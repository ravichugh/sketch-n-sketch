
(function() {
'use strict';

function F2(fun)
{
  function wrapper(a) { return function(b) { return fun(a,b); }; }
  wrapper.arity = 2;
  wrapper.func = fun;
  return wrapper;
}

function F3(fun)
{
  function wrapper(a) {
    return function(b) { return function(c) { return fun(a, b, c); }; };
  }
  wrapper.arity = 3;
  wrapper.func = fun;
  return wrapper;
}

function F4(fun)
{
  function wrapper(a) { return function(b) { return function(c) {
    return function(d) { return fun(a, b, c, d); }; }; };
  }
  wrapper.arity = 4;
  wrapper.func = fun;
  return wrapper;
}

function F5(fun)
{
  function wrapper(a) { return function(b) { return function(c) {
    return function(d) { return function(e) { return fun(a, b, c, d, e); }; }; }; };
  }
  wrapper.arity = 5;
  wrapper.func = fun;
  return wrapper;
}

function F6(fun)
{
  function wrapper(a) { return function(b) { return function(c) {
    return function(d) { return function(e) { return function(f) {
    return fun(a, b, c, d, e, f); }; }; }; }; };
  }
  wrapper.arity = 6;
  wrapper.func = fun;
  return wrapper;
}

function F7(fun)
{
  function wrapper(a) { return function(b) { return function(c) {
    return function(d) { return function(e) { return function(f) {
    return function(g) { return fun(a, b, c, d, e, f, g); }; }; }; }; }; };
  }
  wrapper.arity = 7;
  wrapper.func = fun;
  return wrapper;
}

function F8(fun)
{
  function wrapper(a) { return function(b) { return function(c) {
    return function(d) { return function(e) { return function(f) {
    return function(g) { return function(h) {
    return fun(a, b, c, d, e, f, g, h); }; }; }; }; }; }; };
  }
  wrapper.arity = 8;
  wrapper.func = fun;
  return wrapper;
}

function F9(fun)
{
  function wrapper(a) { return function(b) { return function(c) {
    return function(d) { return function(e) { return function(f) {
    return function(g) { return function(h) { return function(i) {
    return fun(a, b, c, d, e, f, g, h, i); }; }; }; }; }; }; }; };
  }
  wrapper.arity = 9;
  wrapper.func = fun;
  return wrapper;
}

function A2(fun, a, b)
{
  return fun.arity === 2
    ? fun.func(a, b)
    : fun(a)(b);
}
function A3(fun, a, b, c)
{
  return fun.arity === 3
    ? fun.func(a, b, c)
    : fun(a)(b)(c);
}
function A4(fun, a, b, c, d)
{
  return fun.arity === 4
    ? fun.func(a, b, c, d)
    : fun(a)(b)(c)(d);
}
function A5(fun, a, b, c, d, e)
{
  return fun.arity === 5
    ? fun.func(a, b, c, d, e)
    : fun(a)(b)(c)(d)(e);
}
function A6(fun, a, b, c, d, e, f)
{
  return fun.arity === 6
    ? fun.func(a, b, c, d, e, f)
    : fun(a)(b)(c)(d)(e)(f);
}
function A7(fun, a, b, c, d, e, f, g)
{
  return fun.arity === 7
    ? fun.func(a, b, c, d, e, f, g)
    : fun(a)(b)(c)(d)(e)(f)(g);
}
function A8(fun, a, b, c, d, e, f, g, h)
{
  return fun.arity === 8
    ? fun.func(a, b, c, d, e, f, g, h)
    : fun(a)(b)(c)(d)(e)(f)(g)(h);
}
function A9(fun, a, b, c, d, e, f, g, h, i)
{
  return fun.arity === 9
    ? fun.func(a, b, c, d, e, f, g, h, i)
    : fun(a)(b)(c)(d)(e)(f)(g)(h)(i);
}

//import Native.List //

var _elm_lang$core$Native_Array = function() {

// A RRB-Tree has two distinct data types.
// Leaf -> "height"  is always 0
//         "table"   is an array of elements
// Node -> "height"  is always greater than 0
//         "table"   is an array of child nodes
//         "lengths" is an array of accumulated lengths of the child nodes

// M is the maximal table size. 32 seems fast. E is the allowed increase
// of search steps when concatting to find an index. Lower values will
// decrease balancing, but will increase search steps.
var M = 32;
var E = 2;

// An empty array.
var empty = {
	ctor: '_Array',
	height: 0,
	table: []
};


function get(i, array)
{
	if (i < 0 || i >= length(array))
	{
		throw new Error(
			'Index ' + i + ' is out of range. Check the length of ' +
			'your array first or use getMaybe or getWithDefault.');
	}
	return unsafeGet(i, array);
}


function unsafeGet(i, array)
{
	for (var x = array.height; x > 0; x--)
	{
		var slot = i >> (x * 5);
		while (array.lengths[slot] <= i)
		{
			slot++;
		}
		if (slot > 0)
		{
			i -= array.lengths[slot - 1];
		}
		array = array.table[slot];
	}
	return array.table[i];
}


// Sets the value at the index i. Only the nodes leading to i will get
// copied and updated.
function set(i, item, array)
{
	if (i < 0 || length(array) <= i)
	{
		return array;
	}
	return unsafeSet(i, item, array);
}


function unsafeSet(i, item, array)
{
	array = nodeCopy(array);

	if (array.height === 0)
	{
		array.table[i] = item;
	}
	else
	{
		var slot = getSlot(i, array);
		if (slot > 0)
		{
			i -= array.lengths[slot - 1];
		}
		array.table[slot] = unsafeSet(i, item, array.table[slot]);
	}
	return array;
}


function initialize(len, f)
{
	if (len <= 0)
	{
		return empty;
	}
	var h = Math.floor( Math.log(len) / Math.log(M) );
	return initialize_(f, h, 0, len);
}

function initialize_(f, h, from, to)
{
	if (h === 0)
	{
		var table = new Array((to - from) % (M + 1));
		for (var i = 0; i < table.length; i++)
		{
		  table[i] = f(from + i);
		}
		return {
			ctor: '_Array',
			height: 0,
			table: table
		};
	}

	var step = Math.pow(M, h);
	var table = new Array(Math.ceil((to - from) / step));
	var lengths = new Array(table.length);
	for (var i = 0; i < table.length; i++)
	{
		table[i] = initialize_(f, h - 1, from + (i * step), Math.min(from + ((i + 1) * step), to));
		lengths[i] = length(table[i]) + (i > 0 ? lengths[i-1] : 0);
	}
	return {
		ctor: '_Array',
		height: h,
		table: table,
		lengths: lengths
	};
}

function fromList(list)
{
	if (list.ctor === '[]')
	{
		return empty;
	}

	// Allocate M sized blocks (table) and write list elements to it.
	var table = new Array(M);
	var nodes = [];
	var i = 0;

	while (list.ctor !== '[]')
	{
		table[i] = list._0;
		list = list._1;
		i++;

		// table is full, so we can push a leaf containing it into the
		// next node.
		if (i === M)
		{
			var leaf = {
				ctor: '_Array',
				height: 0,
				table: table
			};
			fromListPush(leaf, nodes);
			table = new Array(M);
			i = 0;
		}
	}

	// Maybe there is something left on the table.
	if (i > 0)
	{
		var leaf = {
			ctor: '_Array',
			height: 0,
			table: table.splice(0, i)
		};
		fromListPush(leaf, nodes);
	}

	// Go through all of the nodes and eventually push them into higher nodes.
	for (var h = 0; h < nodes.length - 1; h++)
	{
		if (nodes[h].table.length > 0)
		{
			fromListPush(nodes[h], nodes);
		}
	}

	var head = nodes[nodes.length - 1];
	if (head.height > 0 && head.table.length === 1)
	{
		return head.table[0];
	}
	else
	{
		return head;
	}
}

// Push a node into a higher node as a child.
function fromListPush(toPush, nodes)
{
	var h = toPush.height;

	// Maybe the node on this height does not exist.
	if (nodes.length === h)
	{
		var node = {
			ctor: '_Array',
			height: h + 1,
			table: [],
			lengths: []
		};
		nodes.push(node);
	}

	nodes[h].table.push(toPush);
	var len = length(toPush);
	if (nodes[h].lengths.length > 0)
	{
		len += nodes[h].lengths[nodes[h].lengths.length - 1];
	}
	nodes[h].lengths.push(len);

	if (nodes[h].table.length === M)
	{
		fromListPush(nodes[h], nodes);
		nodes[h] = {
			ctor: '_Array',
			height: h + 1,
			table: [],
			lengths: []
		};
	}
}

// Pushes an item via push_ to the bottom right of a tree.
function push(item, a)
{
	var pushed = push_(item, a);
	if (pushed !== null)
	{
		return pushed;
	}

	var newTree = create(item, a.height);
	return siblise(a, newTree);
}

// Recursively tries to push an item to the bottom-right most
// tree possible. If there is no space left for the item,
// null will be returned.
function push_(item, a)
{
	// Handle resursion stop at leaf level.
	if (a.height === 0)
	{
		if (a.table.length < M)
		{
			var newA = {
				ctor: '_Array',
				height: 0,
				table: a.table.slice()
			};
			newA.table.push(item);
			return newA;
		}
		else
		{
		  return null;
		}
	}

	// Recursively push
	var pushed = push_(item, botRight(a));

	// There was space in the bottom right tree, so the slot will
	// be updated.
	if (pushed !== null)
	{
		var newA = nodeCopy(a);
		newA.table[newA.table.length - 1] = pushed;
		newA.lengths[newA.lengths.length - 1]++;
		return newA;
	}

	// When there was no space left, check if there is space left
	// for a new slot with a tree which contains only the item
	// at the bottom.
	if (a.table.length < M)
	{
		var newSlot = create(item, a.height - 1);
		var newA = nodeCopy(a);
		newA.table.push(newSlot);
		newA.lengths.push(newA.lengths[newA.lengths.length - 1] + length(newSlot));
		return newA;
	}
	else
	{
		return null;
	}
}

// Converts an array into a list of elements.
function toList(a)
{
	return toList_(_elm_lang$core$Native_List.Nil, a);
}

function toList_(list, a)
{
	for (var i = a.table.length - 1; i >= 0; i--)
	{
		list =
			a.height === 0
				? _elm_lang$core$Native_List.Cons(a.table[i], list)
				: toList_(list, a.table[i]);
	}
	return list;
}

// Maps a function over the elements of an array.
function map(f, a)
{
	var newA = {
		ctor: '_Array',
		height: a.height,
		table: new Array(a.table.length)
	};
	if (a.height > 0)
	{
		newA.lengths = a.lengths;
	}
	for (var i = 0; i < a.table.length; i++)
	{
		newA.table[i] =
			a.height === 0
				? f(a.table[i])
				: map(f, a.table[i]);
	}
	return newA;
}

// Maps a function over the elements with their index as first argument.
function indexedMap(f, a)
{
	return indexedMap_(f, a, 0);
}

function indexedMap_(f, a, from)
{
	var newA = {
		ctor: '_Array',
		height: a.height,
		table: new Array(a.table.length)
	};
	if (a.height > 0)
	{
		newA.lengths = a.lengths;
	}
	for (var i = 0; i < a.table.length; i++)
	{
		newA.table[i] =
			a.height === 0
				? A2(f, from + i, a.table[i])
				: indexedMap_(f, a.table[i], i == 0 ? from : from + a.lengths[i - 1]);
	}
	return newA;
}

function foldl(f, b, a)
{
	if (a.height === 0)
	{
		for (var i = 0; i < a.table.length; i++)
		{
			b = A2(f, a.table[i], b);
		}
	}
	else
	{
		for (var i = 0; i < a.table.length; i++)
		{
			b = foldl(f, b, a.table[i]);
		}
	}
	return b;
}

function foldr(f, b, a)
{
	if (a.height === 0)
	{
		for (var i = a.table.length; i--; )
		{
			b = A2(f, a.table[i], b);
		}
	}
	else
	{
		for (var i = a.table.length; i--; )
		{
			b = foldr(f, b, a.table[i]);
		}
	}
	return b;
}

// TODO: currently, it slices the right, then the left. This can be
// optimized.
function slice(from, to, a)
{
	if (from < 0)
	{
		from += length(a);
	}
	if (to < 0)
	{
		to += length(a);
	}
	return sliceLeft(from, sliceRight(to, a));
}

function sliceRight(to, a)
{
	if (to === length(a))
	{
		return a;
	}

	// Handle leaf level.
	if (a.height === 0)
	{
		var newA = { ctor:'_Array', height:0 };
		newA.table = a.table.slice(0, to);
		return newA;
	}

	// Slice the right recursively.
	var right = getSlot(to, a);
	var sliced = sliceRight(to - (right > 0 ? a.lengths[right - 1] : 0), a.table[right]);

	// Maybe the a node is not even needed, as sliced contains the whole slice.
	if (right === 0)
	{
		return sliced;
	}

	// Create new node.
	var newA = {
		ctor: '_Array',
		height: a.height,
		table: a.table.slice(0, right),
		lengths: a.lengths.slice(0, right)
	};
	if (sliced.table.length > 0)
	{
		newA.table[right] = sliced;
		newA.lengths[right] = length(sliced) + (right > 0 ? newA.lengths[right - 1] : 0);
	}
	return newA;
}

function sliceLeft(from, a)
{
	if (from === 0)
	{
		return a;
	}

	// Handle leaf level.
	if (a.height === 0)
	{
		var newA = { ctor:'_Array', height:0 };
		newA.table = a.table.slice(from, a.table.length + 1);
		return newA;
	}

	// Slice the left recursively.
	var left = getSlot(from, a);
	var sliced = sliceLeft(from - (left > 0 ? a.lengths[left - 1] : 0), a.table[left]);

	// Maybe the a node is not even needed, as sliced contains the whole slice.
	if (left === a.table.length - 1)
	{
		return sliced;
	}

	// Create new node.
	var newA = {
		ctor: '_Array',
		height: a.height,
		table: a.table.slice(left, a.table.length + 1),
		lengths: new Array(a.table.length - left)
	};
	newA.table[0] = sliced;
	var len = 0;
	for (var i = 0; i < newA.table.length; i++)
	{
		len += length(newA.table[i]);
		newA.lengths[i] = len;
	}

	return newA;
}

// Appends two trees.
function append(a,b)
{
	if (a.table.length === 0)
	{
		return b;
	}
	if (b.table.length === 0)
	{
		return a;
	}

	var c = append_(a, b);

	// Check if both nodes can be crunshed together.
	if (c[0].table.length + c[1].table.length <= M)
	{
		if (c[0].table.length === 0)
		{
			return c[1];
		}
		if (c[1].table.length === 0)
		{
			return c[0];
		}

		// Adjust .table and .lengths
		c[0].table = c[0].table.concat(c[1].table);
		if (c[0].height > 0)
		{
			var len = length(c[0]);
			for (var i = 0; i < c[1].lengths.length; i++)
			{
				c[1].lengths[i] += len;
			}
			c[0].lengths = c[0].lengths.concat(c[1].lengths);
		}

		return c[0];
	}

	if (c[0].height > 0)
	{
		var toRemove = calcToRemove(a, b);
		if (toRemove > E)
		{
			c = shuffle(c[0], c[1], toRemove);
		}
	}

	return siblise(c[0], c[1]);
}

// Returns an array of two nodes; right and left. One node _may_ be empty.
function append_(a, b)
{
	if (a.height === 0 && b.height === 0)
	{
		return [a, b];
	}

	if (a.height !== 1 || b.height !== 1)
	{
		if (a.height === b.height)
		{
			a = nodeCopy(a);
			b = nodeCopy(b);
			var appended = append_(botRight(a), botLeft(b));

			insertRight(a, appended[1]);
			insertLeft(b, appended[0]);
		}
		else if (a.height > b.height)
		{
			a = nodeCopy(a);
			var appended = append_(botRight(a), b);

			insertRight(a, appended[0]);
			b = parentise(appended[1], appended[1].height + 1);
		}
		else
		{
			b = nodeCopy(b);
			var appended = append_(a, botLeft(b));

			var left = appended[0].table.length === 0 ? 0 : 1;
			var right = left === 0 ? 1 : 0;
			insertLeft(b, appended[left]);
			a = parentise(appended[right], appended[right].height + 1);
		}
	}

	// Check if balancing is needed and return based on that.
	if (a.table.length === 0 || b.table.length === 0)
	{
		return [a, b];
	}

	var toRemove = calcToRemove(a, b);
	if (toRemove <= E)
	{
		return [a, b];
	}
	return shuffle(a, b, toRemove);
}

// Helperfunctions for append_. Replaces a child node at the side of the parent.
function insertRight(parent, node)
{
	var index = parent.table.length - 1;
	parent.table[index] = node;
	parent.lengths[index] = length(node);
	parent.lengths[index] += index > 0 ? parent.lengths[index - 1] : 0;
}

function insertLeft(parent, node)
{
	if (node.table.length > 0)
	{
		parent.table[0] = node;
		parent.lengths[0] = length(node);

		var len = length(parent.table[0]);
		for (var i = 1; i < parent.lengths.length; i++)
		{
			len += length(parent.table[i]);
			parent.lengths[i] = len;
		}
	}
	else
	{
		parent.table.shift();
		for (var i = 1; i < parent.lengths.length; i++)
		{
			parent.lengths[i] = parent.lengths[i] - parent.lengths[0];
		}
		parent.lengths.shift();
	}
}

// Returns the extra search steps for E. Refer to the paper.
function calcToRemove(a, b)
{
	var subLengths = 0;
	for (var i = 0; i < a.table.length; i++)
	{
		subLengths += a.table[i].table.length;
	}
	for (var i = 0; i < b.table.length; i++)
	{
		subLengths += b.table[i].table.length;
	}

	var toRemove = a.table.length + b.table.length;
	return toRemove - (Math.floor((subLengths - 1) / M) + 1);
}

// get2, set2 and saveSlot are helpers for accessing elements over two arrays.
function get2(a, b, index)
{
	return index < a.length
		? a[index]
		: b[index - a.length];
}

function set2(a, b, index, value)
{
	if (index < a.length)
	{
		a[index] = value;
	}
	else
	{
		b[index - a.length] = value;
	}
}

function saveSlot(a, b, index, slot)
{
	set2(a.table, b.table, index, slot);

	var l = (index === 0 || index === a.lengths.length)
		? 0
		: get2(a.lengths, a.lengths, index - 1);

	set2(a.lengths, b.lengths, index, l + length(slot));
}

// Creates a node or leaf with a given length at their arrays for perfomance.
// Is only used by shuffle.
function createNode(h, length)
{
	if (length < 0)
	{
		length = 0;
	}
	var a = {
		ctor: '_Array',
		height: h,
		table: new Array(length)
	};
	if (h > 0)
	{
		a.lengths = new Array(length);
	}
	return a;
}

// Returns an array of two balanced nodes.
function shuffle(a, b, toRemove)
{
	var newA = createNode(a.height, Math.min(M, a.table.length + b.table.length - toRemove));
	var newB = createNode(a.height, newA.table.length - (a.table.length + b.table.length - toRemove));

	// Skip the slots with size M. More precise: copy the slot references
	// to the new node
	var read = 0;
	while (get2(a.table, b.table, read).table.length % M === 0)
	{
		set2(newA.table, newB.table, read, get2(a.table, b.table, read));
		set2(newA.lengths, newB.lengths, read, get2(a.lengths, b.lengths, read));
		read++;
	}

	// Pulling items from left to right, caching in a slot before writing
	// it into the new nodes.
	var write = read;
	var slot = new createNode(a.height - 1, 0);
	var from = 0;

	// If the current slot is still containing data, then there will be at
	// least one more write, so we do not break this loop yet.
	while (read - write - (slot.table.length > 0 ? 1 : 0) < toRemove)
	{
		// Find out the max possible items for copying.
		var source = get2(a.table, b.table, read);
		var to = Math.min(M - slot.table.length, source.table.length);

		// Copy and adjust size table.
		slot.table = slot.table.concat(source.table.slice(from, to));
		if (slot.height > 0)
		{
			var len = slot.lengths.length;
			for (var i = len; i < len + to - from; i++)
			{
				slot.lengths[i] = length(slot.table[i]);
				slot.lengths[i] += (i > 0 ? slot.lengths[i - 1] : 0);
			}
		}

		from += to;

		// Only proceed to next slots[i] if the current one was
		// fully copied.
		if (source.table.length <= to)
		{
			read++; from = 0;
		}

		// Only create a new slot if the current one is filled up.
		if (slot.table.length === M)
		{
			saveSlot(newA, newB, write, slot);
			slot = createNode(a.height - 1, 0);
			write++;
		}
	}

	// Cleanup after the loop. Copy the last slot into the new nodes.
	if (slot.table.length > 0)
	{
		saveSlot(newA, newB, write, slot);
		write++;
	}

	// Shift the untouched slots to the left
	while (read < a.table.length + b.table.length )
	{
		saveSlot(newA, newB, write, get2(a.table, b.table, read));
		read++;
		write++;
	}

	return [newA, newB];
}

// Navigation functions
function botRight(a)
{
	return a.table[a.table.length - 1];
}
function botLeft(a)
{
	return a.table[0];
}

// Copies a node for updating. Note that you should not use this if
// only updating only one of "table" or "lengths" for performance reasons.
function nodeCopy(a)
{
	var newA = {
		ctor: '_Array',
		height: a.height,
		table: a.table.slice()
	};
	if (a.height > 0)
	{
		newA.lengths = a.lengths.slice();
	}
	return newA;
}

// Returns how many items are in the tree.
function length(array)
{
	if (array.height === 0)
	{
		return array.table.length;
	}
	else
	{
		return array.lengths[array.lengths.length - 1];
	}
}

// Calculates in which slot of "table" the item probably is, then
// find the exact slot via forward searching in  "lengths". Returns the index.
function getSlot(i, a)
{
	var slot = i >> (5 * a.height);
	while (a.lengths[slot] <= i)
	{
		slot++;
	}
	return slot;
}

// Recursively creates a tree with a given height containing
// only the given item.
function create(item, h)
{
	if (h === 0)
	{
		return {
			ctor: '_Array',
			height: 0,
			table: [item]
		};
	}
	return {
		ctor: '_Array',
		height: h,
		table: [create(item, h - 1)],
		lengths: [1]
	};
}

// Recursively creates a tree that contains the given tree.
function parentise(tree, h)
{
	if (h === tree.height)
	{
		return tree;
	}

	return {
		ctor: '_Array',
		height: h,
		table: [parentise(tree, h - 1)],
		lengths: [length(tree)]
	};
}

// Emphasizes blood brotherhood beneath two trees.
function siblise(a, b)
{
	return {
		ctor: '_Array',
		height: a.height + 1,
		table: [a, b],
		lengths: [length(a), length(a) + length(b)]
	};
}

function toJSArray(a)
{
	var jsArray = new Array(length(a));
	toJSArray_(jsArray, 0, a);
	return jsArray;
}

function toJSArray_(jsArray, i, a)
{
	for (var t = 0; t < a.table.length; t++)
	{
		if (a.height === 0)
		{
			jsArray[i + t] = a.table[t];
		}
		else
		{
			var inc = t === 0 ? 0 : a.lengths[t - 1];
			toJSArray_(jsArray, i + inc, a.table[t]);
		}
	}
}

function fromJSArray(jsArray)
{
	if (jsArray.length === 0)
	{
		return empty;
	}
	var h = Math.floor(Math.log(jsArray.length) / Math.log(M));
	return fromJSArray_(jsArray, h, 0, jsArray.length);
}

function fromJSArray_(jsArray, h, from, to)
{
	if (h === 0)
	{
		return {
			ctor: '_Array',
			height: 0,
			table: jsArray.slice(from, to)
		};
	}

	var step = Math.pow(M, h);
	var table = new Array(Math.ceil((to - from) / step));
	var lengths = new Array(table.length);
	for (var i = 0; i < table.length; i++)
	{
		table[i] = fromJSArray_(jsArray, h - 1, from + (i * step), Math.min(from + ((i + 1) * step), to));
		lengths[i] = length(table[i]) + (i > 0 ? lengths[i - 1] : 0);
	}
	return {
		ctor: '_Array',
		height: h,
		table: table,
		lengths: lengths
	};
}

return {
	empty: empty,
	fromList: fromList,
	toList: toList,
	initialize: F2(initialize),
	append: F2(append),
	push: F2(push),
	slice: F3(slice),
	get: F2(get),
	set: F3(set),
	map: F2(map),
	indexedMap: F2(indexedMap),
	foldl: F3(foldl),
	foldr: F3(foldr),
	length: length,

	toJSArray: toJSArray,
	fromJSArray: fromJSArray
};

}();
//import Native.Utils //

var _elm_lang$core$Native_Basics = function() {

function div(a, b)
{
	return (a / b) | 0;
}
function rem(a, b)
{
	return a % b;
}
function mod(a, b)
{
	if (b === 0)
	{
		throw new Error('Cannot perform mod 0. Division by zero error.');
	}
	var r = a % b;
	var m = a === 0 ? 0 : (b > 0 ? (a >= 0 ? r : r + b) : -mod(-a, -b));

	return m === b ? 0 : m;
}
function logBase(base, n)
{
	return Math.log(n) / Math.log(base);
}
function negate(n)
{
	return -n;
}
function abs(n)
{
	return n < 0 ? -n : n;
}

function min(a, b)
{
	return _elm_lang$core$Native_Utils.cmp(a, b) < 0 ? a : b;
}
function max(a, b)
{
	return _elm_lang$core$Native_Utils.cmp(a, b) > 0 ? a : b;
}
function clamp(lo, hi, n)
{
	return _elm_lang$core$Native_Utils.cmp(n, lo) < 0
		? lo
		: _elm_lang$core$Native_Utils.cmp(n, hi) > 0
			? hi
			: n;
}

var ord = ['LT', 'EQ', 'GT'];

function compare(x, y)
{
	return { ctor: ord[_elm_lang$core$Native_Utils.cmp(x, y) + 1] };
}

function xor(a, b)
{
	return a !== b;
}
function not(b)
{
	return !b;
}
function isInfinite(n)
{
	return n === Infinity || n === -Infinity;
}

function truncate(n)
{
	return n | 0;
}

function degrees(d)
{
	return d * Math.PI / 180;
}
function turns(t)
{
	return 2 * Math.PI * t;
}
function fromPolar(point)
{
	var r = point._0;
	var t = point._1;
	return _elm_lang$core$Native_Utils.Tuple2(r * Math.cos(t), r * Math.sin(t));
}
function toPolar(point)
{
	var x = point._0;
	var y = point._1;
	return _elm_lang$core$Native_Utils.Tuple2(Math.sqrt(x * x + y * y), Math.atan2(y, x));
}

return {
	div: F2(div),
	rem: F2(rem),
	mod: F2(mod),

	pi: Math.PI,
	e: Math.E,
	cos: Math.cos,
	sin: Math.sin,
	tan: Math.tan,
	acos: Math.acos,
	asin: Math.asin,
	atan: Math.atan,
	atan2: F2(Math.atan2),

	degrees: degrees,
	turns: turns,
	fromPolar: fromPolar,
	toPolar: toPolar,

	sqrt: Math.sqrt,
	logBase: F2(logBase),
	negate: negate,
	abs: abs,
	min: F2(min),
	max: F2(max),
	clamp: F3(clamp),
	compare: F2(compare),

	xor: F2(xor),
	not: not,

	truncate: truncate,
	ceiling: Math.ceil,
	floor: Math.floor,
	round: Math.round,
	toFloat: function(x) { return x; },
	isNaN: isNaN,
	isInfinite: isInfinite
};

}();
//import //

var _elm_lang$core$Native_Utils = function() {

// COMPARISONS

function eq(x, y)
{
	var stack = [];
	var isEqual = eqHelp(x, y, 0, stack);
	var pair;
	while (isEqual && (pair = stack.pop()))
	{
		isEqual = eqHelp(pair.x, pair.y, 0, stack);
	}
	return isEqual;
}


function eqHelp(x, y, depth, stack)
{
	if (depth > 100)
	{
		stack.push({ x: x, y: y });
		return true;
	}

	if (x === y)
	{
		return true;
	}

	if (typeof x !== 'object')
	{
		if (typeof x === 'function')
		{
			throw new Error(
				'Trying to use `(==)` on functions. There is no way to know if functions are "the same" in the Elm sense.'
				+ ' Read more about this at http://package.elm-lang.org/packages/elm-lang/core/latest/Basics#=='
				+ ' which describes why it is this way and what the better version will look like.'
			);
		}
		return false;
	}

	if (x === null || y === null)
	{
		return false
	}

	if (x instanceof Date)
	{
		return x.getTime() === y.getTime();
	}

	if (!('ctor' in x))
	{
		var keys = Object.keys(x).sort();

		for (var i in keys)
		{
			var k = keys[i];
			if (!eqHelp(x[k], y[k], depth + 1, stack))
			{
				return false;
			}
		}
		return true;
	}

	// convert Dicts and Sets to lists
	if (x.ctor === 'RBNode_elm_builtin' || x.ctor === 'RBEmpty_elm_builtin')
	{
		x = _elm_lang$core$Dict$toList(x);
		y = _elm_lang$core$Dict$toList(y);
	}
	if (x.ctor === 'Set_elm_builtin')
	{
		x = _elm_lang$core$Set$toList(x);
		y = _elm_lang$core$Set$toList(y);
	}

	// check if lists are equal without recursion
	if (x.ctor === '::')
	{
		var a = x;
		var b = y;
		while (a.ctor === '::' && b.ctor === '::')
		{
			if (!eqHelp(a._0, b._0, depth + 1, stack))
			{
				return false;
			}
			a = a._1;
			b = b._1;
		}
		return a.ctor === b.ctor;
	}

	// check if Arrays are equal
	if (x.ctor === '_Array')
	{
		var xs = _elm_lang$core$Native_Array.toJSArray(x);
		var ys = _elm_lang$core$Native_Array.toJSArray(y);
		if (xs.length !== ys.length)
		{
			return false;
		}
		for (var i = 0; i < xs.length; i++)
		{
			if (!eqHelp(xs[i], ys[i], depth + 1, stack))
			{
				return false;
			}
		}
		return true;
	}

	if (!eqHelp(x.ctor, y.ctor, depth + 1, stack))
	{
		return false;
	}

	for (var key in x)
	{
		if (!eqHelp(x[key], y[key], depth + 1, stack))
		{
			return false;
		}
	}
	return true;
}

// Code in Generate/JavaScript.hs, Basics.js, and List.js depends on
// the particular integer values assigned to LT, EQ, and GT.

var LT = -1, EQ = 0, GT = 1;

function cmp(x, y)
{
	// This avoids looping forever if someone hacked cycles into the object graph.
	if (x === y)
	{
		return EQ;
	}

	var type = typeof x;

	if (type !== 'object' && type !== 'function')
	{
		return x < y ? LT : GT;
	}

	if (x instanceof String)
	{
		var a = x.valueOf();
		var b = y.valueOf();
		return a === b ? EQ : a < b ? LT : GT;
	}

	if (type === 'function') {
		throw new Error(
			'Comparison error: There is no way to compare functions. '
			+ 'Comparison is only defined on ints, '
			+ 'floats, times, chars, strings, lists of comparable values, '
			+ 'and tuples of comparable values.'
		);
	}

	// Only Javascript objects past this point.

	if ('ctor' in x)
	{
		if (x.ctor === '::' || x.ctor === '[]')
		{
			while (x.ctor === '::' && y.ctor === '::')
			{
				var ord = cmp(x._0, y._0);
				if (ord !== EQ)
				{
					return ord;
				}
				x = x._1;
				y = y._1;
			}
			return x.ctor === y.ctor ? EQ : x.ctor === '[]' ? LT : GT;
		}

		if (x.ctor.slice(0, 6) === '_Tuple')
		{
			var ord;
			var n = x.ctor.slice(6) - 0;
			var err = 'cannot compare tuples with more than 6 elements.';
			if (n === 0) return EQ;
			if (n >= 1) { ord = cmp(x._0, y._0); if (ord !== EQ) return ord;
			if (n >= 2) { ord = cmp(x._1, y._1); if (ord !== EQ) return ord;
			if (n >= 3) { ord = cmp(x._2, y._2); if (ord !== EQ) return ord;
			if (n >= 4) { ord = cmp(x._3, y._3); if (ord !== EQ) return ord;
			if (n >= 5) { ord = cmp(x._4, y._4); if (ord !== EQ) return ord;
			if (n >= 6) { ord = cmp(x._5, y._5); if (ord !== EQ) return ord;
			if (n >= 7) throw new Error('Comparison error: ' + err); } } } } } }
			return EQ;
		}

		// Non-comparable types below, for use in sets and as dictionary keys.
		//
		// Type checker prevents these being used with < > <= >=.

		// convert Dicts and Sets to lists
		if (x.ctor === 'RBNode_elm_builtin' || x.ctor === 'RBEmpty_elm_builtin')
		{
			x = _elm_lang$core$Dict$toList(x);
			y = _elm_lang$core$Dict$toList(y);

			return cmp(x, y);
		}
		if (x.ctor === 'Set_elm_builtin')
		{
			x = _elm_lang$core$Set$toList(x);
			y = _elm_lang$core$Set$toList(y);

			return cmp(x, y);
		}

		// Other ADTs
		if (x.ctor < y.ctor) { return LT; }
		if (x.ctor > y.ctor) { return GT; }

		var ord;
		for (var i in x)
		{
			if (i === 'ctor') continue;

			ord = cmp(x[i], y[i]);

			if (ord !== EQ) { return ord; }
		}

		return EQ;
	}

	if (x instanceof Date)
	{
		return x == y ? EQ : x < y ? LT : GT;
	}

	if (x === null || x.elm_web_socket)
	{
		throw new Error(
			'Comparison error: comparison is only defined on ints, '
			+ 'floats, times, chars, strings, lists of comparable values, '
			+ 'and tuples of comparable values.'
		);
	}

	// Two records.
	var keys = Object.keys(x).sort();

	for (var i in keys)
	{
		var k = keys[i];
		ord = cmp(x[k], y[k]);

		if (ord !== EQ) { return ord; }
	}

	return EQ;
}


// COMMON VALUES

var Tuple0 = {
	ctor: '_Tuple0'
};

function Tuple2(x, y)
{
	return {
		ctor: '_Tuple2',
		_0: x,
		_1: y
	};
}

function chr(c)
{
	return new String(c);
}


// GUID

var count = 0;
function guid(_)
{
	return count++;
}


// RECORDS

function update(oldRecord, updatedFields)
{
	var newRecord = {};

	for (var key in oldRecord)
	{
		newRecord[key] = oldRecord[key];
	}

	for (var key in updatedFields)
	{
		newRecord[key] = updatedFields[key];
	}

	return newRecord;
}


//// LIST STUFF ////

var Nil = { ctor: '[]' };

function Cons(hd, tl)
{
	return {
		ctor: '::',
		_0: hd,
		_1: tl
	};
}

function append(xs, ys)
{
	// append Strings
	if (typeof xs === 'string')
	{
		return xs + ys;
	}

	// append Lists
	if (xs.ctor === '[]')
	{
		return ys;
	}
	var root = Cons(xs._0, Nil);
	var curr = root;
	xs = xs._1;
	while (xs.ctor !== '[]')
	{
		curr._1 = Cons(xs._0, Nil);
		xs = xs._1;
		curr = curr._1;
	}
	curr._1 = ys;
	return root;
}


// CRASHES

function crash(moduleName, region)
{
	return function(message) {
		throw new Error(
			'Ran into a `Debug.crash` in module `' + moduleName + '` ' + regionToString(region) + '\n'
			+ 'The message provided by the code author is:\n\n    '
			+ message
		);
	};
}

function crashCase(moduleName, region, value)
{
	return function(message) {
		throw new Error(
			'Ran into a `Debug.crash` in module `' + moduleName + '`\n\n'
			+ 'This was caused by the `case` expression ' + regionToString(region) + '.\n'
			+ 'One of the branches ended with a crash and the following value got through:\n\n    ' + toString(value) + '\n\n'
			+ 'The message provided by the code author is:\n\n    '
			+ message
		);
	};
}

function regionToString(region)
{
	if (region.start.line == region.end.line)
	{
		return 'on line ' + region.start.line;
	}
	return 'between lines ' + region.start.line + ' and ' + region.end.line;
}


// TO STRING

function toString(v)
{
	var type = typeof v;
	if (type === 'function')
	{
		return '<function>';
	}

	if (type === 'boolean')
	{
		return v ? 'True' : 'False';
	}

	if (type === 'number')
	{
		return v + '';
	}

	if (v instanceof String)
	{
		return '\'' + addSlashes(v, true) + '\'';
	}

	if (type === 'string')
	{
		return '"' + addSlashes(v, false) + '"';
	}

	if (v === null)
	{
		return 'null';
	}

	if (type === 'object' && 'ctor' in v)
	{
		var ctorStarter = v.ctor.substring(0, 5);

		if (ctorStarter === '_Tupl')
		{
			var output = [];
			for (var k in v)
			{
				if (k === 'ctor') continue;
				output.push(toString(v[k]));
			}
			return '(' + output.join(',') + ')';
		}

		if (ctorStarter === '_Task')
		{
			return '<task>'
		}

		if (v.ctor === '_Array')
		{
			var list = _elm_lang$core$Array$toList(v);
			return 'Array.fromList ' + toString(list);
		}

		if (v.ctor === '<decoder>')
		{
			return '<decoder>';
		}

		if (v.ctor === '_Process')
		{
			return '<process:' + v.id + '>';
		}

		if (v.ctor === '::')
		{
			var output = '[' + toString(v._0);
			v = v._1;
			while (v.ctor === '::')
			{
				output += ',' + toString(v._0);
				v = v._1;
			}
			return output + ']';
		}

		if (v.ctor === '[]')
		{
			return '[]';
		}

		if (v.ctor === 'Set_elm_builtin')
		{
			return 'Set.fromList ' + toString(_elm_lang$core$Set$toList(v));
		}

		if (v.ctor === 'RBNode_elm_builtin' || v.ctor === 'RBEmpty_elm_builtin')
		{
			return 'Dict.fromList ' + toString(_elm_lang$core$Dict$toList(v));
		}

		var output = '';
		for (var i in v)
		{
			if (i === 'ctor') continue;
			var str = toString(v[i]);
			var c0 = str[0];
			var parenless = c0 === '{' || c0 === '(' || c0 === '<' || c0 === '"' || str.indexOf(' ') < 0;
			output += ' ' + (parenless ? str : '(' + str + ')');
		}
		return v.ctor + output;
	}

	if (type === 'object')
	{
		if (v instanceof Date)
		{
			return '<' + v.toString() + '>';
		}

		if (v.elm_web_socket)
		{
			return '<websocket>';
		}

		var output = [];
		var keys = Object.keys(v).sort();

		for (var i in keys)
		{
			var k = keys[i];
			output.push(k + ' = ' + toString(v[k]));
		}
		if (output.length === 0)
		{
			return '{}';
		}
		return '{ ' + output.join(', ') + ' }';
	}

	return '<internal structure>';
}

function addSlashes(str, isChar)
{
	var s = str.replace(/\\/g, '\\\\')
			  .replace(/\n/g, '\\n')
			  .replace(/\t/g, '\\t')
			  .replace(/\r/g, '\\r')
			  .replace(/\v/g, '\\v')
			  .replace(/\0/g, '\\0');
	if (isChar)
	{
		return s.replace(/\'/g, '\\\'');
	}
	else
	{
		return s.replace(/\"/g, '\\"');
	}
}


return {
	eq: eq,
	cmp: cmp,
	Tuple0: Tuple0,
	Tuple2: Tuple2,
	chr: chr,
	update: update,
	guid: guid,

	append: F2(append),

	crash: crash,
	crashCase: crashCase,

	toString: toString
};

}();
var _elm_lang$core$Basics$never = function (_p0) {
	never:
	while (true) {
		var _p1 = _p0;
		var _v1 = _p1._0;
		_p0 = _v1;
		continue never;
	}
};
var _elm_lang$core$Basics$uncurry = F2(
	function (f, _p2) {
		var _p3 = _p2;
		return A2(f, _p3._0, _p3._1);
	});
var _elm_lang$core$Basics$curry = F3(
	function (f, a, b) {
		return f(
			{ctor: '_Tuple2', _0: a, _1: b});
	});
var _elm_lang$core$Basics$flip = F3(
	function (f, b, a) {
		return A2(f, a, b);
	});
var _elm_lang$core$Basics$always = F2(
	function (a, _p4) {
		return a;
	});
var _elm_lang$core$Basics$identity = function (x) {
	return x;
};
var _elm_lang$core$Basics_ops = _elm_lang$core$Basics_ops || {};
_elm_lang$core$Basics_ops['<|'] = F2(
	function (f, x) {
		return f(x);
	});
var _elm_lang$core$Basics_ops = _elm_lang$core$Basics_ops || {};
_elm_lang$core$Basics_ops['|>'] = F2(
	function (x, f) {
		return f(x);
	});
var _elm_lang$core$Basics_ops = _elm_lang$core$Basics_ops || {};
_elm_lang$core$Basics_ops['>>'] = F3(
	function (f, g, x) {
		return g(
			f(x));
	});
var _elm_lang$core$Basics_ops = _elm_lang$core$Basics_ops || {};
_elm_lang$core$Basics_ops['<<'] = F3(
	function (g, f, x) {
		return g(
			f(x));
	});
var _elm_lang$core$Basics_ops = _elm_lang$core$Basics_ops || {};
_elm_lang$core$Basics_ops['++'] = _elm_lang$core$Native_Utils.append;
var _elm_lang$core$Basics$toString = _elm_lang$core$Native_Utils.toString;
var _elm_lang$core$Basics$isInfinite = _elm_lang$core$Native_Basics.isInfinite;
var _elm_lang$core$Basics$isNaN = _elm_lang$core$Native_Basics.isNaN;
var _elm_lang$core$Basics$toFloat = _elm_lang$core$Native_Basics.toFloat;
var _elm_lang$core$Basics$ceiling = _elm_lang$core$Native_Basics.ceiling;
var _elm_lang$core$Basics$floor = _elm_lang$core$Native_Basics.floor;
var _elm_lang$core$Basics$truncate = _elm_lang$core$Native_Basics.truncate;
var _elm_lang$core$Basics$round = _elm_lang$core$Native_Basics.round;
var _elm_lang$core$Basics$not = _elm_lang$core$Native_Basics.not;
var _elm_lang$core$Basics$xor = _elm_lang$core$Native_Basics.xor;
var _elm_lang$core$Basics_ops = _elm_lang$core$Basics_ops || {};
_elm_lang$core$Basics_ops['||'] = _elm_lang$core$Native_Basics.or;
var _elm_lang$core$Basics_ops = _elm_lang$core$Basics_ops || {};
_elm_lang$core$Basics_ops['&&'] = _elm_lang$core$Native_Basics.and;
var _elm_lang$core$Basics$max = _elm_lang$core$Native_Basics.max;
var _elm_lang$core$Basics$min = _elm_lang$core$Native_Basics.min;
var _elm_lang$core$Basics$compare = _elm_lang$core$Native_Basics.compare;
var _elm_lang$core$Basics_ops = _elm_lang$core$Basics_ops || {};
_elm_lang$core$Basics_ops['>='] = _elm_lang$core$Native_Basics.ge;
var _elm_lang$core$Basics_ops = _elm_lang$core$Basics_ops || {};
_elm_lang$core$Basics_ops['<='] = _elm_lang$core$Native_Basics.le;
var _elm_lang$core$Basics_ops = _elm_lang$core$Basics_ops || {};
_elm_lang$core$Basics_ops['>'] = _elm_lang$core$Native_Basics.gt;
var _elm_lang$core$Basics_ops = _elm_lang$core$Basics_ops || {};
_elm_lang$core$Basics_ops['<'] = _elm_lang$core$Native_Basics.lt;
var _elm_lang$core$Basics_ops = _elm_lang$core$Basics_ops || {};
_elm_lang$core$Basics_ops['/='] = _elm_lang$core$Native_Basics.neq;
var _elm_lang$core$Basics_ops = _elm_lang$core$Basics_ops || {};
_elm_lang$core$Basics_ops['=='] = _elm_lang$core$Native_Basics.eq;
var _elm_lang$core$Basics$e = _elm_lang$core$Native_Basics.e;
var _elm_lang$core$Basics$pi = _elm_lang$core$Native_Basics.pi;
var _elm_lang$core$Basics$clamp = _elm_lang$core$Native_Basics.clamp;
var _elm_lang$core$Basics$logBase = _elm_lang$core$Native_Basics.logBase;
var _elm_lang$core$Basics$abs = _elm_lang$core$Native_Basics.abs;
var _elm_lang$core$Basics$negate = _elm_lang$core$Native_Basics.negate;
var _elm_lang$core$Basics$sqrt = _elm_lang$core$Native_Basics.sqrt;
var _elm_lang$core$Basics$atan2 = _elm_lang$core$Native_Basics.atan2;
var _elm_lang$core$Basics$atan = _elm_lang$core$Native_Basics.atan;
var _elm_lang$core$Basics$asin = _elm_lang$core$Native_Basics.asin;
var _elm_lang$core$Basics$acos = _elm_lang$core$Native_Basics.acos;
var _elm_lang$core$Basics$tan = _elm_lang$core$Native_Basics.tan;
var _elm_lang$core$Basics$sin = _elm_lang$core$Native_Basics.sin;
var _elm_lang$core$Basics$cos = _elm_lang$core$Native_Basics.cos;
var _elm_lang$core$Basics_ops = _elm_lang$core$Basics_ops || {};
_elm_lang$core$Basics_ops['^'] = _elm_lang$core$Native_Basics.exp;
var _elm_lang$core$Basics_ops = _elm_lang$core$Basics_ops || {};
_elm_lang$core$Basics_ops['%'] = _elm_lang$core$Native_Basics.mod;
var _elm_lang$core$Basics$rem = _elm_lang$core$Native_Basics.rem;
var _elm_lang$core$Basics_ops = _elm_lang$core$Basics_ops || {};
_elm_lang$core$Basics_ops['//'] = _elm_lang$core$Native_Basics.div;
var _elm_lang$core$Basics_ops = _elm_lang$core$Basics_ops || {};
_elm_lang$core$Basics_ops['/'] = _elm_lang$core$Native_Basics.floatDiv;
var _elm_lang$core$Basics_ops = _elm_lang$core$Basics_ops || {};
_elm_lang$core$Basics_ops['*'] = _elm_lang$core$Native_Basics.mul;
var _elm_lang$core$Basics_ops = _elm_lang$core$Basics_ops || {};
_elm_lang$core$Basics_ops['-'] = _elm_lang$core$Native_Basics.sub;
var _elm_lang$core$Basics_ops = _elm_lang$core$Basics_ops || {};
_elm_lang$core$Basics_ops['+'] = _elm_lang$core$Native_Basics.add;
var _elm_lang$core$Basics$toPolar = _elm_lang$core$Native_Basics.toPolar;
var _elm_lang$core$Basics$fromPolar = _elm_lang$core$Native_Basics.fromPolar;
var _elm_lang$core$Basics$turns = _elm_lang$core$Native_Basics.turns;
var _elm_lang$core$Basics$degrees = _elm_lang$core$Native_Basics.degrees;
var _elm_lang$core$Basics$radians = function (t) {
	return t;
};
var _elm_lang$core$Basics$GT = {ctor: 'GT'};
var _elm_lang$core$Basics$EQ = {ctor: 'EQ'};
var _elm_lang$core$Basics$LT = {ctor: 'LT'};
var _elm_lang$core$Basics$JustOneMore = function (a) {
	return {ctor: 'JustOneMore', _0: a};
};

var _elm_lang$core$Maybe$withDefault = F2(
	function ($default, maybe) {
		var _p0 = maybe;
		if (_p0.ctor === 'Just') {
			return _p0._0;
		} else {
			return $default;
		}
	});
var _elm_lang$core$Maybe$Nothing = {ctor: 'Nothing'};
var _elm_lang$core$Maybe$andThen = F2(
	function (callback, maybeValue) {
		var _p1 = maybeValue;
		if (_p1.ctor === 'Just') {
			return callback(_p1._0);
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _elm_lang$core$Maybe$Just = function (a) {
	return {ctor: 'Just', _0: a};
};
var _elm_lang$core$Maybe$map = F2(
	function (f, maybe) {
		var _p2 = maybe;
		if (_p2.ctor === 'Just') {
			return _elm_lang$core$Maybe$Just(
				f(_p2._0));
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _elm_lang$core$Maybe$map2 = F3(
	function (func, ma, mb) {
		var _p3 = {ctor: '_Tuple2', _0: ma, _1: mb};
		if (((_p3.ctor === '_Tuple2') && (_p3._0.ctor === 'Just')) && (_p3._1.ctor === 'Just')) {
			return _elm_lang$core$Maybe$Just(
				A2(func, _p3._0._0, _p3._1._0));
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _elm_lang$core$Maybe$map3 = F4(
	function (func, ma, mb, mc) {
		var _p4 = {ctor: '_Tuple3', _0: ma, _1: mb, _2: mc};
		if ((((_p4.ctor === '_Tuple3') && (_p4._0.ctor === 'Just')) && (_p4._1.ctor === 'Just')) && (_p4._2.ctor === 'Just')) {
			return _elm_lang$core$Maybe$Just(
				A3(func, _p4._0._0, _p4._1._0, _p4._2._0));
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _elm_lang$core$Maybe$map4 = F5(
	function (func, ma, mb, mc, md) {
		var _p5 = {ctor: '_Tuple4', _0: ma, _1: mb, _2: mc, _3: md};
		if (((((_p5.ctor === '_Tuple4') && (_p5._0.ctor === 'Just')) && (_p5._1.ctor === 'Just')) && (_p5._2.ctor === 'Just')) && (_p5._3.ctor === 'Just')) {
			return _elm_lang$core$Maybe$Just(
				A4(func, _p5._0._0, _p5._1._0, _p5._2._0, _p5._3._0));
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _elm_lang$core$Maybe$map5 = F6(
	function (func, ma, mb, mc, md, me) {
		var _p6 = {ctor: '_Tuple5', _0: ma, _1: mb, _2: mc, _3: md, _4: me};
		if ((((((_p6.ctor === '_Tuple5') && (_p6._0.ctor === 'Just')) && (_p6._1.ctor === 'Just')) && (_p6._2.ctor === 'Just')) && (_p6._3.ctor === 'Just')) && (_p6._4.ctor === 'Just')) {
			return _elm_lang$core$Maybe$Just(
				A5(func, _p6._0._0, _p6._1._0, _p6._2._0, _p6._3._0, _p6._4._0));
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});

//import Native.Utils //

var _elm_lang$core$Native_List = function() {

var Nil = { ctor: '[]' };

function Cons(hd, tl)
{
	return { ctor: '::', _0: hd, _1: tl };
}

function fromArray(arr)
{
	var out = Nil;
	for (var i = arr.length; i--; )
	{
		out = Cons(arr[i], out);
	}
	return out;
}

function toArray(xs)
{
	var out = [];
	while (xs.ctor !== '[]')
	{
		out.push(xs._0);
		xs = xs._1;
	}
	return out;
}

function foldr(f, b, xs)
{
	var arr = toArray(xs);
	var acc = b;
	for (var i = arr.length; i--; )
	{
		acc = A2(f, arr[i], acc);
	}
	return acc;
}

function map2(f, xs, ys)
{
	var arr = [];
	while (xs.ctor !== '[]' && ys.ctor !== '[]')
	{
		arr.push(A2(f, xs._0, ys._0));
		xs = xs._1;
		ys = ys._1;
	}
	return fromArray(arr);
}

function map3(f, xs, ys, zs)
{
	var arr = [];
	while (xs.ctor !== '[]' && ys.ctor !== '[]' && zs.ctor !== '[]')
	{
		arr.push(A3(f, xs._0, ys._0, zs._0));
		xs = xs._1;
		ys = ys._1;
		zs = zs._1;
	}
	return fromArray(arr);
}

function map4(f, ws, xs, ys, zs)
{
	var arr = [];
	while (   ws.ctor !== '[]'
		   && xs.ctor !== '[]'
		   && ys.ctor !== '[]'
		   && zs.ctor !== '[]')
	{
		arr.push(A4(f, ws._0, xs._0, ys._0, zs._0));
		ws = ws._1;
		xs = xs._1;
		ys = ys._1;
		zs = zs._1;
	}
	return fromArray(arr);
}

function map5(f, vs, ws, xs, ys, zs)
{
	var arr = [];
	while (   vs.ctor !== '[]'
		   && ws.ctor !== '[]'
		   && xs.ctor !== '[]'
		   && ys.ctor !== '[]'
		   && zs.ctor !== '[]')
	{
		arr.push(A5(f, vs._0, ws._0, xs._0, ys._0, zs._0));
		vs = vs._1;
		ws = ws._1;
		xs = xs._1;
		ys = ys._1;
		zs = zs._1;
	}
	return fromArray(arr);
}

function sortBy(f, xs)
{
	return fromArray(toArray(xs).sort(function(a, b) {
		return _elm_lang$core$Native_Utils.cmp(f(a), f(b));
	}));
}

function sortWith(f, xs)
{
	return fromArray(toArray(xs).sort(function(a, b) {
		var ord = f(a)(b).ctor;
		return ord === 'EQ' ? 0 : ord === 'LT' ? -1 : 1;
	}));
}

return {
	Nil: Nil,
	Cons: Cons,
	cons: F2(Cons),
	toArray: toArray,
	fromArray: fromArray,

	foldr: F3(foldr),

	map2: F3(map2),
	map3: F4(map3),
	map4: F5(map4),
	map5: F6(map5),
	sortBy: F2(sortBy),
	sortWith: F2(sortWith)
};

}();
var _elm_lang$core$List$sortWith = _elm_lang$core$Native_List.sortWith;
var _elm_lang$core$List$sortBy = _elm_lang$core$Native_List.sortBy;
var _elm_lang$core$List$sort = function (xs) {
	return A2(_elm_lang$core$List$sortBy, _elm_lang$core$Basics$identity, xs);
};
var _elm_lang$core$List$singleton = function (value) {
	return {
		ctor: '::',
		_0: value,
		_1: {ctor: '[]'}
	};
};
var _elm_lang$core$List$drop = F2(
	function (n, list) {
		drop:
		while (true) {
			if (_elm_lang$core$Native_Utils.cmp(n, 0) < 1) {
				return list;
			} else {
				var _p0 = list;
				if (_p0.ctor === '[]') {
					return list;
				} else {
					var _v1 = n - 1,
						_v2 = _p0._1;
					n = _v1;
					list = _v2;
					continue drop;
				}
			}
		}
	});
var _elm_lang$core$List$map5 = _elm_lang$core$Native_List.map5;
var _elm_lang$core$List$map4 = _elm_lang$core$Native_List.map4;
var _elm_lang$core$List$map3 = _elm_lang$core$Native_List.map3;
var _elm_lang$core$List$map2 = _elm_lang$core$Native_List.map2;
var _elm_lang$core$List$any = F2(
	function (isOkay, list) {
		any:
		while (true) {
			var _p1 = list;
			if (_p1.ctor === '[]') {
				return false;
			} else {
				if (isOkay(_p1._0)) {
					return true;
				} else {
					var _v4 = isOkay,
						_v5 = _p1._1;
					isOkay = _v4;
					list = _v5;
					continue any;
				}
			}
		}
	});
var _elm_lang$core$List$all = F2(
	function (isOkay, list) {
		return !A2(
			_elm_lang$core$List$any,
			function (_p2) {
				return !isOkay(_p2);
			},
			list);
	});
var _elm_lang$core$List$foldr = _elm_lang$core$Native_List.foldr;
var _elm_lang$core$List$foldl = F3(
	function (func, acc, list) {
		foldl:
		while (true) {
			var _p3 = list;
			if (_p3.ctor === '[]') {
				return acc;
			} else {
				var _v7 = func,
					_v8 = A2(func, _p3._0, acc),
					_v9 = _p3._1;
				func = _v7;
				acc = _v8;
				list = _v9;
				continue foldl;
			}
		}
	});
var _elm_lang$core$List$length = function (xs) {
	return A3(
		_elm_lang$core$List$foldl,
		F2(
			function (_p4, i) {
				return i + 1;
			}),
		0,
		xs);
};
var _elm_lang$core$List$sum = function (numbers) {
	return A3(
		_elm_lang$core$List$foldl,
		F2(
			function (x, y) {
				return x + y;
			}),
		0,
		numbers);
};
var _elm_lang$core$List$product = function (numbers) {
	return A3(
		_elm_lang$core$List$foldl,
		F2(
			function (x, y) {
				return x * y;
			}),
		1,
		numbers);
};
var _elm_lang$core$List$maximum = function (list) {
	var _p5 = list;
	if (_p5.ctor === '::') {
		return _elm_lang$core$Maybe$Just(
			A3(_elm_lang$core$List$foldl, _elm_lang$core$Basics$max, _p5._0, _p5._1));
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _elm_lang$core$List$minimum = function (list) {
	var _p6 = list;
	if (_p6.ctor === '::') {
		return _elm_lang$core$Maybe$Just(
			A3(_elm_lang$core$List$foldl, _elm_lang$core$Basics$min, _p6._0, _p6._1));
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _elm_lang$core$List$member = F2(
	function (x, xs) {
		return A2(
			_elm_lang$core$List$any,
			function (a) {
				return _elm_lang$core$Native_Utils.eq(a, x);
			},
			xs);
	});
var _elm_lang$core$List$isEmpty = function (xs) {
	var _p7 = xs;
	if (_p7.ctor === '[]') {
		return true;
	} else {
		return false;
	}
};
var _elm_lang$core$List$tail = function (list) {
	var _p8 = list;
	if (_p8.ctor === '::') {
		return _elm_lang$core$Maybe$Just(_p8._1);
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _elm_lang$core$List$head = function (list) {
	var _p9 = list;
	if (_p9.ctor === '::') {
		return _elm_lang$core$Maybe$Just(_p9._0);
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _elm_lang$core$List_ops = _elm_lang$core$List_ops || {};
_elm_lang$core$List_ops['::'] = _elm_lang$core$Native_List.cons;
var _elm_lang$core$List$map = F2(
	function (f, xs) {
		return A3(
			_elm_lang$core$List$foldr,
			F2(
				function (x, acc) {
					return {
						ctor: '::',
						_0: f(x),
						_1: acc
					};
				}),
			{ctor: '[]'},
			xs);
	});
var _elm_lang$core$List$filter = F2(
	function (pred, xs) {
		var conditionalCons = F2(
			function (front, back) {
				return pred(front) ? {ctor: '::', _0: front, _1: back} : back;
			});
		return A3(
			_elm_lang$core$List$foldr,
			conditionalCons,
			{ctor: '[]'},
			xs);
	});
var _elm_lang$core$List$maybeCons = F3(
	function (f, mx, xs) {
		var _p10 = f(mx);
		if (_p10.ctor === 'Just') {
			return {ctor: '::', _0: _p10._0, _1: xs};
		} else {
			return xs;
		}
	});
var _elm_lang$core$List$filterMap = F2(
	function (f, xs) {
		return A3(
			_elm_lang$core$List$foldr,
			_elm_lang$core$List$maybeCons(f),
			{ctor: '[]'},
			xs);
	});
var _elm_lang$core$List$reverse = function (list) {
	return A3(
		_elm_lang$core$List$foldl,
		F2(
			function (x, y) {
				return {ctor: '::', _0: x, _1: y};
			}),
		{ctor: '[]'},
		list);
};
var _elm_lang$core$List$scanl = F3(
	function (f, b, xs) {
		var scan1 = F2(
			function (x, accAcc) {
				var _p11 = accAcc;
				if (_p11.ctor === '::') {
					return {
						ctor: '::',
						_0: A2(f, x, _p11._0),
						_1: accAcc
					};
				} else {
					return {ctor: '[]'};
				}
			});
		return _elm_lang$core$List$reverse(
			A3(
				_elm_lang$core$List$foldl,
				scan1,
				{
					ctor: '::',
					_0: b,
					_1: {ctor: '[]'}
				},
				xs));
	});
var _elm_lang$core$List$append = F2(
	function (xs, ys) {
		var _p12 = ys;
		if (_p12.ctor === '[]') {
			return xs;
		} else {
			return A3(
				_elm_lang$core$List$foldr,
				F2(
					function (x, y) {
						return {ctor: '::', _0: x, _1: y};
					}),
				ys,
				xs);
		}
	});
var _elm_lang$core$List$concat = function (lists) {
	return A3(
		_elm_lang$core$List$foldr,
		_elm_lang$core$List$append,
		{ctor: '[]'},
		lists);
};
var _elm_lang$core$List$concatMap = F2(
	function (f, list) {
		return _elm_lang$core$List$concat(
			A2(_elm_lang$core$List$map, f, list));
	});
var _elm_lang$core$List$partition = F2(
	function (pred, list) {
		var step = F2(
			function (x, _p13) {
				var _p14 = _p13;
				var _p16 = _p14._0;
				var _p15 = _p14._1;
				return pred(x) ? {
					ctor: '_Tuple2',
					_0: {ctor: '::', _0: x, _1: _p16},
					_1: _p15
				} : {
					ctor: '_Tuple2',
					_0: _p16,
					_1: {ctor: '::', _0: x, _1: _p15}
				};
			});
		return A3(
			_elm_lang$core$List$foldr,
			step,
			{
				ctor: '_Tuple2',
				_0: {ctor: '[]'},
				_1: {ctor: '[]'}
			},
			list);
	});
var _elm_lang$core$List$unzip = function (pairs) {
	var step = F2(
		function (_p18, _p17) {
			var _p19 = _p18;
			var _p20 = _p17;
			return {
				ctor: '_Tuple2',
				_0: {ctor: '::', _0: _p19._0, _1: _p20._0},
				_1: {ctor: '::', _0: _p19._1, _1: _p20._1}
			};
		});
	return A3(
		_elm_lang$core$List$foldr,
		step,
		{
			ctor: '_Tuple2',
			_0: {ctor: '[]'},
			_1: {ctor: '[]'}
		},
		pairs);
};
var _elm_lang$core$List$intersperse = F2(
	function (sep, xs) {
		var _p21 = xs;
		if (_p21.ctor === '[]') {
			return {ctor: '[]'};
		} else {
			var step = F2(
				function (x, rest) {
					return {
						ctor: '::',
						_0: sep,
						_1: {ctor: '::', _0: x, _1: rest}
					};
				});
			var spersed = A3(
				_elm_lang$core$List$foldr,
				step,
				{ctor: '[]'},
				_p21._1);
			return {ctor: '::', _0: _p21._0, _1: spersed};
		}
	});
var _elm_lang$core$List$takeReverse = F3(
	function (n, list, taken) {
		takeReverse:
		while (true) {
			if (_elm_lang$core$Native_Utils.cmp(n, 0) < 1) {
				return taken;
			} else {
				var _p22 = list;
				if (_p22.ctor === '[]') {
					return taken;
				} else {
					var _v23 = n - 1,
						_v24 = _p22._1,
						_v25 = {ctor: '::', _0: _p22._0, _1: taken};
					n = _v23;
					list = _v24;
					taken = _v25;
					continue takeReverse;
				}
			}
		}
	});
var _elm_lang$core$List$takeTailRec = F2(
	function (n, list) {
		return _elm_lang$core$List$reverse(
			A3(
				_elm_lang$core$List$takeReverse,
				n,
				list,
				{ctor: '[]'}));
	});
var _elm_lang$core$List$takeFast = F3(
	function (ctr, n, list) {
		if (_elm_lang$core$Native_Utils.cmp(n, 0) < 1) {
			return {ctor: '[]'};
		} else {
			var _p23 = {ctor: '_Tuple2', _0: n, _1: list};
			_v26_5:
			do {
				_v26_1:
				do {
					if (_p23.ctor === '_Tuple2') {
						if (_p23._1.ctor === '[]') {
							return list;
						} else {
							if (_p23._1._1.ctor === '::') {
								switch (_p23._0) {
									case 1:
										break _v26_1;
									case 2:
										return {
											ctor: '::',
											_0: _p23._1._0,
											_1: {
												ctor: '::',
												_0: _p23._1._1._0,
												_1: {ctor: '[]'}
											}
										};
									case 3:
										if (_p23._1._1._1.ctor === '::') {
											return {
												ctor: '::',
												_0: _p23._1._0,
												_1: {
													ctor: '::',
													_0: _p23._1._1._0,
													_1: {
														ctor: '::',
														_0: _p23._1._1._1._0,
														_1: {ctor: '[]'}
													}
												}
											};
										} else {
											break _v26_5;
										}
									default:
										if ((_p23._1._1._1.ctor === '::') && (_p23._1._1._1._1.ctor === '::')) {
											var _p28 = _p23._1._1._1._0;
											var _p27 = _p23._1._1._0;
											var _p26 = _p23._1._0;
											var _p25 = _p23._1._1._1._1._0;
											var _p24 = _p23._1._1._1._1._1;
											return (_elm_lang$core$Native_Utils.cmp(ctr, 1000) > 0) ? {
												ctor: '::',
												_0: _p26,
												_1: {
													ctor: '::',
													_0: _p27,
													_1: {
														ctor: '::',
														_0: _p28,
														_1: {
															ctor: '::',
															_0: _p25,
															_1: A2(_elm_lang$core$List$takeTailRec, n - 4, _p24)
														}
													}
												}
											} : {
												ctor: '::',
												_0: _p26,
												_1: {
													ctor: '::',
													_0: _p27,
													_1: {
														ctor: '::',
														_0: _p28,
														_1: {
															ctor: '::',
															_0: _p25,
															_1: A3(_elm_lang$core$List$takeFast, ctr + 1, n - 4, _p24)
														}
													}
												}
											};
										} else {
											break _v26_5;
										}
								}
							} else {
								if (_p23._0 === 1) {
									break _v26_1;
								} else {
									break _v26_5;
								}
							}
						}
					} else {
						break _v26_5;
					}
				} while(false);
				return {
					ctor: '::',
					_0: _p23._1._0,
					_1: {ctor: '[]'}
				};
			} while(false);
			return list;
		}
	});
var _elm_lang$core$List$take = F2(
	function (n, list) {
		return A3(_elm_lang$core$List$takeFast, 0, n, list);
	});
var _elm_lang$core$List$repeatHelp = F3(
	function (result, n, value) {
		repeatHelp:
		while (true) {
			if (_elm_lang$core$Native_Utils.cmp(n, 0) < 1) {
				return result;
			} else {
				var _v27 = {ctor: '::', _0: value, _1: result},
					_v28 = n - 1,
					_v29 = value;
				result = _v27;
				n = _v28;
				value = _v29;
				continue repeatHelp;
			}
		}
	});
var _elm_lang$core$List$repeat = F2(
	function (n, value) {
		return A3(
			_elm_lang$core$List$repeatHelp,
			{ctor: '[]'},
			n,
			value);
	});
var _elm_lang$core$List$rangeHelp = F3(
	function (lo, hi, list) {
		rangeHelp:
		while (true) {
			if (_elm_lang$core$Native_Utils.cmp(lo, hi) < 1) {
				var _v30 = lo,
					_v31 = hi - 1,
					_v32 = {ctor: '::', _0: hi, _1: list};
				lo = _v30;
				hi = _v31;
				list = _v32;
				continue rangeHelp;
			} else {
				return list;
			}
		}
	});
var _elm_lang$core$List$range = F2(
	function (lo, hi) {
		return A3(
			_elm_lang$core$List$rangeHelp,
			lo,
			hi,
			{ctor: '[]'});
	});
var _elm_lang$core$List$indexedMap = F2(
	function (f, xs) {
		return A3(
			_elm_lang$core$List$map2,
			f,
			A2(
				_elm_lang$core$List$range,
				0,
				_elm_lang$core$List$length(xs) - 1),
			xs);
	});

var _elm_lang$core$Array$append = _elm_lang$core$Native_Array.append;
var _elm_lang$core$Array$length = _elm_lang$core$Native_Array.length;
var _elm_lang$core$Array$isEmpty = function (array) {
	return _elm_lang$core$Native_Utils.eq(
		_elm_lang$core$Array$length(array),
		0);
};
var _elm_lang$core$Array$slice = _elm_lang$core$Native_Array.slice;
var _elm_lang$core$Array$set = _elm_lang$core$Native_Array.set;
var _elm_lang$core$Array$get = F2(
	function (i, array) {
		return ((_elm_lang$core$Native_Utils.cmp(0, i) < 1) && (_elm_lang$core$Native_Utils.cmp(
			i,
			_elm_lang$core$Native_Array.length(array)) < 0)) ? _elm_lang$core$Maybe$Just(
			A2(_elm_lang$core$Native_Array.get, i, array)) : _elm_lang$core$Maybe$Nothing;
	});
var _elm_lang$core$Array$push = _elm_lang$core$Native_Array.push;
var _elm_lang$core$Array$empty = _elm_lang$core$Native_Array.empty;
var _elm_lang$core$Array$filter = F2(
	function (isOkay, arr) {
		var update = F2(
			function (x, xs) {
				return isOkay(x) ? A2(_elm_lang$core$Native_Array.push, x, xs) : xs;
			});
		return A3(_elm_lang$core$Native_Array.foldl, update, _elm_lang$core$Native_Array.empty, arr);
	});
var _elm_lang$core$Array$foldr = _elm_lang$core$Native_Array.foldr;
var _elm_lang$core$Array$foldl = _elm_lang$core$Native_Array.foldl;
var _elm_lang$core$Array$indexedMap = _elm_lang$core$Native_Array.indexedMap;
var _elm_lang$core$Array$map = _elm_lang$core$Native_Array.map;
var _elm_lang$core$Array$toIndexedList = function (array) {
	return A3(
		_elm_lang$core$List$map2,
		F2(
			function (v0, v1) {
				return {ctor: '_Tuple2', _0: v0, _1: v1};
			}),
		A2(
			_elm_lang$core$List$range,
			0,
			_elm_lang$core$Native_Array.length(array) - 1),
		_elm_lang$core$Native_Array.toList(array));
};
var _elm_lang$core$Array$toList = _elm_lang$core$Native_Array.toList;
var _elm_lang$core$Array$fromList = _elm_lang$core$Native_Array.fromList;
var _elm_lang$core$Array$initialize = _elm_lang$core$Native_Array.initialize;
var _elm_lang$core$Array$repeat = F2(
	function (n, e) {
		return A2(
			_elm_lang$core$Array$initialize,
			n,
			_elm_lang$core$Basics$always(e));
	});
var _elm_lang$core$Array$Array = {ctor: 'Array'};

//import Native.Utils //

var _elm_lang$core$Native_Char = function() {

return {
	fromCode: function(c) { return _elm_lang$core$Native_Utils.chr(String.fromCharCode(c)); },
	toCode: function(c) { return c.charCodeAt(0); },
	toUpper: function(c) { return _elm_lang$core$Native_Utils.chr(c.toUpperCase()); },
	toLower: function(c) { return _elm_lang$core$Native_Utils.chr(c.toLowerCase()); },
	toLocaleUpper: function(c) { return _elm_lang$core$Native_Utils.chr(c.toLocaleUpperCase()); },
	toLocaleLower: function(c) { return _elm_lang$core$Native_Utils.chr(c.toLocaleLowerCase()); }
};

}();
var _elm_lang$core$Char$fromCode = _elm_lang$core$Native_Char.fromCode;
var _elm_lang$core$Char$toCode = _elm_lang$core$Native_Char.toCode;
var _elm_lang$core$Char$toLocaleLower = _elm_lang$core$Native_Char.toLocaleLower;
var _elm_lang$core$Char$toLocaleUpper = _elm_lang$core$Native_Char.toLocaleUpper;
var _elm_lang$core$Char$toLower = _elm_lang$core$Native_Char.toLower;
var _elm_lang$core$Char$toUpper = _elm_lang$core$Native_Char.toUpper;
var _elm_lang$core$Char$isBetween = F3(
	function (low, high, $char) {
		var code = _elm_lang$core$Char$toCode($char);
		return (_elm_lang$core$Native_Utils.cmp(
			code,
			_elm_lang$core$Char$toCode(low)) > -1) && (_elm_lang$core$Native_Utils.cmp(
			code,
			_elm_lang$core$Char$toCode(high)) < 1);
	});
var _elm_lang$core$Char$isUpper = A2(
	_elm_lang$core$Char$isBetween,
	_elm_lang$core$Native_Utils.chr('A'),
	_elm_lang$core$Native_Utils.chr('Z'));
var _elm_lang$core$Char$isLower = A2(
	_elm_lang$core$Char$isBetween,
	_elm_lang$core$Native_Utils.chr('a'),
	_elm_lang$core$Native_Utils.chr('z'));
var _elm_lang$core$Char$isDigit = A2(
	_elm_lang$core$Char$isBetween,
	_elm_lang$core$Native_Utils.chr('0'),
	_elm_lang$core$Native_Utils.chr('9'));
var _elm_lang$core$Char$isOctDigit = A2(
	_elm_lang$core$Char$isBetween,
	_elm_lang$core$Native_Utils.chr('0'),
	_elm_lang$core$Native_Utils.chr('7'));
var _elm_lang$core$Char$isHexDigit = function ($char) {
	return _elm_lang$core$Char$isDigit($char) || (A3(
		_elm_lang$core$Char$isBetween,
		_elm_lang$core$Native_Utils.chr('a'),
		_elm_lang$core$Native_Utils.chr('f'),
		$char) || A3(
		_elm_lang$core$Char$isBetween,
		_elm_lang$core$Native_Utils.chr('A'),
		_elm_lang$core$Native_Utils.chr('F'),
		$char));
};

var _elm_lang$core$Color$fmod = F2(
	function (f, n) {
		var integer = _elm_lang$core$Basics$floor(f);
		return (_elm_lang$core$Basics$toFloat(
			A2(_elm_lang$core$Basics_ops['%'], integer, n)) + f) - _elm_lang$core$Basics$toFloat(integer);
	});
var _elm_lang$core$Color$rgbToHsl = F3(
	function (red, green, blue) {
		var b = _elm_lang$core$Basics$toFloat(blue) / 255;
		var g = _elm_lang$core$Basics$toFloat(green) / 255;
		var r = _elm_lang$core$Basics$toFloat(red) / 255;
		var cMax = A2(
			_elm_lang$core$Basics$max,
			A2(_elm_lang$core$Basics$max, r, g),
			b);
		var cMin = A2(
			_elm_lang$core$Basics$min,
			A2(_elm_lang$core$Basics$min, r, g),
			b);
		var c = cMax - cMin;
		var lightness = (cMax + cMin) / 2;
		var saturation = _elm_lang$core$Native_Utils.eq(lightness, 0) ? 0 : (c / (1 - _elm_lang$core$Basics$abs((2 * lightness) - 1)));
		var hue = _elm_lang$core$Basics$degrees(60) * (_elm_lang$core$Native_Utils.eq(cMax, r) ? A2(_elm_lang$core$Color$fmod, (g - b) / c, 6) : (_elm_lang$core$Native_Utils.eq(cMax, g) ? (((b - r) / c) + 2) : (((r - g) / c) + 4)));
		return {ctor: '_Tuple3', _0: hue, _1: saturation, _2: lightness};
	});
var _elm_lang$core$Color$hslToRgb = F3(
	function (hue, saturation, lightness) {
		var normHue = hue / _elm_lang$core$Basics$degrees(60);
		var chroma = (1 - _elm_lang$core$Basics$abs((2 * lightness) - 1)) * saturation;
		var x = chroma * (1 - _elm_lang$core$Basics$abs(
			A2(_elm_lang$core$Color$fmod, normHue, 2) - 1));
		var _p0 = (_elm_lang$core$Native_Utils.cmp(normHue, 0) < 0) ? {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0} : ((_elm_lang$core$Native_Utils.cmp(normHue, 1) < 0) ? {ctor: '_Tuple3', _0: chroma, _1: x, _2: 0} : ((_elm_lang$core$Native_Utils.cmp(normHue, 2) < 0) ? {ctor: '_Tuple3', _0: x, _1: chroma, _2: 0} : ((_elm_lang$core$Native_Utils.cmp(normHue, 3) < 0) ? {ctor: '_Tuple3', _0: 0, _1: chroma, _2: x} : ((_elm_lang$core$Native_Utils.cmp(normHue, 4) < 0) ? {ctor: '_Tuple3', _0: 0, _1: x, _2: chroma} : ((_elm_lang$core$Native_Utils.cmp(normHue, 5) < 0) ? {ctor: '_Tuple3', _0: x, _1: 0, _2: chroma} : ((_elm_lang$core$Native_Utils.cmp(normHue, 6) < 0) ? {ctor: '_Tuple3', _0: chroma, _1: 0, _2: x} : {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0}))))));
		var r = _p0._0;
		var g = _p0._1;
		var b = _p0._2;
		var m = lightness - (chroma / 2);
		return {ctor: '_Tuple3', _0: r + m, _1: g + m, _2: b + m};
	});
var _elm_lang$core$Color$toRgb = function (color) {
	var _p1 = color;
	if (_p1.ctor === 'RGBA') {
		return {red: _p1._0, green: _p1._1, blue: _p1._2, alpha: _p1._3};
	} else {
		var _p2 = A3(_elm_lang$core$Color$hslToRgb, _p1._0, _p1._1, _p1._2);
		var r = _p2._0;
		var g = _p2._1;
		var b = _p2._2;
		return {
			red: _elm_lang$core$Basics$round(255 * r),
			green: _elm_lang$core$Basics$round(255 * g),
			blue: _elm_lang$core$Basics$round(255 * b),
			alpha: _p1._3
		};
	}
};
var _elm_lang$core$Color$toHsl = function (color) {
	var _p3 = color;
	if (_p3.ctor === 'HSLA') {
		return {hue: _p3._0, saturation: _p3._1, lightness: _p3._2, alpha: _p3._3};
	} else {
		var _p4 = A3(_elm_lang$core$Color$rgbToHsl, _p3._0, _p3._1, _p3._2);
		var h = _p4._0;
		var s = _p4._1;
		var l = _p4._2;
		return {hue: h, saturation: s, lightness: l, alpha: _p3._3};
	}
};
var _elm_lang$core$Color$HSLA = F4(
	function (a, b, c, d) {
		return {ctor: 'HSLA', _0: a, _1: b, _2: c, _3: d};
	});
var _elm_lang$core$Color$hsla = F4(
	function (hue, saturation, lightness, alpha) {
		return A4(
			_elm_lang$core$Color$HSLA,
			hue - _elm_lang$core$Basics$turns(
				_elm_lang$core$Basics$toFloat(
					_elm_lang$core$Basics$floor(hue / (2 * _elm_lang$core$Basics$pi)))),
			saturation,
			lightness,
			alpha);
	});
var _elm_lang$core$Color$hsl = F3(
	function (hue, saturation, lightness) {
		return A4(_elm_lang$core$Color$hsla, hue, saturation, lightness, 1);
	});
var _elm_lang$core$Color$complement = function (color) {
	var _p5 = color;
	if (_p5.ctor === 'HSLA') {
		return A4(
			_elm_lang$core$Color$hsla,
			_p5._0 + _elm_lang$core$Basics$degrees(180),
			_p5._1,
			_p5._2,
			_p5._3);
	} else {
		var _p6 = A3(_elm_lang$core$Color$rgbToHsl, _p5._0, _p5._1, _p5._2);
		var h = _p6._0;
		var s = _p6._1;
		var l = _p6._2;
		return A4(
			_elm_lang$core$Color$hsla,
			h + _elm_lang$core$Basics$degrees(180),
			s,
			l,
			_p5._3);
	}
};
var _elm_lang$core$Color$grayscale = function (p) {
	return A4(_elm_lang$core$Color$HSLA, 0, 0, 1 - p, 1);
};
var _elm_lang$core$Color$greyscale = function (p) {
	return A4(_elm_lang$core$Color$HSLA, 0, 0, 1 - p, 1);
};
var _elm_lang$core$Color$RGBA = F4(
	function (a, b, c, d) {
		return {ctor: 'RGBA', _0: a, _1: b, _2: c, _3: d};
	});
var _elm_lang$core$Color$rgba = _elm_lang$core$Color$RGBA;
var _elm_lang$core$Color$rgb = F3(
	function (r, g, b) {
		return A4(_elm_lang$core$Color$RGBA, r, g, b, 1);
	});
var _elm_lang$core$Color$lightRed = A4(_elm_lang$core$Color$RGBA, 239, 41, 41, 1);
var _elm_lang$core$Color$red = A4(_elm_lang$core$Color$RGBA, 204, 0, 0, 1);
var _elm_lang$core$Color$darkRed = A4(_elm_lang$core$Color$RGBA, 164, 0, 0, 1);
var _elm_lang$core$Color$lightOrange = A4(_elm_lang$core$Color$RGBA, 252, 175, 62, 1);
var _elm_lang$core$Color$orange = A4(_elm_lang$core$Color$RGBA, 245, 121, 0, 1);
var _elm_lang$core$Color$darkOrange = A4(_elm_lang$core$Color$RGBA, 206, 92, 0, 1);
var _elm_lang$core$Color$lightYellow = A4(_elm_lang$core$Color$RGBA, 255, 233, 79, 1);
var _elm_lang$core$Color$yellow = A4(_elm_lang$core$Color$RGBA, 237, 212, 0, 1);
var _elm_lang$core$Color$darkYellow = A4(_elm_lang$core$Color$RGBA, 196, 160, 0, 1);
var _elm_lang$core$Color$lightGreen = A4(_elm_lang$core$Color$RGBA, 138, 226, 52, 1);
var _elm_lang$core$Color$green = A4(_elm_lang$core$Color$RGBA, 115, 210, 22, 1);
var _elm_lang$core$Color$darkGreen = A4(_elm_lang$core$Color$RGBA, 78, 154, 6, 1);
var _elm_lang$core$Color$lightBlue = A4(_elm_lang$core$Color$RGBA, 114, 159, 207, 1);
var _elm_lang$core$Color$blue = A4(_elm_lang$core$Color$RGBA, 52, 101, 164, 1);
var _elm_lang$core$Color$darkBlue = A4(_elm_lang$core$Color$RGBA, 32, 74, 135, 1);
var _elm_lang$core$Color$lightPurple = A4(_elm_lang$core$Color$RGBA, 173, 127, 168, 1);
var _elm_lang$core$Color$purple = A4(_elm_lang$core$Color$RGBA, 117, 80, 123, 1);
var _elm_lang$core$Color$darkPurple = A4(_elm_lang$core$Color$RGBA, 92, 53, 102, 1);
var _elm_lang$core$Color$lightBrown = A4(_elm_lang$core$Color$RGBA, 233, 185, 110, 1);
var _elm_lang$core$Color$brown = A4(_elm_lang$core$Color$RGBA, 193, 125, 17, 1);
var _elm_lang$core$Color$darkBrown = A4(_elm_lang$core$Color$RGBA, 143, 89, 2, 1);
var _elm_lang$core$Color$black = A4(_elm_lang$core$Color$RGBA, 0, 0, 0, 1);
var _elm_lang$core$Color$white = A4(_elm_lang$core$Color$RGBA, 255, 255, 255, 1);
var _elm_lang$core$Color$lightGrey = A4(_elm_lang$core$Color$RGBA, 238, 238, 236, 1);
var _elm_lang$core$Color$grey = A4(_elm_lang$core$Color$RGBA, 211, 215, 207, 1);
var _elm_lang$core$Color$darkGrey = A4(_elm_lang$core$Color$RGBA, 186, 189, 182, 1);
var _elm_lang$core$Color$lightGray = A4(_elm_lang$core$Color$RGBA, 238, 238, 236, 1);
var _elm_lang$core$Color$gray = A4(_elm_lang$core$Color$RGBA, 211, 215, 207, 1);
var _elm_lang$core$Color$darkGray = A4(_elm_lang$core$Color$RGBA, 186, 189, 182, 1);
var _elm_lang$core$Color$lightCharcoal = A4(_elm_lang$core$Color$RGBA, 136, 138, 133, 1);
var _elm_lang$core$Color$charcoal = A4(_elm_lang$core$Color$RGBA, 85, 87, 83, 1);
var _elm_lang$core$Color$darkCharcoal = A4(_elm_lang$core$Color$RGBA, 46, 52, 54, 1);
var _elm_lang$core$Color$Radial = F5(
	function (a, b, c, d, e) {
		return {ctor: 'Radial', _0: a, _1: b, _2: c, _3: d, _4: e};
	});
var _elm_lang$core$Color$radial = _elm_lang$core$Color$Radial;
var _elm_lang$core$Color$Linear = F3(
	function (a, b, c) {
		return {ctor: 'Linear', _0: a, _1: b, _2: c};
	});
var _elm_lang$core$Color$linear = _elm_lang$core$Color$Linear;

//import Native.Utils //

var _elm_lang$core$Native_Scheduler = function() {

var MAX_STEPS = 10000;


// TASKS

function succeed(value)
{
	return {
		ctor: '_Task_succeed',
		value: value
	};
}

function fail(error)
{
	return {
		ctor: '_Task_fail',
		value: error
	};
}

function nativeBinding(callback)
{
	return {
		ctor: '_Task_nativeBinding',
		callback: callback,
		cancel: null
	};
}

function andThen(callback, task)
{
	return {
		ctor: '_Task_andThen',
		callback: callback,
		task: task
	};
}

function onError(callback, task)
{
	return {
		ctor: '_Task_onError',
		callback: callback,
		task: task
	};
}

function receive(callback)
{
	return {
		ctor: '_Task_receive',
		callback: callback
	};
}


// PROCESSES

function rawSpawn(task)
{
	var process = {
		ctor: '_Process',
		id: _elm_lang$core$Native_Utils.guid(),
		root: task,
		stack: null,
		mailbox: []
	};

	enqueue(process);

	return process;
}

function spawn(task)
{
	return nativeBinding(function(callback) {
		var process = rawSpawn(task);
		callback(succeed(process));
	});
}

function rawSend(process, msg)
{
	process.mailbox.push(msg);
	enqueue(process);
}

function send(process, msg)
{
	return nativeBinding(function(callback) {
		rawSend(process, msg);
		callback(succeed(_elm_lang$core$Native_Utils.Tuple0));
	});
}

function kill(process)
{
	return nativeBinding(function(callback) {
		var root = process.root;
		if (root.ctor === '_Task_nativeBinding' && root.cancel)
		{
			root.cancel();
		}

		process.root = null;

		callback(succeed(_elm_lang$core$Native_Utils.Tuple0));
	});
}

function sleep(time)
{
	return nativeBinding(function(callback) {
		var id = setTimeout(function() {
			callback(succeed(_elm_lang$core$Native_Utils.Tuple0));
		}, time);

		return function() { clearTimeout(id); };
	});
}


// STEP PROCESSES

function step(numSteps, process)
{
	while (numSteps < MAX_STEPS)
	{
		var ctor = process.root.ctor;

		if (ctor === '_Task_succeed')
		{
			while (process.stack && process.stack.ctor === '_Task_onError')
			{
				process.stack = process.stack.rest;
			}
			if (process.stack === null)
			{
				break;
			}
			process.root = process.stack.callback(process.root.value);
			process.stack = process.stack.rest;
			++numSteps;
			continue;
		}

		if (ctor === '_Task_fail')
		{
			while (process.stack && process.stack.ctor === '_Task_andThen')
			{
				process.stack = process.stack.rest;
			}
			if (process.stack === null)
			{
				break;
			}
			process.root = process.stack.callback(process.root.value);
			process.stack = process.stack.rest;
			++numSteps;
			continue;
		}

		if (ctor === '_Task_andThen')
		{
			process.stack = {
				ctor: '_Task_andThen',
				callback: process.root.callback,
				rest: process.stack
			};
			process.root = process.root.task;
			++numSteps;
			continue;
		}

		if (ctor === '_Task_onError')
		{
			process.stack = {
				ctor: '_Task_onError',
				callback: process.root.callback,
				rest: process.stack
			};
			process.root = process.root.task;
			++numSteps;
			continue;
		}

		if (ctor === '_Task_nativeBinding')
		{
			process.root.cancel = process.root.callback(function(newRoot) {
				process.root = newRoot;
				enqueue(process);
			});

			break;
		}

		if (ctor === '_Task_receive')
		{
			var mailbox = process.mailbox;
			if (mailbox.length === 0)
			{
				break;
			}

			process.root = process.root.callback(mailbox.shift());
			++numSteps;
			continue;
		}

		throw new Error(ctor);
	}

	if (numSteps < MAX_STEPS)
	{
		return numSteps + 1;
	}
	enqueue(process);

	return numSteps;
}


// WORK QUEUE

var working = false;
var workQueue = [];

function enqueue(process)
{
	workQueue.push(process);

	if (!working)
	{
		setTimeout(work, 0);
		working = true;
	}
}

function work()
{
	var numSteps = 0;
	var process;
	while (numSteps < MAX_STEPS && (process = workQueue.shift()))
	{
		if (process.root)
		{
			numSteps = step(numSteps, process);
		}
	}
	if (!process)
	{
		working = false;
		return;
	}
	setTimeout(work, 0);
}


return {
	succeed: succeed,
	fail: fail,
	nativeBinding: nativeBinding,
	andThen: F2(andThen),
	onError: F2(onError),
	receive: receive,

	spawn: spawn,
	kill: kill,
	sleep: sleep,
	send: F2(send),

	rawSpawn: rawSpawn,
	rawSend: rawSend
};

}();
//import //

var _elm_lang$core$Native_Platform = function() {


// PROGRAMS

function program(impl)
{
	return function(flagDecoder)
	{
		return function(object, moduleName)
		{
			object['worker'] = function worker(flags)
			{
				if (typeof flags !== 'undefined')
				{
					throw new Error(
						'The `' + moduleName + '` module does not need flags.\n'
						+ 'Call ' + moduleName + '.worker() with no arguments and you should be all set!'
					);
				}

				return initialize(
					impl.init,
					impl.update,
					impl.subscriptions,
					renderer
				);
			};
		};
	};
}

function programWithFlags(impl)
{
	return function(flagDecoder)
	{
		return function(object, moduleName)
		{
			object['worker'] = function worker(flags)
			{
				if (typeof flagDecoder === 'undefined')
				{
					throw new Error(
						'Are you trying to sneak a Never value into Elm? Trickster!\n'
						+ 'It looks like ' + moduleName + '.main is defined with `programWithFlags` but has type `Program Never`.\n'
						+ 'Use `program` instead if you do not want flags.'
					);
				}

				var result = A2(_elm_lang$core$Native_Json.run, flagDecoder, flags);
				if (result.ctor === 'Err')
				{
					throw new Error(
						moduleName + '.worker(...) was called with an unexpected argument.\n'
						+ 'I tried to convert it to an Elm value, but ran into this problem:\n\n'
						+ result._0
					);
				}

				return initialize(
					impl.init(result._0),
					impl.update,
					impl.subscriptions,
					renderer
				);
			};
		};
	};
}

function renderer(enqueue, _)
{
	return function(_) {};
}


// HTML TO PROGRAM

function htmlToProgram(vnode)
{
	var emptyBag = batch(_elm_lang$core$Native_List.Nil);
	var noChange = _elm_lang$core$Native_Utils.Tuple2(
		_elm_lang$core$Native_Utils.Tuple0,
		emptyBag
	);

	return _elm_lang$virtual_dom$VirtualDom$program({
		init: noChange,
		view: function(model) { return main; },
		update: F2(function(msg, model) { return noChange; }),
		subscriptions: function (model) { return emptyBag; }
	});
}


// INITIALIZE A PROGRAM

function initialize(init, update, subscriptions, renderer)
{
	// ambient state
	var managers = {};
	var updateView;

	// init and update state in main process
	var initApp = _elm_lang$core$Native_Scheduler.nativeBinding(function(callback) {
		var model = init._0;
		updateView = renderer(enqueue, model);
		var cmds = init._1;
		var subs = subscriptions(model);
		dispatchEffects(managers, cmds, subs);
		callback(_elm_lang$core$Native_Scheduler.succeed(model));
	});

	function onMessage(msg, model)
	{
		return _elm_lang$core$Native_Scheduler.nativeBinding(function(callback) {
			var results = A2(update, msg, model);
			model = results._0;
			updateView(model);
			var cmds = results._1;
			var subs = subscriptions(model);
			dispatchEffects(managers, cmds, subs);
			callback(_elm_lang$core$Native_Scheduler.succeed(model));
		});
	}

	var mainProcess = spawnLoop(initApp, onMessage);

	function enqueue(msg)
	{
		_elm_lang$core$Native_Scheduler.rawSend(mainProcess, msg);
	}

	var ports = setupEffects(managers, enqueue);

	return ports ? { ports: ports } : {};
}


// EFFECT MANAGERS

var effectManagers = {};

function setupEffects(managers, callback)
{
	var ports;

	// setup all necessary effect managers
	for (var key in effectManagers)
	{
		var manager = effectManagers[key];

		if (manager.isForeign)
		{
			ports = ports || {};
			ports[key] = manager.tag === 'cmd'
				? setupOutgoingPort(key)
				: setupIncomingPort(key, callback);
		}

		managers[key] = makeManager(manager, callback);
	}

	return ports;
}

function makeManager(info, callback)
{
	var router = {
		main: callback,
		self: undefined
	};

	var tag = info.tag;
	var onEffects = info.onEffects;
	var onSelfMsg = info.onSelfMsg;

	function onMessage(msg, state)
	{
		if (msg.ctor === 'self')
		{
			return A3(onSelfMsg, router, msg._0, state);
		}

		var fx = msg._0;
		switch (tag)
		{
			case 'cmd':
				return A3(onEffects, router, fx.cmds, state);

			case 'sub':
				return A3(onEffects, router, fx.subs, state);

			case 'fx':
				return A4(onEffects, router, fx.cmds, fx.subs, state);
		}
	}

	var process = spawnLoop(info.init, onMessage);
	router.self = process;
	return process;
}

function sendToApp(router, msg)
{
	return _elm_lang$core$Native_Scheduler.nativeBinding(function(callback)
	{
		router.main(msg);
		callback(_elm_lang$core$Native_Scheduler.succeed(_elm_lang$core$Native_Utils.Tuple0));
	});
}

function sendToSelf(router, msg)
{
	return A2(_elm_lang$core$Native_Scheduler.send, router.self, {
		ctor: 'self',
		_0: msg
	});
}


// HELPER for STATEFUL LOOPS

function spawnLoop(init, onMessage)
{
	var andThen = _elm_lang$core$Native_Scheduler.andThen;

	function loop(state)
	{
		var handleMsg = _elm_lang$core$Native_Scheduler.receive(function(msg) {
			return onMessage(msg, state);
		});
		return A2(andThen, loop, handleMsg);
	}

	var task = A2(andThen, loop, init);

	return _elm_lang$core$Native_Scheduler.rawSpawn(task);
}


// BAGS

function leaf(home)
{
	return function(value)
	{
		return {
			type: 'leaf',
			home: home,
			value: value
		};
	};
}

function batch(list)
{
	return {
		type: 'node',
		branches: list
	};
}

function map(tagger, bag)
{
	return {
		type: 'map',
		tagger: tagger,
		tree: bag
	}
}


// PIPE BAGS INTO EFFECT MANAGERS

function dispatchEffects(managers, cmdBag, subBag)
{
	var effectsDict = {};
	gatherEffects(true, cmdBag, effectsDict, null);
	gatherEffects(false, subBag, effectsDict, null);

	for (var home in managers)
	{
		var fx = home in effectsDict
			? effectsDict[home]
			: {
				cmds: _elm_lang$core$Native_List.Nil,
				subs: _elm_lang$core$Native_List.Nil
			};

		_elm_lang$core$Native_Scheduler.rawSend(managers[home], { ctor: 'fx', _0: fx });
	}
}

function gatherEffects(isCmd, bag, effectsDict, taggers)
{
	switch (bag.type)
	{
		case 'leaf':
			var home = bag.home;
			var effect = toEffect(isCmd, home, taggers, bag.value);
			effectsDict[home] = insert(isCmd, effect, effectsDict[home]);
			return;

		case 'node':
			var list = bag.branches;
			while (list.ctor !== '[]')
			{
				gatherEffects(isCmd, list._0, effectsDict, taggers);
				list = list._1;
			}
			return;

		case 'map':
			gatherEffects(isCmd, bag.tree, effectsDict, {
				tagger: bag.tagger,
				rest: taggers
			});
			return;
	}
}

function toEffect(isCmd, home, taggers, value)
{
	function applyTaggers(x)
	{
		var temp = taggers;
		while (temp)
		{
			x = temp.tagger(x);
			temp = temp.rest;
		}
		return x;
	}

	var map = isCmd
		? effectManagers[home].cmdMap
		: effectManagers[home].subMap;

	return A2(map, applyTaggers, value)
}

function insert(isCmd, newEffect, effects)
{
	effects = effects || {
		cmds: _elm_lang$core$Native_List.Nil,
		subs: _elm_lang$core$Native_List.Nil
	};
	if (isCmd)
	{
		effects.cmds = _elm_lang$core$Native_List.Cons(newEffect, effects.cmds);
		return effects;
	}
	effects.subs = _elm_lang$core$Native_List.Cons(newEffect, effects.subs);
	return effects;
}


// PORTS

function checkPortName(name)
{
	if (name in effectManagers)
	{
		throw new Error('There can only be one port named `' + name + '`, but your program has multiple.');
	}
}


// OUTGOING PORTS

function outgoingPort(name, converter)
{
	checkPortName(name);
	effectManagers[name] = {
		tag: 'cmd',
		cmdMap: outgoingPortMap,
		converter: converter,
		isForeign: true
	};
	return leaf(name);
}

var outgoingPortMap = F2(function cmdMap(tagger, value) {
	return value;
});

function setupOutgoingPort(name)
{
	var subs = [];
	var converter = effectManagers[name].converter;

	// CREATE MANAGER

	var init = _elm_lang$core$Native_Scheduler.succeed(null);

	function onEffects(router, cmdList, state)
	{
		while (cmdList.ctor !== '[]')
		{
			// grab a separate reference to subs in case unsubscribe is called
			var currentSubs = subs;
			var value = converter(cmdList._0);
			for (var i = 0; i < currentSubs.length; i++)
			{
				currentSubs[i](value);
			}
			cmdList = cmdList._1;
		}
		return init;
	}

	effectManagers[name].init = init;
	effectManagers[name].onEffects = F3(onEffects);

	// PUBLIC API

	function subscribe(callback)
	{
		subs.push(callback);
	}

	function unsubscribe(callback)
	{
		// copy subs into a new array in case unsubscribe is called within a
		// subscribed callback
		subs = subs.slice();
		var index = subs.indexOf(callback);
		if (index >= 0)
		{
			subs.splice(index, 1);
		}
	}

	return {
		subscribe: subscribe,
		unsubscribe: unsubscribe
	};
}


// INCOMING PORTS

function incomingPort(name, converter)
{
	checkPortName(name);
	effectManagers[name] = {
		tag: 'sub',
		subMap: incomingPortMap,
		converter: converter,
		isForeign: true
	};
	return leaf(name);
}

var incomingPortMap = F2(function subMap(tagger, finalTagger)
{
	return function(value)
	{
		return tagger(finalTagger(value));
	};
});

function setupIncomingPort(name, callback)
{
	var sentBeforeInit = [];
	var subs = _elm_lang$core$Native_List.Nil;
	var converter = effectManagers[name].converter;
	var currentOnEffects = preInitOnEffects;
	var currentSend = preInitSend;

	// CREATE MANAGER

	var init = _elm_lang$core$Native_Scheduler.succeed(null);

	function preInitOnEffects(router, subList, state)
	{
		var postInitResult = postInitOnEffects(router, subList, state);

		for(var i = 0; i < sentBeforeInit.length; i++)
		{
			postInitSend(sentBeforeInit[i]);
		}

		sentBeforeInit = null; // to release objects held in queue
		currentSend = postInitSend;
		currentOnEffects = postInitOnEffects;
		return postInitResult;
	}

	function postInitOnEffects(router, subList, state)
	{
		subs = subList;
		return init;
	}

	function onEffects(router, subList, state)
	{
		return currentOnEffects(router, subList, state);
	}

	effectManagers[name].init = init;
	effectManagers[name].onEffects = F3(onEffects);

	// PUBLIC API

	function preInitSend(value)
	{
		sentBeforeInit.push(value);
	}

	function postInitSend(value)
	{
		var temp = subs;
		while (temp.ctor !== '[]')
		{
			callback(temp._0(value));
			temp = temp._1;
		}
	}

	function send(incomingValue)
	{
		var result = A2(_elm_lang$core$Json_Decode$decodeValue, converter, incomingValue);
		if (result.ctor === 'Err')
		{
			throw new Error('Trying to send an unexpected type of value through port `' + name + '`:\n' + result._0);
		}

		currentSend(result._0);
	}

	return { send: send };
}

return {
	// routers
	sendToApp: F2(sendToApp),
	sendToSelf: F2(sendToSelf),

	// global setup
	effectManagers: effectManagers,
	outgoingPort: outgoingPort,
	incomingPort: incomingPort,

	htmlToProgram: htmlToProgram,
	program: program,
	programWithFlags: programWithFlags,
	initialize: initialize,

	// effect bags
	leaf: leaf,
	batch: batch,
	map: F2(map)
};

}();

var _elm_lang$core$Platform_Cmd$batch = _elm_lang$core$Native_Platform.batch;
var _elm_lang$core$Platform_Cmd$none = _elm_lang$core$Platform_Cmd$batch(
	{ctor: '[]'});
var _elm_lang$core$Platform_Cmd_ops = _elm_lang$core$Platform_Cmd_ops || {};
_elm_lang$core$Platform_Cmd_ops['!'] = F2(
	function (model, commands) {
		return {
			ctor: '_Tuple2',
			_0: model,
			_1: _elm_lang$core$Platform_Cmd$batch(commands)
		};
	});
var _elm_lang$core$Platform_Cmd$map = _elm_lang$core$Native_Platform.map;
var _elm_lang$core$Platform_Cmd$Cmd = {ctor: 'Cmd'};

var _elm_lang$core$Platform_Sub$batch = _elm_lang$core$Native_Platform.batch;
var _elm_lang$core$Platform_Sub$none = _elm_lang$core$Platform_Sub$batch(
	{ctor: '[]'});
var _elm_lang$core$Platform_Sub$map = _elm_lang$core$Native_Platform.map;
var _elm_lang$core$Platform_Sub$Sub = {ctor: 'Sub'};

var _elm_lang$core$Platform$hack = _elm_lang$core$Native_Scheduler.succeed;
var _elm_lang$core$Platform$sendToSelf = _elm_lang$core$Native_Platform.sendToSelf;
var _elm_lang$core$Platform$sendToApp = _elm_lang$core$Native_Platform.sendToApp;
var _elm_lang$core$Platform$programWithFlags = _elm_lang$core$Native_Platform.programWithFlags;
var _elm_lang$core$Platform$program = _elm_lang$core$Native_Platform.program;
var _elm_lang$core$Platform$Program = {ctor: 'Program'};
var _elm_lang$core$Platform$Task = {ctor: 'Task'};
var _elm_lang$core$Platform$ProcessId = {ctor: 'ProcessId'};
var _elm_lang$core$Platform$Router = {ctor: 'Router'};

var _elm_lang$core$Result$toMaybe = function (result) {
	var _p0 = result;
	if (_p0.ctor === 'Ok') {
		return _elm_lang$core$Maybe$Just(_p0._0);
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _elm_lang$core$Result$withDefault = F2(
	function (def, result) {
		var _p1 = result;
		if (_p1.ctor === 'Ok') {
			return _p1._0;
		} else {
			return def;
		}
	});
var _elm_lang$core$Result$Err = function (a) {
	return {ctor: 'Err', _0: a};
};
var _elm_lang$core$Result$andThen = F2(
	function (callback, result) {
		var _p2 = result;
		if (_p2.ctor === 'Ok') {
			return callback(_p2._0);
		} else {
			return _elm_lang$core$Result$Err(_p2._0);
		}
	});
var _elm_lang$core$Result$Ok = function (a) {
	return {ctor: 'Ok', _0: a};
};
var _elm_lang$core$Result$map = F2(
	function (func, ra) {
		var _p3 = ra;
		if (_p3.ctor === 'Ok') {
			return _elm_lang$core$Result$Ok(
				func(_p3._0));
		} else {
			return _elm_lang$core$Result$Err(_p3._0);
		}
	});
var _elm_lang$core$Result$map2 = F3(
	function (func, ra, rb) {
		var _p4 = {ctor: '_Tuple2', _0: ra, _1: rb};
		if (_p4._0.ctor === 'Ok') {
			if (_p4._1.ctor === 'Ok') {
				return _elm_lang$core$Result$Ok(
					A2(func, _p4._0._0, _p4._1._0));
			} else {
				return _elm_lang$core$Result$Err(_p4._1._0);
			}
		} else {
			return _elm_lang$core$Result$Err(_p4._0._0);
		}
	});
var _elm_lang$core$Result$map3 = F4(
	function (func, ra, rb, rc) {
		var _p5 = {ctor: '_Tuple3', _0: ra, _1: rb, _2: rc};
		if (_p5._0.ctor === 'Ok') {
			if (_p5._1.ctor === 'Ok') {
				if (_p5._2.ctor === 'Ok') {
					return _elm_lang$core$Result$Ok(
						A3(func, _p5._0._0, _p5._1._0, _p5._2._0));
				} else {
					return _elm_lang$core$Result$Err(_p5._2._0);
				}
			} else {
				return _elm_lang$core$Result$Err(_p5._1._0);
			}
		} else {
			return _elm_lang$core$Result$Err(_p5._0._0);
		}
	});
var _elm_lang$core$Result$map4 = F5(
	function (func, ra, rb, rc, rd) {
		var _p6 = {ctor: '_Tuple4', _0: ra, _1: rb, _2: rc, _3: rd};
		if (_p6._0.ctor === 'Ok') {
			if (_p6._1.ctor === 'Ok') {
				if (_p6._2.ctor === 'Ok') {
					if (_p6._3.ctor === 'Ok') {
						return _elm_lang$core$Result$Ok(
							A4(func, _p6._0._0, _p6._1._0, _p6._2._0, _p6._3._0));
					} else {
						return _elm_lang$core$Result$Err(_p6._3._0);
					}
				} else {
					return _elm_lang$core$Result$Err(_p6._2._0);
				}
			} else {
				return _elm_lang$core$Result$Err(_p6._1._0);
			}
		} else {
			return _elm_lang$core$Result$Err(_p6._0._0);
		}
	});
var _elm_lang$core$Result$map5 = F6(
	function (func, ra, rb, rc, rd, re) {
		var _p7 = {ctor: '_Tuple5', _0: ra, _1: rb, _2: rc, _3: rd, _4: re};
		if (_p7._0.ctor === 'Ok') {
			if (_p7._1.ctor === 'Ok') {
				if (_p7._2.ctor === 'Ok') {
					if (_p7._3.ctor === 'Ok') {
						if (_p7._4.ctor === 'Ok') {
							return _elm_lang$core$Result$Ok(
								A5(func, _p7._0._0, _p7._1._0, _p7._2._0, _p7._3._0, _p7._4._0));
						} else {
							return _elm_lang$core$Result$Err(_p7._4._0);
						}
					} else {
						return _elm_lang$core$Result$Err(_p7._3._0);
					}
				} else {
					return _elm_lang$core$Result$Err(_p7._2._0);
				}
			} else {
				return _elm_lang$core$Result$Err(_p7._1._0);
			}
		} else {
			return _elm_lang$core$Result$Err(_p7._0._0);
		}
	});
var _elm_lang$core$Result$mapError = F2(
	function (f, result) {
		var _p8 = result;
		if (_p8.ctor === 'Ok') {
			return _elm_lang$core$Result$Ok(_p8._0);
		} else {
			return _elm_lang$core$Result$Err(
				f(_p8._0));
		}
	});
var _elm_lang$core$Result$fromMaybe = F2(
	function (err, maybe) {
		var _p9 = maybe;
		if (_p9.ctor === 'Just') {
			return _elm_lang$core$Result$Ok(_p9._0);
		} else {
			return _elm_lang$core$Result$Err(err);
		}
	});

var _elm_lang$core$Task$onError = _elm_lang$core$Native_Scheduler.onError;
var _elm_lang$core$Task$andThen = _elm_lang$core$Native_Scheduler.andThen;
var _elm_lang$core$Task$spawnCmd = F2(
	function (router, _p0) {
		var _p1 = _p0;
		return _elm_lang$core$Native_Scheduler.spawn(
			A2(
				_elm_lang$core$Task$andThen,
				_elm_lang$core$Platform$sendToApp(router),
				_p1._0));
	});
var _elm_lang$core$Task$fail = _elm_lang$core$Native_Scheduler.fail;
var _elm_lang$core$Task$mapError = F2(
	function (convert, task) {
		return A2(
			_elm_lang$core$Task$onError,
			function (_p2) {
				return _elm_lang$core$Task$fail(
					convert(_p2));
			},
			task);
	});
var _elm_lang$core$Task$succeed = _elm_lang$core$Native_Scheduler.succeed;
var _elm_lang$core$Task$map = F2(
	function (func, taskA) {
		return A2(
			_elm_lang$core$Task$andThen,
			function (a) {
				return _elm_lang$core$Task$succeed(
					func(a));
			},
			taskA);
	});
var _elm_lang$core$Task$map2 = F3(
	function (func, taskA, taskB) {
		return A2(
			_elm_lang$core$Task$andThen,
			function (a) {
				return A2(
					_elm_lang$core$Task$andThen,
					function (b) {
						return _elm_lang$core$Task$succeed(
							A2(func, a, b));
					},
					taskB);
			},
			taskA);
	});
var _elm_lang$core$Task$map3 = F4(
	function (func, taskA, taskB, taskC) {
		return A2(
			_elm_lang$core$Task$andThen,
			function (a) {
				return A2(
					_elm_lang$core$Task$andThen,
					function (b) {
						return A2(
							_elm_lang$core$Task$andThen,
							function (c) {
								return _elm_lang$core$Task$succeed(
									A3(func, a, b, c));
							},
							taskC);
					},
					taskB);
			},
			taskA);
	});
var _elm_lang$core$Task$map4 = F5(
	function (func, taskA, taskB, taskC, taskD) {
		return A2(
			_elm_lang$core$Task$andThen,
			function (a) {
				return A2(
					_elm_lang$core$Task$andThen,
					function (b) {
						return A2(
							_elm_lang$core$Task$andThen,
							function (c) {
								return A2(
									_elm_lang$core$Task$andThen,
									function (d) {
										return _elm_lang$core$Task$succeed(
											A4(func, a, b, c, d));
									},
									taskD);
							},
							taskC);
					},
					taskB);
			},
			taskA);
	});
var _elm_lang$core$Task$map5 = F6(
	function (func, taskA, taskB, taskC, taskD, taskE) {
		return A2(
			_elm_lang$core$Task$andThen,
			function (a) {
				return A2(
					_elm_lang$core$Task$andThen,
					function (b) {
						return A2(
							_elm_lang$core$Task$andThen,
							function (c) {
								return A2(
									_elm_lang$core$Task$andThen,
									function (d) {
										return A2(
											_elm_lang$core$Task$andThen,
											function (e) {
												return _elm_lang$core$Task$succeed(
													A5(func, a, b, c, d, e));
											},
											taskE);
									},
									taskD);
							},
							taskC);
					},
					taskB);
			},
			taskA);
	});
var _elm_lang$core$Task$sequence = function (tasks) {
	var _p3 = tasks;
	if (_p3.ctor === '[]') {
		return _elm_lang$core$Task$succeed(
			{ctor: '[]'});
	} else {
		return A3(
			_elm_lang$core$Task$map2,
			F2(
				function (x, y) {
					return {ctor: '::', _0: x, _1: y};
				}),
			_p3._0,
			_elm_lang$core$Task$sequence(_p3._1));
	}
};
var _elm_lang$core$Task$onEffects = F3(
	function (router, commands, state) {
		return A2(
			_elm_lang$core$Task$map,
			function (_p4) {
				return {ctor: '_Tuple0'};
			},
			_elm_lang$core$Task$sequence(
				A2(
					_elm_lang$core$List$map,
					_elm_lang$core$Task$spawnCmd(router),
					commands)));
	});
var _elm_lang$core$Task$init = _elm_lang$core$Task$succeed(
	{ctor: '_Tuple0'});
var _elm_lang$core$Task$onSelfMsg = F3(
	function (_p7, _p6, _p5) {
		return _elm_lang$core$Task$succeed(
			{ctor: '_Tuple0'});
	});
var _elm_lang$core$Task$command = _elm_lang$core$Native_Platform.leaf('Task');
var _elm_lang$core$Task$Perform = function (a) {
	return {ctor: 'Perform', _0: a};
};
var _elm_lang$core$Task$perform = F2(
	function (toMessage, task) {
		return _elm_lang$core$Task$command(
			_elm_lang$core$Task$Perform(
				A2(_elm_lang$core$Task$map, toMessage, task)));
	});
var _elm_lang$core$Task$attempt = F2(
	function (resultToMessage, task) {
		return _elm_lang$core$Task$command(
			_elm_lang$core$Task$Perform(
				A2(
					_elm_lang$core$Task$onError,
					function (_p8) {
						return _elm_lang$core$Task$succeed(
							resultToMessage(
								_elm_lang$core$Result$Err(_p8)));
					},
					A2(
						_elm_lang$core$Task$andThen,
						function (_p9) {
							return _elm_lang$core$Task$succeed(
								resultToMessage(
									_elm_lang$core$Result$Ok(_p9)));
						},
						task))));
	});
var _elm_lang$core$Task$cmdMap = F2(
	function (tagger, _p10) {
		var _p11 = _p10;
		return _elm_lang$core$Task$Perform(
			A2(_elm_lang$core$Task$map, tagger, _p11._0));
	});
_elm_lang$core$Native_Platform.effectManagers['Task'] = {pkg: 'elm-lang/core', init: _elm_lang$core$Task$init, onEffects: _elm_lang$core$Task$onEffects, onSelfMsg: _elm_lang$core$Task$onSelfMsg, tag: 'cmd', cmdMap: _elm_lang$core$Task$cmdMap};

//import Native.Utils //

var _elm_lang$core$Native_Debug = function() {

function log(tag, value)
{
	var msg = tag + ': ' + _elm_lang$core$Native_Utils.toString(value);
	var process = process || {};
	if (process.stdout)
	{
		process.stdout.write(msg);
	}
	else
	{
		console.log(msg);
	}
	return value;
}

function crash(message)
{
	throw new Error(message);
}

return {
	crash: crash,
	log: F2(log)
};

}();
//import Maybe, Native.List, Native.Utils, Result //

var _elm_lang$core$Native_String = function() {

function isEmpty(str)
{
	return str.length === 0;
}
function cons(chr, str)
{
	return chr + str;
}
function uncons(str)
{
	var hd = str[0];
	if (hd)
	{
		return _elm_lang$core$Maybe$Just(_elm_lang$core$Native_Utils.Tuple2(_elm_lang$core$Native_Utils.chr(hd), str.slice(1)));
	}
	return _elm_lang$core$Maybe$Nothing;
}
function append(a, b)
{
	return a + b;
}
function concat(strs)
{
	return _elm_lang$core$Native_List.toArray(strs).join('');
}
function length(str)
{
	return str.length;
}
function map(f, str)
{
	var out = str.split('');
	for (var i = out.length; i--; )
	{
		out[i] = f(_elm_lang$core$Native_Utils.chr(out[i]));
	}
	return out.join('');
}
function filter(pred, str)
{
	return str.split('').map(_elm_lang$core$Native_Utils.chr).filter(pred).join('');
}
function reverse(str)
{
	return str.split('').reverse().join('');
}
function foldl(f, b, str)
{
	var len = str.length;
	for (var i = 0; i < len; ++i)
	{
		b = A2(f, _elm_lang$core$Native_Utils.chr(str[i]), b);
	}
	return b;
}
function foldr(f, b, str)
{
	for (var i = str.length; i--; )
	{
		b = A2(f, _elm_lang$core$Native_Utils.chr(str[i]), b);
	}
	return b;
}
function split(sep, str)
{
	return _elm_lang$core$Native_List.fromArray(str.split(sep));
}
function join(sep, strs)
{
	return _elm_lang$core$Native_List.toArray(strs).join(sep);
}
function repeat(n, str)
{
	var result = '';
	while (n > 0)
	{
		if (n & 1)
		{
			result += str;
		}
		n >>= 1, str += str;
	}
	return result;
}
function slice(start, end, str)
{
	return str.slice(start, end);
}
function left(n, str)
{
	return n < 1 ? '' : str.slice(0, n);
}
function right(n, str)
{
	return n < 1 ? '' : str.slice(-n);
}
function dropLeft(n, str)
{
	return n < 1 ? str : str.slice(n);
}
function dropRight(n, str)
{
	return n < 1 ? str : str.slice(0, -n);
}
function pad(n, chr, str)
{
	var half = (n - str.length) / 2;
	return repeat(Math.ceil(half), chr) + str + repeat(half | 0, chr);
}
function padRight(n, chr, str)
{
	return str + repeat(n - str.length, chr);
}
function padLeft(n, chr, str)
{
	return repeat(n - str.length, chr) + str;
}

function trim(str)
{
	return str.trim();
}
function trimLeft(str)
{
	return str.replace(/^\s+/, '');
}
function trimRight(str)
{
	return str.replace(/\s+$/, '');
}

function words(str)
{
	return _elm_lang$core$Native_List.fromArray(str.trim().split(/\s+/g));
}
function lines(str)
{
	return _elm_lang$core$Native_List.fromArray(str.split(/\r\n|\r|\n/g));
}

function toUpper(str)
{
	return str.toUpperCase();
}
function toLower(str)
{
	return str.toLowerCase();
}

function any(pred, str)
{
	for (var i = str.length; i--; )
	{
		if (pred(_elm_lang$core$Native_Utils.chr(str[i])))
		{
			return true;
		}
	}
	return false;
}
function all(pred, str)
{
	for (var i = str.length; i--; )
	{
		if (!pred(_elm_lang$core$Native_Utils.chr(str[i])))
		{
			return false;
		}
	}
	return true;
}

function contains(sub, str)
{
	return str.indexOf(sub) > -1;
}
function startsWith(sub, str)
{
	return str.indexOf(sub) === 0;
}
function endsWith(sub, str)
{
	return str.length >= sub.length &&
		str.lastIndexOf(sub) === str.length - sub.length;
}
function indexes(sub, str)
{
	var subLen = sub.length;

	if (subLen < 1)
	{
		return _elm_lang$core$Native_List.Nil;
	}

	var i = 0;
	var is = [];

	while ((i = str.indexOf(sub, i)) > -1)
	{
		is.push(i);
		i = i + subLen;
	}

	return _elm_lang$core$Native_List.fromArray(is);
}


function toInt(s)
{
	var len = s.length;

	// if empty
	if (len === 0)
	{
		return intErr(s);
	}

	// if hex
	var c = s[0];
	if (c === '0' && s[1] === 'x')
	{
		for (var i = 2; i < len; ++i)
		{
			var c = s[i];
			if (('0' <= c && c <= '9') || ('A' <= c && c <= 'F') || ('a' <= c && c <= 'f'))
			{
				continue;
			}
			return intErr(s);
		}
		return _elm_lang$core$Result$Ok(parseInt(s, 16));
	}

	// is decimal
	if (c > '9' || (c < '0' && c !== '-' && c !== '+'))
	{
		return intErr(s);
	}
	for (var i = 1; i < len; ++i)
	{
		var c = s[i];
		if (c < '0' || '9' < c)
		{
			return intErr(s);
		}
	}

	return _elm_lang$core$Result$Ok(parseInt(s, 10));
}

function intErr(s)
{
	return _elm_lang$core$Result$Err("could not convert string '" + s + "' to an Int");
}


function toFloat(s)
{
	// check if it is a hex, octal, or binary number
	if (s.length === 0 || /[\sxbo]/.test(s))
	{
		return floatErr(s);
	}
	var n = +s;
	// faster isNaN check
	return n === n ? _elm_lang$core$Result$Ok(n) : floatErr(s);
}

function floatErr(s)
{
	return _elm_lang$core$Result$Err("could not convert string '" + s + "' to a Float");
}


function toList(str)
{
	return _elm_lang$core$Native_List.fromArray(str.split('').map(_elm_lang$core$Native_Utils.chr));
}
function fromList(chars)
{
	return _elm_lang$core$Native_List.toArray(chars).join('');
}

return {
	isEmpty: isEmpty,
	cons: F2(cons),
	uncons: uncons,
	append: F2(append),
	concat: concat,
	length: length,
	map: F2(map),
	filter: F2(filter),
	reverse: reverse,
	foldl: F3(foldl),
	foldr: F3(foldr),

	split: F2(split),
	join: F2(join),
	repeat: F2(repeat),

	slice: F3(slice),
	left: F2(left),
	right: F2(right),
	dropLeft: F2(dropLeft),
	dropRight: F2(dropRight),

	pad: F3(pad),
	padLeft: F3(padLeft),
	padRight: F3(padRight),

	trim: trim,
	trimLeft: trimLeft,
	trimRight: trimRight,

	words: words,
	lines: lines,

	toUpper: toUpper,
	toLower: toLower,

	any: F2(any),
	all: F2(all),

	contains: F2(contains),
	startsWith: F2(startsWith),
	endsWith: F2(endsWith),
	indexes: F2(indexes),

	toInt: toInt,
	toFloat: toFloat,
	toList: toList,
	fromList: fromList
};

}();

var _elm_lang$core$String$fromList = _elm_lang$core$Native_String.fromList;
var _elm_lang$core$String$toList = _elm_lang$core$Native_String.toList;
var _elm_lang$core$String$toFloat = _elm_lang$core$Native_String.toFloat;
var _elm_lang$core$String$toInt = _elm_lang$core$Native_String.toInt;
var _elm_lang$core$String$indices = _elm_lang$core$Native_String.indexes;
var _elm_lang$core$String$indexes = _elm_lang$core$Native_String.indexes;
var _elm_lang$core$String$endsWith = _elm_lang$core$Native_String.endsWith;
var _elm_lang$core$String$startsWith = _elm_lang$core$Native_String.startsWith;
var _elm_lang$core$String$contains = _elm_lang$core$Native_String.contains;
var _elm_lang$core$String$all = _elm_lang$core$Native_String.all;
var _elm_lang$core$String$any = _elm_lang$core$Native_String.any;
var _elm_lang$core$String$toLower = _elm_lang$core$Native_String.toLower;
var _elm_lang$core$String$toUpper = _elm_lang$core$Native_String.toUpper;
var _elm_lang$core$String$lines = _elm_lang$core$Native_String.lines;
var _elm_lang$core$String$words = _elm_lang$core$Native_String.words;
var _elm_lang$core$String$trimRight = _elm_lang$core$Native_String.trimRight;
var _elm_lang$core$String$trimLeft = _elm_lang$core$Native_String.trimLeft;
var _elm_lang$core$String$trim = _elm_lang$core$Native_String.trim;
var _elm_lang$core$String$padRight = _elm_lang$core$Native_String.padRight;
var _elm_lang$core$String$padLeft = _elm_lang$core$Native_String.padLeft;
var _elm_lang$core$String$pad = _elm_lang$core$Native_String.pad;
var _elm_lang$core$String$dropRight = _elm_lang$core$Native_String.dropRight;
var _elm_lang$core$String$dropLeft = _elm_lang$core$Native_String.dropLeft;
var _elm_lang$core$String$right = _elm_lang$core$Native_String.right;
var _elm_lang$core$String$left = _elm_lang$core$Native_String.left;
var _elm_lang$core$String$slice = _elm_lang$core$Native_String.slice;
var _elm_lang$core$String$repeat = _elm_lang$core$Native_String.repeat;
var _elm_lang$core$String$join = _elm_lang$core$Native_String.join;
var _elm_lang$core$String$split = _elm_lang$core$Native_String.split;
var _elm_lang$core$String$foldr = _elm_lang$core$Native_String.foldr;
var _elm_lang$core$String$foldl = _elm_lang$core$Native_String.foldl;
var _elm_lang$core$String$reverse = _elm_lang$core$Native_String.reverse;
var _elm_lang$core$String$filter = _elm_lang$core$Native_String.filter;
var _elm_lang$core$String$map = _elm_lang$core$Native_String.map;
var _elm_lang$core$String$length = _elm_lang$core$Native_String.length;
var _elm_lang$core$String$concat = _elm_lang$core$Native_String.concat;
var _elm_lang$core$String$append = _elm_lang$core$Native_String.append;
var _elm_lang$core$String$uncons = _elm_lang$core$Native_String.uncons;
var _elm_lang$core$String$cons = _elm_lang$core$Native_String.cons;
var _elm_lang$core$String$fromChar = function ($char) {
	return A2(_elm_lang$core$String$cons, $char, '');
};
var _elm_lang$core$String$isEmpty = _elm_lang$core$Native_String.isEmpty;

var _elm_lang$core$Dict$foldr = F3(
	function (f, acc, t) {
		foldr:
		while (true) {
			var _p0 = t;
			if (_p0.ctor === 'RBEmpty_elm_builtin') {
				return acc;
			} else {
				var _v1 = f,
					_v2 = A3(
					f,
					_p0._1,
					_p0._2,
					A3(_elm_lang$core$Dict$foldr, f, acc, _p0._4)),
					_v3 = _p0._3;
				f = _v1;
				acc = _v2;
				t = _v3;
				continue foldr;
			}
		}
	});
var _elm_lang$core$Dict$keys = function (dict) {
	return A3(
		_elm_lang$core$Dict$foldr,
		F3(
			function (key, value, keyList) {
				return {ctor: '::', _0: key, _1: keyList};
			}),
		{ctor: '[]'},
		dict);
};
var _elm_lang$core$Dict$values = function (dict) {
	return A3(
		_elm_lang$core$Dict$foldr,
		F3(
			function (key, value, valueList) {
				return {ctor: '::', _0: value, _1: valueList};
			}),
		{ctor: '[]'},
		dict);
};
var _elm_lang$core$Dict$toList = function (dict) {
	return A3(
		_elm_lang$core$Dict$foldr,
		F3(
			function (key, value, list) {
				return {
					ctor: '::',
					_0: {ctor: '_Tuple2', _0: key, _1: value},
					_1: list
				};
			}),
		{ctor: '[]'},
		dict);
};
var _elm_lang$core$Dict$foldl = F3(
	function (f, acc, dict) {
		foldl:
		while (true) {
			var _p1 = dict;
			if (_p1.ctor === 'RBEmpty_elm_builtin') {
				return acc;
			} else {
				var _v5 = f,
					_v6 = A3(
					f,
					_p1._1,
					_p1._2,
					A3(_elm_lang$core$Dict$foldl, f, acc, _p1._3)),
					_v7 = _p1._4;
				f = _v5;
				acc = _v6;
				dict = _v7;
				continue foldl;
			}
		}
	});
var _elm_lang$core$Dict$reportRemBug = F4(
	function (msg, c, lgot, rgot) {
		return _elm_lang$core$Native_Debug.crash(
			_elm_lang$core$String$concat(
				{
					ctor: '::',
					_0: 'Internal red-black tree invariant violated, expected ',
					_1: {
						ctor: '::',
						_0: msg,
						_1: {
							ctor: '::',
							_0: ' and got ',
							_1: {
								ctor: '::',
								_0: _elm_lang$core$Basics$toString(c),
								_1: {
									ctor: '::',
									_0: '/',
									_1: {
										ctor: '::',
										_0: lgot,
										_1: {
											ctor: '::',
											_0: '/',
											_1: {
												ctor: '::',
												_0: rgot,
												_1: {
													ctor: '::',
													_0: '\nPlease report this bug to <https://github.com/elm-lang/core/issues>',
													_1: {ctor: '[]'}
												}
											}
										}
									}
								}
							}
						}
					}
				}));
	});
var _elm_lang$core$Dict$isBBlack = function (dict) {
	var _p2 = dict;
	_v8_2:
	do {
		if (_p2.ctor === 'RBNode_elm_builtin') {
			if (_p2._0.ctor === 'BBlack') {
				return true;
			} else {
				break _v8_2;
			}
		} else {
			if (_p2._0.ctor === 'LBBlack') {
				return true;
			} else {
				break _v8_2;
			}
		}
	} while(false);
	return false;
};
var _elm_lang$core$Dict$keyCompare = _elm_lang$core$Native_Basics.compare;
var _elm_lang$core$Dict$merge = F6(
	function (leftStep, bothStep, rightStep, leftDict, rightDict, initialResult) {
		var stepState = F3(
			function (rKey, rValue, _p3) {
				stepState:
				while (true) {
					var _p4 = _p3;
					var _p11 = _p4._1;
					var _p10 = _p4._0;
					var _p5 = _p10;
					if (_p5.ctor === '[]') {
						return {
							ctor: '_Tuple2',
							_0: _p10,
							_1: A3(rightStep, rKey, rValue, _p11)
						};
					} else {
						var _p9 = _p5._1;
						var _p8 = _p5._0._1;
						var _p7 = _p5._0._0;
						var _p6 = A2(_elm_lang$core$Dict$keyCompare, _p7, rKey);
						switch (_p6.ctor) {
							case 'LT':
								var _v12 = rKey,
									_v13 = rValue,
									_v14 = {
									ctor: '_Tuple2',
									_0: _p9,
									_1: A3(leftStep, _p7, _p8, _p11)
								};
								rKey = _v12;
								rValue = _v13;
								_p3 = _v14;
								continue stepState;
							case 'GT':
								return {
									ctor: '_Tuple2',
									_0: _p10,
									_1: A3(rightStep, rKey, rValue, _p11)
								};
							default:
								return {
									ctor: '_Tuple2',
									_0: _p9,
									_1: A4(bothStep, _p7, _p8, rValue, _p11)
								};
						}
					}
				}
			});
		var _p12 = A3(
			_elm_lang$core$Dict$foldl,
			stepState,
			{
				ctor: '_Tuple2',
				_0: _elm_lang$core$Dict$toList(leftDict),
				_1: initialResult
			},
			rightDict);
		var leftovers = _p12._0;
		var intermediateResult = _p12._1;
		return A3(
			_elm_lang$core$List$foldl,
			F2(
				function (_p13, result) {
					var _p14 = _p13;
					return A3(leftStep, _p14._0, _p14._1, result);
				}),
			intermediateResult,
			leftovers);
	});
var _elm_lang$core$Dict$sizeHelp = F2(
	function (n, dict) {
		sizeHelp:
		while (true) {
			var _p15 = dict;
			if (_p15.ctor === 'RBEmpty_elm_builtin') {
				return n;
			} else {
				var _v17 = A2(_elm_lang$core$Dict$sizeHelp, n + 1, _p15._4),
					_v18 = _p15._3;
				n = _v17;
				dict = _v18;
				continue sizeHelp;
			}
		}
	});
var _elm_lang$core$Dict$size = function (dict) {
	return A2(_elm_lang$core$Dict$sizeHelp, 0, dict);
};
var _elm_lang$core$Dict$get = F2(
	function (targetKey, dict) {
		get:
		while (true) {
			var _p16 = dict;
			if (_p16.ctor === 'RBEmpty_elm_builtin') {
				return _elm_lang$core$Maybe$Nothing;
			} else {
				var _p17 = A2(_elm_lang$core$Dict$keyCompare, targetKey, _p16._1);
				switch (_p17.ctor) {
					case 'LT':
						var _v21 = targetKey,
							_v22 = _p16._3;
						targetKey = _v21;
						dict = _v22;
						continue get;
					case 'EQ':
						return _elm_lang$core$Maybe$Just(_p16._2);
					default:
						var _v23 = targetKey,
							_v24 = _p16._4;
						targetKey = _v23;
						dict = _v24;
						continue get;
				}
			}
		}
	});
var _elm_lang$core$Dict$member = F2(
	function (key, dict) {
		var _p18 = A2(_elm_lang$core$Dict$get, key, dict);
		if (_p18.ctor === 'Just') {
			return true;
		} else {
			return false;
		}
	});
var _elm_lang$core$Dict$maxWithDefault = F3(
	function (k, v, r) {
		maxWithDefault:
		while (true) {
			var _p19 = r;
			if (_p19.ctor === 'RBEmpty_elm_builtin') {
				return {ctor: '_Tuple2', _0: k, _1: v};
			} else {
				var _v27 = _p19._1,
					_v28 = _p19._2,
					_v29 = _p19._4;
				k = _v27;
				v = _v28;
				r = _v29;
				continue maxWithDefault;
			}
		}
	});
var _elm_lang$core$Dict$NBlack = {ctor: 'NBlack'};
var _elm_lang$core$Dict$BBlack = {ctor: 'BBlack'};
var _elm_lang$core$Dict$Black = {ctor: 'Black'};
var _elm_lang$core$Dict$blackish = function (t) {
	var _p20 = t;
	if (_p20.ctor === 'RBNode_elm_builtin') {
		var _p21 = _p20._0;
		return _elm_lang$core$Native_Utils.eq(_p21, _elm_lang$core$Dict$Black) || _elm_lang$core$Native_Utils.eq(_p21, _elm_lang$core$Dict$BBlack);
	} else {
		return true;
	}
};
var _elm_lang$core$Dict$Red = {ctor: 'Red'};
var _elm_lang$core$Dict$moreBlack = function (color) {
	var _p22 = color;
	switch (_p22.ctor) {
		case 'Black':
			return _elm_lang$core$Dict$BBlack;
		case 'Red':
			return _elm_lang$core$Dict$Black;
		case 'NBlack':
			return _elm_lang$core$Dict$Red;
		default:
			return _elm_lang$core$Native_Debug.crash('Can\'t make a double black node more black!');
	}
};
var _elm_lang$core$Dict$lessBlack = function (color) {
	var _p23 = color;
	switch (_p23.ctor) {
		case 'BBlack':
			return _elm_lang$core$Dict$Black;
		case 'Black':
			return _elm_lang$core$Dict$Red;
		case 'Red':
			return _elm_lang$core$Dict$NBlack;
		default:
			return _elm_lang$core$Native_Debug.crash('Can\'t make a negative black node less black!');
	}
};
var _elm_lang$core$Dict$LBBlack = {ctor: 'LBBlack'};
var _elm_lang$core$Dict$LBlack = {ctor: 'LBlack'};
var _elm_lang$core$Dict$RBEmpty_elm_builtin = function (a) {
	return {ctor: 'RBEmpty_elm_builtin', _0: a};
};
var _elm_lang$core$Dict$empty = _elm_lang$core$Dict$RBEmpty_elm_builtin(_elm_lang$core$Dict$LBlack);
var _elm_lang$core$Dict$isEmpty = function (dict) {
	return _elm_lang$core$Native_Utils.eq(dict, _elm_lang$core$Dict$empty);
};
var _elm_lang$core$Dict$RBNode_elm_builtin = F5(
	function (a, b, c, d, e) {
		return {ctor: 'RBNode_elm_builtin', _0: a, _1: b, _2: c, _3: d, _4: e};
	});
var _elm_lang$core$Dict$ensureBlackRoot = function (dict) {
	var _p24 = dict;
	if ((_p24.ctor === 'RBNode_elm_builtin') && (_p24._0.ctor === 'Red')) {
		return A5(_elm_lang$core$Dict$RBNode_elm_builtin, _elm_lang$core$Dict$Black, _p24._1, _p24._2, _p24._3, _p24._4);
	} else {
		return dict;
	}
};
var _elm_lang$core$Dict$lessBlackTree = function (dict) {
	var _p25 = dict;
	if (_p25.ctor === 'RBNode_elm_builtin') {
		return A5(
			_elm_lang$core$Dict$RBNode_elm_builtin,
			_elm_lang$core$Dict$lessBlack(_p25._0),
			_p25._1,
			_p25._2,
			_p25._3,
			_p25._4);
	} else {
		return _elm_lang$core$Dict$RBEmpty_elm_builtin(_elm_lang$core$Dict$LBlack);
	}
};
var _elm_lang$core$Dict$balancedTree = function (col) {
	return function (xk) {
		return function (xv) {
			return function (yk) {
				return function (yv) {
					return function (zk) {
						return function (zv) {
							return function (a) {
								return function (b) {
									return function (c) {
										return function (d) {
											return A5(
												_elm_lang$core$Dict$RBNode_elm_builtin,
												_elm_lang$core$Dict$lessBlack(col),
												yk,
												yv,
												A5(_elm_lang$core$Dict$RBNode_elm_builtin, _elm_lang$core$Dict$Black, xk, xv, a, b),
												A5(_elm_lang$core$Dict$RBNode_elm_builtin, _elm_lang$core$Dict$Black, zk, zv, c, d));
										};
									};
								};
							};
						};
					};
				};
			};
		};
	};
};
var _elm_lang$core$Dict$blacken = function (t) {
	var _p26 = t;
	if (_p26.ctor === 'RBEmpty_elm_builtin') {
		return _elm_lang$core$Dict$RBEmpty_elm_builtin(_elm_lang$core$Dict$LBlack);
	} else {
		return A5(_elm_lang$core$Dict$RBNode_elm_builtin, _elm_lang$core$Dict$Black, _p26._1, _p26._2, _p26._3, _p26._4);
	}
};
var _elm_lang$core$Dict$redden = function (t) {
	var _p27 = t;
	if (_p27.ctor === 'RBEmpty_elm_builtin') {
		return _elm_lang$core$Native_Debug.crash('can\'t make a Leaf red');
	} else {
		return A5(_elm_lang$core$Dict$RBNode_elm_builtin, _elm_lang$core$Dict$Red, _p27._1, _p27._2, _p27._3, _p27._4);
	}
};
var _elm_lang$core$Dict$balanceHelp = function (tree) {
	var _p28 = tree;
	_v37_6:
	do {
		_v37_5:
		do {
			_v37_4:
			do {
				_v37_3:
				do {
					_v37_2:
					do {
						_v37_1:
						do {
							_v37_0:
							do {
								if (_p28.ctor === 'RBNode_elm_builtin') {
									if (_p28._3.ctor === 'RBNode_elm_builtin') {
										if (_p28._4.ctor === 'RBNode_elm_builtin') {
											switch (_p28._3._0.ctor) {
												case 'Red':
													switch (_p28._4._0.ctor) {
														case 'Red':
															if ((_p28._3._3.ctor === 'RBNode_elm_builtin') && (_p28._3._3._0.ctor === 'Red')) {
																break _v37_0;
															} else {
																if ((_p28._3._4.ctor === 'RBNode_elm_builtin') && (_p28._3._4._0.ctor === 'Red')) {
																	break _v37_1;
																} else {
																	if ((_p28._4._3.ctor === 'RBNode_elm_builtin') && (_p28._4._3._0.ctor === 'Red')) {
																		break _v37_2;
																	} else {
																		if ((_p28._4._4.ctor === 'RBNode_elm_builtin') && (_p28._4._4._0.ctor === 'Red')) {
																			break _v37_3;
																		} else {
																			break _v37_6;
																		}
																	}
																}
															}
														case 'NBlack':
															if ((_p28._3._3.ctor === 'RBNode_elm_builtin') && (_p28._3._3._0.ctor === 'Red')) {
																break _v37_0;
															} else {
																if ((_p28._3._4.ctor === 'RBNode_elm_builtin') && (_p28._3._4._0.ctor === 'Red')) {
																	break _v37_1;
																} else {
																	if (((((_p28._0.ctor === 'BBlack') && (_p28._4._3.ctor === 'RBNode_elm_builtin')) && (_p28._4._3._0.ctor === 'Black')) && (_p28._4._4.ctor === 'RBNode_elm_builtin')) && (_p28._4._4._0.ctor === 'Black')) {
																		break _v37_4;
																	} else {
																		break _v37_6;
																	}
																}
															}
														default:
															if ((_p28._3._3.ctor === 'RBNode_elm_builtin') && (_p28._3._3._0.ctor === 'Red')) {
																break _v37_0;
															} else {
																if ((_p28._3._4.ctor === 'RBNode_elm_builtin') && (_p28._3._4._0.ctor === 'Red')) {
																	break _v37_1;
																} else {
																	break _v37_6;
																}
															}
													}
												case 'NBlack':
													switch (_p28._4._0.ctor) {
														case 'Red':
															if ((_p28._4._3.ctor === 'RBNode_elm_builtin') && (_p28._4._3._0.ctor === 'Red')) {
																break _v37_2;
															} else {
																if ((_p28._4._4.ctor === 'RBNode_elm_builtin') && (_p28._4._4._0.ctor === 'Red')) {
																	break _v37_3;
																} else {
																	if (((((_p28._0.ctor === 'BBlack') && (_p28._3._3.ctor === 'RBNode_elm_builtin')) && (_p28._3._3._0.ctor === 'Black')) && (_p28._3._4.ctor === 'RBNode_elm_builtin')) && (_p28._3._4._0.ctor === 'Black')) {
																		break _v37_5;
																	} else {
																		break _v37_6;
																	}
																}
															}
														case 'NBlack':
															if (_p28._0.ctor === 'BBlack') {
																if ((((_p28._4._3.ctor === 'RBNode_elm_builtin') && (_p28._4._3._0.ctor === 'Black')) && (_p28._4._4.ctor === 'RBNode_elm_builtin')) && (_p28._4._4._0.ctor === 'Black')) {
																	break _v37_4;
																} else {
																	if ((((_p28._3._3.ctor === 'RBNode_elm_builtin') && (_p28._3._3._0.ctor === 'Black')) && (_p28._3._4.ctor === 'RBNode_elm_builtin')) && (_p28._3._4._0.ctor === 'Black')) {
																		break _v37_5;
																	} else {
																		break _v37_6;
																	}
																}
															} else {
																break _v37_6;
															}
														default:
															if (((((_p28._0.ctor === 'BBlack') && (_p28._3._3.ctor === 'RBNode_elm_builtin')) && (_p28._3._3._0.ctor === 'Black')) && (_p28._3._4.ctor === 'RBNode_elm_builtin')) && (_p28._3._4._0.ctor === 'Black')) {
																break _v37_5;
															} else {
																break _v37_6;
															}
													}
												default:
													switch (_p28._4._0.ctor) {
														case 'Red':
															if ((_p28._4._3.ctor === 'RBNode_elm_builtin') && (_p28._4._3._0.ctor === 'Red')) {
																break _v37_2;
															} else {
																if ((_p28._4._4.ctor === 'RBNode_elm_builtin') && (_p28._4._4._0.ctor === 'Red')) {
																	break _v37_3;
																} else {
																	break _v37_6;
																}
															}
														case 'NBlack':
															if (((((_p28._0.ctor === 'BBlack') && (_p28._4._3.ctor === 'RBNode_elm_builtin')) && (_p28._4._3._0.ctor === 'Black')) && (_p28._4._4.ctor === 'RBNode_elm_builtin')) && (_p28._4._4._0.ctor === 'Black')) {
																break _v37_4;
															} else {
																break _v37_6;
															}
														default:
															break _v37_6;
													}
											}
										} else {
											switch (_p28._3._0.ctor) {
												case 'Red':
													if ((_p28._3._3.ctor === 'RBNode_elm_builtin') && (_p28._3._3._0.ctor === 'Red')) {
														break _v37_0;
													} else {
														if ((_p28._3._4.ctor === 'RBNode_elm_builtin') && (_p28._3._4._0.ctor === 'Red')) {
															break _v37_1;
														} else {
															break _v37_6;
														}
													}
												case 'NBlack':
													if (((((_p28._0.ctor === 'BBlack') && (_p28._3._3.ctor === 'RBNode_elm_builtin')) && (_p28._3._3._0.ctor === 'Black')) && (_p28._3._4.ctor === 'RBNode_elm_builtin')) && (_p28._3._4._0.ctor === 'Black')) {
														break _v37_5;
													} else {
														break _v37_6;
													}
												default:
													break _v37_6;
											}
										}
									} else {
										if (_p28._4.ctor === 'RBNode_elm_builtin') {
											switch (_p28._4._0.ctor) {
												case 'Red':
													if ((_p28._4._3.ctor === 'RBNode_elm_builtin') && (_p28._4._3._0.ctor === 'Red')) {
														break _v37_2;
													} else {
														if ((_p28._4._4.ctor === 'RBNode_elm_builtin') && (_p28._4._4._0.ctor === 'Red')) {
															break _v37_3;
														} else {
															break _v37_6;
														}
													}
												case 'NBlack':
													if (((((_p28._0.ctor === 'BBlack') && (_p28._4._3.ctor === 'RBNode_elm_builtin')) && (_p28._4._3._0.ctor === 'Black')) && (_p28._4._4.ctor === 'RBNode_elm_builtin')) && (_p28._4._4._0.ctor === 'Black')) {
														break _v37_4;
													} else {
														break _v37_6;
													}
												default:
													break _v37_6;
											}
										} else {
											break _v37_6;
										}
									}
								} else {
									break _v37_6;
								}
							} while(false);
							return _elm_lang$core$Dict$balancedTree(_p28._0)(_p28._3._3._1)(_p28._3._3._2)(_p28._3._1)(_p28._3._2)(_p28._1)(_p28._2)(_p28._3._3._3)(_p28._3._3._4)(_p28._3._4)(_p28._4);
						} while(false);
						return _elm_lang$core$Dict$balancedTree(_p28._0)(_p28._3._1)(_p28._3._2)(_p28._3._4._1)(_p28._3._4._2)(_p28._1)(_p28._2)(_p28._3._3)(_p28._3._4._3)(_p28._3._4._4)(_p28._4);
					} while(false);
					return _elm_lang$core$Dict$balancedTree(_p28._0)(_p28._1)(_p28._2)(_p28._4._3._1)(_p28._4._3._2)(_p28._4._1)(_p28._4._2)(_p28._3)(_p28._4._3._3)(_p28._4._3._4)(_p28._4._4);
				} while(false);
				return _elm_lang$core$Dict$balancedTree(_p28._0)(_p28._1)(_p28._2)(_p28._4._1)(_p28._4._2)(_p28._4._4._1)(_p28._4._4._2)(_p28._3)(_p28._4._3)(_p28._4._4._3)(_p28._4._4._4);
			} while(false);
			return A5(
				_elm_lang$core$Dict$RBNode_elm_builtin,
				_elm_lang$core$Dict$Black,
				_p28._4._3._1,
				_p28._4._3._2,
				A5(_elm_lang$core$Dict$RBNode_elm_builtin, _elm_lang$core$Dict$Black, _p28._1, _p28._2, _p28._3, _p28._4._3._3),
				A5(
					_elm_lang$core$Dict$balance,
					_elm_lang$core$Dict$Black,
					_p28._4._1,
					_p28._4._2,
					_p28._4._3._4,
					_elm_lang$core$Dict$redden(_p28._4._4)));
		} while(false);
		return A5(
			_elm_lang$core$Dict$RBNode_elm_builtin,
			_elm_lang$core$Dict$Black,
			_p28._3._4._1,
			_p28._3._4._2,
			A5(
				_elm_lang$core$Dict$balance,
				_elm_lang$core$Dict$Black,
				_p28._3._1,
				_p28._3._2,
				_elm_lang$core$Dict$redden(_p28._3._3),
				_p28._3._4._3),
			A5(_elm_lang$core$Dict$RBNode_elm_builtin, _elm_lang$core$Dict$Black, _p28._1, _p28._2, _p28._3._4._4, _p28._4));
	} while(false);
	return tree;
};
var _elm_lang$core$Dict$balance = F5(
	function (c, k, v, l, r) {
		var tree = A5(_elm_lang$core$Dict$RBNode_elm_builtin, c, k, v, l, r);
		return _elm_lang$core$Dict$blackish(tree) ? _elm_lang$core$Dict$balanceHelp(tree) : tree;
	});
var _elm_lang$core$Dict$bubble = F5(
	function (c, k, v, l, r) {
		return (_elm_lang$core$Dict$isBBlack(l) || _elm_lang$core$Dict$isBBlack(r)) ? A5(
			_elm_lang$core$Dict$balance,
			_elm_lang$core$Dict$moreBlack(c),
			k,
			v,
			_elm_lang$core$Dict$lessBlackTree(l),
			_elm_lang$core$Dict$lessBlackTree(r)) : A5(_elm_lang$core$Dict$RBNode_elm_builtin, c, k, v, l, r);
	});
var _elm_lang$core$Dict$removeMax = F5(
	function (c, k, v, l, r) {
		var _p29 = r;
		if (_p29.ctor === 'RBEmpty_elm_builtin') {
			return A3(_elm_lang$core$Dict$rem, c, l, r);
		} else {
			return A5(
				_elm_lang$core$Dict$bubble,
				c,
				k,
				v,
				l,
				A5(_elm_lang$core$Dict$removeMax, _p29._0, _p29._1, _p29._2, _p29._3, _p29._4));
		}
	});
var _elm_lang$core$Dict$rem = F3(
	function (color, left, right) {
		var _p30 = {ctor: '_Tuple2', _0: left, _1: right};
		if (_p30._0.ctor === 'RBEmpty_elm_builtin') {
			if (_p30._1.ctor === 'RBEmpty_elm_builtin') {
				var _p31 = color;
				switch (_p31.ctor) {
					case 'Red':
						return _elm_lang$core$Dict$RBEmpty_elm_builtin(_elm_lang$core$Dict$LBlack);
					case 'Black':
						return _elm_lang$core$Dict$RBEmpty_elm_builtin(_elm_lang$core$Dict$LBBlack);
					default:
						return _elm_lang$core$Native_Debug.crash('cannot have bblack or nblack nodes at this point');
				}
			} else {
				var _p34 = _p30._1._0;
				var _p33 = _p30._0._0;
				var _p32 = {ctor: '_Tuple3', _0: color, _1: _p33, _2: _p34};
				if ((((_p32.ctor === '_Tuple3') && (_p32._0.ctor === 'Black')) && (_p32._1.ctor === 'LBlack')) && (_p32._2.ctor === 'Red')) {
					return A5(_elm_lang$core$Dict$RBNode_elm_builtin, _elm_lang$core$Dict$Black, _p30._1._1, _p30._1._2, _p30._1._3, _p30._1._4);
				} else {
					return A4(
						_elm_lang$core$Dict$reportRemBug,
						'Black/LBlack/Red',
						color,
						_elm_lang$core$Basics$toString(_p33),
						_elm_lang$core$Basics$toString(_p34));
				}
			}
		} else {
			if (_p30._1.ctor === 'RBEmpty_elm_builtin') {
				var _p37 = _p30._1._0;
				var _p36 = _p30._0._0;
				var _p35 = {ctor: '_Tuple3', _0: color, _1: _p36, _2: _p37};
				if ((((_p35.ctor === '_Tuple3') && (_p35._0.ctor === 'Black')) && (_p35._1.ctor === 'Red')) && (_p35._2.ctor === 'LBlack')) {
					return A5(_elm_lang$core$Dict$RBNode_elm_builtin, _elm_lang$core$Dict$Black, _p30._0._1, _p30._0._2, _p30._0._3, _p30._0._4);
				} else {
					return A4(
						_elm_lang$core$Dict$reportRemBug,
						'Black/Red/LBlack',
						color,
						_elm_lang$core$Basics$toString(_p36),
						_elm_lang$core$Basics$toString(_p37));
				}
			} else {
				var _p41 = _p30._0._2;
				var _p40 = _p30._0._4;
				var _p39 = _p30._0._1;
				var newLeft = A5(_elm_lang$core$Dict$removeMax, _p30._0._0, _p39, _p41, _p30._0._3, _p40);
				var _p38 = A3(_elm_lang$core$Dict$maxWithDefault, _p39, _p41, _p40);
				var k = _p38._0;
				var v = _p38._1;
				return A5(_elm_lang$core$Dict$bubble, color, k, v, newLeft, right);
			}
		}
	});
var _elm_lang$core$Dict$map = F2(
	function (f, dict) {
		var _p42 = dict;
		if (_p42.ctor === 'RBEmpty_elm_builtin') {
			return _elm_lang$core$Dict$RBEmpty_elm_builtin(_elm_lang$core$Dict$LBlack);
		} else {
			var _p43 = _p42._1;
			return A5(
				_elm_lang$core$Dict$RBNode_elm_builtin,
				_p42._0,
				_p43,
				A2(f, _p43, _p42._2),
				A2(_elm_lang$core$Dict$map, f, _p42._3),
				A2(_elm_lang$core$Dict$map, f, _p42._4));
		}
	});
var _elm_lang$core$Dict$Same = {ctor: 'Same'};
var _elm_lang$core$Dict$Remove = {ctor: 'Remove'};
var _elm_lang$core$Dict$Insert = {ctor: 'Insert'};
var _elm_lang$core$Dict$update = F3(
	function (k, alter, dict) {
		var up = function (dict) {
			var _p44 = dict;
			if (_p44.ctor === 'RBEmpty_elm_builtin') {
				var _p45 = alter(_elm_lang$core$Maybe$Nothing);
				if (_p45.ctor === 'Nothing') {
					return {ctor: '_Tuple2', _0: _elm_lang$core$Dict$Same, _1: _elm_lang$core$Dict$empty};
				} else {
					return {
						ctor: '_Tuple2',
						_0: _elm_lang$core$Dict$Insert,
						_1: A5(_elm_lang$core$Dict$RBNode_elm_builtin, _elm_lang$core$Dict$Red, k, _p45._0, _elm_lang$core$Dict$empty, _elm_lang$core$Dict$empty)
					};
				}
			} else {
				var _p56 = _p44._2;
				var _p55 = _p44._4;
				var _p54 = _p44._3;
				var _p53 = _p44._1;
				var _p52 = _p44._0;
				var _p46 = A2(_elm_lang$core$Dict$keyCompare, k, _p53);
				switch (_p46.ctor) {
					case 'EQ':
						var _p47 = alter(
							_elm_lang$core$Maybe$Just(_p56));
						if (_p47.ctor === 'Nothing') {
							return {
								ctor: '_Tuple2',
								_0: _elm_lang$core$Dict$Remove,
								_1: A3(_elm_lang$core$Dict$rem, _p52, _p54, _p55)
							};
						} else {
							return {
								ctor: '_Tuple2',
								_0: _elm_lang$core$Dict$Same,
								_1: A5(_elm_lang$core$Dict$RBNode_elm_builtin, _p52, _p53, _p47._0, _p54, _p55)
							};
						}
					case 'LT':
						var _p48 = up(_p54);
						var flag = _p48._0;
						var newLeft = _p48._1;
						var _p49 = flag;
						switch (_p49.ctor) {
							case 'Same':
								return {
									ctor: '_Tuple2',
									_0: _elm_lang$core$Dict$Same,
									_1: A5(_elm_lang$core$Dict$RBNode_elm_builtin, _p52, _p53, _p56, newLeft, _p55)
								};
							case 'Insert':
								return {
									ctor: '_Tuple2',
									_0: _elm_lang$core$Dict$Insert,
									_1: A5(_elm_lang$core$Dict$balance, _p52, _p53, _p56, newLeft, _p55)
								};
							default:
								return {
									ctor: '_Tuple2',
									_0: _elm_lang$core$Dict$Remove,
									_1: A5(_elm_lang$core$Dict$bubble, _p52, _p53, _p56, newLeft, _p55)
								};
						}
					default:
						var _p50 = up(_p55);
						var flag = _p50._0;
						var newRight = _p50._1;
						var _p51 = flag;
						switch (_p51.ctor) {
							case 'Same':
								return {
									ctor: '_Tuple2',
									_0: _elm_lang$core$Dict$Same,
									_1: A5(_elm_lang$core$Dict$RBNode_elm_builtin, _p52, _p53, _p56, _p54, newRight)
								};
							case 'Insert':
								return {
									ctor: '_Tuple2',
									_0: _elm_lang$core$Dict$Insert,
									_1: A5(_elm_lang$core$Dict$balance, _p52, _p53, _p56, _p54, newRight)
								};
							default:
								return {
									ctor: '_Tuple2',
									_0: _elm_lang$core$Dict$Remove,
									_1: A5(_elm_lang$core$Dict$bubble, _p52, _p53, _p56, _p54, newRight)
								};
						}
				}
			}
		};
		var _p57 = up(dict);
		var flag = _p57._0;
		var updatedDict = _p57._1;
		var _p58 = flag;
		switch (_p58.ctor) {
			case 'Same':
				return updatedDict;
			case 'Insert':
				return _elm_lang$core$Dict$ensureBlackRoot(updatedDict);
			default:
				return _elm_lang$core$Dict$blacken(updatedDict);
		}
	});
var _elm_lang$core$Dict$insert = F3(
	function (key, value, dict) {
		return A3(
			_elm_lang$core$Dict$update,
			key,
			_elm_lang$core$Basics$always(
				_elm_lang$core$Maybe$Just(value)),
			dict);
	});
var _elm_lang$core$Dict$singleton = F2(
	function (key, value) {
		return A3(_elm_lang$core$Dict$insert, key, value, _elm_lang$core$Dict$empty);
	});
var _elm_lang$core$Dict$union = F2(
	function (t1, t2) {
		return A3(_elm_lang$core$Dict$foldl, _elm_lang$core$Dict$insert, t2, t1);
	});
var _elm_lang$core$Dict$filter = F2(
	function (predicate, dictionary) {
		var add = F3(
			function (key, value, dict) {
				return A2(predicate, key, value) ? A3(_elm_lang$core$Dict$insert, key, value, dict) : dict;
			});
		return A3(_elm_lang$core$Dict$foldl, add, _elm_lang$core$Dict$empty, dictionary);
	});
var _elm_lang$core$Dict$intersect = F2(
	function (t1, t2) {
		return A2(
			_elm_lang$core$Dict$filter,
			F2(
				function (k, _p59) {
					return A2(_elm_lang$core$Dict$member, k, t2);
				}),
			t1);
	});
var _elm_lang$core$Dict$partition = F2(
	function (predicate, dict) {
		var add = F3(
			function (key, value, _p60) {
				var _p61 = _p60;
				var _p63 = _p61._1;
				var _p62 = _p61._0;
				return A2(predicate, key, value) ? {
					ctor: '_Tuple2',
					_0: A3(_elm_lang$core$Dict$insert, key, value, _p62),
					_1: _p63
				} : {
					ctor: '_Tuple2',
					_0: _p62,
					_1: A3(_elm_lang$core$Dict$insert, key, value, _p63)
				};
			});
		return A3(
			_elm_lang$core$Dict$foldl,
			add,
			{ctor: '_Tuple2', _0: _elm_lang$core$Dict$empty, _1: _elm_lang$core$Dict$empty},
			dict);
	});
var _elm_lang$core$Dict$fromList = function (assocs) {
	return A3(
		_elm_lang$core$List$foldl,
		F2(
			function (_p64, dict) {
				var _p65 = _p64;
				return A3(_elm_lang$core$Dict$insert, _p65._0, _p65._1, dict);
			}),
		_elm_lang$core$Dict$empty,
		assocs);
};
var _elm_lang$core$Dict$remove = F2(
	function (key, dict) {
		return A3(
			_elm_lang$core$Dict$update,
			key,
			_elm_lang$core$Basics$always(_elm_lang$core$Maybe$Nothing),
			dict);
	});
var _elm_lang$core$Dict$diff = F2(
	function (t1, t2) {
		return A3(
			_elm_lang$core$Dict$foldl,
			F3(
				function (k, v, t) {
					return A2(_elm_lang$core$Dict$remove, k, t);
				}),
			t1,
			t2);
	});

//import Native.Scheduler //

var _elm_lang$core$Native_Time = function() {

var now = _elm_lang$core$Native_Scheduler.nativeBinding(function(callback)
{
	callback(_elm_lang$core$Native_Scheduler.succeed(Date.now()));
});

function setInterval_(interval, task)
{
	return _elm_lang$core$Native_Scheduler.nativeBinding(function(callback)
	{
		var id = setInterval(function() {
			_elm_lang$core$Native_Scheduler.rawSpawn(task);
		}, interval);

		return function() { clearInterval(id); };
	});
}

return {
	now: now,
	setInterval_: F2(setInterval_)
};

}();
var _elm_lang$core$Time$setInterval = _elm_lang$core$Native_Time.setInterval_;
var _elm_lang$core$Time$spawnHelp = F3(
	function (router, intervals, processes) {
		var _p0 = intervals;
		if (_p0.ctor === '[]') {
			return _elm_lang$core$Task$succeed(processes);
		} else {
			var _p1 = _p0._0;
			var spawnRest = function (id) {
				return A3(
					_elm_lang$core$Time$spawnHelp,
					router,
					_p0._1,
					A3(_elm_lang$core$Dict$insert, _p1, id, processes));
			};
			var spawnTimer = _elm_lang$core$Native_Scheduler.spawn(
				A2(
					_elm_lang$core$Time$setInterval,
					_p1,
					A2(_elm_lang$core$Platform$sendToSelf, router, _p1)));
			return A2(_elm_lang$core$Task$andThen, spawnRest, spawnTimer);
		}
	});
var _elm_lang$core$Time$addMySub = F2(
	function (_p2, state) {
		var _p3 = _p2;
		var _p6 = _p3._1;
		var _p5 = _p3._0;
		var _p4 = A2(_elm_lang$core$Dict$get, _p5, state);
		if (_p4.ctor === 'Nothing') {
			return A3(
				_elm_lang$core$Dict$insert,
				_p5,
				{
					ctor: '::',
					_0: _p6,
					_1: {ctor: '[]'}
				},
				state);
		} else {
			return A3(
				_elm_lang$core$Dict$insert,
				_p5,
				{ctor: '::', _0: _p6, _1: _p4._0},
				state);
		}
	});
var _elm_lang$core$Time$inMilliseconds = function (t) {
	return t;
};
var _elm_lang$core$Time$millisecond = 1;
var _elm_lang$core$Time$second = 1000 * _elm_lang$core$Time$millisecond;
var _elm_lang$core$Time$minute = 60 * _elm_lang$core$Time$second;
var _elm_lang$core$Time$hour = 60 * _elm_lang$core$Time$minute;
var _elm_lang$core$Time$inHours = function (t) {
	return t / _elm_lang$core$Time$hour;
};
var _elm_lang$core$Time$inMinutes = function (t) {
	return t / _elm_lang$core$Time$minute;
};
var _elm_lang$core$Time$inSeconds = function (t) {
	return t / _elm_lang$core$Time$second;
};
var _elm_lang$core$Time$now = _elm_lang$core$Native_Time.now;
var _elm_lang$core$Time$onSelfMsg = F3(
	function (router, interval, state) {
		var _p7 = A2(_elm_lang$core$Dict$get, interval, state.taggers);
		if (_p7.ctor === 'Nothing') {
			return _elm_lang$core$Task$succeed(state);
		} else {
			var tellTaggers = function (time) {
				return _elm_lang$core$Task$sequence(
					A2(
						_elm_lang$core$List$map,
						function (tagger) {
							return A2(
								_elm_lang$core$Platform$sendToApp,
								router,
								tagger(time));
						},
						_p7._0));
			};
			return A2(
				_elm_lang$core$Task$andThen,
				function (_p8) {
					return _elm_lang$core$Task$succeed(state);
				},
				A2(_elm_lang$core$Task$andThen, tellTaggers, _elm_lang$core$Time$now));
		}
	});
var _elm_lang$core$Time$subscription = _elm_lang$core$Native_Platform.leaf('Time');
var _elm_lang$core$Time$State = F2(
	function (a, b) {
		return {taggers: a, processes: b};
	});
var _elm_lang$core$Time$init = _elm_lang$core$Task$succeed(
	A2(_elm_lang$core$Time$State, _elm_lang$core$Dict$empty, _elm_lang$core$Dict$empty));
var _elm_lang$core$Time$onEffects = F3(
	function (router, subs, _p9) {
		var _p10 = _p9;
		var rightStep = F3(
			function (_p12, id, _p11) {
				var _p13 = _p11;
				return {
					ctor: '_Tuple3',
					_0: _p13._0,
					_1: _p13._1,
					_2: A2(
						_elm_lang$core$Task$andThen,
						function (_p14) {
							return _p13._2;
						},
						_elm_lang$core$Native_Scheduler.kill(id))
				};
			});
		var bothStep = F4(
			function (interval, taggers, id, _p15) {
				var _p16 = _p15;
				return {
					ctor: '_Tuple3',
					_0: _p16._0,
					_1: A3(_elm_lang$core$Dict$insert, interval, id, _p16._1),
					_2: _p16._2
				};
			});
		var leftStep = F3(
			function (interval, taggers, _p17) {
				var _p18 = _p17;
				return {
					ctor: '_Tuple3',
					_0: {ctor: '::', _0: interval, _1: _p18._0},
					_1: _p18._1,
					_2: _p18._2
				};
			});
		var newTaggers = A3(_elm_lang$core$List$foldl, _elm_lang$core$Time$addMySub, _elm_lang$core$Dict$empty, subs);
		var _p19 = A6(
			_elm_lang$core$Dict$merge,
			leftStep,
			bothStep,
			rightStep,
			newTaggers,
			_p10.processes,
			{
				ctor: '_Tuple3',
				_0: {ctor: '[]'},
				_1: _elm_lang$core$Dict$empty,
				_2: _elm_lang$core$Task$succeed(
					{ctor: '_Tuple0'})
			});
		var spawnList = _p19._0;
		var existingDict = _p19._1;
		var killTask = _p19._2;
		return A2(
			_elm_lang$core$Task$andThen,
			function (newProcesses) {
				return _elm_lang$core$Task$succeed(
					A2(_elm_lang$core$Time$State, newTaggers, newProcesses));
			},
			A2(
				_elm_lang$core$Task$andThen,
				function (_p20) {
					return A3(_elm_lang$core$Time$spawnHelp, router, spawnList, existingDict);
				},
				killTask));
	});
var _elm_lang$core$Time$Every = F2(
	function (a, b) {
		return {ctor: 'Every', _0: a, _1: b};
	});
var _elm_lang$core$Time$every = F2(
	function (interval, tagger) {
		return _elm_lang$core$Time$subscription(
			A2(_elm_lang$core$Time$Every, interval, tagger));
	});
var _elm_lang$core$Time$subMap = F2(
	function (f, _p21) {
		var _p22 = _p21;
		return A2(
			_elm_lang$core$Time$Every,
			_p22._0,
			function (_p23) {
				return f(
					_p22._1(_p23));
			});
	});
_elm_lang$core$Native_Platform.effectManagers['Time'] = {pkg: 'elm-lang/core', init: _elm_lang$core$Time$init, onEffects: _elm_lang$core$Time$onEffects, onSelfMsg: _elm_lang$core$Time$onSelfMsg, tag: 'sub', subMap: _elm_lang$core$Time$subMap};

var _elm_lang$core$Debug$crash = _elm_lang$core$Native_Debug.crash;
var _elm_lang$core$Debug$log = _elm_lang$core$Native_Debug.log;

//import Maybe, Native.Array, Native.List, Native.Utils, Result //

var _elm_lang$core$Native_Json = function() {


// CORE DECODERS

function succeed(msg)
{
	return {
		ctor: '<decoder>',
		tag: 'succeed',
		msg: msg
	};
}

function fail(msg)
{
	return {
		ctor: '<decoder>',
		tag: 'fail',
		msg: msg
	};
}

function decodePrimitive(tag)
{
	return {
		ctor: '<decoder>',
		tag: tag
	};
}

function decodeContainer(tag, decoder)
{
	return {
		ctor: '<decoder>',
		tag: tag,
		decoder: decoder
	};
}

function decodeNull(value)
{
	return {
		ctor: '<decoder>',
		tag: 'null',
		value: value
	};
}

function decodeField(field, decoder)
{
	return {
		ctor: '<decoder>',
		tag: 'field',
		field: field,
		decoder: decoder
	};
}

function decodeIndex(index, decoder)
{
	return {
		ctor: '<decoder>',
		tag: 'index',
		index: index,
		decoder: decoder
	};
}

function decodeKeyValuePairs(decoder)
{
	return {
		ctor: '<decoder>',
		tag: 'key-value',
		decoder: decoder
	};
}

function mapMany(f, decoders)
{
	return {
		ctor: '<decoder>',
		tag: 'map-many',
		func: f,
		decoders: decoders
	};
}

function andThen(callback, decoder)
{
	return {
		ctor: '<decoder>',
		tag: 'andThen',
		decoder: decoder,
		callback: callback
	};
}

function oneOf(decoders)
{
	return {
		ctor: '<decoder>',
		tag: 'oneOf',
		decoders: decoders
	};
}


// DECODING OBJECTS

function map1(f, d1)
{
	return mapMany(f, [d1]);
}

function map2(f, d1, d2)
{
	return mapMany(f, [d1, d2]);
}

function map3(f, d1, d2, d3)
{
	return mapMany(f, [d1, d2, d3]);
}

function map4(f, d1, d2, d3, d4)
{
	return mapMany(f, [d1, d2, d3, d4]);
}

function map5(f, d1, d2, d3, d4, d5)
{
	return mapMany(f, [d1, d2, d3, d4, d5]);
}

function map6(f, d1, d2, d3, d4, d5, d6)
{
	return mapMany(f, [d1, d2, d3, d4, d5, d6]);
}

function map7(f, d1, d2, d3, d4, d5, d6, d7)
{
	return mapMany(f, [d1, d2, d3, d4, d5, d6, d7]);
}

function map8(f, d1, d2, d3, d4, d5, d6, d7, d8)
{
	return mapMany(f, [d1, d2, d3, d4, d5, d6, d7, d8]);
}


// DECODE HELPERS

function ok(value)
{
	return { tag: 'ok', value: value };
}

function badPrimitive(type, value)
{
	return { tag: 'primitive', type: type, value: value };
}

function badIndex(index, nestedProblems)
{
	return { tag: 'index', index: index, rest: nestedProblems };
}

function badField(field, nestedProblems)
{
	return { tag: 'field', field: field, rest: nestedProblems };
}

function badIndex(index, nestedProblems)
{
	return { tag: 'index', index: index, rest: nestedProblems };
}

function badOneOf(problems)
{
	return { tag: 'oneOf', problems: problems };
}

function bad(msg)
{
	return { tag: 'fail', msg: msg };
}

function badToString(problem)
{
	var context = '_';
	while (problem)
	{
		switch (problem.tag)
		{
			case 'primitive':
				return 'Expecting ' + problem.type
					+ (context === '_' ? '' : ' at ' + context)
					+ ' but instead got: ' + jsToString(problem.value);

			case 'index':
				context += '[' + problem.index + ']';
				problem = problem.rest;
				break;

			case 'field':
				context += '.' + problem.field;
				problem = problem.rest;
				break;

			case 'oneOf':
				var problems = problem.problems;
				for (var i = 0; i < problems.length; i++)
				{
					problems[i] = badToString(problems[i]);
				}
				return 'I ran into the following problems'
					+ (context === '_' ? '' : ' at ' + context)
					+ ':\n\n' + problems.join('\n');

			case 'fail':
				return 'I ran into a `fail` decoder'
					+ (context === '_' ? '' : ' at ' + context)
					+ ': ' + problem.msg;
		}
	}
}

function jsToString(value)
{
	return value === undefined
		? 'undefined'
		: JSON.stringify(value);
}


// DECODE

function runOnString(decoder, string)
{
	var json;
	try
	{
		json = JSON.parse(string);
	}
	catch (e)
	{
		return _elm_lang$core$Result$Err('Given an invalid JSON: ' + e.message);
	}
	return run(decoder, json);
}

function run(decoder, value)
{
	var result = runHelp(decoder, value);
	return (result.tag === 'ok')
		? _elm_lang$core$Result$Ok(result.value)
		: _elm_lang$core$Result$Err(badToString(result));
}

function runHelp(decoder, value)
{
	switch (decoder.tag)
	{
		case 'bool':
			return (typeof value === 'boolean')
				? ok(value)
				: badPrimitive('a Bool', value);

		case 'int':
			if (typeof value !== 'number') {
				return badPrimitive('an Int', value);
			}

			if (-2147483647 < value && value < 2147483647 && (value | 0) === value) {
				return ok(value);
			}

			if (isFinite(value) && !(value % 1)) {
				return ok(value);
			}

			return badPrimitive('an Int', value);

		case 'float':
			return (typeof value === 'number')
				? ok(value)
				: badPrimitive('a Float', value);

		case 'string':
			return (typeof value === 'string')
				? ok(value)
				: (value instanceof String)
					? ok(value + '')
					: badPrimitive('a String', value);

		case 'null':
			return (value === null)
				? ok(decoder.value)
				: badPrimitive('null', value);

		case 'value':
			return ok(value);

		case 'list':
			if (!(value instanceof Array))
			{
				return badPrimitive('a List', value);
			}

			var list = _elm_lang$core$Native_List.Nil;
			for (var i = value.length; i--; )
			{
				var result = runHelp(decoder.decoder, value[i]);
				if (result.tag !== 'ok')
				{
					return badIndex(i, result)
				}
				list = _elm_lang$core$Native_List.Cons(result.value, list);
			}
			return ok(list);

		case 'array':
			if (!(value instanceof Array))
			{
				return badPrimitive('an Array', value);
			}

			var len = value.length;
			var array = new Array(len);
			for (var i = len; i--; )
			{
				var result = runHelp(decoder.decoder, value[i]);
				if (result.tag !== 'ok')
				{
					return badIndex(i, result);
				}
				array[i] = result.value;
			}
			return ok(_elm_lang$core$Native_Array.fromJSArray(array));

		case 'maybe':
			var result = runHelp(decoder.decoder, value);
			return (result.tag === 'ok')
				? ok(_elm_lang$core$Maybe$Just(result.value))
				: ok(_elm_lang$core$Maybe$Nothing);

		case 'field':
			var field = decoder.field;
			if (typeof value !== 'object' || value === null || !(field in value))
			{
				return badPrimitive('an object with a field named `' + field + '`', value);
			}

			var result = runHelp(decoder.decoder, value[field]);
			return (result.tag === 'ok') ? result : badField(field, result);

		case 'index':
			var index = decoder.index;
			if (!(value instanceof Array))
			{
				return badPrimitive('an array', value);
			}
			if (index >= value.length)
			{
				return badPrimitive('a longer array. Need index ' + index + ' but there are only ' + value.length + ' entries', value);
			}

			var result = runHelp(decoder.decoder, value[index]);
			return (result.tag === 'ok') ? result : badIndex(index, result);

		case 'key-value':
			if (typeof value !== 'object' || value === null || value instanceof Array)
			{
				return badPrimitive('an object', value);
			}

			var keyValuePairs = _elm_lang$core$Native_List.Nil;
			for (var key in value)
			{
				var result = runHelp(decoder.decoder, value[key]);
				if (result.tag !== 'ok')
				{
					return badField(key, result);
				}
				var pair = _elm_lang$core$Native_Utils.Tuple2(key, result.value);
				keyValuePairs = _elm_lang$core$Native_List.Cons(pair, keyValuePairs);
			}
			return ok(keyValuePairs);

		case 'map-many':
			var answer = decoder.func;
			var decoders = decoder.decoders;
			for (var i = 0; i < decoders.length; i++)
			{
				var result = runHelp(decoders[i], value);
				if (result.tag !== 'ok')
				{
					return result;
				}
				answer = answer(result.value);
			}
			return ok(answer);

		case 'andThen':
			var result = runHelp(decoder.decoder, value);
			return (result.tag !== 'ok')
				? result
				: runHelp(decoder.callback(result.value), value);

		case 'oneOf':
			var errors = [];
			var temp = decoder.decoders;
			while (temp.ctor !== '[]')
			{
				var result = runHelp(temp._0, value);

				if (result.tag === 'ok')
				{
					return result;
				}

				errors.push(result);

				temp = temp._1;
			}
			return badOneOf(errors);

		case 'fail':
			return bad(decoder.msg);

		case 'succeed':
			return ok(decoder.msg);
	}
}


// EQUALITY

function equality(a, b)
{
	if (a === b)
	{
		return true;
	}

	if (a.tag !== b.tag)
	{
		return false;
	}

	switch (a.tag)
	{
		case 'succeed':
		case 'fail':
			return a.msg === b.msg;

		case 'bool':
		case 'int':
		case 'float':
		case 'string':
		case 'value':
			return true;

		case 'null':
			return a.value === b.value;

		case 'list':
		case 'array':
		case 'maybe':
		case 'key-value':
			return equality(a.decoder, b.decoder);

		case 'field':
			return a.field === b.field && equality(a.decoder, b.decoder);

		case 'index':
			return a.index === b.index && equality(a.decoder, b.decoder);

		case 'map-many':
			if (a.func !== b.func)
			{
				return false;
			}
			return listEquality(a.decoders, b.decoders);

		case 'andThen':
			return a.callback === b.callback && equality(a.decoder, b.decoder);

		case 'oneOf':
			return listEquality(a.decoders, b.decoders);
	}
}

function listEquality(aDecoders, bDecoders)
{
	var len = aDecoders.length;
	if (len !== bDecoders.length)
	{
		return false;
	}
	for (var i = 0; i < len; i++)
	{
		if (!equality(aDecoders[i], bDecoders[i]))
		{
			return false;
		}
	}
	return true;
}


// ENCODE

function encode(indentLevel, value)
{
	return JSON.stringify(value, null, indentLevel);
}

function identity(value)
{
	return value;
}

function encodeObject(keyValuePairs)
{
	var obj = {};
	while (keyValuePairs.ctor !== '[]')
	{
		var pair = keyValuePairs._0;
		obj[pair._0] = pair._1;
		keyValuePairs = keyValuePairs._1;
	}
	return obj;
}

return {
	encode: F2(encode),
	runOnString: F2(runOnString),
	run: F2(run),

	decodeNull: decodeNull,
	decodePrimitive: decodePrimitive,
	decodeContainer: F2(decodeContainer),

	decodeField: F2(decodeField),
	decodeIndex: F2(decodeIndex),

	map1: F2(map1),
	map2: F3(map2),
	map3: F4(map3),
	map4: F5(map4),
	map5: F6(map5),
	map6: F7(map6),
	map7: F8(map7),
	map8: F9(map8),
	decodeKeyValuePairs: decodeKeyValuePairs,

	andThen: F2(andThen),
	fail: fail,
	succeed: succeed,
	oneOf: oneOf,

	identity: identity,
	encodeNull: null,
	encodeArray: _elm_lang$core$Native_Array.toJSArray,
	encodeList: _elm_lang$core$Native_List.toArray,
	encodeObject: encodeObject,

	equality: equality
};

}();

var _elm_lang$core$Json_Encode$list = _elm_lang$core$Native_Json.encodeList;
var _elm_lang$core$Json_Encode$array = _elm_lang$core$Native_Json.encodeArray;
var _elm_lang$core$Json_Encode$object = _elm_lang$core$Native_Json.encodeObject;
var _elm_lang$core$Json_Encode$null = _elm_lang$core$Native_Json.encodeNull;
var _elm_lang$core$Json_Encode$bool = _elm_lang$core$Native_Json.identity;
var _elm_lang$core$Json_Encode$float = _elm_lang$core$Native_Json.identity;
var _elm_lang$core$Json_Encode$int = _elm_lang$core$Native_Json.identity;
var _elm_lang$core$Json_Encode$string = _elm_lang$core$Native_Json.identity;
var _elm_lang$core$Json_Encode$encode = _elm_lang$core$Native_Json.encode;
var _elm_lang$core$Json_Encode$Value = {ctor: 'Value'};

var _elm_lang$core$Json_Decode$null = _elm_lang$core$Native_Json.decodeNull;
var _elm_lang$core$Json_Decode$value = _elm_lang$core$Native_Json.decodePrimitive('value');
var _elm_lang$core$Json_Decode$andThen = _elm_lang$core$Native_Json.andThen;
var _elm_lang$core$Json_Decode$fail = _elm_lang$core$Native_Json.fail;
var _elm_lang$core$Json_Decode$succeed = _elm_lang$core$Native_Json.succeed;
var _elm_lang$core$Json_Decode$lazy = function (thunk) {
	return A2(
		_elm_lang$core$Json_Decode$andThen,
		thunk,
		_elm_lang$core$Json_Decode$succeed(
			{ctor: '_Tuple0'}));
};
var _elm_lang$core$Json_Decode$decodeValue = _elm_lang$core$Native_Json.run;
var _elm_lang$core$Json_Decode$decodeString = _elm_lang$core$Native_Json.runOnString;
var _elm_lang$core$Json_Decode$map8 = _elm_lang$core$Native_Json.map8;
var _elm_lang$core$Json_Decode$map7 = _elm_lang$core$Native_Json.map7;
var _elm_lang$core$Json_Decode$map6 = _elm_lang$core$Native_Json.map6;
var _elm_lang$core$Json_Decode$map5 = _elm_lang$core$Native_Json.map5;
var _elm_lang$core$Json_Decode$map4 = _elm_lang$core$Native_Json.map4;
var _elm_lang$core$Json_Decode$map3 = _elm_lang$core$Native_Json.map3;
var _elm_lang$core$Json_Decode$map2 = _elm_lang$core$Native_Json.map2;
var _elm_lang$core$Json_Decode$map = _elm_lang$core$Native_Json.map1;
var _elm_lang$core$Json_Decode$oneOf = _elm_lang$core$Native_Json.oneOf;
var _elm_lang$core$Json_Decode$maybe = function (decoder) {
	return A2(_elm_lang$core$Native_Json.decodeContainer, 'maybe', decoder);
};
var _elm_lang$core$Json_Decode$index = _elm_lang$core$Native_Json.decodeIndex;
var _elm_lang$core$Json_Decode$field = _elm_lang$core$Native_Json.decodeField;
var _elm_lang$core$Json_Decode$at = F2(
	function (fields, decoder) {
		return A3(_elm_lang$core$List$foldr, _elm_lang$core$Json_Decode$field, decoder, fields);
	});
var _elm_lang$core$Json_Decode$keyValuePairs = _elm_lang$core$Native_Json.decodeKeyValuePairs;
var _elm_lang$core$Json_Decode$dict = function (decoder) {
	return A2(
		_elm_lang$core$Json_Decode$map,
		_elm_lang$core$Dict$fromList,
		_elm_lang$core$Json_Decode$keyValuePairs(decoder));
};
var _elm_lang$core$Json_Decode$array = function (decoder) {
	return A2(_elm_lang$core$Native_Json.decodeContainer, 'array', decoder);
};
var _elm_lang$core$Json_Decode$list = function (decoder) {
	return A2(_elm_lang$core$Native_Json.decodeContainer, 'list', decoder);
};
var _elm_lang$core$Json_Decode$nullable = function (decoder) {
	return _elm_lang$core$Json_Decode$oneOf(
		{
			ctor: '::',
			_0: _elm_lang$core$Json_Decode$null(_elm_lang$core$Maybe$Nothing),
			_1: {
				ctor: '::',
				_0: A2(_elm_lang$core$Json_Decode$map, _elm_lang$core$Maybe$Just, decoder),
				_1: {ctor: '[]'}
			}
		});
};
var _elm_lang$core$Json_Decode$float = _elm_lang$core$Native_Json.decodePrimitive('float');
var _elm_lang$core$Json_Decode$int = _elm_lang$core$Native_Json.decodePrimitive('int');
var _elm_lang$core$Json_Decode$bool = _elm_lang$core$Native_Json.decodePrimitive('bool');
var _elm_lang$core$Json_Decode$string = _elm_lang$core$Native_Json.decodePrimitive('string');
var _elm_lang$core$Json_Decode$Decoder = {ctor: 'Decoder'};

//import Maybe, Native.List //

var _elm_lang$core$Native_Regex = function() {

function escape(str)
{
	return str.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');
}
function caseInsensitive(re)
{
	return new RegExp(re.source, 'gi');
}
function regex(raw)
{
	return new RegExp(raw, 'g');
}

function contains(re, string)
{
	return string.match(re) !== null;
}

function find(n, re, str)
{
	n = n.ctor === 'All' ? Infinity : n._0;
	var out = [];
	var number = 0;
	var string = str;
	var lastIndex = re.lastIndex;
	var prevLastIndex = -1;
	var result;
	while (number++ < n && (result = re.exec(string)))
	{
		if (prevLastIndex === re.lastIndex) break;
		var i = result.length - 1;
		var subs = new Array(i);
		while (i > 0)
		{
			var submatch = result[i];
			subs[--i] = submatch === undefined
				? _elm_lang$core$Maybe$Nothing
				: _elm_lang$core$Maybe$Just(submatch);
		}
		out.push({
			match: result[0],
			submatches: _elm_lang$core$Native_List.fromArray(subs),
			index: result.index,
			number: number
		});
		prevLastIndex = re.lastIndex;
	}
	re.lastIndex = lastIndex;
	return _elm_lang$core$Native_List.fromArray(out);
}

function replace(n, re, replacer, string)
{
	n = n.ctor === 'All' ? Infinity : n._0;
	var count = 0;
	function jsReplacer(match)
	{
		if (count++ >= n)
		{
			return match;
		}
		var i = arguments.length - 3;
		var submatches = new Array(i);
		while (i > 0)
		{
			var submatch = arguments[i];
			submatches[--i] = submatch === undefined
				? _elm_lang$core$Maybe$Nothing
				: _elm_lang$core$Maybe$Just(submatch);
		}
		return replacer({
			match: match,
			submatches: _elm_lang$core$Native_List.fromArray(submatches),
			index: arguments[arguments.length - 2],
			number: count
		});
	}
	return string.replace(re, jsReplacer);
}

function split(n, re, str)
{
	n = n.ctor === 'All' ? Infinity : n._0;
	if (n === Infinity)
	{
		return _elm_lang$core$Native_List.fromArray(str.split(re));
	}
	var string = str;
	var result;
	var out = [];
	var start = re.lastIndex;
	var restoreLastIndex = re.lastIndex;
	while (n--)
	{
		if (!(result = re.exec(string))) break;
		out.push(string.slice(start, result.index));
		start = re.lastIndex;
	}
	out.push(string.slice(start));
	re.lastIndex = restoreLastIndex;
	return _elm_lang$core$Native_List.fromArray(out);
}

return {
	regex: regex,
	caseInsensitive: caseInsensitive,
	escape: escape,

	contains: F2(contains),
	find: F3(find),
	replace: F4(replace),
	split: F3(split)
};

}();

var _elm_lang$core$Process$kill = _elm_lang$core$Native_Scheduler.kill;
var _elm_lang$core$Process$sleep = _elm_lang$core$Native_Scheduler.sleep;
var _elm_lang$core$Process$spawn = _elm_lang$core$Native_Scheduler.spawn;

var _elm_lang$core$Tuple$mapSecond = F2(
	function (func, _p0) {
		var _p1 = _p0;
		return {
			ctor: '_Tuple2',
			_0: _p1._0,
			_1: func(_p1._1)
		};
	});
var _elm_lang$core$Tuple$mapFirst = F2(
	function (func, _p2) {
		var _p3 = _p2;
		return {
			ctor: '_Tuple2',
			_0: func(_p3._0),
			_1: _p3._1
		};
	});
var _elm_lang$core$Tuple$second = function (_p4) {
	var _p5 = _p4;
	return _p5._1;
};
var _elm_lang$core$Tuple$first = function (_p6) {
	var _p7 = _p6;
	return _p7._0;
};

var _elm_lang$core$Random$onSelfMsg = F3(
	function (_p1, _p0, seed) {
		return _elm_lang$core$Task$succeed(seed);
	});
var _elm_lang$core$Random$magicNum8 = 2147483562;
var _elm_lang$core$Random$range = function (_p2) {
	return {ctor: '_Tuple2', _0: 0, _1: _elm_lang$core$Random$magicNum8};
};
var _elm_lang$core$Random$magicNum7 = 2147483399;
var _elm_lang$core$Random$magicNum6 = 2147483563;
var _elm_lang$core$Random$magicNum5 = 3791;
var _elm_lang$core$Random$magicNum4 = 40692;
var _elm_lang$core$Random$magicNum3 = 52774;
var _elm_lang$core$Random$magicNum2 = 12211;
var _elm_lang$core$Random$magicNum1 = 53668;
var _elm_lang$core$Random$magicNum0 = 40014;
var _elm_lang$core$Random$step = F2(
	function (_p3, seed) {
		var _p4 = _p3;
		return _p4._0(seed);
	});
var _elm_lang$core$Random$onEffects = F3(
	function (router, commands, seed) {
		var _p5 = commands;
		if (_p5.ctor === '[]') {
			return _elm_lang$core$Task$succeed(seed);
		} else {
			var _p6 = A2(_elm_lang$core$Random$step, _p5._0._0, seed);
			var value = _p6._0;
			var newSeed = _p6._1;
			return A2(
				_elm_lang$core$Task$andThen,
				function (_p7) {
					return A3(_elm_lang$core$Random$onEffects, router, _p5._1, newSeed);
				},
				A2(_elm_lang$core$Platform$sendToApp, router, value));
		}
	});
var _elm_lang$core$Random$listHelp = F4(
	function (list, n, generate, seed) {
		listHelp:
		while (true) {
			if (_elm_lang$core$Native_Utils.cmp(n, 1) < 0) {
				return {
					ctor: '_Tuple2',
					_0: _elm_lang$core$List$reverse(list),
					_1: seed
				};
			} else {
				var _p8 = generate(seed);
				var value = _p8._0;
				var newSeed = _p8._1;
				var _v2 = {ctor: '::', _0: value, _1: list},
					_v3 = n - 1,
					_v4 = generate,
					_v5 = newSeed;
				list = _v2;
				n = _v3;
				generate = _v4;
				seed = _v5;
				continue listHelp;
			}
		}
	});
var _elm_lang$core$Random$minInt = -2147483648;
var _elm_lang$core$Random$maxInt = 2147483647;
var _elm_lang$core$Random$iLogBase = F2(
	function (b, i) {
		return (_elm_lang$core$Native_Utils.cmp(i, b) < 0) ? 1 : (1 + A2(_elm_lang$core$Random$iLogBase, b, (i / b) | 0));
	});
var _elm_lang$core$Random$command = _elm_lang$core$Native_Platform.leaf('Random');
var _elm_lang$core$Random$Generator = function (a) {
	return {ctor: 'Generator', _0: a};
};
var _elm_lang$core$Random$list = F2(
	function (n, _p9) {
		var _p10 = _p9;
		return _elm_lang$core$Random$Generator(
			function (seed) {
				return A4(
					_elm_lang$core$Random$listHelp,
					{ctor: '[]'},
					n,
					_p10._0,
					seed);
			});
	});
var _elm_lang$core$Random$map = F2(
	function (func, _p11) {
		var _p12 = _p11;
		return _elm_lang$core$Random$Generator(
			function (seed0) {
				var _p13 = _p12._0(seed0);
				var a = _p13._0;
				var seed1 = _p13._1;
				return {
					ctor: '_Tuple2',
					_0: func(a),
					_1: seed1
				};
			});
	});
var _elm_lang$core$Random$map2 = F3(
	function (func, _p15, _p14) {
		var _p16 = _p15;
		var _p17 = _p14;
		return _elm_lang$core$Random$Generator(
			function (seed0) {
				var _p18 = _p16._0(seed0);
				var a = _p18._0;
				var seed1 = _p18._1;
				var _p19 = _p17._0(seed1);
				var b = _p19._0;
				var seed2 = _p19._1;
				return {
					ctor: '_Tuple2',
					_0: A2(func, a, b),
					_1: seed2
				};
			});
	});
var _elm_lang$core$Random$pair = F2(
	function (genA, genB) {
		return A3(
			_elm_lang$core$Random$map2,
			F2(
				function (v0, v1) {
					return {ctor: '_Tuple2', _0: v0, _1: v1};
				}),
			genA,
			genB);
	});
var _elm_lang$core$Random$map3 = F4(
	function (func, _p22, _p21, _p20) {
		var _p23 = _p22;
		var _p24 = _p21;
		var _p25 = _p20;
		return _elm_lang$core$Random$Generator(
			function (seed0) {
				var _p26 = _p23._0(seed0);
				var a = _p26._0;
				var seed1 = _p26._1;
				var _p27 = _p24._0(seed1);
				var b = _p27._0;
				var seed2 = _p27._1;
				var _p28 = _p25._0(seed2);
				var c = _p28._0;
				var seed3 = _p28._1;
				return {
					ctor: '_Tuple2',
					_0: A3(func, a, b, c),
					_1: seed3
				};
			});
	});
var _elm_lang$core$Random$map4 = F5(
	function (func, _p32, _p31, _p30, _p29) {
		var _p33 = _p32;
		var _p34 = _p31;
		var _p35 = _p30;
		var _p36 = _p29;
		return _elm_lang$core$Random$Generator(
			function (seed0) {
				var _p37 = _p33._0(seed0);
				var a = _p37._0;
				var seed1 = _p37._1;
				var _p38 = _p34._0(seed1);
				var b = _p38._0;
				var seed2 = _p38._1;
				var _p39 = _p35._0(seed2);
				var c = _p39._0;
				var seed3 = _p39._1;
				var _p40 = _p36._0(seed3);
				var d = _p40._0;
				var seed4 = _p40._1;
				return {
					ctor: '_Tuple2',
					_0: A4(func, a, b, c, d),
					_1: seed4
				};
			});
	});
var _elm_lang$core$Random$map5 = F6(
	function (func, _p45, _p44, _p43, _p42, _p41) {
		var _p46 = _p45;
		var _p47 = _p44;
		var _p48 = _p43;
		var _p49 = _p42;
		var _p50 = _p41;
		return _elm_lang$core$Random$Generator(
			function (seed0) {
				var _p51 = _p46._0(seed0);
				var a = _p51._0;
				var seed1 = _p51._1;
				var _p52 = _p47._0(seed1);
				var b = _p52._0;
				var seed2 = _p52._1;
				var _p53 = _p48._0(seed2);
				var c = _p53._0;
				var seed3 = _p53._1;
				var _p54 = _p49._0(seed3);
				var d = _p54._0;
				var seed4 = _p54._1;
				var _p55 = _p50._0(seed4);
				var e = _p55._0;
				var seed5 = _p55._1;
				return {
					ctor: '_Tuple2',
					_0: A5(func, a, b, c, d, e),
					_1: seed5
				};
			});
	});
var _elm_lang$core$Random$andThen = F2(
	function (callback, _p56) {
		var _p57 = _p56;
		return _elm_lang$core$Random$Generator(
			function (seed) {
				var _p58 = _p57._0(seed);
				var result = _p58._0;
				var newSeed = _p58._1;
				var _p59 = callback(result);
				var genB = _p59._0;
				return genB(newSeed);
			});
	});
var _elm_lang$core$Random$State = F2(
	function (a, b) {
		return {ctor: 'State', _0: a, _1: b};
	});
var _elm_lang$core$Random$initState = function (seed) {
	var s = A2(_elm_lang$core$Basics$max, seed, 0 - seed);
	var q = (s / (_elm_lang$core$Random$magicNum6 - 1)) | 0;
	var s2 = A2(_elm_lang$core$Basics_ops['%'], q, _elm_lang$core$Random$magicNum7 - 1);
	var s1 = A2(_elm_lang$core$Basics_ops['%'], s, _elm_lang$core$Random$magicNum6 - 1);
	return A2(_elm_lang$core$Random$State, s1 + 1, s2 + 1);
};
var _elm_lang$core$Random$next = function (_p60) {
	var _p61 = _p60;
	var _p63 = _p61._1;
	var _p62 = _p61._0;
	var k2 = (_p63 / _elm_lang$core$Random$magicNum3) | 0;
	var rawState2 = (_elm_lang$core$Random$magicNum4 * (_p63 - (k2 * _elm_lang$core$Random$magicNum3))) - (k2 * _elm_lang$core$Random$magicNum5);
	var newState2 = (_elm_lang$core$Native_Utils.cmp(rawState2, 0) < 0) ? (rawState2 + _elm_lang$core$Random$magicNum7) : rawState2;
	var k1 = (_p62 / _elm_lang$core$Random$magicNum1) | 0;
	var rawState1 = (_elm_lang$core$Random$magicNum0 * (_p62 - (k1 * _elm_lang$core$Random$magicNum1))) - (k1 * _elm_lang$core$Random$magicNum2);
	var newState1 = (_elm_lang$core$Native_Utils.cmp(rawState1, 0) < 0) ? (rawState1 + _elm_lang$core$Random$magicNum6) : rawState1;
	var z = newState1 - newState2;
	var newZ = (_elm_lang$core$Native_Utils.cmp(z, 1) < 0) ? (z + _elm_lang$core$Random$magicNum8) : z;
	return {
		ctor: '_Tuple2',
		_0: newZ,
		_1: A2(_elm_lang$core$Random$State, newState1, newState2)
	};
};
var _elm_lang$core$Random$split = function (_p64) {
	var _p65 = _p64;
	var _p68 = _p65._1;
	var _p67 = _p65._0;
	var _p66 = _elm_lang$core$Tuple$second(
		_elm_lang$core$Random$next(_p65));
	var t1 = _p66._0;
	var t2 = _p66._1;
	var new_s2 = _elm_lang$core$Native_Utils.eq(_p68, 1) ? (_elm_lang$core$Random$magicNum7 - 1) : (_p68 - 1);
	var new_s1 = _elm_lang$core$Native_Utils.eq(_p67, _elm_lang$core$Random$magicNum6 - 1) ? 1 : (_p67 + 1);
	return {
		ctor: '_Tuple2',
		_0: A2(_elm_lang$core$Random$State, new_s1, t2),
		_1: A2(_elm_lang$core$Random$State, t1, new_s2)
	};
};
var _elm_lang$core$Random$Seed = function (a) {
	return {ctor: 'Seed', _0: a};
};
var _elm_lang$core$Random$int = F2(
	function (a, b) {
		return _elm_lang$core$Random$Generator(
			function (_p69) {
				var _p70 = _p69;
				var _p75 = _p70._0;
				var base = 2147483561;
				var f = F3(
					function (n, acc, state) {
						f:
						while (true) {
							var _p71 = n;
							if (_p71 === 0) {
								return {ctor: '_Tuple2', _0: acc, _1: state};
							} else {
								var _p72 = _p75.next(state);
								var x = _p72._0;
								var nextState = _p72._1;
								var _v27 = n - 1,
									_v28 = x + (acc * base),
									_v29 = nextState;
								n = _v27;
								acc = _v28;
								state = _v29;
								continue f;
							}
						}
					});
				var _p73 = (_elm_lang$core$Native_Utils.cmp(a, b) < 0) ? {ctor: '_Tuple2', _0: a, _1: b} : {ctor: '_Tuple2', _0: b, _1: a};
				var lo = _p73._0;
				var hi = _p73._1;
				var k = (hi - lo) + 1;
				var n = A2(_elm_lang$core$Random$iLogBase, base, k);
				var _p74 = A3(f, n, 1, _p75.state);
				var v = _p74._0;
				var nextState = _p74._1;
				return {
					ctor: '_Tuple2',
					_0: lo + A2(_elm_lang$core$Basics_ops['%'], v, k),
					_1: _elm_lang$core$Random$Seed(
						_elm_lang$core$Native_Utils.update(
							_p75,
							{state: nextState}))
				};
			});
	});
var _elm_lang$core$Random$bool = A2(
	_elm_lang$core$Random$map,
	F2(
		function (x, y) {
			return _elm_lang$core$Native_Utils.eq(x, y);
		})(1),
	A2(_elm_lang$core$Random$int, 0, 1));
var _elm_lang$core$Random$float = F2(
	function (a, b) {
		return _elm_lang$core$Random$Generator(
			function (seed) {
				var _p76 = A2(
					_elm_lang$core$Random$step,
					A2(_elm_lang$core$Random$int, _elm_lang$core$Random$minInt, _elm_lang$core$Random$maxInt),
					seed);
				var number = _p76._0;
				var newSeed = _p76._1;
				var negativeOneToOne = _elm_lang$core$Basics$toFloat(number) / _elm_lang$core$Basics$toFloat(_elm_lang$core$Random$maxInt - _elm_lang$core$Random$minInt);
				var _p77 = (_elm_lang$core$Native_Utils.cmp(a, b) < 0) ? {ctor: '_Tuple2', _0: a, _1: b} : {ctor: '_Tuple2', _0: b, _1: a};
				var lo = _p77._0;
				var hi = _p77._1;
				var scaled = ((lo + hi) / 2) + ((hi - lo) * negativeOneToOne);
				return {ctor: '_Tuple2', _0: scaled, _1: newSeed};
			});
	});
var _elm_lang$core$Random$initialSeed = function (n) {
	return _elm_lang$core$Random$Seed(
		{
			state: _elm_lang$core$Random$initState(n),
			next: _elm_lang$core$Random$next,
			split: _elm_lang$core$Random$split,
			range: _elm_lang$core$Random$range
		});
};
var _elm_lang$core$Random$init = A2(
	_elm_lang$core$Task$andThen,
	function (t) {
		return _elm_lang$core$Task$succeed(
			_elm_lang$core$Random$initialSeed(
				_elm_lang$core$Basics$round(t)));
	},
	_elm_lang$core$Time$now);
var _elm_lang$core$Random$Generate = function (a) {
	return {ctor: 'Generate', _0: a};
};
var _elm_lang$core$Random$generate = F2(
	function (tagger, generator) {
		return _elm_lang$core$Random$command(
			_elm_lang$core$Random$Generate(
				A2(_elm_lang$core$Random$map, tagger, generator)));
	});
var _elm_lang$core$Random$cmdMap = F2(
	function (func, _p78) {
		var _p79 = _p78;
		return _elm_lang$core$Random$Generate(
			A2(_elm_lang$core$Random$map, func, _p79._0));
	});
_elm_lang$core$Native_Platform.effectManagers['Random'] = {pkg: 'elm-lang/core', init: _elm_lang$core$Random$init, onEffects: _elm_lang$core$Random$onEffects, onSelfMsg: _elm_lang$core$Random$onSelfMsg, tag: 'cmd', cmdMap: _elm_lang$core$Random$cmdMap};

var _elm_lang$core$Regex$split = _elm_lang$core$Native_Regex.split;
var _elm_lang$core$Regex$replace = _elm_lang$core$Native_Regex.replace;
var _elm_lang$core$Regex$find = _elm_lang$core$Native_Regex.find;
var _elm_lang$core$Regex$contains = _elm_lang$core$Native_Regex.contains;
var _elm_lang$core$Regex$caseInsensitive = _elm_lang$core$Native_Regex.caseInsensitive;
var _elm_lang$core$Regex$regex = _elm_lang$core$Native_Regex.regex;
var _elm_lang$core$Regex$escape = _elm_lang$core$Native_Regex.escape;
var _elm_lang$core$Regex$Match = F4(
	function (a, b, c, d) {
		return {match: a, submatches: b, index: c, number: d};
	});
var _elm_lang$core$Regex$Regex = {ctor: 'Regex'};
var _elm_lang$core$Regex$AtMost = function (a) {
	return {ctor: 'AtMost', _0: a};
};
var _elm_lang$core$Regex$All = {ctor: 'All'};

var _elm_lang$core$Set$foldr = F3(
	function (f, b, _p0) {
		var _p1 = _p0;
		return A3(
			_elm_lang$core$Dict$foldr,
			F3(
				function (k, _p2, b) {
					return A2(f, k, b);
				}),
			b,
			_p1._0);
	});
var _elm_lang$core$Set$foldl = F3(
	function (f, b, _p3) {
		var _p4 = _p3;
		return A3(
			_elm_lang$core$Dict$foldl,
			F3(
				function (k, _p5, b) {
					return A2(f, k, b);
				}),
			b,
			_p4._0);
	});
var _elm_lang$core$Set$toList = function (_p6) {
	var _p7 = _p6;
	return _elm_lang$core$Dict$keys(_p7._0);
};
var _elm_lang$core$Set$size = function (_p8) {
	var _p9 = _p8;
	return _elm_lang$core$Dict$size(_p9._0);
};
var _elm_lang$core$Set$member = F2(
	function (k, _p10) {
		var _p11 = _p10;
		return A2(_elm_lang$core$Dict$member, k, _p11._0);
	});
var _elm_lang$core$Set$isEmpty = function (_p12) {
	var _p13 = _p12;
	return _elm_lang$core$Dict$isEmpty(_p13._0);
};
var _elm_lang$core$Set$Set_elm_builtin = function (a) {
	return {ctor: 'Set_elm_builtin', _0: a};
};
var _elm_lang$core$Set$empty = _elm_lang$core$Set$Set_elm_builtin(_elm_lang$core$Dict$empty);
var _elm_lang$core$Set$singleton = function (k) {
	return _elm_lang$core$Set$Set_elm_builtin(
		A2(
			_elm_lang$core$Dict$singleton,
			k,
			{ctor: '_Tuple0'}));
};
var _elm_lang$core$Set$insert = F2(
	function (k, _p14) {
		var _p15 = _p14;
		return _elm_lang$core$Set$Set_elm_builtin(
			A3(
				_elm_lang$core$Dict$insert,
				k,
				{ctor: '_Tuple0'},
				_p15._0));
	});
var _elm_lang$core$Set$fromList = function (xs) {
	return A3(_elm_lang$core$List$foldl, _elm_lang$core$Set$insert, _elm_lang$core$Set$empty, xs);
};
var _elm_lang$core$Set$map = F2(
	function (f, s) {
		return _elm_lang$core$Set$fromList(
			A2(
				_elm_lang$core$List$map,
				f,
				_elm_lang$core$Set$toList(s)));
	});
var _elm_lang$core$Set$remove = F2(
	function (k, _p16) {
		var _p17 = _p16;
		return _elm_lang$core$Set$Set_elm_builtin(
			A2(_elm_lang$core$Dict$remove, k, _p17._0));
	});
var _elm_lang$core$Set$union = F2(
	function (_p19, _p18) {
		var _p20 = _p19;
		var _p21 = _p18;
		return _elm_lang$core$Set$Set_elm_builtin(
			A2(_elm_lang$core$Dict$union, _p20._0, _p21._0));
	});
var _elm_lang$core$Set$intersect = F2(
	function (_p23, _p22) {
		var _p24 = _p23;
		var _p25 = _p22;
		return _elm_lang$core$Set$Set_elm_builtin(
			A2(_elm_lang$core$Dict$intersect, _p24._0, _p25._0));
	});
var _elm_lang$core$Set$diff = F2(
	function (_p27, _p26) {
		var _p28 = _p27;
		var _p29 = _p26;
		return _elm_lang$core$Set$Set_elm_builtin(
			A2(_elm_lang$core$Dict$diff, _p28._0, _p29._0));
	});
var _elm_lang$core$Set$filter = F2(
	function (p, _p30) {
		var _p31 = _p30;
		return _elm_lang$core$Set$Set_elm_builtin(
			A2(
				_elm_lang$core$Dict$filter,
				F2(
					function (k, _p32) {
						return p(k);
					}),
				_p31._0));
	});
var _elm_lang$core$Set$partition = F2(
	function (p, _p33) {
		var _p34 = _p33;
		var _p35 = A2(
			_elm_lang$core$Dict$partition,
			F2(
				function (k, _p36) {
					return p(k);
				}),
			_p34._0);
		var p1 = _p35._0;
		var p2 = _p35._1;
		return {
			ctor: '_Tuple2',
			_0: _elm_lang$core$Set$Set_elm_builtin(p1),
			_1: _elm_lang$core$Set$Set_elm_builtin(p2)
		};
	});

var _elm_lang$dom$Native_Dom = function() {

var fakeNode = {
	addEventListener: function() {},
	removeEventListener: function() {}
};

var onDocument = on(typeof document !== 'undefined' ? document : fakeNode);
var onWindow = on(typeof window !== 'undefined' ? window : fakeNode);

function on(node)
{
	return function(eventName, decoder, toTask)
	{
		return _elm_lang$core$Native_Scheduler.nativeBinding(function(callback) {

			function performTask(event)
			{
				var result = A2(_elm_lang$core$Json_Decode$decodeValue, decoder, event);
				if (result.ctor === 'Ok')
				{
					_elm_lang$core$Native_Scheduler.rawSpawn(toTask(result._0));
				}
			}

			node.addEventListener(eventName, performTask);

			return function()
			{
				node.removeEventListener(eventName, performTask);
			};
		});
	};
}

var rAF = typeof requestAnimationFrame !== 'undefined'
	? requestAnimationFrame
	: function(callback) { callback(); };

function withNode(id, doStuff)
{
	return _elm_lang$core$Native_Scheduler.nativeBinding(function(callback)
	{
		rAF(function()
		{
			var node = document.getElementById(id);
			if (node === null)
			{
				callback(_elm_lang$core$Native_Scheduler.fail({ ctor: 'NotFound', _0: id }));
				return;
			}
			callback(_elm_lang$core$Native_Scheduler.succeed(doStuff(node)));
		});
	});
}


// FOCUS

function focus(id)
{
	return withNode(id, function(node) {
		node.focus();
		return _elm_lang$core$Native_Utils.Tuple0;
	});
}

function blur(id)
{
	return withNode(id, function(node) {
		node.blur();
		return _elm_lang$core$Native_Utils.Tuple0;
	});
}


// SCROLLING

function getScrollTop(id)
{
	return withNode(id, function(node) {
		return node.scrollTop;
	});
}

function setScrollTop(id, desiredScrollTop)
{
	return withNode(id, function(node) {
		node.scrollTop = desiredScrollTop;
		return _elm_lang$core$Native_Utils.Tuple0;
	});
}

function toBottom(id)
{
	return withNode(id, function(node) {
		node.scrollTop = node.scrollHeight;
		return _elm_lang$core$Native_Utils.Tuple0;
	});
}

function getScrollLeft(id)
{
	return withNode(id, function(node) {
		return node.scrollLeft;
	});
}

function setScrollLeft(id, desiredScrollLeft)
{
	return withNode(id, function(node) {
		node.scrollLeft = desiredScrollLeft;
		return _elm_lang$core$Native_Utils.Tuple0;
	});
}

function toRight(id)
{
	return withNode(id, function(node) {
		node.scrollLeft = node.scrollWidth;
		return _elm_lang$core$Native_Utils.Tuple0;
	});
}


// SIZE

function width(options, id)
{
	return withNode(id, function(node) {
		switch (options.ctor)
		{
			case 'Content':
				return node.scrollWidth;
			case 'VisibleContent':
				return node.clientWidth;
			case 'VisibleContentWithBorders':
				return node.offsetWidth;
			case 'VisibleContentWithBordersAndMargins':
				var rect = node.getBoundingClientRect();
				return rect.right - rect.left;
		}
	});
}

function height(options, id)
{
	return withNode(id, function(node) {
		switch (options.ctor)
		{
			case 'Content':
				return node.scrollHeight;
			case 'VisibleContent':
				return node.clientHeight;
			case 'VisibleContentWithBorders':
				return node.offsetHeight;
			case 'VisibleContentWithBordersAndMargins':
				var rect = node.getBoundingClientRect();
				return rect.bottom - rect.top;
		}
	});
}

return {
	onDocument: F3(onDocument),
	onWindow: F3(onWindow),

	focus: focus,
	blur: blur,

	getScrollTop: getScrollTop,
	setScrollTop: F2(setScrollTop),
	getScrollLeft: getScrollLeft,
	setScrollLeft: F2(setScrollLeft),
	toBottom: toBottom,
	toRight: toRight,

	height: F2(height),
	width: F2(width)
};

}();

var _elm_lang$dom$Dom_LowLevel$onWindow = _elm_lang$dom$Native_Dom.onWindow;
var _elm_lang$dom$Dom_LowLevel$onDocument = _elm_lang$dom$Native_Dom.onDocument;

var _elm_lang$virtual_dom$VirtualDom_Debug$wrap;
var _elm_lang$virtual_dom$VirtualDom_Debug$wrapWithFlags;

var _elm_lang$virtual_dom$Native_VirtualDom = function() {

var STYLE_KEY = 'STYLE';
var EVENT_KEY = 'EVENT';
var ATTR_KEY = 'ATTR';
var ATTR_NS_KEY = 'ATTR_NS';

var localDoc = typeof document !== 'undefined' ? document : {};


////////////  VIRTUAL DOM NODES  ////////////


function text(string)
{
	return {
		type: 'text',
		text: string
	};
}


function node(tag)
{
	return F2(function(factList, kidList) {
		return nodeHelp(tag, factList, kidList);
	});
}


function nodeHelp(tag, factList, kidList)
{
	var organized = organizeFacts(factList);
	var namespace = organized.namespace;
	var facts = organized.facts;

	var children = [];
	var descendantsCount = 0;
	while (kidList.ctor !== '[]')
	{
		var kid = kidList._0;
		descendantsCount += (kid.descendantsCount || 0);
		children.push(kid);
		kidList = kidList._1;
	}
	descendantsCount += children.length;

	return {
		type: 'node',
		tag: tag,
		facts: facts,
		children: children,
		namespace: namespace,
		descendantsCount: descendantsCount
	};
}


function keyedNode(tag, factList, kidList)
{
	var organized = organizeFacts(factList);
	var namespace = organized.namespace;
	var facts = organized.facts;

	var children = [];
	var descendantsCount = 0;
	while (kidList.ctor !== '[]')
	{
		var kid = kidList._0;
		descendantsCount += (kid._1.descendantsCount || 0);
		children.push(kid);
		kidList = kidList._1;
	}
	descendantsCount += children.length;

	return {
		type: 'keyed-node',
		tag: tag,
		facts: facts,
		children: children,
		namespace: namespace,
		descendantsCount: descendantsCount
	};
}


function custom(factList, model, impl)
{
	var facts = organizeFacts(factList).facts;

	return {
		type: 'custom',
		facts: facts,
		model: model,
		impl: impl
	};
}


function map(tagger, node)
{
	return {
		type: 'tagger',
		tagger: tagger,
		node: node,
		descendantsCount: 1 + (node.descendantsCount || 0)
	};
}


function thunk(func, args, thunk)
{
	return {
		type: 'thunk',
		func: func,
		args: args,
		thunk: thunk,
		node: undefined
	};
}

function lazy(fn, a)
{
	return thunk(fn, [a], function() {
		return fn(a);
	});
}

function lazy2(fn, a, b)
{
	return thunk(fn, [a,b], function() {
		return A2(fn, a, b);
	});
}

function lazy3(fn, a, b, c)
{
	return thunk(fn, [a,b,c], function() {
		return A3(fn, a, b, c);
	});
}



// FACTS


function organizeFacts(factList)
{
	var namespace, facts = {};

	while (factList.ctor !== '[]')
	{
		var entry = factList._0;
		var key = entry.key;

		if (key === ATTR_KEY || key === ATTR_NS_KEY || key === EVENT_KEY)
		{
			var subFacts = facts[key] || {};
			subFacts[entry.realKey] = entry.value;
			facts[key] = subFacts;
		}
		else if (key === STYLE_KEY)
		{
			var styles = facts[key] || {};
			var styleList = entry.value;
			while (styleList.ctor !== '[]')
			{
				var style = styleList._0;
				styles[style._0] = style._1;
				styleList = styleList._1;
			}
			facts[key] = styles;
		}
		else if (key === 'namespace')
		{
			namespace = entry.value;
		}
		else if (key === 'className')
		{
			var classes = facts[key];
			facts[key] = typeof classes === 'undefined'
				? entry.value
				: classes + ' ' + entry.value;
		}
 		else
		{
			facts[key] = entry.value;
		}
		factList = factList._1;
	}

	return {
		facts: facts,
		namespace: namespace
	};
}



////////////  PROPERTIES AND ATTRIBUTES  ////////////


function style(value)
{
	return {
		key: STYLE_KEY,
		value: value
	};
}


function property(key, value)
{
	return {
		key: key,
		value: value
	};
}


function attribute(key, value)
{
	return {
		key: ATTR_KEY,
		realKey: key,
		value: value
	};
}


function attributeNS(namespace, key, value)
{
	return {
		key: ATTR_NS_KEY,
		realKey: key,
		value: {
			value: value,
			namespace: namespace
		}
	};
}


function on(name, options, decoder)
{
	return {
		key: EVENT_KEY,
		realKey: name,
		value: {
			options: options,
			decoder: decoder
		}
	};
}


function equalEvents(a, b)
{
	if (a.options !== b.options)
	{
		if (a.options.stopPropagation !== b.options.stopPropagation || a.options.preventDefault !== b.options.preventDefault)
		{
			return false;
		}
	}
	return _elm_lang$core$Native_Json.equality(a.decoder, b.decoder);
}


function mapProperty(func, property)
{
	if (property.key !== EVENT_KEY)
	{
		return property;
	}
	return on(
		property.realKey,
		property.value.options,
		A2(_elm_lang$core$Json_Decode$map, func, property.value.decoder)
	);
}


////////////  RENDER  ////////////


function render(vNode, eventNode)
{
	switch (vNode.type)
	{
		case 'thunk':
			if (!vNode.node)
			{
				vNode.node = vNode.thunk();
			}
			return render(vNode.node, eventNode);

		case 'tagger':
			var subNode = vNode.node;
			var tagger = vNode.tagger;

			while (subNode.type === 'tagger')
			{
				typeof tagger !== 'object'
					? tagger = [tagger, subNode.tagger]
					: tagger.push(subNode.tagger);

				subNode = subNode.node;
			}

			var subEventRoot = { tagger: tagger, parent: eventNode };
			var domNode = render(subNode, subEventRoot);
			domNode.elm_event_node_ref = subEventRoot;
			return domNode;

		case 'text':
			return localDoc.createTextNode(vNode.text);

		case 'node':
			var domNode = vNode.namespace
				? localDoc.createElementNS(vNode.namespace, vNode.tag)
				: localDoc.createElement(vNode.tag);

			applyFacts(domNode, eventNode, vNode.facts);

			var children = vNode.children;

			for (var i = 0; i < children.length; i++)
			{
				domNode.appendChild(render(children[i], eventNode));
			}

			return domNode;

		case 'keyed-node':
			var domNode = vNode.namespace
				? localDoc.createElementNS(vNode.namespace, vNode.tag)
				: localDoc.createElement(vNode.tag);

			applyFacts(domNode, eventNode, vNode.facts);

			var children = vNode.children;

			for (var i = 0; i < children.length; i++)
			{
				domNode.appendChild(render(children[i]._1, eventNode));
			}

			return domNode;

		case 'custom':
			var domNode = vNode.impl.render(vNode.model);
			applyFacts(domNode, eventNode, vNode.facts);
			return domNode;
	}
}



////////////  APPLY FACTS  ////////////


function applyFacts(domNode, eventNode, facts)
{
	for (var key in facts)
	{
		var value = facts[key];

		switch (key)
		{
			case STYLE_KEY:
				applyStyles(domNode, value);
				break;

			case EVENT_KEY:
				applyEvents(domNode, eventNode, value);
				break;

			case ATTR_KEY:
				applyAttrs(domNode, value);
				break;

			case ATTR_NS_KEY:
				applyAttrsNS(domNode, value);
				break;

			case 'value':
				if (domNode[key] !== value)
				{
					domNode[key] = value;
				}
				break;

			default:
				domNode[key] = value;
				break;
		}
	}
}

function applyStyles(domNode, styles)
{
	var domNodeStyle = domNode.style;

	for (var key in styles)
	{
		domNodeStyle[key] = styles[key];
	}
}

function applyEvents(domNode, eventNode, events)
{
	var allHandlers = domNode.elm_handlers || {};

	for (var key in events)
	{
		var handler = allHandlers[key];
		var value = events[key];

		if (typeof value === 'undefined')
		{
			domNode.removeEventListener(key, handler);
			allHandlers[key] = undefined;
		}
		else if (typeof handler === 'undefined')
		{
			var handler = makeEventHandler(eventNode, value);
			domNode.addEventListener(key, handler);
			allHandlers[key] = handler;
		}
		else
		{
			handler.info = value;
		}
	}

	domNode.elm_handlers = allHandlers;
}

function makeEventHandler(eventNode, info)
{
	function eventHandler(event)
	{
		var info = eventHandler.info;

		var value = A2(_elm_lang$core$Native_Json.run, info.decoder, event);

		if (value.ctor === 'Ok')
		{
			var options = info.options;
			if (options.stopPropagation)
			{
				event.stopPropagation();
			}
			if (options.preventDefault)
			{
				event.preventDefault();
			}

			var message = value._0;

			var currentEventNode = eventNode;
			while (currentEventNode)
			{
				var tagger = currentEventNode.tagger;
				if (typeof tagger === 'function')
				{
					message = tagger(message);
				}
				else
				{
					for (var i = tagger.length; i--; )
					{
						message = tagger[i](message);
					}
				}
				currentEventNode = currentEventNode.parent;
			}
		}
	};

	eventHandler.info = info;

	return eventHandler;
}

function applyAttrs(domNode, attrs)
{
	for (var key in attrs)
	{
		var value = attrs[key];
		if (typeof value === 'undefined')
		{
			domNode.removeAttribute(key);
		}
		else
		{
			domNode.setAttribute(key, value);
		}
	}
}

function applyAttrsNS(domNode, nsAttrs)
{
	for (var key in nsAttrs)
	{
		var pair = nsAttrs[key];
		var namespace = pair.namespace;
		var value = pair.value;

		if (typeof value === 'undefined')
		{
			domNode.removeAttributeNS(namespace, key);
		}
		else
		{
			domNode.setAttributeNS(namespace, key, value);
		}
	}
}



////////////  DIFF  ////////////


function diff(a, b)
{
	var patches = [];
	diffHelp(a, b, patches, 0);
	return patches;
}


function makePatch(type, index, data)
{
	return {
		index: index,
		type: type,
		data: data,
		domNode: undefined,
		eventNode: undefined
	};
}


function diffHelp(a, b, patches, index)
{
	if (a === b)
	{
		return;
	}

	var aType = a.type;
	var bType = b.type;

	// Bail if you run into different types of nodes. Implies that the
	// structure has changed significantly and it's not worth a diff.
	if (aType !== bType)
	{
		patches.push(makePatch('p-redraw', index, b));
		return;
	}

	// Now we know that both nodes are the same type.
	switch (bType)
	{
		case 'thunk':
			var aArgs = a.args;
			var bArgs = b.args;
			var i = aArgs.length;
			var same = a.func === b.func && i === bArgs.length;
			while (same && i--)
			{
				same = aArgs[i] === bArgs[i];
			}
			if (same)
			{
				b.node = a.node;
				return;
			}
			b.node = b.thunk();
			var subPatches = [];
			diffHelp(a.node, b.node, subPatches, 0);
			if (subPatches.length > 0)
			{
				patches.push(makePatch('p-thunk', index, subPatches));
			}
			return;

		case 'tagger':
			// gather nested taggers
			var aTaggers = a.tagger;
			var bTaggers = b.tagger;
			var nesting = false;

			var aSubNode = a.node;
			while (aSubNode.type === 'tagger')
			{
				nesting = true;

				typeof aTaggers !== 'object'
					? aTaggers = [aTaggers, aSubNode.tagger]
					: aTaggers.push(aSubNode.tagger);

				aSubNode = aSubNode.node;
			}

			var bSubNode = b.node;
			while (bSubNode.type === 'tagger')
			{
				nesting = true;

				typeof bTaggers !== 'object'
					? bTaggers = [bTaggers, bSubNode.tagger]
					: bTaggers.push(bSubNode.tagger);

				bSubNode = bSubNode.node;
			}

			// Just bail if different numbers of taggers. This implies the
			// structure of the virtual DOM has changed.
			if (nesting && aTaggers.length !== bTaggers.length)
			{
				patches.push(makePatch('p-redraw', index, b));
				return;
			}

			// check if taggers are "the same"
			if (nesting ? !pairwiseRefEqual(aTaggers, bTaggers) : aTaggers !== bTaggers)
			{
				patches.push(makePatch('p-tagger', index, bTaggers));
			}

			// diff everything below the taggers
			diffHelp(aSubNode, bSubNode, patches, index + 1);
			return;

		case 'text':
			if (a.text !== b.text)
			{
				patches.push(makePatch('p-text', index, b.text));
				return;
			}

			return;

		case 'node':
			// Bail if obvious indicators have changed. Implies more serious
			// structural changes such that it's not worth it to diff.
			if (a.tag !== b.tag || a.namespace !== b.namespace)
			{
				patches.push(makePatch('p-redraw', index, b));
				return;
			}

			var factsDiff = diffFacts(a.facts, b.facts);

			if (typeof factsDiff !== 'undefined')
			{
				patches.push(makePatch('p-facts', index, factsDiff));
			}

			diffChildren(a, b, patches, index);
			return;

		case 'keyed-node':
			// Bail if obvious indicators have changed. Implies more serious
			// structural changes such that it's not worth it to diff.
			if (a.tag !== b.tag || a.namespace !== b.namespace)
			{
				patches.push(makePatch('p-redraw', index, b));
				return;
			}

			var factsDiff = diffFacts(a.facts, b.facts);

			if (typeof factsDiff !== 'undefined')
			{
				patches.push(makePatch('p-facts', index, factsDiff));
			}

			diffKeyedChildren(a, b, patches, index);
			return;

		case 'custom':
			if (a.impl !== b.impl)
			{
				patches.push(makePatch('p-redraw', index, b));
				return;
			}

			var factsDiff = diffFacts(a.facts, b.facts);
			if (typeof factsDiff !== 'undefined')
			{
				patches.push(makePatch('p-facts', index, factsDiff));
			}

			var patch = b.impl.diff(a,b);
			if (patch)
			{
				patches.push(makePatch('p-custom', index, patch));
				return;
			}

			return;
	}
}


// assumes the incoming arrays are the same length
function pairwiseRefEqual(as, bs)
{
	for (var i = 0; i < as.length; i++)
	{
		if (as[i] !== bs[i])
		{
			return false;
		}
	}

	return true;
}


// TODO Instead of creating a new diff object, it's possible to just test if
// there *is* a diff. During the actual patch, do the diff again and make the
// modifications directly. This way, there's no new allocations. Worth it?
function diffFacts(a, b, category)
{
	var diff;

	// look for changes and removals
	for (var aKey in a)
	{
		if (aKey === STYLE_KEY || aKey === EVENT_KEY || aKey === ATTR_KEY || aKey === ATTR_NS_KEY)
		{
			var subDiff = diffFacts(a[aKey], b[aKey] || {}, aKey);
			if (subDiff)
			{
				diff = diff || {};
				diff[aKey] = subDiff;
			}
			continue;
		}

		// remove if not in the new facts
		if (!(aKey in b))
		{
			diff = diff || {};
			diff[aKey] =
				(typeof category === 'undefined')
					? (typeof a[aKey] === 'string' ? '' : null)
					:
				(category === STYLE_KEY)
					? ''
					:
				(category === EVENT_KEY || category === ATTR_KEY)
					? undefined
					:
				{ namespace: a[aKey].namespace, value: undefined };

			continue;
		}

		var aValue = a[aKey];
		var bValue = b[aKey];

		// reference equal, so don't worry about it
		if (aValue === bValue && aKey !== 'value'
			|| category === EVENT_KEY && equalEvents(aValue, bValue))
		{
			continue;
		}

		diff = diff || {};
		diff[aKey] = bValue;
	}

	// add new stuff
	for (var bKey in b)
	{
		if (!(bKey in a))
		{
			diff = diff || {};
			diff[bKey] = b[bKey];
		}
	}

	return diff;
}


function diffChildren(aParent, bParent, patches, rootIndex)
{
	var aChildren = aParent.children;
	var bChildren = bParent.children;

	var aLen = aChildren.length;
	var bLen = bChildren.length;

	// FIGURE OUT IF THERE ARE INSERTS OR REMOVALS

	if (aLen > bLen)
	{
		patches.push(makePatch('p-remove-last', rootIndex, aLen - bLen));
	}
	else if (aLen < bLen)
	{
		patches.push(makePatch('p-append', rootIndex, bChildren.slice(aLen)));
	}

	// PAIRWISE DIFF EVERYTHING ELSE

	var index = rootIndex;
	var minLen = aLen < bLen ? aLen : bLen;
	for (var i = 0; i < minLen; i++)
	{
		index++;
		var aChild = aChildren[i];
		diffHelp(aChild, bChildren[i], patches, index);
		index += aChild.descendantsCount || 0;
	}
}



////////////  KEYED DIFF  ////////////


function diffKeyedChildren(aParent, bParent, patches, rootIndex)
{
	var localPatches = [];

	var changes = {}; // Dict String Entry
	var inserts = []; // Array { index : Int, entry : Entry }
	// type Entry = { tag : String, vnode : VNode, index : Int, data : _ }

	var aChildren = aParent.children;
	var bChildren = bParent.children;
	var aLen = aChildren.length;
	var bLen = bChildren.length;
	var aIndex = 0;
	var bIndex = 0;

	var index = rootIndex;

	while (aIndex < aLen && bIndex < bLen)
	{
		var a = aChildren[aIndex];
		var b = bChildren[bIndex];

		var aKey = a._0;
		var bKey = b._0;
		var aNode = a._1;
		var bNode = b._1;

		// check if keys match

		if (aKey === bKey)
		{
			index++;
			diffHelp(aNode, bNode, localPatches, index);
			index += aNode.descendantsCount || 0;

			aIndex++;
			bIndex++;
			continue;
		}

		// look ahead 1 to detect insertions and removals.

		var aLookAhead = aIndex + 1 < aLen;
		var bLookAhead = bIndex + 1 < bLen;

		if (aLookAhead)
		{
			var aNext = aChildren[aIndex + 1];
			var aNextKey = aNext._0;
			var aNextNode = aNext._1;
			var oldMatch = bKey === aNextKey;
		}

		if (bLookAhead)
		{
			var bNext = bChildren[bIndex + 1];
			var bNextKey = bNext._0;
			var bNextNode = bNext._1;
			var newMatch = aKey === bNextKey;
		}


		// swap a and b
		if (aLookAhead && bLookAhead && newMatch && oldMatch)
		{
			index++;
			diffHelp(aNode, bNextNode, localPatches, index);
			insertNode(changes, localPatches, aKey, bNode, bIndex, inserts);
			index += aNode.descendantsCount || 0;

			index++;
			removeNode(changes, localPatches, aKey, aNextNode, index);
			index += aNextNode.descendantsCount || 0;

			aIndex += 2;
			bIndex += 2;
			continue;
		}

		// insert b
		if (bLookAhead && newMatch)
		{
			index++;
			insertNode(changes, localPatches, bKey, bNode, bIndex, inserts);
			diffHelp(aNode, bNextNode, localPatches, index);
			index += aNode.descendantsCount || 0;

			aIndex += 1;
			bIndex += 2;
			continue;
		}

		// remove a
		if (aLookAhead && oldMatch)
		{
			index++;
			removeNode(changes, localPatches, aKey, aNode, index);
			index += aNode.descendantsCount || 0;

			index++;
			diffHelp(aNextNode, bNode, localPatches, index);
			index += aNextNode.descendantsCount || 0;

			aIndex += 2;
			bIndex += 1;
			continue;
		}

		// remove a, insert b
		if (aLookAhead && bLookAhead && aNextKey === bNextKey)
		{
			index++;
			removeNode(changes, localPatches, aKey, aNode, index);
			insertNode(changes, localPatches, bKey, bNode, bIndex, inserts);
			index += aNode.descendantsCount || 0;

			index++;
			diffHelp(aNextNode, bNextNode, localPatches, index);
			index += aNextNode.descendantsCount || 0;

			aIndex += 2;
			bIndex += 2;
			continue;
		}

		break;
	}

	// eat up any remaining nodes with removeNode and insertNode

	while (aIndex < aLen)
	{
		index++;
		var a = aChildren[aIndex];
		var aNode = a._1;
		removeNode(changes, localPatches, a._0, aNode, index);
		index += aNode.descendantsCount || 0;
		aIndex++;
	}

	var endInserts;
	while (bIndex < bLen)
	{
		endInserts = endInserts || [];
		var b = bChildren[bIndex];
		insertNode(changes, localPatches, b._0, b._1, undefined, endInserts);
		bIndex++;
	}

	if (localPatches.length > 0 || inserts.length > 0 || typeof endInserts !== 'undefined')
	{
		patches.push(makePatch('p-reorder', rootIndex, {
			patches: localPatches,
			inserts: inserts,
			endInserts: endInserts
		}));
	}
}



////////////  CHANGES FROM KEYED DIFF  ////////////


var POSTFIX = '_elmW6BL';


function insertNode(changes, localPatches, key, vnode, bIndex, inserts)
{
	var entry = changes[key];

	// never seen this key before
	if (typeof entry === 'undefined')
	{
		entry = {
			tag: 'insert',
			vnode: vnode,
			index: bIndex,
			data: undefined
		};

		inserts.push({ index: bIndex, entry: entry });
		changes[key] = entry;

		return;
	}

	// this key was removed earlier, a match!
	if (entry.tag === 'remove')
	{
		inserts.push({ index: bIndex, entry: entry });

		entry.tag = 'move';
		var subPatches = [];
		diffHelp(entry.vnode, vnode, subPatches, entry.index);
		entry.index = bIndex;
		entry.data.data = {
			patches: subPatches,
			entry: entry
		};

		return;
	}

	// this key has already been inserted or moved, a duplicate!
	insertNode(changes, localPatches, key + POSTFIX, vnode, bIndex, inserts);
}


function removeNode(changes, localPatches, key, vnode, index)
{
	var entry = changes[key];

	// never seen this key before
	if (typeof entry === 'undefined')
	{
		var patch = makePatch('p-remove', index, undefined);
		localPatches.push(patch);

		changes[key] = {
			tag: 'remove',
			vnode: vnode,
			index: index,
			data: patch
		};

		return;
	}

	// this key was inserted earlier, a match!
	if (entry.tag === 'insert')
	{
		entry.tag = 'move';
		var subPatches = [];
		diffHelp(vnode, entry.vnode, subPatches, index);

		var patch = makePatch('p-remove', index, {
			patches: subPatches,
			entry: entry
		});
		localPatches.push(patch);

		return;
	}

	// this key has already been removed or moved, a duplicate!
	removeNode(changes, localPatches, key + POSTFIX, vnode, index);
}



////////////  ADD DOM NODES  ////////////
//
// Each DOM node has an "index" assigned in order of traversal. It is important
// to minimize our crawl over the actual DOM, so these indexes (along with the
// descendantsCount of virtual nodes) let us skip touching entire subtrees of
// the DOM if we know there are no patches there.


function addDomNodes(domNode, vNode, patches, eventNode)
{
	addDomNodesHelp(domNode, vNode, patches, 0, 0, vNode.descendantsCount, eventNode);
}


// assumes `patches` is non-empty and indexes increase monotonically.
function addDomNodesHelp(domNode, vNode, patches, i, low, high, eventNode)
{
	var patch = patches[i];
	var index = patch.index;

	while (index === low)
	{
		var patchType = patch.type;

		if (patchType === 'p-thunk')
		{
			addDomNodes(domNode, vNode.node, patch.data, eventNode);
		}
		else if (patchType === 'p-reorder')
		{
			patch.domNode = domNode;
			patch.eventNode = eventNode;

			var subPatches = patch.data.patches;
			if (subPatches.length > 0)
			{
				addDomNodesHelp(domNode, vNode, subPatches, 0, low, high, eventNode);
			}
		}
		else if (patchType === 'p-remove')
		{
			patch.domNode = domNode;
			patch.eventNode = eventNode;

			var data = patch.data;
			if (typeof data !== 'undefined')
			{
				data.entry.data = domNode;
				var subPatches = data.patches;
				if (subPatches.length > 0)
				{
					addDomNodesHelp(domNode, vNode, subPatches, 0, low, high, eventNode);
				}
			}
		}
		else
		{
			patch.domNode = domNode;
			patch.eventNode = eventNode;
		}

		i++;

		if (!(patch = patches[i]) || (index = patch.index) > high)
		{
			return i;
		}
	}

	switch (vNode.type)
	{
		case 'tagger':
			var subNode = vNode.node;

			while (subNode.type === "tagger")
			{
				subNode = subNode.node;
			}

			return addDomNodesHelp(domNode, subNode, patches, i, low + 1, high, domNode.elm_event_node_ref);

		case 'node':
			var vChildren = vNode.children;
			var childNodes = domNode.childNodes;
			for (var j = 0; j < vChildren.length; j++)
			{
				low++;
				var vChild = vChildren[j];
				var nextLow = low + (vChild.descendantsCount || 0);
				if (low <= index && index <= nextLow)
				{
					i = addDomNodesHelp(childNodes[j], vChild, patches, i, low, nextLow, eventNode);
					if (!(patch = patches[i]) || (index = patch.index) > high)
					{
						return i;
					}
				}
				low = nextLow;
			}
			return i;

		case 'keyed-node':
			var vChildren = vNode.children;
			var childNodes = domNode.childNodes;
			for (var j = 0; j < vChildren.length; j++)
			{
				low++;
				var vChild = vChildren[j]._1;
				var nextLow = low + (vChild.descendantsCount || 0);
				if (low <= index && index <= nextLow)
				{
					i = addDomNodesHelp(childNodes[j], vChild, patches, i, low, nextLow, eventNode);
					if (!(patch = patches[i]) || (index = patch.index) > high)
					{
						return i;
					}
				}
				low = nextLow;
			}
			return i;

		case 'text':
		case 'thunk':
			throw new Error('should never traverse `text` or `thunk` nodes like this');
	}
}



////////////  APPLY PATCHES  ////////////


function applyPatches(rootDomNode, oldVirtualNode, patches, eventNode)
{
	if (patches.length === 0)
	{
		return rootDomNode;
	}

	addDomNodes(rootDomNode, oldVirtualNode, patches, eventNode);
	return applyPatchesHelp(rootDomNode, patches);
}

function applyPatchesHelp(rootDomNode, patches)
{
	for (var i = 0; i < patches.length; i++)
	{
		var patch = patches[i];
		var localDomNode = patch.domNode
		var newNode = applyPatch(localDomNode, patch);
		if (localDomNode === rootDomNode)
		{
			rootDomNode = newNode;
		}
	}
	return rootDomNode;
}

function applyPatch(domNode, patch)
{
	switch (patch.type)
	{
		case 'p-redraw':
			return applyPatchRedraw(domNode, patch.data, patch.eventNode);

		case 'p-facts':
			applyFacts(domNode, patch.eventNode, patch.data);
			return domNode;

		case 'p-text':
			domNode.replaceData(0, domNode.length, patch.data);
			return domNode;

		case 'p-thunk':
			return applyPatchesHelp(domNode, patch.data);

		case 'p-tagger':
			if (typeof domNode.elm_event_node_ref !== 'undefined')
			{
				domNode.elm_event_node_ref.tagger = patch.data;
			}
			else
			{
				domNode.elm_event_node_ref = { tagger: patch.data, parent: patch.eventNode };
			}
			return domNode;

		case 'p-remove-last':
			var i = patch.data;
			while (i--)
			{
				domNode.removeChild(domNode.lastChild);
			}
			return domNode;

		case 'p-append':
			var newNodes = patch.data;
			for (var i = 0; i < newNodes.length; i++)
			{
				domNode.appendChild(render(newNodes[i], patch.eventNode));
			}
			return domNode;

		case 'p-remove':
			var data = patch.data;
			if (typeof data === 'undefined')
			{
				domNode.parentNode.removeChild(domNode);
				return domNode;
			}
			var entry = data.entry;
			if (typeof entry.index !== 'undefined')
			{
				domNode.parentNode.removeChild(domNode);
			}
			entry.data = applyPatchesHelp(domNode, data.patches);
			return domNode;

		case 'p-reorder':
			return applyPatchReorder(domNode, patch);

		case 'p-custom':
			var impl = patch.data;
			return impl.applyPatch(domNode, impl.data);

		default:
			throw new Error('Ran into an unknown patch!');
	}
}


function applyPatchRedraw(domNode, vNode, eventNode)
{
	var parentNode = domNode.parentNode;
	var newNode = render(vNode, eventNode);

	if (typeof newNode.elm_event_node_ref === 'undefined')
	{
		newNode.elm_event_node_ref = domNode.elm_event_node_ref;
	}

	if (parentNode && newNode !== domNode)
	{
		parentNode.replaceChild(newNode, domNode);
	}
	return newNode;
}


function applyPatchReorder(domNode, patch)
{
	var data = patch.data;

	// remove end inserts
	var frag = applyPatchReorderEndInsertsHelp(data.endInserts, patch);

	// removals
	domNode = applyPatchesHelp(domNode, data.patches);

	// inserts
	var inserts = data.inserts;
	for (var i = 0; i < inserts.length; i++)
	{
		var insert = inserts[i];
		var entry = insert.entry;
		var node = entry.tag === 'move'
			? entry.data
			: render(entry.vnode, patch.eventNode);
		domNode.insertBefore(node, domNode.childNodes[insert.index]);
	}

	// add end inserts
	if (typeof frag !== 'undefined')
	{
		domNode.appendChild(frag);
	}

	return domNode;
}


function applyPatchReorderEndInsertsHelp(endInserts, patch)
{
	if (typeof endInserts === 'undefined')
	{
		return;
	}

	var frag = localDoc.createDocumentFragment();
	for (var i = 0; i < endInserts.length; i++)
	{
		var insert = endInserts[i];
		var entry = insert.entry;
		frag.appendChild(entry.tag === 'move'
			? entry.data
			: render(entry.vnode, patch.eventNode)
		);
	}
	return frag;
}


// PROGRAMS

var program = makeProgram(checkNoFlags);
var programWithFlags = makeProgram(checkYesFlags);

function makeProgram(flagChecker)
{
	return F2(function(debugWrap, impl)
	{
		return function(flagDecoder)
		{
			return function(object, moduleName, debugMetadata)
			{
				var checker = flagChecker(flagDecoder, moduleName);
				if (typeof debugMetadata === 'undefined')
				{
					normalSetup(impl, object, moduleName, checker);
				}
				else
				{
					debugSetup(A2(debugWrap, debugMetadata, impl), object, moduleName, checker);
				}
			};
		};
	});
}

function staticProgram(vNode)
{
	var nothing = _elm_lang$core$Native_Utils.Tuple2(
		_elm_lang$core$Native_Utils.Tuple0,
		_elm_lang$core$Platform_Cmd$none
	);
	return A2(program, _elm_lang$virtual_dom$VirtualDom_Debug$wrap, {
		init: nothing,
		view: function() { return vNode; },
		update: F2(function() { return nothing; }),
		subscriptions: function() { return _elm_lang$core$Platform_Sub$none; }
	})();
}


// FLAG CHECKERS

function checkNoFlags(flagDecoder, moduleName)
{
	return function(init, flags, domNode)
	{
		if (typeof flags === 'undefined')
		{
			return init;
		}

		var errorMessage =
			'The `' + moduleName + '` module does not need flags.\n'
			+ 'Initialize it with no arguments and you should be all set!';

		crash(errorMessage, domNode);
	};
}

function checkYesFlags(flagDecoder, moduleName)
{
	return function(init, flags, domNode)
	{
		if (typeof flagDecoder === 'undefined')
		{
			var errorMessage =
				'Are you trying to sneak a Never value into Elm? Trickster!\n'
				+ 'It looks like ' + moduleName + '.main is defined with `programWithFlags` but has type `Program Never`.\n'
				+ 'Use `program` instead if you do not want flags.'

			crash(errorMessage, domNode);
		}

		var result = A2(_elm_lang$core$Native_Json.run, flagDecoder, flags);
		if (result.ctor === 'Ok')
		{
			return init(result._0);
		}

		var errorMessage =
			'Trying to initialize the `' + moduleName + '` module with an unexpected flag.\n'
			+ 'I tried to convert it to an Elm value, but ran into this problem:\n\n'
			+ result._0;

		crash(errorMessage, domNode);
	};
}

function crash(errorMessage, domNode)
{
	if (domNode)
	{
		domNode.innerHTML =
			'<div style="padding-left:1em;">'
			+ '<h2 style="font-weight:normal;"><b>Oops!</b> Something went wrong when starting your Elm program.</h2>'
			+ '<pre style="padding-left:1em;">' + errorMessage + '</pre>'
			+ '</div>';
	}

	throw new Error(errorMessage);
}


//  NORMAL SETUP

function normalSetup(impl, object, moduleName, flagChecker)
{
	object['embed'] = function embed(node, flags)
	{
		while (node.lastChild)
		{
			node.removeChild(node.lastChild);
		}

		return _elm_lang$core$Native_Platform.initialize(
			flagChecker(impl.init, flags, node),
			impl.update,
			impl.subscriptions,
			normalRenderer(node, impl.view)
		);
	};

	object['fullscreen'] = function fullscreen(flags)
	{
		return _elm_lang$core$Native_Platform.initialize(
			flagChecker(impl.init, flags, document.body),
			impl.update,
			impl.subscriptions,
			normalRenderer(document.body, impl.view)
		);
	};
}

function normalRenderer(parentNode, view)
{
	return function(tagger, initialModel)
	{
		var eventNode = { tagger: tagger, parent: undefined };
		var initialVirtualNode = view(initialModel);
		var domNode = render(initialVirtualNode, eventNode);
		parentNode.appendChild(domNode);
		return makeStepper(domNode, view, initialVirtualNode, eventNode);
	};
}


// STEPPER

var rAF =
	typeof requestAnimationFrame !== 'undefined'
		? requestAnimationFrame
		: function(callback) { setTimeout(callback, 1000 / 60); };

function makeStepper(domNode, view, initialVirtualNode, eventNode)
{
	var state = 'NO_REQUEST';
	var currNode = initialVirtualNode;
	var nextModel;

	function updateIfNeeded()
	{
		switch (state)
		{
			case 'NO_REQUEST':
				throw new Error(
					'Unexpected draw callback.\n' +
					'Please report this to <https://github.com/elm-lang/virtual-dom/issues>.'
				);

			case 'PENDING_REQUEST':
				rAF(updateIfNeeded);
				state = 'EXTRA_REQUEST';

				var nextNode = view(nextModel);
				var patches = diff(currNode, nextNode);
				domNode = applyPatches(domNode, currNode, patches, eventNode);
				currNode = nextNode;

				return;

			case 'EXTRA_REQUEST':
				state = 'NO_REQUEST';
				return;
		}
	}

	return function stepper(model)
	{
		if (state === 'NO_REQUEST')
		{
			rAF(updateIfNeeded);
		}
		state = 'PENDING_REQUEST';
		nextModel = model;
	};
}


// DEBUG SETUP

function debugSetup(impl, object, moduleName, flagChecker)
{
	object['fullscreen'] = function fullscreen(flags)
	{
		var popoutRef = { doc: undefined };
		return _elm_lang$core$Native_Platform.initialize(
			flagChecker(impl.init, flags, document.body),
			impl.update(scrollTask(popoutRef)),
			impl.subscriptions,
			debugRenderer(moduleName, document.body, popoutRef, impl.view, impl.viewIn, impl.viewOut)
		);
	};

	object['embed'] = function fullscreen(node, flags)
	{
		var popoutRef = { doc: undefined };
		return _elm_lang$core$Native_Platform.initialize(
			flagChecker(impl.init, flags, node),
			impl.update(scrollTask(popoutRef)),
			impl.subscriptions,
			debugRenderer(moduleName, node, popoutRef, impl.view, impl.viewIn, impl.viewOut)
		);
	};
}

function scrollTask(popoutRef)
{
	return _elm_lang$core$Native_Scheduler.nativeBinding(function(callback)
	{
		var doc = popoutRef.doc;
		if (doc)
		{
			var msgs = doc.getElementsByClassName('debugger-sidebar-messages')[0];
			if (msgs)
			{
				msgs.scrollTop = msgs.scrollHeight;
			}
		}
		callback(_elm_lang$core$Native_Scheduler.succeed(_elm_lang$core$Native_Utils.Tuple0));
	});
}


function debugRenderer(moduleName, parentNode, popoutRef, view, viewIn, viewOut)
{
	return function(tagger, initialModel)
	{
		var appEventNode = { tagger: tagger, parent: undefined };
		var eventNode = { tagger: tagger, parent: undefined };

		// make normal stepper
		var appVirtualNode = view(initialModel);
		var appNode = render(appVirtualNode, appEventNode);
		parentNode.appendChild(appNode);
		var appStepper = makeStepper(appNode, view, appVirtualNode, appEventNode);

		// make overlay stepper
		var overVirtualNode = viewIn(initialModel)._1;
		var overNode = render(overVirtualNode, eventNode);
		parentNode.appendChild(overNode);
		var wrappedViewIn = wrapViewIn(appEventNode, overNode, viewIn);
		var overStepper = makeStepper(overNode, wrappedViewIn, overVirtualNode, eventNode);

		// make debugger stepper
		var debugStepper = makeDebugStepper(initialModel, viewOut, eventNode, parentNode, moduleName, popoutRef);

		return function stepper(model)
		{
			appStepper(model);
			overStepper(model);
			debugStepper(model);
		}
	};
}

function makeDebugStepper(initialModel, view, eventNode, parentNode, moduleName, popoutRef)
{
	var curr;
	var domNode;

	return function stepper(model)
	{
		if (!model.isDebuggerOpen)
		{
			return;
		}

		if (!popoutRef.doc)
		{
			curr = view(model);
			domNode = openDebugWindow(moduleName, popoutRef, curr, eventNode);
			return;
		}

		// switch to document of popout
		localDoc = popoutRef.doc;

		var next = view(model);
		var patches = diff(curr, next);
		domNode = applyPatches(domNode, curr, patches, eventNode);
		curr = next;

		// switch back to normal document
		localDoc = document;
	};
}

function openDebugWindow(moduleName, popoutRef, virtualNode, eventNode)
{
	var w = 900;
	var h = 360;
	var x = screen.width - w;
	var y = screen.height - h;
	var debugWindow = window.open('', '', 'width=' + w + ',height=' + h + ',left=' + x + ',top=' + y);

	// switch to window document
	localDoc = debugWindow.document;

	popoutRef.doc = localDoc;
	localDoc.title = 'Debugger - ' + moduleName;
	localDoc.body.style.margin = '0';
	localDoc.body.style.padding = '0';
	var domNode = render(virtualNode, eventNode);
	localDoc.body.appendChild(domNode);

	localDoc.addEventListener('keydown', function(event) {
		if (event.metaKey && event.which === 82)
		{
			window.location.reload();
		}
		if (event.which === 38)
		{
			eventNode.tagger({ ctor: 'Up' });
			event.preventDefault();
		}
		if (event.which === 40)
		{
			eventNode.tagger({ ctor: 'Down' });
			event.preventDefault();
		}
	});

	function close()
	{
		popoutRef.doc = undefined;
		debugWindow.close();
	}
	window.addEventListener('unload', close);
	debugWindow.addEventListener('unload', function() {
		popoutRef.doc = undefined;
		window.removeEventListener('unload', close);
		eventNode.tagger({ ctor: 'Close' });
	});

	// switch back to the normal document
	localDoc = document;

	return domNode;
}


// BLOCK EVENTS

function wrapViewIn(appEventNode, overlayNode, viewIn)
{
	var ignorer = makeIgnorer(overlayNode);
	var blocking = 'Normal';
	var overflow;

	var normalTagger = appEventNode.tagger;
	var blockTagger = function() {};

	return function(model)
	{
		var tuple = viewIn(model);
		var newBlocking = tuple._0.ctor;
		appEventNode.tagger = newBlocking === 'Normal' ? normalTagger : blockTagger;
		if (blocking !== newBlocking)
		{
			traverse('removeEventListener', ignorer, blocking);
			traverse('addEventListener', ignorer, newBlocking);

			if (blocking === 'Normal')
			{
				overflow = document.body.style.overflow;
				document.body.style.overflow = 'hidden';
			}

			if (newBlocking === 'Normal')
			{
				document.body.style.overflow = overflow;
			}

			blocking = newBlocking;
		}
		return tuple._1;
	}
}

function traverse(verbEventListener, ignorer, blocking)
{
	switch(blocking)
	{
		case 'Normal':
			return;

		case 'Pause':
			return traverseHelp(verbEventListener, ignorer, mostEvents);

		case 'Message':
			return traverseHelp(verbEventListener, ignorer, allEvents);
	}
}

function traverseHelp(verbEventListener, handler, eventNames)
{
	for (var i = 0; i < eventNames.length; i++)
	{
		document.body[verbEventListener](eventNames[i], handler, true);
	}
}

function makeIgnorer(overlayNode)
{
	return function(event)
	{
		if (event.type === 'keydown' && event.metaKey && event.which === 82)
		{
			return;
		}

		var isScroll = event.type === 'scroll' || event.type === 'wheel';

		var node = event.target;
		while (node !== null)
		{
			if (node.className === 'elm-overlay-message-details' && isScroll)
			{
				return;
			}

			if (node === overlayNode && !isScroll)
			{
				return;
			}
			node = node.parentNode;
		}

		event.stopPropagation();
		event.preventDefault();
	}
}

var mostEvents = [
	'click', 'dblclick', 'mousemove',
	'mouseup', 'mousedown', 'mouseenter', 'mouseleave',
	'touchstart', 'touchend', 'touchcancel', 'touchmove',
	'pointerdown', 'pointerup', 'pointerover', 'pointerout',
	'pointerenter', 'pointerleave', 'pointermove', 'pointercancel',
	'dragstart', 'drag', 'dragend', 'dragenter', 'dragover', 'dragleave', 'drop',
	'keyup', 'keydown', 'keypress',
	'input', 'change',
	'focus', 'blur'
];

var allEvents = mostEvents.concat('wheel', 'scroll');


return {
	node: node,
	text: text,
	custom: custom,
	map: F2(map),

	on: F3(on),
	style: style,
	property: F2(property),
	attribute: F2(attribute),
	attributeNS: F3(attributeNS),
	mapProperty: F2(mapProperty),

	lazy: F2(lazy),
	lazy2: F3(lazy2),
	lazy3: F4(lazy3),
	keyedNode: F3(keyedNode),

	program: program,
	programWithFlags: programWithFlags,
	staticProgram: staticProgram
};

}();

var _elm_lang$virtual_dom$VirtualDom$programWithFlags = function (impl) {
	return A2(_elm_lang$virtual_dom$Native_VirtualDom.programWithFlags, _elm_lang$virtual_dom$VirtualDom_Debug$wrapWithFlags, impl);
};
var _elm_lang$virtual_dom$VirtualDom$program = function (impl) {
	return A2(_elm_lang$virtual_dom$Native_VirtualDom.program, _elm_lang$virtual_dom$VirtualDom_Debug$wrap, impl);
};
var _elm_lang$virtual_dom$VirtualDom$keyedNode = _elm_lang$virtual_dom$Native_VirtualDom.keyedNode;
var _elm_lang$virtual_dom$VirtualDom$lazy3 = _elm_lang$virtual_dom$Native_VirtualDom.lazy3;
var _elm_lang$virtual_dom$VirtualDom$lazy2 = _elm_lang$virtual_dom$Native_VirtualDom.lazy2;
var _elm_lang$virtual_dom$VirtualDom$lazy = _elm_lang$virtual_dom$Native_VirtualDom.lazy;
var _elm_lang$virtual_dom$VirtualDom$defaultOptions = {stopPropagation: false, preventDefault: false};
var _elm_lang$virtual_dom$VirtualDom$onWithOptions = _elm_lang$virtual_dom$Native_VirtualDom.on;
var _elm_lang$virtual_dom$VirtualDom$on = F2(
	function (eventName, decoder) {
		return A3(_elm_lang$virtual_dom$VirtualDom$onWithOptions, eventName, _elm_lang$virtual_dom$VirtualDom$defaultOptions, decoder);
	});
var _elm_lang$virtual_dom$VirtualDom$style = _elm_lang$virtual_dom$Native_VirtualDom.style;
var _elm_lang$virtual_dom$VirtualDom$mapProperty = _elm_lang$virtual_dom$Native_VirtualDom.mapProperty;
var _elm_lang$virtual_dom$VirtualDom$attributeNS = _elm_lang$virtual_dom$Native_VirtualDom.attributeNS;
var _elm_lang$virtual_dom$VirtualDom$attribute = _elm_lang$virtual_dom$Native_VirtualDom.attribute;
var _elm_lang$virtual_dom$VirtualDom$property = _elm_lang$virtual_dom$Native_VirtualDom.property;
var _elm_lang$virtual_dom$VirtualDom$map = _elm_lang$virtual_dom$Native_VirtualDom.map;
var _elm_lang$virtual_dom$VirtualDom$text = _elm_lang$virtual_dom$Native_VirtualDom.text;
var _elm_lang$virtual_dom$VirtualDom$node = _elm_lang$virtual_dom$Native_VirtualDom.node;
var _elm_lang$virtual_dom$VirtualDom$Options = F2(
	function (a, b) {
		return {stopPropagation: a, preventDefault: b};
	});
var _elm_lang$virtual_dom$VirtualDom$Node = {ctor: 'Node'};
var _elm_lang$virtual_dom$VirtualDom$Property = {ctor: 'Property'};

var _elm_lang$html$Html$programWithFlags = _elm_lang$virtual_dom$VirtualDom$programWithFlags;
var _elm_lang$html$Html$program = _elm_lang$virtual_dom$VirtualDom$program;
var _elm_lang$html$Html$beginnerProgram = function (_p0) {
	var _p1 = _p0;
	return _elm_lang$html$Html$program(
		{
			init: A2(
				_elm_lang$core$Platform_Cmd_ops['!'],
				_p1.model,
				{ctor: '[]'}),
			update: F2(
				function (msg, model) {
					return A2(
						_elm_lang$core$Platform_Cmd_ops['!'],
						A2(_p1.update, msg, model),
						{ctor: '[]'});
				}),
			view: _p1.view,
			subscriptions: function (_p2) {
				return _elm_lang$core$Platform_Sub$none;
			}
		});
};
var _elm_lang$html$Html$map = _elm_lang$virtual_dom$VirtualDom$map;
var _elm_lang$html$Html$text = _elm_lang$virtual_dom$VirtualDom$text;
var _elm_lang$html$Html$node = _elm_lang$virtual_dom$VirtualDom$node;
var _elm_lang$html$Html$body = _elm_lang$html$Html$node('body');
var _elm_lang$html$Html$section = _elm_lang$html$Html$node('section');
var _elm_lang$html$Html$nav = _elm_lang$html$Html$node('nav');
var _elm_lang$html$Html$article = _elm_lang$html$Html$node('article');
var _elm_lang$html$Html$aside = _elm_lang$html$Html$node('aside');
var _elm_lang$html$Html$h1 = _elm_lang$html$Html$node('h1');
var _elm_lang$html$Html$h2 = _elm_lang$html$Html$node('h2');
var _elm_lang$html$Html$h3 = _elm_lang$html$Html$node('h3');
var _elm_lang$html$Html$h4 = _elm_lang$html$Html$node('h4');
var _elm_lang$html$Html$h5 = _elm_lang$html$Html$node('h5');
var _elm_lang$html$Html$h6 = _elm_lang$html$Html$node('h6');
var _elm_lang$html$Html$header = _elm_lang$html$Html$node('header');
var _elm_lang$html$Html$footer = _elm_lang$html$Html$node('footer');
var _elm_lang$html$Html$address = _elm_lang$html$Html$node('address');
var _elm_lang$html$Html$main_ = _elm_lang$html$Html$node('main');
var _elm_lang$html$Html$p = _elm_lang$html$Html$node('p');
var _elm_lang$html$Html$hr = _elm_lang$html$Html$node('hr');
var _elm_lang$html$Html$pre = _elm_lang$html$Html$node('pre');
var _elm_lang$html$Html$blockquote = _elm_lang$html$Html$node('blockquote');
var _elm_lang$html$Html$ol = _elm_lang$html$Html$node('ol');
var _elm_lang$html$Html$ul = _elm_lang$html$Html$node('ul');
var _elm_lang$html$Html$li = _elm_lang$html$Html$node('li');
var _elm_lang$html$Html$dl = _elm_lang$html$Html$node('dl');
var _elm_lang$html$Html$dt = _elm_lang$html$Html$node('dt');
var _elm_lang$html$Html$dd = _elm_lang$html$Html$node('dd');
var _elm_lang$html$Html$figure = _elm_lang$html$Html$node('figure');
var _elm_lang$html$Html$figcaption = _elm_lang$html$Html$node('figcaption');
var _elm_lang$html$Html$div = _elm_lang$html$Html$node('div');
var _elm_lang$html$Html$a = _elm_lang$html$Html$node('a');
var _elm_lang$html$Html$em = _elm_lang$html$Html$node('em');
var _elm_lang$html$Html$strong = _elm_lang$html$Html$node('strong');
var _elm_lang$html$Html$small = _elm_lang$html$Html$node('small');
var _elm_lang$html$Html$s = _elm_lang$html$Html$node('s');
var _elm_lang$html$Html$cite = _elm_lang$html$Html$node('cite');
var _elm_lang$html$Html$q = _elm_lang$html$Html$node('q');
var _elm_lang$html$Html$dfn = _elm_lang$html$Html$node('dfn');
var _elm_lang$html$Html$abbr = _elm_lang$html$Html$node('abbr');
var _elm_lang$html$Html$time = _elm_lang$html$Html$node('time');
var _elm_lang$html$Html$code = _elm_lang$html$Html$node('code');
var _elm_lang$html$Html$var = _elm_lang$html$Html$node('var');
var _elm_lang$html$Html$samp = _elm_lang$html$Html$node('samp');
var _elm_lang$html$Html$kbd = _elm_lang$html$Html$node('kbd');
var _elm_lang$html$Html$sub = _elm_lang$html$Html$node('sub');
var _elm_lang$html$Html$sup = _elm_lang$html$Html$node('sup');
var _elm_lang$html$Html$i = _elm_lang$html$Html$node('i');
var _elm_lang$html$Html$b = _elm_lang$html$Html$node('b');
var _elm_lang$html$Html$u = _elm_lang$html$Html$node('u');
var _elm_lang$html$Html$mark = _elm_lang$html$Html$node('mark');
var _elm_lang$html$Html$ruby = _elm_lang$html$Html$node('ruby');
var _elm_lang$html$Html$rt = _elm_lang$html$Html$node('rt');
var _elm_lang$html$Html$rp = _elm_lang$html$Html$node('rp');
var _elm_lang$html$Html$bdi = _elm_lang$html$Html$node('bdi');
var _elm_lang$html$Html$bdo = _elm_lang$html$Html$node('bdo');
var _elm_lang$html$Html$span = _elm_lang$html$Html$node('span');
var _elm_lang$html$Html$br = _elm_lang$html$Html$node('br');
var _elm_lang$html$Html$wbr = _elm_lang$html$Html$node('wbr');
var _elm_lang$html$Html$ins = _elm_lang$html$Html$node('ins');
var _elm_lang$html$Html$del = _elm_lang$html$Html$node('del');
var _elm_lang$html$Html$img = _elm_lang$html$Html$node('img');
var _elm_lang$html$Html$iframe = _elm_lang$html$Html$node('iframe');
var _elm_lang$html$Html$embed = _elm_lang$html$Html$node('embed');
var _elm_lang$html$Html$object = _elm_lang$html$Html$node('object');
var _elm_lang$html$Html$param = _elm_lang$html$Html$node('param');
var _elm_lang$html$Html$video = _elm_lang$html$Html$node('video');
var _elm_lang$html$Html$audio = _elm_lang$html$Html$node('audio');
var _elm_lang$html$Html$source = _elm_lang$html$Html$node('source');
var _elm_lang$html$Html$track = _elm_lang$html$Html$node('track');
var _elm_lang$html$Html$canvas = _elm_lang$html$Html$node('canvas');
var _elm_lang$html$Html$math = _elm_lang$html$Html$node('math');
var _elm_lang$html$Html$table = _elm_lang$html$Html$node('table');
var _elm_lang$html$Html$caption = _elm_lang$html$Html$node('caption');
var _elm_lang$html$Html$colgroup = _elm_lang$html$Html$node('colgroup');
var _elm_lang$html$Html$col = _elm_lang$html$Html$node('col');
var _elm_lang$html$Html$tbody = _elm_lang$html$Html$node('tbody');
var _elm_lang$html$Html$thead = _elm_lang$html$Html$node('thead');
var _elm_lang$html$Html$tfoot = _elm_lang$html$Html$node('tfoot');
var _elm_lang$html$Html$tr = _elm_lang$html$Html$node('tr');
var _elm_lang$html$Html$td = _elm_lang$html$Html$node('td');
var _elm_lang$html$Html$th = _elm_lang$html$Html$node('th');
var _elm_lang$html$Html$form = _elm_lang$html$Html$node('form');
var _elm_lang$html$Html$fieldset = _elm_lang$html$Html$node('fieldset');
var _elm_lang$html$Html$legend = _elm_lang$html$Html$node('legend');
var _elm_lang$html$Html$label = _elm_lang$html$Html$node('label');
var _elm_lang$html$Html$input = _elm_lang$html$Html$node('input');
var _elm_lang$html$Html$button = _elm_lang$html$Html$node('button');
var _elm_lang$html$Html$select = _elm_lang$html$Html$node('select');
var _elm_lang$html$Html$datalist = _elm_lang$html$Html$node('datalist');
var _elm_lang$html$Html$optgroup = _elm_lang$html$Html$node('optgroup');
var _elm_lang$html$Html$option = _elm_lang$html$Html$node('option');
var _elm_lang$html$Html$textarea = _elm_lang$html$Html$node('textarea');
var _elm_lang$html$Html$keygen = _elm_lang$html$Html$node('keygen');
var _elm_lang$html$Html$output = _elm_lang$html$Html$node('output');
var _elm_lang$html$Html$progress = _elm_lang$html$Html$node('progress');
var _elm_lang$html$Html$meter = _elm_lang$html$Html$node('meter');
var _elm_lang$html$Html$details = _elm_lang$html$Html$node('details');
var _elm_lang$html$Html$summary = _elm_lang$html$Html$node('summary');
var _elm_lang$html$Html$menuitem = _elm_lang$html$Html$node('menuitem');
var _elm_lang$html$Html$menu = _elm_lang$html$Html$node('menu');

var _elm_lang$html$Html_Attributes$map = _elm_lang$virtual_dom$VirtualDom$mapProperty;
var _elm_lang$html$Html_Attributes$attribute = _elm_lang$virtual_dom$VirtualDom$attribute;
var _elm_lang$html$Html_Attributes$contextmenu = function (value) {
	return A2(_elm_lang$html$Html_Attributes$attribute, 'contextmenu', value);
};
var _elm_lang$html$Html_Attributes$draggable = function (value) {
	return A2(_elm_lang$html$Html_Attributes$attribute, 'draggable', value);
};
var _elm_lang$html$Html_Attributes$itemprop = function (value) {
	return A2(_elm_lang$html$Html_Attributes$attribute, 'itemprop', value);
};
var _elm_lang$html$Html_Attributes$tabindex = function (n) {
	return A2(
		_elm_lang$html$Html_Attributes$attribute,
		'tabIndex',
		_elm_lang$core$Basics$toString(n));
};
var _elm_lang$html$Html_Attributes$charset = function (value) {
	return A2(_elm_lang$html$Html_Attributes$attribute, 'charset', value);
};
var _elm_lang$html$Html_Attributes$height = function (value) {
	return A2(
		_elm_lang$html$Html_Attributes$attribute,
		'height',
		_elm_lang$core$Basics$toString(value));
};
var _elm_lang$html$Html_Attributes$width = function (value) {
	return A2(
		_elm_lang$html$Html_Attributes$attribute,
		'width',
		_elm_lang$core$Basics$toString(value));
};
var _elm_lang$html$Html_Attributes$formaction = function (value) {
	return A2(_elm_lang$html$Html_Attributes$attribute, 'formAction', value);
};
var _elm_lang$html$Html_Attributes$list = function (value) {
	return A2(_elm_lang$html$Html_Attributes$attribute, 'list', value);
};
var _elm_lang$html$Html_Attributes$minlength = function (n) {
	return A2(
		_elm_lang$html$Html_Attributes$attribute,
		'minLength',
		_elm_lang$core$Basics$toString(n));
};
var _elm_lang$html$Html_Attributes$maxlength = function (n) {
	return A2(
		_elm_lang$html$Html_Attributes$attribute,
		'maxlength',
		_elm_lang$core$Basics$toString(n));
};
var _elm_lang$html$Html_Attributes$size = function (n) {
	return A2(
		_elm_lang$html$Html_Attributes$attribute,
		'size',
		_elm_lang$core$Basics$toString(n));
};
var _elm_lang$html$Html_Attributes$form = function (value) {
	return A2(_elm_lang$html$Html_Attributes$attribute, 'form', value);
};
var _elm_lang$html$Html_Attributes$cols = function (n) {
	return A2(
		_elm_lang$html$Html_Attributes$attribute,
		'cols',
		_elm_lang$core$Basics$toString(n));
};
var _elm_lang$html$Html_Attributes$rows = function (n) {
	return A2(
		_elm_lang$html$Html_Attributes$attribute,
		'rows',
		_elm_lang$core$Basics$toString(n));
};
var _elm_lang$html$Html_Attributes$challenge = function (value) {
	return A2(_elm_lang$html$Html_Attributes$attribute, 'challenge', value);
};
var _elm_lang$html$Html_Attributes$media = function (value) {
	return A2(_elm_lang$html$Html_Attributes$attribute, 'media', value);
};
var _elm_lang$html$Html_Attributes$rel = function (value) {
	return A2(_elm_lang$html$Html_Attributes$attribute, 'rel', value);
};
var _elm_lang$html$Html_Attributes$datetime = function (value) {
	return A2(_elm_lang$html$Html_Attributes$attribute, 'datetime', value);
};
var _elm_lang$html$Html_Attributes$pubdate = function (value) {
	return A2(_elm_lang$html$Html_Attributes$attribute, 'pubdate', value);
};
var _elm_lang$html$Html_Attributes$colspan = function (n) {
	return A2(
		_elm_lang$html$Html_Attributes$attribute,
		'colspan',
		_elm_lang$core$Basics$toString(n));
};
var _elm_lang$html$Html_Attributes$rowspan = function (n) {
	return A2(
		_elm_lang$html$Html_Attributes$attribute,
		'rowspan',
		_elm_lang$core$Basics$toString(n));
};
var _elm_lang$html$Html_Attributes$manifest = function (value) {
	return A2(_elm_lang$html$Html_Attributes$attribute, 'manifest', value);
};
var _elm_lang$html$Html_Attributes$property = _elm_lang$virtual_dom$VirtualDom$property;
var _elm_lang$html$Html_Attributes$stringProperty = F2(
	function (name, string) {
		return A2(
			_elm_lang$html$Html_Attributes$property,
			name,
			_elm_lang$core$Json_Encode$string(string));
	});
var _elm_lang$html$Html_Attributes$class = function (name) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'className', name);
};
var _elm_lang$html$Html_Attributes$id = function (name) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'id', name);
};
var _elm_lang$html$Html_Attributes$title = function (name) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'title', name);
};
var _elm_lang$html$Html_Attributes$accesskey = function ($char) {
	return A2(
		_elm_lang$html$Html_Attributes$stringProperty,
		'accessKey',
		_elm_lang$core$String$fromChar($char));
};
var _elm_lang$html$Html_Attributes$dir = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'dir', value);
};
var _elm_lang$html$Html_Attributes$dropzone = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'dropzone', value);
};
var _elm_lang$html$Html_Attributes$lang = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'lang', value);
};
var _elm_lang$html$Html_Attributes$content = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'content', value);
};
var _elm_lang$html$Html_Attributes$httpEquiv = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'httpEquiv', value);
};
var _elm_lang$html$Html_Attributes$language = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'language', value);
};
var _elm_lang$html$Html_Attributes$src = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'src', value);
};
var _elm_lang$html$Html_Attributes$alt = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'alt', value);
};
var _elm_lang$html$Html_Attributes$preload = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'preload', value);
};
var _elm_lang$html$Html_Attributes$poster = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'poster', value);
};
var _elm_lang$html$Html_Attributes$kind = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'kind', value);
};
var _elm_lang$html$Html_Attributes$srclang = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'srclang', value);
};
var _elm_lang$html$Html_Attributes$sandbox = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'sandbox', value);
};
var _elm_lang$html$Html_Attributes$srcdoc = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'srcdoc', value);
};
var _elm_lang$html$Html_Attributes$type_ = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'type', value);
};
var _elm_lang$html$Html_Attributes$value = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'value', value);
};
var _elm_lang$html$Html_Attributes$defaultValue = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'defaultValue', value);
};
var _elm_lang$html$Html_Attributes$placeholder = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'placeholder', value);
};
var _elm_lang$html$Html_Attributes$accept = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'accept', value);
};
var _elm_lang$html$Html_Attributes$acceptCharset = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'acceptCharset', value);
};
var _elm_lang$html$Html_Attributes$action = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'action', value);
};
var _elm_lang$html$Html_Attributes$autocomplete = function (bool) {
	return A2(
		_elm_lang$html$Html_Attributes$stringProperty,
		'autocomplete',
		bool ? 'on' : 'off');
};
var _elm_lang$html$Html_Attributes$enctype = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'enctype', value);
};
var _elm_lang$html$Html_Attributes$method = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'method', value);
};
var _elm_lang$html$Html_Attributes$name = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'name', value);
};
var _elm_lang$html$Html_Attributes$pattern = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'pattern', value);
};
var _elm_lang$html$Html_Attributes$for = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'htmlFor', value);
};
var _elm_lang$html$Html_Attributes$max = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'max', value);
};
var _elm_lang$html$Html_Attributes$min = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'min', value);
};
var _elm_lang$html$Html_Attributes$step = function (n) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'step', n);
};
var _elm_lang$html$Html_Attributes$wrap = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'wrap', value);
};
var _elm_lang$html$Html_Attributes$usemap = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'useMap', value);
};
var _elm_lang$html$Html_Attributes$shape = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'shape', value);
};
var _elm_lang$html$Html_Attributes$coords = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'coords', value);
};
var _elm_lang$html$Html_Attributes$keytype = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'keytype', value);
};
var _elm_lang$html$Html_Attributes$align = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'align', value);
};
var _elm_lang$html$Html_Attributes$cite = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'cite', value);
};
var _elm_lang$html$Html_Attributes$href = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'href', value);
};
var _elm_lang$html$Html_Attributes$target = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'target', value);
};
var _elm_lang$html$Html_Attributes$downloadAs = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'download', value);
};
var _elm_lang$html$Html_Attributes$hreflang = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'hreflang', value);
};
var _elm_lang$html$Html_Attributes$ping = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'ping', value);
};
var _elm_lang$html$Html_Attributes$start = function (n) {
	return A2(
		_elm_lang$html$Html_Attributes$stringProperty,
		'start',
		_elm_lang$core$Basics$toString(n));
};
var _elm_lang$html$Html_Attributes$headers = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'headers', value);
};
var _elm_lang$html$Html_Attributes$scope = function (value) {
	return A2(_elm_lang$html$Html_Attributes$stringProperty, 'scope', value);
};
var _elm_lang$html$Html_Attributes$boolProperty = F2(
	function (name, bool) {
		return A2(
			_elm_lang$html$Html_Attributes$property,
			name,
			_elm_lang$core$Json_Encode$bool(bool));
	});
var _elm_lang$html$Html_Attributes$hidden = function (bool) {
	return A2(_elm_lang$html$Html_Attributes$boolProperty, 'hidden', bool);
};
var _elm_lang$html$Html_Attributes$contenteditable = function (bool) {
	return A2(_elm_lang$html$Html_Attributes$boolProperty, 'contentEditable', bool);
};
var _elm_lang$html$Html_Attributes$spellcheck = function (bool) {
	return A2(_elm_lang$html$Html_Attributes$boolProperty, 'spellcheck', bool);
};
var _elm_lang$html$Html_Attributes$async = function (bool) {
	return A2(_elm_lang$html$Html_Attributes$boolProperty, 'async', bool);
};
var _elm_lang$html$Html_Attributes$defer = function (bool) {
	return A2(_elm_lang$html$Html_Attributes$boolProperty, 'defer', bool);
};
var _elm_lang$html$Html_Attributes$scoped = function (bool) {
	return A2(_elm_lang$html$Html_Attributes$boolProperty, 'scoped', bool);
};
var _elm_lang$html$Html_Attributes$autoplay = function (bool) {
	return A2(_elm_lang$html$Html_Attributes$boolProperty, 'autoplay', bool);
};
var _elm_lang$html$Html_Attributes$controls = function (bool) {
	return A2(_elm_lang$html$Html_Attributes$boolProperty, 'controls', bool);
};
var _elm_lang$html$Html_Attributes$loop = function (bool) {
	return A2(_elm_lang$html$Html_Attributes$boolProperty, 'loop', bool);
};
var _elm_lang$html$Html_Attributes$default = function (bool) {
	return A2(_elm_lang$html$Html_Attributes$boolProperty, 'default', bool);
};
var _elm_lang$html$Html_Attributes$seamless = function (bool) {
	return A2(_elm_lang$html$Html_Attributes$boolProperty, 'seamless', bool);
};
var _elm_lang$html$Html_Attributes$checked = function (bool) {
	return A2(_elm_lang$html$Html_Attributes$boolProperty, 'checked', bool);
};
var _elm_lang$html$Html_Attributes$selected = function (bool) {
	return A2(_elm_lang$html$Html_Attributes$boolProperty, 'selected', bool);
};
var _elm_lang$html$Html_Attributes$autofocus = function (bool) {
	return A2(_elm_lang$html$Html_Attributes$boolProperty, 'autofocus', bool);
};
var _elm_lang$html$Html_Attributes$disabled = function (bool) {
	return A2(_elm_lang$html$Html_Attributes$boolProperty, 'disabled', bool);
};
var _elm_lang$html$Html_Attributes$multiple = function (bool) {
	return A2(_elm_lang$html$Html_Attributes$boolProperty, 'multiple', bool);
};
var _elm_lang$html$Html_Attributes$novalidate = function (bool) {
	return A2(_elm_lang$html$Html_Attributes$boolProperty, 'noValidate', bool);
};
var _elm_lang$html$Html_Attributes$readonly = function (bool) {
	return A2(_elm_lang$html$Html_Attributes$boolProperty, 'readOnly', bool);
};
var _elm_lang$html$Html_Attributes$required = function (bool) {
	return A2(_elm_lang$html$Html_Attributes$boolProperty, 'required', bool);
};
var _elm_lang$html$Html_Attributes$ismap = function (value) {
	return A2(_elm_lang$html$Html_Attributes$boolProperty, 'isMap', value);
};
var _elm_lang$html$Html_Attributes$download = function (bool) {
	return A2(_elm_lang$html$Html_Attributes$boolProperty, 'download', bool);
};
var _elm_lang$html$Html_Attributes$reversed = function (bool) {
	return A2(_elm_lang$html$Html_Attributes$boolProperty, 'reversed', bool);
};
var _elm_lang$html$Html_Attributes$classList = function (list) {
	return _elm_lang$html$Html_Attributes$class(
		A2(
			_elm_lang$core$String$join,
			' ',
			A2(
				_elm_lang$core$List$map,
				_elm_lang$core$Tuple$first,
				A2(_elm_lang$core$List$filter, _elm_lang$core$Tuple$second, list))));
};
var _elm_lang$html$Html_Attributes$style = _elm_lang$virtual_dom$VirtualDom$style;

var _elm_lang$html$Html_Events$keyCode = A2(_elm_lang$core$Json_Decode$field, 'keyCode', _elm_lang$core$Json_Decode$int);
var _elm_lang$html$Html_Events$targetChecked = A2(
	_elm_lang$core$Json_Decode$at,
	{
		ctor: '::',
		_0: 'target',
		_1: {
			ctor: '::',
			_0: 'checked',
			_1: {ctor: '[]'}
		}
	},
	_elm_lang$core$Json_Decode$bool);
var _elm_lang$html$Html_Events$targetValue = A2(
	_elm_lang$core$Json_Decode$at,
	{
		ctor: '::',
		_0: 'target',
		_1: {
			ctor: '::',
			_0: 'value',
			_1: {ctor: '[]'}
		}
	},
	_elm_lang$core$Json_Decode$string);
var _elm_lang$html$Html_Events$defaultOptions = _elm_lang$virtual_dom$VirtualDom$defaultOptions;
var _elm_lang$html$Html_Events$onWithOptions = _elm_lang$virtual_dom$VirtualDom$onWithOptions;
var _elm_lang$html$Html_Events$on = _elm_lang$virtual_dom$VirtualDom$on;
var _elm_lang$html$Html_Events$onFocus = function (msg) {
	return A2(
		_elm_lang$html$Html_Events$on,
		'focus',
		_elm_lang$core$Json_Decode$succeed(msg));
};
var _elm_lang$html$Html_Events$onBlur = function (msg) {
	return A2(
		_elm_lang$html$Html_Events$on,
		'blur',
		_elm_lang$core$Json_Decode$succeed(msg));
};
var _elm_lang$html$Html_Events$onSubmitOptions = _elm_lang$core$Native_Utils.update(
	_elm_lang$html$Html_Events$defaultOptions,
	{preventDefault: true});
var _elm_lang$html$Html_Events$onSubmit = function (msg) {
	return A3(
		_elm_lang$html$Html_Events$onWithOptions,
		'submit',
		_elm_lang$html$Html_Events$onSubmitOptions,
		_elm_lang$core$Json_Decode$succeed(msg));
};
var _elm_lang$html$Html_Events$onCheck = function (tagger) {
	return A2(
		_elm_lang$html$Html_Events$on,
		'change',
		A2(_elm_lang$core$Json_Decode$map, tagger, _elm_lang$html$Html_Events$targetChecked));
};
var _elm_lang$html$Html_Events$onInput = function (tagger) {
	return A2(
		_elm_lang$html$Html_Events$on,
		'input',
		A2(_elm_lang$core$Json_Decode$map, tagger, _elm_lang$html$Html_Events$targetValue));
};
var _elm_lang$html$Html_Events$onMouseOut = function (msg) {
	return A2(
		_elm_lang$html$Html_Events$on,
		'mouseout',
		_elm_lang$core$Json_Decode$succeed(msg));
};
var _elm_lang$html$Html_Events$onMouseOver = function (msg) {
	return A2(
		_elm_lang$html$Html_Events$on,
		'mouseover',
		_elm_lang$core$Json_Decode$succeed(msg));
};
var _elm_lang$html$Html_Events$onMouseLeave = function (msg) {
	return A2(
		_elm_lang$html$Html_Events$on,
		'mouseleave',
		_elm_lang$core$Json_Decode$succeed(msg));
};
var _elm_lang$html$Html_Events$onMouseEnter = function (msg) {
	return A2(
		_elm_lang$html$Html_Events$on,
		'mouseenter',
		_elm_lang$core$Json_Decode$succeed(msg));
};
var _elm_lang$html$Html_Events$onMouseUp = function (msg) {
	return A2(
		_elm_lang$html$Html_Events$on,
		'mouseup',
		_elm_lang$core$Json_Decode$succeed(msg));
};
var _elm_lang$html$Html_Events$onMouseDown = function (msg) {
	return A2(
		_elm_lang$html$Html_Events$on,
		'mousedown',
		_elm_lang$core$Json_Decode$succeed(msg));
};
var _elm_lang$html$Html_Events$onDoubleClick = function (msg) {
	return A2(
		_elm_lang$html$Html_Events$on,
		'dblclick',
		_elm_lang$core$Json_Decode$succeed(msg));
};
var _elm_lang$html$Html_Events$onClick = function (msg) {
	return A2(
		_elm_lang$html$Html_Events$on,
		'click',
		_elm_lang$core$Json_Decode$succeed(msg));
};
var _elm_lang$html$Html_Events$Options = F2(
	function (a, b) {
		return {stopPropagation: a, preventDefault: b};
	});

var _elm_lang$keyboard$Keyboard$onSelfMsg = F3(
	function (router, _p0, state) {
		var _p1 = _p0;
		var _p2 = A2(_elm_lang$core$Dict$get, _p1.category, state);
		if (_p2.ctor === 'Nothing') {
			return _elm_lang$core$Task$succeed(state);
		} else {
			var send = function (tagger) {
				return A2(
					_elm_lang$core$Platform$sendToApp,
					router,
					tagger(_p1.keyCode));
			};
			return A2(
				_elm_lang$core$Task$andThen,
				function (_p3) {
					return _elm_lang$core$Task$succeed(state);
				},
				_elm_lang$core$Task$sequence(
					A2(_elm_lang$core$List$map, send, _p2._0.taggers)));
		}
	});
var _elm_lang$keyboard$Keyboard_ops = _elm_lang$keyboard$Keyboard_ops || {};
_elm_lang$keyboard$Keyboard_ops['&>'] = F2(
	function (task1, task2) {
		return A2(
			_elm_lang$core$Task$andThen,
			function (_p4) {
				return task2;
			},
			task1);
	});
var _elm_lang$keyboard$Keyboard$init = _elm_lang$core$Task$succeed(_elm_lang$core$Dict$empty);
var _elm_lang$keyboard$Keyboard$categorizeHelpHelp = F2(
	function (value, maybeValues) {
		var _p5 = maybeValues;
		if (_p5.ctor === 'Nothing') {
			return _elm_lang$core$Maybe$Just(
				{
					ctor: '::',
					_0: value,
					_1: {ctor: '[]'}
				});
		} else {
			return _elm_lang$core$Maybe$Just(
				{ctor: '::', _0: value, _1: _p5._0});
		}
	});
var _elm_lang$keyboard$Keyboard$categorizeHelp = F2(
	function (subs, subDict) {
		categorizeHelp:
		while (true) {
			var _p6 = subs;
			if (_p6.ctor === '[]') {
				return subDict;
			} else {
				var _v4 = _p6._1,
					_v5 = A3(
					_elm_lang$core$Dict$update,
					_p6._0._0,
					_elm_lang$keyboard$Keyboard$categorizeHelpHelp(_p6._0._1),
					subDict);
				subs = _v4;
				subDict = _v5;
				continue categorizeHelp;
			}
		}
	});
var _elm_lang$keyboard$Keyboard$categorize = function (subs) {
	return A2(_elm_lang$keyboard$Keyboard$categorizeHelp, subs, _elm_lang$core$Dict$empty);
};
var _elm_lang$keyboard$Keyboard$keyCode = A2(_elm_lang$core$Json_Decode$field, 'keyCode', _elm_lang$core$Json_Decode$int);
var _elm_lang$keyboard$Keyboard$subscription = _elm_lang$core$Native_Platform.leaf('Keyboard');
var _elm_lang$keyboard$Keyboard$Watcher = F2(
	function (a, b) {
		return {taggers: a, pid: b};
	});
var _elm_lang$keyboard$Keyboard$Msg = F2(
	function (a, b) {
		return {category: a, keyCode: b};
	});
var _elm_lang$keyboard$Keyboard$onEffects = F3(
	function (router, newSubs, oldState) {
		var rightStep = F3(
			function (category, taggers, task) {
				return A2(
					_elm_lang$core$Task$andThen,
					function (state) {
						return A2(
							_elm_lang$core$Task$andThen,
							function (pid) {
								return _elm_lang$core$Task$succeed(
									A3(
										_elm_lang$core$Dict$insert,
										category,
										A2(_elm_lang$keyboard$Keyboard$Watcher, taggers, pid),
										state));
							},
							_elm_lang$core$Process$spawn(
								A3(
									_elm_lang$dom$Dom_LowLevel$onDocument,
									category,
									_elm_lang$keyboard$Keyboard$keyCode,
									function (_p7) {
										return A2(
											_elm_lang$core$Platform$sendToSelf,
											router,
											A2(_elm_lang$keyboard$Keyboard$Msg, category, _p7));
									})));
					},
					task);
			});
		var bothStep = F4(
			function (category, _p8, taggers, task) {
				var _p9 = _p8;
				return A2(
					_elm_lang$core$Task$map,
					A2(
						_elm_lang$core$Dict$insert,
						category,
						A2(_elm_lang$keyboard$Keyboard$Watcher, taggers, _p9.pid)),
					task);
			});
		var leftStep = F3(
			function (category, _p10, task) {
				var _p11 = _p10;
				return A2(
					_elm_lang$keyboard$Keyboard_ops['&>'],
					_elm_lang$core$Process$kill(_p11.pid),
					task);
			});
		return A6(
			_elm_lang$core$Dict$merge,
			leftStep,
			bothStep,
			rightStep,
			oldState,
			_elm_lang$keyboard$Keyboard$categorize(newSubs),
			_elm_lang$core$Task$succeed(_elm_lang$core$Dict$empty));
	});
var _elm_lang$keyboard$Keyboard$MySub = F2(
	function (a, b) {
		return {ctor: 'MySub', _0: a, _1: b};
	});
var _elm_lang$keyboard$Keyboard$presses = function (tagger) {
	return _elm_lang$keyboard$Keyboard$subscription(
		A2(_elm_lang$keyboard$Keyboard$MySub, 'keypress', tagger));
};
var _elm_lang$keyboard$Keyboard$downs = function (tagger) {
	return _elm_lang$keyboard$Keyboard$subscription(
		A2(_elm_lang$keyboard$Keyboard$MySub, 'keydown', tagger));
};
var _elm_lang$keyboard$Keyboard$ups = function (tagger) {
	return _elm_lang$keyboard$Keyboard$subscription(
		A2(_elm_lang$keyboard$Keyboard$MySub, 'keyup', tagger));
};
var _elm_lang$keyboard$Keyboard$subMap = F2(
	function (func, _p12) {
		var _p13 = _p12;
		return A2(
			_elm_lang$keyboard$Keyboard$MySub,
			_p13._0,
			function (_p14) {
				return func(
					_p13._1(_p14));
			});
	});
_elm_lang$core$Native_Platform.effectManagers['Keyboard'] = {pkg: 'elm-lang/keyboard', init: _elm_lang$keyboard$Keyboard$init, onEffects: _elm_lang$keyboard$Keyboard$onEffects, onSelfMsg: _elm_lang$keyboard$Keyboard$onSelfMsg, tag: 'sub', subMap: _elm_lang$keyboard$Keyboard$subMap};

var _elm_lang$mouse$Mouse_ops = _elm_lang$mouse$Mouse_ops || {};
_elm_lang$mouse$Mouse_ops['&>'] = F2(
	function (t1, t2) {
		return A2(
			_elm_lang$core$Task$andThen,
			function (_p0) {
				return t2;
			},
			t1);
	});
var _elm_lang$mouse$Mouse$onSelfMsg = F3(
	function (router, _p1, state) {
		var _p2 = _p1;
		var _p3 = A2(_elm_lang$core$Dict$get, _p2.category, state);
		if (_p3.ctor === 'Nothing') {
			return _elm_lang$core$Task$succeed(state);
		} else {
			var send = function (tagger) {
				return A2(
					_elm_lang$core$Platform$sendToApp,
					router,
					tagger(_p2.position));
			};
			return A2(
				_elm_lang$mouse$Mouse_ops['&>'],
				_elm_lang$core$Task$sequence(
					A2(_elm_lang$core$List$map, send, _p3._0.taggers)),
				_elm_lang$core$Task$succeed(state));
		}
	});
var _elm_lang$mouse$Mouse$init = _elm_lang$core$Task$succeed(_elm_lang$core$Dict$empty);
var _elm_lang$mouse$Mouse$categorizeHelpHelp = F2(
	function (value, maybeValues) {
		var _p4 = maybeValues;
		if (_p4.ctor === 'Nothing') {
			return _elm_lang$core$Maybe$Just(
				{
					ctor: '::',
					_0: value,
					_1: {ctor: '[]'}
				});
		} else {
			return _elm_lang$core$Maybe$Just(
				{ctor: '::', _0: value, _1: _p4._0});
		}
	});
var _elm_lang$mouse$Mouse$categorizeHelp = F2(
	function (subs, subDict) {
		categorizeHelp:
		while (true) {
			var _p5 = subs;
			if (_p5.ctor === '[]') {
				return subDict;
			} else {
				var _v4 = _p5._1,
					_v5 = A3(
					_elm_lang$core$Dict$update,
					_p5._0._0,
					_elm_lang$mouse$Mouse$categorizeHelpHelp(_p5._0._1),
					subDict);
				subs = _v4;
				subDict = _v5;
				continue categorizeHelp;
			}
		}
	});
var _elm_lang$mouse$Mouse$categorize = function (subs) {
	return A2(_elm_lang$mouse$Mouse$categorizeHelp, subs, _elm_lang$core$Dict$empty);
};
var _elm_lang$mouse$Mouse$subscription = _elm_lang$core$Native_Platform.leaf('Mouse');
var _elm_lang$mouse$Mouse$Position = F2(
	function (a, b) {
		return {x: a, y: b};
	});
var _elm_lang$mouse$Mouse$position = A3(
	_elm_lang$core$Json_Decode$map2,
	_elm_lang$mouse$Mouse$Position,
	A2(_elm_lang$core$Json_Decode$field, 'pageX', _elm_lang$core$Json_Decode$int),
	A2(_elm_lang$core$Json_Decode$field, 'pageY', _elm_lang$core$Json_Decode$int));
var _elm_lang$mouse$Mouse$Watcher = F2(
	function (a, b) {
		return {taggers: a, pid: b};
	});
var _elm_lang$mouse$Mouse$Msg = F2(
	function (a, b) {
		return {category: a, position: b};
	});
var _elm_lang$mouse$Mouse$onEffects = F3(
	function (router, newSubs, oldState) {
		var rightStep = F3(
			function (category, taggers, task) {
				var tracker = A3(
					_elm_lang$dom$Dom_LowLevel$onDocument,
					category,
					_elm_lang$mouse$Mouse$position,
					function (_p6) {
						return A2(
							_elm_lang$core$Platform$sendToSelf,
							router,
							A2(_elm_lang$mouse$Mouse$Msg, category, _p6));
					});
				return A2(
					_elm_lang$core$Task$andThen,
					function (state) {
						return A2(
							_elm_lang$core$Task$andThen,
							function (pid) {
								return _elm_lang$core$Task$succeed(
									A3(
										_elm_lang$core$Dict$insert,
										category,
										A2(_elm_lang$mouse$Mouse$Watcher, taggers, pid),
										state));
							},
							_elm_lang$core$Process$spawn(tracker));
					},
					task);
			});
		var bothStep = F4(
			function (category, _p7, taggers, task) {
				var _p8 = _p7;
				return A2(
					_elm_lang$core$Task$andThen,
					function (state) {
						return _elm_lang$core$Task$succeed(
							A3(
								_elm_lang$core$Dict$insert,
								category,
								A2(_elm_lang$mouse$Mouse$Watcher, taggers, _p8.pid),
								state));
					},
					task);
			});
		var leftStep = F3(
			function (category, _p9, task) {
				var _p10 = _p9;
				return A2(
					_elm_lang$mouse$Mouse_ops['&>'],
					_elm_lang$core$Process$kill(_p10.pid),
					task);
			});
		return A6(
			_elm_lang$core$Dict$merge,
			leftStep,
			bothStep,
			rightStep,
			oldState,
			_elm_lang$mouse$Mouse$categorize(newSubs),
			_elm_lang$core$Task$succeed(_elm_lang$core$Dict$empty));
	});
var _elm_lang$mouse$Mouse$MySub = F2(
	function (a, b) {
		return {ctor: 'MySub', _0: a, _1: b};
	});
var _elm_lang$mouse$Mouse$clicks = function (tagger) {
	return _elm_lang$mouse$Mouse$subscription(
		A2(_elm_lang$mouse$Mouse$MySub, 'click', tagger));
};
var _elm_lang$mouse$Mouse$moves = function (tagger) {
	return _elm_lang$mouse$Mouse$subscription(
		A2(_elm_lang$mouse$Mouse$MySub, 'mousemove', tagger));
};
var _elm_lang$mouse$Mouse$downs = function (tagger) {
	return _elm_lang$mouse$Mouse$subscription(
		A2(_elm_lang$mouse$Mouse$MySub, 'mousedown', tagger));
};
var _elm_lang$mouse$Mouse$ups = function (tagger) {
	return _elm_lang$mouse$Mouse$subscription(
		A2(_elm_lang$mouse$Mouse$MySub, 'mouseup', tagger));
};
var _elm_lang$mouse$Mouse$subMap = F2(
	function (func, _p11) {
		var _p12 = _p11;
		return A2(
			_elm_lang$mouse$Mouse$MySub,
			_p12._0,
			function (_p13) {
				return func(
					_p12._1(_p13));
			});
	});
_elm_lang$core$Native_Platform.effectManagers['Mouse'] = {pkg: 'elm-lang/mouse', init: _elm_lang$mouse$Mouse$init, onEffects: _elm_lang$mouse$Mouse$onEffects, onSelfMsg: _elm_lang$mouse$Mouse$onSelfMsg, tag: 'sub', subMap: _elm_lang$mouse$Mouse$subMap};

// import Native.Scheduler, Utils //

var _elm_lang$page_visibility$Native_PageVisibility = function() {


// sort out the prefixes

var hidden, change;
if (typeof document.hidden !== 'undefined')
{
	hidden = 'hidden';
	change = 'visibilitychange';
}
else if (typeof document.mozHidden !== 'undefined')
{
	hidden = 'mozHidden';
	change = 'mozvisibilitychange';
}
else if (typeof document.msHidden !== 'undefined')
{
	hidden = 'msHidden';
	change = 'msvisibilitychange';
}
else if (typeof document.webkitHidden !== 'undefined')
{
	hidden = 'webkitHidden';
	change = 'webkitvisibilitychange';
}


// actually provide functionality

function visibilityChange(toTask)
{
	return _elm_lang$core$Native_Scheduler.nativeBinding(function(callback) {

		function performTask()
		{
			_elm_lang$core$Native_Scheduler.rawSpawn(toTask(document[hidden]));
		}

		document.addEventListener(change, performTask);

		return function()
		{
			document.removeEventListener(change, performTask);
		};
	});
}

var isHidden = _elm_lang$core$Native_Scheduler.nativeBinding(function(callback) {
	callback(_elm_lang$core$Native_Scheduler.succeed(document[hidden]));
});


return {
	visibilityChange: visibilityChange,
	isHidden: isHidden
};

}();

var _elm_lang$page_visibility$PageVisibility$onVisibilityChange = _elm_lang$page_visibility$Native_PageVisibility.visibilityChange;
var _elm_lang$page_visibility$PageVisibility$onEffects = F3(
	function (router, newSubs, state) {
		var _p0 = {ctor: '_Tuple2', _0: state, _1: newSubs};
		if (_p0._0.ctor === 'Nothing') {
			if (_p0._1.ctor === '[]') {
				return _elm_lang$core$Task$succeed(state);
			} else {
				return A2(
					_elm_lang$core$Task$andThen,
					function (pid) {
						return _elm_lang$core$Task$succeed(
							_elm_lang$core$Maybe$Just(
								{subs: newSubs, pid: pid}));
					},
					_elm_lang$core$Process$spawn(
						_elm_lang$page_visibility$PageVisibility$onVisibilityChange(
							_elm_lang$core$Platform$sendToSelf(router))));
			}
		} else {
			if (_p0._1.ctor === '[]') {
				return A2(
					_elm_lang$core$Task$andThen,
					function (_p1) {
						return _elm_lang$core$Task$succeed(_elm_lang$core$Maybe$Nothing);
					},
					_elm_lang$core$Process$kill(_p0._0._0.pid));
			} else {
				return _elm_lang$core$Task$succeed(
					_elm_lang$core$Maybe$Just(
						{subs: newSubs, pid: _p0._0._0.pid}));
			}
		}
	});
var _elm_lang$page_visibility$PageVisibility$init = _elm_lang$core$Task$succeed(_elm_lang$core$Maybe$Nothing);
var _elm_lang$page_visibility$PageVisibility$isHidden = _elm_lang$page_visibility$Native_PageVisibility.isHidden;
var _elm_lang$page_visibility$PageVisibility$isVisible = A2(_elm_lang$core$Task$map, _elm_lang$core$Basics$not, _elm_lang$page_visibility$PageVisibility$isHidden);
var _elm_lang$page_visibility$PageVisibility$subscription = _elm_lang$core$Native_Platform.leaf('PageVisibility');
var _elm_lang$page_visibility$PageVisibility$Hidden = {ctor: 'Hidden'};
var _elm_lang$page_visibility$PageVisibility$Visible = {ctor: 'Visible'};
var _elm_lang$page_visibility$PageVisibility$hiddenToVisibility = function (hidden) {
	return hidden ? _elm_lang$page_visibility$PageVisibility$Hidden : _elm_lang$page_visibility$PageVisibility$Visible;
};
var _elm_lang$page_visibility$PageVisibility$visibility = A2(_elm_lang$core$Task$map, _elm_lang$page_visibility$PageVisibility$hiddenToVisibility, _elm_lang$page_visibility$PageVisibility$isHidden);
var _elm_lang$page_visibility$PageVisibility$onSelfMsg = F3(
	function (router, hidden, state) {
		var _p2 = state;
		if (_p2.ctor === 'Nothing') {
			return _elm_lang$core$Task$succeed(state);
		} else {
			var send = function (_p3) {
				var _p4 = _p3;
				return A2(
					_elm_lang$core$Platform$sendToApp,
					router,
					_p4._0(
						_elm_lang$page_visibility$PageVisibility$hiddenToVisibility(hidden)));
			};
			return A2(
				_elm_lang$core$Task$andThen,
				function (_p5) {
					return _elm_lang$core$Task$succeed(state);
				},
				_elm_lang$core$Task$sequence(
					A2(_elm_lang$core$List$map, send, _p2._0.subs)));
		}
	});
var _elm_lang$page_visibility$PageVisibility$Tagger = function (a) {
	return {ctor: 'Tagger', _0: a};
};
var _elm_lang$page_visibility$PageVisibility$visibilityChanges = function (tagger) {
	return _elm_lang$page_visibility$PageVisibility$subscription(
		_elm_lang$page_visibility$PageVisibility$Tagger(tagger));
};
var _elm_lang$page_visibility$PageVisibility$subMap = F2(
	function (func, _p6) {
		var _p7 = _p6;
		return _elm_lang$page_visibility$PageVisibility$Tagger(
			function (_p8) {
				return func(
					_p7._0(_p8));
			});
	});
_elm_lang$core$Native_Platform.effectManagers['PageVisibility'] = {pkg: 'elm-lang/page-visibility', init: _elm_lang$page_visibility$PageVisibility$init, onEffects: _elm_lang$page_visibility$PageVisibility$onEffects, onSelfMsg: _elm_lang$page_visibility$PageVisibility$onSelfMsg, tag: 'sub', subMap: _elm_lang$page_visibility$PageVisibility$subMap};

var _elm_lang$svg$Svg$map = _elm_lang$virtual_dom$VirtualDom$map;
var _elm_lang$svg$Svg$text = _elm_lang$virtual_dom$VirtualDom$text;
var _elm_lang$svg$Svg$svgNamespace = A2(
	_elm_lang$virtual_dom$VirtualDom$property,
	'namespace',
	_elm_lang$core$Json_Encode$string('http://www.w3.org/2000/svg'));
var _elm_lang$svg$Svg$node = F3(
	function (name, attributes, children) {
		return A3(
			_elm_lang$virtual_dom$VirtualDom$node,
			name,
			{ctor: '::', _0: _elm_lang$svg$Svg$svgNamespace, _1: attributes},
			children);
	});
var _elm_lang$svg$Svg$svg = _elm_lang$svg$Svg$node('svg');
var _elm_lang$svg$Svg$foreignObject = _elm_lang$svg$Svg$node('foreignObject');
var _elm_lang$svg$Svg$animate = _elm_lang$svg$Svg$node('animate');
var _elm_lang$svg$Svg$animateColor = _elm_lang$svg$Svg$node('animateColor');
var _elm_lang$svg$Svg$animateMotion = _elm_lang$svg$Svg$node('animateMotion');
var _elm_lang$svg$Svg$animateTransform = _elm_lang$svg$Svg$node('animateTransform');
var _elm_lang$svg$Svg$mpath = _elm_lang$svg$Svg$node('mpath');
var _elm_lang$svg$Svg$set = _elm_lang$svg$Svg$node('set');
var _elm_lang$svg$Svg$a = _elm_lang$svg$Svg$node('a');
var _elm_lang$svg$Svg$defs = _elm_lang$svg$Svg$node('defs');
var _elm_lang$svg$Svg$g = _elm_lang$svg$Svg$node('g');
var _elm_lang$svg$Svg$marker = _elm_lang$svg$Svg$node('marker');
var _elm_lang$svg$Svg$mask = _elm_lang$svg$Svg$node('mask');
var _elm_lang$svg$Svg$pattern = _elm_lang$svg$Svg$node('pattern');
var _elm_lang$svg$Svg$switch = _elm_lang$svg$Svg$node('switch');
var _elm_lang$svg$Svg$symbol = _elm_lang$svg$Svg$node('symbol');
var _elm_lang$svg$Svg$desc = _elm_lang$svg$Svg$node('desc');
var _elm_lang$svg$Svg$metadata = _elm_lang$svg$Svg$node('metadata');
var _elm_lang$svg$Svg$title = _elm_lang$svg$Svg$node('title');
var _elm_lang$svg$Svg$feBlend = _elm_lang$svg$Svg$node('feBlend');
var _elm_lang$svg$Svg$feColorMatrix = _elm_lang$svg$Svg$node('feColorMatrix');
var _elm_lang$svg$Svg$feComponentTransfer = _elm_lang$svg$Svg$node('feComponentTransfer');
var _elm_lang$svg$Svg$feComposite = _elm_lang$svg$Svg$node('feComposite');
var _elm_lang$svg$Svg$feConvolveMatrix = _elm_lang$svg$Svg$node('feConvolveMatrix');
var _elm_lang$svg$Svg$feDiffuseLighting = _elm_lang$svg$Svg$node('feDiffuseLighting');
var _elm_lang$svg$Svg$feDisplacementMap = _elm_lang$svg$Svg$node('feDisplacementMap');
var _elm_lang$svg$Svg$feFlood = _elm_lang$svg$Svg$node('feFlood');
var _elm_lang$svg$Svg$feFuncA = _elm_lang$svg$Svg$node('feFuncA');
var _elm_lang$svg$Svg$feFuncB = _elm_lang$svg$Svg$node('feFuncB');
var _elm_lang$svg$Svg$feFuncG = _elm_lang$svg$Svg$node('feFuncG');
var _elm_lang$svg$Svg$feFuncR = _elm_lang$svg$Svg$node('feFuncR');
var _elm_lang$svg$Svg$feGaussianBlur = _elm_lang$svg$Svg$node('feGaussianBlur');
var _elm_lang$svg$Svg$feImage = _elm_lang$svg$Svg$node('feImage');
var _elm_lang$svg$Svg$feMerge = _elm_lang$svg$Svg$node('feMerge');
var _elm_lang$svg$Svg$feMergeNode = _elm_lang$svg$Svg$node('feMergeNode');
var _elm_lang$svg$Svg$feMorphology = _elm_lang$svg$Svg$node('feMorphology');
var _elm_lang$svg$Svg$feOffset = _elm_lang$svg$Svg$node('feOffset');
var _elm_lang$svg$Svg$feSpecularLighting = _elm_lang$svg$Svg$node('feSpecularLighting');
var _elm_lang$svg$Svg$feTile = _elm_lang$svg$Svg$node('feTile');
var _elm_lang$svg$Svg$feTurbulence = _elm_lang$svg$Svg$node('feTurbulence');
var _elm_lang$svg$Svg$font = _elm_lang$svg$Svg$node('font');
var _elm_lang$svg$Svg$linearGradient = _elm_lang$svg$Svg$node('linearGradient');
var _elm_lang$svg$Svg$radialGradient = _elm_lang$svg$Svg$node('radialGradient');
var _elm_lang$svg$Svg$stop = _elm_lang$svg$Svg$node('stop');
var _elm_lang$svg$Svg$circle = _elm_lang$svg$Svg$node('circle');
var _elm_lang$svg$Svg$ellipse = _elm_lang$svg$Svg$node('ellipse');
var _elm_lang$svg$Svg$image = _elm_lang$svg$Svg$node('image');
var _elm_lang$svg$Svg$line = _elm_lang$svg$Svg$node('line');
var _elm_lang$svg$Svg$path = _elm_lang$svg$Svg$node('path');
var _elm_lang$svg$Svg$polygon = _elm_lang$svg$Svg$node('polygon');
var _elm_lang$svg$Svg$polyline = _elm_lang$svg$Svg$node('polyline');
var _elm_lang$svg$Svg$rect = _elm_lang$svg$Svg$node('rect');
var _elm_lang$svg$Svg$use = _elm_lang$svg$Svg$node('use');
var _elm_lang$svg$Svg$feDistantLight = _elm_lang$svg$Svg$node('feDistantLight');
var _elm_lang$svg$Svg$fePointLight = _elm_lang$svg$Svg$node('fePointLight');
var _elm_lang$svg$Svg$feSpotLight = _elm_lang$svg$Svg$node('feSpotLight');
var _elm_lang$svg$Svg$altGlyph = _elm_lang$svg$Svg$node('altGlyph');
var _elm_lang$svg$Svg$altGlyphDef = _elm_lang$svg$Svg$node('altGlyphDef');
var _elm_lang$svg$Svg$altGlyphItem = _elm_lang$svg$Svg$node('altGlyphItem');
var _elm_lang$svg$Svg$glyph = _elm_lang$svg$Svg$node('glyph');
var _elm_lang$svg$Svg$glyphRef = _elm_lang$svg$Svg$node('glyphRef');
var _elm_lang$svg$Svg$textPath = _elm_lang$svg$Svg$node('textPath');
var _elm_lang$svg$Svg$text_ = _elm_lang$svg$Svg$node('text');
var _elm_lang$svg$Svg$tref = _elm_lang$svg$Svg$node('tref');
var _elm_lang$svg$Svg$tspan = _elm_lang$svg$Svg$node('tspan');
var _elm_lang$svg$Svg$clipPath = _elm_lang$svg$Svg$node('clipPath');
var _elm_lang$svg$Svg$colorProfile = _elm_lang$svg$Svg$node('colorProfile');
var _elm_lang$svg$Svg$cursor = _elm_lang$svg$Svg$node('cursor');
var _elm_lang$svg$Svg$filter = _elm_lang$svg$Svg$node('filter');
var _elm_lang$svg$Svg$script = _elm_lang$svg$Svg$node('script');
var _elm_lang$svg$Svg$style = _elm_lang$svg$Svg$node('style');
var _elm_lang$svg$Svg$view = _elm_lang$svg$Svg$node('view');

var _elm_lang$svg$Svg_Attributes$writingMode = _elm_lang$virtual_dom$VirtualDom$attribute('writing-mode');
var _elm_lang$svg$Svg_Attributes$wordSpacing = _elm_lang$virtual_dom$VirtualDom$attribute('word-spacing');
var _elm_lang$svg$Svg_Attributes$visibility = _elm_lang$virtual_dom$VirtualDom$attribute('visibility');
var _elm_lang$svg$Svg_Attributes$unicodeBidi = _elm_lang$virtual_dom$VirtualDom$attribute('unicode-bidi');
var _elm_lang$svg$Svg_Attributes$textRendering = _elm_lang$virtual_dom$VirtualDom$attribute('text-rendering');
var _elm_lang$svg$Svg_Attributes$textDecoration = _elm_lang$virtual_dom$VirtualDom$attribute('text-decoration');
var _elm_lang$svg$Svg_Attributes$textAnchor = _elm_lang$virtual_dom$VirtualDom$attribute('text-anchor');
var _elm_lang$svg$Svg_Attributes$stroke = _elm_lang$virtual_dom$VirtualDom$attribute('stroke');
var _elm_lang$svg$Svg_Attributes$strokeWidth = _elm_lang$virtual_dom$VirtualDom$attribute('stroke-width');
var _elm_lang$svg$Svg_Attributes$strokeOpacity = _elm_lang$virtual_dom$VirtualDom$attribute('stroke-opacity');
var _elm_lang$svg$Svg_Attributes$strokeMiterlimit = _elm_lang$virtual_dom$VirtualDom$attribute('stroke-miterlimit');
var _elm_lang$svg$Svg_Attributes$strokeLinejoin = _elm_lang$virtual_dom$VirtualDom$attribute('stroke-linejoin');
var _elm_lang$svg$Svg_Attributes$strokeLinecap = _elm_lang$virtual_dom$VirtualDom$attribute('stroke-linecap');
var _elm_lang$svg$Svg_Attributes$strokeDashoffset = _elm_lang$virtual_dom$VirtualDom$attribute('stroke-dashoffset');
var _elm_lang$svg$Svg_Attributes$strokeDasharray = _elm_lang$virtual_dom$VirtualDom$attribute('stroke-dasharray');
var _elm_lang$svg$Svg_Attributes$stopOpacity = _elm_lang$virtual_dom$VirtualDom$attribute('stop-opacity');
var _elm_lang$svg$Svg_Attributes$stopColor = _elm_lang$virtual_dom$VirtualDom$attribute('stop-color');
var _elm_lang$svg$Svg_Attributes$shapeRendering = _elm_lang$virtual_dom$VirtualDom$attribute('shape-rendering');
var _elm_lang$svg$Svg_Attributes$pointerEvents = _elm_lang$virtual_dom$VirtualDom$attribute('pointer-events');
var _elm_lang$svg$Svg_Attributes$overflow = _elm_lang$virtual_dom$VirtualDom$attribute('overflow');
var _elm_lang$svg$Svg_Attributes$opacity = _elm_lang$virtual_dom$VirtualDom$attribute('opacity');
var _elm_lang$svg$Svg_Attributes$mask = _elm_lang$virtual_dom$VirtualDom$attribute('mask');
var _elm_lang$svg$Svg_Attributes$markerStart = _elm_lang$virtual_dom$VirtualDom$attribute('marker-start');
var _elm_lang$svg$Svg_Attributes$markerMid = _elm_lang$virtual_dom$VirtualDom$attribute('marker-mid');
var _elm_lang$svg$Svg_Attributes$markerEnd = _elm_lang$virtual_dom$VirtualDom$attribute('marker-end');
var _elm_lang$svg$Svg_Attributes$lightingColor = _elm_lang$virtual_dom$VirtualDom$attribute('lighting-color');
var _elm_lang$svg$Svg_Attributes$letterSpacing = _elm_lang$virtual_dom$VirtualDom$attribute('letter-spacing');
var _elm_lang$svg$Svg_Attributes$kerning = _elm_lang$virtual_dom$VirtualDom$attribute('kerning');
var _elm_lang$svg$Svg_Attributes$imageRendering = _elm_lang$virtual_dom$VirtualDom$attribute('image-rendering');
var _elm_lang$svg$Svg_Attributes$glyphOrientationVertical = _elm_lang$virtual_dom$VirtualDom$attribute('glyph-orientation-vertical');
var _elm_lang$svg$Svg_Attributes$glyphOrientationHorizontal = _elm_lang$virtual_dom$VirtualDom$attribute('glyph-orientation-horizontal');
var _elm_lang$svg$Svg_Attributes$fontWeight = _elm_lang$virtual_dom$VirtualDom$attribute('font-weight');
var _elm_lang$svg$Svg_Attributes$fontVariant = _elm_lang$virtual_dom$VirtualDom$attribute('font-variant');
var _elm_lang$svg$Svg_Attributes$fontStyle = _elm_lang$virtual_dom$VirtualDom$attribute('font-style');
var _elm_lang$svg$Svg_Attributes$fontStretch = _elm_lang$virtual_dom$VirtualDom$attribute('font-stretch');
var _elm_lang$svg$Svg_Attributes$fontSize = _elm_lang$virtual_dom$VirtualDom$attribute('font-size');
var _elm_lang$svg$Svg_Attributes$fontSizeAdjust = _elm_lang$virtual_dom$VirtualDom$attribute('font-size-adjust');
var _elm_lang$svg$Svg_Attributes$fontFamily = _elm_lang$virtual_dom$VirtualDom$attribute('font-family');
var _elm_lang$svg$Svg_Attributes$floodOpacity = _elm_lang$virtual_dom$VirtualDom$attribute('flood-opacity');
var _elm_lang$svg$Svg_Attributes$floodColor = _elm_lang$virtual_dom$VirtualDom$attribute('flood-color');
var _elm_lang$svg$Svg_Attributes$filter = _elm_lang$virtual_dom$VirtualDom$attribute('filter');
var _elm_lang$svg$Svg_Attributes$fill = _elm_lang$virtual_dom$VirtualDom$attribute('fill');
var _elm_lang$svg$Svg_Attributes$fillRule = _elm_lang$virtual_dom$VirtualDom$attribute('fill-rule');
var _elm_lang$svg$Svg_Attributes$fillOpacity = _elm_lang$virtual_dom$VirtualDom$attribute('fill-opacity');
var _elm_lang$svg$Svg_Attributes$enableBackground = _elm_lang$virtual_dom$VirtualDom$attribute('enable-background');
var _elm_lang$svg$Svg_Attributes$dominantBaseline = _elm_lang$virtual_dom$VirtualDom$attribute('dominant-baseline');
var _elm_lang$svg$Svg_Attributes$display = _elm_lang$virtual_dom$VirtualDom$attribute('display');
var _elm_lang$svg$Svg_Attributes$direction = _elm_lang$virtual_dom$VirtualDom$attribute('direction');
var _elm_lang$svg$Svg_Attributes$cursor = _elm_lang$virtual_dom$VirtualDom$attribute('cursor');
var _elm_lang$svg$Svg_Attributes$color = _elm_lang$virtual_dom$VirtualDom$attribute('color');
var _elm_lang$svg$Svg_Attributes$colorRendering = _elm_lang$virtual_dom$VirtualDom$attribute('color-rendering');
var _elm_lang$svg$Svg_Attributes$colorProfile = _elm_lang$virtual_dom$VirtualDom$attribute('color-profile');
var _elm_lang$svg$Svg_Attributes$colorInterpolation = _elm_lang$virtual_dom$VirtualDom$attribute('color-interpolation');
var _elm_lang$svg$Svg_Attributes$colorInterpolationFilters = _elm_lang$virtual_dom$VirtualDom$attribute('color-interpolation-filters');
var _elm_lang$svg$Svg_Attributes$clip = _elm_lang$virtual_dom$VirtualDom$attribute('clip');
var _elm_lang$svg$Svg_Attributes$clipRule = _elm_lang$virtual_dom$VirtualDom$attribute('clip-rule');
var _elm_lang$svg$Svg_Attributes$clipPath = _elm_lang$virtual_dom$VirtualDom$attribute('clip-path');
var _elm_lang$svg$Svg_Attributes$baselineShift = _elm_lang$virtual_dom$VirtualDom$attribute('baseline-shift');
var _elm_lang$svg$Svg_Attributes$alignmentBaseline = _elm_lang$virtual_dom$VirtualDom$attribute('alignment-baseline');
var _elm_lang$svg$Svg_Attributes$zoomAndPan = _elm_lang$virtual_dom$VirtualDom$attribute('zoomAndPan');
var _elm_lang$svg$Svg_Attributes$z = _elm_lang$virtual_dom$VirtualDom$attribute('z');
var _elm_lang$svg$Svg_Attributes$yChannelSelector = _elm_lang$virtual_dom$VirtualDom$attribute('yChannelSelector');
var _elm_lang$svg$Svg_Attributes$y2 = _elm_lang$virtual_dom$VirtualDom$attribute('y2');
var _elm_lang$svg$Svg_Attributes$y1 = _elm_lang$virtual_dom$VirtualDom$attribute('y1');
var _elm_lang$svg$Svg_Attributes$y = _elm_lang$virtual_dom$VirtualDom$attribute('y');
var _elm_lang$svg$Svg_Attributes$xmlSpace = A2(_elm_lang$virtual_dom$VirtualDom$attributeNS, 'http://www.w3.org/XML/1998/namespace', 'xml:space');
var _elm_lang$svg$Svg_Attributes$xmlLang = A2(_elm_lang$virtual_dom$VirtualDom$attributeNS, 'http://www.w3.org/XML/1998/namespace', 'xml:lang');
var _elm_lang$svg$Svg_Attributes$xmlBase = A2(_elm_lang$virtual_dom$VirtualDom$attributeNS, 'http://www.w3.org/XML/1998/namespace', 'xml:base');
var _elm_lang$svg$Svg_Attributes$xlinkType = A2(_elm_lang$virtual_dom$VirtualDom$attributeNS, 'http://www.w3.org/1999/xlink', 'xlink:type');
var _elm_lang$svg$Svg_Attributes$xlinkTitle = A2(_elm_lang$virtual_dom$VirtualDom$attributeNS, 'http://www.w3.org/1999/xlink', 'xlink:title');
var _elm_lang$svg$Svg_Attributes$xlinkShow = A2(_elm_lang$virtual_dom$VirtualDom$attributeNS, 'http://www.w3.org/1999/xlink', 'xlink:show');
var _elm_lang$svg$Svg_Attributes$xlinkRole = A2(_elm_lang$virtual_dom$VirtualDom$attributeNS, 'http://www.w3.org/1999/xlink', 'xlink:role');
var _elm_lang$svg$Svg_Attributes$xlinkHref = A2(_elm_lang$virtual_dom$VirtualDom$attributeNS, 'http://www.w3.org/1999/xlink', 'xlink:href');
var _elm_lang$svg$Svg_Attributes$xlinkArcrole = A2(_elm_lang$virtual_dom$VirtualDom$attributeNS, 'http://www.w3.org/1999/xlink', 'xlink:arcrole');
var _elm_lang$svg$Svg_Attributes$xlinkActuate = A2(_elm_lang$virtual_dom$VirtualDom$attributeNS, 'http://www.w3.org/1999/xlink', 'xlink:actuate');
var _elm_lang$svg$Svg_Attributes$xChannelSelector = _elm_lang$virtual_dom$VirtualDom$attribute('xChannelSelector');
var _elm_lang$svg$Svg_Attributes$x2 = _elm_lang$virtual_dom$VirtualDom$attribute('x2');
var _elm_lang$svg$Svg_Attributes$x1 = _elm_lang$virtual_dom$VirtualDom$attribute('x1');
var _elm_lang$svg$Svg_Attributes$xHeight = _elm_lang$virtual_dom$VirtualDom$attribute('x-height');
var _elm_lang$svg$Svg_Attributes$x = _elm_lang$virtual_dom$VirtualDom$attribute('x');
var _elm_lang$svg$Svg_Attributes$widths = _elm_lang$virtual_dom$VirtualDom$attribute('widths');
var _elm_lang$svg$Svg_Attributes$width = _elm_lang$virtual_dom$VirtualDom$attribute('width');
var _elm_lang$svg$Svg_Attributes$viewTarget = _elm_lang$virtual_dom$VirtualDom$attribute('viewTarget');
var _elm_lang$svg$Svg_Attributes$viewBox = _elm_lang$virtual_dom$VirtualDom$attribute('viewBox');
var _elm_lang$svg$Svg_Attributes$vertOriginY = _elm_lang$virtual_dom$VirtualDom$attribute('vert-origin-y');
var _elm_lang$svg$Svg_Attributes$vertOriginX = _elm_lang$virtual_dom$VirtualDom$attribute('vert-origin-x');
var _elm_lang$svg$Svg_Attributes$vertAdvY = _elm_lang$virtual_dom$VirtualDom$attribute('vert-adv-y');
var _elm_lang$svg$Svg_Attributes$version = _elm_lang$virtual_dom$VirtualDom$attribute('version');
var _elm_lang$svg$Svg_Attributes$values = _elm_lang$virtual_dom$VirtualDom$attribute('values');
var _elm_lang$svg$Svg_Attributes$vMathematical = _elm_lang$virtual_dom$VirtualDom$attribute('v-mathematical');
var _elm_lang$svg$Svg_Attributes$vIdeographic = _elm_lang$virtual_dom$VirtualDom$attribute('v-ideographic');
var _elm_lang$svg$Svg_Attributes$vHanging = _elm_lang$virtual_dom$VirtualDom$attribute('v-hanging');
var _elm_lang$svg$Svg_Attributes$vAlphabetic = _elm_lang$virtual_dom$VirtualDom$attribute('v-alphabetic');
var _elm_lang$svg$Svg_Attributes$unitsPerEm = _elm_lang$virtual_dom$VirtualDom$attribute('units-per-em');
var _elm_lang$svg$Svg_Attributes$unicodeRange = _elm_lang$virtual_dom$VirtualDom$attribute('unicode-range');
var _elm_lang$svg$Svg_Attributes$unicode = _elm_lang$virtual_dom$VirtualDom$attribute('unicode');
var _elm_lang$svg$Svg_Attributes$underlineThickness = _elm_lang$virtual_dom$VirtualDom$attribute('underline-thickness');
var _elm_lang$svg$Svg_Attributes$underlinePosition = _elm_lang$virtual_dom$VirtualDom$attribute('underline-position');
var _elm_lang$svg$Svg_Attributes$u2 = _elm_lang$virtual_dom$VirtualDom$attribute('u2');
var _elm_lang$svg$Svg_Attributes$u1 = _elm_lang$virtual_dom$VirtualDom$attribute('u1');
var _elm_lang$svg$Svg_Attributes$type_ = _elm_lang$virtual_dom$VirtualDom$attribute('type');
var _elm_lang$svg$Svg_Attributes$transform = _elm_lang$virtual_dom$VirtualDom$attribute('transform');
var _elm_lang$svg$Svg_Attributes$to = _elm_lang$virtual_dom$VirtualDom$attribute('to');
var _elm_lang$svg$Svg_Attributes$title = _elm_lang$virtual_dom$VirtualDom$attribute('title');
var _elm_lang$svg$Svg_Attributes$textLength = _elm_lang$virtual_dom$VirtualDom$attribute('textLength');
var _elm_lang$svg$Svg_Attributes$targetY = _elm_lang$virtual_dom$VirtualDom$attribute('targetY');
var _elm_lang$svg$Svg_Attributes$targetX = _elm_lang$virtual_dom$VirtualDom$attribute('targetX');
var _elm_lang$svg$Svg_Attributes$target = _elm_lang$virtual_dom$VirtualDom$attribute('target');
var _elm_lang$svg$Svg_Attributes$tableValues = _elm_lang$virtual_dom$VirtualDom$attribute('tableValues');
var _elm_lang$svg$Svg_Attributes$systemLanguage = _elm_lang$virtual_dom$VirtualDom$attribute('systemLanguage');
var _elm_lang$svg$Svg_Attributes$surfaceScale = _elm_lang$virtual_dom$VirtualDom$attribute('surfaceScale');
var _elm_lang$svg$Svg_Attributes$style = _elm_lang$virtual_dom$VirtualDom$attribute('style');
var _elm_lang$svg$Svg_Attributes$string = _elm_lang$virtual_dom$VirtualDom$attribute('string');
var _elm_lang$svg$Svg_Attributes$strikethroughThickness = _elm_lang$virtual_dom$VirtualDom$attribute('strikethrough-thickness');
var _elm_lang$svg$Svg_Attributes$strikethroughPosition = _elm_lang$virtual_dom$VirtualDom$attribute('strikethrough-position');
var _elm_lang$svg$Svg_Attributes$stitchTiles = _elm_lang$virtual_dom$VirtualDom$attribute('stitchTiles');
var _elm_lang$svg$Svg_Attributes$stemv = _elm_lang$virtual_dom$VirtualDom$attribute('stemv');
var _elm_lang$svg$Svg_Attributes$stemh = _elm_lang$virtual_dom$VirtualDom$attribute('stemh');
var _elm_lang$svg$Svg_Attributes$stdDeviation = _elm_lang$virtual_dom$VirtualDom$attribute('stdDeviation');
var _elm_lang$svg$Svg_Attributes$startOffset = _elm_lang$virtual_dom$VirtualDom$attribute('startOffset');
var _elm_lang$svg$Svg_Attributes$spreadMethod = _elm_lang$virtual_dom$VirtualDom$attribute('spreadMethod');
var _elm_lang$svg$Svg_Attributes$speed = _elm_lang$virtual_dom$VirtualDom$attribute('speed');
var _elm_lang$svg$Svg_Attributes$specularExponent = _elm_lang$virtual_dom$VirtualDom$attribute('specularExponent');
var _elm_lang$svg$Svg_Attributes$specularConstant = _elm_lang$virtual_dom$VirtualDom$attribute('specularConstant');
var _elm_lang$svg$Svg_Attributes$spacing = _elm_lang$virtual_dom$VirtualDom$attribute('spacing');
var _elm_lang$svg$Svg_Attributes$slope = _elm_lang$virtual_dom$VirtualDom$attribute('slope');
var _elm_lang$svg$Svg_Attributes$seed = _elm_lang$virtual_dom$VirtualDom$attribute('seed');
var _elm_lang$svg$Svg_Attributes$scale = _elm_lang$virtual_dom$VirtualDom$attribute('scale');
var _elm_lang$svg$Svg_Attributes$ry = _elm_lang$virtual_dom$VirtualDom$attribute('ry');
var _elm_lang$svg$Svg_Attributes$rx = _elm_lang$virtual_dom$VirtualDom$attribute('rx');
var _elm_lang$svg$Svg_Attributes$rotate = _elm_lang$virtual_dom$VirtualDom$attribute('rotate');
var _elm_lang$svg$Svg_Attributes$result = _elm_lang$virtual_dom$VirtualDom$attribute('result');
var _elm_lang$svg$Svg_Attributes$restart = _elm_lang$virtual_dom$VirtualDom$attribute('restart');
var _elm_lang$svg$Svg_Attributes$requiredFeatures = _elm_lang$virtual_dom$VirtualDom$attribute('requiredFeatures');
var _elm_lang$svg$Svg_Attributes$requiredExtensions = _elm_lang$virtual_dom$VirtualDom$attribute('requiredExtensions');
var _elm_lang$svg$Svg_Attributes$repeatDur = _elm_lang$virtual_dom$VirtualDom$attribute('repeatDur');
var _elm_lang$svg$Svg_Attributes$repeatCount = _elm_lang$virtual_dom$VirtualDom$attribute('repeatCount');
var _elm_lang$svg$Svg_Attributes$renderingIntent = _elm_lang$virtual_dom$VirtualDom$attribute('rendering-intent');
var _elm_lang$svg$Svg_Attributes$refY = _elm_lang$virtual_dom$VirtualDom$attribute('refY');
var _elm_lang$svg$Svg_Attributes$refX = _elm_lang$virtual_dom$VirtualDom$attribute('refX');
var _elm_lang$svg$Svg_Attributes$radius = _elm_lang$virtual_dom$VirtualDom$attribute('radius');
var _elm_lang$svg$Svg_Attributes$r = _elm_lang$virtual_dom$VirtualDom$attribute('r');
var _elm_lang$svg$Svg_Attributes$primitiveUnits = _elm_lang$virtual_dom$VirtualDom$attribute('primitiveUnits');
var _elm_lang$svg$Svg_Attributes$preserveAspectRatio = _elm_lang$virtual_dom$VirtualDom$attribute('preserveAspectRatio');
var _elm_lang$svg$Svg_Attributes$preserveAlpha = _elm_lang$virtual_dom$VirtualDom$attribute('preserveAlpha');
var _elm_lang$svg$Svg_Attributes$pointsAtZ = _elm_lang$virtual_dom$VirtualDom$attribute('pointsAtZ');
var _elm_lang$svg$Svg_Attributes$pointsAtY = _elm_lang$virtual_dom$VirtualDom$attribute('pointsAtY');
var _elm_lang$svg$Svg_Attributes$pointsAtX = _elm_lang$virtual_dom$VirtualDom$attribute('pointsAtX');
var _elm_lang$svg$Svg_Attributes$points = _elm_lang$virtual_dom$VirtualDom$attribute('points');
var _elm_lang$svg$Svg_Attributes$pointOrder = _elm_lang$virtual_dom$VirtualDom$attribute('point-order');
var _elm_lang$svg$Svg_Attributes$patternUnits = _elm_lang$virtual_dom$VirtualDom$attribute('patternUnits');
var _elm_lang$svg$Svg_Attributes$patternTransform = _elm_lang$virtual_dom$VirtualDom$attribute('patternTransform');
var _elm_lang$svg$Svg_Attributes$patternContentUnits = _elm_lang$virtual_dom$VirtualDom$attribute('patternContentUnits');
var _elm_lang$svg$Svg_Attributes$pathLength = _elm_lang$virtual_dom$VirtualDom$attribute('pathLength');
var _elm_lang$svg$Svg_Attributes$path = _elm_lang$virtual_dom$VirtualDom$attribute('path');
var _elm_lang$svg$Svg_Attributes$panose1 = _elm_lang$virtual_dom$VirtualDom$attribute('panose-1');
var _elm_lang$svg$Svg_Attributes$overlineThickness = _elm_lang$virtual_dom$VirtualDom$attribute('overline-thickness');
var _elm_lang$svg$Svg_Attributes$overlinePosition = _elm_lang$virtual_dom$VirtualDom$attribute('overline-position');
var _elm_lang$svg$Svg_Attributes$origin = _elm_lang$virtual_dom$VirtualDom$attribute('origin');
var _elm_lang$svg$Svg_Attributes$orientation = _elm_lang$virtual_dom$VirtualDom$attribute('orientation');
var _elm_lang$svg$Svg_Attributes$orient = _elm_lang$virtual_dom$VirtualDom$attribute('orient');
var _elm_lang$svg$Svg_Attributes$order = _elm_lang$virtual_dom$VirtualDom$attribute('order');
var _elm_lang$svg$Svg_Attributes$operator = _elm_lang$virtual_dom$VirtualDom$attribute('operator');
var _elm_lang$svg$Svg_Attributes$offset = _elm_lang$virtual_dom$VirtualDom$attribute('offset');
var _elm_lang$svg$Svg_Attributes$numOctaves = _elm_lang$virtual_dom$VirtualDom$attribute('numOctaves');
var _elm_lang$svg$Svg_Attributes$name = _elm_lang$virtual_dom$VirtualDom$attribute('name');
var _elm_lang$svg$Svg_Attributes$mode = _elm_lang$virtual_dom$VirtualDom$attribute('mode');
var _elm_lang$svg$Svg_Attributes$min = _elm_lang$virtual_dom$VirtualDom$attribute('min');
var _elm_lang$svg$Svg_Attributes$method = _elm_lang$virtual_dom$VirtualDom$attribute('method');
var _elm_lang$svg$Svg_Attributes$media = _elm_lang$virtual_dom$VirtualDom$attribute('media');
var _elm_lang$svg$Svg_Attributes$max = _elm_lang$virtual_dom$VirtualDom$attribute('max');
var _elm_lang$svg$Svg_Attributes$mathematical = _elm_lang$virtual_dom$VirtualDom$attribute('mathematical');
var _elm_lang$svg$Svg_Attributes$maskUnits = _elm_lang$virtual_dom$VirtualDom$attribute('maskUnits');
var _elm_lang$svg$Svg_Attributes$maskContentUnits = _elm_lang$virtual_dom$VirtualDom$attribute('maskContentUnits');
var _elm_lang$svg$Svg_Attributes$markerWidth = _elm_lang$virtual_dom$VirtualDom$attribute('markerWidth');
var _elm_lang$svg$Svg_Attributes$markerUnits = _elm_lang$virtual_dom$VirtualDom$attribute('markerUnits');
var _elm_lang$svg$Svg_Attributes$markerHeight = _elm_lang$virtual_dom$VirtualDom$attribute('markerHeight');
var _elm_lang$svg$Svg_Attributes$local = _elm_lang$virtual_dom$VirtualDom$attribute('local');
var _elm_lang$svg$Svg_Attributes$limitingConeAngle = _elm_lang$virtual_dom$VirtualDom$attribute('limitingConeAngle');
var _elm_lang$svg$Svg_Attributes$lengthAdjust = _elm_lang$virtual_dom$VirtualDom$attribute('lengthAdjust');
var _elm_lang$svg$Svg_Attributes$lang = _elm_lang$virtual_dom$VirtualDom$attribute('lang');
var _elm_lang$svg$Svg_Attributes$keyTimes = _elm_lang$virtual_dom$VirtualDom$attribute('keyTimes');
var _elm_lang$svg$Svg_Attributes$keySplines = _elm_lang$virtual_dom$VirtualDom$attribute('keySplines');
var _elm_lang$svg$Svg_Attributes$keyPoints = _elm_lang$virtual_dom$VirtualDom$attribute('keyPoints');
var _elm_lang$svg$Svg_Attributes$kernelUnitLength = _elm_lang$virtual_dom$VirtualDom$attribute('kernelUnitLength');
var _elm_lang$svg$Svg_Attributes$kernelMatrix = _elm_lang$virtual_dom$VirtualDom$attribute('kernelMatrix');
var _elm_lang$svg$Svg_Attributes$k4 = _elm_lang$virtual_dom$VirtualDom$attribute('k4');
var _elm_lang$svg$Svg_Attributes$k3 = _elm_lang$virtual_dom$VirtualDom$attribute('k3');
var _elm_lang$svg$Svg_Attributes$k2 = _elm_lang$virtual_dom$VirtualDom$attribute('k2');
var _elm_lang$svg$Svg_Attributes$k1 = _elm_lang$virtual_dom$VirtualDom$attribute('k1');
var _elm_lang$svg$Svg_Attributes$k = _elm_lang$virtual_dom$VirtualDom$attribute('k');
var _elm_lang$svg$Svg_Attributes$intercept = _elm_lang$virtual_dom$VirtualDom$attribute('intercept');
var _elm_lang$svg$Svg_Attributes$in2 = _elm_lang$virtual_dom$VirtualDom$attribute('in2');
var _elm_lang$svg$Svg_Attributes$in_ = _elm_lang$virtual_dom$VirtualDom$attribute('in');
var _elm_lang$svg$Svg_Attributes$ideographic = _elm_lang$virtual_dom$VirtualDom$attribute('ideographic');
var _elm_lang$svg$Svg_Attributes$id = _elm_lang$virtual_dom$VirtualDom$attribute('id');
var _elm_lang$svg$Svg_Attributes$horizOriginY = _elm_lang$virtual_dom$VirtualDom$attribute('horiz-origin-y');
var _elm_lang$svg$Svg_Attributes$horizOriginX = _elm_lang$virtual_dom$VirtualDom$attribute('horiz-origin-x');
var _elm_lang$svg$Svg_Attributes$horizAdvX = _elm_lang$virtual_dom$VirtualDom$attribute('horiz-adv-x');
var _elm_lang$svg$Svg_Attributes$height = _elm_lang$virtual_dom$VirtualDom$attribute('height');
var _elm_lang$svg$Svg_Attributes$hanging = _elm_lang$virtual_dom$VirtualDom$attribute('hanging');
var _elm_lang$svg$Svg_Attributes$gradientUnits = _elm_lang$virtual_dom$VirtualDom$attribute('gradientUnits');
var _elm_lang$svg$Svg_Attributes$gradientTransform = _elm_lang$virtual_dom$VirtualDom$attribute('gradientTransform');
var _elm_lang$svg$Svg_Attributes$glyphRef = _elm_lang$virtual_dom$VirtualDom$attribute('glyphRef');
var _elm_lang$svg$Svg_Attributes$glyphName = _elm_lang$virtual_dom$VirtualDom$attribute('glyph-name');
var _elm_lang$svg$Svg_Attributes$g2 = _elm_lang$virtual_dom$VirtualDom$attribute('g2');
var _elm_lang$svg$Svg_Attributes$g1 = _elm_lang$virtual_dom$VirtualDom$attribute('g1');
var _elm_lang$svg$Svg_Attributes$fy = _elm_lang$virtual_dom$VirtualDom$attribute('fy');
var _elm_lang$svg$Svg_Attributes$fx = _elm_lang$virtual_dom$VirtualDom$attribute('fx');
var _elm_lang$svg$Svg_Attributes$from = _elm_lang$virtual_dom$VirtualDom$attribute('from');
var _elm_lang$svg$Svg_Attributes$format = _elm_lang$virtual_dom$VirtualDom$attribute('format');
var _elm_lang$svg$Svg_Attributes$filterUnits = _elm_lang$virtual_dom$VirtualDom$attribute('filterUnits');
var _elm_lang$svg$Svg_Attributes$filterRes = _elm_lang$virtual_dom$VirtualDom$attribute('filterRes');
var _elm_lang$svg$Svg_Attributes$externalResourcesRequired = _elm_lang$virtual_dom$VirtualDom$attribute('externalResourcesRequired');
var _elm_lang$svg$Svg_Attributes$exponent = _elm_lang$virtual_dom$VirtualDom$attribute('exponent');
var _elm_lang$svg$Svg_Attributes$end = _elm_lang$virtual_dom$VirtualDom$attribute('end');
var _elm_lang$svg$Svg_Attributes$elevation = _elm_lang$virtual_dom$VirtualDom$attribute('elevation');
var _elm_lang$svg$Svg_Attributes$edgeMode = _elm_lang$virtual_dom$VirtualDom$attribute('edgeMode');
var _elm_lang$svg$Svg_Attributes$dy = _elm_lang$virtual_dom$VirtualDom$attribute('dy');
var _elm_lang$svg$Svg_Attributes$dx = _elm_lang$virtual_dom$VirtualDom$attribute('dx');
var _elm_lang$svg$Svg_Attributes$dur = _elm_lang$virtual_dom$VirtualDom$attribute('dur');
var _elm_lang$svg$Svg_Attributes$divisor = _elm_lang$virtual_dom$VirtualDom$attribute('divisor');
var _elm_lang$svg$Svg_Attributes$diffuseConstant = _elm_lang$virtual_dom$VirtualDom$attribute('diffuseConstant');
var _elm_lang$svg$Svg_Attributes$descent = _elm_lang$virtual_dom$VirtualDom$attribute('descent');
var _elm_lang$svg$Svg_Attributes$decelerate = _elm_lang$virtual_dom$VirtualDom$attribute('decelerate');
var _elm_lang$svg$Svg_Attributes$d = _elm_lang$virtual_dom$VirtualDom$attribute('d');
var _elm_lang$svg$Svg_Attributes$cy = _elm_lang$virtual_dom$VirtualDom$attribute('cy');
var _elm_lang$svg$Svg_Attributes$cx = _elm_lang$virtual_dom$VirtualDom$attribute('cx');
var _elm_lang$svg$Svg_Attributes$contentStyleType = _elm_lang$virtual_dom$VirtualDom$attribute('contentStyleType');
var _elm_lang$svg$Svg_Attributes$contentScriptType = _elm_lang$virtual_dom$VirtualDom$attribute('contentScriptType');
var _elm_lang$svg$Svg_Attributes$clipPathUnits = _elm_lang$virtual_dom$VirtualDom$attribute('clipPathUnits');
var _elm_lang$svg$Svg_Attributes$class = _elm_lang$virtual_dom$VirtualDom$attribute('class');
var _elm_lang$svg$Svg_Attributes$capHeight = _elm_lang$virtual_dom$VirtualDom$attribute('cap-height');
var _elm_lang$svg$Svg_Attributes$calcMode = _elm_lang$virtual_dom$VirtualDom$attribute('calcMode');
var _elm_lang$svg$Svg_Attributes$by = _elm_lang$virtual_dom$VirtualDom$attribute('by');
var _elm_lang$svg$Svg_Attributes$bias = _elm_lang$virtual_dom$VirtualDom$attribute('bias');
var _elm_lang$svg$Svg_Attributes$begin = _elm_lang$virtual_dom$VirtualDom$attribute('begin');
var _elm_lang$svg$Svg_Attributes$bbox = _elm_lang$virtual_dom$VirtualDom$attribute('bbox');
var _elm_lang$svg$Svg_Attributes$baseProfile = _elm_lang$virtual_dom$VirtualDom$attribute('baseProfile');
var _elm_lang$svg$Svg_Attributes$baseFrequency = _elm_lang$virtual_dom$VirtualDom$attribute('baseFrequency');
var _elm_lang$svg$Svg_Attributes$azimuth = _elm_lang$virtual_dom$VirtualDom$attribute('azimuth');
var _elm_lang$svg$Svg_Attributes$autoReverse = _elm_lang$virtual_dom$VirtualDom$attribute('autoReverse');
var _elm_lang$svg$Svg_Attributes$attributeType = _elm_lang$virtual_dom$VirtualDom$attribute('attributeType');
var _elm_lang$svg$Svg_Attributes$attributeName = _elm_lang$virtual_dom$VirtualDom$attribute('attributeName');
var _elm_lang$svg$Svg_Attributes$ascent = _elm_lang$virtual_dom$VirtualDom$attribute('ascent');
var _elm_lang$svg$Svg_Attributes$arabicForm = _elm_lang$virtual_dom$VirtualDom$attribute('arabic-form');
var _elm_lang$svg$Svg_Attributes$amplitude = _elm_lang$virtual_dom$VirtualDom$attribute('amplitude');
var _elm_lang$svg$Svg_Attributes$allowReorder = _elm_lang$virtual_dom$VirtualDom$attribute('allowReorder');
var _elm_lang$svg$Svg_Attributes$alphabetic = _elm_lang$virtual_dom$VirtualDom$attribute('alphabetic');
var _elm_lang$svg$Svg_Attributes$additive = _elm_lang$virtual_dom$VirtualDom$attribute('additive');
var _elm_lang$svg$Svg_Attributes$accumulate = _elm_lang$virtual_dom$VirtualDom$attribute('accumulate');
var _elm_lang$svg$Svg_Attributes$accelerate = _elm_lang$virtual_dom$VirtualDom$attribute('accelerate');
var _elm_lang$svg$Svg_Attributes$accentHeight = _elm_lang$virtual_dom$VirtualDom$attribute('accent-height');

var _elm_lang$svg$Svg_Events$on = _elm_lang$virtual_dom$VirtualDom$on;
var _elm_lang$svg$Svg_Events$simpleOn = F2(
	function (name, msg) {
		return A2(
			_elm_lang$svg$Svg_Events$on,
			name,
			_elm_lang$core$Json_Decode$succeed(msg));
	});
var _elm_lang$svg$Svg_Events$onBegin = _elm_lang$svg$Svg_Events$simpleOn('begin');
var _elm_lang$svg$Svg_Events$onEnd = _elm_lang$svg$Svg_Events$simpleOn('end');
var _elm_lang$svg$Svg_Events$onRepeat = _elm_lang$svg$Svg_Events$simpleOn('repeat');
var _elm_lang$svg$Svg_Events$onAbort = _elm_lang$svg$Svg_Events$simpleOn('abort');
var _elm_lang$svg$Svg_Events$onError = _elm_lang$svg$Svg_Events$simpleOn('error');
var _elm_lang$svg$Svg_Events$onResize = _elm_lang$svg$Svg_Events$simpleOn('resize');
var _elm_lang$svg$Svg_Events$onScroll = _elm_lang$svg$Svg_Events$simpleOn('scroll');
var _elm_lang$svg$Svg_Events$onLoad = _elm_lang$svg$Svg_Events$simpleOn('load');
var _elm_lang$svg$Svg_Events$onUnload = _elm_lang$svg$Svg_Events$simpleOn('unload');
var _elm_lang$svg$Svg_Events$onZoom = _elm_lang$svg$Svg_Events$simpleOn('zoom');
var _elm_lang$svg$Svg_Events$onActivate = _elm_lang$svg$Svg_Events$simpleOn('activate');
var _elm_lang$svg$Svg_Events$onClick = _elm_lang$svg$Svg_Events$simpleOn('click');
var _elm_lang$svg$Svg_Events$onFocusIn = _elm_lang$svg$Svg_Events$simpleOn('focusin');
var _elm_lang$svg$Svg_Events$onFocusOut = _elm_lang$svg$Svg_Events$simpleOn('focusout');
var _elm_lang$svg$Svg_Events$onMouseDown = _elm_lang$svg$Svg_Events$simpleOn('mousedown');
var _elm_lang$svg$Svg_Events$onMouseMove = _elm_lang$svg$Svg_Events$simpleOn('mousemove');
var _elm_lang$svg$Svg_Events$onMouseOut = _elm_lang$svg$Svg_Events$simpleOn('mouseout');
var _elm_lang$svg$Svg_Events$onMouseOver = _elm_lang$svg$Svg_Events$simpleOn('mouseover');
var _elm_lang$svg$Svg_Events$onMouseUp = _elm_lang$svg$Svg_Events$simpleOn('mouseup');

var _elm_lang$svg$Svg_Lazy$lazy3 = _elm_lang$virtual_dom$VirtualDom$lazy3;
var _elm_lang$svg$Svg_Lazy$lazy2 = _elm_lang$virtual_dom$VirtualDom$lazy2;
var _elm_lang$svg$Svg_Lazy$lazy = _elm_lang$virtual_dom$VirtualDom$lazy;

var _elm_lang$window$Native_Window = function()
{

var size = _elm_lang$core$Native_Scheduler.nativeBinding(function(callback)	{
	callback(_elm_lang$core$Native_Scheduler.succeed({
		width: window.innerWidth,
		height: window.innerHeight
	}));
});

return {
	size: size
};

}();
var _elm_lang$window$Window_ops = _elm_lang$window$Window_ops || {};
_elm_lang$window$Window_ops['&>'] = F2(
	function (task1, task2) {
		return A2(
			_elm_lang$core$Task$andThen,
			function (_p0) {
				return task2;
			},
			task1);
	});
var _elm_lang$window$Window$onSelfMsg = F3(
	function (router, dimensions, state) {
		var _p1 = state;
		if (_p1.ctor === 'Nothing') {
			return _elm_lang$core$Task$succeed(state);
		} else {
			var send = function (_p2) {
				var _p3 = _p2;
				return A2(
					_elm_lang$core$Platform$sendToApp,
					router,
					_p3._0(dimensions));
			};
			return A2(
				_elm_lang$window$Window_ops['&>'],
				_elm_lang$core$Task$sequence(
					A2(_elm_lang$core$List$map, send, _p1._0.subs)),
				_elm_lang$core$Task$succeed(state));
		}
	});
var _elm_lang$window$Window$init = _elm_lang$core$Task$succeed(_elm_lang$core$Maybe$Nothing);
var _elm_lang$window$Window$size = _elm_lang$window$Native_Window.size;
var _elm_lang$window$Window$width = A2(
	_elm_lang$core$Task$map,
	function (_) {
		return _.width;
	},
	_elm_lang$window$Window$size);
var _elm_lang$window$Window$height = A2(
	_elm_lang$core$Task$map,
	function (_) {
		return _.height;
	},
	_elm_lang$window$Window$size);
var _elm_lang$window$Window$onEffects = F3(
	function (router, newSubs, oldState) {
		var _p4 = {ctor: '_Tuple2', _0: oldState, _1: newSubs};
		if (_p4._0.ctor === 'Nothing') {
			if (_p4._1.ctor === '[]') {
				return _elm_lang$core$Task$succeed(_elm_lang$core$Maybe$Nothing);
			} else {
				return A2(
					_elm_lang$core$Task$andThen,
					function (pid) {
						return _elm_lang$core$Task$succeed(
							_elm_lang$core$Maybe$Just(
								{subs: newSubs, pid: pid}));
					},
					_elm_lang$core$Process$spawn(
						A3(
							_elm_lang$dom$Dom_LowLevel$onWindow,
							'resize',
							_elm_lang$core$Json_Decode$succeed(
								{ctor: '_Tuple0'}),
							function (_p5) {
								return A2(
									_elm_lang$core$Task$andThen,
									_elm_lang$core$Platform$sendToSelf(router),
									_elm_lang$window$Window$size);
							})));
			}
		} else {
			if (_p4._1.ctor === '[]') {
				return A2(
					_elm_lang$window$Window_ops['&>'],
					_elm_lang$core$Process$kill(_p4._0._0.pid),
					_elm_lang$core$Task$succeed(_elm_lang$core$Maybe$Nothing));
			} else {
				return _elm_lang$core$Task$succeed(
					_elm_lang$core$Maybe$Just(
						{subs: newSubs, pid: _p4._0._0.pid}));
			}
		}
	});
var _elm_lang$window$Window$subscription = _elm_lang$core$Native_Platform.leaf('Window');
var _elm_lang$window$Window$Size = F2(
	function (a, b) {
		return {width: a, height: b};
	});
var _elm_lang$window$Window$MySub = function (a) {
	return {ctor: 'MySub', _0: a};
};
var _elm_lang$window$Window$resizes = function (tagger) {
	return _elm_lang$window$Window$subscription(
		_elm_lang$window$Window$MySub(tagger));
};
var _elm_lang$window$Window$subMap = F2(
	function (func, _p6) {
		var _p7 = _p6;
		return _elm_lang$window$Window$MySub(
			function (_p8) {
				return func(
					_p7._0(_p8));
			});
	});
_elm_lang$core$Native_Platform.effectManagers['Window'] = {pkg: 'elm-lang/window', init: _elm_lang$window$Window$init, onEffects: _elm_lang$window$Window$onEffects, onSelfMsg: _elm_lang$window$Window$onSelfMsg, tag: 'sub', subMap: _elm_lang$window$Window$subMap};

var _elm_tools$parser_primitives$Native_ParserPrimitives = function() {


// STRINGS

function isSubString(smallString, offset, row, col, bigString)
{
	var smallLength = smallString.length;
	var bigLength = bigString.length - offset;

	if (bigLength < smallLength)
	{
		return tuple3(-1, row, col);
	}

	for (var i = 0; i < smallLength; i++)
	{
		var char = smallString[i];

		if (char !== bigString[offset + i])
		{
			return tuple3(-1, row, col);
		}

		// if it is a two word character
		if ((bigString.charCodeAt(offset) & 0xF800) === 0xD800)
		{
			i++
			if (smallString[i] !== bigString[offset + i])
			{
				return tuple3(-1, row, col);
			}
			col++;
			continue;
		}

		// if it is a newline
		if (char === '\n')
		{
			row++;
			col = 1;
			continue;
		}

		// if it is a one word character
		col++
	}

	return tuple3(offset + smallLength, row, col);
}

function tuple3(a, b, c)
{
	return { ctor: '_Tuple3', _0: a, _1: b, _2: c };
}


// CHARS

var mkChar = _elm_lang$core$Native_Utils.chr;

function isSubChar(predicate, offset, string)
{
	if (offset >= string.length)
	{
		return -1;
	}

	if ((string.charCodeAt(offset) & 0xF800) === 0xD800)
	{
		return predicate(mkChar(string.substr(offset, 2)))
			? offset + 2
			: -1;
	}

	var char = string[offset];

	return predicate(mkChar(char))
		? ((char === '\n') ? -2 : (offset + 1))
		: -1;
}


// FIND STRING

function findSubString(before, smallString, offset, row, col, bigString)
{
	var newOffset = bigString.indexOf(smallString, offset);

	if (newOffset === -1)
	{
		return tuple3(-1, row, col);
	}

	var scanTarget = before ? newOffset	: newOffset + smallString.length;

	while (offset < scanTarget)
	{
		var char = bigString[offset];

		if (char === '\n')
		{
			offset++;
			row++;
			col = 1;
			continue;
		}

		if ((bigString.charCodeAt(offset) & 0xF800) === 0xD800)
		{
			offset += 2;
			col++;
			continue;
		}

		offset++;
		col++;
	}

	return tuple3(offset, row, col);
}


return {
	isSubString: F5(isSubString),
	isSubChar: F3(isSubChar),
	findSubString: F6(findSubString)
};

}();

var _elm_tools$parser_primitives$ParserPrimitives$findSubString = _elm_tools$parser_primitives$Native_ParserPrimitives.findSubString;
var _elm_tools$parser_primitives$ParserPrimitives$isSubChar = _elm_tools$parser_primitives$Native_ParserPrimitives.isSubChar;
var _elm_tools$parser_primitives$ParserPrimitives$isSubString = _elm_tools$parser_primitives$Native_ParserPrimitives.isSubString;

var _elm_tools$parser$Parser_Internal$isPlusOrMinus = function ($char) {
	return _elm_lang$core$Native_Utils.eq(
		$char,
		_elm_lang$core$Native_Utils.chr('+')) || _elm_lang$core$Native_Utils.eq(
		$char,
		_elm_lang$core$Native_Utils.chr('-'));
};
var _elm_tools$parser$Parser_Internal$isZero = function ($char) {
	return _elm_lang$core$Native_Utils.eq(
		$char,
		_elm_lang$core$Native_Utils.chr('0'));
};
var _elm_tools$parser$Parser_Internal$isE = function ($char) {
	return _elm_lang$core$Native_Utils.eq(
		$char,
		_elm_lang$core$Native_Utils.chr('e')) || _elm_lang$core$Native_Utils.eq(
		$char,
		_elm_lang$core$Native_Utils.chr('E'));
};
var _elm_tools$parser$Parser_Internal$isDot = function ($char) {
	return _elm_lang$core$Native_Utils.eq(
		$char,
		_elm_lang$core$Native_Utils.chr('.'));
};
var _elm_tools$parser$Parser_Internal$isBadIntEnd = function ($char) {
	return _elm_lang$core$Char$isDigit($char) || (_elm_lang$core$Char$isUpper($char) || (_elm_lang$core$Char$isLower($char) || _elm_lang$core$Native_Utils.eq(
		$char,
		_elm_lang$core$Native_Utils.chr('.'))));
};
var _elm_tools$parser$Parser_Internal$chomp = F3(
	function (isGood, offset, source) {
		chomp:
		while (true) {
			var newOffset = A3(_elm_tools$parser_primitives$ParserPrimitives$isSubChar, isGood, offset, source);
			if (_elm_lang$core$Native_Utils.cmp(newOffset, 0) < 0) {
				return offset;
			} else {
				var _v0 = isGood,
					_v1 = newOffset,
					_v2 = source;
				isGood = _v0;
				offset = _v1;
				source = _v2;
				continue chomp;
			}
		}
	});
var _elm_tools$parser$Parser_Internal$chompDigits = F3(
	function (isValidDigit, offset, source) {
		var newOffset = A3(_elm_tools$parser$Parser_Internal$chomp, isValidDigit, offset, source);
		return _elm_lang$core$Native_Utils.eq(newOffset, offset) ? _elm_lang$core$Result$Err(newOffset) : ((!_elm_lang$core$Native_Utils.eq(
			A3(_elm_tools$parser_primitives$ParserPrimitives$isSubChar, _elm_tools$parser$Parser_Internal$isBadIntEnd, newOffset, source),
			-1)) ? _elm_lang$core$Result$Err(newOffset) : _elm_lang$core$Result$Ok(newOffset));
	});
var _elm_tools$parser$Parser_Internal$chompExp = F2(
	function (offset, source) {
		var eOffset = A3(_elm_tools$parser_primitives$ParserPrimitives$isSubChar, _elm_tools$parser$Parser_Internal$isE, offset, source);
		if (_elm_lang$core$Native_Utils.eq(eOffset, -1)) {
			return _elm_lang$core$Result$Ok(offset);
		} else {
			var opOffset = A3(_elm_tools$parser_primitives$ParserPrimitives$isSubChar, _elm_tools$parser$Parser_Internal$isPlusOrMinus, eOffset, source);
			var expOffset = _elm_lang$core$Native_Utils.eq(opOffset, -1) ? eOffset : opOffset;
			return (!_elm_lang$core$Native_Utils.eq(
				A3(_elm_tools$parser_primitives$ParserPrimitives$isSubChar, _elm_tools$parser$Parser_Internal$isZero, expOffset, source),
				-1)) ? _elm_lang$core$Result$Err(expOffset) : (_elm_lang$core$Native_Utils.eq(
				A3(_elm_tools$parser_primitives$ParserPrimitives$isSubChar, _elm_lang$core$Char$isDigit, expOffset, source),
				-1) ? _elm_lang$core$Result$Err(expOffset) : A3(_elm_tools$parser$Parser_Internal$chompDigits, _elm_lang$core$Char$isDigit, expOffset, source));
		}
	});
var _elm_tools$parser$Parser_Internal$chompDotAndExp = F2(
	function (offset, source) {
		var dotOffset = A3(_elm_tools$parser_primitives$ParserPrimitives$isSubChar, _elm_tools$parser$Parser_Internal$isDot, offset, source);
		return _elm_lang$core$Native_Utils.eq(dotOffset, -1) ? A2(_elm_tools$parser$Parser_Internal$chompExp, offset, source) : A2(
			_elm_tools$parser$Parser_Internal$chompExp,
			A3(_elm_tools$parser$Parser_Internal$chomp, _elm_lang$core$Char$isDigit, dotOffset, source),
			source);
	});
var _elm_tools$parser$Parser_Internal$State = F6(
	function (a, b, c, d, e, f) {
		return {source: a, offset: b, indent: c, context: d, row: e, col: f};
	});
var _elm_tools$parser$Parser_Internal$Parser = function (a) {
	return {ctor: 'Parser', _0: a};
};
var _elm_tools$parser$Parser_Internal$Bad = F2(
	function (a, b) {
		return {ctor: 'Bad', _0: a, _1: b};
	});
var _elm_tools$parser$Parser_Internal$Good = F2(
	function (a, b) {
		return {ctor: 'Good', _0: a, _1: b};
	});

var _elm_tools$parser$Parser$changeContext = F2(
	function (newContext, _p0) {
		var _p1 = _p0;
		return {source: _p1.source, offset: _p1.offset, indent: _p1.indent, context: newContext, row: _p1.row, col: _p1.col};
	});
var _elm_tools$parser$Parser$sourceMap = F2(
	function (func, _p2) {
		var _p3 = _p2;
		return _elm_tools$parser$Parser_Internal$Parser(
			function (_p4) {
				var _p5 = _p4;
				var _p6 = _p3._0(_p5);
				if (_p6.ctor === 'Bad') {
					return A2(_elm_tools$parser$Parser_Internal$Bad, _p6._0, _p6._1);
				} else {
					var _p7 = _p6._1;
					var subString = A3(_elm_lang$core$String$slice, _p5.offset, _p7.offset, _p5.source);
					return A2(
						_elm_tools$parser$Parser_Internal$Good,
						A2(func, subString, _p6._0),
						_p7);
				}
			});
	});
var _elm_tools$parser$Parser$source = function (parser) {
	return A2(_elm_tools$parser$Parser$sourceMap, _elm_lang$core$Basics$always, parser);
};
var _elm_tools$parser$Parser$badFloatMsg = 'The `Parser.float` parser seems to have a bug.\nPlease report an SSCCE to <https://github.com/elm-tools/parser/issues>.';
var _elm_tools$parser$Parser$floatHelp = F3(
	function (offset, zeroOffset, source) {
		if (_elm_lang$core$Native_Utils.cmp(zeroOffset, 0) > -1) {
			return A2(_elm_tools$parser$Parser_Internal$chompDotAndExp, zeroOffset, source);
		} else {
			var dotOffset = A3(_elm_tools$parser$Parser_Internal$chomp, _elm_lang$core$Char$isDigit, offset, source);
			var result = A2(_elm_tools$parser$Parser_Internal$chompDotAndExp, dotOffset, source);
			var _p8 = result;
			if (_p8.ctor === 'Err') {
				return result;
			} else {
				var _p9 = _p8._0;
				return _elm_lang$core$Native_Utils.eq(_p9, offset) ? _elm_lang$core$Result$Err(_p9) : result;
			}
		}
	});
var _elm_tools$parser$Parser$badIntMsg = 'The `Parser.int` parser seems to have a bug.\nPlease report an SSCCE to <https://github.com/elm-tools/parser/issues>.';
var _elm_tools$parser$Parser$isX = function ($char) {
	return _elm_lang$core$Native_Utils.eq(
		$char,
		_elm_lang$core$Native_Utils.chr('x'));
};
var _elm_tools$parser$Parser$isO = function ($char) {
	return _elm_lang$core$Native_Utils.eq(
		$char,
		_elm_lang$core$Native_Utils.chr('o'));
};
var _elm_tools$parser$Parser$isZero = function ($char) {
	return _elm_lang$core$Native_Utils.eq(
		$char,
		_elm_lang$core$Native_Utils.chr('0'));
};
var _elm_tools$parser$Parser$intHelp = F3(
	function (offset, zeroOffset, source) {
		return _elm_lang$core$Native_Utils.eq(zeroOffset, -1) ? A3(_elm_tools$parser$Parser_Internal$chompDigits, _elm_lang$core$Char$isDigit, offset, source) : ((!_elm_lang$core$Native_Utils.eq(
			A3(_elm_tools$parser_primitives$ParserPrimitives$isSubChar, _elm_tools$parser$Parser$isX, zeroOffset, source),
			-1)) ? A3(_elm_tools$parser$Parser_Internal$chompDigits, _elm_lang$core$Char$isHexDigit, offset + 2, source) : (_elm_lang$core$Native_Utils.eq(
			A3(_elm_tools$parser_primitives$ParserPrimitives$isSubChar, _elm_tools$parser$Parser_Internal$isBadIntEnd, zeroOffset, source),
			-1) ? _elm_lang$core$Result$Ok(zeroOffset) : _elm_lang$core$Result$Err(zeroOffset)));
	});
var _elm_tools$parser$Parser$token = F2(
	function (makeProblem, str) {
		return _elm_tools$parser$Parser_Internal$Parser(
			function (_p10) {
				var _p11 = _p10;
				var _p13 = _p11.source;
				var _p12 = A5(_elm_tools$parser_primitives$ParserPrimitives$isSubString, str, _p11.offset, _p11.row, _p11.col, _p13);
				var newOffset = _p12._0;
				var newRow = _p12._1;
				var newCol = _p12._2;
				return _elm_lang$core$Native_Utils.eq(newOffset, -1) ? A2(
					_elm_tools$parser$Parser_Internal$Bad,
					makeProblem(str),
					_p11) : A2(
					_elm_tools$parser$Parser_Internal$Good,
					{ctor: '_Tuple0'},
					{source: _p13, offset: newOffset, indent: _p11.indent, context: _p11.context, row: newRow, col: newCol});
			});
	});
var _elm_tools$parser$Parser$delayedCommitMap = F3(
	function (func, _p15, _p14) {
		var _p16 = _p15;
		var _p17 = _p14;
		return _elm_tools$parser$Parser_Internal$Parser(
			function (state1) {
				var _p18 = _p16._0(state1);
				if (_p18.ctor === 'Bad') {
					return A2(_elm_tools$parser$Parser_Internal$Bad, _p18._0, state1);
				} else {
					var _p22 = _p18._1;
					var _p19 = _p17._0(_p22);
					if (_p19.ctor === 'Good') {
						return A2(
							_elm_tools$parser$Parser_Internal$Good,
							A2(func, _p18._0, _p19._0),
							_p19._1);
					} else {
						var _p21 = _p19._0;
						var _p20 = _p19._1;
						return (_elm_lang$core$Native_Utils.eq(_p22.row, _p20.row) && _elm_lang$core$Native_Utils.eq(_p22.col, _p20.col)) ? A2(_elm_tools$parser$Parser_Internal$Bad, _p21, state1) : A2(_elm_tools$parser$Parser_Internal$Bad, _p21, _p20);
					}
				}
			});
	});
var _elm_tools$parser$Parser$delayedCommit = F2(
	function (filler, realStuff) {
		return A3(
			_elm_tools$parser$Parser$delayedCommitMap,
			F2(
				function (_p23, v) {
					return v;
				}),
			filler,
			realStuff);
	});
var _elm_tools$parser$Parser$lazy = function (thunk) {
	return _elm_tools$parser$Parser_Internal$Parser(
		function (state) {
			var _p24 = thunk(
				{ctor: '_Tuple0'});
			var parse = _p24._0;
			return parse(state);
		});
};
var _elm_tools$parser$Parser$andThen = F2(
	function (callback, _p25) {
		var _p26 = _p25;
		return _elm_tools$parser$Parser_Internal$Parser(
			function (state1) {
				var _p27 = _p26._0(state1);
				if (_p27.ctor === 'Bad') {
					return A2(_elm_tools$parser$Parser_Internal$Bad, _p27._0, _p27._1);
				} else {
					var _p28 = callback(_p27._0);
					var parseB = _p28._0;
					return parseB(_p27._1);
				}
			});
	});
var _elm_tools$parser$Parser$apply = F2(
	function (f, a) {
		return f(a);
	});
var _elm_tools$parser$Parser$map2 = F3(
	function (func, _p30, _p29) {
		var _p31 = _p30;
		var _p32 = _p29;
		return _elm_tools$parser$Parser_Internal$Parser(
			function (state1) {
				var _p33 = _p31._0(state1);
				if (_p33.ctor === 'Bad') {
					return A2(_elm_tools$parser$Parser_Internal$Bad, _p33._0, _p33._1);
				} else {
					var _p34 = _p32._0(_p33._1);
					if (_p34.ctor === 'Bad') {
						return A2(_elm_tools$parser$Parser_Internal$Bad, _p34._0, _p34._1);
					} else {
						return A2(
							_elm_tools$parser$Parser_Internal$Good,
							A2(func, _p33._0, _p34._0),
							_p34._1);
					}
				}
			});
	});
var _elm_tools$parser$Parser_ops = _elm_tools$parser$Parser_ops || {};
_elm_tools$parser$Parser_ops['|='] = F2(
	function (parseFunc, parseArg) {
		return A3(_elm_tools$parser$Parser$map2, _elm_tools$parser$Parser$apply, parseFunc, parseArg);
	});
var _elm_tools$parser$Parser_ops = _elm_tools$parser$Parser_ops || {};
_elm_tools$parser$Parser_ops['|.'] = F2(
	function (keepParser, ignoreParser) {
		return A3(_elm_tools$parser$Parser$map2, _elm_lang$core$Basics$always, keepParser, ignoreParser);
	});
var _elm_tools$parser$Parser$map = F2(
	function (func, _p35) {
		var _p36 = _p35;
		return _elm_tools$parser$Parser_Internal$Parser(
			function (state1) {
				var _p37 = _p36._0(state1);
				if (_p37.ctor === 'Good') {
					return A2(
						_elm_tools$parser$Parser_Internal$Good,
						func(_p37._0),
						_p37._1);
				} else {
					return A2(_elm_tools$parser$Parser_Internal$Bad, _p37._0, _p37._1);
				}
			});
	});
var _elm_tools$parser$Parser$succeed = function (a) {
	return _elm_tools$parser$Parser_Internal$Parser(
		function (state) {
			return A2(_elm_tools$parser$Parser_Internal$Good, a, state);
		});
};
var _elm_tools$parser$Parser$run = F2(
	function (_p38, source) {
		var _p39 = _p38;
		var initialState = {
			source: source,
			offset: 0,
			indent: 1,
			context: {ctor: '[]'},
			row: 1,
			col: 1
		};
		var _p40 = _p39._0(initialState);
		if (_p40.ctor === 'Good') {
			return _elm_lang$core$Result$Ok(_p40._0);
		} else {
			return _elm_lang$core$Result$Err(
				{row: _p40._1.row, col: _p40._1.col, source: source, problem: _p40._0, context: _p40._1.context});
		}
	});
var _elm_tools$parser$Parser$Error = F5(
	function (a, b, c, d, e) {
		return {row: a, col: b, source: c, problem: d, context: e};
	});
var _elm_tools$parser$Parser$Context = F3(
	function (a, b, c) {
		return {row: a, col: b, description: c};
	});
var _elm_tools$parser$Parser$inContext = F2(
	function (ctx, _p41) {
		var _p42 = _p41;
		return _elm_tools$parser$Parser_Internal$Parser(
			function (_p43) {
				var _p44 = _p43;
				var _p46 = _p44.context;
				var state1 = A2(
					_elm_tools$parser$Parser$changeContext,
					{
						ctor: '::',
						_0: A3(_elm_tools$parser$Parser$Context, _p44.row, _p44.col, ctx),
						_1: _p46
					},
					_p44);
				var _p45 = _p42._0(state1);
				if (_p45.ctor === 'Good') {
					return A2(
						_elm_tools$parser$Parser_Internal$Good,
						_p45._0,
						A2(_elm_tools$parser$Parser$changeContext, _p46, _p45._1));
				} else {
					return _p45;
				}
			});
	});
var _elm_tools$parser$Parser$Fail = function (a) {
	return {ctor: 'Fail', _0: a};
};
var _elm_tools$parser$Parser$fail = function (message) {
	return _elm_tools$parser$Parser_Internal$Parser(
		function (state) {
			return A2(
				_elm_tools$parser$Parser_Internal$Bad,
				_elm_tools$parser$Parser$Fail(message),
				state);
		});
};
var _elm_tools$parser$Parser$ExpectingClosing = function (a) {
	return {ctor: 'ExpectingClosing', _0: a};
};
var _elm_tools$parser$Parser$ignoreUntil = function (str) {
	return _elm_tools$parser$Parser_Internal$Parser(
		function (_p47) {
			var _p48 = _p47;
			var _p50 = _p48.source;
			var _p49 = A6(_elm_tools$parser_primitives$ParserPrimitives$findSubString, false, str, _p48.offset, _p48.row, _p48.col, _p50);
			var newOffset = _p49._0;
			var newRow = _p49._1;
			var newCol = _p49._2;
			return _elm_lang$core$Native_Utils.eq(newOffset, -1) ? A2(
				_elm_tools$parser$Parser_Internal$Bad,
				_elm_tools$parser$Parser$ExpectingClosing(str),
				_p48) : A2(
				_elm_tools$parser$Parser_Internal$Good,
				{ctor: '_Tuple0'},
				{source: _p50, offset: newOffset, indent: _p48.indent, context: _p48.context, row: newRow, col: newCol});
		});
};
var _elm_tools$parser$Parser$ExpectingVariable = {ctor: 'ExpectingVariable'};
var _elm_tools$parser$Parser$ExpectingKeyword = function (a) {
	return {ctor: 'ExpectingKeyword', _0: a};
};
var _elm_tools$parser$Parser$keyword = function (str) {
	return A2(_elm_tools$parser$Parser$token, _elm_tools$parser$Parser$ExpectingKeyword, str);
};
var _elm_tools$parser$Parser$ExpectingSymbol = function (a) {
	return {ctor: 'ExpectingSymbol', _0: a};
};
var _elm_tools$parser$Parser$symbol = function (str) {
	return A2(_elm_tools$parser$Parser$token, _elm_tools$parser$Parser$ExpectingSymbol, str);
};
var _elm_tools$parser$Parser$ExpectingEnd = {ctor: 'ExpectingEnd'};
var _elm_tools$parser$Parser$end = _elm_tools$parser$Parser_Internal$Parser(
	function (state) {
		return _elm_lang$core$Native_Utils.eq(
			_elm_lang$core$String$length(state.source),
			state.offset) ? A2(
			_elm_tools$parser$Parser_Internal$Good,
			{ctor: '_Tuple0'},
			state) : A2(_elm_tools$parser$Parser_Internal$Bad, _elm_tools$parser$Parser$ExpectingEnd, state);
	});
var _elm_tools$parser$Parser$BadRepeat = {ctor: 'BadRepeat'};
var _elm_tools$parser$Parser$repeatExactly = F4(
	function (n, parse, revList, state1) {
		repeatExactly:
		while (true) {
			if (_elm_lang$core$Native_Utils.cmp(n, 0) < 1) {
				return A2(
					_elm_tools$parser$Parser_Internal$Good,
					_elm_lang$core$List$reverse(revList),
					state1);
			} else {
				var _p51 = parse(state1);
				if (_p51.ctor === 'Good') {
					var _p52 = _p51._1;
					if (_elm_lang$core$Native_Utils.eq(state1.row, _p52.row) && _elm_lang$core$Native_Utils.eq(state1.col, _p52.col)) {
						return A2(_elm_tools$parser$Parser_Internal$Bad, _elm_tools$parser$Parser$BadRepeat, _p52);
					} else {
						var _v25 = n - 1,
							_v26 = parse,
							_v27 = {ctor: '::', _0: _p51._0, _1: revList},
							_v28 = _p52;
						n = _v25;
						parse = _v26;
						revList = _v27;
						state1 = _v28;
						continue repeatExactly;
					}
				} else {
					return A2(_elm_tools$parser$Parser_Internal$Bad, _p51._0, _p51._1);
				}
			}
		}
	});
var _elm_tools$parser$Parser$repeatAtLeast = F4(
	function (n, parse, revList, state1) {
		repeatAtLeast:
		while (true) {
			var _p53 = parse(state1);
			if (_p53.ctor === 'Good') {
				var _p54 = _p53._1;
				if (_elm_lang$core$Native_Utils.eq(state1.row, _p54.row) && _elm_lang$core$Native_Utils.eq(state1.col, _p54.col)) {
					return A2(_elm_tools$parser$Parser_Internal$Bad, _elm_tools$parser$Parser$BadRepeat, _p54);
				} else {
					var _v30 = n - 1,
						_v31 = parse,
						_v32 = {ctor: '::', _0: _p53._0, _1: revList},
						_v33 = _p54;
					n = _v30;
					parse = _v31;
					revList = _v32;
					state1 = _v33;
					continue repeatAtLeast;
				}
			} else {
				var _p55 = _p53._1;
				return (_elm_lang$core$Native_Utils.eq(state1.row, _p55.row) && (_elm_lang$core$Native_Utils.eq(state1.col, _p55.col) && (_elm_lang$core$Native_Utils.cmp(n, 0) < 1))) ? A2(
					_elm_tools$parser$Parser_Internal$Good,
					_elm_lang$core$List$reverse(revList),
					state1) : A2(_elm_tools$parser$Parser_Internal$Bad, _p53._0, _p55);
			}
		}
	});
var _elm_tools$parser$Parser$repeat = F2(
	function (count, _p56) {
		var _p57 = _p56;
		var _p59 = _p57._0;
		var _p58 = count;
		if (_p58.ctor === 'Exactly') {
			return _elm_tools$parser$Parser_Internal$Parser(
				function (state) {
					return A4(
						_elm_tools$parser$Parser$repeatExactly,
						_p58._0,
						_p59,
						{ctor: '[]'},
						state);
				});
		} else {
			return _elm_tools$parser$Parser_Internal$Parser(
				function (state) {
					return A4(
						_elm_tools$parser$Parser$repeatAtLeast,
						_p58._0,
						_p59,
						{ctor: '[]'},
						state);
				});
		}
	});
var _elm_tools$parser$Parser$ignoreExactly = F8(
	function (n, predicate, source, offset, indent, context, row, col) {
		ignoreExactly:
		while (true) {
			if (_elm_lang$core$Native_Utils.cmp(n, 0) < 1) {
				return A2(
					_elm_tools$parser$Parser_Internal$Good,
					{ctor: '_Tuple0'},
					{source: source, offset: offset, indent: indent, context: context, row: row, col: col});
			} else {
				var newOffset = A3(_elm_tools$parser_primitives$ParserPrimitives$isSubChar, predicate, offset, source);
				if (_elm_lang$core$Native_Utils.eq(newOffset, -1)) {
					return A2(
						_elm_tools$parser$Parser_Internal$Bad,
						_elm_tools$parser$Parser$BadRepeat,
						{source: source, offset: offset, indent: indent, context: context, row: row, col: col});
				} else {
					if (_elm_lang$core$Native_Utils.eq(newOffset, -2)) {
						var _v36 = n - 1,
							_v37 = predicate,
							_v38 = source,
							_v39 = offset + 1,
							_v40 = indent,
							_v41 = context,
							_v42 = row + 1,
							_v43 = 1;
						n = _v36;
						predicate = _v37;
						source = _v38;
						offset = _v39;
						indent = _v40;
						context = _v41;
						row = _v42;
						col = _v43;
						continue ignoreExactly;
					} else {
						var _v44 = n - 1,
							_v45 = predicate,
							_v46 = source,
							_v47 = newOffset,
							_v48 = indent,
							_v49 = context,
							_v50 = row,
							_v51 = col + 1;
						n = _v44;
						predicate = _v45;
						source = _v46;
						offset = _v47;
						indent = _v48;
						context = _v49;
						row = _v50;
						col = _v51;
						continue ignoreExactly;
					}
				}
			}
		}
	});
var _elm_tools$parser$Parser$ignoreAtLeast = F8(
	function (n, predicate, source, offset, indent, context, row, col) {
		ignoreAtLeast:
		while (true) {
			var newOffset = A3(_elm_tools$parser_primitives$ParserPrimitives$isSubChar, predicate, offset, source);
			if (_elm_lang$core$Native_Utils.eq(newOffset, -1)) {
				var state = {source: source, offset: offset, indent: indent, context: context, row: row, col: col};
				return (_elm_lang$core$Native_Utils.cmp(n, 0) < 1) ? A2(
					_elm_tools$parser$Parser_Internal$Good,
					{ctor: '_Tuple0'},
					state) : A2(_elm_tools$parser$Parser_Internal$Bad, _elm_tools$parser$Parser$BadRepeat, state);
			} else {
				if (_elm_lang$core$Native_Utils.eq(newOffset, -2)) {
					var _v52 = n - 1,
						_v53 = predicate,
						_v54 = source,
						_v55 = offset + 1,
						_v56 = indent,
						_v57 = context,
						_v58 = row + 1,
						_v59 = 1;
					n = _v52;
					predicate = _v53;
					source = _v54;
					offset = _v55;
					indent = _v56;
					context = _v57;
					row = _v58;
					col = _v59;
					continue ignoreAtLeast;
				} else {
					var _v60 = n - 1,
						_v61 = predicate,
						_v62 = source,
						_v63 = newOffset,
						_v64 = indent,
						_v65 = context,
						_v66 = row,
						_v67 = col + 1;
					n = _v60;
					predicate = _v61;
					source = _v62;
					offset = _v63;
					indent = _v64;
					context = _v65;
					row = _v66;
					col = _v67;
					continue ignoreAtLeast;
				}
			}
		}
	});
var _elm_tools$parser$Parser$ignore = F2(
	function (count, predicate) {
		var _p60 = count;
		if (_p60.ctor === 'Exactly') {
			return _elm_tools$parser$Parser_Internal$Parser(
				function (_p61) {
					var _p62 = _p61;
					return A8(_elm_tools$parser$Parser$ignoreExactly, _p60._0, predicate, _p62.source, _p62.offset, _p62.indent, _p62.context, _p62.row, _p62.col);
				});
		} else {
			return _elm_tools$parser$Parser_Internal$Parser(
				function (_p63) {
					var _p64 = _p63;
					return A8(_elm_tools$parser$Parser$ignoreAtLeast, _p60._0, predicate, _p64.source, _p64.offset, _p64.indent, _p64.context, _p64.row, _p64.col);
				});
		}
	});
var _elm_tools$parser$Parser$keep = F2(
	function (count, predicate) {
		return _elm_tools$parser$Parser$source(
			A2(_elm_tools$parser$Parser$ignore, count, predicate));
	});
var _elm_tools$parser$Parser$BadFloat = {ctor: 'BadFloat'};
var _elm_tools$parser$Parser$float = _elm_tools$parser$Parser_Internal$Parser(
	function (_p65) {
		var _p66 = _p65;
		var _p77 = _p66.source;
		var _p76 = _p66.row;
		var _p75 = _p66.offset;
		var _p74 = _p66.indent;
		var _p73 = _p66.context;
		var _p72 = _p66.col;
		var _p67 = A3(
			_elm_tools$parser$Parser$floatHelp,
			_p75,
			A3(_elm_tools$parser_primitives$ParserPrimitives$isSubChar, _elm_tools$parser$Parser$isZero, _p75, _p77),
			_p77);
		if (_p67.ctor === 'Err') {
			var _p68 = _p67._0;
			return A2(
				_elm_tools$parser$Parser_Internal$Bad,
				_elm_tools$parser$Parser$BadFloat,
				{source: _p77, offset: _p68, indent: _p74, context: _p73, row: _p76, col: _p72 + (_p68 - _p75)});
		} else {
			var _p71 = _p67._0;
			var _p69 = _elm_lang$core$String$toFloat(
				A3(_elm_lang$core$String$slice, _p75, _p71, _p77));
			if (_p69.ctor === 'Err') {
				return _elm_lang$core$Native_Utils.crashCase(
					'Parser',
					{
						start: {line: 733, column: 9},
						end: {line: 745, column: 16}
					},
					_p69)(_elm_tools$parser$Parser$badFloatMsg);
			} else {
				return A2(
					_elm_tools$parser$Parser_Internal$Good,
					_p69._0,
					{source: _p77, offset: _p71, indent: _p74, context: _p73, row: _p76, col: _p72 + (_p71 - _p75)});
			}
		}
	});
var _elm_tools$parser$Parser$BadInt = {ctor: 'BadInt'};
var _elm_tools$parser$Parser$int = _elm_tools$parser$Parser_Internal$Parser(
	function (_p78) {
		var _p79 = _p78;
		var _p90 = _p79.source;
		var _p89 = _p79.row;
		var _p88 = _p79.offset;
		var _p87 = _p79.indent;
		var _p86 = _p79.context;
		var _p85 = _p79.col;
		var _p80 = A3(
			_elm_tools$parser$Parser$intHelp,
			_p88,
			A3(_elm_tools$parser_primitives$ParserPrimitives$isSubChar, _elm_tools$parser$Parser$isZero, _p88, _p90),
			_p90);
		if (_p80.ctor === 'Err') {
			var _p81 = _p80._0;
			return A2(
				_elm_tools$parser$Parser_Internal$Bad,
				_elm_tools$parser$Parser$BadInt,
				{source: _p90, offset: _p81, indent: _p87, context: _p86, row: _p89, col: _p85 + (_p81 - _p88)});
		} else {
			var _p84 = _p80._0;
			var _p82 = _elm_lang$core$String$toInt(
				A3(_elm_lang$core$String$slice, _p88, _p84, _p90));
			if (_p82.ctor === 'Err') {
				return _elm_lang$core$Native_Utils.crashCase(
					'Parser',
					{
						start: {line: 638, column: 9},
						end: {line: 650, column: 16}
					},
					_p82)(_elm_tools$parser$Parser$badIntMsg);
			} else {
				return A2(
					_elm_tools$parser$Parser_Internal$Good,
					_p82._0,
					{source: _p90, offset: _p84, indent: _p87, context: _p86, row: _p89, col: _p85 + (_p84 - _p88)});
			}
		}
	});
var _elm_tools$parser$Parser$BadOneOf = function (a) {
	return {ctor: 'BadOneOf', _0: a};
};
var _elm_tools$parser$Parser$oneOfHelp = F3(
	function (state, problems, parsers) {
		oneOfHelp:
		while (true) {
			var _p91 = parsers;
			if (_p91.ctor === '[]') {
				return A2(
					_elm_tools$parser$Parser_Internal$Bad,
					_elm_tools$parser$Parser$BadOneOf(
						_elm_lang$core$List$reverse(problems)),
					state);
			} else {
				var _p92 = _p91._0._0(state);
				if (_p92.ctor === 'Good') {
					return _p92;
				} else {
					if (_elm_lang$core$Native_Utils.eq(state.row, _p92._1.row) && _elm_lang$core$Native_Utils.eq(state.col, _p92._1.col)) {
						var _v79 = state,
							_v80 = {ctor: '::', _0: _p92._0, _1: problems},
							_v81 = _p91._1;
						state = _v79;
						problems = _v80;
						parsers = _v81;
						continue oneOfHelp;
					} else {
						return _p92;
					}
				}
			}
		}
	});
var _elm_tools$parser$Parser$oneOf = function (parsers) {
	return _elm_tools$parser$Parser_Internal$Parser(
		function (state) {
			return A3(
				_elm_tools$parser$Parser$oneOfHelp,
				state,
				{ctor: '[]'},
				parsers);
		});
};
var _elm_tools$parser$Parser$Exactly = function (a) {
	return {ctor: 'Exactly', _0: a};
};
var _elm_tools$parser$Parser$AtLeast = function (a) {
	return {ctor: 'AtLeast', _0: a};
};
var _elm_tools$parser$Parser$zeroOrMore = _elm_tools$parser$Parser$AtLeast(0);
var _elm_tools$parser$Parser$oneOrMore = _elm_tools$parser$Parser$AtLeast(1);

var _elm_tools$parser$Parser_LanguageKit$isChar = function ($char) {
	return true;
};
var _elm_tools$parser$Parser_LanguageKit$isTab = function ($char) {
	return _elm_lang$core$Native_Utils.eq(
		$char,
		_elm_lang$core$Native_Utils.chr('\t'));
};
var _elm_tools$parser$Parser_LanguageKit$isSpace = function ($char) {
	return _elm_lang$core$Native_Utils.eq(
		$char,
		_elm_lang$core$Native_Utils.chr(' ')) || (_elm_lang$core$Native_Utils.eq(
		$char,
		_elm_lang$core$Native_Utils.chr('\n')) || _elm_lang$core$Native_Utils.eq(
		$char,
		_elm_lang$core$Native_Utils.chr('\r')));
};
var _elm_tools$parser$Parser_LanguageKit$chompSpaces = A2(_elm_tools$parser$Parser$ignore, _elm_tools$parser$Parser$zeroOrMore, _elm_tools$parser$Parser_LanguageKit$isSpace);
var _elm_tools$parser$Parser_LanguageKit$revAlways = F2(
	function (_p0, keep) {
		return keep;
	});
var _elm_tools$parser$Parser_LanguageKit$ignore = F2(
	function (ignoreParser, keepParser) {
		return A3(_elm_tools$parser$Parser$map2, _elm_tools$parser$Parser_LanguageKit$revAlways, ignoreParser, keepParser);
	});
var _elm_tools$parser$Parser_LanguageKit_ops = _elm_tools$parser$Parser_LanguageKit_ops || {};
_elm_tools$parser$Parser_LanguageKit_ops['|-'] = _elm_tools$parser$Parser_LanguageKit$ignore;
var _elm_tools$parser$Parser_LanguageKit$sequenceEndMandatory = F5(
	function (end, spaces, parseItem, sep, revItems) {
		var chompRest = function (item) {
			return A5(
				_elm_tools$parser$Parser_LanguageKit$sequenceEndMandatory,
				end,
				spaces,
				parseItem,
				sep,
				{ctor: '::', _0: item, _1: revItems});
		};
		return _elm_tools$parser$Parser$oneOf(
			{
				ctor: '::',
				_0: A2(
					_elm_tools$parser$Parser$andThen,
					chompRest,
					A2(
						_elm_tools$parser$Parser_ops['|.'],
						A2(
							_elm_tools$parser$Parser_ops['|.'],
							A2(_elm_tools$parser$Parser_ops['|.'], parseItem, spaces),
							_elm_tools$parser$Parser$symbol(sep)),
						spaces)),
				_1: {
					ctor: '::',
					_0: A2(
						_elm_tools$parser$Parser_LanguageKit_ops['|-'],
						_elm_tools$parser$Parser$symbol(end),
						_elm_tools$parser$Parser$succeed(
							_elm_lang$core$List$reverse(revItems))),
					_1: {ctor: '[]'}
				}
			});
	});
var _elm_tools$parser$Parser_LanguageKit$sequenceEndForbidden = F5(
	function (end, spaces, parseItem, sep, revItems) {
		var chompRest = function (item) {
			return A5(
				_elm_tools$parser$Parser_LanguageKit$sequenceEndForbidden,
				end,
				spaces,
				parseItem,
				sep,
				{ctor: '::', _0: item, _1: revItems});
		};
		return A2(
			_elm_tools$parser$Parser_LanguageKit$ignore,
			spaces,
			_elm_tools$parser$Parser$oneOf(
				{
					ctor: '::',
					_0: A2(
						_elm_tools$parser$Parser_LanguageKit_ops['|-'],
						A2(
							_elm_tools$parser$Parser_LanguageKit_ops['|-'],
							_elm_tools$parser$Parser$symbol(sep),
							spaces),
						A2(_elm_tools$parser$Parser$andThen, chompRest, parseItem)),
					_1: {
						ctor: '::',
						_0: A2(
							_elm_tools$parser$Parser_LanguageKit_ops['|-'],
							_elm_tools$parser$Parser$symbol(end),
							_elm_tools$parser$Parser$succeed(
								_elm_lang$core$List$reverse(revItems))),
						_1: {ctor: '[]'}
					}
				}));
	});
var _elm_tools$parser$Parser_LanguageKit$sequenceEndOptional = F5(
	function (end, spaces, parseItem, sep, revItems) {
		var chompRest = function (item) {
			return A5(
				_elm_tools$parser$Parser_LanguageKit$sequenceEndOptional,
				end,
				spaces,
				parseItem,
				sep,
				{ctor: '::', _0: item, _1: revItems});
		};
		var parseEnd = A2(
			_elm_tools$parser$Parser$andThen,
			function (_p1) {
				return _elm_tools$parser$Parser$succeed(
					_elm_lang$core$List$reverse(revItems));
			},
			_elm_tools$parser$Parser$symbol(end));
		return A2(
			_elm_tools$parser$Parser_LanguageKit$ignore,
			spaces,
			_elm_tools$parser$Parser$oneOf(
				{
					ctor: '::',
					_0: A2(
						_elm_tools$parser$Parser_LanguageKit_ops['|-'],
						A2(
							_elm_tools$parser$Parser_LanguageKit_ops['|-'],
							_elm_tools$parser$Parser$symbol(sep),
							spaces),
						_elm_tools$parser$Parser$oneOf(
							{
								ctor: '::',
								_0: A2(_elm_tools$parser$Parser$andThen, chompRest, parseItem),
								_1: {
									ctor: '::',
									_0: parseEnd,
									_1: {ctor: '[]'}
								}
							})),
					_1: {
						ctor: '::',
						_0: parseEnd,
						_1: {ctor: '[]'}
					}
				}));
	});
var _elm_tools$parser$Parser_LanguageKit$sequenceEnd = F5(
	function (end, spaces, parseItem, sep, trailing) {
		var chompRest = function (item) {
			var _p2 = trailing;
			switch (_p2.ctor) {
				case 'Forbidden':
					return A5(
						_elm_tools$parser$Parser_LanguageKit$sequenceEndForbidden,
						end,
						spaces,
						parseItem,
						sep,
						{
							ctor: '::',
							_0: item,
							_1: {ctor: '[]'}
						});
				case 'Optional':
					return A5(
						_elm_tools$parser$Parser_LanguageKit$sequenceEndOptional,
						end,
						spaces,
						parseItem,
						sep,
						{
							ctor: '::',
							_0: item,
							_1: {ctor: '[]'}
						});
				default:
					return A2(
						_elm_tools$parser$Parser_LanguageKit_ops['|-'],
						A2(
							_elm_tools$parser$Parser_LanguageKit_ops['|-'],
							A2(
								_elm_tools$parser$Parser_LanguageKit_ops['|-'],
								spaces,
								_elm_tools$parser$Parser$symbol(sep)),
							spaces),
						A5(
							_elm_tools$parser$Parser_LanguageKit$sequenceEndMandatory,
							end,
							spaces,
							parseItem,
							sep,
							{
								ctor: '::',
								_0: item,
								_1: {ctor: '[]'}
							}));
			}
		};
		return _elm_tools$parser$Parser$oneOf(
			{
				ctor: '::',
				_0: A2(_elm_tools$parser$Parser$andThen, chompRest, parseItem),
				_1: {
					ctor: '::',
					_0: A2(
						_elm_tools$parser$Parser_LanguageKit_ops['|-'],
						_elm_tools$parser$Parser$symbol(end),
						_elm_tools$parser$Parser$succeed(
							{ctor: '[]'})),
					_1: {ctor: '[]'}
				}
			});
	});
var _elm_tools$parser$Parser_LanguageKit$whitespaceHelp = function (parser) {
	return A2(
		_elm_tools$parser$Parser_LanguageKit$ignore,
		_elm_tools$parser$Parser_LanguageKit$chompSpaces,
		_elm_tools$parser$Parser$oneOf(
			{
				ctor: '::',
				_0: A2(
					_elm_tools$parser$Parser$andThen,
					function (_p3) {
						return _elm_tools$parser$Parser_LanguageKit$whitespaceHelp(parser);
					},
					parser),
				_1: {
					ctor: '::',
					_0: _elm_tools$parser$Parser$succeed(
						{ctor: '_Tuple0'}),
					_1: {ctor: '[]'}
				}
			}));
};
var _elm_tools$parser$Parser_LanguageKit$nestableCommentHelp = F4(
	function (isNotRelevant, start, end, nestLevel) {
		return _elm_tools$parser$Parser$lazy(
			function (_p4) {
				return A2(
					_elm_tools$parser$Parser_LanguageKit$ignore,
					A2(_elm_tools$parser$Parser$ignore, _elm_tools$parser$Parser$zeroOrMore, isNotRelevant),
					_elm_tools$parser$Parser$oneOf(
						{
							ctor: '::',
							_0: A2(
								_elm_tools$parser$Parser_LanguageKit$ignore,
								_elm_tools$parser$Parser$symbol(end),
								_elm_lang$core$Native_Utils.eq(nestLevel, 1) ? _elm_tools$parser$Parser$succeed(
									{ctor: '_Tuple0'}) : A4(_elm_tools$parser$Parser_LanguageKit$nestableCommentHelp, isNotRelevant, start, end, nestLevel - 1)),
							_1: {
								ctor: '::',
								_0: A2(
									_elm_tools$parser$Parser_LanguageKit$ignore,
									_elm_tools$parser$Parser$symbol(start),
									A4(_elm_tools$parser$Parser_LanguageKit$nestableCommentHelp, isNotRelevant, start, end, nestLevel + 1)),
								_1: {
									ctor: '::',
									_0: A2(
										_elm_tools$parser$Parser_LanguageKit$ignore,
										A2(
											_elm_tools$parser$Parser$ignore,
											_elm_tools$parser$Parser$Exactly(1),
											_elm_tools$parser$Parser_LanguageKit$isChar),
										A4(_elm_tools$parser$Parser_LanguageKit$nestableCommentHelp, isNotRelevant, start, end, nestLevel)),
									_1: {ctor: '[]'}
								}
							}
						}));
			});
	});
var _elm_tools$parser$Parser_LanguageKit$nestableComment = F2(
	function (start, end) {
		var _p5 = {
			ctor: '_Tuple2',
			_0: _elm_lang$core$String$uncons(start),
			_1: _elm_lang$core$String$uncons(end)
		};
		if (_p5._0.ctor === 'Nothing') {
			return _elm_tools$parser$Parser$fail('Trying to parse a multi-line comment, but the start token cannot be the empty string!');
		} else {
			if (_p5._1.ctor === 'Nothing') {
				return _elm_tools$parser$Parser$fail('Trying to parse a multi-line comment, but the end token cannot be the empty string!');
			} else {
				var isNotRelevant = function ($char) {
					return (!_elm_lang$core$Native_Utils.eq($char, _p5._0._0._0)) && (!_elm_lang$core$Native_Utils.eq($char, _p5._1._0._0));
				};
				return A2(
					_elm_tools$parser$Parser_ops['|.'],
					_elm_tools$parser$Parser$symbol(start),
					A4(_elm_tools$parser$Parser_LanguageKit$nestableCommentHelp, isNotRelevant, start, end, 1));
			}
		}
	});
var _elm_tools$parser$Parser_LanguageKit$whitespace = function (_p6) {
	var _p7 = _p6;
	var multiParser = function () {
		var _p8 = _p7.multiComment;
		switch (_p8.ctor) {
			case 'NoMultiComment':
				return {ctor: '[]'};
			case 'UnnestableComment':
				return {
					ctor: '::',
					_0: A2(
						_elm_tools$parser$Parser_ops['|.'],
						_elm_tools$parser$Parser$symbol(_p8._0),
						_elm_tools$parser$Parser$ignoreUntil(_p8._1)),
					_1: {ctor: '[]'}
				};
			default:
				return {
					ctor: '::',
					_0: A2(_elm_tools$parser$Parser_LanguageKit$nestableComment, _p8._0, _p8._1),
					_1: {ctor: '[]'}
				};
		}
	}();
	var lineParser = function () {
		var _p9 = _p7.lineComment;
		if (_p9.ctor === 'NoLineComment') {
			return {ctor: '[]'};
		} else {
			return {
				ctor: '::',
				_0: A2(
					_elm_tools$parser$Parser_ops['|.'],
					_elm_tools$parser$Parser$symbol(_p9._0),
					_elm_tools$parser$Parser$ignoreUntil('\n')),
				_1: {ctor: '[]'}
			};
		}
	}();
	var tabParser = _p7.allowTabs ? {
		ctor: '::',
		_0: A2(_elm_tools$parser$Parser$ignore, _elm_tools$parser$Parser$zeroOrMore, _elm_tools$parser$Parser_LanguageKit$isTab),
		_1: {ctor: '[]'}
	} : {ctor: '[]'};
	return _elm_tools$parser$Parser_LanguageKit$whitespaceHelp(
		_elm_tools$parser$Parser$oneOf(
			A2(
				_elm_lang$core$Basics_ops['++'],
				tabParser,
				A2(_elm_lang$core$Basics_ops['++'], lineParser, multiParser))));
};
var _elm_tools$parser$Parser_LanguageKit$sequence = function (_p10) {
	var _p11 = _p10;
	var _p12 = _p11.spaces;
	return A2(
		_elm_tools$parser$Parser_LanguageKit_ops['|-'],
		A2(
			_elm_tools$parser$Parser_LanguageKit_ops['|-'],
			_elm_tools$parser$Parser$symbol(_p11.start),
			_p12),
		A5(_elm_tools$parser$Parser_LanguageKit$sequenceEnd, _p11.end, _p12, _p11.item, _p11.separator, _p11.trailing));
};
var _elm_tools$parser$Parser_LanguageKit$varHelp = F7(
	function (isGood, offset, row, col, source, indent, context) {
		varHelp:
		while (true) {
			var newOffset = A3(_elm_tools$parser_primitives$ParserPrimitives$isSubChar, isGood, offset, source);
			if (_elm_lang$core$Native_Utils.eq(newOffset, -1)) {
				return {source: source, offset: offset, indent: indent, context: context, row: row, col: col};
			} else {
				if (_elm_lang$core$Native_Utils.eq(newOffset, -2)) {
					var _v6 = isGood,
						_v7 = offset + 1,
						_v8 = row + 1,
						_v9 = 1,
						_v10 = source,
						_v11 = indent,
						_v12 = context;
					isGood = _v6;
					offset = _v7;
					row = _v8;
					col = _v9;
					source = _v10;
					indent = _v11;
					context = _v12;
					continue varHelp;
				} else {
					var _v13 = isGood,
						_v14 = newOffset,
						_v15 = row,
						_v16 = col + 1,
						_v17 = source,
						_v18 = indent,
						_v19 = context;
					isGood = _v13;
					offset = _v14;
					row = _v15;
					col = _v16;
					source = _v17;
					indent = _v18;
					context = _v19;
					continue varHelp;
				}
			}
		}
	});
var _elm_tools$parser$Parser_LanguageKit$variable = F3(
	function (isFirst, isOther, keywords) {
		return _elm_tools$parser$Parser_Internal$Parser(
			function (_p13) {
				var _p14 = _p13;
				var _p20 = _p14;
				var _p19 = _p14.source;
				var _p18 = _p14.row;
				var _p17 = _p14.offset;
				var _p16 = _p14.indent;
				var _p15 = _p14.context;
				var firstOffset = A3(_elm_tools$parser_primitives$ParserPrimitives$isSubChar, isFirst, _p17, _p19);
				if (_elm_lang$core$Native_Utils.eq(firstOffset, -1)) {
					return A2(_elm_tools$parser$Parser_Internal$Bad, _elm_tools$parser$Parser$ExpectingVariable, _p20);
				} else {
					var state2 = _elm_lang$core$Native_Utils.eq(firstOffset, -2) ? A7(_elm_tools$parser$Parser_LanguageKit$varHelp, isOther, _p17 + 1, _p18 + 1, 1, _p19, _p16, _p15) : A7(_elm_tools$parser$Parser_LanguageKit$varHelp, isOther, firstOffset, _p18, _p14.col + 1, _p19, _p16, _p15);
					var name = A3(_elm_lang$core$String$slice, _p17, state2.offset, _p19);
					return A2(_elm_lang$core$Set$member, name, keywords) ? A2(_elm_tools$parser$Parser_Internal$Bad, _elm_tools$parser$Parser$ExpectingVariable, _p20) : A2(_elm_tools$parser$Parser_Internal$Good, name, state2);
				}
			});
	});
var _elm_tools$parser$Parser_LanguageKit$Mandatory = {ctor: 'Mandatory'};
var _elm_tools$parser$Parser_LanguageKit$Optional = {ctor: 'Optional'};
var _elm_tools$parser$Parser_LanguageKit$Forbidden = {ctor: 'Forbidden'};
var _elm_tools$parser$Parser_LanguageKit$list = F2(
	function (spaces, item) {
		return _elm_tools$parser$Parser_LanguageKit$sequence(
			{start: '[', separator: ',', end: ']', spaces: spaces, item: item, trailing: _elm_tools$parser$Parser_LanguageKit$Forbidden});
	});
var _elm_tools$parser$Parser_LanguageKit$record = F2(
	function (spaces, item) {
		return _elm_tools$parser$Parser_LanguageKit$sequence(
			{start: '{', separator: ',', end: '}', spaces: spaces, item: item, trailing: _elm_tools$parser$Parser_LanguageKit$Forbidden});
	});
var _elm_tools$parser$Parser_LanguageKit$tuple = F2(
	function (spaces, item) {
		return _elm_tools$parser$Parser_LanguageKit$sequence(
			{start: '(', separator: ',', end: ')', spaces: spaces, item: item, trailing: _elm_tools$parser$Parser_LanguageKit$Forbidden});
	});
var _elm_tools$parser$Parser_LanguageKit$LineComment = function (a) {
	return {ctor: 'LineComment', _0: a};
};
var _elm_tools$parser$Parser_LanguageKit$NoLineComment = {ctor: 'NoLineComment'};
var _elm_tools$parser$Parser_LanguageKit$UnnestableComment = F2(
	function (a, b) {
		return {ctor: 'UnnestableComment', _0: a, _1: b};
	});
var _elm_tools$parser$Parser_LanguageKit$NestableComment = F2(
	function (a, b) {
		return {ctor: 'NestableComment', _0: a, _1: b};
	});
var _elm_tools$parser$Parser_LanguageKit$NoMultiComment = {ctor: 'NoMultiComment'};

var _elm_tools$parser$Parser_LowLevel$getSource = _elm_tools$parser$Parser_Internal$Parser(
	function (state) {
		return A2(_elm_tools$parser$Parser_Internal$Good, state.source, state);
	});
var _elm_tools$parser$Parser_LowLevel$getOffset = _elm_tools$parser$Parser_Internal$Parser(
	function (state) {
		return A2(_elm_tools$parser$Parser_Internal$Good, state.offset, state);
	});
var _elm_tools$parser$Parser_LowLevel$getCol = _elm_tools$parser$Parser_Internal$Parser(
	function (state) {
		return A2(_elm_tools$parser$Parser_Internal$Good, state.col, state);
	});
var _elm_tools$parser$Parser_LowLevel$getRow = _elm_tools$parser$Parser_Internal$Parser(
	function (state) {
		return A2(_elm_tools$parser$Parser_Internal$Good, state.row, state);
	});
var _elm_tools$parser$Parser_LowLevel$getPosition = _elm_tools$parser$Parser_Internal$Parser(
	function (state) {
		return A2(
			_elm_tools$parser$Parser_Internal$Good,
			{ctor: '_Tuple2', _0: state.row, _1: state.col},
			state);
	});
var _elm_tools$parser$Parser_LowLevel$changeIndent = F2(
	function (newIndent, _p0) {
		var _p1 = _p0;
		return {source: _p1.source, offset: _p1.offset, indent: newIndent, context: _p1.context, row: _p1.row, col: _p1.col};
	});
var _elm_tools$parser$Parser_LowLevel$withIndentLevel = F2(
	function (newIndent, _p2) {
		var _p3 = _p2;
		return _elm_tools$parser$Parser_Internal$Parser(
			function (state1) {
				var _p4 = _p3._0(
					A2(_elm_tools$parser$Parser_LowLevel$changeIndent, newIndent, state1));
				if (_p4.ctor === 'Good') {
					return A2(
						_elm_tools$parser$Parser_Internal$Good,
						_p4._0,
						A2(_elm_tools$parser$Parser_LowLevel$changeIndent, state1.indent, _p4._1));
				} else {
					return A2(
						_elm_tools$parser$Parser_Internal$Bad,
						_p4._0,
						A2(_elm_tools$parser$Parser_LowLevel$changeIndent, state1.indent, _p4._1));
				}
			});
	});
var _elm_tools$parser$Parser_LowLevel$getIndentLevel = _elm_tools$parser$Parser_Internal$Parser(
	function (state) {
		return A2(_elm_tools$parser$Parser_Internal$Good, state.indent, state);
	});

var _user$project$Ace$Annotation = F3(
	function (a, b, c) {
		return {row: a, type_: b, text: c};
	});
var _user$project$Ace$Tooltip = F3(
	function (a, b, c) {
		return {row: a, col: b, text: c};
	});
var _user$project$Ace$Highlight = F2(
	function (a, b) {
		return {range: a, color: b};
	});
var _user$project$Ace$Pos = F2(
	function (a, b) {
		return {row: a, column: b};
	});
var _user$project$Ace$Range = F2(
	function (a, b) {
		return {start: a, end: b};
	});

var _user$project$Updatable$needsUpdate = function (_p0) {
	var _p1 = _p0;
	var _p2 = _p1._0;
	if (_p2.ctor === 'NeedsUpdate') {
		return true;
	} else {
		return false;
	}
};
var _user$project$Updatable$extract = function (_p3) {
	var _p4 = _p3;
	return _p4._1;
};
var _user$project$Updatable$Updated = {ctor: 'Updated'};
var _user$project$Updatable$NeedsUpdate = {ctor: 'NeedsUpdate'};
var _user$project$Updatable$U = F2(
	function (a, b) {
		return {ctor: 'U', _0: a, _1: b};
	});
var _user$project$Updatable$create = function (val) {
	return A2(_user$project$Updatable$U, _user$project$Updatable$NeedsUpdate, val);
};
var _user$project$Updatable$setUpdated = function (_p5) {
	var _p6 = _p5;
	return A2(_user$project$Updatable$U, _user$project$Updatable$Updated, _p6._1);
};

var _user$project$Utils$isOdd = function (n) {
	return _elm_lang$core$Native_Utils.eq(
		A2(_elm_lang$core$Basics_ops['%'], n, 2),
		1);
};
var _user$project$Utils$isEven = function (n) {
	return _elm_lang$core$Native_Utils.eq(
		A2(_elm_lang$core$Basics_ops['%'], n, 2),
		0);
};
var _user$project$Utils$log = function (s) {
	return A2(
		_elm_lang$core$Debug$log,
		s,
		{ctor: '_Tuple0'});
};
var _user$project$Utils$or = A2(
	_elm_lang$core$List$foldl,
	F2(
		function (x, y) {
			return x || y;
		}),
	false);
var _user$project$Utils$and = A2(
	_elm_lang$core$List$foldl,
	F2(
		function (x, y) {
			return x && y;
		}),
	true);
var _user$project$Utils$compose = A2(
	_elm_lang$core$List$foldl,
	F2(
		function (x, y) {
			return function (_p0) {
				return x(
					y(_p0));
			};
		}),
	_elm_lang$core$Basics$identity);
var _user$project$Utils$unwrap8 = function (xs) {
	var _p1 = xs;
	if (((((((((_p1.ctor === '::') && (_p1._1.ctor === '::')) && (_p1._1._1.ctor === '::')) && (_p1._1._1._1.ctor === '::')) && (_p1._1._1._1._1.ctor === '::')) && (_p1._1._1._1._1._1.ctor === '::')) && (_p1._1._1._1._1._1._1.ctor === '::')) && (_p1._1._1._1._1._1._1._1.ctor === '::')) && (_p1._1._1._1._1._1._1._1._1.ctor === '[]')) {
		return {ctor: '_Tuple8', _0: _p1._0, _1: _p1._1._0, _2: _p1._1._1._0, _3: _p1._1._1._1._0, _4: _p1._1._1._1._1._0, _5: _p1._1._1._1._1._1._0, _6: _p1._1._1._1._1._1._1._0, _7: _p1._1._1._1._1._1._1._1._0};
	} else {
		return _elm_lang$core$Native_Utils.crashCase(
			'Utils',
			{
				start: {line: 1060, column: 14},
				end: {line: 1062, column: 29}
			},
			_p1)('unwrap7');
	}
};
var _user$project$Utils$unwrap7 = function (xs) {
	var _p3 = xs;
	if ((((((((_p3.ctor === '::') && (_p3._1.ctor === '::')) && (_p3._1._1.ctor === '::')) && (_p3._1._1._1.ctor === '::')) && (_p3._1._1._1._1.ctor === '::')) && (_p3._1._1._1._1._1.ctor === '::')) && (_p3._1._1._1._1._1._1.ctor === '::')) && (_p3._1._1._1._1._1._1._1.ctor === '[]')) {
		return {ctor: '_Tuple7', _0: _p3._0, _1: _p3._1._0, _2: _p3._1._1._0, _3: _p3._1._1._1._0, _4: _p3._1._1._1._1._0, _5: _p3._1._1._1._1._1._0, _6: _p3._1._1._1._1._1._1._0};
	} else {
		return _elm_lang$core$Native_Utils.crashCase(
			'Utils',
			{
				start: {line: 1056, column: 14},
				end: {line: 1058, column: 29}
			},
			_p3)('unwrap7');
	}
};
var _user$project$Utils$unwrap6 = function (xs) {
	var _p5 = xs;
	if (((((((_p5.ctor === '::') && (_p5._1.ctor === '::')) && (_p5._1._1.ctor === '::')) && (_p5._1._1._1.ctor === '::')) && (_p5._1._1._1._1.ctor === '::')) && (_p5._1._1._1._1._1.ctor === '::')) && (_p5._1._1._1._1._1._1.ctor === '[]')) {
		return {ctor: '_Tuple6', _0: _p5._0, _1: _p5._1._0, _2: _p5._1._1._0, _3: _p5._1._1._1._0, _4: _p5._1._1._1._1._0, _5: _p5._1._1._1._1._1._0};
	} else {
		return _elm_lang$core$Native_Utils.crashCase(
			'Utils',
			{
				start: {line: 1052, column: 14},
				end: {line: 1054, column: 29}
			},
			_p5)('unwrap6');
	}
};
var _user$project$Utils$unwrap5 = function (xs) {
	var _p7 = xs;
	if ((((((_p7.ctor === '::') && (_p7._1.ctor === '::')) && (_p7._1._1.ctor === '::')) && (_p7._1._1._1.ctor === '::')) && (_p7._1._1._1._1.ctor === '::')) && (_p7._1._1._1._1._1.ctor === '[]')) {
		return {ctor: '_Tuple5', _0: _p7._0, _1: _p7._1._0, _2: _p7._1._1._0, _3: _p7._1._1._1._0, _4: _p7._1._1._1._1._0};
	} else {
		return _elm_lang$core$Native_Utils.crashCase(
			'Utils',
			{
				start: {line: 1048, column: 14},
				end: {line: 1050, column: 29}
			},
			_p7)('unwrap5');
	}
};
var _user$project$Utils$unwrap4 = function (xs) {
	var _p9 = xs;
	if (((((_p9.ctor === '::') && (_p9._1.ctor === '::')) && (_p9._1._1.ctor === '::')) && (_p9._1._1._1.ctor === '::')) && (_p9._1._1._1._1.ctor === '[]')) {
		return {ctor: '_Tuple4', _0: _p9._0, _1: _p9._1._0, _2: _p9._1._1._0, _3: _p9._1._1._1._0};
	} else {
		return _elm_lang$core$Native_Utils.crashCase(
			'Utils',
			{
				start: {line: 1044, column: 14},
				end: {line: 1046, column: 29}
			},
			_p9)('unwrap4');
	}
};
var _user$project$Utils$unwrap3 = function (xs) {
	var _p11 = xs;
	if ((((_p11.ctor === '::') && (_p11._1.ctor === '::')) && (_p11._1._1.ctor === '::')) && (_p11._1._1._1.ctor === '[]')) {
		return {ctor: '_Tuple3', _0: _p11._0, _1: _p11._1._0, _2: _p11._1._1._0};
	} else {
		return _elm_lang$core$Native_Utils.crashCase(
			'Utils',
			{
				start: {line: 1040, column: 14},
				end: {line: 1042, column: 29}
			},
			_p11)('unwrap3');
	}
};
var _user$project$Utils$unwrap2 = function (xs) {
	var _p13 = xs;
	if (((_p13.ctor === '::') && (_p13._1.ctor === '::')) && (_p13._1._1.ctor === '[]')) {
		return {ctor: '_Tuple2', _0: _p13._0, _1: _p13._1._0};
	} else {
		return _elm_lang$core$Native_Utils.crashCase(
			'Utils',
			{
				start: {line: 1036, column: 14},
				end: {line: 1038, column: 29}
			},
			_p13)('unwrap2');
	}
};
var _user$project$Utils$unwrap1 = function (xs) {
	var _p15 = xs;
	if ((_p15.ctor === '::') && (_p15._1.ctor === '[]')) {
		return _p15._0;
	} else {
		return _elm_lang$core$Native_Utils.crashCase(
			'Utils',
			{
				start: {line: 1032, column: 14},
				end: {line: 1034, column: 29}
			},
			_p15)('unwrap1');
	}
};
var _user$project$Utils$uniPlusMinus = '';
var _user$project$Utils$uniDelta = '';
var _user$project$Utils$uniLambda = '';
var _user$project$Utils$uniCamera = '';
var _user$project$Utils$uniReload = '';
var _user$project$Utils$uniRedo = '';
var _user$project$Utils$uniUndo = '';
var _user$project$Utils$uniSave = '';
var _user$project$Utils$uniEnter = '';
var _user$project$Utils$uniRight = '';
var _user$project$Utils$uniLeft = '';
var _user$project$Utils$radiansToDegrees = function (rad) {
	return (rad / _elm_lang$core$Basics$pi) * 180;
};
var _user$project$Utils$numToColor_ = function (val) {
	var min = 55;
	var max = 200;
	var diff = max - min;
	var n = _elm_lang$core$Basics$toFloat(
		A2(_elm_lang$core$Basics_ops['%'], val, 360));
	var i = (_elm_lang$core$Basics$floor(n) / 60) | 0;
	var _p17 = i;
	switch (_p17) {
		case 0:
			return {
				ctor: '_Tuple3',
				_0: max,
				_1: _elm_lang$core$Basics$round(min + (diff * (1 - ((60 - n) / 60)))),
				_2: min
			};
		case 1:
			return {
				ctor: '_Tuple3',
				_0: _elm_lang$core$Basics$round(max - (diff * (1 - ((120 - n) / 60)))),
				_1: max,
				_2: min
			};
		case 2:
			return {
				ctor: '_Tuple3',
				_0: min,
				_1: max,
				_2: _elm_lang$core$Basics$round(min + (diff * (1 - ((180 - n) / 60))))
			};
		case 3:
			return {
				ctor: '_Tuple3',
				_0: min,
				_1: _elm_lang$core$Basics$round(max - (diff * (1 - ((240 - n) / 60)))),
				_2: max
			};
		case 4:
			return {
				ctor: '_Tuple3',
				_0: _elm_lang$core$Basics$round(min + (diff * (1 - ((300 - n) / 60)))),
				_1: min,
				_2: max
			};
		case 5:
			return {
				ctor: '_Tuple3',
				_0: max,
				_1: min,
				_2: _elm_lang$core$Basics$round(max - (diff * (1 - ((360 - n) / 60))))
			};
		default:
			return _elm_lang$core$Native_Utils.crashCase(
				'Utils',
				{
					start: {line: 995, column: 6},
					end: {line: 1002, column: 37}
				},
				_p17)('numToColor');
	}
};
var _user$project$Utils$distance = F2(
	function (_p20, _p19) {
		var _p21 = _p20;
		var _p22 = _p19;
		return _elm_lang$core$Basics$sqrt(
			Math.pow(_p22._0 - _p21._0, 2) + Math.pow(_p22._1 - _p21._1, 2));
	});
var _user$project$Utils$distanceInt = F2(
	function (_p24, _p23) {
		var _p25 = _p24;
		var _p26 = _p23;
		return A2(
			_user$project$Utils$distance,
			{
				ctor: '_Tuple2',
				_0: _elm_lang$core$Basics$toFloat(_p25._0),
				_1: _elm_lang$core$Basics$toFloat(_p25._1)
			},
			{
				ctor: '_Tuple2',
				_0: _elm_lang$core$Basics$toFloat(_p26._0),
				_1: _elm_lang$core$Basics$toFloat(_p26._1)
			});
	});
var _user$project$Utils$between = F2(
	function (x, _p27) {
		var _p28 = _p27;
		return (_elm_lang$core$Native_Utils.cmp(_p28._0, x) < 1) && (_elm_lang$core$Native_Utils.cmp(x, _p28._1) < 0);
	});
var _user$project$Utils$numToColor = F2(
	function (n, i) {
		var j = _elm_lang$core$Basics$round((i / n) * 500);
		if (A2(
			_user$project$Utils$between,
			j,
			{ctor: '_Tuple2', _0: 0, _1: 360})) {
			return _user$project$Utils$numToColor_(j);
		} else {
			if (A2(
				_user$project$Utils$between,
				j,
				{ctor: '_Tuple2', _0: 360, _1: 380})) {
				return {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0};
			} else {
				if (A2(
					_user$project$Utils$between,
					j,
					{ctor: '_Tuple2', _0: 480, _1: 500})) {
					return {ctor: '_Tuple3', _0: 255, _1: 255, _2: 255};
				} else {
					var x = _elm_lang$core$Basics$round(
						255 * ((_elm_lang$core$Basics$toFloat(j) - 380) / 100));
					return {ctor: '_Tuple3', _0: x, _1: x, _2: x};
				}
			}
		}
	});
var _user$project$Utils$sgn = function (x) {
	return _elm_lang$core$Native_Utils.eq(x, 0) ? 0 : ((_elm_lang$core$Native_Utils.cmp(x, 0) < 0) ? -1 : ((_elm_lang$core$Native_Utils.cmp(x, 0) > 0) ? 1 : x));
};
var _user$project$Utils$commonPrefixPair = F2(
	function (l1, l2) {
		var _p29 = {ctor: '_Tuple2', _0: l1, _1: l2};
		if (((_p29.ctor === '_Tuple2') && (_p29._0.ctor === '::')) && (_p29._1.ctor === '::')) {
			var _p30 = _p29._0._0;
			return _elm_lang$core$Native_Utils.eq(_p30, _p29._1._0) ? {
				ctor: '::',
				_0: _p30,
				_1: A2(_user$project$Utils$commonPrefixPair, _p29._0._1, _p29._1._1)
			} : {ctor: '[]'};
		} else {
			return {ctor: '[]'};
		}
	});
var _user$project$Utils$commonPrefix = function (lists) {
	var _p31 = lists;
	if (_p31.ctor === '::') {
		return A3(_elm_lang$core$List$foldl, _user$project$Utils$commonPrefixPair, _p31._0, _p31._1);
	} else {
		return {ctor: '[]'};
	}
};
var _user$project$Utils$commonSuffix = function (lists) {
	return _elm_lang$core$List$reverse(
		_user$project$Utils$commonPrefix(
			A2(_elm_lang$core$List$map, _elm_lang$core$List$reverse, lists)));
};
var _user$project$Utils$removeCommonPrefix = function (lists) {
	var prefixLength = _elm_lang$core$List$length(
		_user$project$Utils$commonPrefix(lists));
	return A2(
		_elm_lang$core$List$map,
		_elm_lang$core$List$drop(prefixLength),
		lists);
};
var _user$project$Utils$removeCommonSuffix = function (lists) {
	return A2(
		_elm_lang$core$List$map,
		_elm_lang$core$List$reverse,
		_user$project$Utils$removeCommonPrefix(
			A2(_elm_lang$core$List$map, _elm_lang$core$List$reverse, lists)));
};
var _user$project$Utils$isPrefixOf = F2(
	function (longer, prefix) {
		var _p32 = {ctor: '_Tuple2', _0: longer, _1: prefix};
		if (_p32._1.ctor === '[]') {
			return true;
		} else {
			if (_p32._0.ctor === '[]') {
				return false;
			} else {
				return _elm_lang$core$Native_Utils.eq(_p32._0._0, _p32._1._0) && A2(_user$project$Utils$isPrefixOf, _p32._0._1, _p32._1._1);
			}
		}
	});
var _user$project$Utils$isPrefix = F2(
	function (prefix, longer) {
		return A2(_user$project$Utils$isPrefixOf, longer, prefix);
	});
var _user$project$Utils$setCardinal = function (_p33) {
	return _elm_lang$core$List$length(
		_elm_lang$core$Set$toList(_p33));
};
var _user$project$Utils$dictIsEmpty = function (_p34) {
	return A2(
		F2(
			function (x, y) {
				return _elm_lang$core$Native_Utils.eq(x, y);
			}),
		{ctor: '[]'},
		_elm_lang$core$Dict$toList(_p34));
};
var _user$project$Utils$setIsEmpty = function (_p35) {
	return A2(
		F2(
			function (x, y) {
				return _elm_lang$core$Native_Utils.eq(x, y);
			}),
		{ctor: '[]'},
		_elm_lang$core$Set$toList(_p35));
};
var _user$project$Utils$bindResult = F2(
	function (res, f) {
		var _p36 = res;
		if (_p36.ctor === 'Err') {
			return _elm_lang$core$Result$Err(_p36._0);
		} else {
			return f(_p36._0);
		}
	});
var _user$project$Utils$flip = function (_p37) {
	var _p38 = _p37;
	return {ctor: '_Tuple2', _0: _p38._1, _1: _p38._0};
};
var _user$project$Utils$fourth4 = function (_p39) {
	var _p40 = _p39;
	return _p40._3;
};
var _user$project$Utils$mapThd3 = F2(
	function (f, _p41) {
		var _p42 = _p41;
		return {
			ctor: '_Tuple3',
			_0: _p42._0,
			_1: _p42._1,
			_2: f(_p42._2)
		};
	});
var _user$project$Utils$mapSnd3 = F2(
	function (f, _p43) {
		var _p44 = _p43;
		return {
			ctor: '_Tuple3',
			_0: _p44._0,
			_1: f(_p44._1),
			_2: _p44._2
		};
	});
var _user$project$Utils$mapFst3 = F2(
	function (f, _p45) {
		var _p46 = _p45;
		return {
			ctor: '_Tuple3',
			_0: f(_p46._0),
			_1: _p46._1,
			_2: _p46._2
		};
	});
var _user$project$Utils$thd3 = function (_p47) {
	var _p48 = _p47;
	return _p48._2;
};
var _user$project$Utils$snd3 = function (_p49) {
	var _p50 = _p49;
	return _p50._1;
};
var _user$project$Utils$fst3 = function (_p51) {
	var _p52 = _p51;
	return _p52._0;
};
var _user$project$Utils$mapBoth = F2(
	function (f, _p53) {
		var _p54 = _p53;
		return {
			ctor: '_Tuple2',
			_0: f(_p54._0),
			_1: f(_p54._1)
		};
	});
var _user$project$Utils$projOk = function (list) {
	return A3(
		_elm_lang$core$List$foldr,
		F2(
			function (res, out) {
				var _p55 = {ctor: '_Tuple2', _0: res, _1: out};
				if (_p55._1.ctor === 'Err') {
					return out;
				} else {
					if (_p55._0.ctor === 'Ok') {
						return _elm_lang$core$Result$Ok(
							{ctor: '::', _0: _p55._0._0, _1: _p55._1._0});
					} else {
						return _elm_lang$core$Result$Err(_p55._0._0);
					}
				}
			}),
		_elm_lang$core$Result$Ok(
			{ctor: '[]'}),
		list);
};
var _user$project$Utils$foldrMaybe = F3(
	function (f, maybeAcc, list) {
		var _p56 = list;
		if (_p56.ctor === '[]') {
			return maybeAcc;
		} else {
			return A2(
				_elm_lang$core$Maybe$andThen,
				function (acc) {
					return A2(f, _p56._0, acc);
				},
				A3(_user$project$Utils$foldrMaybe, f, maybeAcc, _p56._1));
		}
	});
var _user$project$Utils$foldlMaybe = F3(
	function (f, maybeAcc, list) {
		foldlMaybe:
		while (true) {
			var _p57 = {ctor: '_Tuple2', _0: maybeAcc, _1: list};
			if (_p57._0.ctor === 'Nothing') {
				return _elm_lang$core$Maybe$Nothing;
			} else {
				if (_p57._1.ctor === '::') {
					var _v30 = f,
						_v31 = A2(f, _p57._1._0, _p57._0._0),
						_v32 = _p57._1._1;
					f = _v30;
					maybeAcc = _v31;
					list = _v32;
					continue foldlMaybe;
				} else {
					return maybeAcc;
				}
			}
		}
	});
var _user$project$Utils$filterJusts = function (mxs) {
	filterJusts:
	while (true) {
		var _p58 = mxs;
		if (_p58.ctor === '[]') {
			return {ctor: '[]'};
		} else {
			if (_p58._0.ctor === 'Just') {
				return {
					ctor: '::',
					_0: _p58._0._0,
					_1: _user$project$Utils$filterJusts(_p58._1)
				};
			} else {
				var _v34 = _p58._1;
				mxs = _v34;
				continue filterJusts;
			}
		}
	}
};
var _user$project$Utils$projJusts = A2(
	_elm_lang$core$List$foldr,
	F2(
		function (mx, acc) {
			var _p59 = {ctor: '_Tuple2', _0: mx, _1: acc};
			if (((_p59.ctor === '_Tuple2') && (_p59._0.ctor === 'Just')) && (_p59._1.ctor === 'Just')) {
				return _elm_lang$core$Maybe$Just(
					{ctor: '::', _0: _p59._0._0, _1: _p59._1._0});
			} else {
				return _elm_lang$core$Maybe$Nothing;
			}
		}),
	_elm_lang$core$Maybe$Just(
		{ctor: '[]'}));
var _user$project$Utils$bindMaybesToList = F2(
	function (list, f) {
		var _p60 = _user$project$Utils$projJusts(list);
		if (_p60.ctor === 'Nothing') {
			return {ctor: '[]'};
		} else {
			return f(_p60._0);
		}
	});
var _user$project$Utils$elseMaybe = F2(
	function (mx, $default) {
		var _p61 = mx;
		if (_p61.ctor === 'Just') {
			return _p61._0;
		} else {
			return $default;
		}
	});
var _user$project$Utils$plusMaybe = F2(
	function (mx, my) {
		var _p62 = mx;
		if (_p62.ctor === 'Just') {
			return mx;
		} else {
			return my;
		}
	});
var _user$project$Utils$firstMaybe = function (list) {
	return A3(_elm_lang$core$List$foldr, _user$project$Utils$plusMaybe, _elm_lang$core$Maybe$Nothing, list);
};
var _user$project$Utils$bindMaybe = _elm_lang$core$Maybe$andThen;
var _user$project$Utils$bindMaybe2 = F3(
	function (f, mx, my) {
		return A2(
			_user$project$Utils$bindMaybe,
			function (x) {
				return A2(
					_user$project$Utils$bindMaybe,
					f(x),
					my);
			},
			mx);
	});
var _user$project$Utils$bindMaybe3 = F4(
	function (f, mx, my, mz) {
		return A3(
			_user$project$Utils$bindMaybe2,
			F2(
				function (x, y) {
					return A2(
						_user$project$Utils$bindMaybe,
						A2(f, x, y),
						mz);
				}),
			mx,
			my);
	});
var _user$project$Utils$filterMaybe = F2(
	function (pred, mx) {
		var _p63 = mx;
		if (_p63.ctor === 'Just') {
			var _p64 = _p63._0;
			return pred(_p64) ? _elm_lang$core$Maybe$Just(_p64) : _elm_lang$core$Maybe$Nothing;
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$Utils$mapMaybe = _elm_lang$core$Maybe$map;
var _user$project$Utils$dropWhile = F2(
	function (pred, list) {
		dropWhile:
		while (true) {
			var _p65 = list;
			if (_p65.ctor === '[]') {
				return {ctor: '[]'};
			} else {
				if (pred(_p65._0)) {
					var _v41 = pred,
						_v42 = _p65._1;
					pred = _v41;
					list = _v42;
					continue dropWhile;
				} else {
					return list;
				}
			}
		}
	});
var _user$project$Utils$takeWhile = F2(
	function (pred, list) {
		var _p66 = list;
		if (_p66.ctor === '[]') {
			return {ctor: '[]'};
		} else {
			var _p67 = _p66._0;
			return pred(_p67) ? {
				ctor: '::',
				_0: _p67,
				_1: A2(_user$project$Utils$takeWhile, pred, _p66._1)
			} : {ctor: '[]'};
		}
	});
var _user$project$Utils$takeLast = F2(
	function (n, list) {
		return _elm_lang$core$List$reverse(
			A2(
				_elm_lang$core$List$take,
				n,
				_elm_lang$core$List$reverse(list)));
	});
var _user$project$Utils$maybeUncons = function (list) {
	var _p68 = list;
	if (_p68.ctor === '[]') {
		return _elm_lang$core$Maybe$Nothing;
	} else {
		return _elm_lang$core$Maybe$Just(
			{ctor: '_Tuple2', _0: _p68._0, _1: _p68._1});
	}
};
var _user$project$Utils$uncons = function (xs) {
	var _p69 = xs;
	if (_p69.ctor === '::') {
		return {ctor: '_Tuple2', _0: _p69._0, _1: _p69._1};
	} else {
		return _elm_lang$core$Native_Utils.crashCase(
			'Utils',
			{
				start: {line: 772, column: 13},
				end: {line: 774, column: 32}
			},
			_p69)('uncons');
	}
};
var _user$project$Utils$maybeLast = function (list) {
	maybeLast:
	while (true) {
		var _p71 = list;
		if (_p71.ctor === '[]') {
			return _elm_lang$core$Maybe$Nothing;
		} else {
			if (_p71._1.ctor === '[]') {
				return _elm_lang$core$Maybe$Just(_p71._0);
			} else {
				var _v47 = _p71._1;
				list = _v47;
				continue maybeLast;
			}
		}
	}
};
var _user$project$Utils$dictGetSet = F2(
	function (k, d) {
		return A2(
			_elm_lang$core$Maybe$withDefault,
			_elm_lang$core$Set$empty,
			A2(_elm_lang$core$Dict$get, k, d));
	});
var _user$project$Utils$dictUnionSet = F3(
	function (k, more, dict) {
		return A3(
			_elm_lang$core$Dict$insert,
			k,
			A2(
				_elm_lang$core$Set$union,
				more,
				A2(_user$project$Utils$dictGetSet, k, dict)),
			dict);
	});
var _user$project$Utils$dictAddToSet = F3(
	function (k, v, dict) {
		var _p72 = A2(_elm_lang$core$Dict$get, k, dict);
		if (_p72.ctor === 'Just') {
			return A3(
				_elm_lang$core$Dict$insert,
				k,
				A2(_elm_lang$core$Set$insert, v, _p72._0),
				dict);
		} else {
			return A3(
				_elm_lang$core$Dict$insert,
				k,
				_elm_lang$core$Set$singleton(v),
				dict);
		}
	});
var _user$project$Utils$multiKeySingleValue = F2(
	function (keys, value) {
		return A3(
			_elm_lang$core$List$foldl,
			F2(
				function (key, dict) {
					return A3(_elm_lang$core$Dict$insert, key, value, dict);
				}),
			_elm_lang$core$Dict$empty,
			keys);
	});
var _user$project$Utils$flipDict = function (dict) {
	return _elm_lang$core$Dict$fromList(
		A2(
			_elm_lang$core$List$map,
			_user$project$Utils$flip,
			_elm_lang$core$Dict$toList(dict)));
};
var _user$project$Utils$toggleDict = F2(
	function (_p73, dict) {
		var _p74 = _p73;
		var _p75 = _p74._0;
		return A2(_elm_lang$core$Dict$member, _p75, dict) ? A2(_elm_lang$core$Dict$remove, _p75, dict) : A3(_elm_lang$core$Dict$insert, _p75, _p74._1, dict);
	});
var _user$project$Utils$toggleSet = F2(
	function (x, set) {
		return A2(_elm_lang$core$Set$member, x, set) ? A2(_elm_lang$core$Set$remove, x, set) : A2(_elm_lang$core$Set$insert, x, set);
	});
var _user$project$Utils$getWithDefault = F3(
	function (key, $default, dict) {
		var _p76 = A2(_elm_lang$core$Dict$get, key, dict);
		if (_p76.ctor === 'Just') {
			return _p76._0;
		} else {
			return $default;
		}
	});
var _user$project$Utils$justGetError = F4(
	function (s, k, d, _p77) {
		var _p78 = _p77;
		return A2(
			_elm_lang$core$Basics_ops['++'],
			'Utils.justGet ',
			A2(
				_elm_lang$core$Basics_ops['++'],
				s,
				A2(
					_elm_lang$core$Basics_ops['++'],
					': key ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_elm_lang$core$Basics$toString(k),
						A2(
							_elm_lang$core$Basics_ops['++'],
							' not found in dictionary ',
							_elm_lang$core$Basics$toString(d))))));
	});
var _user$project$Utils$unwrapNestedResult = function (nestedResult) {
	var _p79 = nestedResult;
	if (_p79.ctor === 'Err') {
		return _elm_lang$core$Result$Err(_p79._0);
	} else {
		if (_p79._0.ctor === 'Err') {
			return _elm_lang$core$Result$Err(_p79._0._0);
		} else {
			return _elm_lang$core$Result$Ok(_p79._0._0);
		}
	}
};
var _user$project$Utils$fromOk = F2(
	function (s, mx) {
		var _p80 = mx;
		if (_p80.ctor === 'Ok') {
			return _p80._0;
		} else {
			return _elm_lang$core$Native_Utils.crashCase(
				'Utils',
				{
					start: {line: 690, column: 15},
					end: {line: 692, column: 60}
				},
				_p80)(
				A2(
					_elm_lang$core$Basics_ops['++'],
					'fromOk [',
					A2(
						_elm_lang$core$Basics_ops['++'],
						s,
						A2(_elm_lang$core$Basics_ops['++'], ']: ', _p80._0))));
		}
	});
var _user$project$Utils$fromOk_ = _user$project$Utils$fromOk('');
var _user$project$Utils$parseInt = function (_p82) {
	return _user$project$Utils$fromOk_(
		_elm_lang$core$String$toInt(_p82));
};
var _user$project$Utils$parseFloat = function (_p83) {
	return _user$project$Utils$fromOk_(
		_elm_lang$core$String$toFloat(_p83));
};
var _user$project$Utils$fromOkay = F2(
	function (s, mx) {
		var _p84 = mx;
		if (_p84.ctor === 'Ok') {
			return _p84._0;
		} else {
			return _elm_lang$core$Native_Utils.crashCase(
				'Utils',
				{
					start: {line: 683, column: 17},
					end: {line: 685, column: 53}
				},
				_p84)(
				A2(
					_elm_lang$core$Basics_ops['++'],
					'fromOkay [',
					A2(_elm_lang$core$Basics_ops['++'], s, ']: ')));
		}
	});
var _user$project$Utils$fromJust__ = F2(
	function (f, mx) {
		var _p86 = mx;
		if (_p86.ctor === 'Just') {
			return _p86._0;
		} else {
			return _elm_lang$core$Native_Utils.crashCase(
				'Utils',
				{
					start: {line: 678, column: 19},
					end: {line: 680, column: 33}
				},
				_p86)(
				f(
					{ctor: '_Tuple0'}));
		}
	});
var _user$project$Utils$justGet = F2(
	function (k, d) {
		return A2(
			_user$project$Utils$fromJust__,
			A3(_user$project$Utils$justGetError, '', k, d),
			A2(_elm_lang$core$Dict$get, k, d));
	});
var _user$project$Utils$justGet_ = F3(
	function (s, k, d) {
		return A2(
			_user$project$Utils$fromJust__,
			A3(_user$project$Utils$justGetError, s, k, d),
			A2(_elm_lang$core$Dict$get, k, d));
	});
var _user$project$Utils$fromJust_ = F2(
	function (s, mx) {
		var _p88 = mx;
		if (_p88.ctor === 'Just') {
			return _p88._0;
		} else {
			return _elm_lang$core$Native_Utils.crashCase(
				'Utils',
				{
					start: {line: 673, column: 18},
					end: {line: 675, column: 53}
				},
				_p88)(
				A2(_elm_lang$core$Basics_ops['++'], 'Utils.fromJust_: ', s));
		}
	});
var _user$project$Utils$head = function (msg) {
	return function (_p90) {
		return A2(
			_user$project$Utils$fromJust_,
			msg,
			_elm_lang$core$List$head(_p90));
	};
};
var _user$project$Utils$head_ = _user$project$Utils$head('Utils.head_');
var _user$project$Utils$tail = function (msg) {
	return function (_p91) {
		return A2(
			_user$project$Utils$fromJust_,
			msg,
			_elm_lang$core$List$tail(_p91));
	};
};
var _user$project$Utils$last = function (msg) {
	return function (_p92) {
		return A2(
			_user$project$Utils$fromJust_,
			msg,
			_user$project$Utils$maybeLast(_p92));
	};
};
var _user$project$Utils$last_ = _user$project$Utils$last('Utils.last_');
var _user$project$Utils$tail_ = function (_p93) {
	return A2(
		_user$project$Utils$fromJust_,
		'Utils.tail_',
		_elm_lang$core$List$tail(_p93));
};
var _user$project$Utils$fromJust = function (m) {
	var _p94 = m;
	if (_p94.ctor === 'Just') {
		return _p94._0;
	} else {
		return _elm_lang$core$Native_Utils.crashCase(
			'Utils',
			{
				start: {line: 669, column: 14},
				end: {line: 671, column: 54}
			},
			_p94)('Utils.fromJust: Nothing');
	}
};
var _user$project$Utils$maybeToBool = function (m) {
	var _p96 = m;
	if (_p96.ctor === 'Just') {
		return true;
	} else {
		return false;
	}
};
var _user$project$Utils$assert = F2(
	function (s, b) {
		return b ? {ctor: '_Tuple0'} : _elm_lang$core$Native_Utils.crash(
			'Utils',
			{
				start: {line: 663, column: 32},
				end: {line: 663, column: 43}
			})(
			A2(_elm_lang$core$Basics_ops['++'], 'assert error: ', s));
	});
var _user$project$Utils$lift_2_2 = F3(
	function (f, _p98, _p97) {
		var _p99 = _p98;
		var _p100 = _p97;
		return {
			ctor: '_Tuple2',
			_0: A2(f, _p99._0, _p100._0),
			_1: A2(f, _p99._1, _p100._1)
		};
	});
var _user$project$Utils$avg = function (ns) {
	return _elm_lang$core$List$sum(ns) / _elm_lang$core$Basics$toFloat(
		_elm_lang$core$List$length(ns));
};
var _user$project$Utils$sum = A2(
	_elm_lang$core$List$foldl,
	F2(
		function (x, y) {
			return x + y;
		}),
	0);
var _user$project$Utils$stringReplace = F3(
	function (target, replacement, string) {
		return A2(
			_elm_lang$core$String$join,
			replacement,
			A2(_elm_lang$core$String$split, target, string));
	});
var _user$project$Utils$capitalize = function (str) {
	var _p101 = A2(_elm_lang$core$String$split, '', str);
	if (_p101.ctor === '[]') {
		return '';
	} else {
		return A2(
			_elm_lang$core$String$join,
			'',
			{
				ctor: '::',
				_0: _elm_lang$core$String$toUpper(_p101._0),
				_1: _p101._1
			});
	}
};
var _user$project$Utils$pluralize = F2(
	function (count, singular) {
		var _p102 = count;
		if (_p102 === 1) {
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_elm_lang$core$Basics$toString(count),
				A2(_elm_lang$core$Basics_ops['++'], ' ', singular));
		} else {
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_elm_lang$core$Basics$toString(count),
				A2(
					_elm_lang$core$Basics_ops['++'],
					' ',
					A2(_elm_lang$core$Basics_ops['++'], singular, 's')));
		}
	});
var _user$project$Utils$perhapsPluralizeList = F2(
	function (str, list) {
		return A2(
			_elm_lang$core$Basics_ops['++'],
			str,
			_elm_lang$core$Native_Utils.eq(
				_elm_lang$core$List$length(list),
				1) ? '' : 's');
	});
var _user$project$Utils$niceTruncateString = F3(
	function (n, toBeContinuedStr, str) {
		return (_elm_lang$core$Native_Utils.cmp(
			_elm_lang$core$String$length(str),
			n) > 0) ? A2(
			_elm_lang$core$Basics_ops['++'],
			_elm_lang$core$String$trimRight(
				A2(
					_elm_lang$core$String$left,
					n - _elm_lang$core$String$length(toBeContinuedStr),
					str)),
			toBeContinuedStr) : str;
	});
var _user$project$Utils$squish = function (str) {
	return _elm_lang$core$String$trim(
		A4(
			_elm_lang$core$Regex$replace,
			_elm_lang$core$Regex$All,
			_elm_lang$core$Regex$regex('\\s+'),
			function (_p103) {
				return ' ';
			},
			str));
};
var _user$project$Utils$commonPrefixString = function (strings) {
	return _elm_lang$core$String$fromList(
		_user$project$Utils$commonPrefix(
			A2(_elm_lang$core$List$map, _elm_lang$core$String$toList, strings)));
};
var _user$project$Utils$commonSuffixString = function (strings) {
	return _elm_lang$core$String$reverse(
		_user$project$Utils$commonPrefixString(
			A2(_elm_lang$core$List$map, _elm_lang$core$String$reverse, strings)));
};
var _user$project$Utils$takeNLines = F2(
	function (n, s) {
		return A2(
			_elm_lang$core$String$join,
			'\n',
			A2(
				_elm_lang$core$List$take,
				n,
				_elm_lang$core$String$lines(s)));
	});
var _user$project$Utils$splitString = F2(
	function (n, s) {
		return {
			ctor: '_Tuple2',
			_0: A2(_elm_lang$core$String$left, n, s),
			_1: A2(_elm_lang$core$String$dropLeft, n, s)
		};
	});
var _user$project$Utils$munchString = F2(
	function (prefix, s) {
		var _p104 = A2(
			_user$project$Utils$splitString,
			_elm_lang$core$String$length(prefix),
			s);
		var pre = _p104._0;
		var suf = _p104._1;
		return _elm_lang$core$Native_Utils.eq(pre, prefix) ? _elm_lang$core$Maybe$Just(suf) : _elm_lang$core$Maybe$Nothing;
	});
var _user$project$Utils$lines = _elm_lang$core$String$join('\n');
var _user$project$Utils$commas = _elm_lang$core$String$join(', ');
var _user$project$Utils$spaces = _elm_lang$core$String$join(' ');
var _user$project$Utils$delimit = F3(
	function (a, b, s) {
		return _elm_lang$core$String$concat(
			{
				ctor: '::',
				_0: a,
				_1: {
					ctor: '::',
					_0: s,
					_1: {
						ctor: '::',
						_0: b,
						_1: {ctor: '[]'}
					}
				}
			});
	});
var _user$project$Utils$parens = A2(_user$project$Utils$delimit, '(', ')');
var _user$project$Utils$bracks = A2(_user$project$Utils$delimit, '[', ']');
var _user$project$Utils$ibracks = A2(_user$project$Utils$delimit, '[|', '|]');
var _user$project$Utils$braces = A2(_user$project$Utils$delimit, '{', '}');
var _user$project$Utils$angleBracks = A2(_user$project$Utils$delimit, '<', '>');
var _user$project$Utils$count = F2(
	function (pred, list) {
		return _elm_lang$core$List$length(
			A2(_elm_lang$core$List$filter, pred, list));
	});
var _user$project$Utils$maybeConsensus = function (bools) {
	return A2(
		_elm_lang$core$List$all,
		F2(
			function (x, y) {
				return _elm_lang$core$Native_Utils.eq(x, y);
			})(true),
		bools) ? _elm_lang$core$Maybe$Just(true) : (A2(
		_elm_lang$core$List$all,
		F2(
			function (x, y) {
				return _elm_lang$core$Native_Utils.eq(x, y);
			})(false),
		bools) ? _elm_lang$core$Maybe$Just(false) : _elm_lang$core$Maybe$Nothing);
};
var _user$project$Utils$allSame = function (list) {
	var _p105 = list;
	if (_p105.ctor === '[]') {
		return false;
	} else {
		return A2(
			_elm_lang$core$List$all,
			F2(
				function (x, y) {
					return _elm_lang$core$Native_Utils.eq(x, y);
				})(_p105._0),
			_p105._1);
	}
};
var _user$project$Utils$changeTail = F2(
	function (f, list) {
		var _p106 = list;
		if (_p106.ctor === '[]') {
			return {ctor: '[]'};
		} else {
			return {
				ctor: '::',
				_0: _p106._0,
				_1: f(_p106._1)
			};
		}
	});
var _user$project$Utils$getReplacei0 = F3(
	function (i, f, list) {
		var _p107 = {
			ctor: '_Tuple2',
			_0: A2(_elm_lang$core$List$take, i, list),
			_1: A2(_elm_lang$core$List$drop, i, list)
		};
		if ((_p107.ctor === '_Tuple2') && (_p107._1.ctor === '::')) {
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p107._0,
				A2(
					_elm_lang$core$Basics_ops['++'],
					{
						ctor: '::',
						_0: f(_p107._1._0),
						_1: {ctor: '[]'}
					},
					_p107._1._1));
		} else {
			return list;
		}
	});
var _user$project$Utils$getReplacei1 = F3(
	function (i, f, list) {
		return A3(_user$project$Utils$getReplacei0, i - 1, f, list);
	});
var _user$project$Utils$mapHead = F2(
	function (f, list) {
		return A3(_user$project$Utils$getReplacei0, 0, f, list);
	});
var _user$project$Utils$mapLast = F2(
	function (f, list) {
		return A3(
			_user$project$Utils$getReplacei0,
			_elm_lang$core$List$length(list) - 1,
			f,
			list);
	});
var _user$project$Utils$maybeGeti1 = F2(
	function (i, list) {
		return _elm_lang$core$List$head(
			A2(_elm_lang$core$List$drop, i - 1, list));
	});
var _user$project$Utils$maybeGeti0 = F2(
	function (i, list) {
		return _elm_lang$core$List$head(
			A2(_elm_lang$core$List$drop, i, list));
	});
var _user$project$Utils$inserti = F3(
	function (i, xi_, xs) {
		return A2(
			_elm_lang$core$Basics_ops['++'],
			A2(_elm_lang$core$List$take, i - 1, xs),
			A2(
				_elm_lang$core$Basics_ops['++'],
				{
					ctor: '::',
					_0: xi_,
					_1: {ctor: '[]'}
				},
				A2(_elm_lang$core$List$drop, i - 1, xs)));
	});
var _user$project$Utils$removei = F2(
	function (i, xs) {
		return A2(
			_elm_lang$core$Basics_ops['++'],
			A2(_elm_lang$core$List$take, i - 1, xs),
			A2(_elm_lang$core$List$drop, i, xs));
	});
var _user$project$Utils$replacei = F3(
	function (i, xi_, xs) {
		return A2(
			_elm_lang$core$Basics_ops['++'],
			A2(_elm_lang$core$List$take, i - 1, xs),
			A2(
				_elm_lang$core$Basics_ops['++'],
				{
					ctor: '::',
					_0: xi_,
					_1: {ctor: '[]'}
				},
				A2(_elm_lang$core$List$drop, i, xs)));
	});
var _user$project$Utils$geti = function (i) {
	return function (_p108) {
		return A2(
			_user$project$Utils$fromJust_,
			'Utils.geti',
			_elm_lang$core$List$head(
				A2(_elm_lang$core$List$drop, i - 1, _p108)));
	};
};
var _user$project$Utils$findi_ = F3(
	function (i, p, xs) {
		findi_:
		while (true) {
			var _p109 = xs;
			if (_p109.ctor === '[]') {
				return _elm_lang$core$Maybe$Nothing;
			} else {
				if (p(_p109._0)) {
					return _elm_lang$core$Maybe$Just(i);
				} else {
					var _v67 = i + 1,
						_v68 = p,
						_v69 = _p109._1;
					i = _v67;
					p = _v68;
					xs = _v69;
					continue findi_;
				}
			}
		}
	});
var _user$project$Utils$findi = F2(
	function (p, xs) {
		return A3(_user$project$Utils$findi_, 1, p, xs);
	});
var _user$project$Utils$adjacentPairs = F2(
	function (includeLast, list) {
		var _p110 = list;
		if (_p110.ctor === '[]') {
			return {ctor: '[]'};
		} else {
			var _p114 = _p110._0;
			var f = F2(
				function (xi, _p111) {
					var _p112 = _p111;
					return {
						ctor: '_Tuple2',
						_0: xi,
						_1: {
							ctor: '::',
							_0: {ctor: '_Tuple2', _0: _p112._0, _1: xi},
							_1: _p112._1
						}
					};
				});
			var _p113 = A3(
				_elm_lang$core$List$foldl,
				f,
				{
					ctor: '_Tuple2',
					_0: _p114,
					_1: {ctor: '[]'}
				},
				_p110._1);
			var xn = _p113._0;
			var pairs = _p113._1;
			return includeLast ? _elm_lang$core$List$reverse(
				{
					ctor: '::',
					_0: {ctor: '_Tuple2', _0: xn, _1: _p114},
					_1: pairs
				}) : _elm_lang$core$List$reverse(pairs);
		}
	});
var _user$project$Utils$firstOrLazySecond = F2(
	function (maybe1, lazyMaybe2) {
		var _p115 = maybe1;
		if (_p115.ctor === 'Just') {
			return maybe1;
		} else {
			return lazyMaybe2(
				{ctor: '_Tuple0'});
		}
	});
var _user$project$Utils$mapFirstSuccess = F2(
	function (f, list) {
		mapFirstSuccess:
		while (true) {
			var _p116 = list;
			if (_p116.ctor === '[]') {
				return _elm_lang$core$Maybe$Nothing;
			} else {
				var _p117 = f(_p116._0);
				if (_p117.ctor === 'Just') {
					return _elm_lang$core$Maybe$Just(_p117._0);
				} else {
					var _v75 = f,
						_v76 = _p116._1;
					f = _v75;
					list = _v76;
					continue mapFirstSuccess;
				}
			}
		}
	});
var _user$project$Utils$removeLastElement = function (list) {
	return A2(
		_elm_lang$core$List$take,
		_elm_lang$core$List$length(list) - 1,
		list);
};
var _user$project$Utils$maybeMapLast = F2(
	function (f, list) {
		return A2(
			_elm_lang$core$Maybe$map,
			function (last) {
				return A2(
					_elm_lang$core$Basics_ops['++'],
					_user$project$Utils$removeLastElement(list),
					{
						ctor: '::',
						_0: f(last),
						_1: {ctor: '[]'}
					});
			},
			_user$project$Utils$maybeLast(list));
	});
var _user$project$Utils$maybeRemoveFirst = F2(
	function (x, ys) {
		var _p118 = ys;
		if (_p118.ctor === '[]') {
			return _elm_lang$core$Maybe$Nothing;
		} else {
			var _p122 = _p118._1;
			var _p121 = _p118._0._1;
			var _p120 = _p118._0._0;
			if (_elm_lang$core$Native_Utils.eq(x, _p120)) {
				return _elm_lang$core$Maybe$Just(
					{ctor: '_Tuple2', _0: _p121, _1: _p122});
			} else {
				var _p119 = A2(_user$project$Utils$maybeRemoveFirst, x, _p122);
				if (_p119.ctor === 'Nothing') {
					return _elm_lang$core$Maybe$Nothing;
				} else {
					return _elm_lang$core$Maybe$Just(
						{
							ctor: '_Tuple2',
							_0: _p119._0._0,
							_1: {
								ctor: '::',
								_0: {ctor: '_Tuple2', _0: _p120, _1: _p121},
								_1: _p119._0._1
							}
						});
				}
			}
		}
	});
var _user$project$Utils$removeFirst = F2(
	function (x, ys) {
		var _p123 = ys;
		if (_p123.ctor === '[]') {
			return {ctor: '[]'};
		} else {
			var _p125 = _p123._1;
			var _p124 = _p123._0;
			return _elm_lang$core$Native_Utils.eq(x, _p124) ? _p125 : {
				ctor: '::',
				_0: _p124,
				_1: A2(_user$project$Utils$removeFirst, x, _p125)
			};
		}
	});
var _user$project$Utils$maybeFindAndRemoveFirst = F2(
	function (p, xs) {
		var _p126 = xs;
		if (_p126.ctor === '[]') {
			return _elm_lang$core$Maybe$Nothing;
		} else {
			var _p130 = _p126._1;
			var _p129 = _p126._0;
			return p(_p129) ? _elm_lang$core$Maybe$Just(
				{ctor: '_Tuple2', _0: _p129, _1: _p130}) : A2(
				_elm_lang$core$Maybe$map,
				function (_p127) {
					var _p128 = _p127;
					return {
						ctor: '_Tuple2',
						_0: _p128._0,
						_1: {ctor: '::', _0: _p129, _1: _p128._1}
					};
				},
				A2(_user$project$Utils$maybeFindAndRemoveFirst, p, _p130));
		}
	});
var _user$project$Utils$findSublistIndex_ = F3(
	function (i, targetList, list) {
		findSublistIndex_:
		while (true) {
			if (_elm_lang$core$Native_Utils.eq(
				A2(
					_elm_lang$core$List$take,
					_elm_lang$core$List$length(targetList),
					list),
				targetList)) {
				return _elm_lang$core$Maybe$Just(i);
			} else {
				var _p131 = list;
				if (_p131.ctor === '[]') {
					return _elm_lang$core$Maybe$Nothing;
				} else {
					var _v83 = i + 1,
						_v84 = targetList,
						_v85 = _p131._1;
					i = _v83;
					targetList = _v84;
					list = _v85;
					continue findSublistIndex_;
				}
			}
		}
	});
var _user$project$Utils$findSublistIndex = F2(
	function (targetList, list) {
		return A3(_user$project$Utils$findSublistIndex_, 0, targetList, list);
	});
var _user$project$Utils$findFirst = F2(
	function (p, xs) {
		findFirst:
		while (true) {
			var _p132 = xs;
			if (_p132.ctor === '[]') {
				return _elm_lang$core$Maybe$Nothing;
			} else {
				var _p133 = _p132._0;
				if (p(_p133)) {
					return _elm_lang$core$Maybe$Just(_p133);
				} else {
					var _v87 = p,
						_v88 = _p132._1;
					p = _v87;
					xs = _v88;
					continue findFirst;
				}
			}
		}
	});
var _user$project$Utils$findLast = F2(
	function (p, xs) {
		return A2(
			_user$project$Utils$findFirst,
			p,
			_elm_lang$core$List$reverse(xs));
	});
var _user$project$Utils$hasMatchingElement = function (p) {
	return function (_p134) {
		return _user$project$Utils$maybeToBool(
			A2(_user$project$Utils$findFirst, p, _p134));
	};
};
var _user$project$Utils$unionAll = function (sets) {
	return A3(_elm_lang$core$List$foldl, _elm_lang$core$Set$union, _elm_lang$core$Set$empty, sets);
};
var _user$project$Utils$anyOverlap = function (sets) {
	return _elm_lang$core$Native_Utils.cmp(
		_elm_lang$core$Set$size(
			_user$project$Utils$unionAll(sets)),
		_elm_lang$core$List$sum(
			A2(_elm_lang$core$List$map, _elm_lang$core$Set$size, sets))) < 0;
};
var _user$project$Utils$intersectMany = function (list) {
	var _p135 = list;
	if (_p135.ctor === '::') {
		return A3(_elm_lang$core$List$foldl, _elm_lang$core$Set$intersect, _p135._0, _p135._1);
	} else {
		return _elm_lang$core$Native_Utils.crashCase(
			'Utils',
			{
				start: {line: 349, column: 22},
				end: {line: 351, column: 43}
			},
			_p135)('intersectMany');
	}
};
var _user$project$Utils$isSubset = F2(
	function (sub, sup) {
		return A2(
			_elm_lang$core$List$all,
			function (elem) {
				return A2(_elm_lang$core$Set$member, elem, sup);
			},
			_elm_lang$core$Set$toList(sub));
	});
var _user$project$Utils$oneOfEach = function (xss) {
	var _p137 = xss;
	if (_p137.ctor === '[]') {
		return {
			ctor: '::',
			_0: {ctor: '[]'},
			_1: {ctor: '[]'}
		};
	} else {
		return A2(
			_elm_lang$core$List$concatMap,
			function (x) {
				return A2(
					_elm_lang$core$List$map,
					F2(
						function (x, y) {
							return {ctor: '::', _0: x, _1: y};
						})(x),
					_user$project$Utils$oneOfEach(_p137._1));
			},
			_p137._0);
	}
};
var _user$project$Utils$cartProd = F2(
	function (xs, ys) {
		return A2(
			_elm_lang$core$List$concatMap,
			function (x) {
				return A2(
					_elm_lang$core$List$map,
					F2(
						function (v0, v1) {
							return {ctor: '_Tuple2', _0: v0, _1: v1};
						})(x),
					ys);
			},
			xs);
	});
var _user$project$Utils$slice = F3(
	function (start, end, list) {
		return A2(
			_elm_lang$core$List$take,
			end - start,
			A2(_elm_lang$core$List$drop, start, list));
	});
var _user$project$Utils$dropLast = F2(
	function (n, list) {
		return _elm_lang$core$List$reverse(
			A2(
				_elm_lang$core$List$drop,
				n,
				_elm_lang$core$List$reverse(list)));
	});
var _user$project$Utils$toSentence = function (strings) {
	var _p138 = {
		ctor: '_Tuple2',
		_0: A2(_user$project$Utils$dropLast, 1, strings),
		_1: _user$project$Utils$maybeLast(strings)
	};
	if (_p138._1.ctor === 'Nothing') {
		return '';
	} else {
		if (_p138._0.ctor === '[]') {
			return _p138._1._0;
		} else {
			if (_p138._0._1.ctor === '[]') {
				return A2(
					_elm_lang$core$Basics_ops['++'],
					_p138._0._0,
					A2(_elm_lang$core$Basics_ops['++'], ' and ', _p138._1._0));
			} else {
				return A2(
					_elm_lang$core$Basics_ops['++'],
					A2(_elm_lang$core$String$join, ', ', _p138._0),
					A2(_elm_lang$core$Basics_ops['++'], ', and ', _p138._1._0));
			}
		}
	}
};
var _user$project$Utils$mergeStrings = function (strings) {
	var stringsWords = A2(
		_elm_lang$core$List$map,
		function (_p139) {
			return A2(
				_elm_lang$core$String$split,
				' ',
				_user$project$Utils$squish(_p139));
		},
		strings);
	var prefixWords = _user$project$Utils$commonPrefix(stringsWords);
	var noPrefixes = _user$project$Utils$removeCommonPrefix(stringsWords);
	var suffixWords = _user$project$Utils$commonSuffix(noPrefixes);
	var middleString = _user$project$Utils$toSentence(
		A2(
			_elm_lang$core$List$filter,
			function (_p140) {
				return !_elm_lang$core$String$isEmpty(_p140);
			},
			A2(
				_elm_lang$core$List$map,
				_elm_lang$core$String$join(' '),
				_user$project$Utils$removeCommonSuffix(noPrefixes))));
	return A2(
		_elm_lang$core$String$join,
		' ',
		A2(
			_elm_lang$core$List$filter,
			function (_p141) {
				return !_elm_lang$core$String$isEmpty(_p141);
			},
			A2(
				_elm_lang$core$Basics_ops['++'],
				prefixWords,
				A2(
					_elm_lang$core$Basics_ops['++'],
					{
						ctor: '::',
						_0: middleString,
						_1: {ctor: '[]'}
					},
					suffixWords))));
};
var _user$project$Utils$splitBy = F2(
	function (splitElems, list) {
		var _p142 = A2(_user$project$Utils$findSublistIndex, splitElems, list);
		if (_p142.ctor === 'Just') {
			var _p143 = _p142._0;
			return {
				ctor: '::',
				_0: A2(_elm_lang$core$List$take, _p143, list),
				_1: A2(
					_user$project$Utils$splitBy,
					splitElems,
					A2(
						_elm_lang$core$List$drop,
						_p143 + _elm_lang$core$List$length(splitElems),
						list))
			};
		} else {
			return {
				ctor: '::',
				_0: list,
				_1: {ctor: '[]'}
			};
		}
	});
var _user$project$Utils$split = F2(
	function (n, xs) {
		return {
			ctor: '_Tuple2',
			_0: A2(_elm_lang$core$List$take, n, xs),
			_1: A2(_elm_lang$core$List$drop, n, xs)
		};
	});
var _user$project$Utils$snoc = F2(
	function (xs, x) {
		return A2(
			_elm_lang$core$Basics_ops['++'],
			xs,
			{
				ctor: '::',
				_0: x,
				_1: {ctor: '[]'}
			});
	});
var _user$project$Utils$snocMaybe = F2(
	function (xs, mx) {
		return A2(
			_elm_lang$core$Maybe$withDefault,
			xs,
			A2(
				_user$project$Utils$mapMaybe,
				_user$project$Utils$snoc(xs),
				mx));
	});
var _user$project$Utils$maybeUnpackSingleton = function (xs) {
	var _p144 = xs;
	if ((_p144.ctor === '::') && (_p144._1.ctor === '[]')) {
		return _elm_lang$core$Maybe$Just(_p144._0);
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$Utils$oneElement = function (xs) {
	var _p145 = xs;
	if ((_p145.ctor === '::') && (_p145._1.ctor === '[]')) {
		return true;
	} else {
		return false;
	}
};
var _user$project$Utils$zeroElements = function (xs) {
	var _p146 = xs;
	if (_p146.ctor === '[]') {
		return true;
	} else {
		return false;
	}
};
var _user$project$Utils$clamp = F3(
	function (i, j, n) {
		return (_elm_lang$core$Native_Utils.cmp(n, i) < 0) ? i : ((_elm_lang$core$Native_Utils.cmp(j, n) < 0) ? j : n);
	});
var _user$project$Utils$oneToOneMappingExists = F2(
	function (l1, l2) {
		var numericRepresentation = function (list) {
			return _elm_lang$core$Tuple$second(
				A3(
					_elm_lang$core$List$foldl,
					F2(
						function (x, _p147) {
							var _p148 = _p147;
							var _p151 = _p148._1;
							var _p150 = _p148._0;
							var _p149 = A2(_elm_lang$core$Dict$get, x, _p150);
							if (_p149.ctor === 'Just') {
								return {
									ctor: '_Tuple2',
									_0: _p150,
									_1: A2(
										_elm_lang$core$Basics_ops['++'],
										_p151,
										{
											ctor: '::',
											_0: _p149._0,
											_1: {ctor: '[]'}
										})
								};
							} else {
								var n = _elm_lang$core$Dict$size(_p150);
								var dict_ = A3(_elm_lang$core$Dict$insert, x, n, _p150);
								return {
									ctor: '_Tuple2',
									_0: dict_,
									_1: A2(
										_elm_lang$core$Basics_ops['++'],
										_p151,
										{
											ctor: '::',
											_0: n,
											_1: {ctor: '[]'}
										})
								};
							}
						}),
					{
						ctor: '_Tuple2',
						_0: _elm_lang$core$Dict$empty,
						_1: {ctor: '[]'}
					},
					list));
		};
		return _elm_lang$core$Native_Utils.eq(
			numericRepresentation(l1),
			numericRepresentation(l2));
	});
var _user$project$Utils$groupBy = F2(
	function (f, xs) {
		return A3(
			_elm_lang$core$List$foldl,
			F2(
				function (x, dict) {
					var key = f(x);
					var equivalents = A3(
						_user$project$Utils$getWithDefault,
						key,
						{ctor: '[]'},
						dict);
					return A3(
						_elm_lang$core$Dict$insert,
						key,
						A2(
							_elm_lang$core$Basics_ops['++'],
							equivalents,
							{
								ctor: '::',
								_0: x,
								_1: {ctor: '[]'}
							}),
						dict);
				}),
			_elm_lang$core$Dict$empty,
			xs);
	});
var _user$project$Utils$isSublistAsSet = F2(
	function (sub, $super) {
		return A2(
			_elm_lang$core$List$all,
			function (x) {
				return A2(_elm_lang$core$List$member, x, $super);
			},
			sub);
	});
var _user$project$Utils$equalAsSets = F2(
	function (a, b) {
		return A2(_user$project$Utils$isSublistAsSet, a, b) && A2(_user$project$Utils$isSublistAsSet, b, a);
	});
var _user$project$Utils$removeAsSet = F2(
	function (x, xs) {
		return A2(
			_elm_lang$core$List$filter,
			F2(
				function (x, y) {
					return !_elm_lang$core$Native_Utils.eq(x, y);
				})(x),
			xs);
	});
var _user$project$Utils$diffAsSet = F2(
	function (xs, ys) {
		return A3(_elm_lang$core$List$foldl, _user$project$Utils$removeAsSet, xs, ys);
	});
var _user$project$Utils$removeAll = _user$project$Utils$diffAsSet;
var _user$project$Utils$addAsSet = F2(
	function (x, xs) {
		return A2(_elm_lang$core$List$member, x, xs) ? xs : {ctor: '::', _0: x, _1: xs};
	});
var _user$project$Utils$listDiffSet = F2(
	function (list, setToRemove) {
		return A2(
			_elm_lang$core$List$filter,
			function (element) {
				return !A2(_elm_lang$core$Set$member, element, setToRemove);
			},
			list);
	});
var _user$project$Utils$listDiff = F2(
	function (l1, l2) {
		return A2(
			_user$project$Utils$listDiffSet,
			l1,
			_elm_lang$core$Set$fromList(l2));
	});
var _user$project$Utils$dedupByEquality = function (xs) {
	return A3(
		_elm_lang$core$List$foldr,
		_user$project$Utils$addAsSet,
		{ctor: '[]'},
		xs);
};
var _user$project$Utils$dedupBy = F2(
	function (f, xs) {
		var _p152 = A3(
			_elm_lang$core$List$foldl,
			F2(
				function (x, _p153) {
					var _p154 = _p153;
					var _p156 = _p154._1;
					var _p155 = _p154._0;
					var key = f(x);
					return A2(_elm_lang$core$Set$member, key, _p156) ? {ctor: '_Tuple2', _0: _p155, _1: _p156} : {
						ctor: '_Tuple2',
						_0: A2(
							_elm_lang$core$Basics_ops['++'],
							_p155,
							{
								ctor: '::',
								_0: x,
								_1: {ctor: '[]'}
							}),
						_1: A2(_elm_lang$core$Set$insert, key, _p156)
					};
				}),
			{
				ctor: '_Tuple2',
				_0: {ctor: '[]'},
				_1: _elm_lang$core$Set$empty
			},
			xs);
		var deduped = _p152._0;
		return deduped;
	});
var _user$project$Utils$dedup = function (xs) {
	return A2(_user$project$Utils$dedupBy, _elm_lang$core$Basics$identity, xs);
};
var _user$project$Utils$listsEqualBy = F3(
	function (elementEqualityFunc, xs, ys) {
		var _p157 = {ctor: '_Tuple2', _0: xs, _1: ys};
		_v99_2:
		do {
			if (_p157.ctor === '_Tuple2') {
				if (_p157._0.ctor === '[]') {
					if (_p157._1.ctor === '[]') {
						return true;
					} else {
						break _v99_2;
					}
				} else {
					if (_p157._1.ctor === '::') {
						return A2(elementEqualityFunc, _p157._0._0, _p157._1._0) && A3(_user$project$Utils$listsEqualBy, elementEqualityFunc, _p157._0._1, _p157._1._1);
					} else {
						break _v99_2;
					}
				}
			} else {
				break _v99_2;
			}
		} while(false);
		return false;
	});
var _user$project$Utils$filterMapTogetherPreservingLeftovers = F3(
	function (f, l1, l2) {
		filterMapTogetherPreservingLeftovers:
		while (true) {
			var _p158 = {ctor: '_Tuple2', _0: l1, _1: l2};
			if (((_p158.ctor === '_Tuple2') && (_p158._0.ctor === '::')) && (_p158._1.ctor === '::')) {
				var _p162 = _p158._1._1;
				var _p161 = _p158._0._1;
				var _p159 = A2(f, _p158._0._0, _p158._1._0);
				if (_p159.ctor === 'Just') {
					var _p160 = A3(_user$project$Utils$filterMapTogetherPreservingLeftovers, f, _p161, _p162);
					var newXRest = _p160._0;
					var newYRest = _p160._1;
					return {
						ctor: '_Tuple2',
						_0: {ctor: '::', _0: _p159._0._0, _1: newXRest},
						_1: {ctor: '::', _0: _p159._0._1, _1: newYRest}
					};
				} else {
					var _v102 = f,
						_v103 = _p161,
						_v104 = _p162;
					f = _v102;
					l1 = _v103;
					l2 = _v104;
					continue filterMapTogetherPreservingLeftovers;
				}
			} else {
				return {ctor: '_Tuple2', _0: l1, _1: l2};
			}
		}
	});
var _user$project$Utils$reverse2 = function (_p163) {
	var _p164 = _p163;
	return {
		ctor: '_Tuple2',
		_0: _elm_lang$core$List$reverse(_p164._0),
		_1: _elm_lang$core$List$reverse(_p164._1)
	};
};
var _user$project$Utils$zipi_ = F2(
	function (i, list) {
		var _p165 = list;
		if (_p165.ctor === '[]') {
			return {ctor: '[]'};
		} else {
			return {
				ctor: '::',
				_0: {ctor: '_Tuple2', _0: i, _1: _p165._0},
				_1: A2(_user$project$Utils$zipi_, i + 1, _p165._1)
			};
		}
	});
var _user$project$Utils$mapi_ = F3(
	function (initI, f, xs) {
		return A2(
			_elm_lang$core$List$map,
			f,
			A2(_user$project$Utils$zipi_, initI, xs));
	});
var _user$project$Utils$mapi0 = _user$project$Utils$mapi_(0);
var _user$project$Utils$mapi1 = _user$project$Utils$mapi_(1);
var _user$project$Utils$naturalToCamelCase = function (natural) {
	return A2(
		_elm_lang$core$String$join,
		'',
		A2(
			_user$project$Utils$mapi1,
			function (_p166) {
				var _p167 = _p166;
				var _p168 = _p167._1;
				return _elm_lang$core$Native_Utils.eq(_p167._0, 1) ? _p168 : _user$project$Utils$capitalize(_p168);
			},
			A2(
				_elm_lang$core$List$map,
				_elm_lang$core$String$toLower,
				A2(_elm_lang$core$String$split, ' ', natural))));
};
var _user$project$Utils$foldli_ = F4(
	function (initI, f, init, xs) {
		return A3(
			_elm_lang$core$List$foldl,
			f,
			init,
			A2(_user$project$Utils$zipi_, initI, xs));
	});
var _user$project$Utils$foldli0 = _user$project$Utils$foldli_(0);
var _user$project$Utils$foldli1 = _user$project$Utils$foldli_(1);
var _user$project$Utils$manySetDiffs = function (sets) {
	return A2(
		_user$project$Utils$mapi1,
		function (_p169) {
			var _p170 = _p169;
			return A3(
				_user$project$Utils$foldli1,
				F2(
					function (_p171, acc) {
						var _p172 = _p171;
						return _elm_lang$core$Native_Utils.eq(_p170._0, _p172._0) ? acc : A2(_elm_lang$core$Set$diff, acc, _p172._1);
					}),
				_p170._1,
				sets);
		},
		sets);
};
var _user$project$Utils$cartProdWithDiff = function (_p173) {
	return _user$project$Utils$oneOfEach(
		A2(
			_elm_lang$core$List$map,
			_elm_lang$core$Set$toList,
			_user$project$Utils$manySetDiffs(_p173)));
};
var _user$project$Utils$zipi1 = _user$project$Utils$zipi_(1);
var _user$project$Utils$filteri1 = F2(
	function (f, xs) {
		return A2(
			_elm_lang$core$List$map,
			_elm_lang$core$Tuple$second,
			A2(
				_elm_lang$core$List$filter,
				f,
				_user$project$Utils$zipi1(xs)));
	});
var _user$project$Utils$concatMapi1 = F2(
	function (f, xs) {
		return A2(
			_elm_lang$core$List$concatMap,
			f,
			_user$project$Utils$zipi1(xs));
	});
var _user$project$Utils$zipi0 = _user$project$Utils$zipi_(0);
var _user$project$Utils$maybeZipN = function (lists) {
	if (A2(_elm_lang$core$List$all, _user$project$Utils$zeroElements, lists)) {
		return _elm_lang$core$Maybe$Just(
			{ctor: '[]'});
	} else {
		if (A2(_elm_lang$core$List$all, _user$project$Utils$oneElement, lists)) {
			return _elm_lang$core$Maybe$Just(
				{
					ctor: '::',
					_0: _elm_lang$core$List$concat(lists),
					_1: {ctor: '[]'}
				});
		} else {
			var maybeHeads = _user$project$Utils$projJusts(
				A2(_elm_lang$core$List$map, _elm_lang$core$List$head, lists));
			var maybeTails = _user$project$Utils$projJusts(
				A2(_elm_lang$core$List$map, _elm_lang$core$List$tail, lists));
			var _p174 = {ctor: '_Tuple2', _0: maybeHeads, _1: maybeTails};
			if (((_p174.ctor === '_Tuple2') && (_p174._0.ctor === 'Just')) && (_p174._1.ctor === 'Just')) {
				return A2(
					_elm_lang$core$Maybe$map,
					F2(
						function (x, y) {
							return {ctor: '::', _0: x, _1: y};
						})(_p174._0._0),
					_user$project$Utils$maybeZipN(_p174._1._0));
			} else {
				return _elm_lang$core$Maybe$Nothing;
			}
		}
	}
};
var _user$project$Utils$unzip3 = function (zipped) {
	return A3(
		_elm_lang$core$List$foldr,
		F2(
			function (_p176, _p175) {
				var _p177 = _p176;
				var _p178 = _p175;
				return {
					ctor: '_Tuple3',
					_0: {ctor: '::', _0: _p177._0, _1: _p178._0},
					_1: {ctor: '::', _0: _p177._1, _1: _p178._1},
					_2: {ctor: '::', _0: _p177._2, _1: _p178._2}
				};
			}),
		{
			ctor: '_Tuple3',
			_0: {ctor: '[]'},
			_1: {ctor: '[]'},
			_2: {ctor: '[]'}
		},
		zipped);
};
var _user$project$Utils$zip3 = F3(
	function (xs, ys, zs) {
		var _p179 = {ctor: '_Tuple3', _0: xs, _1: ys, _2: zs};
		if ((((_p179.ctor === '_Tuple3') && (_p179._0.ctor === '::')) && (_p179._1.ctor === '::')) && (_p179._2.ctor === '::')) {
			return {
				ctor: '::',
				_0: {ctor: '_Tuple3', _0: _p179._0._0, _1: _p179._1._0, _2: _p179._2._0},
				_1: A3(_user$project$Utils$zip3, _p179._0._1, _p179._1._1, _p179._2._1)
			};
		} else {
			return {ctor: '[]'};
		}
	});
var _user$project$Utils$maybeZipDicts = F2(
	function (d1, d2) {
		return (!_elm_lang$core$Native_Utils.eq(
			_elm_lang$core$Dict$keys(d1),
			_elm_lang$core$Dict$keys(d2))) ? _elm_lang$core$Maybe$Nothing : _elm_lang$core$Maybe$Just(
			A2(
				_elm_lang$core$Dict$map,
				F2(
					function (k, v1) {
						return {
							ctor: '_Tuple2',
							_0: v1,
							_1: A2(_user$project$Utils$justGet, k, d2)
						};
					}),
				d1));
	});
var _user$project$Utils$maybeZip = F2(
	function (xs, ys) {
		var _p180 = {ctor: '_Tuple2', _0: xs, _1: ys};
		_v114_2:
		do {
			if (_p180.ctor === '_Tuple2') {
				if (_p180._0.ctor === '::') {
					if (_p180._1.ctor === '::') {
						var _p181 = A2(_user$project$Utils$maybeZip, _p180._0._1, _p180._1._1);
						if (_p181.ctor === 'Nothing') {
							return _elm_lang$core$Maybe$Nothing;
						} else {
							return _elm_lang$core$Maybe$Just(
								{
									ctor: '::',
									_0: {ctor: '_Tuple2', _0: _p180._0._0, _1: _p180._1._0},
									_1: _p181._0
								});
						}
					} else {
						break _v114_2;
					}
				} else {
					if (_p180._1.ctor === '[]') {
						return _elm_lang$core$Maybe$Just(
							{ctor: '[]'});
					} else {
						break _v114_2;
					}
				}
			} else {
				break _v114_2;
			}
		} while(false);
		return _elm_lang$core$Maybe$Nothing;
	});
var _user$project$Utils$zipWith = F3(
	function (f, xs, ys) {
		var _p182 = {ctor: '_Tuple2', _0: xs, _1: ys};
		if (((_p182.ctor === '_Tuple2') && (_p182._0.ctor === '::')) && (_p182._1.ctor === '::')) {
			return {
				ctor: '::',
				_0: A2(f, _p182._0._0, _p182._1._0),
				_1: A3(_user$project$Utils$zipWith, f, _p182._0._1, _p182._1._1)
			};
		} else {
			return {ctor: '[]'};
		}
	});
var _user$project$Utils$zip = _user$project$Utils$zipWith(
	F2(
		function (v0, v1) {
			return {ctor: '_Tuple2', _0: v0, _1: v1};
		}));
var _user$project$Utils$selfZipCircConsecPairs = function (list) {
	var shiftList = function () {
		var _p183 = list;
		if (_p183.ctor === '::') {
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p183._1,
				{
					ctor: '::',
					_0: _p183._0,
					_1: {ctor: '[]'}
				});
		} else {
			return {ctor: '[]'};
		}
	}();
	return A2(_user$project$Utils$zip, list, shiftList);
};
var _user$project$Utils$update = F2(
	function (_p184, vals) {
		var _p185 = _p184;
		var _p190 = _p185._1;
		var _p189 = _p185._0;
		var _p186 = vals;
		if (_p186.ctor === '[]') {
			return {ctor: '[]'};
		} else {
			var _p188 = _p186._1;
			var _p187 = _p186._0._0;
			return _elm_lang$core$Native_Utils.eq(_p187, _p189) ? {
				ctor: '::',
				_0: {ctor: '_Tuple2', _0: _p187, _1: _p190},
				_1: _p188
			} : {
				ctor: '::',
				_0: {ctor: '_Tuple2', _0: _p187, _1: _p186._0._1},
				_1: A2(
					_user$project$Utils$update,
					{ctor: '_Tuple2', _0: _p189, _1: _p190},
					_p188)
			};
		}
	});
var _user$project$Utils$maybeFind = F2(
	function (k, l) {
		maybeFind:
		while (true) {
			var _p191 = l;
			if (_p191.ctor === '[]') {
				return _elm_lang$core$Maybe$Nothing;
			} else {
				if (_elm_lang$core$Native_Utils.eq(k, _p191._0._0)) {
					return _elm_lang$core$Maybe$Just(_p191._0._1);
				} else {
					var _v121 = k,
						_v122 = _p191._1;
					k = _v121;
					l = _v122;
					continue maybeFind;
				}
			}
		}
	});
var _user$project$Utils$find = F3(
	function (err, d, k) {
		var _p192 = A2(_user$project$Utils$maybeFind, k, d);
		if (_p192.ctor === 'Just') {
			return _p192._0;
		} else {
			return _elm_lang$core$Native_Utils.crashCase(
				'Utils',
				{
					start: {line: 19, column: 3},
					end: {line: 21, column: 52}
				},
				_p192)(
				A2(_elm_lang$core$Basics_ops['++'], 'Utils.find: ', err));
		}
	});
var _user$project$Utils$find_ = F2(
	function (d, k) {
		return A3(
			_user$project$Utils$find,
			A2(
				_elm_lang$core$Basics_ops['++'],
				'[',
				A2(
					_elm_lang$core$Basics_ops['++'],
					_elm_lang$core$Basics$toString(k),
					']')),
			d,
			k);
	});
var _user$project$Utils$infinity = 1 / 0;

var _user$project$Lang$firstNestedExp = function (e) {
	firstNestedExp:
	while (true) {
		var _p0 = e.val.e__;
		_v0_5:
		do {
			switch (_p0.ctor) {
				case 'ELet':
					if (_p0._1.ctor === 'Def') {
						var _v1 = _p0._5;
						e = _v1;
						continue firstNestedExp;
					} else {
						break _v0_5;
					}
				case 'EComment':
					var _v2 = _p0._2;
					e = _v2;
					continue firstNestedExp;
				case 'EOption':
					var _v3 = _p0._4;
					e = _v3;
					continue firstNestedExp;
				case 'ETyp':
					var _v4 = _p0._3;
					e = _v4;
					continue firstNestedExp;
				case 'ETypeAlias':
					var _v5 = _p0._3;
					e = _v5;
					continue firstNestedExp;
				default:
					break _v0_5;
			}
		} while(false);
		return e;
	}
};
var _user$project$Lang$tagPatList = function (_p1) {
	var _p2 = _p1;
	return function (_p3) {
		return _elm_lang$core$List$concat(
			A2(
				_elm_lang$core$List$indexedMap,
				F2(
					function (index, pat) {
						return A2(
							_user$project$Lang$tagSinglePat,
							{
								ctor: '_Tuple2',
								_0: _p2._0,
								_1: A2(
									_elm_lang$core$Basics_ops['++'],
									_p2._1,
									{
										ctor: '::',
										_0: index + 1,
										_1: {ctor: '[]'}
									})
							},
							pat);
					}),
				_p3));
	};
};
var _user$project$Lang$tagSinglePat = F2(
	function (ppid, pat) {
		return {
			ctor: '::',
			_0: {ctor: '_Tuple2', _0: pat.val.pid, _1: ppid},
			_1: function () {
				var _p4 = pat.val.p__;
				switch (_p4.ctor) {
					case 'PConst':
						return {ctor: '[]'};
					case 'PBase':
						return {ctor: '[]'};
					case 'PVar':
						return {ctor: '[]'};
					case 'PAs':
						return A2(_user$project$Lang$tagSinglePat, ppid, _p4._3);
					default:
						if (_p4._3.ctor === 'Nothing') {
							return A2(_user$project$Lang$tagPatList, ppid, _p4._1);
						} else {
							return A2(
								_user$project$Lang$tagPatList,
								ppid,
								A2(
									_elm_lang$core$Basics_ops['++'],
									_p4._1,
									{
										ctor: '::',
										_0: _p4._3._0,
										_1: {ctor: '[]'}
									}));
						}
				}
			}()
		};
	});
var _user$project$Lang$rootPathedPatternId = function (scopeId) {
	return {
		ctor: '_Tuple2',
		_0: scopeId,
		_1: {ctor: '[]'}
	};
};
var _user$project$Lang$tagBranchList = function (eid) {
	return function (_p5) {
		return _elm_lang$core$List$concat(
			A2(
				_elm_lang$core$List$indexedMap,
				F2(
					function (index, branch) {
						var _p6 = branch.val;
						return A2(
							_user$project$Lang$tagSinglePat,
							_user$project$Lang$rootPathedPatternId(
								{ctor: '_Tuple2', _0: eid, _1: index + 1}),
							_p6._1);
					}),
				_p5));
	};
};
var _user$project$Lang$hasPid = F2(
	function (pid, codeObject) {
		var _p7 = codeObject;
		if (_p7.ctor === 'P') {
			return _elm_lang$core$Native_Utils.eq(_p7._1.val.pid, pid);
		} else {
			return false;
		}
	});
var _user$project$Lang$isImplicitMain = function (e) {
	var _p8 = e.val.e__;
	if (_p8.ctor === 'ELet') {
		var _p9 = _p8._3.val.p__;
		if ((_p9.ctor === 'PVar') && (_p9._1 === '_IMPLICIT_MAIN')) {
			return true;
		} else {
			return false;
		}
	} else {
		return false;
	}
};
var _user$project$Lang$isHiddenCodeObject = function (codeObject) {
	var _p10 = codeObject;
	switch (_p10.ctor) {
		case 'E':
			return _user$project$Lang$isImplicitMain(_p10._0);
		case 'ET':
			return _user$project$Lang$isImplicitMain(_p10._2);
		default:
			return false;
	}
};
var _user$project$Lang$wsBefore = function (codeObject) {
	var _p11 = codeObject;
	switch (_p11.ctor) {
		case 'E':
			var _p12 = _p11._0.val.e__;
			switch (_p12.ctor) {
				case 'EConst':
					return _p12._0;
				case 'EBase':
					return _p12._0;
				case 'EVar':
					return _p12._0;
				case 'EFun':
					return _p12._0;
				case 'EApp':
					return _p12._0;
				case 'EOp':
					return _p12._0;
				case 'EList':
					return _p12._0;
				case 'EIf':
					return _p12._0;
				case 'ECase':
					return _p12._0;
				case 'ETypeCase':
					return _p12._0;
				case 'ELet':
					return _p12._0;
				case 'EComment':
					return _p12._0;
				case 'EOption':
					return _p12._0;
				case 'ETyp':
					return _p12._0;
				case 'EColonType':
					return _p12._0;
				default:
					return _p12._0;
			}
		case 'P':
			var _p13 = _p11._1.val.p__;
			switch (_p13.ctor) {
				case 'PVar':
					return _p13._0;
				case 'PConst':
					return _p13._0;
				case 'PBase':
					return _p13._0;
				case 'PList':
					return _p13._0;
				default:
					return _p13._0;
			}
		case 'T':
			var _p14 = _p11._0.val;
			switch (_p14.ctor) {
				case 'TNum':
					return _p14._0;
				case 'TBool':
					return _p14._0;
				case 'TString':
					return _p14._0;
				case 'TNull':
					return _p14._0;
				case 'TList':
					return _p14._0;
				case 'TDict':
					return _p14._0;
				case 'TTuple':
					return _p14._0;
				case 'TArrow':
					return _p14._0;
				case 'TUnion':
					return _p14._0;
				case 'TNamed':
					return _p14._0;
				case 'TVar':
					return _p14._0;
				case 'TForall':
					return _p14._0;
				default:
					return _p14._0;
			}
		case 'LBE':
			var _p15 = _p11._0;
			return {start: _p15.start, end: _p15.end, val: ''};
		case 'ET':
			return _p11._1;
		case 'PT':
			return _p11._1;
		default:
			return _p11._1;
	}
};
var _user$project$Lang$isWord = function (codeObject) {
	var _p16 = codeObject;
	switch (_p16.ctor) {
		case 'E':
			var _p17 = _p16._0.val.e__;
			switch (_p17.ctor) {
				case 'EConst':
					return true;
				case 'EBase':
					return true;
				case 'EVar':
					return true;
				default:
					return false;
			}
		case 'P':
			var _p18 = _p16._1.val.p__;
			switch (_p18.ctor) {
				case 'PVar':
					return true;
				case 'PConst':
					return true;
				case 'PBase':
					return true;
				default:
					return false;
			}
		default:
			return false;
	}
};
var _user$project$Lang$isSelectable = function (codeObject) {
	var _p19 = codeObject;
	if (_p19.ctor === 'E') {
		var _p20 = _p19._0.val.e__;
		switch (_p20.ctor) {
			case 'EComment':
				return false;
			case 'EOption':
				return false;
			default:
				return true;
		}
	} else {
		return true;
	}
};
var _user$project$Lang$isTarget = function (codeObject) {
	var _p21 = codeObject;
	switch (_p21.ctor) {
		case 'E':
			return false;
		case 'P':
			return false;
		case 'T':
			return false;
		case 'LBE':
			return false;
		case 'ET':
			return true;
		case 'PT':
			return true;
		default:
			return true;
	}
};
var _user$project$Lang$isTextSelectable = function (codeObject) {
	return _user$project$Lang$isSelectable(codeObject) && (!_user$project$Lang$isTarget(codeObject));
};
var _user$project$Lang$extractInfoFromCodeObject = function (codeObject) {
	var _p22 = codeObject;
	switch (_p22.ctor) {
		case 'E':
			return _elm_lang$core$Native_Utils.update(
				_p22._0,
				{val: codeObject});
		case 'P':
			return _elm_lang$core$Native_Utils.update(
				_p22._1,
				{val: codeObject});
		case 'T':
			return _elm_lang$core$Native_Utils.update(
				_p22._0,
				{val: codeObject});
		case 'LBE':
			return _elm_lang$core$Native_Utils.update(
				_p22._0,
				{val: codeObject});
		case 'ET':
			return _elm_lang$core$Native_Utils.update(
				_p22._1,
				{val: codeObject});
		case 'PT':
			return _elm_lang$core$Native_Utils.update(
				_p22._1,
				{val: codeObject});
		default:
			return _elm_lang$core$Native_Utils.update(
				_p22._1,
				{val: codeObject});
	}
};
var _user$project$Lang$tabsToSpaces = function (ws) {
	return A4(
		_elm_lang$core$Regex$replace,
		_elm_lang$core$Regex$All,
		_elm_lang$core$Regex$regex('\t'),
		function (_p23) {
			return '    ';
		},
		ws);
};
var _user$project$Lang$ensureWhitespace = function (s) {
	return _elm_lang$core$Native_Utils.eq(s, '') ? ' ' : s;
};
var _user$project$Lang$ensureWhitespaceNNewlines = F2(
	function (n, s) {
		var newlineCount = _elm_lang$core$List$length(
			A2(_elm_lang$core$String$split, '\n', s)) - 1;
		return _user$project$Lang$ensureWhitespace(
			A2(
				_elm_lang$core$Basics_ops['++'],
				A2(_elm_lang$core$String$repeat, n - newlineCount, '\n'),
				s));
	});
var _user$project$Lang$precedingWhitespaceExp__ = function (e__) {
	return function (_) {
		return _.val;
	}(
		function () {
			var _p24 = e__;
			switch (_p24.ctor) {
				case 'EBase':
					return _p24._0;
				case 'EConst':
					return _p24._0;
				case 'EVar':
					return _p24._0;
				case 'EFun':
					return _p24._0;
				case 'EApp':
					return _p24._0;
				case 'EList':
					return _p24._0;
				case 'EOp':
					return _p24._0;
				case 'EIf':
					return _p24._0;
				case 'ELet':
					return _p24._0;
				case 'ECase':
					return _p24._0;
				case 'ETypeCase':
					return _p24._0;
				case 'EComment':
					return _p24._0;
				case 'EOption':
					return _p24._0;
				case 'ETyp':
					return _p24._0;
				case 'EColonType':
					return _p24._0;
				default:
					return _p24._0;
			}
		}());
};
var _user$project$Lang$precedingWhitespacePat = function (pat) {
	return function (_) {
		return _.val;
	}(
		function () {
			var _p25 = pat.val.p__;
			switch (_p25.ctor) {
				case 'PVar':
					return _p25._0;
				case 'PConst':
					return _p25._0;
				case 'PBase':
					return _p25._0;
				case 'PList':
					return _p25._0;
				default:
					return _p25._0;
			}
		}());
};
var _user$project$Lang$extractIndentation = function (string) {
	return _user$project$Lang$tabsToSpaces(
		A2(
			_elm_lang$core$Maybe$withDefault,
			'',
			_user$project$Utils$maybeLast(
				A2(
					_elm_lang$core$List$drop,
					1,
					A2(_elm_lang$core$String$split, '\n', string)))));
};
var _user$project$Lang$ensureNNewlines = F3(
	function (n, indentationIfNoPreviousNewlines, ws) {
		var previousNewlineCount = _elm_lang$core$List$length(
			A2(_elm_lang$core$String$split, '\n', ws)) - 1;
		return _elm_lang$core$Native_Utils.eq(previousNewlineCount, 0) ? A2(
			_elm_lang$core$Basics_ops['++'],
			A2(_elm_lang$core$String$repeat, n, '\n'),
			indentationIfNoPreviousNewlines) : ((_elm_lang$core$Native_Utils.cmp(previousNewlineCount, n) < 0) ? A2(
			_elm_lang$core$Basics_ops['++'],
			A2(_elm_lang$core$String$repeat, n, '\n'),
			_user$project$Lang$extractIndentation(ws)) : ws);
	});
var _user$project$Lang$precedingWhitespace = function (exp) {
	return _user$project$Lang$precedingWhitespaceExp__(exp.val.e__);
};
var _user$project$Lang$indentationOf = function (exp) {
	return _user$project$Lang$extractIndentation(
		_user$project$Lang$precedingWhitespace(exp));
};
var _user$project$Lang$maxNumTr = F2(
	function (_p27, _p26) {
		var _p28 = _p27;
		var _p31 = _p28._0;
		var _p29 = _p26;
		var _p30 = _p29._0;
		return (_elm_lang$core$Native_Utils.cmp(_p31, _p30) > -1) ? {ctor: '_Tuple2', _0: _p31, _1: _p28._1} : {ctor: '_Tuple2', _0: _p30, _1: _p29._1};
	});
var _user$project$Lang$minNumTr = F2(
	function (_p33, _p32) {
		var _p34 = _p33;
		var _p37 = _p34._0;
		var _p35 = _p32;
		var _p36 = _p35._0;
		return (_elm_lang$core$Native_Utils.cmp(_p37, _p36) < 1) ? {ctor: '_Tuple2', _0: _p37, _1: _p34._1} : {ctor: '_Tuple2', _0: _p36, _1: _p35._1};
	});
var _user$project$Lang$minMaxNumTr = F2(
	function (nt1, nt2) {
		return {
			ctor: '_Tuple2',
			_0: A2(_user$project$Lang$minNumTr, nt1, nt2),
			_1: A2(_user$project$Lang$maxNumTr, nt1, nt2)
		};
	});
var _user$project$Lang$minMax = F2(
	function (x, y) {
		return {
			ctor: '_Tuple2',
			_0: A2(_elm_lang$core$Basics$min, x, y),
			_1: A2(_elm_lang$core$Basics$max, x, y)
		};
	});
var _user$project$Lang$unwrapVBaseString_ = F2(
	function (s, v_) {
		var _p38 = v_;
		if ((_p38.ctor === 'VBase') && (_p38._0.ctor === 'VString')) {
			return _p38._0._0;
		} else {
			return _elm_lang$core$Native_Utils.crashCase(
				'Lang',
				{
					start: {line: 1663, column: 27},
					end: {line: 1665, column: 66}
				},
				_p38)(
				A2(_elm_lang$core$Basics_ops['++'], 'unwrapVBaseString_: ', s));
		}
	});
var _user$project$Lang$unwrapVList_ = F2(
	function (s, v) {
		var _p40 = v.v_;
		if (_p40.ctor === 'VList') {
			return A2(
				_elm_lang$core$List$map,
				function (_) {
					return _.v_;
				},
				_p40._0);
		} else {
			return _elm_lang$core$Native_Utils.crashCase(
				'Lang',
				{
					start: {line: 1658, column: 20},
					end: {line: 1660, column: 51}
				},
				_p40)(
				A2(_elm_lang$core$Basics_ops['++'], 'unwrapVList_: ', s));
		}
	});
var _user$project$Lang$unwrapVList = function (v) {
	var _p42 = v.v_;
	if (_p42.ctor === 'VList') {
		return _elm_lang$core$Maybe$Just(
			A2(
				_elm_lang$core$List$map,
				function (_) {
					return _.v_;
				},
				_p42._0));
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$Lang$dummyLoc_ = function (b) {
	return {ctor: '_Tuple3', _0: 0, _1: b, _2: ''};
};
var _user$project$Lang$setPId = F2(
	function (pid, p) {
		var p_ = p.val;
		return _elm_lang$core$Native_Utils.update(
			p,
			{
				val: _elm_lang$core$Native_Utils.update(
					p_,
					{pid: pid})
			});
	});
var _user$project$Lang$clearPId = function (p) {
	return A2(_user$project$Lang$setPId, -1, p);
};
var _user$project$Lang$setEId = F2(
	function (eid, e) {
		var e_ = e.val;
		return _elm_lang$core$Native_Utils.update(
			e,
			{
				val: _elm_lang$core$Native_Utils.update(
					e_,
					{eid: eid})
			});
	});
var _user$project$Lang$clearEId = function (e) {
	return A2(_user$project$Lang$setEId, -1, e);
};
var _user$project$Lang$replaceP__ = F2(
	function (p, p__) {
		var p_ = p.val;
		return _elm_lang$core$Native_Utils.update(
			p,
			{
				val: _elm_lang$core$Native_Utils.update(
					p_,
					{p__: p__})
			});
	});
var _user$project$Lang$mapNodeP__ = F2(
	function (f, p) {
		return A2(
			_user$project$Lang$replaceP__,
			p,
			f(p.val.p__));
	});
var _user$project$Lang$replaceE__ = F2(
	function (e, e__) {
		var e_ = e.val;
		return _elm_lang$core$Native_Utils.update(
			e,
			{
				val: _elm_lang$core$Native_Utils.update(
					e_,
					{e__: e__})
			});
	});
var _user$project$Lang$mapNodeE__ = F2(
	function (f, e) {
		return A2(
			_user$project$Lang$replaceE__,
			e,
			f(e.val.e__));
	});
var _user$project$Lang$strPos = function (p) {
	var _p43 = {
		ctor: '_Tuple2',
		_0: _elm_lang$core$Basics$toString(p.line),
		_1: _elm_lang$core$Basics$toString(p.col)
	};
	var i = _p43._0;
	var j = _p43._1;
	return A2(
		_elm_lang$core$Basics_ops['++'],
		'(Line:',
		A2(
			_elm_lang$core$Basics_ops['++'],
			i,
			A2(
				_elm_lang$core$Basics_ops['++'],
				' Col:',
				A2(_elm_lang$core$Basics_ops['++'], j, ')'))));
};
var _user$project$Lang$errorPrefix = '[Little Error]';
var _user$project$Lang$crashWithMsg = function (s) {
	return _elm_lang$core$Native_Utils.crash(
		'Lang',
		{
			start: {line: 1463, column: 19},
			end: {line: 1463, column: 30}
		})(
		A2(
			_elm_lang$core$Basics_ops['++'],
			_user$project$Lang$errorPrefix,
			A2(_elm_lang$core$Basics_ops['++'], '\n\n', s)));
};
var _user$project$Lang$errorMsg = function (s) {
	return _elm_lang$core$Result$Err(
		A2(
			_elm_lang$core$Basics_ops['++'],
			_user$project$Lang$errorPrefix,
			A2(_elm_lang$core$Basics_ops['++'], '\n\n', s)));
};
var _user$project$Lang$getOptions = function (e) {
	getOptions:
	while (true) {
		var _p44 = e.val.e__;
		switch (_p44.ctor) {
			case 'EOption':
				return {
					ctor: '::',
					_0: {ctor: '_Tuple2', _0: _p44._1.val, _1: _p44._3.val},
					_1: _user$project$Lang$getOptions(_p44._4)
				};
			case 'EComment':
				var _v34 = _p44._2;
				e = _v34;
				continue getOptions;
			default:
				return {ctor: '[]'};
		}
	}
};
var _user$project$Lang$childPats = function (pat) {
	var _p45 = pat.val.p__;
	switch (_p45.ctor) {
		case 'PConst':
			return {ctor: '[]'};
		case 'PBase':
			return {ctor: '[]'};
		case 'PVar':
			return {ctor: '[]'};
		case 'PList':
			if (_p45._3.ctor === 'Nothing') {
				return _p45._1;
			} else {
				return A2(
					_elm_lang$core$Basics_ops['++'],
					_p45._1,
					{
						ctor: '::',
						_0: _p45._3._0,
						_1: {ctor: '[]'}
					});
			}
		default:
			return {
				ctor: '::',
				_0: _p45._3,
				_1: {ctor: '[]'}
			};
	}
};
var _user$project$Lang$flattenPatTree = function (pat) {
	return {
		ctor: '::',
		_0: pat,
		_1: A2(
			_elm_lang$core$List$concatMap,
			_user$project$Lang$flattenPatTree,
			_user$project$Lang$childPats(pat))
	};
};
var _user$project$Lang$varsOfPat = function (pat) {
	var _p46 = pat.val.p__;
	switch (_p46.ctor) {
		case 'PConst':
			return {ctor: '[]'};
		case 'PBase':
			return {ctor: '[]'};
		case 'PVar':
			return {
				ctor: '::',
				_0: _p46._1,
				_1: {ctor: '[]'}
			};
		case 'PList':
			if (_p46._3.ctor === 'Nothing') {
				return A2(_elm_lang$core$List$concatMap, _user$project$Lang$varsOfPat, _p46._1);
			} else {
				return A2(
					_elm_lang$core$List$concatMap,
					_user$project$Lang$varsOfPat,
					{ctor: '::', _0: _p46._3._0, _1: _p46._1});
			}
		default:
			return {
				ctor: '::',
				_0: _p46._1,
				_1: _user$project$Lang$varsOfPat(_p46._3)
			};
	}
};
var _user$project$Lang$isOption = function (exp) {
	var _p47 = exp.val.e__;
	if (_p47.ctor === 'EOption') {
		return true;
	} else {
		return false;
	}
};
var _user$project$Lang$isComment = function (exp) {
	var _p48 = exp.val.e__;
	if (_p48.ctor === 'EComment') {
		return true;
	} else {
		return false;
	}
};
var _user$project$Lang$isNumber = function (exp) {
	var _p49 = exp.val.e__;
	if (_p49.ctor === 'EConst') {
		return true;
	} else {
		return false;
	}
};
var _user$project$Lang$isScope = F2(
	function (maybeParent, exp) {
		var isObviouslyScope = function () {
			var _p50 = exp.val.e__;
			switch (_p50.ctor) {
				case 'ELet':
					return true;
				case 'EFun':
					return true;
				default:
					return false;
			}
		}();
		var _p51 = maybeParent;
		if (_p51.ctor === 'Just') {
			var _p52 = _p51._0.val.e__;
			if (_p52.ctor === 'ECase') {
				return !_elm_lang$core$Native_Utils.eq(_p52._1, exp);
			} else {
				return isObviouslyScope;
			}
		} else {
			return isObviouslyScope;
		}
	});
var _user$project$Lang$branchPatExps = function (branches) {
	return A2(
		_elm_lang$core$List$map,
		function (_p53) {
			return function (_p54) {
				var _p55 = _p54;
				return {ctor: '_Tuple2', _0: _p55._1, _1: _p55._2};
			}(
				function (_) {
					return _.val;
				}(_p53));
		},
		branches);
};
var _user$project$Lang$tbranchTypes = function (tbranches) {
	return A2(
		_elm_lang$core$List$map,
		function (_p56) {
			return function (_p57) {
				var _p58 = _p57;
				return _p58._1;
			}(
				function (_) {
					return _.val;
				}(_p56));
		},
		tbranches);
};
var _user$project$Lang$branchPat = function (branch) {
	var _p59 = branch.val;
	var pat = _p59._1;
	return pat;
};
var _user$project$Lang$branchPats = function (branches) {
	return A2(_elm_lang$core$List$map, _user$project$Lang$branchPat, branches);
};
var _user$project$Lang$tbranchExps = function (tbranches) {
	return A2(
		_elm_lang$core$List$map,
		function (_p60) {
			return function (_p61) {
				var _p62 = _p61;
				return _p62._2;
			}(
				function (_) {
					return _.val;
				}(_p60));
		},
		tbranches);
};
var _user$project$Lang$branchExps = function (branches) {
	return A2(
		_elm_lang$core$List$map,
		function (_p63) {
			return function (_p64) {
				var _p65 = _p64;
				return _p65._2;
			}(
				function (_) {
					return _.val;
				}(_p63));
		},
		branches);
};
var _user$project$Lang$valToTrace = function (v) {
	var _p66 = v.v_;
	if ((_p66.ctor === 'VConst') && (_p66._1.ctor === '_Tuple2')) {
		return _p66._1._1;
	} else {
		return _elm_lang$core$Native_Utils.crashCase(
			'Lang',
			{
				start: {line: 1254, column: 16},
				end: {line: 1256, column: 51}
			},
			_p66)('valToTrace');
	}
};
var _user$project$Lang$childExps = function (e) {
	var _p68 = e.val.e__;
	switch (_p68.ctor) {
		case 'EConst':
			return {ctor: '[]'};
		case 'EBase':
			return {ctor: '[]'};
		case 'EVar':
			return {ctor: '[]'};
		case 'EFun':
			return {
				ctor: '::',
				_0: _p68._2,
				_1: {ctor: '[]'}
			};
		case 'EOp':
			return _p68._2;
		case 'EList':
			var _p70 = _p68._1;
			var _p69 = _p68._3;
			if (_p69.ctor === 'Just') {
				return A2(
					_elm_lang$core$Basics_ops['++'],
					_p70,
					{
						ctor: '::',
						_0: _p69._0,
						_1: {ctor: '[]'}
					});
			} else {
				return _p70;
			}
		case 'EApp':
			return {ctor: '::', _0: _p68._1, _1: _p68._2};
		case 'ELet':
			return {
				ctor: '::',
				_0: _p68._4,
				_1: {
					ctor: '::',
					_0: _p68._5,
					_1: {ctor: '[]'}
				}
			};
		case 'EIf':
			return {
				ctor: '::',
				_0: _p68._1,
				_1: {
					ctor: '::',
					_0: _p68._2,
					_1: {
						ctor: '::',
						_0: _p68._3,
						_1: {ctor: '[]'}
					}
				}
			};
		case 'ECase':
			return {
				ctor: '::',
				_0: _p68._1,
				_1: _user$project$Lang$branchExps(_p68._2)
			};
		case 'ETypeCase':
			return _user$project$Lang$tbranchExps(_p68._2);
		case 'EComment':
			return {
				ctor: '::',
				_0: _p68._2,
				_1: {ctor: '[]'}
			};
		case 'EOption':
			return {
				ctor: '::',
				_0: _p68._4,
				_1: {ctor: '[]'}
			};
		case 'ETyp':
			return {
				ctor: '::',
				_0: _p68._3,
				_1: {ctor: '[]'}
			};
		case 'EColonType':
			return {
				ctor: '::',
				_0: _p68._1,
				_1: {ctor: '[]'}
			};
		default:
			return {
				ctor: '::',
				_0: _p68._3,
				_1: {ctor: '[]'}
			};
	}
};
var _user$project$Lang$findWithAncestorsByEId = F2(
	function (exp, targetEId) {
		return _elm_lang$core$Native_Utils.eq(exp.val.eid, targetEId) ? _elm_lang$core$Maybe$Just(
			{
				ctor: '::',
				_0: exp,
				_1: {ctor: '[]'}
			}) : A2(
			_elm_lang$core$Maybe$map,
			function (descendents) {
				return {ctor: '::', _0: exp, _1: descendents};
			},
			A2(
				_user$project$Utils$mapFirstSuccess,
				function (child) {
					return A2(_user$project$Lang$findWithAncestorsByEId, child, targetEId);
				},
				_user$project$Lang$childExps(exp)));
	});
var _user$project$Lang$parentByEId = F2(
	function (program, targetEId) {
		return A2(
			_elm_lang$core$Maybe$map,
			function (_p71) {
				return _elm_lang$core$List$head(
					A2(
						_user$project$Utils$dropLast,
						1,
						A2(_user$project$Utils$takeLast, 2, _p71)));
			},
			A2(_user$project$Lang$findWithAncestorsByEId, program, targetEId));
	});
var _user$project$Lang$indentationAt = F2(
	function (eid, program) {
		var _p72 = A2(_user$project$Lang$findWithAncestorsByEId, program, eid);
		if (_p72.ctor === 'Just') {
			return A2(
				_elm_lang$core$Maybe$withDefault,
				'',
				A2(
					_user$project$Utils$mapFirstSuccess,
					function (ws) {
						return A2(_elm_lang$core$String$contains, '\n', ws) ? _elm_lang$core$Maybe$Just(
							_user$project$Lang$extractIndentation(ws)) : _elm_lang$core$Maybe$Nothing;
					},
					A2(
						_elm_lang$core$List$map,
						_user$project$Lang$precedingWhitespace,
						_elm_lang$core$List$reverse(_p72._0))));
		} else {
			return '';
		}
	});
var _user$project$Lang$findAllWithAncestorsScopesTagged_ = F3(
	function (predicate, ancestors, exp) {
		var ancestorsAndThisNoScope = A2(
			_elm_lang$core$Basics_ops['++'],
			ancestors,
			{
				ctor: '::',
				_0: {ctor: '_Tuple2', _0: exp, _1: false},
				_1: {ctor: '[]'}
			});
		var ancestorsAndThisScope = A2(
			_elm_lang$core$Basics_ops['++'],
			ancestors,
			{
				ctor: '::',
				_0: {ctor: '_Tuple2', _0: exp, _1: true},
				_1: {ctor: '[]'}
			});
		var thisResult = predicate(exp) ? {
			ctor: '::',
			_0: ancestorsAndThisNoScope,
			_1: {ctor: '[]'}
		} : {ctor: '[]'};
		var recurseNoScope = function (exp) {
			return A3(_user$project$Lang$findAllWithAncestorsScopesTagged_, predicate, ancestorsAndThisNoScope, exp);
		};
		var recurseScope = function (exp) {
			return A3(_user$project$Lang$findAllWithAncestorsScopesTagged_, predicate, ancestorsAndThisScope, exp);
		};
		var _p73 = exp.val.e__;
		switch (_p73.ctor) {
			case 'ELet':
				return A2(
					_elm_lang$core$Basics_ops['++'],
					thisResult,
					A2(
						_elm_lang$core$Basics_ops['++'],
						recurseNoScope(_p73._4),
						recurseScope(_p73._5)));
			case 'ECase':
				return A2(
					_elm_lang$core$Basics_ops['++'],
					thisResult,
					A2(
						_elm_lang$core$Basics_ops['++'],
						recurseNoScope(_p73._1),
						A2(
							_elm_lang$core$List$concatMap,
							recurseScope,
							_user$project$Lang$branchExps(_p73._2))));
			case 'EFun':
				return A2(
					_elm_lang$core$Basics_ops['++'],
					thisResult,
					recurseScope(_p73._2));
			default:
				return A2(
					_elm_lang$core$Basics_ops['++'],
					thisResult,
					A2(
						_elm_lang$core$List$concatMap,
						recurseNoScope,
						_user$project$Lang$childExps(exp)));
		}
	});
var _user$project$Lang$findAllWithAncestorsScopesTagged = F2(
	function (predicate, exp) {
		return A3(
			_user$project$Lang$findAllWithAncestorsScopesTagged_,
			predicate,
			{ctor: '[]'},
			exp);
	});
var _user$project$Lang$findAllWithAncestors_ = F3(
	function (predicate, ancestors, exp) {
		var ancestorsAndThis = A2(
			_elm_lang$core$Basics_ops['++'],
			ancestors,
			{
				ctor: '::',
				_0: exp,
				_1: {ctor: '[]'}
			});
		var thisResult = predicate(exp) ? {
			ctor: '::',
			_0: ancestorsAndThis,
			_1: {ctor: '[]'}
		} : {ctor: '[]'};
		var recurse = function (exp) {
			return A3(_user$project$Lang$findAllWithAncestors_, predicate, ancestorsAndThis, exp);
		};
		return A2(
			_elm_lang$core$Basics_ops['++'],
			thisResult,
			A2(
				_elm_lang$core$List$concatMap,
				recurse,
				_user$project$Lang$childExps(exp)));
	});
var _user$project$Lang$findAllWithAncestors = F2(
	function (predicate, exp) {
		return A3(
			_user$project$Lang$findAllWithAncestors_,
			predicate,
			{ctor: '[]'},
			exp);
	});
var _user$project$Lang$commonAncestors = F2(
	function (pred, exp) {
		return _user$project$Utils$commonPrefix(
			A2(
				_elm_lang$core$List$map,
				_user$project$Utils$dropLast(1),
				A2(_user$project$Lang$findAllWithAncestors, pred, exp)));
	});
var _user$project$Lang$mapFirstSuccessNode = F2(
	function (f, exp) {
		var _p74 = f(exp);
		if (_p74.ctor === 'Just') {
			return _elm_lang$core$Maybe$Just(_p74._0);
		} else {
			return A2(
				_user$project$Utils$mapFirstSuccess,
				_user$project$Lang$mapFirstSuccessNode(f),
				_user$project$Lang$childExps(exp));
		}
	});
var _user$project$Lang$findFirstNode = F2(
	function (predicate, exp) {
		return predicate(exp) ? _elm_lang$core$Maybe$Just(exp) : A2(
			_user$project$Utils$mapFirstSuccess,
			_user$project$Lang$findFirstNode(predicate),
			_user$project$Lang$childExps(exp));
	});
var _user$project$Lang$findExpByEId = F2(
	function (program, targetEId) {
		return A2(
			_user$project$Lang$findFirstNode,
			function (exp) {
				return _elm_lang$core$Native_Utils.eq(exp.val.eid, targetEId);
			},
			program);
	});
var _user$project$Lang$findExpByLocId = F2(
	function (program, targetLocId) {
		var isTarget = function (exp) {
			var _p75 = exp.val.e__;
			if ((_p75.ctor === 'EConst') && (_p75._2.ctor === '_Tuple3')) {
				return _elm_lang$core$Native_Utils.eq(_p75._2._0, targetLocId);
			} else {
				return false;
			}
		};
		return A2(_user$project$Lang$findFirstNode, isTarget, program);
	});
var _user$project$Lang$locIdToEId = F2(
	function (program, locId) {
		return A2(
			_elm_lang$core$Maybe$map,
			function (_p76) {
				return function (_) {
					return _.eid;
				}(
					function (_) {
						return _.val;
					}(_p76));
			},
			A2(_user$project$Lang$findExpByLocId, program, locId));
	});
var _user$project$Lang$flattenExpTree = function (exp) {
	return {
		ctor: '::',
		_0: exp,
		_1: A2(
			_elm_lang$core$List$concatMap,
			_user$project$Lang$flattenExpTree,
			_user$project$Lang$childExps(exp))
	};
};
var _user$project$Lang$allEIds = function (exp) {
	return A2(
		_elm_lang$core$List$map,
		function (_p77) {
			return function (_) {
				return _.eid;
			}(
				function (_) {
					return _.val;
				}(_p77));
		},
		_user$project$Lang$flattenExpTree(exp));
};
var _user$project$Lang$computePatMap = function () {
	var taggedChildPats = function (e) {
		var _p78 = e.val.e__;
		switch (_p78.ctor) {
			case 'EFun':
				return A2(
					_user$project$Lang$tagPatList,
					_user$project$Lang$rootPathedPatternId(
						{ctor: '_Tuple2', _0: e.val.eid, _1: 1}),
					_p78._1);
			case 'ECase':
				return A2(_user$project$Lang$tagBranchList, e.val.eid, _p78._2);
			case 'ETypeCase':
				return A2(
					_user$project$Lang$tagSinglePat,
					_user$project$Lang$rootPathedPatternId(
						{ctor: '_Tuple2', _0: e.val.eid, _1: 1}),
					_p78._1);
			case 'ELet':
				return A2(
					_user$project$Lang$tagSinglePat,
					_user$project$Lang$rootPathedPatternId(
						{ctor: '_Tuple2', _0: e.val.eid, _1: 1}),
					_p78._3);
			case 'ETyp':
				return A2(
					_user$project$Lang$tagSinglePat,
					_user$project$Lang$rootPathedPatternId(
						{ctor: '_Tuple2', _0: e.val.eid, _1: 1}),
					_p78._1);
			case 'ETypeAlias':
				return A2(
					_user$project$Lang$tagSinglePat,
					_user$project$Lang$rootPathedPatternId(
						{ctor: '_Tuple2', _0: e.val.eid, _1: 1}),
					_p78._1);
			default:
				return {ctor: '[]'};
		}
	};
	return function (_p79) {
		return _elm_lang$core$Dict$fromList(
			A2(
				_elm_lang$core$List$concatMap,
				taggedChildPats,
				_user$project$Lang$flattenExpTree(_p79)));
	};
}();
var _user$project$Lang$foldType = F3(
	function (f, tipe, acc) {
		var foldTypes = F3(
			function (f, tipes, acc) {
				return A3(
					_elm_lang$core$List$foldl,
					F2(
						function (t, acc) {
							return A3(_user$project$Lang$foldType, f, t, acc);
						}),
					acc,
					tipes);
			});
		var _p80 = tipe.val;
		switch (_p80.ctor) {
			case 'TNum':
				return A2(f, tipe, acc);
			case 'TBool':
				return A2(f, tipe, acc);
			case 'TString':
				return A2(f, tipe, acc);
			case 'TNull':
				return A2(f, tipe, acc);
			case 'TNamed':
				return A2(f, tipe, acc);
			case 'TVar':
				return A2(f, tipe, acc);
			case 'TWildcard':
				return A2(f, tipe, acc);
			case 'TList':
				return A2(
					f,
					tipe,
					A3(_user$project$Lang$foldType, f, _p80._1, acc));
			case 'TDict':
				return A2(
					f,
					tipe,
					A3(
						_user$project$Lang$foldType,
						f,
						_p80._2,
						A3(_user$project$Lang$foldType, f, _p80._1, acc)));
			case 'TForall':
				return A2(
					f,
					tipe,
					A3(_user$project$Lang$foldType, f, _p80._2, acc));
			case 'TArrow':
				return A2(
					f,
					tipe,
					A3(foldTypes, f, _p80._1, acc));
			case 'TUnion':
				return A2(
					f,
					tipe,
					A3(foldTypes, f, _p80._1, acc));
			default:
				if (_p80._3.ctor === 'Nothing') {
					return A2(
						f,
						tipe,
						A3(foldTypes, f, _p80._1, acc));
				} else {
					return A2(
						f,
						tipe,
						A3(
							foldTypes,
							f,
							A2(
								_elm_lang$core$Basics_ops['++'],
								_p80._1,
								{
									ctor: '::',
									_0: _p80._3._0,
									_1: {ctor: '[]'}
								}),
							acc));
				}
		}
	});
var _user$project$Lang$foldExp = F3(
	function (f, acc, exp) {
		return A3(
			_elm_lang$core$List$foldl,
			f,
			acc,
			_user$project$Lang$flattenExpTree(exp));
	});
var _user$project$Lang$foldExpViaE__ = F3(
	function (f, acc, exp) {
		var f_ = function (exp) {
			return f(exp.val.e__);
		};
		return A3(_user$project$Lang$foldExp, f_, acc, exp);
	});
var _user$project$Lang$foldVal = F3(
	function (f, v, a) {
		var _p81 = v.v_;
		switch (_p81.ctor) {
			case 'VList':
				return A2(
					f,
					v,
					A3(
						_elm_lang$core$List$foldl,
						_user$project$Lang$foldVal(f),
						a,
						_p81._0));
			case 'VDict':
				return A2(
					f,
					v,
					A3(
						_elm_lang$core$List$foldl,
						_user$project$Lang$foldVal(f),
						a,
						_elm_lang$core$Dict$values(_p81._0)));
			case 'VConst':
				return A2(f, v, a);
			case 'VBase':
				return A2(f, v, a);
			default:
				return A2(f, v, a);
		}
	});
var _user$project$Lang$mapValField = F2(
	function (f, r) {
		return _elm_lang$core$Native_Utils.update(
			r,
			{
				val: f(r.val)
			});
	});
var _user$project$Lang$isFunc = function (e) {
	var _p82 = e.val.e__;
	if (_p82.ctor === 'EFun') {
		return true;
	} else {
		return false;
	}
};
var _user$project$Lang$isList = function (e) {
	var _p83 = e.val.e__;
	if (_p83.ctor === 'EList') {
		return true;
	} else {
		return false;
	}
};
var _user$project$Lang$isLet = function (e) {
	var _p84 = e.val.e__;
	if (_p84.ctor === 'ELet') {
		return true;
	} else {
		return false;
	}
};
var _user$project$Lang$fitsOnLine = function (s) {
	return (_elm_lang$core$Native_Utils.cmp(
		_elm_lang$core$String$length(s),
		70) > 0) ? false : (A2(
		_elm_lang$core$List$member,
		_elm_lang$core$Native_Utils.chr('\n'),
		_elm_lang$core$String$toList(s)) ? false : true);
};
var _user$project$Lang$tab = function (k) {
	return A2(_elm_lang$core$String$repeat, k, '  ');
};
var _user$project$Lang$traceToMaybeIdent = function (tr) {
	var _p85 = tr;
	if ((_p85.ctor === 'TrLoc') && (_p85._0.ctor === '_Tuple3')) {
		var _p86 = _p85._0._2;
		return (!_elm_lang$core$Native_Utils.eq(_p86, '')) ? _elm_lang$core$Maybe$Just(_p86) : _elm_lang$core$Maybe$Nothing;
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$Lang$strLoc = function (_p87) {
	var _p88 = _p87;
	var _p89 = _p88._2;
	return A2(
		_elm_lang$core$Basics_ops['++'],
		'k',
		A2(
			_elm_lang$core$Basics_ops['++'],
			_elm_lang$core$Basics$toString(_p88._0),
			A2(
				_elm_lang$core$Basics_ops['++'],
				_elm_lang$core$Native_Utils.eq(_p89, '') ? '' : A2(_elm_lang$core$Basics_ops['++'], '_', _p89),
				_p88._1)));
};
var _user$project$Lang$strOp = function (op) {
	var _p90 = op;
	switch (_p90.ctor) {
		case 'Plus':
			return '+';
		case 'Minus':
			return '-';
		case 'Mult':
			return '*';
		case 'Div':
			return '/';
		case 'Lt':
			return '<';
		case 'Eq':
			return '=';
		case 'Pi':
			return 'pi';
		case 'Cos':
			return 'cos';
		case 'Sin':
			return 'sin';
		case 'ArcCos':
			return 'arccos';
		case 'ArcSin':
			return 'arcsin';
		case 'ArcTan2':
			return 'arctan2';
		case 'Floor':
			return 'floor';
		case 'Ceil':
			return 'ceiling';
		case 'Round':
			return 'round';
		case 'ToStr':
			return 'toString';
		case 'Explode':
			return 'explode';
		case 'Sqrt':
			return 'sqrt';
		case 'Mod':
			return 'mod';
		case 'Pow':
			return 'pow';
		case 'DictEmpty':
			return 'empty';
		case 'DictInsert':
			return 'insert';
		case 'DictGet':
			return 'get';
		case 'DictRemove':
			return 'remove';
		default:
			return 'debug';
	}
};
var _user$project$Lang$strTrace = function (tr) {
	var _p91 = tr;
	if (_p91.ctor === 'TrLoc') {
		return _user$project$Lang$strLoc(_p91._0);
	} else {
		return _user$project$Utils$parens(
			_elm_lang$core$String$concat(
				{
					ctor: '::',
					_0: _user$project$Lang$strOp(_p91._0),
					_1: {
						ctor: '::',
						_0: ' ',
						_1: {
							ctor: '::',
							_0: A2(
								_elm_lang$core$String$join,
								' ',
								A2(_elm_lang$core$List$map, _user$project$Lang$strTrace, _p91._1)),
							_1: {ctor: '[]'}
						}
					}
				}));
	}
};
var _user$project$Lang$strNum = _elm_lang$core$Basics$toString;
var _user$project$Lang$strNumTrunc = function (k) {
	return function (_p92) {
		return function (s) {
			return (_elm_lang$core$Native_Utils.cmp(
				_elm_lang$core$String$length(s),
				k) > 0) ? A2(
				_elm_lang$core$Basics_ops['++'],
				A2(_elm_lang$core$String$left, k, s),
				'..') : s;
		}(
			_user$project$Lang$strNum(_p92));
	};
};
var _user$project$Lang$strBaseVal = function (v) {
	var _p93 = v;
	switch (_p93.ctor) {
		case 'VBool':
			if (_p93._0 === true) {
				return 'true';
			} else {
				return 'false';
			}
		case 'VString':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				'\'',
				A2(_elm_lang$core$Basics_ops['++'], _p93._0, '\''));
		default:
			return 'null';
	}
};
var _user$project$Lang$strVal_ = F2(
	function (showTraces, v) {
		var foo = _user$project$Lang$strVal_(showTraces);
		var sTrace = showTraces ? _user$project$Utils$braces(
			_elm_lang$core$Basics$toString(v.vtrace)) : '';
		return A2(
			_elm_lang$core$Basics_ops['++'],
			sTrace,
			function () {
				var _p94 = v.v_;
				switch (_p94.ctor) {
					case 'VConst':
						return A2(
							_elm_lang$core$Basics_ops['++'],
							_user$project$Lang$strNum(_p94._1._0),
							showTraces ? A2(
								_elm_lang$core$Basics_ops['++'],
								_user$project$Utils$angleBracks(
									_elm_lang$core$Basics$toString(_p94._0)),
								_user$project$Utils$braces(
									_user$project$Lang$strTrace(_p94._1._1))) : '');
					case 'VBase':
						return _user$project$Lang$strBaseVal(_p94._0);
					case 'VClosure':
						return '<fun>';
					case 'VList':
						return _user$project$Utils$bracks(
							A2(
								_elm_lang$core$String$join,
								' ',
								A2(_elm_lang$core$List$map, foo, _p94._0)));
					default:
						return A2(
							_elm_lang$core$Basics_ops['++'],
							'<dict ',
							A2(
								_elm_lang$core$Basics_ops['++'],
								A2(
									_elm_lang$core$String$join,
									' ',
									A2(
										_elm_lang$core$List$map,
										function (_p95) {
											var _p96 = _p95;
											return A2(
												_elm_lang$core$Basics_ops['++'],
												_elm_lang$core$Basics$toString(_p96._0),
												A2(
													_elm_lang$core$Basics_ops['++'],
													':',
													foo(_p96._1)));
										},
										_elm_lang$core$Dict$toList(_p94._0))),
								'>'));
				}
			}());
	});
var _user$project$Lang$strVal = _user$project$Lang$strVal_(false);
var _user$project$Lang$strValLocs = _user$project$Lang$strVal_(true);
var _user$project$Lang$pathAfterElementRemoved = F2(
	function (removedPath, path) {
		var _p97 = {ctor: '_Tuple2', _0: removedPath, _1: path};
		if (_p97._0.ctor === '::') {
			if (_p97._1.ctor === '::') {
				if (_p97._0._1.ctor === '[]') {
					if (_p97._1._1.ctor === '[]') {
						var _p98 = _p97._1._0;
						return (_elm_lang$core$Native_Utils.cmp(_p97._0._0, _p98) < 0) ? _elm_lang$core$Maybe$Just(
							{
								ctor: '::',
								_0: _p98 - 1,
								_1: {ctor: '[]'}
							}) : _elm_lang$core$Maybe$Just(
							{
								ctor: '::',
								_0: _p98,
								_1: {ctor: '[]'}
							});
					} else {
						var _p101 = _p97._0._0;
						var _p100 = _p97._1._0;
						if (_elm_lang$core$Native_Utils.eq(_p101, _p100)) {
							var _p99 = _elm_lang$core$Debug$log(
								A2(
									_elm_lang$core$Basics_ops['++'],
									'removed pat path is supertree of target path ',
									_elm_lang$core$Basics$toString(
										{ctor: '_Tuple2', _0: removedPath, _1: path})));
							return _elm_lang$core$Maybe$Nothing;
						} else {
							if (_elm_lang$core$Native_Utils.cmp(_p101, _p100) < 0) {
								return _elm_lang$core$Maybe$Just(
									{ctor: '::', _0: _p100 - 1, _1: _p97._1._1});
							} else {
								return _elm_lang$core$Maybe$Just(path);
							}
						}
					}
				} else {
					var _p102 = _p97._1._0;
					return _elm_lang$core$Native_Utils.eq(_p97._0._0, _p102) ? A2(
						_elm_lang$core$Maybe$map,
						F2(
							function (x, y) {
								return {ctor: '::', _0: x, _1: y};
							})(_p102),
						A2(_user$project$Lang$pathAfterElementRemoved, _p97._0._1, _p97._1._1)) : _elm_lang$core$Maybe$Just(path);
				}
			} else {
				return _elm_lang$core$Maybe$Just(path);
			}
		} else {
			if (_p97._1.ctor === '::') {
				var _p103 = _elm_lang$core$Debug$log(
					A2(
						_elm_lang$core$Basics_ops['++'],
						'removed pat path is supertree of target path ',
						_elm_lang$core$Basics$toString(
							{ctor: '_Tuple2', _0: removedPath, _1: path})));
				return _elm_lang$core$Maybe$Nothing;
			} else {
				return _elm_lang$core$Native_Utils.crashCase(
					'Lang',
					{
						start: {line: 350, column: 3},
						end: {line: 381, column: 110}
					},
					_p97)(
					A2(
						_elm_lang$core$Basics_ops['++'],
						'Lang.pathAfterElementRemoved why did this get called?!',
						_elm_lang$core$Basics$toString(
							{ctor: '_Tuple2', _0: removedPath, _1: path})));
			}
		}
	});
var _user$project$Lang$pathRightSibling = function (path) {
	return A2(
		_user$project$Utils$maybeMapLast,
		F2(
			function (x, y) {
				return x + y;
			})(1),
		path);
};
var _user$project$Lang$patTargetPositionToTargetPathedPatId = function (_p105) {
	var _p106 = _p105;
	var _p111 = _p106._1;
	var _p110 = _p106._0;
	var _p107 = _p111;
	var referenceScopeId = _p107._0;
	var referencePath = _p107._1;
	var targetPath = function () {
		var referencePathAsPList = function () {
			var _p108 = referencePath;
			if (_p108.ctor === '[]') {
				return {
					ctor: '::',
					_0: 1,
					_1: {ctor: '[]'}
				};
			} else {
				return referencePath;
			}
		}();
		var _p109 = _p110;
		if (_p109.ctor === 'Before') {
			return referencePathAsPList;
		} else {
			return A2(
				_user$project$Utils$fromJust_,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'invalid target pattern id path of [] in target path position: ',
					_elm_lang$core$Basics$toString(
						{ctor: '_Tuple2', _0: _p110, _1: _p111})),
				_user$project$Lang$pathRightSibling(referencePathAsPList));
		}
	}();
	return {ctor: '_Tuple2', _0: referenceScopeId, _1: targetPath};
};
var _user$project$Lang$pathedPatIdRightSibling = function (_p112) {
	var _p113 = _p112;
	return A2(
		_elm_lang$core$Maybe$map,
		function (newPath) {
			return {ctor: '_Tuple2', _0: _p113._0, _1: newPath};
		},
		_user$project$Lang$pathRightSibling(_p113._1));
};
var _user$project$Lang$pathedPatIdToPath = function (_p114) {
	var _p115 = _p114;
	return _p115._1;
};
var _user$project$Lang$pathedPatIdToScopeId = function (_p116) {
	var _p117 = _p116;
	return _p117._0;
};
var _user$project$Lang$scopeIdToScopeEId = function (_p118) {
	var _p119 = _p118;
	return _p119._0;
};
var _user$project$Lang$pathedPatIdToScopeEId = function (pathedPatId) {
	return _user$project$Lang$scopeIdToScopeEId(
		_user$project$Lang$pathedPatIdToScopeId(pathedPatId));
};
var _user$project$Lang$eBaseValsEqual = F2(
	function (ebv1, ebv2) {
		var _p120 = {ctor: '_Tuple2', _0: ebv1, _1: ebv2};
		_v75_3:
		do {
			if (_p120.ctor === '_Tuple2') {
				switch (_p120._0.ctor) {
					case 'EBool':
						if (_p120._1.ctor === 'EBool') {
							return _elm_lang$core$Native_Utils.eq(_p120._0._0, _p120._1._0);
						} else {
							break _v75_3;
						}
					case 'EString':
						if (_p120._1.ctor === 'EString') {
							return _elm_lang$core$Native_Utils.eq(_p120._0._1, _p120._1._1);
						} else {
							break _v75_3;
						}
					default:
						if (_p120._1.ctor === 'ENull') {
							return true;
						} else {
							break _v75_3;
						}
				}
			} else {
				break _v75_3;
			}
		} while(false);
		return false;
	});
var _user$project$Lang$defaultQuoteChar = '\'';
var _user$project$Lang$_p121 = {ctor: '_Tuple4', _0: '!', _1: '', _2: '?', _3: '~'};
var _user$project$Lang$frozen = _user$project$Lang$_p121._0;
var _user$project$Lang$unann = _user$project$Lang$_p121._1;
var _user$project$Lang$thawed = _user$project$Lang$_p121._2;
var _user$project$Lang$assignOnlyOnce = _user$project$Lang$_p121._3;
var _user$project$Lang$isFrozenNumber = function (exp) {
	var _p122 = exp.val.e__;
	if ((_p122.ctor === 'EConst') && (_p122._2.ctor === '_Tuple3')) {
		return _elm_lang$core$Native_Utils.eq(_p122._2._1, _user$project$Lang$frozen);
	} else {
		return false;
	}
};
var _user$project$Lang$dummyLoc = _user$project$Lang$dummyLoc_(_user$project$Lang$unann);
var _user$project$Lang$mapInfo = F2(
	function (f, wa) {
		return _elm_lang$core$Native_Utils.update(
			wa,
			{
				val: f(wa.val)
			});
	});
var _user$project$Lang$withInfo = F3(
	function (x, start, end) {
		return {val: x, start: start, end: end};
	});
var _user$project$Lang$posFromRowCol = function (_p123) {
	var _p124 = _p123;
	return {line: _p124._0, col: _p124._1};
};
var _user$project$Lang$dummyPos = {line: -1, col: -1};
var _user$project$Lang$withDummyInfo = function (x) {
	return A3(_user$project$Lang$withInfo, x, _user$project$Lang$dummyPos, _user$project$Lang$dummyPos);
};
var _user$project$Lang$ws = _user$project$Lang$withDummyInfo;
var _user$project$Lang$space0 = _user$project$Lang$ws('');
var _user$project$Lang$space1 = _user$project$Lang$ws(' ');
var _user$project$Lang$newline1 = _user$project$Lang$ws('\n');
var _user$project$Lang$newline2 = _user$project$Lang$ws('\n\n');
var _user$project$Lang$hasDummyInfo = function (w) {
	return _elm_lang$core$Native_Utils.eq(
		{ctor: '_Tuple2', _0: w.start, _1: w.end},
		{ctor: '_Tuple2', _0: _user$project$Lang$dummyPos, _1: _user$project$Lang$dummyPos});
};
var _user$project$Lang$startPos = {line: 1, col: 1};
var _user$project$Lang$Pos = F2(
	function (a, b) {
		return {line: a, col: b};
	});
var _user$project$Lang$WithPos = F2(
	function (a, b) {
		return {val: a, pos: b};
	});
var _user$project$Lang$WithInfo = F3(
	function (a, b, c) {
		return {val: a, start: b, end: c};
	});
var _user$project$Lang$withDummyRange = function (x) {
	return A3(_user$project$Lang$WithInfo, x, _user$project$Lang$dummyPos, _user$project$Lang$dummyPos);
};
var _user$project$Lang$rangeSlider = F3(
	function (kind, a, b) {
		return _user$project$Lang$withDummyRange(
			A5(
				kind,
				_user$project$Lang$withDummyRange(a),
				_user$project$Lang$withDummyRange('-'),
				_user$project$Lang$withDummyRange(b),
				_elm_lang$core$Maybe$Nothing,
				false));
	});
var _user$project$Lang$Exp_ = F2(
	function (a, b) {
		return {e__: a, eid: b};
	});
var _user$project$Lang$exp_ = A2(_elm_lang$core$Basics$flip, _user$project$Lang$Exp_, -1);
var _user$project$Lang$withDummyExpInfo = function (e__) {
	return A3(
		_user$project$Lang$WithInfo,
		_user$project$Lang$exp_(e__),
		_user$project$Lang$dummyPos,
		_user$project$Lang$dummyPos);
};
var _user$project$Lang$withDummyExpInfoEId = F2(
	function (eid, e__) {
		return A3(
			_user$project$Lang$WithInfo,
			A2(_user$project$Lang$Exp_, e__, eid),
			_user$project$Lang$dummyPos,
			_user$project$Lang$dummyPos);
	});
var _user$project$Lang$Pat_ = F2(
	function (a, b) {
		return {p__: a, pid: b};
	});
var _user$project$Lang$pat_ = A2(_elm_lang$core$Basics$flip, _user$project$Lang$Pat_, -1);
var _user$project$Lang$withDummyPatInfo = function (p__) {
	return A3(
		_user$project$Lang$WithInfo,
		_user$project$Lang$pat_(p__),
		_user$project$Lang$dummyPos,
		_user$project$Lang$dummyPos);
};
var _user$project$Lang$withDummyPatInfoPId = F2(
	function (pid, p__) {
		return A3(
			_user$project$Lang$WithInfo,
			A2(_user$project$Lang$Pat_, p__, pid),
			_user$project$Lang$dummyPos,
			_user$project$Lang$dummyPos);
	});
var _user$project$Lang$Val = F2(
	function (a, b) {
		return {v_: a, vtrace: b};
	});
var _user$project$Lang$val = A2(
	_elm_lang$core$Basics$flip,
	_user$project$Lang$Val,
	{
		ctor: '::',
		_0: -1,
		_1: {ctor: '[]'}
	});
var _user$project$Lang$TwoSubsts = F2(
	function (a, b) {
		return {lsubst: a, esubst: b};
	});
var _user$project$Lang$PAs = F4(
	function (a, b, c, d) {
		return {ctor: 'PAs', _0: a, _1: b, _2: c, _3: d};
	});
var _user$project$Lang$pAs = F2(
	function (x, p) {
		return _user$project$Lang$withDummyPatInfo(
			A4(_user$project$Lang$PAs, _user$project$Lang$space1, x, _user$project$Lang$space1, p));
	});
var _user$project$Lang$PList = F5(
	function (a, b, c, d, e) {
		return {ctor: 'PList', _0: a, _1: b, _2: c, _3: d, _4: e};
	});
var _user$project$Lang$mapFoldPat = F3(
	function (f, initAcc, p) {
		var recurse = _user$project$Lang$mapFoldPat(f);
		var wrap = function (p__) {
			return A2(_user$project$Lang$replaceP__, p, p__);
		};
		var wrapAndMap = function (_p125) {
			return f(
				wrap(_p125));
		};
		var recurseAll = F2(
			function (initAcc, pats) {
				return A3(
					_elm_lang$core$List$foldr,
					F2(
						function (pat, _p126) {
							var _p127 = _p126;
							var _p128 = A2(recurse, _p127._1, pat);
							var newPat = _p128._0;
							var newAcc = _p128._1;
							return {
								ctor: '_Tuple2',
								_0: {ctor: '::', _0: newPat, _1: _p127._0},
								_1: newAcc
							};
						}),
					{
						ctor: '_Tuple2',
						_0: {ctor: '[]'},
						_1: initAcc
					},
					pats);
			});
		var _p129 = p.val.p__;
		switch (_p129.ctor) {
			case 'PVar':
				return A2(f, p, initAcc);
			case 'PConst':
				return A2(f, p, initAcc);
			case 'PBase':
				return A2(f, p, initAcc);
			case 'PList':
				if (_p129._3.ctor === 'Nothing') {
					var _p130 = A2(recurseAll, initAcc, _p129._1);
					var newPs = _p130._0;
					var newAcc = _p130._1;
					return A2(
						wrapAndMap,
						A5(_user$project$Lang$PList, _p129._0, newPs, _p129._2, _elm_lang$core$Maybe$Nothing, _p129._4),
						newAcc);
				} else {
					var _p131 = A2(recurse, initAcc, _p129._3._0);
					var newPTail = _p131._0;
					var newAcc = _p131._1;
					var _p132 = A2(recurseAll, newAcc, _p129._1);
					var newPs = _p132._0;
					var newAcc2 = _p132._1;
					return A2(
						wrapAndMap,
						A5(
							_user$project$Lang$PList,
							_p129._0,
							newPs,
							_p129._2,
							_elm_lang$core$Maybe$Just(newPTail),
							_p129._4),
						newAcc2);
				}
			default:
				var _p133 = A2(recurse, initAcc, _p129._3);
				var newPChild = _p133._0;
				var newAcc = _p133._1;
				return A2(
					wrapAndMap,
					A4(_user$project$Lang$PAs, _p129._0, _p129._1, _p129._2, newPChild),
					newAcc);
		}
	});
var _user$project$Lang$mapPat = F2(
	function (f, p) {
		var _p134 = A3(
			_user$project$Lang$mapFoldPat,
			F2(
				function (pat, _p135) {
					return {
						ctor: '_Tuple2',
						_0: f(pat),
						_1: {ctor: '_Tuple0'}
					};
				}),
			{ctor: '_Tuple0'},
			p);
		var newPat = _p134._0;
		return newPat;
	});
var _user$project$Lang$mapPatNodePat = F3(
	function (pid, f, rootPat) {
		return A2(
			_user$project$Lang$mapPat,
			function (pat) {
				return _elm_lang$core$Native_Utils.eq(pat.val.pid, pid) ? f(pat) : pat;
			},
			rootPat);
	});
var _user$project$Lang$mapFoldPatTopDown = F3(
	function (f, initAcc, p) {
		var _p136 = A2(f, p, initAcc);
		var newP = _p136._0;
		var newAcc = _p136._1;
		var ret = F2(
			function (p__, acc) {
				return {
					ctor: '_Tuple2',
					_0: A2(_user$project$Lang$replaceP__, newP, p__),
					_1: acc
				};
			});
		var recurse = F2(
			function (acc, child) {
				return A3(_user$project$Lang$mapFoldPatTopDown, f, acc, child);
			});
		var recurseAll = F2(
			function (acc, pats) {
				return A3(
					_elm_lang$core$List$foldl,
					F2(
						function (pat, _p137) {
							var _p138 = _p137;
							var _p139 = A2(recurse, _p138._1, pat);
							var newPat = _p139._0;
							var newAcc = _p139._1;
							return {
								ctor: '_Tuple2',
								_0: A2(
									_elm_lang$core$Basics_ops['++'],
									_p138._0,
									{
										ctor: '::',
										_0: newPat,
										_1: {ctor: '[]'}
									}),
								_1: newAcc
							};
						}),
					{
						ctor: '_Tuple2',
						_0: {ctor: '[]'},
						_1: acc
					},
					pats);
			});
		var _p140 = newP.val.p__;
		switch (_p140.ctor) {
			case 'PVar':
				return {ctor: '_Tuple2', _0: newP, _1: newAcc};
			case 'PConst':
				return {ctor: '_Tuple2', _0: newP, _1: newAcc};
			case 'PBase':
				return {ctor: '_Tuple2', _0: newP, _1: newAcc};
			case 'PList':
				if (_p140._3.ctor === 'Nothing') {
					var _p141 = A2(recurseAll, newAcc, _p140._1);
					var newPs = _p141._0;
					var newAcc2 = _p141._1;
					return A2(
						ret,
						A5(_user$project$Lang$PList, _p140._0, newPs, _p140._2, _elm_lang$core$Maybe$Nothing, _p140._4),
						newAcc2);
				} else {
					var _p142 = A2(recurseAll, newAcc, _p140._1);
					var newPs = _p142._0;
					var newAcc2 = _p142._1;
					var _p143 = A2(recurse, newAcc2, _p140._3._0);
					var newPTail = _p143._0;
					var newAcc3 = _p143._1;
					return A2(
						ret,
						A5(
							_user$project$Lang$PList,
							_p140._0,
							newPs,
							_p140._2,
							_elm_lang$core$Maybe$Just(newPTail),
							_p140._4),
						newAcc3);
				}
			default:
				var _p144 = A2(recurse, newAcc, _p140._3);
				var newPChild = _p144._0;
				var newAcc2 = _p144._1;
				return A2(
					ret,
					A4(_user$project$Lang$PAs, _p140._0, _p140._1, _p140._2, newPChild),
					newAcc2);
		}
	});
var _user$project$Lang$mapPatTopDown = F2(
	function (f, p) {
		var _p145 = A3(
			_user$project$Lang$mapFoldPatTopDown,
			F2(
				function (pat, _p146) {
					return {
						ctor: '_Tuple2',
						_0: f(pat),
						_1: {ctor: '_Tuple0'}
					};
				}),
			{ctor: '_Tuple0'},
			p);
		var newPat = _p145._0;
		return newPat;
	});
var _user$project$Lang$clearPIds = function (p) {
	return A2(_user$project$Lang$mapPatTopDown, _user$project$Lang$clearPId, p);
};
var _user$project$Lang$pList0 = function (ps) {
	return _user$project$Lang$withDummyPatInfo(
		A5(_user$project$Lang$PList, _user$project$Lang$space0, ps, _user$project$Lang$space0, _elm_lang$core$Maybe$Nothing, _user$project$Lang$space0));
};
var _user$project$Lang$pList = function (ps) {
	return _user$project$Lang$withDummyPatInfo(
		A5(_user$project$Lang$PList, _user$project$Lang$space1, ps, _user$project$Lang$space0, _elm_lang$core$Maybe$Nothing, _user$project$Lang$space0));
};
var _user$project$Lang$PBase = F2(
	function (a, b) {
		return {ctor: 'PBase', _0: a, _1: b};
	});
var _user$project$Lang$PConst = F2(
	function (a, b) {
		return {ctor: 'PConst', _0: a, _1: b};
	});
var _user$project$Lang$PVar = F3(
	function (a, b, c) {
		return {ctor: 'PVar', _0: a, _1: b, _2: c};
	});
var _user$project$Lang$mapPrecedingWhitespacePat = F2(
	function (stringMap, pat) {
		var mapWs = function (s) {
			return _user$project$Lang$ws(
				stringMap(s.val));
		};
		var p__ = function () {
			var _p147 = pat.val.p__;
			switch (_p147.ctor) {
				case 'PVar':
					return A3(
						_user$project$Lang$PVar,
						mapWs(_p147._0),
						_p147._1,
						_p147._2);
				case 'PConst':
					return A2(
						_user$project$Lang$PConst,
						mapWs(_p147._0),
						_p147._1);
				case 'PBase':
					return A2(
						_user$project$Lang$PBase,
						mapWs(_p147._0),
						_p147._1);
				case 'PList':
					return A5(
						_user$project$Lang$PList,
						mapWs(_p147._0),
						_p147._1,
						_p147._2,
						_p147._3,
						_p147._4);
				default:
					return A4(
						_user$project$Lang$PAs,
						mapWs(_p147._0),
						_p147._1,
						_p147._2,
						_p147._3);
			}
		}();
		return A2(_user$project$Lang$replaceP__, pat, p__);
	});
var _user$project$Lang$replacePrecedingWhitespacePat = F2(
	function (newWs, pat) {
		return A2(
			_user$project$Lang$mapPrecedingWhitespacePat,
			function (oldWs) {
				return newWs;
			},
			pat);
	});
var _user$project$Lang$replaceP__PreservingPrecedingWhitespace = F2(
	function (p, p__) {
		return A2(
			_user$project$Lang$replacePrecedingWhitespacePat,
			_user$project$Lang$precedingWhitespacePat(p),
			A2(_user$project$Lang$replaceP__, p, p__));
	});
var _user$project$Lang$copyPrecedingWhitespacePat = F2(
	function (source, target) {
		return A2(
			_user$project$Lang$replacePrecedingWhitespacePat,
			_user$project$Lang$precedingWhitespacePat(source),
			target);
	});
var _user$project$Lang$setPatListWhitespace = F3(
	function (firstWs, sepWs, pats) {
		var _p148 = pats;
		if (_p148.ctor === '[]') {
			return {ctor: '[]'};
		} else {
			return {
				ctor: '::',
				_0: A2(_user$project$Lang$replacePrecedingWhitespacePat, firstWs, _p148._0),
				_1: A2(
					_elm_lang$core$List$map,
					_user$project$Lang$replacePrecedingWhitespacePat(sepWs),
					_p148._1)
			};
		}
	});
var _user$project$Lang$imitatePatListWhitespace = F2(
	function (oldPats, newPats) {
		var _p149 = function () {
			var _p150 = oldPats;
			if (_p150.ctor === '::') {
				if (_p150._1.ctor === '::') {
					return {
						ctor: '_Tuple2',
						_0: _user$project$Lang$precedingWhitespacePat(_p150._0),
						_1: _user$project$Lang$precedingWhitespacePat(_p150._1._0)
					};
				} else {
					var _p151 = _p150._0;
					return {
						ctor: '_Tuple2',
						_0: _user$project$Lang$precedingWhitespacePat(_p151),
						_1: _elm_lang$core$Native_Utils.eq(
							_user$project$Lang$precedingWhitespacePat(_p151),
							'') ? ' ' : _user$project$Lang$precedingWhitespacePat(_p151)
					};
				}
			} else {
				return {ctor: '_Tuple2', _0: '', _1: ' '};
			}
		}();
		var firstWs = _p149._0;
		var sepWs = _p149._1;
		var _p152 = newPats;
		if (_p152.ctor === '[]') {
			return {ctor: '[]'};
		} else {
			var firstWithNewWs = A2(_user$project$Lang$replacePrecedingWhitespacePat, firstWs, _p152._0);
			var restWithNewWs = A2(
				_elm_lang$core$List$map,
				function (p) {
					return _elm_lang$core$Native_Utils.eq(
						_user$project$Lang$precedingWhitespacePat(p),
						'') ? A2(_user$project$Lang$replacePrecedingWhitespacePat, sepWs, p) : (A2(_elm_lang$core$List$member, p, oldPats) ? p : A2(_user$project$Lang$replacePrecedingWhitespacePat, sepWs, p));
				},
				_p152._1);
			return {ctor: '::', _0: firstWithNewWs, _1: restWithNewWs};
		}
	});
var _user$project$Lang$ensureWhitespacePat = function (pat) {
	return A2(_user$project$Lang$mapPrecedingWhitespacePat, _user$project$Lang$ensureWhitespace, pat);
};
var _user$project$Lang$DictInsert = {ctor: 'DictInsert'};
var _user$project$Lang$DictRemove = {ctor: 'DictRemove'};
var _user$project$Lang$DictGet = {ctor: 'DictGet'};
var _user$project$Lang$ArcTan2 = {ctor: 'ArcTan2'};
var _user$project$Lang$Pow = {ctor: 'Pow'};
var _user$project$Lang$Mod = {ctor: 'Mod'};
var _user$project$Lang$Eq = {ctor: 'Eq'};
var _user$project$Lang$Lt = {ctor: 'Lt'};
var _user$project$Lang$Div = {ctor: 'Div'};
var _user$project$Lang$Mult = {ctor: 'Mult'};
var _user$project$Lang$Minus = {ctor: 'Minus'};
var _user$project$Lang$Plus = {ctor: 'Plus'};
var _user$project$Lang$DebugLog = {ctor: 'DebugLog'};
var _user$project$Lang$Explode = {ctor: 'Explode'};
var _user$project$Lang$Sqrt = {ctor: 'Sqrt'};
var _user$project$Lang$ToStr = {ctor: 'ToStr'};
var _user$project$Lang$Round = {ctor: 'Round'};
var _user$project$Lang$Ceil = {ctor: 'Ceil'};
var _user$project$Lang$Floor = {ctor: 'Floor'};
var _user$project$Lang$ArcSin = {ctor: 'ArcSin'};
var _user$project$Lang$ArcCos = {ctor: 'ArcCos'};
var _user$project$Lang$Sin = {ctor: 'Sin'};
var _user$project$Lang$Cos = {ctor: 'Cos'};
var _user$project$Lang$DictEmpty = {ctor: 'DictEmpty'};
var _user$project$Lang$Pi = {ctor: 'Pi'};
var _user$project$Lang$ETypeAlias = F5(
	function (a, b, c, d, e) {
		return {ctor: 'ETypeAlias', _0: a, _1: b, _2: c, _3: d, _4: e};
	});
var _user$project$Lang$EColonType = F5(
	function (a, b, c, d, e) {
		return {ctor: 'EColonType', _0: a, _1: b, _2: c, _3: d, _4: e};
	});
var _user$project$Lang$eColonType = F2(
	function (e, t) {
		return _user$project$Lang$withDummyExpInfo(
			A5(
				_user$project$Lang$EColonType,
				_user$project$Lang$space1,
				e,
				_user$project$Lang$space1,
				_user$project$Lang$withDummyRange(t),
				_user$project$Lang$space0));
	});
var _user$project$Lang$ETyp = F5(
	function (a, b, c, d, e) {
		return {ctor: 'ETyp', _0: a, _1: b, _2: c, _3: d, _4: e};
	});
var _user$project$Lang$EOption = F5(
	function (a, b, c, d, e) {
		return {ctor: 'EOption', _0: a, _1: b, _2: c, _3: d, _4: e};
	});
var _user$project$Lang$EComment = F3(
	function (a, b, c) {
		return {ctor: 'EComment', _0: a, _1: b, _2: c};
	});
var _user$project$Lang$eComment = F2(
	function (a, b) {
		return _user$project$Lang$withDummyExpInfo(
			A3(_user$project$Lang$EComment, _user$project$Lang$space1, a, b));
	});
var _user$project$Lang$ELet = F7(
	function (a, b, c, d, e, f, g) {
		return {ctor: 'ELet', _0: a, _1: b, _2: c, _3: d, _4: e, _5: f, _6: g};
	});
var _user$project$Lang$ETypeCase = F4(
	function (a, b, c, d) {
		return {ctor: 'ETypeCase', _0: a, _1: b, _2: c, _3: d};
	});
var _user$project$Lang$ECase = F4(
	function (a, b, c, d) {
		return {ctor: 'ECase', _0: a, _1: b, _2: c, _3: d};
	});
var _user$project$Lang$EIf = F5(
	function (a, b, c, d, e) {
		return {ctor: 'EIf', _0: a, _1: b, _2: c, _3: d, _4: e};
	});
var _user$project$Lang$EList = F5(
	function (a, b, c, d, e) {
		return {ctor: 'EList', _0: a, _1: b, _2: c, _3: d, _4: e};
	});
var _user$project$Lang$ePair = F2(
	function (e1, e2) {
		return _user$project$Lang$withDummyExpInfo(
			A5(
				_user$project$Lang$EList,
				_user$project$Lang$space1,
				{
					ctor: '::',
					_0: e1,
					_1: {
						ctor: '::',
						_0: e2,
						_1: {ctor: '[]'}
					}
				},
				_user$project$Lang$space0,
				_elm_lang$core$Maybe$Nothing,
				_user$project$Lang$space0));
	});
var _user$project$Lang$eList0 = F2(
	function (a, b) {
		return _user$project$Lang$withDummyExpInfo(
			A5(_user$project$Lang$EList, _user$project$Lang$space0, a, _user$project$Lang$space0, b, _user$project$Lang$space0));
	});
var _user$project$Lang$eTuple0 = function (a) {
	return A2(_user$project$Lang$eList0, a, _elm_lang$core$Maybe$Nothing);
};
var _user$project$Lang$eList = F2(
	function (a, b) {
		return _user$project$Lang$withDummyExpInfo(
			A5(_user$project$Lang$EList, _user$project$Lang$space1, a, _user$project$Lang$space0, b, _user$project$Lang$space0));
	});
var _user$project$Lang$eTuple = function (a) {
	return A2(_user$project$Lang$eList, a, _elm_lang$core$Maybe$Nothing);
};
var _user$project$Lang$EOp = F4(
	function (a, b, c, d) {
		return {ctor: 'EOp', _0: a, _1: b, _2: c, _3: d};
	});
var _user$project$Lang$eOp = F2(
	function (op_, es) {
		return _user$project$Lang$withDummyExpInfo(
			A4(
				_user$project$Lang$EOp,
				_user$project$Lang$space1,
				_user$project$Lang$withDummyRange(op_),
				es,
				_user$project$Lang$space0));
	});
var _user$project$Lang$ePlus = F2(
	function (e1, e2) {
		return A2(
			_user$project$Lang$eOp,
			_user$project$Lang$Plus,
			{
				ctor: '::',
				_0: e1,
				_1: {
					ctor: '::',
					_0: e2,
					_1: {ctor: '[]'}
				}
			});
	});
var _user$project$Lang$eMinus = F2(
	function (e1, e2) {
		return A2(
			_user$project$Lang$eOp,
			_user$project$Lang$Minus,
			{
				ctor: '::',
				_0: e1,
				_1: {
					ctor: '::',
					_0: e2,
					_1: {ctor: '[]'}
				}
			});
	});
var _user$project$Lang$EApp = F4(
	function (a, b, c, d) {
		return {ctor: 'EApp', _0: a, _1: b, _2: c, _3: d};
	});
var _user$project$Lang$eApp = F2(
	function (e, es) {
		return _user$project$Lang$withDummyExpInfo(
			A4(_user$project$Lang$EApp, _user$project$Lang$space1, e, es, _user$project$Lang$space0));
	});
var _user$project$Lang$desugarEApp = F2(
	function (e, es) {
		desugarEApp:
		while (true) {
			var _p153 = es;
			if (_p153.ctor === '[]') {
				return _elm_lang$core$Native_Utils.crashCase(
					'Lang',
					{
						start: {line: 1564, column: 20},
						end: {line: 1567, column: 43}
					},
					_p153)('desugarEApp');
			} else {
				if (_p153._1.ctor === '[]') {
					return A2(
						_user$project$Lang$eApp,
						e,
						{
							ctor: '::',
							_0: _p153._0,
							_1: {ctor: '[]'}
						});
				} else {
					var _v87 = A2(
						_user$project$Lang$eApp,
						e,
						{
							ctor: '::',
							_0: _p153._0,
							_1: {ctor: '[]'}
						}),
						_v88 = _p153._1;
					e = _v87;
					es = _v88;
					continue desugarEApp;
				}
			}
		}
	});
var _user$project$Lang$EFun = F4(
	function (a, b, c, d) {
		return {ctor: 'EFun', _0: a, _1: b, _2: c, _3: d};
	});
var _user$project$Lang$eFun = F2(
	function (ps, e) {
		return _user$project$Lang$withDummyExpInfo(
			A4(_user$project$Lang$EFun, _user$project$Lang$space1, ps, e, _user$project$Lang$space0));
	});
var _user$project$Lang$desugarEFun = F2(
	function (ps, e) {
		var _p155 = ps;
		if (_p155.ctor === '[]') {
			return _elm_lang$core$Native_Utils.crashCase(
				'Lang',
				{
					start: {line: 1569, column: 20},
					end: {line: 1572, column: 42}
				},
				_p155)('desugarEFun');
		} else {
			if (_p155._1.ctor === '[]') {
				return A2(
					_user$project$Lang$eFun,
					{
						ctor: '::',
						_0: _p155._0,
						_1: {ctor: '[]'}
					},
					e);
			} else {
				return A2(
					_user$project$Lang$eFun,
					{
						ctor: '::',
						_0: _p155._0,
						_1: {ctor: '[]'}
					},
					A2(_user$project$Lang$desugarEFun, _p155._1, e));
			}
		}
	});
var _user$project$Lang$EVar = F2(
	function (a, b) {
		return {ctor: 'EVar', _0: a, _1: b};
	});
var _user$project$Lang$eVar0 = function (a) {
	return _user$project$Lang$withDummyExpInfo(
		A2(_user$project$Lang$EVar, _user$project$Lang$space0, a));
};
var _user$project$Lang$eRaw0 = _user$project$Lang$eVar0;
var _user$project$Lang$eVar = function (a) {
	return _user$project$Lang$withDummyExpInfo(
		A2(_user$project$Lang$EVar, _user$project$Lang$space1, a));
};
var _user$project$Lang$eRaw = _user$project$Lang$eVar;
var _user$project$Lang$listOfVars = function (xs) {
	var _p157 = xs;
	if (_p157.ctor === '[]') {
		return {ctor: '[]'};
	} else {
		return {
			ctor: '::',
			_0: _user$project$Lang$eVar0(_p157._0),
			_1: A2(_elm_lang$core$List$map, _user$project$Lang$eVar, _p157._1)
		};
	}
};
var _user$project$Lang$listOfRaw = _user$project$Lang$listOfVars;
var _user$project$Lang$eRaw__ = _user$project$Lang$EVar;
var _user$project$Lang$EBase = F2(
	function (a, b) {
		return {ctor: 'EBase', _0: a, _1: b};
	});
var _user$project$Lang$EConst = F4(
	function (a, b, c, d) {
		return {ctor: 'EConst', _0: a, _1: b, _2: c, _3: d};
	});
var _user$project$Lang$listOfAnnotatedNums1 = _elm_lang$core$List$map(
	function (_p158) {
		var _p159 = _p158;
		return _user$project$Lang$withDummyExpInfo(
			A4(
				_user$project$Lang$EConst,
				_user$project$Lang$space1,
				_p159._0,
				_user$project$Lang$dummyLoc_(_p159._1),
				_p159._2));
	});
var _user$project$Lang$listOfAnnotatedNums = function (list) {
	var _p160 = list;
	if (_p160.ctor === '[]') {
		return {ctor: '[]'};
	} else {
		return {
			ctor: '::',
			_0: _user$project$Lang$withDummyExpInfo(
				A4(
					_user$project$Lang$EConst,
					_user$project$Lang$space0,
					_p160._0._0,
					_user$project$Lang$dummyLoc_(_p160._0._1),
					_p160._0._2)),
			_1: _user$project$Lang$listOfAnnotatedNums1(_p160._1)
		};
	}
};
var _user$project$Lang$mapPrecedingWhitespace = F2(
	function (stringMap, exp) {
		var mapWs = function (s) {
			return _user$project$Lang$ws(
				stringMap(s.val));
		};
		var e__New = function () {
			var _p161 = exp.val.e__;
			switch (_p161.ctor) {
				case 'EBase':
					return A2(
						_user$project$Lang$EBase,
						mapWs(_p161._0),
						_p161._1);
				case 'EConst':
					return A4(
						_user$project$Lang$EConst,
						mapWs(_p161._0),
						_p161._1,
						_p161._2,
						_p161._3);
				case 'EVar':
					return A2(
						_user$project$Lang$EVar,
						mapWs(_p161._0),
						_p161._1);
				case 'EFun':
					return A4(
						_user$project$Lang$EFun,
						mapWs(_p161._0),
						_p161._1,
						_p161._2,
						_p161._3);
				case 'EApp':
					return A4(
						_user$project$Lang$EApp,
						mapWs(_p161._0),
						_p161._1,
						_p161._2,
						_p161._3);
				case 'EList':
					return A5(
						_user$project$Lang$EList,
						mapWs(_p161._0),
						_p161._1,
						_p161._2,
						_p161._3,
						_p161._4);
				case 'EOp':
					return A4(
						_user$project$Lang$EOp,
						mapWs(_p161._0),
						_p161._1,
						_p161._2,
						_p161._3);
				case 'EIf':
					return A5(
						_user$project$Lang$EIf,
						mapWs(_p161._0),
						_p161._1,
						_p161._2,
						_p161._3,
						_p161._4);
				case 'ELet':
					return A7(
						_user$project$Lang$ELet,
						mapWs(_p161._0),
						_p161._1,
						_p161._2,
						_p161._3,
						_p161._4,
						_p161._5,
						_p161._6);
				case 'ECase':
					return A4(
						_user$project$Lang$ECase,
						mapWs(_p161._0),
						_p161._1,
						_p161._2,
						_p161._3);
				case 'ETypeCase':
					return A4(
						_user$project$Lang$ETypeCase,
						mapWs(_p161._0),
						_p161._1,
						_p161._2,
						_p161._3);
				case 'EComment':
					return A3(
						_user$project$Lang$EComment,
						mapWs(_p161._0),
						_p161._1,
						_p161._2);
				case 'EOption':
					return A5(
						_user$project$Lang$EOption,
						mapWs(_p161._0),
						_p161._1,
						_p161._2,
						_p161._3,
						_p161._4);
				case 'ETyp':
					return A5(
						_user$project$Lang$ETyp,
						mapWs(_p161._0),
						_p161._1,
						_p161._2,
						_p161._3,
						_p161._4);
				case 'EColonType':
					return A5(
						_user$project$Lang$EColonType,
						mapWs(_p161._0),
						_p161._1,
						_p161._2,
						_p161._3,
						_p161._4);
				default:
					return A5(
						_user$project$Lang$ETypeAlias,
						mapWs(_p161._0),
						_p161._1,
						_p161._2,
						_p161._3,
						_p161._4);
			}
		}();
		return A2(_user$project$Lang$replaceE__, exp, e__New);
	});
var _user$project$Lang$addPrecedingWhitespace = F2(
	function (newWs, exp) {
		return A2(
			_user$project$Lang$mapPrecedingWhitespace,
			function (oldWs) {
				return A2(_elm_lang$core$Basics_ops['++'], oldWs, newWs);
			},
			exp);
	});
var _user$project$Lang$replacePrecedingWhitespace = F2(
	function (newWs, exp) {
		return A2(
			_user$project$Lang$mapPrecedingWhitespace,
			function (oldWs) {
				return newWs;
			},
			exp);
	});
var _user$project$Lang$replaceE__PreservingPrecedingWhitespace = F2(
	function (e, e__) {
		return A2(
			_user$project$Lang$replacePrecedingWhitespace,
			_user$project$Lang$precedingWhitespace(e),
			A2(_user$project$Lang$replaceE__, e, e__));
	});
var _user$project$Lang$copyPrecedingWhitespace = F2(
	function (source, target) {
		return A2(
			_user$project$Lang$replacePrecedingWhitespace,
			_user$project$Lang$precedingWhitespace(source),
			target);
	});
var _user$project$Lang$setExpListWhitespace = F3(
	function (firstWs, sepWs, exps) {
		var _p162 = exps;
		if (_p162.ctor === '[]') {
			return {ctor: '[]'};
		} else {
			return {
				ctor: '::',
				_0: A2(_user$project$Lang$replacePrecedingWhitespace, firstWs, _p162._0),
				_1: A2(
					_elm_lang$core$List$map,
					_user$project$Lang$replacePrecedingWhitespace(sepWs),
					_p162._1)
			};
		}
	});
var _user$project$Lang$imitateExpListWhitespace = F2(
	function (oldExps, newExps) {
		var _p163 = function () {
			var _p164 = oldExps;
			if (_p164.ctor === '::') {
				if (_p164._1.ctor === '::') {
					return {
						ctor: '_Tuple2',
						_0: _user$project$Lang$precedingWhitespace(_p164._0),
						_1: _user$project$Lang$precedingWhitespace(_p164._1._0)
					};
				} else {
					var _p165 = _p164._0;
					return {
						ctor: '_Tuple2',
						_0: _user$project$Lang$precedingWhitespace(_p165),
						_1: _elm_lang$core$Native_Utils.eq(
							_user$project$Lang$precedingWhitespace(_p165),
							'') ? ' ' : _user$project$Lang$precedingWhitespace(_p165)
					};
				}
			} else {
				return {ctor: '_Tuple2', _0: '', _1: ' '};
			}
		}();
		var firstWs = _p163._0;
		var sepWs = _p163._1;
		var _p166 = newExps;
		if (_p166.ctor === '[]') {
			return {ctor: '[]'};
		} else {
			var firstWithNewWs = A2(_user$project$Lang$replacePrecedingWhitespace, firstWs, _p166._0);
			var restWithNewWs = A2(
				_elm_lang$core$List$map,
				function (e) {
					return _elm_lang$core$Native_Utils.eq(
						_user$project$Lang$precedingWhitespace(e),
						'') ? A2(_user$project$Lang$replacePrecedingWhitespace, sepWs, e) : (A2(_elm_lang$core$List$member, e, oldExps) ? e : A2(_user$project$Lang$replacePrecedingWhitespace, sepWs, e));
				},
				_p166._1);
			return {ctor: '::', _0: firstWithNewWs, _1: restWithNewWs};
		}
	});
var _user$project$Lang$ensureWhitespaceExp = function (exp) {
	return A2(_user$project$Lang$mapPrecedingWhitespace, _user$project$Lang$ensureWhitespace, exp);
};
var _user$project$Lang$ensureWhitespaceNNewlinesExp = F2(
	function (n, exp) {
		return A2(
			_user$project$Lang$mapPrecedingWhitespace,
			_user$project$Lang$ensureWhitespaceNNewlines(n),
			exp);
	});
var _user$project$Lang$ensureWhitespaceNewlineExp = function (exp) {
	return A2(_user$project$Lang$ensureWhitespaceNNewlinesExp, 1, exp);
};
var _user$project$Lang$ensureNNewlinesExp = F3(
	function (n, indentationIfNoPreviousNewlines, exp) {
		return A2(
			_user$project$Lang$mapPrecedingWhitespace,
			A2(_user$project$Lang$ensureNNewlines, n, indentationIfNoPreviousNewlines),
			exp);
	});
var _user$project$Lang$TWildcard = function (a) {
	return {ctor: 'TWildcard', _0: a};
};
var _user$project$Lang$TForall = F4(
	function (a, b, c, d) {
		return {ctor: 'TForall', _0: a, _1: b, _2: c, _3: d};
	});
var _user$project$Lang$TVar = F2(
	function (a, b) {
		return {ctor: 'TVar', _0: a, _1: b};
	});
var _user$project$Lang$TNamed = F2(
	function (a, b) {
		return {ctor: 'TNamed', _0: a, _1: b};
	});
var _user$project$Lang$TUnion = F3(
	function (a, b, c) {
		return {ctor: 'TUnion', _0: a, _1: b, _2: c};
	});
var _user$project$Lang$TArrow = F3(
	function (a, b, c) {
		return {ctor: 'TArrow', _0: a, _1: b, _2: c};
	});
var _user$project$Lang$TTuple = F5(
	function (a, b, c, d, e) {
		return {ctor: 'TTuple', _0: a, _1: b, _2: c, _3: d, _4: e};
	});
var _user$project$Lang$TDict = F4(
	function (a, b, c, d) {
		return {ctor: 'TDict', _0: a, _1: b, _2: c, _3: d};
	});
var _user$project$Lang$TList = F3(
	function (a, b, c) {
		return {ctor: 'TList', _0: a, _1: b, _2: c};
	});
var _user$project$Lang$mapType = F2(
	function (f, tipe) {
		var recurse = _user$project$Lang$mapType(f);
		var wrap = function (t_) {
			return A3(_user$project$Lang$WithInfo, t_, tipe.start, tipe.end);
		};
		var _p167 = tipe.val;
		switch (_p167.ctor) {
			case 'TNum':
				return f(tipe);
			case 'TBool':
				return f(tipe);
			case 'TString':
				return f(tipe);
			case 'TNull':
				return f(tipe);
			case 'TNamed':
				return f(tipe);
			case 'TVar':
				return f(tipe);
			case 'TWildcard':
				return f(tipe);
			case 'TList':
				return f(
					wrap(
						A3(
							_user$project$Lang$TList,
							_p167._0,
							recurse(_p167._1),
							_p167._2)));
			case 'TDict':
				return f(
					wrap(
						A4(
							_user$project$Lang$TDict,
							_p167._0,
							recurse(_p167._1),
							recurse(_p167._2),
							_p167._3)));
			case 'TArrow':
				return f(
					wrap(
						A3(
							_user$project$Lang$TArrow,
							_p167._0,
							A2(_elm_lang$core$List$map, recurse, _p167._1),
							_p167._2)));
			case 'TUnion':
				return f(
					wrap(
						A3(
							_user$project$Lang$TUnion,
							_p167._0,
							A2(_elm_lang$core$List$map, recurse, _p167._1),
							_p167._2)));
			case 'TForall':
				return f(
					wrap(
						A4(
							_user$project$Lang$TForall,
							_p167._0,
							_p167._1,
							recurse(_p167._2),
							_p167._3)));
			default:
				return f(
					wrap(
						A5(
							_user$project$Lang$TTuple,
							_p167._0,
							A2(_elm_lang$core$List$map, recurse, _p167._1),
							_p167._2,
							A2(_user$project$Utils$mapMaybe, recurse, _p167._3),
							_p167._4)));
		}
	});
var _user$project$Lang$TNull = function (a) {
	return {ctor: 'TNull', _0: a};
};
var _user$project$Lang$TString = function (a) {
	return {ctor: 'TString', _0: a};
};
var _user$project$Lang$TBool = function (a) {
	return {ctor: 'TBool', _0: a};
};
var _user$project$Lang$TNum = function (a) {
	return {ctor: 'TNum', _0: a};
};
var _user$project$Lang$Many = F3(
	function (a, b, c) {
		return {ctor: 'Many', _0: a, _1: b, _2: c};
	});
var _user$project$Lang$One = function (a) {
	return {ctor: 'One', _0: a};
};
var _user$project$Lang$Branch_ = F4(
	function (a, b, c, d) {
		return {ctor: 'Branch_', _0: a, _1: b, _2: c, _3: d};
	});
var _user$project$Lang$mapBranchPats = F2(
	function (f, branches) {
		return A2(
			_elm_lang$core$List$map,
			function (branch) {
				var _p168 = branch.val;
				var ws1 = _p168._0;
				var pat = _p168._1;
				var exp = _p168._2;
				var ws2 = _p168._3;
				return _elm_lang$core$Native_Utils.update(
					branch,
					{
						val: A4(
							_user$project$Lang$Branch_,
							ws1,
							f(pat),
							exp,
							ws2)
					});
			},
			branches);
	});
var _user$project$Lang$clearNodeIds = function (e) {
	var eidCleared = _user$project$Lang$clearEId(e);
	var _p169 = eidCleared.val.e__;
	_v98_7:
	do {
		switch (_p169.ctor) {
			case 'EConst':
				if (_p169._2.ctor === '_Tuple3') {
					return A2(
						_user$project$Lang$replaceE__,
						eidCleared,
						A4(
							_user$project$Lang$EConst,
							_p169._0,
							_p169._1,
							{ctor: '_Tuple3', _0: 0, _1: _p169._2._1, _2: ''},
							_p169._3));
				} else {
					break _v98_7;
				}
			case 'ELet':
				return A2(
					_user$project$Lang$replaceE__,
					eidCleared,
					A7(
						_user$project$Lang$ELet,
						_p169._0,
						_p169._1,
						_p169._2,
						_user$project$Lang$clearPIds(_p169._3),
						_p169._4,
						_p169._5,
						_p169._6));
			case 'EFun':
				return A2(
					_user$project$Lang$replaceE__,
					eidCleared,
					A4(
						_user$project$Lang$EFun,
						_p169._0,
						A2(_elm_lang$core$List$map, _user$project$Lang$clearPIds, _p169._1),
						_p169._2,
						_p169._3));
			case 'ECase':
				return A2(
					_user$project$Lang$replaceE__,
					eidCleared,
					A4(
						_user$project$Lang$ECase,
						_p169._0,
						_p169._1,
						A2(_user$project$Lang$mapBranchPats, _user$project$Lang$clearPIds, _p169._2),
						_p169._3));
			case 'ETypeCase':
				return A2(
					_user$project$Lang$replaceE__,
					eidCleared,
					A4(
						_user$project$Lang$ETypeCase,
						_p169._0,
						_user$project$Lang$clearPIds(_p169._1),
						_p169._2,
						_p169._3));
			case 'ETyp':
				return A2(
					_user$project$Lang$replaceE__,
					eidCleared,
					A5(
						_user$project$Lang$ETyp,
						_p169._0,
						_user$project$Lang$clearPIds(_p169._1),
						_p169._2,
						_p169._3,
						_p169._4));
			case 'ETypeAlias':
				return A2(
					_user$project$Lang$replaceE__,
					eidCleared,
					A5(
						_user$project$Lang$ETypeAlias,
						_p169._0,
						_user$project$Lang$clearPIds(_p169._1),
						_p169._2,
						_p169._3,
						_p169._4));
			default:
				break _v98_7;
		}
	} while(false);
	return eidCleared;
};
var _user$project$Lang$replaceBranchExp = F2(
	function (branch, exp) {
		var _p170 = branch.val;
		var bws1 = _p170._0;
		var p = _p170._1;
		var bws2 = _p170._3;
		return _elm_lang$core$Native_Utils.update(
			branch,
			{
				val: A4(_user$project$Lang$Branch_, bws1, p, exp, bws2)
			});
	});
var _user$project$Lang$TBranch_ = F4(
	function (a, b, c, d) {
		return {ctor: 'TBranch_', _0: a, _1: b, _2: c, _3: d};
	});
var _user$project$Lang$mapFoldExp = F3(
	function (f, initAcc, e) {
		var recurse = _user$project$Lang$mapFoldExp(f);
		var wrap = function (e__) {
			return A2(_user$project$Lang$replaceE__, e, e__);
		};
		var wrapAndMap = function (_p171) {
			return f(
				wrap(_p171));
		};
		var recurseAll = F2(
			function (initAcc, exps) {
				return A3(
					_elm_lang$core$List$foldr,
					F2(
						function (exp, _p172) {
							var _p173 = _p172;
							var _p174 = A2(recurse, _p173._1, exp);
							var newExp = _p174._0;
							var newAcc = _p174._1;
							return {
								ctor: '_Tuple2',
								_0: {ctor: '::', _0: newExp, _1: _p173._0},
								_1: newAcc
							};
						}),
					{
						ctor: '_Tuple2',
						_0: {ctor: '[]'},
						_1: initAcc
					},
					exps);
			});
		var _p175 = e.val.e__;
		switch (_p175.ctor) {
			case 'EConst':
				return A2(f, e, initAcc);
			case 'EBase':
				return A2(f, e, initAcc);
			case 'EVar':
				return A2(f, e, initAcc);
			case 'EFun':
				var _p176 = A2(recurse, initAcc, _p175._2);
				var newE1 = _p176._0;
				var newAcc = _p176._1;
				return A2(
					wrapAndMap,
					A4(_user$project$Lang$EFun, _p175._0, _p175._1, newE1, _p175._3),
					newAcc);
			case 'EApp':
				var _p177 = A2(recurseAll, initAcc, _p175._2);
				var newEs = _p177._0;
				var newAcc = _p177._1;
				var _p178 = A2(recurse, newAcc, _p175._1);
				var newE1 = _p178._0;
				var newAcc2 = _p178._1;
				return A2(
					wrapAndMap,
					A4(_user$project$Lang$EApp, _p175._0, newE1, newEs, _p175._3),
					newAcc2);
			case 'EOp':
				var _p179 = A2(recurseAll, initAcc, _p175._2);
				var newEs = _p179._0;
				var newAcc = _p179._1;
				return A2(
					wrapAndMap,
					A4(_user$project$Lang$EOp, _p175._0, _p175._1, newEs, _p175._3),
					newAcc);
			case 'EList':
				if (_p175._3.ctor === 'Nothing') {
					var _p180 = A2(recurseAll, initAcc, _p175._1);
					var newEs = _p180._0;
					var newAcc = _p180._1;
					return A2(
						wrapAndMap,
						A5(_user$project$Lang$EList, _p175._0, newEs, _p175._2, _elm_lang$core$Maybe$Nothing, _p175._4),
						newAcc);
				} else {
					var _p181 = A2(recurse, initAcc, _p175._3._0);
					var newE1 = _p181._0;
					var newAcc = _p181._1;
					var _p182 = A2(recurseAll, newAcc, _p175._1);
					var newEs = _p182._0;
					var newAcc2 = _p182._1;
					return A2(
						wrapAndMap,
						A5(
							_user$project$Lang$EList,
							_p175._0,
							newEs,
							_p175._2,
							_elm_lang$core$Maybe$Just(newE1),
							_p175._4),
						newAcc2);
				}
			case 'EIf':
				var _p183 = A2(
					recurseAll,
					initAcc,
					{
						ctor: '::',
						_0: _p175._1,
						_1: {
							ctor: '::',
							_0: _p175._2,
							_1: {
								ctor: '::',
								_0: _p175._3,
								_1: {ctor: '[]'}
							}
						}
					});
				if (((((_p183.ctor === '_Tuple2') && (_p183._0.ctor === '::')) && (_p183._0._1.ctor === '::')) && (_p183._0._1._1.ctor === '::')) && (_p183._0._1._1._1.ctor === '[]')) {
					return A2(
						wrapAndMap,
						A5(_user$project$Lang$EIf, _p175._0, _p183._0._0, _p183._0._1._0, _p183._0._1._1._0, _p175._4),
						_p183._1);
				} else {
					return _elm_lang$core$Native_Utils.crashCase(
						'Lang',
						{
							start: {line: 553, column: 7},
							end: {line: 555, column: 116}
						},
						_p183)('I\'ll buy you a beer if this line of code executes. - Brian');
				}
			case 'ECase':
				var _p185 = A3(
					_elm_lang$core$List$foldr,
					F2(
						function (branch, _p186) {
							var _p187 = _p186;
							var _p188 = branch.val;
							var bws1 = _p188._0;
							var p = _p188._1;
							var ei = _p188._2;
							var bws2 = _p188._3;
							var _p189 = A2(recurse, _p187._1, ei);
							var newEi = _p189._0;
							var newAcc = _p189._1;
							return {
								ctor: '_Tuple2',
								_0: {
									ctor: '::',
									_0: _elm_lang$core$Native_Utils.update(
										branch,
										{
											val: A4(_user$project$Lang$Branch_, bws1, p, newEi, bws2)
										}),
									_1: _p187._0
								},
								_1: newAcc
							};
						}),
					{
						ctor: '_Tuple2',
						_0: {ctor: '[]'},
						_1: initAcc
					},
					_p175._2);
				var newBranches = _p185._0;
				var newAcc = _p185._1;
				var _p190 = A2(recurse, newAcc, _p175._1);
				var newE1 = _p190._0;
				var newAcc2 = _p190._1;
				return A2(
					wrapAndMap,
					A4(_user$project$Lang$ECase, _p175._0, newE1, newBranches, _p175._3),
					newAcc2);
			case 'ETypeCase':
				var _p191 = A3(
					_elm_lang$core$List$foldr,
					F2(
						function (tbranch, _p192) {
							var _p193 = _p192;
							var _p194 = tbranch.val;
							var bws1 = _p194._0;
							var t = _p194._1;
							var ei = _p194._2;
							var bws2 = _p194._3;
							var _p195 = A2(recurse, _p193._1, ei);
							var newEi = _p195._0;
							var newAcc = _p195._1;
							return {
								ctor: '_Tuple2',
								_0: {
									ctor: '::',
									_0: _elm_lang$core$Native_Utils.update(
										tbranch,
										{
											val: A4(_user$project$Lang$TBranch_, bws1, t, newEi, bws2)
										}),
									_1: _p193._0
								},
								_1: newAcc
							};
						}),
					{
						ctor: '_Tuple2',
						_0: {ctor: '[]'},
						_1: initAcc
					},
					_p175._2);
				var newBranches = _p191._0;
				var newAcc = _p191._1;
				return A2(
					wrapAndMap,
					A4(_user$project$Lang$ETypeCase, _p175._0, _p175._1, newBranches, _p175._3),
					newAcc);
			case 'EComment':
				var _p196 = A2(recurse, initAcc, _p175._2);
				var newE1 = _p196._0;
				var newAcc = _p196._1;
				return A2(
					wrapAndMap,
					A3(_user$project$Lang$EComment, _p175._0, _p175._1, newE1),
					newAcc);
			case 'EOption':
				var _p197 = A2(recurse, initAcc, _p175._4);
				var newE1 = _p197._0;
				var newAcc = _p197._1;
				return A2(
					wrapAndMap,
					A5(_user$project$Lang$EOption, _p175._0, _p175._1, _p175._2, _p175._3, newE1),
					newAcc);
			case 'ELet':
				var _p198 = A2(recurse, initAcc, _p175._5);
				var newE2 = _p198._0;
				var newAcc = _p198._1;
				var _p199 = A2(recurse, newAcc, _p175._4);
				var newE1 = _p199._0;
				var newAcc2 = _p199._1;
				return A2(
					wrapAndMap,
					A7(_user$project$Lang$ELet, _p175._0, _p175._1, _p175._2, _p175._3, newE1, newE2, _p175._6),
					newAcc2);
			case 'ETyp':
				var _p200 = A2(recurse, initAcc, _p175._3);
				var newE1 = _p200._0;
				var newAcc = _p200._1;
				return A2(
					wrapAndMap,
					A5(_user$project$Lang$ETyp, _p175._0, _p175._1, _p175._2, newE1, _p175._4),
					newAcc);
			case 'EColonType':
				var _p201 = A2(recurse, initAcc, _p175._1);
				var newE1 = _p201._0;
				var newAcc = _p201._1;
				return A2(
					wrapAndMap,
					A5(_user$project$Lang$EColonType, _p175._0, newE1, _p175._2, _p175._3, _p175._4),
					newAcc);
			default:
				var _p202 = A2(recurse, initAcc, _p175._3);
				var newE1 = _p202._0;
				var newAcc = _p202._1;
				return A2(
					wrapAndMap,
					A5(_user$project$Lang$ETypeAlias, _p175._0, _p175._1, _p175._2, newE1, _p175._4),
					newAcc);
		}
	});
var _user$project$Lang$mapExp = F2(
	function (f, e) {
		var _p203 = A3(
			_user$project$Lang$mapFoldExp,
			F2(
				function (exp, _p204) {
					return {
						ctor: '_Tuple2',
						_0: f(exp),
						_1: {ctor: '_Tuple0'}
					};
				}),
			{ctor: '_Tuple0'},
			e);
		var newExp = _p203._0;
		return newExp;
	});
var _user$project$Lang$mapExpViaExp__ = F2(
	function (f, e) {
		var f_ = function (exp) {
			return A2(
				_user$project$Lang$replaceE__,
				exp,
				f(exp.val.e__));
		};
		return A2(_user$project$Lang$mapExp, f_, e);
	});
var _user$project$Lang$mapPatNode = F3(
	function (pid, f, root) {
		return A2(
			_user$project$Lang$mapExpViaExp__,
			function (e__) {
				var _p205 = e__;
				switch (_p205.ctor) {
					case 'ELet':
						return A7(
							_user$project$Lang$ELet,
							_p205._0,
							_p205._1,
							_p205._2,
							A3(_user$project$Lang$mapPatNodePat, pid, f, _p205._3),
							_p205._4,
							_p205._5,
							_p205._6);
					case 'EFun':
						return A4(
							_user$project$Lang$EFun,
							_p205._0,
							A2(
								_elm_lang$core$List$map,
								A2(_user$project$Lang$mapPatNodePat, pid, f),
								_p205._1),
							_p205._2,
							_p205._3);
					case 'ECase':
						return A4(
							_user$project$Lang$ECase,
							_p205._0,
							_p205._1,
							A2(
								_user$project$Lang$mapBranchPats,
								A2(_user$project$Lang$mapPatNodePat, pid, f),
								_p205._2),
							_p205._3);
					case 'ETypeCase':
						return A4(
							_user$project$Lang$ETypeCase,
							_p205._0,
							A3(_user$project$Lang$mapPatNodePat, pid, f, _p205._1),
							_p205._2,
							_p205._3);
					default:
						return e__;
				}
			},
			root);
	});
var _user$project$Lang$replacePatNodePreservingPrecedingWhitespace = F3(
	function (pid, newPat, root) {
		return A3(
			_user$project$Lang$mapPatNode,
			pid,
			function (pat) {
				return A2(
					_user$project$Lang$replacePrecedingWhitespacePat,
					_user$project$Lang$precedingWhitespacePat(pat),
					newPat);
			},
			root);
	});
var _user$project$Lang$mapExpNode = F3(
	function (eid, f, root) {
		return A2(
			_user$project$Lang$mapExp,
			function (exp) {
				return _elm_lang$core$Native_Utils.eq(exp.val.eid, eid) ? f(exp) : exp;
			},
			root);
	});
var _user$project$Lang$replaceExpNode = F3(
	function (eid, newNode, root) {
		return A3(
			_user$project$Lang$mapExpNode,
			eid,
			_elm_lang$core$Basics$always(newNode),
			root);
	});
var _user$project$Lang$replaceExpNodePreservingPrecedingWhitespace = F3(
	function (eid, newNode, root) {
		return A3(
			_user$project$Lang$mapExpNode,
			eid,
			function (exp) {
				return A2(
					_user$project$Lang$replacePrecedingWhitespace,
					_user$project$Lang$precedingWhitespace(exp),
					newNode);
			},
			root);
	});
var _user$project$Lang$applySubst = F2(
	function (subst, exp) {
		var replacer = function (e) {
			var e__ConstReplaced = function () {
				var e__ = e.val.e__;
				var _p206 = e__;
				if (_p206.ctor === 'EConst') {
					var _p208 = _p206._2;
					var locId = _user$project$Utils$fst3(_p208);
					var _p207 = A2(_elm_lang$core$Dict$get, locId, subst.lsubst);
					if (_p207.ctor === 'Just') {
						return A4(_user$project$Lang$EConst, _p206._0, _p207._0, _p208, _p206._3);
					} else {
						return e__;
					}
				} else {
					return e__;
				}
			}();
			var e__New = function () {
				var _p209 = A2(_elm_lang$core$Dict$get, e.val.eid, subst.esubst);
				if (_p209.ctor === 'Just') {
					return _p209._0;
				} else {
					return e__ConstReplaced;
				}
			}();
			return A2(_user$project$Lang$replaceE__, e, e__New);
		};
		return A2(_user$project$Lang$mapExp, replacer, exp);
	});
var _user$project$Lang$applyLocSubst = function (s) {
	return _user$project$Lang$applySubst(
		{lsubst: s, esubst: _elm_lang$core$Dict$empty});
};
var _user$project$Lang$applyESubst = function (s) {
	return _user$project$Lang$applySubst(
		{lsubst: _elm_lang$core$Dict$empty, esubst: s});
};
var _user$project$Lang$replaceExpNodeE__ByEId = F3(
	function (eid, newE__, root) {
		var esubst = A2(_elm_lang$core$Dict$singleton, eid, newE__);
		return A2(_user$project$Lang$applyESubst, esubst, root);
	});
var _user$project$Lang$replaceExpNodeE__ = F3(
	function (oldNode, newE__, root) {
		return A3(_user$project$Lang$replaceExpNodeE__ByEId, oldNode.val.eid, newE__, root);
	});
var _user$project$Lang$applyESubstPreservingPrecedingWhitespace = F2(
	function (esubst, exp) {
		var replacer = function (e) {
			var _p210 = A2(_elm_lang$core$Dict$get, e.val.eid, esubst);
			if (_p210.ctor === 'Just') {
				return A2(_user$project$Lang$replaceE__PreservingPrecedingWhitespace, e, _p210._0);
			} else {
				return e;
			}
		};
		return A2(_user$project$Lang$mapExp, replacer, exp);
	});
var _user$project$Lang$applyIndentationDelta = F2(
	function (delta, exp) {
		var processWS = function (ws) {
			return A4(
				_elm_lang$core$Regex$replace,
				_elm_lang$core$Regex$AtMost(1),
				_elm_lang$core$Regex$regex('\n[ \t]*$'),
				function (match) {
					var priorSpacesCount = _elm_lang$core$String$length(
						_user$project$Lang$tabsToSpaces(
							A2(_elm_lang$core$String$dropLeft, 1, match.match)));
					return A2(
						_elm_lang$core$Basics_ops['++'],
						'\n',
						A2(_elm_lang$core$String$repeat, priorSpacesCount + delta, ' '));
				},
				ws);
		};
		return A2(
			_user$project$Lang$mapExp,
			_user$project$Lang$mapPrecedingWhitespace(processWS),
			exp);
	});
var _user$project$Lang$copyIndentationChange = F3(
	function (exp1, exp2, exp) {
		var delta = _elm_lang$core$String$length(
			_user$project$Lang$tabsToSpaces(
				_user$project$Lang$indentationOf(exp2))) - _elm_lang$core$String$length(
			_user$project$Lang$tabsToSpaces(
				_user$project$Lang$indentationOf(exp1)));
		return A2(_user$project$Lang$applyIndentationDelta, delta, exp);
	});
var _user$project$Lang$unindent = function (exp) {
	var expWsAsSpaces = A2(
		_user$project$Lang$mapExp,
		_user$project$Lang$mapPrecedingWhitespace(_user$project$Lang$tabsToSpaces),
		exp);
	var smallestIndentation = A3(
		_user$project$Lang$foldExpViaE__,
		F2(
			function (e__, smallest) {
				var _p211 = _elm_lang$core$List$concat(
					A2(
						_elm_lang$core$List$map,
						function (_) {
							return _.submatches;
						},
						A3(
							_elm_lang$core$Regex$find,
							_elm_lang$core$Regex$All,
							_elm_lang$core$Regex$regex('\n( *)$'),
							_user$project$Lang$precedingWhitespaceExp__(e__))));
				if (((_p211.ctor === '::') && (_p211._0.ctor === 'Just')) && (_p211._1.ctor === '[]')) {
					var _p212 = _p211._0._0;
					return (_elm_lang$core$Native_Utils.cmp(
						_elm_lang$core$String$length(_p212),
						_elm_lang$core$String$length(smallest)) < 0) ? _p212 : smallest;
				} else {
					return smallest;
				}
			}),
		A2(_elm_lang$core$String$repeat, 100, ' '),
		expWsAsSpaces);
	var removeIndentation = function (ws) {
		return A4(
			_elm_lang$core$Regex$replace,
			_elm_lang$core$Regex$All,
			_elm_lang$core$Regex$regex(
				A2(_elm_lang$core$Basics_ops['++'], '\n', smallestIndentation)),
			function (_p213) {
				return '\n';
			},
			ws);
	};
	return A2(
		_user$project$Lang$mapExp,
		_user$project$Lang$mapPrecedingWhitespace(removeIndentation),
		expWsAsSpaces);
};
var _user$project$Lang$indent = F2(
	function (spaces, e) {
		var processWS = function (ws) {
			return _elm_lang$core$String$reverse(
				A4(
					_elm_lang$core$Regex$replace,
					_elm_lang$core$Regex$AtMost(1),
					_elm_lang$core$Regex$regex('\n'),
					function (_p214) {
						return A2(_elm_lang$core$Basics_ops['++'], spaces, '\n');
					},
					_elm_lang$core$String$reverse(ws)));
		};
		return A2(
			_user$project$Lang$mapExp,
			_user$project$Lang$mapPrecedingWhitespace(processWS),
			e);
	});
var _user$project$Lang$replaceIndentation = F2(
	function (spaces, exp) {
		return A2(
			_user$project$Lang$indent,
			spaces,
			_user$project$Lang$unindent(exp));
	});
var _user$project$Lang$ensureWhitespaceSmartExp = F3(
	function (newlineCountIfMultiline, indentationIfMultiline, exp) {
		return (_user$project$Lang$isLet(exp) || A2(
			_elm_lang$core$List$any,
			function (_p215) {
				return A2(
					_elm_lang$core$String$contains,
					'\n',
					_user$project$Lang$precedingWhitespace(_p215));
			},
			_user$project$Lang$flattenExpTree(exp))) ? A2(
			_user$project$Lang$replaceIndentation,
			indentationIfMultiline,
			A2(_user$project$Lang$ensureWhitespaceNNewlinesExp, newlineCountIfMultiline, exp)) : _user$project$Lang$ensureWhitespaceExp(exp);
	});
var _user$project$Lang$pushRight = F2(
	function (spaces, e) {
		return A2(
			_user$project$Lang$replacePrecedingWhitespace,
			A2(
				_elm_lang$core$Basics_ops['++'],
				_user$project$Lang$precedingWhitespace(e),
				spaces),
			A2(_user$project$Lang$indent, spaces, e));
	});
var _user$project$Lang$mapFoldExpTopDown = F3(
	function (f, initAcc, e) {
		var _p216 = A2(f, e, initAcc);
		var newE = _p216._0;
		var newAcc = _p216._1;
		var ret = F2(
			function (e__, acc) {
				return {
					ctor: '_Tuple2',
					_0: A2(_user$project$Lang$replaceE__, newE, e__),
					_1: acc
				};
			});
		var recurse = F2(
			function (acc, child) {
				return A3(_user$project$Lang$mapFoldExpTopDown, f, acc, child);
			});
		var recurseAll = F2(
			function (acc, exps) {
				return A3(
					_elm_lang$core$List$foldl,
					F2(
						function (exp, _p217) {
							var _p218 = _p217;
							var _p219 = A2(recurse, _p218._1, exp);
							var newExp = _p219._0;
							var newAcc = _p219._1;
							return {
								ctor: '_Tuple2',
								_0: A2(
									_elm_lang$core$Basics_ops['++'],
									_p218._0,
									{
										ctor: '::',
										_0: newExp,
										_1: {ctor: '[]'}
									}),
								_1: newAcc
							};
						}),
					{
						ctor: '_Tuple2',
						_0: {ctor: '[]'},
						_1: acc
					},
					exps);
			});
		var _p220 = newE.val.e__;
		switch (_p220.ctor) {
			case 'EConst':
				return {ctor: '_Tuple2', _0: newE, _1: newAcc};
			case 'EBase':
				return {ctor: '_Tuple2', _0: newE, _1: newAcc};
			case 'EVar':
				return {ctor: '_Tuple2', _0: newE, _1: newAcc};
			case 'EFun':
				var _p221 = A2(recurse, newAcc, _p220._2);
				var newE1 = _p221._0;
				var newAcc2 = _p221._1;
				return A2(
					ret,
					A4(_user$project$Lang$EFun, _p220._0, _p220._1, newE1, _p220._3),
					newAcc2);
			case 'EApp':
				var _p222 = A2(recurse, newAcc, _p220._1);
				var newE1 = _p222._0;
				var newAcc2 = _p222._1;
				var _p223 = A2(recurseAll, newAcc2, _p220._2);
				var newEs = _p223._0;
				var newAcc3 = _p223._1;
				return A2(
					ret,
					A4(_user$project$Lang$EApp, _p220._0, newE1, newEs, _p220._3),
					newAcc3);
			case 'EOp':
				var _p224 = A2(recurseAll, newAcc, _p220._2);
				var newEs = _p224._0;
				var newAcc2 = _p224._1;
				return A2(
					ret,
					A4(_user$project$Lang$EOp, _p220._0, _p220._1, newEs, _p220._3),
					newAcc2);
			case 'EList':
				if (_p220._3.ctor === 'Nothing') {
					var _p225 = A2(recurseAll, newAcc, _p220._1);
					var newEs = _p225._0;
					var newAcc2 = _p225._1;
					return A2(
						ret,
						A5(_user$project$Lang$EList, _p220._0, newEs, _p220._2, _elm_lang$core$Maybe$Nothing, _p220._4),
						newAcc2);
				} else {
					var _p226 = A2(recurseAll, newAcc, _p220._1);
					var newEs = _p226._0;
					var newAcc2 = _p226._1;
					var _p227 = A2(recurse, newAcc2, _p220._3._0);
					var newE1 = _p227._0;
					var newAcc3 = _p227._1;
					return A2(
						ret,
						A5(
							_user$project$Lang$EList,
							_p220._0,
							newEs,
							_p220._2,
							_elm_lang$core$Maybe$Just(newE1),
							_p220._4),
						newAcc3);
				}
			case 'EIf':
				var _p228 = A2(
					recurseAll,
					newAcc,
					{
						ctor: '::',
						_0: _p220._1,
						_1: {
							ctor: '::',
							_0: _p220._2,
							_1: {
								ctor: '::',
								_0: _p220._3,
								_1: {ctor: '[]'}
							}
						}
					});
				if (((((_p228.ctor === '_Tuple2') && (_p228._0.ctor === '::')) && (_p228._0._1.ctor === '::')) && (_p228._0._1._1.ctor === '::')) && (_p228._0._1._1._1.ctor === '[]')) {
					return A2(
						ret,
						A5(_user$project$Lang$EIf, _p220._0, _p228._0._0, _p228._0._1._0, _p228._0._1._1._0, _p220._4),
						_p228._1);
				} else {
					return _elm_lang$core$Native_Utils.crashCase(
						'Lang',
						{
							start: {line: 694, column: 7},
							end: {line: 696, column: 117}
						},
						_p228)('I\'ll buy you a beer if this line of code executes. - Brian');
				}
			case 'ECase':
				var _p230 = A2(recurse, newAcc, _p220._1);
				var newE1 = _p230._0;
				var newAcc2 = _p230._1;
				var _p231 = A3(
					_elm_lang$core$List$foldl,
					F2(
						function (branch, _p232) {
							var _p233 = _p232;
							var _p234 = branch.val;
							var bws1 = _p234._0;
							var p = _p234._1;
							var ei = _p234._2;
							var bws2 = _p234._3;
							var _p235 = A2(recurse, _p233._1, ei);
							var newEi = _p235._0;
							var newAcc3 = _p235._1;
							return {
								ctor: '_Tuple2',
								_0: A2(
									_elm_lang$core$Basics_ops['++'],
									_p233._0,
									{
										ctor: '::',
										_0: _elm_lang$core$Native_Utils.update(
											branch,
											{
												val: A4(_user$project$Lang$Branch_, bws1, p, newEi, bws2)
											}),
										_1: {ctor: '[]'}
									}),
								_1: newAcc3
							};
						}),
					{
						ctor: '_Tuple2',
						_0: {ctor: '[]'},
						_1: newAcc2
					},
					_p220._2);
				var newBranches = _p231._0;
				var newAcc3 = _p231._1;
				return A2(
					ret,
					A4(_user$project$Lang$ECase, _p220._0, newE1, newBranches, _p220._3),
					newAcc3);
			case 'ETypeCase':
				var _p236 = A3(
					_elm_lang$core$List$foldl,
					F2(
						function (tbranch, _p237) {
							var _p238 = _p237;
							var _p239 = tbranch.val;
							var bws1 = _p239._0;
							var t = _p239._1;
							var ei = _p239._2;
							var bws2 = _p239._3;
							var _p240 = A2(recurse, _p238._1, ei);
							var newEi = _p240._0;
							var newAcc2 = _p240._1;
							return {
								ctor: '_Tuple2',
								_0: A2(
									_elm_lang$core$Basics_ops['++'],
									_p238._0,
									{
										ctor: '::',
										_0: _elm_lang$core$Native_Utils.update(
											tbranch,
											{
												val: A4(_user$project$Lang$TBranch_, bws1, t, newEi, bws2)
											}),
										_1: {ctor: '[]'}
									}),
								_1: newAcc2
							};
						}),
					{
						ctor: '_Tuple2',
						_0: {ctor: '[]'},
						_1: newAcc
					},
					_p220._2);
				var newBranches = _p236._0;
				var newAcc2 = _p236._1;
				return A2(
					ret,
					A4(_user$project$Lang$ETypeCase, _p220._0, _p220._1, newBranches, _p220._3),
					newAcc2);
			case 'EComment':
				var _p241 = A2(recurse, newAcc, _p220._2);
				var newE1 = _p241._0;
				var newAcc2 = _p241._1;
				return A2(
					ret,
					A3(_user$project$Lang$EComment, _p220._0, _p220._1, newE1),
					newAcc2);
			case 'EOption':
				var _p242 = A2(recurse, newAcc, _p220._4);
				var newE1 = _p242._0;
				var newAcc2 = _p242._1;
				return A2(
					ret,
					A5(_user$project$Lang$EOption, _p220._0, _p220._1, _p220._2, _p220._3, newE1),
					newAcc2);
			case 'ELet':
				var _p243 = A2(recurse, newAcc, _p220._4);
				var newE1 = _p243._0;
				var newAcc2 = _p243._1;
				var _p244 = A2(recurse, newAcc2, _p220._5);
				var newE2 = _p244._0;
				var newAcc3 = _p244._1;
				return A2(
					ret,
					A7(_user$project$Lang$ELet, _p220._0, _p220._1, _p220._2, _p220._3, newE1, newE2, _p220._6),
					newAcc3);
			case 'ETyp':
				var _p245 = A2(recurse, newAcc, _p220._3);
				var newE1 = _p245._0;
				var newAcc2 = _p245._1;
				return A2(
					ret,
					A5(_user$project$Lang$ETyp, _p220._0, _p220._1, _p220._2, newE1, _p220._4),
					newAcc2);
			case 'EColonType':
				var _p246 = A2(recurse, newAcc, _p220._1);
				var newE1 = _p246._0;
				var newAcc2 = _p246._1;
				return A2(
					ret,
					A5(_user$project$Lang$EColonType, _p220._0, newE1, _p220._2, _p220._3, _p220._4),
					newAcc2);
			default:
				var _p247 = A2(recurse, newAcc, _p220._3);
				var newE1 = _p247._0;
				var newAcc2 = _p247._1;
				return A2(
					ret,
					A5(_user$project$Lang$ETypeAlias, _p220._0, _p220._1, _p220._2, newE1, _p220._4),
					newAcc2);
		}
	});
var _user$project$Lang$mapExpTopDown = F2(
	function (f, e) {
		var _p248 = A3(
			_user$project$Lang$mapFoldExpTopDown,
			F2(
				function (exp, _p249) {
					return {
						ctor: '_Tuple2',
						_0: f(exp),
						_1: {ctor: '_Tuple0'}
					};
				}),
			{ctor: '_Tuple0'},
			e);
		var newExp = _p248._0;
		return newExp;
	});
var _user$project$Lang$replaceExpNodes = F2(
	function (eidToNewNode, root) {
		return A2(
			_user$project$Lang$mapExpTopDown,
			function (exp) {
				var _p250 = A2(_elm_lang$core$Dict$get, exp.val.eid, eidToNewNode);
				if (_p250.ctor === 'Just') {
					return _p250._0;
				} else {
					return exp;
				}
			},
			root);
	});
var _user$project$Lang$replaceExpNodesPreservingPrecedingWhitespace = F2(
	function (eidToNewNode, root) {
		return A2(
			_user$project$Lang$mapExpTopDown,
			function (exp) {
				var _p251 = A2(_elm_lang$core$Dict$get, exp.val.eid, eidToNewNode);
				if (_p251.ctor === 'Just') {
					return A2(
						_user$project$Lang$replacePrecedingWhitespace,
						_user$project$Lang$precedingWhitespace(exp),
						_p251._0);
				} else {
					return exp;
				}
			},
			root);
	});
var _user$project$Lang$mapFoldExpTopDownWithScope = F7(
	function (f, handleELet, handleEFun, handleCaseBranch, initGlobalAcc, initScopeTempAcc, e) {
		var _p252 = A3(f, e, initGlobalAcc, initScopeTempAcc);
		var newE = _p252._0;
		var newGlobalAcc = _p252._1;
		var ret = F2(
			function (e__, globalAcc) {
				return {
					ctor: '_Tuple2',
					_0: A2(_user$project$Lang$replaceE__, newE, e__),
					_1: globalAcc
				};
			});
		var recurse = F3(
			function (globalAcc, scopeTempAcc, child) {
				return A7(_user$project$Lang$mapFoldExpTopDownWithScope, f, handleELet, handleEFun, handleCaseBranch, globalAcc, scopeTempAcc, child);
			});
		var recurseAll = F3(
			function (globalAcc, scopeTempAcc, exps) {
				return A3(
					_elm_lang$core$List$foldl,
					F2(
						function (exp, _p253) {
							var _p254 = _p253;
							var _p255 = A3(recurse, _p254._1, scopeTempAcc, exp);
							var newExp = _p255._0;
							var newGlobalAcc = _p255._1;
							return {
								ctor: '_Tuple2',
								_0: A2(
									_elm_lang$core$Basics_ops['++'],
									_p254._0,
									{
										ctor: '::',
										_0: newExp,
										_1: {ctor: '[]'}
									}),
								_1: newGlobalAcc
							};
						}),
					{
						ctor: '_Tuple2',
						_0: {ctor: '[]'},
						_1: globalAcc
					},
					exps);
			});
		var _p256 = newE.val.e__;
		switch (_p256.ctor) {
			case 'EConst':
				return {ctor: '_Tuple2', _0: newE, _1: newGlobalAcc};
			case 'EBase':
				return {ctor: '_Tuple2', _0: newE, _1: newGlobalAcc};
			case 'EVar':
				return {ctor: '_Tuple2', _0: newE, _1: newGlobalAcc};
			case 'EFun':
				var newScopeTempAcc = A2(handleEFun, newE, initScopeTempAcc);
				var _p257 = A3(recurse, newGlobalAcc, newScopeTempAcc, _p256._2);
				var newE1 = _p257._0;
				var newGlobalAcc2 = _p257._1;
				return A2(
					ret,
					A4(_user$project$Lang$EFun, _p256._0, _p256._1, newE1, _p256._3),
					newGlobalAcc2);
			case 'EApp':
				var _p258 = A3(recurse, newGlobalAcc, initScopeTempAcc, _p256._1);
				var newE1 = _p258._0;
				var newGlobalAcc2 = _p258._1;
				var _p259 = A3(recurseAll, newGlobalAcc2, initScopeTempAcc, _p256._2);
				var newEs = _p259._0;
				var newGlobalAcc3 = _p259._1;
				return A2(
					ret,
					A4(_user$project$Lang$EApp, _p256._0, newE1, newEs, _p256._3),
					newGlobalAcc3);
			case 'EOp':
				var _p260 = A3(recurseAll, newGlobalAcc, initScopeTempAcc, _p256._2);
				var newEs = _p260._0;
				var newGlobalAcc2 = _p260._1;
				return A2(
					ret,
					A4(_user$project$Lang$EOp, _p256._0, _p256._1, newEs, _p256._3),
					newGlobalAcc2);
			case 'EList':
				if (_p256._3.ctor === 'Nothing') {
					var _p261 = A3(recurseAll, newGlobalAcc, initScopeTempAcc, _p256._1);
					var newEs = _p261._0;
					var newGlobalAcc2 = _p261._1;
					return A2(
						ret,
						A5(_user$project$Lang$EList, _p256._0, newEs, _p256._2, _elm_lang$core$Maybe$Nothing, _p256._4),
						newGlobalAcc2);
				} else {
					var _p262 = A3(recurse, newGlobalAcc, initScopeTempAcc, _p256._3._0);
					var newE1 = _p262._0;
					var newGlobalAcc2 = _p262._1;
					var _p263 = A3(recurseAll, newGlobalAcc2, initScopeTempAcc, _p256._1);
					var newEs = _p263._0;
					var newGlobalAcc3 = _p263._1;
					return A2(
						ret,
						A5(
							_user$project$Lang$EList,
							_p256._0,
							newEs,
							_p256._2,
							_elm_lang$core$Maybe$Just(newE1),
							_p256._4),
						newGlobalAcc3);
				}
			case 'EIf':
				var _p264 = A3(
					recurseAll,
					newGlobalAcc,
					initScopeTempAcc,
					{
						ctor: '::',
						_0: _p256._1,
						_1: {
							ctor: '::',
							_0: _p256._2,
							_1: {
								ctor: '::',
								_0: _p256._3,
								_1: {ctor: '[]'}
							}
						}
					});
				if (((((_p264.ctor === '_Tuple2') && (_p264._0.ctor === '::')) && (_p264._0._1.ctor === '::')) && (_p264._0._1._1.ctor === '::')) && (_p264._0._1._1._1.ctor === '[]')) {
					return A2(
						ret,
						A5(_user$project$Lang$EIf, _p256._0, _p264._0._0, _p264._0._1._0, _p264._0._1._1._0, _p256._4),
						_p264._1);
				} else {
					return _elm_lang$core$Native_Utils.crashCase(
						'Lang',
						{
							start: {line: 847, column: 7},
							end: {line: 849, column: 123}
						},
						_p264)('I\'ll buy you a beer if this line of code executes. - Brian');
				}
			case 'ECase':
				var _p266 = A3(recurse, newGlobalAcc, initScopeTempAcc, _p256._1);
				var newE1 = _p266._0;
				var newGlobalAcc2 = _p266._1;
				var _p267 = A3(
					_user$project$Utils$foldli1,
					F2(
						function (_p269, _p268) {
							var _p270 = _p269;
							var _p274 = _p270._1;
							var _p271 = _p268;
							var newScopeTempAcc = A4(handleCaseBranch, newE, _p274, _p270._0, initScopeTempAcc);
							var _p272 = _p274.val;
							var bws1 = _p272._0;
							var p = _p272._1;
							var ei = _p272._2;
							var bws2 = _p272._3;
							var _p273 = A3(recurse, _p271._1, newScopeTempAcc, ei);
							var newEi = _p273._0;
							var newGlobalAcc3 = _p273._1;
							return {
								ctor: '_Tuple2',
								_0: A2(
									_elm_lang$core$Basics_ops['++'],
									_p271._0,
									{
										ctor: '::',
										_0: _elm_lang$core$Native_Utils.update(
											_p274,
											{
												val: A4(_user$project$Lang$Branch_, bws1, p, newEi, bws2)
											}),
										_1: {ctor: '[]'}
									}),
								_1: newGlobalAcc3
							};
						}),
					{
						ctor: '_Tuple2',
						_0: {ctor: '[]'},
						_1: newGlobalAcc2
					},
					_p256._2);
				var newBranches = _p267._0;
				var newGlobalAcc3 = _p267._1;
				return A2(
					ret,
					A4(_user$project$Lang$ECase, _p256._0, newE1, newBranches, _p256._3),
					newGlobalAcc3);
			case 'ETypeCase':
				var _p275 = A3(
					_elm_lang$core$List$foldl,
					F2(
						function (tbranch, _p276) {
							var _p277 = _p276;
							var _p278 = tbranch.val;
							var bws1 = _p278._0;
							var t = _p278._1;
							var ei = _p278._2;
							var bws2 = _p278._3;
							var _p279 = A3(recurse, _p277._1, initScopeTempAcc, ei);
							var newEi = _p279._0;
							var newGlobalAcc2 = _p279._1;
							return {
								ctor: '_Tuple2',
								_0: A2(
									_elm_lang$core$Basics_ops['++'],
									_p277._0,
									{
										ctor: '::',
										_0: _elm_lang$core$Native_Utils.update(
											tbranch,
											{
												val: A4(_user$project$Lang$TBranch_, bws1, t, newEi, bws2)
											}),
										_1: {ctor: '[]'}
									}),
								_1: newGlobalAcc2
							};
						}),
					{
						ctor: '_Tuple2',
						_0: {ctor: '[]'},
						_1: newGlobalAcc
					},
					_p256._2);
				var newBranches = _p275._0;
				var newGlobalAcc2 = _p275._1;
				return A2(
					ret,
					A4(_user$project$Lang$ETypeCase, _p256._0, _p256._1, newBranches, _p256._3),
					newGlobalAcc2);
			case 'EComment':
				var _p280 = A3(recurse, newGlobalAcc, initScopeTempAcc, _p256._2);
				var newE1 = _p280._0;
				var newGlobalAcc2 = _p280._1;
				return A2(
					ret,
					A3(_user$project$Lang$EComment, _p256._0, _p256._1, newE1),
					newGlobalAcc2);
			case 'EOption':
				var _p281 = A3(recurse, newGlobalAcc, initScopeTempAcc, _p256._4);
				var newE1 = _p281._0;
				var newGlobalAcc2 = _p281._1;
				return A2(
					ret,
					A5(_user$project$Lang$EOption, _p256._0, _p256._1, _p256._2, _p256._3, newE1),
					newGlobalAcc2);
			case 'ELet':
				var _p285 = _p256._2;
				var _p284 = _p256._4;
				var newScopeTempAcc = A2(handleELet, newE, initScopeTempAcc);
				var _p282 = _p285 ? A3(recurse, newGlobalAcc, newScopeTempAcc, _p284) : A3(recurse, newGlobalAcc, initScopeTempAcc, _p284);
				var newE1 = _p282._0;
				var newGlobalAcc2 = _p282._1;
				var _p283 = A3(recurse, newGlobalAcc2, newScopeTempAcc, _p256._5);
				var newE2 = _p283._0;
				var newGlobalAcc3 = _p283._1;
				return A2(
					ret,
					A7(_user$project$Lang$ELet, _p256._0, _p256._1, _p285, _p256._3, newE1, newE2, _p256._6),
					newGlobalAcc3);
			case 'ETyp':
				var _p286 = A3(recurse, newGlobalAcc, initScopeTempAcc, _p256._3);
				var newE1 = _p286._0;
				var newGlobalAcc2 = _p286._1;
				return A2(
					ret,
					A5(_user$project$Lang$ETyp, _p256._0, _p256._1, _p256._2, newE1, _p256._4),
					newGlobalAcc2);
			case 'EColonType':
				var _p287 = A3(recurse, newGlobalAcc, initScopeTempAcc, _p256._1);
				var newE1 = _p287._0;
				var newGlobalAcc2 = _p287._1;
				return A2(
					ret,
					A5(_user$project$Lang$EColonType, _p256._0, newE1, _p256._2, _p256._3, _p256._4),
					newGlobalAcc2);
			default:
				var _p288 = A3(recurse, newGlobalAcc, initScopeTempAcc, _p256._3);
				var newE1 = _p288._0;
				var newGlobalAcc2 = _p288._1;
				return A2(
					ret,
					A5(_user$project$Lang$ETypeAlias, _p256._0, _p256._1, _p256._2, newE1, _p256._4),
					newGlobalAcc2);
		}
	});
var _user$project$Lang$foldExpTopDownWithScope = F7(
	function (f, handleELet, handleEFun, handleCaseBranch, initGlobalAcc, initScopeTempAcc, e) {
		var _p289 = A7(
			_user$project$Lang$mapFoldExpTopDownWithScope,
			F3(
				function (e, globalAcc, scopeTempAcc) {
					return {
						ctor: '_Tuple2',
						_0: e,
						_1: A3(f, e, globalAcc, scopeTempAcc)
					};
				}),
			handleELet,
			handleEFun,
			handleCaseBranch,
			initGlobalAcc,
			initScopeTempAcc,
			e);
		var finalGlobalAcc = _p289._1;
		return finalGlobalAcc;
	});
var _user$project$Lang$replaceTBranchExp = F2(
	function (tbranch, exp) {
		var _p290 = tbranch.val;
		var tbws1 = _p290._0;
		var tipe = _p290._1;
		var tbws2 = _p290._3;
		return _elm_lang$core$Native_Utils.update(
			tbranch,
			{
				val: A4(_user$project$Lang$TBranch_, tbws1, tipe, exp, tbws2)
			});
	});
var _user$project$Lang$Def = {ctor: 'Def'};
var _user$project$Lang$Let = {ctor: 'Let'};
var _user$project$Lang$NoWidgetDecl = {ctor: 'NoWidgetDecl'};
var _user$project$Lang$noWidgetDecl = _user$project$Lang$withDummyRange(_user$project$Lang$NoWidgetDecl);
var _user$project$Lang$eConst0 = F2(
	function (a, b) {
		return _user$project$Lang$withDummyExpInfo(
			A4(_user$project$Lang$EConst, _user$project$Lang$space0, a, b, _user$project$Lang$noWidgetDecl));
	});
var _user$project$Lang$eConst = F2(
	function (a, b) {
		return _user$project$Lang$withDummyExpInfo(
			A4(_user$project$Lang$EConst, _user$project$Lang$space1, a, b, _user$project$Lang$noWidgetDecl));
	});
var _user$project$Lang$listOfNums = function (ns) {
	var _p291 = ns;
	if (_p291.ctor === '[]') {
		return {ctor: '[]'};
	} else {
		return {
			ctor: '::',
			_0: A2(_user$project$Lang$eConst0, _p291._0, _user$project$Lang$dummyLoc),
			_1: A2(
				_elm_lang$core$List$map,
				A2(_elm_lang$core$Basics$flip, _user$project$Lang$eConst, _user$project$Lang$dummyLoc),
				_p291._1)
		};
	}
};
var _user$project$Lang$eConstDummyLoc0 = function (a) {
	return _user$project$Lang$withDummyExpInfo(
		A4(_user$project$Lang$EConst, _user$project$Lang$space0, a, _user$project$Lang$dummyLoc, _user$project$Lang$noWidgetDecl));
};
var _user$project$Lang$eConstDummyLoc = function (a) {
	return _user$project$Lang$withDummyExpInfo(
		A4(_user$project$Lang$EConst, _user$project$Lang$space1, a, _user$project$Lang$dummyLoc, _user$project$Lang$noWidgetDecl));
};
var _user$project$Lang$pVar0 = function (a) {
	return _user$project$Lang$withDummyPatInfo(
		A3(_user$project$Lang$PVar, _user$project$Lang$space0, a, _user$project$Lang$noWidgetDecl));
};
var _user$project$Lang$pVar = function (a) {
	return _user$project$Lang$withDummyPatInfo(
		A3(_user$project$Lang$PVar, _user$project$Lang$space1, a, _user$project$Lang$noWidgetDecl));
};
var _user$project$Lang$listOfPVars = function (xs) {
	var _p292 = xs;
	if (_p292.ctor === '[]') {
		return {ctor: '[]'};
	} else {
		return {
			ctor: '::',
			_0: _user$project$Lang$pVar0(_p292._0),
			_1: A2(_elm_lang$core$List$map, _user$project$Lang$pVar, _p292._1)
		};
	}
};
var _user$project$Lang$pListOfPVars = function (names) {
	return _user$project$Lang$pList(
		_user$project$Lang$listOfPVars(names));
};
var _user$project$Lang$patBoundExpOf = function (namesAndAssigns) {
	var _p293 = _elm_lang$core$List$unzip(namesAndAssigns);
	if ((((_p293._0.ctor === '::') && (_p293._0._1.ctor === '[]')) && (_p293._1.ctor === '::')) && (_p293._1._1.ctor === '[]')) {
		return {
			ctor: '_Tuple2',
			_0: _user$project$Lang$pVar(_p293._0._0),
			_1: A2(_user$project$Lang$replacePrecedingWhitespace, ' ', _p293._1._0)
		};
	} else {
		return {
			ctor: '_Tuple2',
			_0: _user$project$Lang$pListOfPVars(_p293._0),
			_1: A2(
				_user$project$Lang$eList,
				A3(_user$project$Lang$setExpListWhitespace, '', ' ', _p293._1),
				_elm_lang$core$Maybe$Nothing)
		};
	}
};
var _user$project$Lang$eLetOrDef = F3(
	function (letKind, namesAndAssigns, bodyExp) {
		var _p294 = _user$project$Lang$patBoundExpOf(namesAndAssigns);
		var pat = _p294._0;
		var assign = _p294._1;
		return _user$project$Lang$withDummyExpInfo(
			A7(_user$project$Lang$ELet, _user$project$Lang$newline1, letKind, false, pat, assign, bodyExp, _user$project$Lang$space0));
	});
var _user$project$Lang$eLet = _user$project$Lang$eLetOrDef(_user$project$Lang$Let);
var _user$project$Lang$eLets = F2(
	function (xes, eBody) {
		var _p295 = xes;
		if (_p295.ctor === '::') {
			return A2(
				_user$project$Lang$eLet,
				{
					ctor: '::',
					_0: {ctor: '_Tuple2', _0: _p295._0._0, _1: _p295._0._1},
					_1: {ctor: '[]'}
				},
				A2(_user$project$Lang$eLets, _p295._1, eBody));
		} else {
			return eBody;
		}
	});
var _user$project$Lang$eDef = _user$project$Lang$eLetOrDef(_user$project$Lang$Def);
var _user$project$Lang$NumSlider = F5(
	function (a, b, c, d, e) {
		return {ctor: 'NumSlider', _0: a, _1: b, _2: c, _3: d, _4: e};
	});
var _user$project$Lang$numSlider = _user$project$Lang$rangeSlider(_user$project$Lang$NumSlider);
var _user$project$Lang$IntSlider = F5(
	function (a, b, c, d, e) {
		return {ctor: 'IntSlider', _0: a, _1: b, _2: c, _3: d, _4: e};
	});
var _user$project$Lang$intSlider = _user$project$Lang$rangeSlider(_user$project$Lang$IntSlider);
var _user$project$Lang$colorNumberSlider = A2(_user$project$Lang$intSlider, 0, 499);
var _user$project$Lang$Y = {ctor: 'Y'};
var _user$project$Lang$X = {ctor: 'X'};
var _user$project$Lang$Negative = {ctor: 'Negative'};
var _user$project$Lang$Positive = {ctor: 'Positive'};
var _user$project$Lang$WOffset1D = F5(
	function (a, b, c, d, e) {
		return {ctor: 'WOffset1D', _0: a, _1: b, _2: c, _3: d, _4: e};
	});
var _user$project$Lang$WPoint = F2(
	function (a, b) {
		return {ctor: 'WPoint', _0: a, _1: b};
	});
var _user$project$Lang$WNumSlider = F6(
	function (a, b, c, d, e, f) {
		return {ctor: 'WNumSlider', _0: a, _1: b, _2: c, _3: d, _4: e, _5: f};
	});
var _user$project$Lang$WIntSlider = F6(
	function (a, b, c, d, e, f) {
		return {ctor: 'WIntSlider', _0: a, _1: b, _2: c, _3: d, _4: e, _5: f};
	});
var _user$project$Lang$VDict = function (a) {
	return {ctor: 'VDict', _0: a};
};
var _user$project$Lang$vDict = function (_p296) {
	return _user$project$Lang$val(
		_user$project$Lang$VDict(_p296));
};
var _user$project$Lang$VList = function (a) {
	return {ctor: 'VList', _0: a};
};
var _user$project$Lang$mapVal = F2(
	function (f, v) {
		var _p297 = v.v_;
		switch (_p297.ctor) {
			case 'VList':
				return f(
					_elm_lang$core$Native_Utils.update(
						v,
						{
							v_: _user$project$Lang$VList(
								A2(
									_elm_lang$core$List$map,
									_user$project$Lang$mapVal(f),
									_p297._0))
						}));
			case 'VDict':
				return f(
					_elm_lang$core$Native_Utils.update(
						v,
						{
							v_: _user$project$Lang$VDict(
								A2(
									_elm_lang$core$Dict$map,
									F2(
										function (_p298, v) {
											return A2(_user$project$Lang$mapVal, f, v);
										}),
									_p297._0))
						}));
			case 'VConst':
				return f(v);
			case 'VBase':
				return f(v);
			default:
				return f(v);
		}
	});
var _user$project$Lang$vList = function (_p299) {
	return _user$project$Lang$val(
		_user$project$Lang$VList(_p299));
};
var _user$project$Lang$VClosure = F4(
	function (a, b, c, d) {
		return {ctor: 'VClosure', _0: a, _1: b, _2: c, _3: d};
	});
var _user$project$Lang$VBase = function (a) {
	return {ctor: 'VBase', _0: a};
};
var _user$project$Lang$vBase = function (_p300) {
	return _user$project$Lang$val(
		_user$project$Lang$VBase(_p300));
};
var _user$project$Lang$VConst = F2(
	function (a, b) {
		return {ctor: 'VConst', _0: a, _1: b};
	});
var _user$project$Lang$vConst = function (_p301) {
	return _user$project$Lang$val(
		A2(_user$project$Lang$VConst, _elm_lang$core$Maybe$Nothing, _p301));
};
var _user$project$Lang$VNull = {ctor: 'VNull'};
var _user$project$Lang$VString = function (a) {
	return {ctor: 'VString', _0: a};
};
var _user$project$Lang$vStr = function (_p302) {
	return _user$project$Lang$val(
		_user$project$Lang$VBase(
			_user$project$Lang$VString(_p302)));
};
var _user$project$Lang$VBool = function (a) {
	return {ctor: 'VBool', _0: a};
};
var _user$project$Lang$vBool = function (_p303) {
	return _user$project$Lang$val(
		_user$project$Lang$VBase(
			_user$project$Lang$VBool(_p303)));
};
var _user$project$Lang$vTrue = _user$project$Lang$vBool(true);
var _user$project$Lang$vFalse = _user$project$Lang$vBool(false);
var _user$project$Lang$ENull = {ctor: 'ENull'};
var _user$project$Lang$EString = F2(
	function (a, b) {
		return {ctor: 'EString', _0: a, _1: b};
	});
var _user$project$Lang$eStr = function (_p304) {
	return _user$project$Lang$withDummyExpInfo(
		A2(
			_user$project$Lang$EBase,
			_user$project$Lang$space1,
			A2(_user$project$Lang$EString, _user$project$Lang$defaultQuoteChar, _p304)));
};
var _user$project$Lang$eStr0 = function (_p305) {
	return _user$project$Lang$withDummyExpInfo(
		A2(
			_user$project$Lang$EBase,
			_user$project$Lang$space0,
			A2(_user$project$Lang$EString, _user$project$Lang$defaultQuoteChar, _p305)));
};
var _user$project$Lang$EBool = function (a) {
	return {ctor: 'EBool', _0: a};
};
var _user$project$Lang$eBool = function (_p306) {
	return _user$project$Lang$withDummyExpInfo(
		A2(
			_user$project$Lang$EBase,
			_user$project$Lang$space1,
			_user$project$Lang$EBool(_p306)));
};
var _user$project$Lang$eTrue = _user$project$Lang$eBool(true);
var _user$project$Lang$eFalse = _user$project$Lang$eBool(false);
var _user$project$Lang$TrOp = F2(
	function (a, b) {
		return {ctor: 'TrOp', _0: a, _1: b};
	});
var _user$project$Lang$plusNumTr = F2(
	function (_p308, _p307) {
		var _p309 = _p308;
		var _p310 = _p307;
		return {
			ctor: '_Tuple2',
			_0: _p309._0 + _p310._0,
			_1: A2(
				_user$project$Lang$TrOp,
				_user$project$Lang$Plus,
				{
					ctor: '::',
					_0: _p309._1,
					_1: {
						ctor: '::',
						_0: _p310._1,
						_1: {ctor: '[]'}
					}
				})
		};
	});
var _user$project$Lang$minusNumTr = F2(
	function (_p312, _p311) {
		var _p313 = _p312;
		var _p314 = _p311;
		return {
			ctor: '_Tuple2',
			_0: _p313._0 + _p314._0,
			_1: A2(
				_user$project$Lang$TrOp,
				_user$project$Lang$Minus,
				{
					ctor: '::',
					_0: _p313._1,
					_1: {
						ctor: '::',
						_0: _p314._1,
						_1: {ctor: '[]'}
					}
				})
		};
	});
var _user$project$Lang$TrLoc = function (a) {
	return {ctor: 'TrLoc', _0: a};
};
var _user$project$Lang$dummyTrace_ = function (b) {
	return _user$project$Lang$TrLoc(
		_user$project$Lang$dummyLoc_(b));
};
var _user$project$Lang$dummyTrace = _user$project$Lang$dummyTrace_(_user$project$Lang$unann);
var _user$project$Lang$After = {ctor: 'After'};
var _user$project$Lang$Before = {ctor: 'Before'};
var _user$project$Lang$PatTargetPosition = function (a) {
	return {ctor: 'PatTargetPosition', _0: a};
};
var _user$project$Lang$ExpTargetPosition = function (a) {
	return {ctor: 'ExpTargetPosition', _0: a};
};
var _user$project$Lang$TT = F3(
	function (a, b, c) {
		return {ctor: 'TT', _0: a, _1: b, _2: c};
	});
var _user$project$Lang$PT = F4(
	function (a, b, c, d) {
		return {ctor: 'PT', _0: a, _1: b, _2: c, _3: d};
	});
var _user$project$Lang$ET = F3(
	function (a, b, c) {
		return {ctor: 'ET', _0: a, _1: b, _2: c};
	});
var _user$project$Lang$LBE = function (a) {
	return {ctor: 'LBE', _0: a};
};
var _user$project$Lang$T = function (a) {
	return {ctor: 'T', _0: a};
};
var _user$project$Lang$P = F2(
	function (a, b) {
		return {ctor: 'P', _0: a, _1: b};
	});
var _user$project$Lang$E = function (a) {
	return {ctor: 'E', _0: a};
};
var _user$project$Lang$modifyWsBefore = F2(
	function (f, codeObject) {
		var _p315 = codeObject;
		switch (_p315.ctor) {
			case 'E':
				var _p317 = _p315._0;
				var eVal = _p317.val;
				var newE__ = function () {
					var _p316 = eVal.e__;
					switch (_p316.ctor) {
						case 'EConst':
							return A4(
								_user$project$Lang$EConst,
								f(_p316._0),
								_p316._1,
								_p316._2,
								_p316._3);
						case 'EBase':
							return A2(
								_user$project$Lang$EBase,
								f(_p316._0),
								_p316._1);
						case 'EVar':
							return A2(
								_user$project$Lang$EVar,
								f(_p316._0),
								_p316._1);
						case 'EFun':
							return A4(
								_user$project$Lang$EFun,
								f(_p316._0),
								_p316._1,
								_p316._2,
								_p316._3);
						case 'EApp':
							return A4(
								_user$project$Lang$EApp,
								f(_p316._0),
								_p316._1,
								_p316._2,
								_p316._3);
						case 'EOp':
							return A4(
								_user$project$Lang$EOp,
								f(_p316._0),
								_p316._1,
								_p316._2,
								_p316._3);
						case 'EList':
							return A5(
								_user$project$Lang$EList,
								f(_p316._0),
								_p316._1,
								_p316._2,
								_p316._3,
								_p316._4);
						case 'EIf':
							return A5(
								_user$project$Lang$EIf,
								f(_p316._0),
								_p316._1,
								_p316._2,
								_p316._3,
								_p316._4);
						case 'ECase':
							return A4(
								_user$project$Lang$ECase,
								f(_p316._0),
								_p316._1,
								_p316._2,
								_p316._3);
						case 'ETypeCase':
							return A4(
								_user$project$Lang$ETypeCase,
								f(_p316._0),
								_p316._1,
								_p316._2,
								_p316._3);
						case 'ELet':
							return A7(
								_user$project$Lang$ELet,
								f(_p316._0),
								_p316._1,
								_p316._2,
								_p316._3,
								_p316._4,
								_p316._5,
								_p316._6);
						case 'EComment':
							return A3(
								_user$project$Lang$EComment,
								f(_p316._0),
								_p316._1,
								_p316._2);
						case 'EOption':
							return A5(
								_user$project$Lang$EOption,
								f(_p316._0),
								_p316._1,
								_p316._2,
								_p316._3,
								_p316._4);
						case 'ETyp':
							return A5(
								_user$project$Lang$ETyp,
								f(_p316._0),
								_p316._1,
								_p316._2,
								_p316._3,
								_p316._4);
						case 'EColonType':
							return A5(
								_user$project$Lang$EColonType,
								f(_p316._0),
								_p316._1,
								_p316._2,
								_p316._3,
								_p316._4);
						default:
							return A5(
								_user$project$Lang$ETypeAlias,
								f(_p316._0),
								_p316._1,
								_p316._2,
								_p316._3,
								_p316._4);
					}
				}();
				return _user$project$Lang$E(
					_elm_lang$core$Native_Utils.update(
						_p317,
						{
							val: _elm_lang$core$Native_Utils.update(
								eVal,
								{e__: newE__})
						}));
			case 'P':
				var _p319 = _p315._1;
				var pVal = _p319.val;
				var newP__ = function () {
					var _p318 = pVal.p__;
					switch (_p318.ctor) {
						case 'PVar':
							return A3(
								_user$project$Lang$PVar,
								f(_p318._0),
								_p318._1,
								_p318._2);
						case 'PConst':
							return A2(
								_user$project$Lang$PConst,
								f(_p318._0),
								_p318._1);
						case 'PBase':
							return A2(
								_user$project$Lang$PBase,
								f(_p318._0),
								_p318._1);
						case 'PList':
							return A5(
								_user$project$Lang$PList,
								f(_p318._0),
								_p318._1,
								_p318._2,
								_p318._3,
								_p318._4);
						default:
							return A4(
								_user$project$Lang$PAs,
								f(_p318._0),
								_p318._1,
								_p318._2,
								_p318._3);
					}
				}();
				return A2(
					_user$project$Lang$P,
					_p315._0,
					_elm_lang$core$Native_Utils.update(
						_p319,
						{
							val: _elm_lang$core$Native_Utils.update(
								pVal,
								{p__: newP__})
						}));
			case 'T':
				var _p321 = _p315._0;
				var newVal = function () {
					var _p320 = _p321.val;
					switch (_p320.ctor) {
						case 'TNum':
							return _user$project$Lang$TNum(
								f(_p320._0));
						case 'TBool':
							return _user$project$Lang$TBool(
								f(_p320._0));
						case 'TString':
							return _user$project$Lang$TString(
								f(_p320._0));
						case 'TNull':
							return _user$project$Lang$TNull(
								f(_p320._0));
						case 'TList':
							return A3(
								_user$project$Lang$TList,
								f(_p320._0),
								_p320._1,
								_p320._2);
						case 'TDict':
							return A4(
								_user$project$Lang$TDict,
								f(_p320._0),
								_p320._1,
								_p320._2,
								_p320._3);
						case 'TTuple':
							return A5(
								_user$project$Lang$TTuple,
								f(_p320._0),
								_p320._1,
								_p320._2,
								_p320._3,
								_p320._4);
						case 'TArrow':
							return A3(
								_user$project$Lang$TArrow,
								f(_p320._0),
								_p320._1,
								_p320._2);
						case 'TUnion':
							return A3(
								_user$project$Lang$TUnion,
								f(_p320._0),
								_p320._1,
								_p320._2);
						case 'TNamed':
							return A2(
								_user$project$Lang$TNamed,
								f(_p320._0),
								_p320._1);
						case 'TVar':
							return A2(
								_user$project$Lang$TVar,
								f(_p320._0),
								_p320._1);
						case 'TForall':
							return A4(
								_user$project$Lang$TForall,
								f(_p320._0),
								_p320._1,
								_p320._2,
								_p320._3);
						default:
							return _user$project$Lang$TWildcard(
								f(_p320._0));
					}
				}();
				return _user$project$Lang$T(
					_elm_lang$core$Native_Utils.update(
						_p321,
						{val: newVal}));
			case 'LBE':
				return _user$project$Lang$LBE(_p315._0);
			case 'ET':
				return A3(
					_user$project$Lang$ET,
					_p315._0,
					f(_p315._1),
					_p315._2);
			case 'PT':
				return A4(
					_user$project$Lang$PT,
					_p315._0,
					f(_p315._1),
					_p315._2,
					_p315._3);
			default:
				return A3(
					_user$project$Lang$TT,
					_p315._0,
					f(_p315._1),
					_p315._2);
		}
	});
var _user$project$Lang$childCodeObjects = function (co) {
	return A2(
		_elm_lang$core$List$filter,
		function (_p322) {
			return !_user$project$Lang$isHiddenCodeObject(_p322);
		},
		function () {
			var _p323 = co;
			switch (_p323.ctor) {
				case 'E':
					var _p365 = _p323._0;
					var _p324 = _p365.val.e__;
					switch (_p324.ctor) {
						case 'EConst':
							return {
								ctor: '::',
								_0: A3(_user$project$Lang$ET, _user$project$Lang$Before, _p324._0, _p365),
								_1: {ctor: '[]'}
							};
						case 'EBase':
							return {
								ctor: '::',
								_0: A3(_user$project$Lang$ET, _user$project$Lang$Before, _p324._0, _p365),
								_1: {ctor: '[]'}
							};
						case 'EVar':
							return {
								ctor: '::',
								_0: A3(_user$project$Lang$ET, _user$project$Lang$Before, _p324._0, _p365),
								_1: {ctor: '[]'}
							};
						case 'EFun':
							var _p328 = _p324._1;
							var _p327 = _p324._2;
							return A2(
								_elm_lang$core$Basics_ops['++'],
								{
									ctor: '::',
									_0: A3(_user$project$Lang$ET, _user$project$Lang$Before, _p324._0, _p365),
									_1: {ctor: '[]'}
								},
								A2(
									_elm_lang$core$Basics_ops['++'],
									A2(
										_elm_lang$core$List$map,
										_user$project$Lang$P(_p365),
										_p328),
									A2(
										_elm_lang$core$Basics_ops['++'],
										function () {
											var _p325 = _user$project$Utils$maybeLast(_p328);
											if (_p325.ctor === 'Just') {
												var _p326 = _p325._0;
												return {
													ctor: '::',
													_0: A4(
														_user$project$Lang$PT,
														_user$project$Lang$After,
														A3(_user$project$Lang$withInfo, '', _p326.end, _p326.end),
														_p365,
														_p326),
													_1: {ctor: '[]'}
												};
											} else {
												return {ctor: '[]'};
											}
										}(),
										{
											ctor: '::',
											_0: _user$project$Lang$E(_p327),
											_1: {
												ctor: '::',
												_0: A3(_user$project$Lang$ET, _user$project$Lang$After, _p324._3, _p327),
												_1: {ctor: '[]'}
											}
										})));
						case 'EApp':
							var _p330 = _p324._2;
							return A2(
								_elm_lang$core$Basics_ops['++'],
								{
									ctor: '::',
									_0: A3(_user$project$Lang$ET, _user$project$Lang$Before, _p324._0, _p365),
									_1: {
										ctor: '::',
										_0: _user$project$Lang$E(_p324._1),
										_1: {ctor: '[]'}
									}
								},
								A2(
									_elm_lang$core$Basics_ops['++'],
									A2(_elm_lang$core$List$map, _user$project$Lang$E, _p330),
									function () {
										var _p329 = _user$project$Utils$maybeLast(_p330);
										if (_p329.ctor === 'Just') {
											return {
												ctor: '::',
												_0: A3(_user$project$Lang$ET, _user$project$Lang$After, _p324._3, _p329._0),
												_1: {ctor: '[]'}
											};
										} else {
											return {ctor: '[]'};
										}
									}()));
						case 'EOp':
							var _p332 = _p324._2;
							return A2(
								_elm_lang$core$Basics_ops['++'],
								{
									ctor: '::',
									_0: A3(_user$project$Lang$ET, _user$project$Lang$Before, _p324._0, _p365),
									_1: {ctor: '[]'}
								},
								A2(
									_elm_lang$core$Basics_ops['++'],
									A2(_elm_lang$core$List$map, _user$project$Lang$E, _p332),
									function () {
										var _p331 = _user$project$Utils$maybeLast(_p332);
										if (_p331.ctor === 'Just') {
											return {
												ctor: '::',
												_0: A3(_user$project$Lang$ET, _user$project$Lang$After, _p324._3, _p331._0),
												_1: {ctor: '[]'}
											};
										} else {
											return {ctor: '[]'};
										}
									}()));
						case 'EList':
							var _p337 = _p324._4;
							var _p336 = _p324._1;
							var lastHead = function () {
								var _p333 = _user$project$Utils$maybeLast(_p336);
								if (_p333.ctor === 'Just') {
									return {
										ctor: '::',
										_0: _p333._0,
										_1: {ctor: '[]'}
									};
								} else {
									return {ctor: '[]'};
								}
							}();
							return A2(
								_elm_lang$core$Basics_ops['++'],
								{
									ctor: '::',
									_0: A3(_user$project$Lang$ET, _user$project$Lang$Before, _p324._0, _p365),
									_1: {ctor: '[]'}
								},
								A2(
									_elm_lang$core$Basics_ops['++'],
									A2(_elm_lang$core$List$map, _user$project$Lang$E, _p336),
									function () {
										var _p334 = _p324._3;
										if (_p334.ctor === 'Just') {
											var _p335 = _p334._0;
											return A2(
												_elm_lang$core$Basics_ops['++'],
												A2(
													_elm_lang$core$List$map,
													A2(_user$project$Lang$ET, _user$project$Lang$After, _p324._2),
													lastHead),
												{
													ctor: '::',
													_0: _user$project$Lang$E(_p335),
													_1: {
														ctor: '::',
														_0: A3(_user$project$Lang$ET, _user$project$Lang$After, _p337, _p335),
														_1: {ctor: '[]'}
													}
												});
										} else {
											return A2(
												_elm_lang$core$List$map,
												A2(_user$project$Lang$ET, _user$project$Lang$After, _p337),
												lastHead);
										}
									}()));
						case 'EIf':
							var _p338 = _p324._3;
							return {
								ctor: '::',
								_0: A3(_user$project$Lang$ET, _user$project$Lang$Before, _p324._0, _p365),
								_1: {
									ctor: '::',
									_0: _user$project$Lang$E(_p324._1),
									_1: {
										ctor: '::',
										_0: _user$project$Lang$E(_p324._2),
										_1: {
											ctor: '::',
											_0: _user$project$Lang$E(_p338),
											_1: {
												ctor: '::',
												_0: A3(_user$project$Lang$ET, _user$project$Lang$After, _p324._4, _p338),
												_1: {ctor: '[]'}
											}
										}
									}
								}
							};
						case 'ECase':
							var _p346 = _p324._1;
							var _p345 = _p324._2;
							return A2(
								_elm_lang$core$Basics_ops['++'],
								{
									ctor: '::',
									_0: A3(_user$project$Lang$ET, _user$project$Lang$Before, _p324._0, _p365),
									_1: {
										ctor: '::',
										_0: _user$project$Lang$E(_p346),
										_1: {ctor: '[]'}
									}
								},
								A2(
									_elm_lang$core$Basics_ops['++'],
									function () {
										var _p339 = _elm_lang$core$List$head(_p345);
										if (_p339.ctor === 'Just') {
											var _p340 = _p339._0.val;
											return {
												ctor: '::',
												_0: A3(_user$project$Lang$ET, _user$project$Lang$After, _p340._0, _p346),
												_1: {ctor: '[]'}
											};
										} else {
											return {ctor: '[]'};
										}
									}(),
									A2(
										_elm_lang$core$List$concatMap,
										function (_p341) {
											return function (_p342) {
												var _p343 = _p342;
												var _p344 = _p343._2;
												return {
													ctor: '::',
													_0: A2(_user$project$Lang$P, _p365, _p343._1),
													_1: {
														ctor: '::',
														_0: _user$project$Lang$E(_p344),
														_1: {
															ctor: '::',
															_0: A3(_user$project$Lang$ET, _user$project$Lang$After, _p343._3, _p344),
															_1: {ctor: '[]'}
														}
													}
												};
											}(
												function (_) {
													return _.val;
												}(_p341));
										},
										_p345)));
						case 'ETypeCase':
							var _p354 = _p324._2;
							var _p353 = _p324._1;
							return A2(
								_elm_lang$core$Basics_ops['++'],
								{
									ctor: '::',
									_0: A3(_user$project$Lang$ET, _user$project$Lang$Before, _p324._0, _p365),
									_1: {
										ctor: '::',
										_0: A2(_user$project$Lang$P, _p365, _p353),
										_1: {ctor: '[]'}
									}
								},
								A2(
									_elm_lang$core$Basics_ops['++'],
									function () {
										var _p347 = _elm_lang$core$List$head(_p354);
										if (_p347.ctor === 'Just') {
											var _p348 = _p347._0.val;
											return {
												ctor: '::',
												_0: A4(_user$project$Lang$PT, _user$project$Lang$After, _p348._0, _p365, _p353),
												_1: {ctor: '[]'}
											};
										} else {
											return {ctor: '[]'};
										}
									}(),
									A2(
										_elm_lang$core$List$concatMap,
										function (_p349) {
											return function (_p350) {
												var _p351 = _p350;
												var _p352 = _p351._2;
												return {
													ctor: '::',
													_0: _user$project$Lang$T(_p351._1),
													_1: {
														ctor: '::',
														_0: _user$project$Lang$E(_p352),
														_1: {
															ctor: '::',
															_0: A3(_user$project$Lang$ET, _user$project$Lang$After, _p351._3, _p352),
															_1: {ctor: '[]'}
														}
													}
												};
											}(
												function (_) {
													return _.val;
												}(_p349));
										},
										_p354)));
						case 'ELet':
							var _p362 = _p324._6;
							var _p361 = _p324._3;
							var _p360 = _p324._1;
							var _p359 = _p324._5;
							var _p358 = _p324._4;
							var _p355 = function () {
								var e1Ws = function (_p356) {
									return _user$project$Lang$wsBefore(
										_user$project$Lang$E(_p356));
								}(_p358);
								if (_elm_lang$core$Native_Utils.eq(e1Ws.start.line, e1Ws.end.line)) {
									return {
										ctor: '_Tuple2',
										_0: e1Ws,
										_1: _user$project$Lang$withDummyInfo('')
									};
								} else {
									var breakpoint = {line: e1Ws.start.line + 1, col: 1};
									return {
										ctor: '_Tuple2',
										_0: _elm_lang$core$Native_Utils.update(
											e1Ws,
											{
												end: _elm_lang$core$Native_Utils.update(
													breakpoint,
													{col: 0})
											}),
										_1: _elm_lang$core$Native_Utils.update(
											e1Ws,
											{start: breakpoint})
									};
								}
							}();
							var special1 = _p355._0;
							var special2 = _p355._1;
							return A2(
								_elm_lang$core$Basics_ops['++'],
								{
									ctor: '::',
									_0: A3(_user$project$Lang$ET, _user$project$Lang$Before, _p324._0, _p365),
									_1: {
										ctor: '::',
										_0: _user$project$Lang$LBE(
											{
												start: {
													line: _p365.start.line,
													col: _elm_lang$core$Native_Utils.eq(_p360, _user$project$Lang$Def) ? _p365.start.col : (_p365.start.col + 1)
												},
												end: _elm_lang$core$Native_Utils.eq(_p360, _user$project$Lang$Def) ? _p365.end : _p358.end,
												val: _p365.val.eid
											}),
										_1: {
											ctor: '::',
											_0: A2(_user$project$Lang$P, _p365, _p361),
											_1: {
												ctor: '::',
												_0: A4(_user$project$Lang$PT, _user$project$Lang$After, special1, _p365, _p361),
												_1: {
													ctor: '::',
													_0: A2(
														_user$project$Lang$modifyWsBefore,
														_elm_lang$core$Basics$always(special2),
														_user$project$Lang$E(_p358)),
													_1: {ctor: '[]'}
												}
											}
										}
									}
								},
								function () {
									var _p357 = _p360;
									if (_p357.ctor === 'Let') {
										return {
											ctor: '::',
											_0: _user$project$Lang$E(_p359),
											_1: {
												ctor: '::',
												_0: A3(_user$project$Lang$ET, _user$project$Lang$After, _p362, _p359),
												_1: {ctor: '[]'}
											}
										};
									} else {
										return {
											ctor: '::',
											_0: A3(_user$project$Lang$ET, _user$project$Lang$After, _p362, _p358),
											_1: {
												ctor: '::',
												_0: _user$project$Lang$E(_p359),
												_1: {ctor: '[]'}
											}
										};
									}
								}());
						case 'EComment':
							return {
								ctor: '::',
								_0: A3(_user$project$Lang$ET, _user$project$Lang$Before, _p324._0, _p365),
								_1: {
									ctor: '::',
									_0: _user$project$Lang$E(_p324._2),
									_1: {ctor: '[]'}
								}
							};
						case 'EOption':
							return {
								ctor: '::',
								_0: A3(_user$project$Lang$ET, _user$project$Lang$Before, _p324._0, _p365),
								_1: {
									ctor: '::',
									_0: _user$project$Lang$E(_p324._4),
									_1: {ctor: '[]'}
								}
							};
						case 'ETyp':
							var _p363 = _p324._2;
							return {
								ctor: '::',
								_0: A3(_user$project$Lang$ET, _user$project$Lang$Before, _p324._0, _p365),
								_1: {
									ctor: '::',
									_0: A2(_user$project$Lang$P, _p365, _p324._1),
									_1: {
										ctor: '::',
										_0: _user$project$Lang$T(_p363),
										_1: {
											ctor: '::',
											_0: A3(_user$project$Lang$TT, _user$project$Lang$After, _p324._4, _p363),
											_1: {
												ctor: '::',
												_0: _user$project$Lang$E(_p324._3),
												_1: {ctor: '[]'}
											}
										}
									}
								}
							};
						case 'EColonType':
							return {
								ctor: '::',
								_0: _user$project$Lang$E(_p324._1),
								_1: {
									ctor: '::',
									_0: _user$project$Lang$T(_p324._3),
									_1: {ctor: '[]'}
								}
							};
						default:
							var _p364 = _p324._2;
							return {
								ctor: '::',
								_0: A3(_user$project$Lang$ET, _user$project$Lang$Before, _p324._0, _p365),
								_1: {
									ctor: '::',
									_0: A2(_user$project$Lang$P, _p365, _p324._1),
									_1: {
										ctor: '::',
										_0: _user$project$Lang$T(_p364),
										_1: {
											ctor: '::',
											_0: A3(_user$project$Lang$TT, _user$project$Lang$After, _p324._4, _p364),
											_1: {
												ctor: '::',
												_0: _user$project$Lang$E(_p324._3),
												_1: {ctor: '[]'}
											}
										}
									}
								}
							};
					}
				case 'P':
					var _p373 = _p323._1;
					var _p372 = _p323._0;
					var _p366 = _p373.val.p__;
					switch (_p366.ctor) {
						case 'PVar':
							return {
								ctor: '::',
								_0: A4(_user$project$Lang$PT, _user$project$Lang$Before, _p366._0, _p372, _p373),
								_1: {ctor: '[]'}
							};
						case 'PConst':
							return {
								ctor: '::',
								_0: A4(_user$project$Lang$PT, _user$project$Lang$Before, _p366._0, _p372, _p373),
								_1: {ctor: '[]'}
							};
						case 'PBase':
							return {
								ctor: '::',
								_0: A4(_user$project$Lang$PT, _user$project$Lang$Before, _p366._0, _p372, _p373),
								_1: {ctor: '[]'}
							};
						case 'PList':
							var _p371 = _p366._4;
							var _p370 = _p366._1;
							var lastHead = function () {
								var _p367 = _user$project$Utils$maybeLast(_p370);
								if (_p367.ctor === 'Just') {
									return {
										ctor: '::',
										_0: _p367._0,
										_1: {ctor: '[]'}
									};
								} else {
									return {ctor: '[]'};
								}
							}();
							return A2(
								_elm_lang$core$Basics_ops['++'],
								{
									ctor: '::',
									_0: A4(_user$project$Lang$PT, _user$project$Lang$Before, _p366._0, _p372, _p373),
									_1: {ctor: '[]'}
								},
								A2(
									_elm_lang$core$Basics_ops['++'],
									A2(
										_elm_lang$core$List$map,
										_user$project$Lang$P(_p372),
										_p370),
									function () {
										var _p368 = _p366._3;
										if (_p368.ctor === 'Just') {
											var _p369 = _p368._0;
											return A2(
												_elm_lang$core$Basics_ops['++'],
												A2(
													_elm_lang$core$List$map,
													A3(_user$project$Lang$PT, _user$project$Lang$After, _p366._2, _p372),
													lastHead),
												{
													ctor: '::',
													_0: A2(_user$project$Lang$P, _p372, _p369),
													_1: {
														ctor: '::',
														_0: A4(_user$project$Lang$PT, _user$project$Lang$After, _p371, _p372, _p369),
														_1: {ctor: '[]'}
													}
												});
										} else {
											return A2(
												_elm_lang$core$List$map,
												A3(_user$project$Lang$PT, _user$project$Lang$After, _p371, _p372),
												lastHead);
										}
									}()));
						default:
							return {
								ctor: '::',
								_0: A4(_user$project$Lang$PT, _user$project$Lang$Before, _p366._0, _p372, _p373),
								_1: {
									ctor: '::',
									_0: A2(_user$project$Lang$P, _p372, _p366._3),
									_1: {ctor: '[]'}
								}
							};
					}
				case 'T':
					var _p387 = _p323._0;
					var _p374 = _p387.val;
					switch (_p374.ctor) {
						case 'TNum':
							return {
								ctor: '::',
								_0: A3(_user$project$Lang$TT, _user$project$Lang$Before, _p374._0, _p387),
								_1: {ctor: '[]'}
							};
						case 'TBool':
							return {
								ctor: '::',
								_0: A3(_user$project$Lang$TT, _user$project$Lang$Before, _p374._0, _p387),
								_1: {ctor: '[]'}
							};
						case 'TString':
							return {
								ctor: '::',
								_0: A3(_user$project$Lang$TT, _user$project$Lang$Before, _p374._0, _p387),
								_1: {ctor: '[]'}
							};
						case 'TNull':
							return {
								ctor: '::',
								_0: A3(_user$project$Lang$TT, _user$project$Lang$Before, _p374._0, _p387),
								_1: {ctor: '[]'}
							};
						case 'TList':
							var _p375 = _p374._1;
							return {
								ctor: '::',
								_0: A3(_user$project$Lang$TT, _user$project$Lang$Before, _p374._0, _p387),
								_1: {
									ctor: '::',
									_0: _user$project$Lang$T(_p375),
									_1: {
										ctor: '::',
										_0: A3(_user$project$Lang$TT, _user$project$Lang$After, _p374._2, _p375),
										_1: {ctor: '[]'}
									}
								}
							};
						case 'TDict':
							var _p376 = _p374._2;
							return {
								ctor: '::',
								_0: A3(_user$project$Lang$TT, _user$project$Lang$Before, _p374._0, _p387),
								_1: {
									ctor: '::',
									_0: _user$project$Lang$T(_p374._1),
									_1: {
										ctor: '::',
										_0: _user$project$Lang$T(_p376),
										_1: {
											ctor: '::',
											_0: A3(_user$project$Lang$TT, _user$project$Lang$After, _p374._3, _p376),
											_1: {ctor: '[]'}
										}
									}
								}
							};
						case 'TTuple':
							var _p381 = _p374._4;
							var _p380 = _p374._1;
							var lastHead = function () {
								var _p377 = _user$project$Utils$maybeLast(_p380);
								if (_p377.ctor === 'Just') {
									return {
										ctor: '::',
										_0: _p377._0,
										_1: {ctor: '[]'}
									};
								} else {
									return {ctor: '[]'};
								}
							}();
							return A2(
								_elm_lang$core$Basics_ops['++'],
								{
									ctor: '::',
									_0: A3(_user$project$Lang$TT, _user$project$Lang$Before, _p374._0, _p387),
									_1: {ctor: '[]'}
								},
								A2(
									_elm_lang$core$Basics_ops['++'],
									A2(_elm_lang$core$List$map, _user$project$Lang$T, _p380),
									function () {
										var _p378 = _p374._3;
										if (_p378.ctor === 'Just') {
											var _p379 = _p378._0;
											return A2(
												_elm_lang$core$Basics_ops['++'],
												A2(
													_elm_lang$core$List$map,
													A2(_user$project$Lang$TT, _user$project$Lang$After, _p374._2),
													lastHead),
												{
													ctor: '::',
													_0: _user$project$Lang$T(_p379),
													_1: {
														ctor: '::',
														_0: A3(_user$project$Lang$TT, _user$project$Lang$After, _p381, _p379),
														_1: {ctor: '[]'}
													}
												});
										} else {
											return A2(
												_elm_lang$core$List$map,
												A2(_user$project$Lang$TT, _user$project$Lang$After, _p381),
												lastHead);
										}
									}()));
						case 'TArrow':
							var _p383 = _p374._1;
							var lastHead = function () {
								var _p382 = _user$project$Utils$maybeLast(_p383);
								if (_p382.ctor === 'Just') {
									return {
										ctor: '::',
										_0: _p382._0,
										_1: {ctor: '[]'}
									};
								} else {
									return {ctor: '[]'};
								}
							}();
							return A2(
								_elm_lang$core$Basics_ops['++'],
								{
									ctor: '::',
									_0: A3(_user$project$Lang$TT, _user$project$Lang$Before, _p374._0, _p387),
									_1: {ctor: '[]'}
								},
								A2(
									_elm_lang$core$Basics_ops['++'],
									A2(_elm_lang$core$List$map, _user$project$Lang$T, _p383),
									A2(
										_elm_lang$core$List$map,
										A2(_user$project$Lang$TT, _user$project$Lang$After, _p374._2),
										lastHead)));
						case 'TUnion':
							var _p385 = _p374._1;
							var lastHead = function () {
								var _p384 = _user$project$Utils$maybeLast(_p385);
								if (_p384.ctor === 'Just') {
									return {
										ctor: '::',
										_0: _p384._0,
										_1: {ctor: '[]'}
									};
								} else {
									return {ctor: '[]'};
								}
							}();
							return A2(
								_elm_lang$core$Basics_ops['++'],
								{
									ctor: '::',
									_0: A3(_user$project$Lang$TT, _user$project$Lang$Before, _p374._0, _p387),
									_1: {ctor: '[]'}
								},
								A2(
									_elm_lang$core$Basics_ops['++'],
									A2(_elm_lang$core$List$map, _user$project$Lang$T, _p385),
									A2(
										_elm_lang$core$List$map,
										A2(_user$project$Lang$TT, _user$project$Lang$After, _p374._2),
										lastHead)));
						case 'TNamed':
							return {
								ctor: '::',
								_0: A3(_user$project$Lang$TT, _user$project$Lang$Before, _p374._0, _p387),
								_1: {ctor: '[]'}
							};
						case 'TVar':
							return {
								ctor: '::',
								_0: A3(_user$project$Lang$TT, _user$project$Lang$Before, _p374._0, _p387),
								_1: {ctor: '[]'}
							};
						case 'TForall':
							var _p386 = _p374._2;
							return {
								ctor: '::',
								_0: A3(_user$project$Lang$TT, _user$project$Lang$Before, _p374._0, _p387),
								_1: {
									ctor: '::',
									_0: _user$project$Lang$T(_p386),
									_1: {
										ctor: '::',
										_0: A3(_user$project$Lang$TT, _user$project$Lang$After, _p374._3, _p386),
										_1: {ctor: '[]'}
									}
								}
							};
						default:
							return {
								ctor: '::',
								_0: A3(_user$project$Lang$TT, _user$project$Lang$Before, _p374._0, _p387),
								_1: {ctor: '[]'}
							};
					}
				case 'LBE':
					return {ctor: '[]'};
				case 'ET':
					return {ctor: '[]'};
				case 'PT':
					return {ctor: '[]'};
				default:
					return {ctor: '[]'};
			}
		}());
};
var _user$project$Lang$flattenToCodeObjects = function (codeObject) {
	return {
		ctor: '::',
		_0: codeObject,
		_1: A2(
			_elm_lang$core$List$concatMap,
			_user$project$Lang$flattenToCodeObjects,
			_user$project$Lang$childCodeObjects(codeObject))
	};
};
var _user$project$Lang$foldCode = F3(
	function (f, acc, code) {
		return A3(
			_elm_lang$core$List$foldl,
			f,
			acc,
			_user$project$Lang$flattenToCodeObjects(code));
	});
var _user$project$Lang$hasPatWithPid = function (pid) {
	return function (_p388) {
		return A2(
			_user$project$Utils$hasMatchingElement,
			_user$project$Lang$hasPid(pid),
			_user$project$Lang$childCodeObjects(
				_user$project$Lang$E(_p388)));
	};
};

var _user$project$PreludeGenerated$prelude = '\n; prelude.little\n;\n; This little library is accessible by every program.\n; This is not an example that generates an SVG canvas,\n; but we include it here for reference.\n\n;; The identity function - given a value, returns exactly that value\n(typ id (forall a (-> a a)))\n(def id (\\x x))\n\n;; A function that always returns the same value a, regardless of b\n(typ always (forall (a b) (-> a b a)))\n(def always (\\(x _) x))\n\n;; Composes two functions together\n(typ compose (forall (a b c) (-> (-> b c) (-> a b) (-> a c))))\n(def compose (\\(f g) (\\x (f (g x)))))\n\n(typ flip (forall (a b c) (-> (-> a b c) (-> b a c))))\n(def flip (\\f (\\(x y) (f y x))))\n  ; TODO other version:\n  ; (def flip (\\(f x y) (f y x)))\n\n(typ fst (forall (a b) (-> [a b] a)))\n(typ snd (forall (a b) (-> [a b] b)))\n\n(def fst (\\[a _] a))\n(def snd (\\[_ b] b))\n\n;; Given a bool, returns the opposite boolean value\n(typ not (-> Bool Bool))\n(def not (\\b (if b false true)))\n\n;; Given two bools, returns a bool regarding if the first argument is true, then the second argument is as well\n(typ implies (-> Bool Bool Bool))\n(def implies (\\(p q) (if p q true)))\n\n(typ or  (-> Bool Bool Bool))\n(typ and (-> Bool Bool Bool))\n\n(def or  (\\(p q) (if p true q)))\n(def and (\\(p q) (if p q false)))\n\n(typ lt (-> Num Num Bool))\n(typ eq (-> Num Num Bool))\n(typ le (-> Num Num Bool))\n(typ gt (-> Num Num Bool))\n(typ ge (-> Num Num Bool))\n\n(def lt (\\(x y) (< x y)))\n(def eq (\\(x y) (= x y)))\n(def le (\\(x y) (or (lt x y) (eq x y))))\n(def gt (flip lt))\n(def ge (\\(x y) (or (gt x y) (eq x y))))\n\n;; Returns the length of a given list\n(typ len (forall a (-> (List a) Num)))\n(defrec len (\\xs (case xs ([] 0) ([_ | xs1] (+ 1 (len xs1))))))\n\n;; Maps a function, f, over a list of values and returns the resulting list\n(typ map (forall (a b) (-> (-> a b) (List a) (List b))))\n(defrec map (\\(f xs)\n  (case xs ([] []) ([hd|tl] [(f hd)|(map f tl)]))))\n\n;; Combines two lists with a given function, extra elements are dropped\n(typ map2 (forall (a b c) (-> (-> a b c) (List a) (List b) (List c))))\n(defrec map2 (\\(f xs ys)\n  (case [xs ys]\n    ([[x|xs1] [y|ys1]] [ (f x y) | (map2 f xs1 ys1) ])\n    (_                 []))))\n\n;; Combines three lists with a given function, extra elements are dropped\n(typ map3 (forall (a b c d) (-> (-> a b c d) (List a) (List b) (List c) (List d))))\n(defrec map3 (\\(f xs ys zs)\n  (case [xs ys zs]\n    ([[x|xs1] [y|ys1] [z|zs1]] [ (f x y z) | (map3 f xs1 ys1 zs1) ])\n    (_                         []))))\n\n;; Combines four lists with a given function, extra elements are dropped\n(typ map4 (forall (a b c d e) (-> (-> a b c d e) (List a) (List b) (List c) (List d) (List e))))\n(defrec map4 (\\(f ws xs ys zs)\n  (case [ws xs ys zs]\n    ([[w|ws1] [x|xs1] [y|ys1] [z|zs1]] [ (f w x y z) | (map4 f ws1 xs1 ys1 zs1) ])\n    (_                                 []))))\n\n;; Takes a function, an accumulator, and a list as input and reduces using the function from the left\n(typ foldl (forall (a b) (-> (-> a b b) b (List a) b)))\n(defrec foldl (\\(f acc xs)\n  (case xs ([] acc) ([x|xs1] (foldl f (f x acc) xs1)))))\n\n;; Takes a function, an accumulator, and a list as input and reduces using the function from the right\n(typ foldr (forall (a b) (-> (-> a b b) b (List a) b)))\n(defrec foldr (\\(f acc xs)\n  (case xs ([] acc) ([x|xs1] (f x (foldr f acc xs1))))))\n\n;; Given two lists, append the second list to the end of the first\n(typ append (forall a (-> (List a) (List a) (List a))))\n(defrec append (\\(xs ys)\n  (case xs ([] ys) ([x|xs1] [ x | (append xs1 ys)]))))\n\n;; concatenate a list of lists into a single list\n(typ concat (forall a (-> (List (List a)) (List a))))\n(def concat (\\xss (foldr append [] xss)))\n  ; TODO eta-reduced version:\n  ; (def concat (foldr append []))\n\n;; Map a given function over a list and concatenate the resulting list of lists\n(typ concatMap (forall (a b) (-> (-> a (List b)) (List a) (List b))))\n(def concatMap (\\(f xs) (concat (map f xs))))\n\n;; Takes two lists and returns a list that is their cartesian product\n(typ cartProd (forall (a b) (-> (List a) (List b) (List [a b]))))\n(def cartProd (\\(xs ys)\n  (concatMap (\\x (map (\\y [x y]) ys)) xs)))\n\n;; Takes elements at the same position from two input lists and returns a list of pairs of these elements\n(typ zip (forall (a b) (-> (List a) (List b) (List [a b]))))\n(def zip (\\(xs ys) (map2 (\\(x y) [x y]) xs ys)))\n  ; TODO eta-reduced version:\n  ; (def zip (map2 (\\(x y) [x y])))\n\n;; The empty list\n;; (typ nil (forall a (List a)))\n(typ nil [])\n(def nil [])\n\n;; attaches an element to the front of a list\n(typ cons (forall a (-> a (List a) (List a))))\n(def cons (\\(x xs) [x | xs]))\n\n;; attaches an element to the end of a list\n(typ snoc (forall a (-> a (List a) (List a))))\n(def snoc (\\(x ys) (append ys [x])))\n\n;; Returns the first element of a given list\n(typ hd (forall a (-> (List a) a)))\n(def hd (\\[x|xs] x))\n\n(typ tl (forall a (-> (List a) (List a))))\n(def tl (\\[x|xs] xs))\n\n;; Returns the last element of a given list\n(typ last (forall a (-> (List a) a)))\n(defrec last (\\xs\n  (case xs\n    ([x]    x)\n    ([_|xs] (last xs)))))\n\n;; Given a list, reverse its order\n(typ reverse (forall a (-> (List a) (List a))))\n(def reverse (\\xs (foldl cons nil xs)))\n  ; TODO eta-reduced version:\n  ; (def reverse (foldl cons nil))\n\n;; Given two numbers, creates the list between them (inclusive)\n(typ range (-> Num Num (List Num)))\n(defrec range (\\(i j)\n  (if (< i (+ j 1))\n      (cons i (range (+ i 1) j))\n      nil)))\n\n;; Given a number, create the list of 0 to that number inclusive (number must be > 0)\n(typ list0N (-> Num (List Num)))\n(def list0N (\\n (range 0 n)))\n\n;; Given a number, create the list of 1 to that number inclusive\n(typ list1N (-> Num (List Num)))\n(def list1N (\\n (range 1 n)))\n\n(typ zeroTo (-> Num (List Num)))\n(def zeroTo (\\n (range 0 (- n 1))))\n\n;; Given a number n and some value x, return a list with x repeated n times\n(typ repeat (forall a (-> Num a (List a))))\n(def repeat (\\(n x) (map (always x) (range 1 n))))\n\n;; Given two lists, return a single list that alternates between their values (first element is from first list)\n(typ intermingle (forall a (-> (List a) (List a) (List a))))\n(defrec intermingle (\\(xs ys)\n  (case [xs ys]\n    ([[x|xs1] [y|ys1]] (cons x (cons y (intermingle xs1 ys1))))\n    ([[]      []]      nil)\n    (_                 (append xs ys)))))\n\n(def intersperse (\\(sep xs)\n  (case xs\n    ([]     xs)\n    ([x|xs] (reverse (foldl (\\(y acc) [ y sep | acc ]) [x] xs))))))\n\n(typ mapi (forall (a b) (-> (-> [Num a] b) (List a) (List b))))\n(def mapi (\\(f xs) (map f (zip (range 0 (- (len xs) 1)) xs))))\n\n\n(typ nth (forall a (-> (List a) Num (union Null a))))\n(defrec nth (\\(xs n)\n  (if (< n 0)       null\n    (case [n xs]\n      ([_ []]       null)\n      ([0 [x|xs1]]  x)\n      ([_ [x|xs1]]  (nth xs1 (- n 1)))))))\n\n; (defrec nth (\\(xs n)\n;   (if (< n 0)   \'ERROR: nth\'\n;     (case xs\n;       ([]       \'ERROR: nth\')\n;       ([x|xs1]  (if (= n 0) x (nth xs1 (- n 1))))))))\n\n; TODO change typ/def\n; (typ take (forall a (-> (List a) Num (union Null (List a)))))\n\n(typ take (forall a (-> (List a) Num (List (union Null a)))))\n(defrec take (\\(xs n)\n  (if (= n 0) []\n    (case xs\n      ([]      [null])\n      ([x|xs1] [x | (take xs1 (- n 1))])))))\n\n; (def take\n;   (letrec take_ (\\(n xs)\n;     (case [n xs]\n;       ([0 _]       [])\n;       ([_ []]      [])\n;       ([_ [x|xs1]] [x | (take_ (- n 1) xs1)])))\n;   (compose take_ (max 0))))\n\n(typ drop (forall a (-> (List a) Num (union Null (List a)))))\n(defrec drop (\\(xs n)\n  (if (le n 0)\n    xs\n    (case xs\n      ([]      null)\n      ([x|xs1] (drop xs1 (- n 1)))))))\n\n;; Drop n elements from the end of a list\n(typ dropEnd (forall a (-> (List a) Num (union Null (List a)))))\n(def dropEnd (\\(xs n)\n  (let tryDrop (drop (reverse xs) n)\n  (typecase tryDrop\n    (Null null)\n    (_    (reverse tryDrop))))))\n\n(typ elem (forall a (-> a (List a) Bool)))\n(defrec elem (\\(x ys)\n  (case ys\n    ([]      false)\n    ([y|ys1] (or (= x y) (elem x ys1))))))\n\n(def sortBy (\\(f xs)\n  (letrec ins (\\(x ys)   ; insert is a keyword...\n    (case ys\n      ([]     [x])\n      ([y|ys] (if (f x y) [x y | ys] [y | (ins x ys)]))))\n  (foldl ins [] xs))))\n\n(def sortAscending (sortBy lt))\n(def sortDescending (sortBy gt))\n\n\n;; multiply two numbers and return the result\n(typ mult (-> Num Num Num))\n(defrec mult (\\(m n)\n  (if (< m 1) 0 (+ n (mult (+ m -1) n)))))\n\n;; Given two numbers, subtract the second from the first\n(typ minus (-> Num Num Num))\n(def minus (\\(x y) (+ x (mult y -1))))\n\n;; Given two numbers, divide the first by the second\n(typ div (-> Num Num Num))\n(defrec div (\\(m n)\n  (if (< m n) 0\n  (if (< n 2) m\n    (+ 1 (div (minus m n) n))))))\n\n;; Given a number, returns the negative of that number\n(typ neg (-> Num Num))\n(def neg (\\x (- 0 x)))\n\n;; Absolute value\n(typ abs (-> Num Num))\n(def abs (\\x (if (< x 0) (neg x) x)))\n\n;; Sign function; -1, 0, or 1 based on sign of given number\n(typ sgn (-> Num Num))\n(def sgn (\\x (if (= 0 x) 0 (/ x (abs x)))))\n\n(typ some (forall a (-> (-> a Bool) (List a) Bool)))\n(defrec some (\\(p xs)\n  (case xs\n    ([]      false)\n    ([x|xs1] (or (p x) (some p xs1))))))\n\n(typ all (forall a (-> (-> a Bool) (List a) Bool)))\n(defrec all (\\(p xs)\n  (case xs\n    ([]      true)\n    ([x|xs1] (and (p x) (all p xs1))))))\n\n;; Given an upper bound, lower bound, and a number, restricts that number between those bounds (inclusive)\n;; Ex. clamp 1 5 4 = 4\n;; Ex. clamp 1 5 6 = 5\n(typ clamp (-> Num Num Num Num))\n(def clamp (\\(i j n) (if (< n i) i (if (< j n) j n))))\n\n(typ between (-> Num Num Num Bool))\n(def between (\\(i j n) (= n (clamp i j n))))\n\n(typ plus (-> Num Num Num))\n(def plus (\\(x y) (+ x y)))\n\n(typ min (-> Num Num Num))\n(def min (\\(i j) (if (lt i j) i j)))\n\n(typ max (-> Num Num Num))\n(def max (\\(i j) (if (gt i j) i j)))\n\n(typ minimum (-> (List Num) Num))\n(def minimum (\\[hd|tl] (foldl min hd tl)))\n\n(typ maximum (-> (List Num) Num))\n(def maximum (\\[hd|tl] (foldl max hd tl)))\n\n(typ average (-> (List Num) Num))\n(def average (\\nums\n  (let sum (foldl plus 0 nums)\n  (let n   (len nums)\n    (/ sum n)))))\n\n;; Combine a list of strings with a given separator\n;; Ex. joinStrings \', \' [\'hello\' \'world\'] = \'hello, world\'\n(typ joinStrings (-> String (List String) String))\n(def joinStrings (\\(sep ss)\n  (foldr (\\(str acc) (if (= acc \'\') str (+ str (+ sep acc)))) \'\' ss)))\n\n;; Concatenate a list of strings and return the resulting string\n(typ concatStrings (-> (List String) String))\n(def concatStrings (joinStrings \'\'))\n\n;; Concatenates a list of strings, interspersing a single space in between each string\n(typ spaces (-> (List String) String))\n(def spaces (joinStrings \' \'))\n\n;; First two arguments are appended at the front and then end of the third argument correspondingly\n;; Ex. delimit \'+\' \'+\' \'plus\' = \'+plus+\'\n(typ delimit (-> String String String String))\n(def delimit (\\(a b s) (concatStrings [a s b])))\n\n;; delimit a string with parentheses\n(typ parens (-> String String))\n(def parens (delimit \'(\' \')\'))\n\n;\n; SVG Manipulating Functions\n;\n\n; === SVG Types ===\n\n(def Point [Num Num])\n(def RGBA [Num Num Num Num])\n(def Color (union String Num RGBA))\n(def PathCmds (List (union String Num)))\n(def Points (List Point))\n(def RotationCmd [[String Num Num Num]])\n(def AttrVal (union String Num Bool Color PathCmds Points RotationCmd))\n(def AttrName String)\n(def AttrPair [AttrName AttrVal])\n(def Attrs (List AttrPair))\n(def NodeKind String)\n; TODO add recursive types properly\n(def SVG [NodeKind Attrs (List SVG_or_Text)])\n(def SVG_or_Text (union SVG [String String]))\n(def Blob (List SVG))\n\n; === Attribute Lookup ===\n\n(typ lookupWithDefault (forall (k v) (-> v k (List [k v]) v)))\n(defrec lookupWithDefault (\\(default k dict)\n  (let foo (lookupWithDefault default k)\n  (case dict\n    ([]            default)\n    ([[k1 v]|rest] (if (= k k1) v (foo rest)))))))\n\n(typ lookup (forall (k v) (-> k (List [k v]) (union v Null))))\n(defrec lookup (\\(k dict)\n  (let foo (lookup k)\n  (case dict\n    ([]            null)\n    ([[k1 v]|rest] (if (= k k1) v (foo rest)))))))\n\n(typ addExtras (-> Num (List [String (List [Num AttrVal])]) SVG SVG))\n(defrec addExtras (\\(i extras shape)\n  (case extras\n    ([] shape)\n    ([[k table] | rest]\n      (let v (lookup i table)\n      (typecase v\n        (Null    (addExtras i rest shape))\n        (AttrVal (addExtras i rest (addAttr shape [k v])))))))))\n\n(typ lookupAttr (-> SVG AttrName (union AttrVal Null)))\n(def lookupAttr (\\([_ attrs _] k) (lookup k attrs)))\n\n(typ lookupAttrWithDefault (-> AttrVal SVG AttrName AttrVal))\n(def lookupAttrWithDefault (\\(default [_ attrs _] k) (lookupWithDefault default k attrs)))\n\n; Pairs of Type-Specific Lookup Functions\n\n(typ lookupNumAttr (-> SVG AttrName (union Num Null)))\n(def lookupNumAttr (\\([_ attrs _] k)\n  (let val (lookup k attrs)\n  (typecase val (Num val) (_ null)))))\n\n(typ lookupNumAttrWithDefault (-> Num SVG AttrName Num))\n(def lookupNumAttrWithDefault (\\(default shape k)\n  (let val (lookupNumAttr shape k)\n  (typecase val (Num val) (Null default)))))\n\n(typ lookupPointsAttr (-> SVG AttrName (union Points Null)))\n(def lookupPointsAttr (\\([_ attrs _] k)\n  (let val (lookup k attrs)\n  (typecase val ((List [Num Num]) val) (_ null)))))\n\n(typ lookupPointsAttrWithDefault (-> Points SVG AttrName Points))\n(def lookupPointsAttrWithDefault (\\(default shape k)\n  (let val (lookupPointsAttr shape k)\n  (typecase val ((List [Num Num]) val) (Null default)))))\n\n(typ lookupStringAttr (-> SVG AttrName (union String Null)))\n(def lookupStringAttr (\\([_ attrs _] k)\n  (let val (lookup k attrs)\n  (typecase val (String val) (_ null)))))\n\n(typ lookupStringAttrWithDefault (-> String SVG AttrName String))\n(def lookupStringAttrWithDefault (\\(default shape k)\n  (let val (lookupStringAttr shape k)\n  (typecase val (String val) (Null default)))))\n\n; === Points ===\n\n(def Vec2D [Num Num])\n\n(typ vec2DPlus (-> Point Vec2D Point))\n(def vec2DPlus (\\(pt vec)\n  [\n    (+ (fst pt) (fst vec))\n    (+ (snd pt) (snd vec))\n  ]\n))\n\n(typ vec2DMinus (-> Point Point Vec2D))\n(def vec2DMinus (\\(pt vec)\n  [\n    (- (fst pt) (fst vec))\n    (- (snd pt) (snd vec))\n  ]\n))\n\n(typ vec2DScalarMult (-> Num Vec2D Point))\n(def vec2DScalarMult (\\(num vec)\n  [\n    (* (fst vec) num)\n    (* (snd vec) num)\n  ]\n))\n\n(typ vec2DScalarDiv (-> Num Vec2D Point))\n(def vec2DScalarDiv (\\(num vec)\n  [\n    (/ (fst vec) num)\n    (/ (snd vec) num)\n  ]\n))\n\n(typ vec2DLength (-> Point Point Num))\n(def vec2DLength (\\([x1 y1] [x2 y2])\n  (let [dx dy] [(- x2 x1) (- y2 y1)]\n  (sqrt (+ (* dx dx) (* dy dy))))))\n\n\n; === Circles ===\n\n(def Circle SVG)\n\n;; argument order - color, x, y, radius\n;; creates a circle, center at (x,y) with given radius and color\n(typ circle (-> Color Num Num Num Circle))\n(def circle (\\(fill cx cy r)\n  [\'circle\'\n     [[\'cx\' cx] [\'cy\' cy] [\'r\' r] [\'fill\' fill]]\n     []]))\n\n(typ circleCenter (-> Ellipse Point))\n(def circleCenter (\\circle\n  [\n    (lookupNumAttrWithDefault 0 circle \'cx\')\n    (lookupNumAttrWithDefault 0 circle \'cy\')\n  ]\n))\n\n(typ circleRadius (-> Circle Num))\n(def circleRadius (\\circle\n  (lookupNumAttrWithDefault 0 circle \'r\')\n))\n\n(typ circleDiameter (-> Circle Num))\n(def circleDiameter (\\circle\n  (* 2 (circleRadius circle))\n))\n\n(typ circleNorth (-> Circle Point))\n(def circleNorth (\\circle\n  (let [cx cy] (circleCenter circle)\n    [cx (- cy (circleRadius circle))]\n  )\n))\n\n(typ circleEast (-> Circle Point))\n(def circleEast (\\circle\n  (let [cx cy] (circleCenter circle)\n    [(+ cx (circleRadius circle)) cy]\n  )\n))\n\n(typ circleSouth (-> Circle Point))\n(def circleSouth (\\circle\n  (let [cx cy] (circleCenter circle)\n    [cx (+ cy (circleRadius circle))]\n  )\n))\n\n(typ circleWest (-> Circle Point))\n(def circleWest (\\circle\n  (let [cx cy] (circleCenter circle)\n    [(- cx (circleRadius circle)) cy]\n  )\n))\n\n\n;; argument order - color, width, x, y, radius\n;; Just as circle, except new width parameter determines thickness of ring\n(typ ring (-> Color Num Num Num Num SVG))\n(def ring (\\(c w x y r)\n  [\'circle\'\n     [ [\'cx\' x] [\'cy\' y] [\'r\' r] [\'fill\' \'none\'] [\'stroke\' c] [\'stroke-width\' w] ]\n     []]))\n\n\n; === Ellipses ===\n\n(def Ellipse SVG)\n\n;; argument order - color, x, y, x-radius, y-radius\n;; Just as circle, except radius is separated into x and y parameters\n(typ ellipse (-> Color Num Num Num Num Ellipse))\n(def ellipse (\\(fill x y rx ry)\n  [\'ellipse\'\n     [ [\'cx\' x] [\'cy\' y] [\'rx\' rx] [\'ry\' ry] [\'fill\' fill] ]\n     []]))\n\n(typ ellipseCenter (-> Ellipse Point))\n(def ellipseCenter (\\ellipse\n  [\n    (lookupNumAttrWithDefault 0 ellipse \'cx\')\n    (lookupNumAttrWithDefault 0 ellipse \'cy\')\n  ]\n))\n\n(typ ellipseRadiusX (-> Ellipse Num))\n(def ellipseRadiusX (\\ellipse\n  (lookupNumAttrWithDefault 0 ellipse \'rx\')\n))\n\n(typ ellipseRadiusY (-> Ellipse Num))\n(def ellipseRadiusY (\\ellipse\n  (lookupNumAttrWithDefault 0 ellipse \'ry\')\n))\n\n(typ ellipseDiameterX (-> Ellipse Num))\n(def ellipseDiameterX (\\ellipse\n  (* 2 (ellipseRadiusX ellipse))\n))\n\n(typ ellipseDiameterY (-> Ellipse Num))\n(def ellipseDiameterY (\\ellipse\n  (* 2 (ellipseRadiusY ellipse))\n))\n\n(typ ellipseNorth (-> Ellipse Point))\n(def ellipseNorth (\\ellipse\n  (let [cx cy] (ellipseCenter ellipse)\n    [cx (- cy (ellipseRadiusY ellipse))]\n  )\n))\n\n(typ ellipseEast (-> Ellipse Point))\n(def ellipseEast (\\ellipse\n  (let [cx cy] (ellipseCenter ellipse)\n    [(+ cx (ellipseRadiusX ellipse)) cy]\n  )\n))\n\n(typ ellipseSouth (-> Ellipse Point))\n(def ellipseSouth (\\ellipse\n  (let [cx cy] (ellipseCenter ellipse)\n    [cx (+ cy (ellipseRadiusY ellipse))]\n  )\n))\n\n(typ ellipseWest (-> Ellipse Point))\n(def ellipseWest (\\ellipse\n  (let [cx cy] (ellipseCenter ellipse)\n    [(- cx (ellipseRadiusX ellipse)) cy]\n  )\n))\n\n\n; === Bounds-based shapes (Oval and Box) ===\n\n(def BoundedShape SVG)\n(def Bounds [Num Num Num Num])\n\n(typ boundedShapeLeft (-> BoundedShape Num))\n(def boundedShapeLeft (\\shape\n  (lookupNumAttrWithDefault 0 shape \'LEFT\')\n))\n\n(typ boundedShapeTop (-> BoundedShape Num))\n(def boundedShapeTop (\\shape\n  (lookupNumAttrWithDefault 0 shape \'TOP\')\n))\n\n(typ boundedShapeRight (-> BoundedShape Num))\n(def boundedShapeRight (\\shape\n  (lookupNumAttrWithDefault 0 shape \'RIGHT\')\n))\n\n(typ boundedShapeBot (-> BoundedShape Num))\n(def boundedShapeBot (\\shape\n  (lookupNumAttrWithDefault 0 shape \'BOT\')\n))\n\n(typ boundedShapeWidth (-> BoundedShape Num))\n(def boundedShapeWidth (\\shape\n  (- (boundedShapeRight shape) (boundedShapeLeft shape))\n))\n\n(typ boundedShapeHeight (-> BoundedShape Num))\n(def boundedShapeHeight (\\shape\n  (- (boundedShapeBot shape) (boundedShapeTop shape))\n))\n\n(typ boundedShapeLeftTop (-> BoundedShape Point))\n(def boundedShapeLeftTop (\\shape\n  [\n    (boundedShapeLeft shape)\n    (boundedShapeTop shape)\n  ]\n))\n\n(typ boundedShapeCenterTop (-> BoundedShape Point))\n(def boundedShapeCenterTop (\\shape\n  [\n    (/ (+ (boundedShapeLeft shape) (boundedShapeRight shape)) 2)\n    (boundedShapeTop shape)\n  ]\n))\n\n(typ boundedShapeRightTop (-> BoundedShape Point))\n(def boundedShapeRightTop (\\shape\n  [\n    (boundedShapeRight shape)\n    (boundedShapeTop shape)\n  ]\n))\n\n(typ boundedShapeRightCenter (-> BoundedShape Point))\n(def boundedShapeRightCenter (\\shape\n  [\n    (boundedShapeRight shape)\n    (/ (+ (boundedShapeTop shape) (boundedShapeBot shape)) 2)\n  ]\n))\n\n(typ boundedShapeRightBot (-> BoundedShape Point))\n(def boundedShapeRightBot (\\shape\n  [\n    (boundedShapeRight shape)\n    (boundedShapeBot shape)\n  ]\n))\n\n(typ boundedShapeCenterBot (-> BoundedShape Point))\n(def boundedShapeCenterBot (\\shape\n  [\n    (/ (+ (boundedShapeLeft shape) (boundedShapeRight shape)) 2)\n    (boundedShapeBot shape)\n  ]\n))\n\n(typ boundedShapeLeftBot (-> BoundedShape Point))\n(def boundedShapeLeftBot (\\shape\n  [\n    (boundedShapeLeft shape)\n    (boundedShapeBot shape)\n  ]\n))\n\n(typ boundedShapeLeftCenter (-> BoundedShape Point))\n(def boundedShapeLeftCenter (\\shape\n  [\n    (boundedShapeLeft shape)\n    (/ (+ (boundedShapeTop shape) (boundedShapeBot shape)) 2)\n  ]\n))\n\n(typ boundedShapeCenter (-> BoundedShape Point))\n(def boundedShapeCenter (\\shape\n  [\n    (/ (+ (boundedShapeLeft shape) (boundedShapeRight shape)) 2)\n    (/ (+ (boundedShapeTop shape) (boundedShapeBot shape)) 2)\n  ]\n))\n\n\n; === Rectangles ===\n\n(def Rect SVG)\n\n;; argument order - color, x, y, width, height\n;; creates a rectangle of given width and height with (x,y) as the top left corner coordinate\n(typ rect (-> Color Num Num Num Num Rect))\n(def rect (\\(fill x y w h)\n  [\'rect\'\n     [ [\'x\' x] [\'y\' y] [\'width\' w] [\'height\' h] [\'fill\' fill] ]\n     []]))\n\n(typ square (-> Color Num Num Num Rect))\n(def square (\\(fill x y side) (rect fill x y side side)))\n\n(typ rectWidth (-> Rect Num))\n(def rectWidth (\\rect\n  (lookupNumAttrWithDefault 0 rect \'width\')\n))\n\n(typ rectHeight (-> Rect Num))\n(def rectHeight (\\rect\n  (lookupNumAttrWithDefault 0 rect \'height\')\n))\n\n(typ rectLeftTop (-> Rect Point))\n(def rectLeftTop (\\rect\n  [\n    (lookupNumAttrWithDefault 0 rect \'x\')\n    (lookupNumAttrWithDefault 0 rect \'y\')\n  ]\n))\n\n(typ rectCenterTop (-> Rect Point))\n(def rectCenterTop (\\rect\n  (vec2DPlus\n    (rectLeftTop rect)\n    [ (/ (rectWidth rect) 2) 0 ]\n  )\n))\n\n(typ rectRightTop (-> Rect Point))\n(def rectRightTop (\\rect\n  (vec2DPlus\n    (rectLeftTop rect)\n    [ (rectWidth rect) 0 ]\n  )\n))\n\n(typ rectRightCenter (-> Rect Point))\n(def rectRightCenter (\\rect\n  (vec2DPlus\n    (rectLeftTop rect)\n    [ (rectWidth rect) (/ (rectHeight rect) 2) ]\n  )\n))\n\n(typ rectRightBot (-> Rect Point))\n(def rectRightBot (\\rect\n  (vec2DPlus\n    (rectLeftTop rect)\n    [ (rectWidth rect) (rectHeight rect) ]\n  )\n))\n\n(typ rectCenterBot (-> Rect Point))\n(def rectCenterBot (\\rect\n  (vec2DPlus\n    (rectLeftTop rect)\n    [ (/ (rectWidth rect) 2) (rectHeight rect) ]\n  )\n))\n\n(typ rectLeftBot (-> Rect Point))\n(def rectLeftBot (\\rect\n  (vec2DPlus\n    (rectLeftTop rect)\n    [0 (rectHeight rect) ]\n  )\n))\n\n(typ rectLeftCenter (-> Rect Point))\n(def rectLeftCenter (\\rect\n  (vec2DPlus\n    (rectLeftTop rect)\n    [0 (/ (rectHeight rect) 2) ]\n  )\n))\n\n(typ rectCenter (-> Rect Point))\n(def rectCenter (\\rect\n  (vec2DPlus\n    (rectLeftTop rect)\n    [ (/ (rectWidth rect) 2) (/ (rectHeight rect) 2) ]\n  )\n))\n\n\n; === Lines ===\n\n(def Line SVG)\n\n;; argument order - color, width, x1, y1, x1, y2\n;; creates a line from (x1, y1) to (x2,y2) with given color and width\n(typ line (-> Color Num Num Num Num Num Line))\n(def line (\\(stroke w x1 y1 x2 y2)\n  [\'line\'\n     [ [\'x1\' x1] [\'y1\' y1] [\'x2\' x2] [\'y2\' y2] [\'stroke\' stroke] [\'stroke-width\' w] ]\n     []]))\n\n(typ lineBetween (-> Color Num Point Point Line))\n(def lineBetween (\\(stroke w [x1 y1] [x2 y2])\n  (line stroke w x1 y1 x2 y2)))\n\n(typ lineStart (-> Line Point))\n(def lineStart (\\line\n  [\n    (lookupNumAttrWithDefault 0 line \'x1\')\n    (lookupNumAttrWithDefault 0 line \'y1\')\n  ]\n))\n\n(typ lineEnd (-> Line Point))\n(def lineEnd (\\line\n  [\n    (lookupNumAttrWithDefault 0 line \'x2\')\n    (lookupNumAttrWithDefault 0 line \'y2\')\n  ]\n))\n\n(typ lineMidPoint (-> Line Point))\n(def lineMidPoint (\\line\n  (halfwayBetween (lineStart line) (lineEnd line))\n))\n\n\n;; argument order - fill, stroke, width, points\n;; creates a polygon following the list of points, with given fill color and a border with given width and stroke\n(typ polygon (-> Color Color Num Points SVG))\n(def polygon (\\(fill stroke w pts)\n  [\'polygon\'\n     [ [\'fill\' fill] [\'points\' pts] [\'stroke\' stroke] [\'stroke-width\' w] ]\n     []]))\n\n;; argument order - fill, stroke, width, points\n;; See polygon\n(typ polyline (-> Color Color Num Points SVG))\n(def polyline (\\(fill stroke w pts)\n  [\'polyline\'\n     [ [\'fill\' fill] [\'points\' pts] [\'stroke\' stroke] [\'stroke-width\' w] ]\n     []]))\n\n;; argument order - fill, stroke, width, d\n;; Given SVG path command d, create path with given fill color, stroke and width\n;; See https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths for path command info\n(typ path (-> Color Color Num PathCmds SVG))\n(def path (\\(fill stroke w d)\n  [\'path\'\n     [ [\'fill\' fill] [\'stroke\' stroke] [\'stroke-width\' w] [\'d\' d] ]\n     []]))\n\n;; argument order - x, y, string\n;; place a text string with top left corner at (x,y) - with default color & font\n(typ text (-> Num Num String SVG))\n(def text (\\(x y s)\n   [\'text\' [[\'x\' x] [\'y\' y] [\'style\' \'fill:black\']\n            [\'font-family\' \'Tahoma, sans-serif\']]\n           [[\'TEXT\' s]]]))\n\n;; argument order - shape, new attribute\n;; Add a new attribute to a given Shape\n(typ addAttr (-> SVG AttrPair SVG))\n(def addAttr (\\([shapeKind oldAttrs children] newAttr)\n  [shapeKind (snoc newAttr oldAttrs) children]))\n\n(typ consAttr (-> SVG AttrPair SVG))\n(def consAttr (\\([shapeKind oldAttrs children] newAttr)\n  [shapeKind (cons newAttr oldAttrs) children]))\n\n;; Given a list of shapes, compose into a single SVG\n(def svg (\\shapes [\'svg\' [] shapes]))\n\n;; argument order - x-maximum, y-maximum, shapes\n;; Given a list of shapes, compose into a single SVG within the x & y maxima\n(typ svgViewBox (-> Num Num (List SVG) SVG))\n(def svgViewBox (\\(xMax yMax shapes)\n  (let [sx sy] [(toString xMax) (toString yMax)]\n  [\'svg\'\n    [[\'x\' \'0\'] [\'y\' \'0\'] [\'viewBox\' (joinStrings \' \' [\'0\' \'0\' sx sy])]]\n    shapes])))\n\n;; As rect, except x & y represent the center of the defined rectangle\n(typ rectByCenter (-> Color Num Num Num Num Rect))\n(def rectByCenter (\\(fill cx cy w h)\n  (rect fill (- cx (/ w 2)) (- cy (/ h 2)) w h)))\n\n;; As square, except x & y represent the center of the defined rectangle\n(typ squareByCenter (-> Color Num Num Num Rect))\n(def squareByCenter (\\(fill cx cy w) (rectByCenter fill cx cy w w)))\n\n;; Some shapes with given default values for fill, stroke, and stroke width\n; TODO remove these\n(def circle_    (circle \'red\'))\n(def ellipse_   (ellipse \'orange\'))\n(def rect_      (rect \'#999999\'))\n(def square_    (square \'#999999\'))\n(def line_      (line \'blue\' 2))\n(def polygon_   (polygon \'green\' \'purple\' 3))\n(def path_      (path \'transparent\' \'goldenrod\' 5))\n\n;; updates an SVG by comparing differences with another SVG\n;; Note: accDiff pre-condition: indices in increasing order\n;; (so can\'t just use foldr instead of reverse . foldl)\n(typ updateCanvas (-> SVG SVG SVG))\n(def updateCanvas (\\([_ svgAttrs oldShapes] diff)\n  (let oldShapesI (zip (list1N (len oldShapes)) oldShapes)\n  (let initAcc [[] diff]\n  (let f (\\([i oldShape] [accShapes accDiff])\n    (case accDiff\n      ([]\n        [(cons oldShape accShapes) accDiff])\n      ([[j newShape] | accDiffRest]\n        (if (= i j)\n          [(cons newShape accShapes) accDiffRest]\n          [(cons oldShape accShapes) accDiff]))))\n  (let newShapes (reverse (fst (foldl f initAcc oldShapesI)))\n    [\'svg\' svgAttrs newShapes]))))))\n\n(def addBlob (\\(newShapes [\'svg\' svgAttrs oldShapes])\n  [\'svg\' svgAttrs (append oldShapes newShapes)]))\n\n(typ groupMap (forall (a b) (-> (List a) (-> a b) (List b))))\n(def groupMap (\\(xs f) (map f xs)))\n\n(def autoChose (\\(_ x _) x))\n(def inferred  (\\(x _ _) x))\n(def flow (\\(_ x) x))\n\n; \'constant folding\'\n(def twoPi (* 2 (pi)))\n(def halfPi (/ (pi) 2))\n\n;; Helper function for nPointsOnCircle, calculates angle of points\n;; Note: angles are calculated clockwise from the traditional pi/2 mark\n(typ nPointsOnUnitCircle (-> Num Num (List Point)))\n(def nPointsOnUnitCircle (\\(n rot)\n  (let off (- halfPi rot)\n  (let foo (\\i\n    (let ang (+ off (* (/ i n) twoPi))\n    [(cos ang) (neg (sin ang))]))\n  (map foo (list0N (- n 1)))))))\n\n(typ nPointsOnCircle (-> Num Num Num Num Num (List Point)))\n;; argument order - Num of points, degree of rotation, x-center, y-center, radius\n;; Scales nPointsOnUnitCircle to the proper size and location with a given radius and center\n(def nPointsOnCircle (\\(n rot cx cy r)\n  (let pts (nPointsOnUnitCircle n rot)\n  (map (\\[x y] [(+ cx (* x r)) (+ cy (* y r))]) pts))))\n\n(typ nStar (-> Color Color Num Num Num Num Num Num Num SVG))\n;; argument order -\n;; fill color - interior color of star\n;; stroke color - border color of star\n;; width - thickness of stroke\n;; points - number of star points\n;; len1 - length from center to one set of star points\n;; len2 - length from center to other set of star points (either inner or outer compared to len1)\n;; rot - degree of rotation\n;; cx - x-coordinate of center position\n;; cy - y-coordinate of center position\n;; Creates stars that can be modified on a number of parameters\n(def nStar (\\(fill stroke w n len1 len2 rot cx cy)\n  (let pti (\\[i len]\n    (let anglei (+ (- (/ (* i (pi)) n) rot) halfPi)\n    (let xi (+ cx (* len (cos anglei)))\n    (let yi (+ cy (neg (* len (sin anglei))))\n      [xi yi]))))\n  (let lengths\n    (map (\\b (if b len1 len2))\n         (concat (repeat n [true false])))\n  (let indices (list0N (- (* 2! n) 1!))\n    (polygon fill stroke w (map pti (zip indices lengths))))))))\n\n(typ setZones (-> String SVG SVG))\n(def setZones (\\(s shape) (addAttr shape [\'ZONES\' s])))\n\n(typ zones (-> String (List SVG) (List SVG)))\n(def zones (\\(s shapes) (map (setZones s) shapes)))\n  ; TODO eta-reduced version:\n  ; (def zones (\\s (map (setZones s))))\n\n;; Remove all zones from shapes except for the first in the list\n(typ hideZonesTail (-> (List SVG) (List SVG)))\n(def hideZonesTail  (\\[hd | tl] [hd | (zones \'none\' tl)]))\n\n;; Turn all zones to basic for a given list of shapes except for the first shape\n(typ basicZonesTail (-> (List SVG) (List SVG)))\n(def basicZonesTail (\\[hd | tl] [hd | (zones \'basic\' tl)]))\n\n(typ ghost (-> SVG SVG))\n(def ghost\n  ; consAttr (instead of addAttr) makes internal calls to\n  ; Utils.maybeRemoveFirst \'HIDDEN\' slightly faster\n  (\\shape (consAttr shape [\'HIDDEN\' \'\'])))\n\n(def ghosts (map ghost))\n\n;; hSlider_ : Bool -> Bool -> Int -> Int -> Int -> Num -> Num -> Str -> Num\n;; -> [Num (List Svg)]\n;; argument order - dropBall roundInt xStart xEnd y minVal maxVal caption srcVal\n;; dropBall - Determines if the slider ball continues to appear past the edges of the slider\n;; roundInt - Determines whether to round to Ints or not\n;; xStart - left edge of slider\n;; xEnd - right edge of slider\n;; y - y positioning of entire slider bar\n;; minVal - minimum value of slider\n;; maxVal - maximum value of slider\n;; caption - text to display along with the slider\n;; srcVal - the current value given by the slider ball\n(def hSlider_ (\\(dropBall roundInt x0 x1 y minVal maxVal caption srcVal)\n  (let preVal (clamp minVal maxVal srcVal)\n  (let targetVal (if roundInt (round preVal) preVal)\n  (let shapes\n    (let ball\n      (let [xDiff valDiff] [(- x1 x0) (- maxVal minVal)]\n      (let xBall (+ x0 (* xDiff (/ (- srcVal minVal) valDiff)))\n      (if (= preVal srcVal) (circle \'black\' xBall y 10!)\n      (if dropBall          (circle \'black\' 0! 0! 0!)\n                            (circle \'red\' xBall y 10!)))))\n    [ (line \'black\' 3! x0 y x1 y)\n      (text (+ x1 10) (+ y 5) (+ caption (toString targetVal)))\n      (circle \'black\' x0 y 4!) (circle \'black\' x1 y 4!) ball ])\n  [targetVal (ghosts shapes)])))))\n; TODO only draw zones for ball\n\n(def vSlider_ (\\(dropBall roundInt y0 y1 x minVal maxVal caption srcVal)\n  (let preVal (clamp minVal maxVal srcVal)\n  (let targetVal (if roundInt (round preVal) preVal)\n  (let shapes\n    (let ball\n      (let [yDiff valDiff] [(- y1 y0) (- maxVal minVal)]\n      (let yBall (+ y0 (* yDiff (/ (- srcVal minVal) valDiff)))\n      (if (= preVal srcVal) (circle \'black\' x yBall 10!)\n      (if dropBall          (circle \'black\' 0! 0! 0!)\n                            (circle \'red\' x yBall 10!)))))\n    [ (line \'black\' 3! x y0 x y1)\n      ; (text (+ x1 10) (+ y 5) (+ caption (toString targetVal)))\n      (circle \'black\' x y0 4!) (circle \'black\' x y1 4!) ball ])\n  [targetVal (ghosts shapes)])))))\n; TODO only draw zones for ball\n\n(def hSlider (hSlider_ false))\n(def vSlider (vSlider_ false))\n\n;; button_ : Bool -> Num -> Num -> String -> Num -> SVG\n;; Similar to sliders, but just has boolean values\n(def button_ (\\(dropBall xStart y caption xCur)\n  (let [rPoint wLine rBall wSlider] [4! 3! 10! 70!]\n  (let xEnd (+ xStart wSlider)\n  (let xBall (+ xStart (* xCur wSlider))\n  (let xBall_ (clamp xStart xEnd xBall)\n  (let val (< xCur 0.5)\n  (let shapes1\n    [ (circle \'black\' xStart y rPoint)\n      (circle \'black\' xEnd y rPoint)\n      (line \'black\' wLine xStart y xEnd y)\n      (text (+ xEnd 10) (+ y 5) (+ caption (toString val))) ]\n  (let shapes2\n    [ (if (= xBall_ xBall) (circle (if val \'darkgreen\' \'darkred\') xBall y rBall)\n      (if dropBall         (circle \'black\' 0! 0! 0!)\n                           (circle \'red\' xBall y rBall))) ]\n  (let shapes (append (zones \'none\' shapes1) (zones \'basic\' shapes2))\n  [val (ghosts shapes)]))))))))))\n\n(def button (button_ false))\n\n(def xySlider\n  (\\(xStart xEnd yStart yEnd xMin xMax yMin yMax xCaption yCaption xCur yCur)\n    (let [rCorner wEdge rBall] [4! 3! 10!]\n    (let [xDiff yDiff xValDiff yValDiff] [(- xEnd xStart) (- yEnd yStart) (- xMax xMin) (- yMax yMin)]\n    (let xBall (+ xStart (* xDiff (/ (- xCur xMin) xValDiff)))\n    (let yBall (+ yStart (* yDiff (/ (- yCur yMin) yValDiff)))\n    (let cBall (if (and (between xMin xMax xCur) (between yMin yMax yCur)) \'black\' \'red\')\n    (let xVal (ceiling (clamp xMin xMax xCur))\n    (let yVal (ceiling (clamp yMin yMax yCur))\n    (let myLine (\\(x1 y1 x2 y2) (line \'black\' wEdge x1 y1 x2 y2))\n    (let myCirc (\\(x0 y0) (circle \'black\' x0 y0 rCorner))\n    (let shapes\n      [ (myLine xStart yStart xEnd yStart)\n        (myLine xStart yStart xStart yEnd)\n        (myLine xStart yEnd xEnd yEnd)\n        (myLine xEnd yStart xEnd yEnd)\n        (myCirc xStart yStart)\n        (myCirc xStart yEnd)\n        (myCirc xEnd yStart)\n        (myCirc xEnd yEnd)\n        (circle cBall xBall yBall rBall)\n        (text (- (+ xStart (/ xDiff 2)) 40) (+ yEnd 20) (+ xCaption (toString xVal)))\n        (text (+ xEnd 10) (+ yStart (/ yDiff 2)) (+ yCaption (toString yVal))) ]\n    [ [ xVal yVal ] (ghosts shapes) ]\n))))))))))))\n\n(typ enumSlider (forall a (-> Num Num Num [a|(List a)] String Num [a (List SVG)])))\n(def enumSlider (\\(x0 x1 y enum@[a|_] caption srcVal)\n  (let n (len enum)\n  (let [minVal maxVal] [0! n]\n  (let preVal (clamp minVal maxVal srcVal)\n  (let i (floor preVal)\n  (let item ; using dummy first element for typechecking\n    (let item_ (nth enum (if (= i n) (- n 1) i))\n    (typecase item_\n      (Null a)\n      (_    item_)))\n  (let wrap (\\circ (addAttr circ [\'SELECTED\' \'\'])) ; TODO\n  (let shapes\n    (let rail [ (line \'black\' 3! x0 y x1 y) ]\n    (let ball\n      (let [xDiff valDiff] [(- x1 x0) (- maxVal minVal)]\n      (let xBall (+ x0 (* xDiff (/ (- srcVal minVal) valDiff)))\n      (let colorBall (if (= preVal srcVal) \'black\' \'red\')\n        [ (wrap (circle colorBall xBall y 10!)) ])))\n    (let endpoints\n      [ (wrap (circle \'black\' x0 y 4!)) (wrap (circle \'black\' x1 y 4!)) ]\n    (let tickpoints\n      (let sep (/ (- x1 x0) n)\n      (map (\\j (wrap (circle \'grey\' (+ x0 (mult j sep)) y 4!)))\n           (range 1! (- n 1!))))\n    (let label [ (text (+ x1 10!) (+ y 5!) (+ caption (toString item))) ]\n    (concat [ rail endpoints tickpoints ball label ]))))))\n  [item (ghosts shapes)])))))))))\n\n(def addSelectionSliders (\\(y0 seeds shapesCaps)\n  (let shapesCapsSeeds (zip shapesCaps (take seeds (len shapesCaps)))\n  (let foo (\\[i [[shape cap] seed]]\n    (let [k _ _] shape\n    (let enum\n      (if (= k \'circle\') [\'\' \'cx\' \'cy\' \'r\']\n      (if (= k \'line\')   [\'\' \'x1\' \'y1\' \'x2\' \'y2\']\n      (if (= k \'rect\')   [\'\' \'x\' \'y\' \'width\' \'height\']\n        [(+ \'NO SELECTION ENUM FOR KIND \' k)])))\n    (let [item slider] (enumSlider 20! 170! (+ y0 (mult i 30!)) enum cap seed)\n    (let shape1 (addAttr shape [\'SELECTED\' item]) ; TODO overwrite existing\n    [shape1|slider])))))\n  (concat (mapi foo shapesCapsSeeds))))))\n\n; Text Widgets\n\n(def simpleText (\\(family color size x1 x2 y horizAlignSeed textVal)\n  (let xMid (+ x1 (/ (- x2 x1) 2!))\n  (let [anchor hAlignSlider]\n    (let dx (/ (- x2 x1) 4!)\n    (let yLine (+ 30! y)\n    (enumSlider (- xMid dx) (+ xMid dx) yLine\n      [\'start\' \'middle\' \'end\'] \'\' horizAlignSeed)))\n  (let x\n    (if (= anchor \'start\') x1\n    (if (= anchor \'middle\') xMid\n    (if (= anchor \'end\') x2\n      \'CRASH\')))\n  (let theText\n    [\'text\'\n      [[\'x\' x] [\'y\' y]\n       [\'style\' (+ \'fill:\' color)]\n       [\'font-family\' family] [\'font-size\' size]\n       [\'text-anchor\' anchor]]\n      [[\'TEXT\' textVal]]]\n  (let rails\n    (let pad 15!\n    (let yBaseLine (+ y pad)\n    (let xSideLine (- x1 pad)\n    (let rail (line \'gray\' 3)\n    (let baseLine (rail xSideLine yBaseLine x2 yBaseLine)\n    (let sideLine (rail xSideLine yBaseLine xSideLine (- y size))\n    (let dragBall (circle \'black\' x yBaseLine 8!)\n    (ghosts [baseLine sideLine dragBall]))))))))\n  (concat [[theText] hAlignSlider rails])\n)))))))\n\n\n(typ rotate (-> SVG Num Num Num SVG))\n;; argument order - shape, rot, x, y\n;; Takes a shape rotates it rot degrees around point (x,y)\n(def rotate (\\(shape n1 n2 n3)\n  (addAttr shape [\'transform\' [[\'rotate\' n1 n2 n3]]])))\n\n(typ rotateAround (-> Num Num Num SVG SVG))\n(def rotateAround (\\(rot x y shape)\n  (addAttr shape [\'transform\' [[\'rotate\' rot x y]]])))\n\n; Convert radians to degrees\n(typ radToDeg (-> Num Num))\n(def radToDeg (\\rad (* (/ rad (pi)) 180!)))\n\n; Convert degrees to radians\n(typ degToRad (-> Num Num))\n(def degToRad (\\deg (* (/ deg 180!) (pi))))\n\n; Polygon and Path Helpers\n\n(typ middleOfPoints (-> (List Point) Point))\n(def middleOfPoints (\\pts\n  (let [xs ys] [(map fst pts) (map snd pts)]\n  (let [xMin xMax] [(minimum xs) (maximum xs)]\n  (let [yMin yMax] [(minimum ys) (maximum ys)]\n  (let xMiddle (+ xMin (* 0.5 (- xMax xMin)))\n  (let yMiddle (+ yMin (* 0.5 (- yMax yMin)))\n    [xMiddle yMiddle] )))))))\n\n(typ polygonPoints (-> SVG Points))\n(def polygonPoints (\\shape@[shapeKind _ _]\n  (case shapeKind\n    (\'polygon\' (lookupPointsAttrWithDefault [] shape \'points\'))\n    (_         []))))\n\n(typ allPointsOfPathCmds_ (-> PathCmds (List [(union Num String) (union Num String)])))\n(defrec allPointsOfPathCmds_ (\\cmds (case cmds\n  ([]    [])\n  ([\'Z\'] [])\n\n  ([\'M\' x y | rest] (cons [x y] (allPointsOfPathCmds_ rest)))\n  ([\'L\' x y | rest] (cons [x y] (allPointsOfPathCmds_ rest)))\n\n  ([\'Q\' x1 y1 x y | rest]\n    (append [[x1 y1] [x y]] (allPointsOfPathCmds_ rest)))\n\n  ([\'C\' x1 y1 x2 y2 x y | rest]\n    (append [[x1 y1] [x2 y2] [x y]] (allPointsOfPathCmds_ rest)))\n\n  (_ [(let _ (debug \"Prelude.allPointsOfPathCmds_: not Nums...\") [-1 -1])])\n)))\n\n; (typ allPointsOfPathCmds (-> PathCmds (List Point)))\n; (def allPointsOfPathCmds (\\cmds\n;   (let toNum (\\numOrString\n;     (typecase numOrString (Num numOrString) (String -1)))\n;   (map (\\[x y] [(toNum x) (toNum y)]) (allPointsOfPathCmds_ cmds)))))\n\n; TODO remove inner annotations and named lambda\n\n(typ allPointsOfPathCmds (-> PathCmds (List Point)))\n(def allPointsOfPathCmds (\\cmds\n  (typ toNum (-> (union Num String) Num))\n  (let toNum (\\numOrString\n    (typecase numOrString (Num numOrString) (String -1)))\n  (typ foo (-> [(union Num String) (union Num String)] Point))\n  (let foo (\\[x y] [(toNum x) (toNum y)])\n  (map foo (allPointsOfPathCmds_ cmds))))))\n\n\n; Raw Shapes\n\n(def rawShape (\\(kind attrs) [kind attrs []]))\n\n(typ rawRect (-> Color Color Num Num Num Num Num Num Rect))\n(def rawRect (\\(fill stroke strokeWidth x y w h rot)\n  (let [cx cy] [(+ x (/ w 2!)) (+ y (/ h 2!))]\n  (rotateAround rot cx cy\n    (rawShape \'rect\' [\n      [\'x\' x] [\'y\' y] [\'width\' w] [\'height\' h]\n      [\'fill\' fill] [\'stroke\' stroke] [\'stroke-width\' strokeWidth] ])))))\n\n(typ rawCircle (-> Color Color Num Num Num Num Circle))\n(def rawCircle (\\(fill stroke strokeWidth cx cy r)\n  (rawShape \'circle\' [\n    [\'cx\' cx] [\'cy\' cy] [\'r\' r]\n    [\'fill\' fill] [\'stroke\' stroke] [\'stroke-width\' strokeWidth] ])))\n\n(typ rawEllipse (-> Color Color Num Num Num Num Num Num Ellipse))\n(def rawEllipse (\\(fill stroke strokeWidth cx cy rx ry rot)\n  (rotateAround rot cx cy\n    (rawShape \'ellipse\' [\n      [\'cx\' cx] [\'cy\' cy] [\'rx\' rx] [\'ry\' ry]\n      [\'fill\' fill] [\'stroke\' stroke] [\'stroke-width\' strokeWidth] ]))))\n\n(typ rawPolygon (-> Color Color Num Points Num SVG))\n(def rawPolygon (\\(fill stroke w pts rot)\n  (let [cx cy] (middleOfPoints pts)\n  (rotateAround rot cx cy\n    (rawShape \'polygon\'\n      [ [\'fill\' fill] [\'points\' pts] [\'stroke\' stroke] [\'stroke-width\' w] ])))))\n\n(typ rawPath (-> Color Color Num PathCmds Num SVG))\n(def rawPath (\\(fill stroke w d rot)\n  (let [cx cy] (middleOfPoints (allPointsOfPathCmds d))\n  (rotateAround rot cx cy\n    (rawShape \'path\'\n      [ [\'fill\' fill] [\'d\' d] [\'stroke\' stroke] [\'stroke-width\' w] ])))))\n\n\n; Shapes via Bounding Boxes\n\n(typ box (-> Bounds Color Color Num BoundedShape))\n(def box (\\(bounds fill stroke strokeWidth)\n  (let [x y xw yh] bounds\n  [\'BOX\'\n    [ [\'LEFT\' x] [\'TOP\' y] [\'RIGHT\' xw] [\'BOT\' yh]\n      [\'fill\' fill] [\'stroke\' stroke] [\'stroke-width\' strokeWidth]\n    ] []\n  ])))\n\n; string fill/stroke/stroke-width attributes to avoid sliders\n(typ hiddenBoundingBox (-> Bounds BoundedShape))\n(def hiddenBoundingBox (\\bounds\n  (ghost (box bounds \'transparent\' \'transparent\' \'0\'))))\n\n(typ simpleBoundingBox (-> Bounds BoundedShape))\n(def simpleBoundingBox (\\bounds\n  (ghost (box bounds \'transparent\' \'darkblue\' 1))))\n\n(typ strList (-> (List String) String))\n(def strList\n  (let foo (\\(x acc) (+ (+ acc (if (= acc \'\') \'\' \' \')) (toString x)))\n  (foldl foo \'\')))\n\n(typ fancyBoundingBox (-> Bounds (List SVG)))\n(def fancyBoundingBox (\\bounds\n  (let [left top right bot] bounds\n  (let [width height] [(- right left) (- bot top)]\n  (let [c1 c2 r] [\'darkblue\' \'skyblue\' 6]\n  [ (ghost (box bounds \'transparent\' c1 1))\n    (ghost (setZones \'none\' (circle c2 left top r)))\n    (ghost (setZones \'none\' (circle c2 right top r)))\n    (ghost (setZones \'none\' (circle c2 right bot r)))\n    (ghost (setZones \'none\' (circle c2 left bot r)))\n    (ghost (setZones \'none\' (circle c2 left (+ top (/ height 2)) r)))\n    (ghost (setZones \'none\' (circle c2 right (+ top (/ height 2)) r)))\n    (ghost (setZones \'none\' (circle c2 (+ left (/ width 2)) top r)))\n    (ghost (setZones \'none\' (circle c2 (+ left (/ width 2)) bot r)))\n  ])))))\n\n(typ groupWithPad (-> Num Bounds (List SVG) SVG))\n(def groupWithPad (\\(pad bounds shapes)\n  (let [left top right bot] bounds\n  (let paddedBounds [(- left pad) (- top pad) (+ right pad) (+ bot pad)]\n  [\'g\' [[\'BOUNDS\' bounds]]\n       (cons (hiddenBoundingBox paddedBounds) shapes)]\n))))\n\n(typ group (-> Bounds (List SVG) SVG))\n(def group (groupWithPad (let nGroupPad 20 nGroupPad)))\n\n  ; NOTE:\n  ;   keep the names nGroupPad and nPolyPathPad (and values)\n  ;   in sync with ExpressionBasedTransform.elm\n\n  ; (def group (groupWithPad 15))\n\n(def polyPathGroup (groupWithPad (let nPolyPathPad 10 nPolyPathPad)))\n\n; TODO make one pass over pts\n(typ boundsOfPoints (-> (List Point) Bounds))\n(def boundsOfPoints (\\pts\n  (let left  (minimum (map fst pts))\n  (let right (maximum (map fst pts))\n  (let top   (minimum (map snd pts))\n  (let bot   (maximum (map snd pts))\n    [left top right bot]\n))))))\n\n(typ extremeShapePoints (-> SVG Points))\n(def extremeShapePoints (\\shape@[kind _ _]\n  (case kind\n\n    (\'line\'\n      (let attrs@[x1 y1 x2 y2] (map (lookupAttr shape) [\"x1\" \"y1\" \"x2\" \"y2\"])\n      (typecase attrs\n        ([Num Num Num Num] [[x1 y1] [x2 y2]])\n        (_ []))))\n\n    (\'rect\'\n      (let attrs@[x y w h] (map (lookupAttr shape) [\"x\" \"y\" \"width\" \"height\"])\n      (typecase attrs\n        ([Num Num Num Num] [[x y] [(+ x w) (+ y h)]])\n        (_ []))))\n\n    (\'circle\'\n      (let attrs@[cx cy r] (map (lookupAttr shape) [\"cx\" \"cy\" \"r\"])\n      (typecase attrs\n        ([Num Num Num] [[(- cx r) (- cy r)] [(+ cx r) (+ cy r)]])\n        (_ []))))\n\n    (\'ellipse\'\n      (let attrs@[cx cy rx ry] (map (lookupAttr shape) [\"cx\" \"cy\" \"rx\" \"ry\"])\n      (typecase attrs\n        ([Num Num Num Num] [[(- cx rx) (- cy ry)] [(+ cx rx) (+ cy ry)]])\n        (_ []))))\n\n    (\'polygon\' (polygonPoints shape))\n\n    (\'path\'\n      (let pathCmds (lookupAttr shape \"d\")\n      (typecase pathCmds\n        ((List (union String Num)) (allPointsOfPathCmds pathCmds))\n        (_ []))))\n\n    (_ [])\n)))\n\n(typ anchoredGroup (-> (List SVG) SVG))\n(def anchoredGroup (\\shapes\n  (let bounds (boundsOfPoints (concat (map extremeShapePoints shapes)))\n  (group bounds shapes)\n)))\n\n; (def group (\\(bounds shapes)\n;   [\'g\' [[\'BOUNDS\' bounds]]\n;        (cons (hiddenBoundingBox bounds) shapes)]))\n\n       ; (concat [(fancyBoundingBox bounds) shapes])]))\n\n; TODO no longer used...\n(typ rotatedRect (-> Color Num Num Num Num Num Rect))\n(def rotatedRect (\\(fill x y w h rot)\n  (let [cx cy] [(+ x (/ w 2!)) (+ y (/ h 2!))]\n  (let bounds [x y (+ x w) (+ y h)]\n  (let shape (rotateAround rot cx cy (rect fill x y w h))\n  (group bounds [shape])\n)))))\n\n(typ rectangle (-> Color Color Num Num Bounds Rect))\n(def rectangle (\\(fill stroke strokeWidth rot bounds)\n  (let [left top right bot] bounds\n  (let [cx cy] [(+ left (/ (- right left) 2!)) (+ top (/ (- bot top) 2!))]\n  (let shape (rotateAround rot cx cy (box bounds fill stroke strokeWidth))\n  shape\n)))))\n  ; (group bounds [shape])\n\n; TODO no longer used...\n(typ rotatedEllipse (-> Color Num Num Num Num Num Ellipse))\n(def rotatedEllipse (\\(fill cx cy rx ry rot)\n  (let bounds [(- cx rx) (- cy ry) (+ cx rx) (+ cy ry)]\n  (let shape (rotateAround rot cx cy (ellipse fill cx cy rx ry))\n  (group bounds [shape])\n))))\n\n; TODO take rot\n(typ oval (-> Color Color Num Bounds BoundedShape))\n(def oval (\\(fill stroke strokeWidth bounds)\n  (let [left top right bot] bounds\n  (let shape\n    [\'OVAL\'\n       [ [\'LEFT\' left] [\'TOP\' top] [\'RIGHT\' right] [\'BOT\' bot]\n         [\'fill\' fill] [\'stroke\' stroke] [\'stroke-width\' strokeWidth] ]\n       []]\n  shape\n))))\n\n; ; TODO take rot\n; (def oval (\\(fill stroke strokeWidth bounds)\n;   (let [left top right bot] bounds\n;   (let [rx ry] [(/ (- right left) 2!) (/ (- bot top) 2!)]\n;   (let [cx cy] [(+ left rx) (+ top ry)]\n;   (let shape ; TODO change def ellipse to take stroke/strokeWidth\n;     [\'ellipse\'\n;        [ [\'cx\' cx] [\'cy\' cy] [\'rx\' rx] [\'ry\' ry]\n;          [\'fill\' fill] [\'stroke\' stroke] [\'stroke-width\' strokeWidth] ]\n;        []]\n;   (group bounds [shape])\n; ))))))\n\n(def scaleBetween (\\(a b pct)\n  (case pct\n    (0 a)\n    (1 b)\n    (_ (+ a (* pct (- b a)))))))\n\n(typ stretchyPolygon (-> Bounds Color Color Num (List Num) SVG))\n(def stretchyPolygon (\\(bounds fill stroke strokeWidth percentages)\n  (let [left top right bot] bounds\n  (let [xScale yScale] [(scaleBetween left right) (scaleBetween top bot)]\n  (let pts (map (\\[xPct yPct] [ (xScale xPct) (yScale yPct) ]) percentages)\n  ; (group bounds [(polygon fill stroke strokeWidth pts)])\n  (polyPathGroup bounds [(polygon fill stroke strokeWidth pts)])\n)))))\n\n; TODO no longer used...\n(def pointyPath (\\(fill stroke w d)\n  (let dot (\\(x y) (ghost (circle \'orange\' x y 5)))\n  (letrec pointsOf (\\cmds\n    (case cmds\n      ([]                     [])\n      ([\'Z\']                  [])\n      ([\'M\' x y | rest]       (append [(dot x y)] (pointsOf rest)))\n      ([\'L\' x y | rest]       (append [(dot x y)] (pointsOf rest)))\n      ([\'Q\' x1 y1 x y | rest] (append [(dot x1 y1) (dot x y)] (pointsOf rest)))\n      ([\'C\' x1 y1 x2 y2 x y | rest] (append [(dot x1 y1) (dot x2 y2) (dot x y)] (pointsOf rest)))\n      (_                      \'ERROR\')))\n  [\'g\' []\n    (cons\n      (path fill stroke w d)\n      [])]\n))))\n      ; turning off points for now\n      ; (pointsOf d)) ]\n\n; can refactor to make one pass\n; can also change representation/template code to pair points\n(def stretchyPath (\\(bounds fill stroke w d)\n  (let [left top right bot] bounds\n  (let [xScale yScale] [(scaleBetween left right) (scaleBetween top bot)]\n  (let dot (\\(x y) (ghost (circle \'orange\' x y 5)))\n  (letrec toPath (\\cmds\n    (case cmds\n      ([]    [])\n      ([\'Z\'] [\'Z\'])\n      ([\'M\' x y | rest] (append [\'M\' (xScale x) (yScale y)] (toPath rest)))\n      ([\'L\' x y | rest] (append [\'L\' (xScale x) (yScale y)] (toPath rest)))\n      ([\'Q\' x1 y1 x y | rest]\n        (append [\'Q\' (xScale x1) (yScale y1) (xScale x) (yScale y)]\n                (toPath rest)))\n      ([\'C\' x1 y1 x2 y2 x y | rest]\n        (append [\'C\' (xScale x1) (yScale y1) (xScale x2) (yScale y2) (xScale x) (yScale y)]\n                (toPath rest)))\n      (_ \'ERROR\')))\n  (letrec pointsOf (\\cmds\n    (case cmds\n      ([]    [])\n      ([\'Z\'] [])\n      ([\'M\' x y | rest] (append [(dot (xScale x) (yScale y))] (pointsOf rest)))\n      ([\'L\' x y | rest] (append [(dot (xScale x) (yScale y))] (pointsOf rest)))\n      ([\'Q\' x1 y1 x y | rest]\n        (append [(dot (xScale x1) (yScale y1)) (dot (xScale x) (yScale y))]\n                (pointsOf rest)))\n      ([\'C\' x1 y1 x2 y2 x y | rest]\n        (append [(dot (xScale x1) (yScale y1))\n                 (dot (xScale x2) (yScale y2))\n                 (dot (xScale x)  (yScale y))]\n                (pointsOf rest)))\n      (_ \'ERROR\')))\n  ; (group bounds\n  (polyPathGroup bounds\n    (cons\n      (path fill stroke w (toPath d))\n      []))\n)))))))\n      ; turning off points for now\n      ; (pointsOf d)))\n\n(typ evalOffset (-> [Num Num] Num))\n(def evalOffset (\\[base off]\n  (case off\n    (0 base)\n    (_ (+ base off)))))\n\n(def stickyPolygon (\\(bounds fill stroke strokeWidth offsets)\n  (let pts (map (\\[xOff yOff] [ (evalOffset xOff) (evalOffset yOff) ]) offsets)\n  (group bounds [(polygon fill stroke strokeWidth pts)])\n)))\n\n(typ withBounds (-> Bounds (-> Bounds (List SVG)) (List SVG)))\n(def withBounds (\\(bounds f) (f bounds)))\n\n(typ withAnchor (-> Point (-> Point (List SVG)) (List SVG)))\n(def withAnchor (\\(anchor f) (f anchor)))\n\n(typ star (-> Bounds (List SVG)))\n(def star (\\bounds\n  (let [left top right bot] bounds\n  (let [width height] [(- right left) (- bot top)]\n  (let [cx cy] [(+ left (/ width 2)) (+ top (/ height 2))]\n  [(nStar 0 \'black\' 0 6 (min (/ width 2) (/ height 2)) 10 0 cx cy)]\n)))))\n\n(typ blobs (-> (List Blob) SVG))\n(def blobs (\\blobs\n  (let modifyBlob (\\[i blob]\n    (case blob\n      ([[\'g\' gAttrs [shape | shapes]]]\n       [[\'g\' gAttrs [(consAttr shape [\'BLOB\' (toString (+ i 1))]) | shapes]]])\n      ([shape] [(consAttr shape [\'BLOB\' (toString (+ i 1))])])\n      (_       blob)))\n  (svg (concat (mapi modifyBlob blobs)))\n)))\n\n\n; === Relations ===\n\n(typ halfwayBetween (-> Point Point Point))\n(def halfwayBetween (\\(pt1 pt2)\n  (vec2DScalarMult 0.5 (vec2DPlus pt1 pt2))\n))\n\n(typ nextInLine (-> Point Point Point))\n(def nextInLine (\\(pt1 pt2)\n  (vec2DPlus pt2 (vec2DMinus pt2 pt1))\n))\n\n; Point on line segment, at `ratio` location.\n(typ onLine (-> Point Point Num Point))\n(def onLine (\\(pt1 pt2 ratio)\n  (let vec (vec2DMinus pt2 pt1)\n  (vec2DPlus pt1 (vec2DScalarMult ratio vec)))))\n\n; === Basic Replicate ===\n\n(def horizontalArray (\\(n sep func [x y])\n  (let _ ; draw point widget to control anchor\n    ([x y] : Point)\n  (let draw_i (\\i\n    (let xi (+ x (* i sep))\n    (func [xi y])))\n  (concat (map draw_i (zeroTo n)))\n))))\n\n(def linearArrayFromTo (\\(n func [xStart yStart] [xEnd yEnd])\n  (let xsep (/ (- xEnd xStart) (- n 1))\n  (let ysep (/ (- yEnd yStart) (- n 1))\n  (let draw_i (\\i\n    (let xi (+ xStart (* i xsep))\n    (let yi (+ yStart (* i ysep))\n    (func [xi yi]))))\n  (concat (map draw_i (zeroTo n)))\n)))))\n\n; To reduce size of resulting trace,\n; could subtract up to M>1 at a time.\n;\n(defrec floorAndLocalFreeze (\\n\n  (if (le n 1) 0\n  ;else\n    (+ 1 (floorAndLocalFreeze (- n 1))))))\n\n  ; (let _ ; draw point widget to control anchor\n  ;   ([cx cy] : Point)\n(def radialArray (\\(n radius rot func [cx cy])\n  (let center ; draw ghost circle to control anchor\n              ; not using point widget, since it\'s not selectable\n    (ghost (circle \'orange\' cx cy 20))\n  (let _ ; draw point widget to control radius\n    (let xWidget (floorAndLocalFreeze cx)\n    (let yWidget (- (floorAndLocalFreeze cy) radius)\n      ([xWidget yWidget] : Point)))\n  (let endpoints (nPointsOnCircle n rot cx cy radius)\n  (let bounds\n    [(- cx radius) (- cy radius) (+ cx radius) (+ cy radius)]\n  [(group bounds (cons center (concat (map func endpoints))))]\n))))))\n\n(def offsetAnchor (\\(dx dy f)\n  (\\[x y] (f [(+ x dx) (+ y dy)]))\n))\n\n(def horizontalArrayByBounds (\\(n sep func [left_0 top right_0 bot])\n  (let w_i     (- right_0 left_0)\n  (let left_i  (\\i (+ left_0 (* i (+ w_i sep))))\n  (let right_i (\\i (+ (left_i i) w_i))\n  (let draw_i  (\\i (func [(left_i i) top (right_i i) bot]))\n  (let bounds  [left_0 top (right_i (- n 1)) bot]\n    [(groupWithPad 30 bounds (concat (map draw_i (zeroTo n))))]\n)))))))\n\n(def repeatInsideBounds (\\(n sep func bounds@[left top right bot])\n  (let w_i (/ (- (- right left) (* sep (- n 1))) n)\n  (let draw_i (\\i\n    (let left_i (+ left (* i (+ w_i sep)))\n    (let right_i (+ left_i w_i)\n    (func [left_i top right_i bot]))))\n  [(groupWithPad 30 bounds (concat (map draw_i (zeroTo n))))]\n))))\n\n\n(def draw svg)\n\n(def showOne (\\(x y val)\n   [\'text\' [[\'x\' x] [\'y\' y] [\'style\' \'fill:black\']\n            [\'font-family\' \'monospace\']\n            [\'font-size\' \'12pt\']]\n           [[\'TEXT\' (toString val)]]]))\n\n(def show (showOne 20 30))\n\n(def showList (\\vals\n  [\'g\' [] (mapi (\\[i val] (showOne 20 (* (+ i 1) 30) val)) vals)]))\n\n(def rectWithBorder (\\(stroke strokeWidth fill x y w h)\n  (addAttr (addAttr\n    (rect fill x y w h)\n      [\"stroke\" stroke])\n      [\"stroke-width\" strokeWidth])))\n\n; The type checker relies on the name of this definition.\n(let dummyPreludeMain [\'svg\' [] []] dummyPreludeMain)\n\n';
var _user$project$PreludeGenerated$src = _user$project$PreludeGenerated$prelude;

var _user$project$Native_ImpureGoodies = {

    randomFloat : function(_) {
      return Math.random();
    },

    crashToNothing : function(thunk) {
      try {
        // Just (thunk ())
        var result = thunk({ctor: '_Tuple0'});
        return _elm_lang$core$Maybe$Just(result);
      } catch(err) {
        // Nothing
        console.log(err);
        return _elm_lang$core$Maybe$Nothing;
      }
    },

    crashToError : function(thunk) {
      try {
        // Ok (thunk ())
        var result = thunk({ctor: '_Tuple0'});
        return _elm_lang$core$Result$Ok(result);
      } catch(err) {
        // Err (toString err)
        return _elm_lang$core$Result$Err(err.toString());
      }
    },

    timedRun : function(thunk) {
      var start = (new Date()).getTime();
      var result = thunk(_elm_lang$core$Native_Utils.Tuple0);
      var end = (new Date()).getTime();

      return _elm_lang$core$Native_Utils.Tuple2(result, end-start);
    }

};

var _user$project$ImpureGoodies$timedRun = function (thunk) {
	return _user$project$Native_ImpureGoodies.timedRun(thunk);
};
var _user$project$ImpureGoodies$logTimedRun = F2(
	function (caption, thunk) {
		var _p0 = _user$project$ImpureGoodies$timedRun(thunk);
		var result = _p0._0;
		var time = _p0._1;
		var _p1 = A2(
			_elm_lang$core$Debug$log,
			A2(_elm_lang$core$Basics_ops['++'], caption, ' milliseconds'),
			time);
		return result;
	});
var _user$project$ImpureGoodies$crashToError = function (thunk) {
	return _user$project$Native_ImpureGoodies.crashToError(thunk);
};
var _user$project$ImpureGoodies$crashToNothing = function (thunk) {
	return _user$project$Native_ImpureGoodies.crashToNothing(thunk);
};
var _user$project$ImpureGoodies$randomFloat = function (_p2) {
	var _p3 = _p2;
	return _user$project$Native_ImpureGoodies.randomFloat(
		{ctor: '_Tuple0'});
};
var _user$project$ImpureGoodies$randomInt = F2(
	function (low, highNonInclusive) {
		var range = highNonInclusive - low;
		return _elm_lang$core$Basics$floor(
			(_user$project$ImpureGoodies$randomFloat(
				{ctor: '_Tuple0'}) * _elm_lang$core$Basics$toFloat(range)) + _elm_lang$core$Basics$toFloat(low));
	});

var _user$project$FastParser$substPlusOf_ = F2(
	function (substPlus, exp) {
		var accumulator = F2(
			function (e, s) {
				var _p0 = e.val.e__;
				if ((_p0.ctor === 'EConst') && (_p0._2.ctor === '_Tuple3')) {
					var _p3 = _p0._1;
					var _p2 = _p0._2._0;
					var _p1 = A2(_elm_lang$core$Dict$get, _p2, s);
					if (_p1.ctor === 'Nothing') {
						return A3(
							_elm_lang$core$Dict$insert,
							_p2,
							_elm_lang$core$Native_Utils.update(
								e,
								{val: _p3}),
							s);
					} else {
						return _elm_lang$core$Native_Utils.eq(_p3, _p1._0.val) ? s : _elm_lang$core$Native_Utils.crash(
							'FastParser',
							{
								start: {line: 1845, column: 46},
								end: {line: 1845, column: 57}
							})(
							A2(
								_elm_lang$core$Basics_ops['++'],
								'substPlusOf_ Constant: ',
								_elm_lang$core$Basics$toString(_p3)));
					}
				} else {
					return s;
				}
			});
		return A3(_user$project$Lang$foldExp, accumulator, substPlus, exp);
	});
var _user$project$FastParser$recordIdentifiers = function (_p4) {
	recordIdentifiers:
	while (true) {
		var _p5 = _p4;
		var _p15 = _p5._0;
		var _p14 = _p5._1;
		var ret = function (e__) {
			return A3(
				_user$project$Lang$WithInfo,
				A2(_user$project$Lang$Exp_, e__, _p14.val.eid),
				_p14.start,
				_p14.end);
		};
		var _p6 = {ctor: '_Tuple2', _0: _p15.val.p__, _1: _p14.val.e__};
		_v3_4:
		do {
			_v3_3:
			do {
				switch (_p6._0.ctor) {
					case 'PVar':
						switch (_p6._1.ctor) {
							case 'EConst':
								if (_p6._1._2.ctor === '_Tuple3') {
									return ret(
										A4(
											_user$project$Lang$EConst,
											_p6._1._0,
											_p6._1._1,
											{ctor: '_Tuple3', _0: _p6._1._2._0, _1: _p6._1._2._1, _2: _p6._0._1},
											_p6._1._3));
								} else {
									break _v3_4;
								}
							case 'EColonType':
								break _v3_3;
							default:
								break _v3_4;
						}
					case 'PList':
						switch (_p6._1.ctor) {
							case 'EList':
								var _p13 = _p6._1._4;
								var _p12 = _p6._1._2;
								var _p11 = _p6._1._0;
								var _p10 = _p6._1._3;
								var _p9 = _p6._1._1;
								var _p7 = A2(_user$project$Utils$maybeZip, _p6._0._1, _p9);
								if (_p7.ctor === 'Nothing') {
									return ret(
										A5(_user$project$Lang$EList, _p11, _p9, _p12, _p10, _p13));
								} else {
									var es_ = A2(_elm_lang$core$List$map, _user$project$FastParser$recordIdentifiers, _p7._0);
									var me_ = function () {
										var _p8 = {ctor: '_Tuple2', _0: _p6._0._3, _1: _p10};
										if (((_p8.ctor === '_Tuple2') && (_p8._0.ctor === 'Just')) && (_p8._1.ctor === 'Just')) {
											return _elm_lang$core$Maybe$Just(
												_user$project$FastParser$recordIdentifiers(
													{ctor: '_Tuple2', _0: _p8._0._0, _1: _p8._1._0}));
										} else {
											return _p10;
										}
									}();
									return ret(
										A5(_user$project$Lang$EList, _p11, es_, _p12, me_, _p13));
								}
							case 'EColonType':
								break _v3_3;
							default:
								break _v3_4;
						}
					case 'PAs':
						var _v6 = {ctor: '_Tuple2', _0: _p6._0._3, _1: _p14};
						_p4 = _v6;
						continue recordIdentifiers;
					default:
						if (_p6._1.ctor === 'EColonType') {
							break _v3_3;
						} else {
							break _v3_4;
						}
				}
			} while(false);
			return ret(
				A5(
					_user$project$Lang$EColonType,
					_p6._1._0,
					_user$project$FastParser$recordIdentifiers(
						{ctor: '_Tuple2', _0: _p15, _1: _p6._1._1}),
					_p6._1._2,
					_p6._1._3,
					_p6._1._4));
		} while(false);
		return ret(_p6._1);
	}
};
var _user$project$FastParser$allIdsRaw = function (exp) {
	var pidsInPat = function (pat) {
		return A2(
			_elm_lang$core$List$map,
			function (_p16) {
				return function (_) {
					return _.pid;
				}(
					function (_) {
						return _.val;
					}(_p16));
			},
			_user$project$Lang$flattenPatTree(pat));
	};
	var pidsInPats = function (pats) {
		return A2(_elm_lang$core$List$concatMap, pidsInPat, pats);
	};
	var flattened = _user$project$Lang$flattenExpTree(exp);
	var eids = A2(
		_elm_lang$core$List$map,
		function (_p17) {
			return function (_) {
				return _.eid;
			}(
				function (_) {
					return _.val;
				}(_p17));
		},
		flattened);
	var otherIds = A2(
		_elm_lang$core$List$concatMap,
		function (exp) {
			var _p18 = exp.val.e__;
			_v7_7:
			do {
				switch (_p18.ctor) {
					case 'EConst':
						if (_p18._2.ctor === '_Tuple3') {
							return {
								ctor: '::',
								_0: _p18._2._0,
								_1: {ctor: '[]'}
							};
						} else {
							break _v7_7;
						}
					case 'ELet':
						return pidsInPat(_p18._3);
					case 'EFun':
						return pidsInPats(_p18._1);
					case 'ECase':
						return pidsInPats(
							_user$project$Lang$branchPats(_p18._2));
					case 'ETypeCase':
						return pidsInPat(_p18._1);
					case 'ETyp':
						return pidsInPat(_p18._1);
					case 'ETypeAlias':
						return pidsInPat(_p18._1);
					default:
						break _v7_7;
				}
			} while(false);
			return {ctor: '[]'};
		},
		flattened);
	return A2(_elm_lang$core$Basics_ops['++'], eids, otherIds);
};
var _user$project$FastParser$freshenPatPreserving = F3(
	function (idsToPreserve, initK, p) {
		var getId = function (k) {
			getId:
			while (true) {
				if (A2(_elm_lang$core$Set$member, k, idsToPreserve)) {
					var _v8 = k + 1;
					k = _v8;
					continue getId;
				} else {
					return k;
				}
			}
		};
		var assignIds = F2(
			function (pat, k) {
				if (A2(_elm_lang$core$Set$member, pat.val.pid, idsToPreserve)) {
					return {ctor: '_Tuple2', _0: pat, _1: k};
				} else {
					var pid = getId(k);
					return {
						ctor: '_Tuple2',
						_0: A2(_user$project$Lang$setPId, pid, pat),
						_1: pid + 1
					};
				}
			});
		return A3(_user$project$Lang$mapFoldPatTopDown, assignIds, initK, p);
	});
var _user$project$FastParser$freshenPatsPreserving = F3(
	function (idsToPreserve, initK, pats) {
		return A3(
			_elm_lang$core$List$foldl,
			F2(
				function (pat, _p19) {
					var _p20 = _p19;
					var _p21 = A3(_user$project$FastParser$freshenPatPreserving, idsToPreserve, _p20._1, pat);
					var newPat = _p21._0;
					var newK = _p21._1;
					return {
						ctor: '_Tuple2',
						_0: A2(
							_elm_lang$core$Basics_ops['++'],
							_p20._0,
							{
								ctor: '::',
								_0: newPat,
								_1: {ctor: '[]'}
							}),
						_1: newK
					};
				}),
			{
				ctor: '_Tuple2',
				_0: {ctor: '[]'},
				_1: initK
			},
			pats);
	});
var _user$project$FastParser$freshenPreserving = F3(
	function (idsToPreserve, initK, e) {
		var getId = function (k) {
			getId:
			while (true) {
				if (A2(_elm_lang$core$Set$member, k, idsToPreserve)) {
					var _v10 = k + 1;
					k = _v10;
					continue getId;
				} else {
					return k;
				}
			}
		};
		var assignIds = F2(
			function (exp, k) {
				var e__ = exp.val.e__;
				var _p22 = function () {
					var _p23 = e__;
					_v11_7:
					do {
						switch (_p23.ctor) {
							case 'EConst':
								if (_p23._2.ctor === '_Tuple3') {
									if (A2(_elm_lang$core$Set$member, _p23._2._0, idsToPreserve)) {
										return {ctor: '_Tuple2', _0: e__, _1: k};
									} else {
										var locId = getId(k);
										return {
											ctor: '_Tuple2',
											_0: A4(
												_user$project$Lang$EConst,
												_p23._0,
												_p23._1,
												{ctor: '_Tuple3', _0: locId, _1: _p23._2._1, _2: _p23._2._2},
												_p23._3),
											_1: locId + 1
										};
									}
								} else {
									break _v11_7;
								}
							case 'ELet':
								var _p24 = A3(_user$project$FastParser$freshenPatPreserving, idsToPreserve, k, _p23._3);
								var newP = _p24._0;
								var newK = _p24._1;
								var newE1 = _user$project$FastParser$recordIdentifiers(
									{ctor: '_Tuple2', _0: newP, _1: _p23._4});
								return {
									ctor: '_Tuple2',
									_0: A7(_user$project$Lang$ELet, _p23._0, _p23._1, _p23._2, newP, newE1, _p23._5, _p23._6),
									_1: newK
								};
							case 'EFun':
								var _p25 = A3(_user$project$FastParser$freshenPatsPreserving, idsToPreserve, k, _p23._1);
								var newPats = _p25._0;
								var newK = _p25._1;
								return {
									ctor: '_Tuple2',
									_0: A4(_user$project$Lang$EFun, _p23._0, newPats, _p23._2, _p23._3),
									_1: newK
								};
							case 'ECase':
								var _p26 = A3(
									_elm_lang$core$List$foldl,
									F2(
										function (branch, _p27) {
											var _p28 = _p27;
											var _p29 = branch.val;
											var bws1 = _p29._0;
											var pat = _p29._1;
											var ei = _p29._2;
											var bws2 = _p29._3;
											var _p30 = A3(_user$project$FastParser$freshenPatPreserving, idsToPreserve, _p28._1, pat);
											var newPi = _p30._0;
											var newK = _p30._1;
											return {
												ctor: '_Tuple2',
												_0: A2(
													_elm_lang$core$Basics_ops['++'],
													_p28._0,
													{
														ctor: '::',
														_0: _elm_lang$core$Native_Utils.update(
															branch,
															{
																val: A4(_user$project$Lang$Branch_, bws1, newPi, ei, bws2)
															}),
														_1: {ctor: '[]'}
													}),
												_1: newK
											};
										}),
									{
										ctor: '_Tuple2',
										_0: {ctor: '[]'},
										_1: k
									},
									_p23._2);
								var newBranches = _p26._0;
								var newK = _p26._1;
								return {
									ctor: '_Tuple2',
									_0: A4(_user$project$Lang$ECase, _p23._0, _p23._1, newBranches, _p23._3),
									_1: newK
								};
							case 'ETypeCase':
								var _p31 = A3(_user$project$FastParser$freshenPatPreserving, idsToPreserve, k, _p23._1);
								var newPat = _p31._0;
								var newK = _p31._1;
								return {
									ctor: '_Tuple2',
									_0: A4(_user$project$Lang$ETypeCase, _p23._0, newPat, _p23._2, _p23._3),
									_1: newK
								};
							case 'ETyp':
								var _p32 = A3(_user$project$FastParser$freshenPatPreserving, idsToPreserve, k, _p23._1);
								var newPat = _p32._0;
								var newK = _p32._1;
								return {
									ctor: '_Tuple2',
									_0: A5(_user$project$Lang$ETyp, _p23._0, newPat, _p23._2, _p23._3, _p23._4),
									_1: newK
								};
							case 'ETypeAlias':
								var _p33 = A3(_user$project$FastParser$freshenPatPreserving, idsToPreserve, k, _p23._1);
								var newPat = _p33._0;
								var newK = _p33._1;
								return {
									ctor: '_Tuple2',
									_0: A5(_user$project$Lang$ETypeAlias, _p23._0, newPat, _p23._2, _p23._3, _p23._4),
									_1: newK
								};
							default:
								break _v11_7;
						}
					} while(false);
					return {ctor: '_Tuple2', _0: e__, _1: k};
				}();
				var newE__ = _p22._0;
				var newK = _p22._1;
				if (A2(_elm_lang$core$Set$member, exp.val.eid, idsToPreserve)) {
					return {
						ctor: '_Tuple2',
						_0: A2(_user$project$Lang$replaceE__, exp, newE__),
						_1: newK
					};
				} else {
					var eid = getId(newK);
					return {
						ctor: '_Tuple2',
						_0: A3(
							_user$project$Lang$WithInfo,
							A2(_user$project$Lang$Exp_, newE__, eid),
							exp.start,
							exp.end),
						_1: eid + 1
					};
				}
			});
		return A3(_user$project$Lang$mapFoldExp, assignIds, initK, e);
	});
var _user$project$FastParser$freshenClean = F2(
	function (initK, e) {
		return A3(_user$project$FastParser$freshenPreserving, _elm_lang$core$Set$empty, initK, e);
	});
var _user$project$FastParser$clearAllIds = function (root) {
	return A2(_user$project$Lang$mapExp, _user$project$Lang$clearNodeIds, root);
};
var _user$project$FastParser$showIndentedProblem = F2(
	function (n, prob) {
		var indent = A2(_elm_lang$core$String$repeat, 2 * n, ' ');
		var _p34 = prob;
		switch (_p34.ctor) {
			case 'BadOneOf':
				return A2(
					_elm_lang$core$Basics_ops['++'],
					indent,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'One of:\n',
						_elm_lang$core$String$concat(
							A2(
								_elm_lang$core$List$map,
								_user$project$FastParser$showIndentedProblem(n + 1),
								_p34._0))));
			case 'BadInt':
				return A2(_elm_lang$core$Basics_ops['++'], indent, 'Bad integer value\n');
			case 'BadFloat':
				return A2(_elm_lang$core$Basics_ops['++'], indent, 'Bad float value\n');
			case 'BadRepeat':
				return A2(_elm_lang$core$Basics_ops['++'], indent, 'Parse of zero-length input indefinitely\n');
			case 'ExpectingEnd':
				return A2(_elm_lang$core$Basics_ops['++'], indent, 'Expecting end\n');
			case 'ExpectingSymbol':
				return A2(
					_elm_lang$core$Basics_ops['++'],
					indent,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'Expecting symbol \'',
						A2(_elm_lang$core$Basics_ops['++'], _p34._0, '\'\n')));
			case 'ExpectingKeyword':
				return A2(
					_elm_lang$core$Basics_ops['++'],
					indent,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'Expecting keyword \'',
						A2(_elm_lang$core$Basics_ops['++'], _p34._0, '\'\n')));
			case 'ExpectingVariable':
				return A2(_elm_lang$core$Basics_ops['++'], indent, 'Expecting variable\n');
			case 'ExpectingClosing':
				return A2(
					_elm_lang$core$Basics_ops['++'],
					indent,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'Expecting closing string \'',
						A2(_elm_lang$core$Basics_ops['++'], _p34._0, '\'\n')));
			default:
				return A2(
					_elm_lang$core$Basics_ops['++'],
					indent,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'Parser failure: ',
						A2(_elm_lang$core$Basics_ops['++'], _p34._0, '\n')));
		}
	});
var _user$project$FastParser$showError = function (err) {
	var deepestContext = function () {
		var _p35 = _elm_lang$core$List$head(err.context);
		if (_p35.ctor === 'Just') {
			return A2(
				_elm_lang$core$Basics_ops['++'],
				'Error while parsing \'',
				A2(_elm_lang$core$Basics_ops['++'], _p35._0.description, '\':\n'));
		} else {
			return '';
		}
	}();
	var showContext = function (c) {
		return A2(
			_elm_lang$core$Basics_ops['++'],
			'  (row: ',
			A2(
				_elm_lang$core$Basics_ops['++'],
				_elm_lang$core$Basics$toString(c.row),
				A2(
					_elm_lang$core$Basics_ops['++'],
					', col: ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_elm_lang$core$Basics$toString(c.col),
						A2(
							_elm_lang$core$Basics_ops['++'],
							') Error while parsing \'',
							A2(_elm_lang$core$Basics_ops['++'], c.description, '\'\n'))))));
	};
	var prettyError = function () {
		var arrow = A2(
			_elm_lang$core$Basics_ops['++'],
			A2(_elm_lang$core$String$repeat, err.col - 1, ' '),
			'^');
		var sourceLines = _elm_lang$core$String$lines(err.source);
		var problemLine = _elm_lang$core$List$head(
			A2(_elm_lang$core$List$drop, err.row - 1, sourceLines));
		var _p36 = problemLine;
		if (_p36.ctor === 'Just') {
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p36._0,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'\n',
					A2(_elm_lang$core$Basics_ops['++'], arrow, '\n\n')));
		} else {
			return '';
		}
	}();
	return A2(
		_elm_lang$core$Basics_ops['++'],
		'[Parser Error]\n\n',
		A2(
			_elm_lang$core$Basics_ops['++'],
			deepestContext,
			A2(
				_elm_lang$core$Basics_ops['++'],
				'\n',
				A2(
					_elm_lang$core$Basics_ops['++'],
					prettyError,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'Position\n',
						A2(
							_elm_lang$core$Basics_ops['++'],
							'========\n',
							A2(
								_elm_lang$core$Basics_ops['++'],
								'  Row: ',
								A2(
									_elm_lang$core$Basics_ops['++'],
									_elm_lang$core$Basics$toString(err.row),
									A2(
										_elm_lang$core$Basics_ops['++'],
										'\n',
										A2(
											_elm_lang$core$Basics_ops['++'],
											'  Col: ',
											A2(
												_elm_lang$core$Basics_ops['++'],
												_elm_lang$core$Basics$toString(err.col),
												A2(
													_elm_lang$core$Basics_ops['++'],
													'\n\n',
													A2(
														_elm_lang$core$Basics_ops['++'],
														'Problem\n',
														A2(
															_elm_lang$core$Basics_ops['++'],
															'=======\n',
															A2(
																_elm_lang$core$Basics_ops['++'],
																A2(_user$project$FastParser$showIndentedProblem, 1, err.problem),
																A2(
																	_elm_lang$core$Basics_ops['++'],
																	'\n',
																	A2(
																		_elm_lang$core$Basics_ops['++'],
																		'Context Stack\n',
																		A2(
																			_elm_lang$core$Basics_ops['++'],
																			'=============\n',
																			A2(
																				_elm_lang$core$Basics_ops['++'],
																				_elm_lang$core$String$concat(
																					A2(_elm_lang$core$List$map, showContext, err.context)),
																				'\n\n')))))))))))))))))));
};
var _user$project$FastParser$fuseTopLevelExp = F2(
	function (tld, rest) {
		return A3(
			_user$project$Lang$withInfo,
			tld.val(rest),
			tld.start,
			tld.end);
	});
var _user$project$FastParser$fuseTopLevelExps = F2(
	function (tlds, rest) {
		return A3(_elm_lang$core$List$foldr, _user$project$FastParser$fuseTopLevelExp, rest, tlds);
	});
var _user$project$FastParser$dummyLocWithDebugInfo = F2(
	function (b, n) {
		return {ctor: '_Tuple3', _0: 0, _1: b, _2: ''};
	});
var _user$project$FastParser$mapExp_ = function (_p37) {
	return _elm_tools$parser$Parser$map(
		_user$project$Lang$mapInfo(_p37));
}(_user$project$Lang$exp_);
var _user$project$FastParser$mapPat_ = function (_p38) {
	return _elm_tools$parser$Parser$map(
		_user$project$Lang$mapInfo(_p38));
}(_user$project$Lang$pat_);
var _user$project$FastParser$validTypeIdentifierFirstChar = function (c) {
	return _elm_lang$core$Char$isUpper(c);
};
var _user$project$FastParser$validVariableIdentifierFirstChar = function (c) {
	return _elm_lang$core$Char$isLower(c) || _elm_lang$core$Native_Utils.eq(
		c,
		_elm_lang$core$Native_Utils.chr('_'));
};
var _user$project$FastParser$keywords = _elm_lang$core$Set$fromList(
	{
		ctor: '::',
		_0: 'true',
		_1: {
			ctor: '::',
			_0: 'false',
			_1: {
				ctor: '::',
				_0: 'pi',
				_1: {
					ctor: '::',
					_0: 'cos',
					_1: {
						ctor: '::',
						_0: 'sin',
						_1: {
							ctor: '::',
							_0: 'arccos',
							_1: {
								ctor: '::',
								_0: 'arcsin',
								_1: {
									ctor: '::',
									_0: 'floor',
									_1: {
										ctor: '::',
										_0: 'ceiling',
										_1: {
											ctor: '::',
											_0: 'round',
											_1: {
												ctor: '::',
												_0: 'toString',
												_1: {
													ctor: '::',
													_0: 'sqrt',
													_1: {
														ctor: '::',
														_0: 'explode',
														_1: {
															ctor: '::',
															_0: 'mod',
															_1: {
																ctor: '::',
																_0: 'pow',
																_1: {
																	ctor: '::',
																	_0: 'arctan2',
																	_1: {
																		ctor: '::',
																		_0: 'if',
																		_1: {
																			ctor: '::',
																			_0: 'case',
																			_1: {
																				ctor: '::',
																				_0: 'typecase',
																				_1: {
																					ctor: '::',
																					_0: 'let',
																					_1: {
																						ctor: '::',
																						_0: 'letrec',
																						_1: {
																							ctor: '::',
																							_0: 'def',
																							_1: {
																								ctor: '::',
																								_0: 'defrec',
																								_1: {
																									ctor: '::',
																									_0: 'typ',
																									_1: {
																										ctor: '::',
																										_0: 'empty',
																										_1: {
																											ctor: '::',
																											_0: 'insert',
																											_1: {
																												ctor: '::',
																												_0: 'get',
																												_1: {
																													ctor: '::',
																													_0: 'remove',
																													_1: {
																														ctor: '::',
																														_0: 'debug',
																														_1: {ctor: '[]'}
																													}
																												}
																											}
																										}
																									}
																								}
																							}
																						}
																					}
																				}
																			}
																		}
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	});
var _user$project$FastParser$validIdentifierRestChar = function (c) {
	return _elm_lang$core$Char$isLower(c) || (_elm_lang$core$Char$isUpper(c) || (_elm_lang$core$Char$isDigit(c) || (_elm_lang$core$Native_Utils.eq(
		c,
		_elm_lang$core$Native_Utils.chr('_')) || _elm_lang$core$Native_Utils.eq(
		c,
		_elm_lang$core$Native_Utils.chr('\'')))));
};
var _user$project$FastParser$sanitizeVariableName = function (unsafeName) {
	return _elm_lang$core$String$fromList(
		A2(
			_user$project$Utils$changeTail,
			_elm_lang$core$List$filter(_user$project$FastParser$validIdentifierRestChar),
			A2(
				_user$project$Utils$mapHead,
				_elm_lang$core$Char$toLower,
				A2(
					_user$project$Utils$dropWhile,
					function (_p39) {
						return !function (_p40) {
							return _user$project$FastParser$validVariableIdentifierFirstChar(
								_elm_lang$core$Char$toLower(_p40));
						}(_p39);
					},
					_elm_lang$core$String$toList(unsafeName)))));
};
var _user$project$FastParser$isInt = function (n) {
	return _elm_lang$core$Native_Utils.eq(
		n,
		_elm_lang$core$Basics$toFloat(
			_elm_lang$core$Basics$floor(n)));
};
var _user$project$FastParser$isSpace = function (c) {
	return _elm_lang$core$Native_Utils.eq(
		c,
		_elm_lang$core$Native_Utils.chr(' ')) || _elm_lang$core$Native_Utils.eq(
		c,
		_elm_lang$core$Native_Utils.chr('\n'));
};
var _user$project$FastParser$isOnlySpaces = _elm_lang$core$String$all(_user$project$FastParser$isSpace);
var _user$project$FastParser$untrackInfo = _elm_tools$parser$Parser$map(
	function (_) {
		return _.val;
	});
var _user$project$FastParser$getPos = A2(_elm_tools$parser$Parser$map, _user$project$Lang$posFromRowCol, _elm_tools$parser$Parser_LowLevel$getPosition);
var _user$project$FastParser$trackInfo = function (p) {
	return A3(
		_elm_tools$parser$Parser$delayedCommitMap,
		F2(
			function (start, _p41) {
				var _p42 = _p41;
				return A3(_user$project$Lang$withInfo, _p42._0, start, _p42._1);
			}),
		_user$project$FastParser$getPos,
		A2(
			_elm_tools$parser$Parser_ops['|='],
			A2(
				_elm_tools$parser$Parser_ops['|='],
				_elm_tools$parser$Parser$succeed(
					F2(
						function (v0, v1) {
							return {ctor: '_Tuple2', _0: v0, _1: v1};
						})),
				p),
			_user$project$FastParser$getPos));
};
var _user$project$FastParser$spaces = _user$project$FastParser$trackInfo(
	A2(_elm_tools$parser$Parser$keep, _elm_tools$parser$Parser$zeroOrMore, _user$project$FastParser$isSpace));
var _user$project$FastParser$spaceSaverKeyword = F2(
	function (kword, combiner) {
		return A3(
			_elm_tools$parser$Parser$delayedCommitMap,
			F2(
				function (ws, _p43) {
					return A3(
						_user$project$Lang$withInfo,
						combiner(ws),
						ws.start,
						ws.end);
				}),
			_user$project$FastParser$spaces,
			_elm_tools$parser$Parser$keyword(kword));
	});
var _user$project$FastParser$wildcardType = A2(
	_elm_tools$parser$Parser$inContext,
	'wildcard type',
	A2(_user$project$FastParser$spaceSaverKeyword, '_', _user$project$Lang$TWildcard));
var _user$project$FastParser$spacesBefore = F2(
	function (combiner, p) {
		return A3(
			_elm_tools$parser$Parser$delayedCommitMap,
			F2(
				function (ws, x) {
					return A3(
						_user$project$Lang$withInfo,
						A2(combiner, ws, x.val),
						x.start,
						x.end);
				}),
			_user$project$FastParser$spaces,
			p);
	});
var _user$project$FastParser$namePattern = function (ident) {
	return _user$project$FastParser$mapPat_(
		A2(
			_user$project$FastParser$spacesBefore,
			F2(
				function (ws, name) {
					return A3(_user$project$Lang$PVar, ws, name, _user$project$Lang$noWidgetDecl);
				}),
			ident));
};
var _user$project$FastParser$baseType = F3(
	function (context, combiner, token) {
		return A2(
			_elm_tools$parser$Parser$inContext,
			context,
			A3(
				_elm_tools$parser$Parser$delayedCommitMap,
				F2(
					function (ws, _p44) {
						return A3(
							_user$project$Lang$withInfo,
							combiner(ws),
							ws.start,
							ws.end);
					}),
				_user$project$FastParser$spaces,
				_elm_tools$parser$Parser$keyword(token)));
	});
var _user$project$FastParser$nullType = A3(_user$project$FastParser$baseType, 'null type', _user$project$Lang$TNull, 'Null');
var _user$project$FastParser$numType = A3(_user$project$FastParser$baseType, 'num type', _user$project$Lang$TNum, 'Num');
var _user$project$FastParser$boolType = A3(_user$project$FastParser$baseType, 'bool type', _user$project$Lang$TBool, 'Bool');
var _user$project$FastParser$stringType = A3(_user$project$FastParser$baseType, 'string type', _user$project$Lang$TString, 'String');
var _user$project$FastParser$block = F4(
	function (combiner, openSymbol, closeSymbol, p) {
		return A3(
			_elm_tools$parser$Parser$delayedCommitMap,
			F2(
				function (_p46, _p45) {
					var _p47 = _p46;
					var _p48 = _p45;
					return A3(
						_user$project$Lang$withInfo,
						A3(combiner, _p47._0, _p48._0, _p48._1),
						_p47._1.start,
						_p48._2.end);
				}),
			A2(
				_elm_tools$parser$Parser_ops['|='],
				A2(
					_elm_tools$parser$Parser_ops['|='],
					_elm_tools$parser$Parser$succeed(
						F2(
							function (v0, v1) {
								return {ctor: '_Tuple2', _0: v0, _1: v1};
							})),
					_user$project$FastParser$spaces),
				_user$project$FastParser$trackInfo(
					_elm_tools$parser$Parser$symbol(openSymbol))),
			A2(
				_elm_tools$parser$Parser_ops['|='],
				A2(
					_elm_tools$parser$Parser_ops['|='],
					A2(
						_elm_tools$parser$Parser_ops['|='],
						_elm_tools$parser$Parser$succeed(
							F3(
								function (v0, v1, v2) {
									return {ctor: '_Tuple3', _0: v0, _1: v1, _2: v2};
								})),
						p),
					_user$project$FastParser$spaces),
				_user$project$FastParser$trackInfo(
					_elm_tools$parser$Parser$symbol(closeSymbol))));
	});
var _user$project$FastParser$parenBlock = function (combiner) {
	return A3(_user$project$FastParser$block, combiner, '(', ')');
};
var _user$project$FastParser$bracketBlock = function (combiner) {
	return A3(_user$project$FastParser$block, combiner, '[', ']');
};
var _user$project$FastParser$listLiteralInternal = F3(
	function (context, combiner, elem) {
		return A2(
			_elm_tools$parser$Parser$inContext,
			context,
			A2(
				_user$project$FastParser$bracketBlock,
				combiner,
				A2(_elm_tools$parser$Parser$repeat, _elm_tools$parser$Parser$zeroOrMore, elem)));
	});
var _user$project$FastParser$multiConsInternal = F3(
	function (context, combiner, elem) {
		return A2(
			_elm_tools$parser$Parser$inContext,
			context,
			A2(
				_user$project$FastParser$bracketBlock,
				F3(
					function (wsStart, _p49, wsEnd) {
						var _p50 = _p49;
						return A5(combiner, wsStart, _p50._0, _p50._1, _p50._2, wsEnd);
					}),
				A3(
					_elm_tools$parser$Parser$delayedCommitMap,
					F2(
						function (_p51, tail) {
							var _p52 = _p51;
							return {ctor: '_Tuple3', _0: _p52._0, _1: _p52._1, _2: tail};
						}),
					A2(
						_elm_tools$parser$Parser_ops['|.'],
						A2(
							_elm_tools$parser$Parser_ops['|='],
							A2(
								_elm_tools$parser$Parser_ops['|='],
								_elm_tools$parser$Parser$succeed(
									F2(
										function (v0, v1) {
											return {ctor: '_Tuple2', _0: v0, _1: v1};
										})),
								A2(_elm_tools$parser$Parser$repeat, _elm_tools$parser$Parser$oneOrMore, elem)),
							_user$project$FastParser$spaces),
						_elm_tools$parser$Parser$symbol('|')),
					elem)));
	});
var _user$project$FastParser$genericList = function (args) {
	return A2(
		_elm_tools$parser$Parser$inContext,
		args.generalContext,
		_elm_tools$parser$Parser$oneOf(
			{
				ctor: '::',
				_0: A3(_user$project$FastParser$multiConsInternal, args.multiConsContext, args.multiConsCombiner, args.elem),
				_1: {
					ctor: '::',
					_0: A3(_user$project$FastParser$listLiteralInternal, args.listLiteralContext, args.listLiteralCombiner, args.elem),
					_1: {ctor: '[]'}
				}
			}));
};
var _user$project$FastParser$blockIgnoreWS = _user$project$FastParser$block(
	F3(
		function (wsStart, x, wsEnd) {
			return x;
		}));
var _user$project$FastParser$parenBlockIgnoreWS = A2(_user$project$FastParser$blockIgnoreWS, '(', ')');
var _user$project$FastParser$string = function () {
	var stringHelper = function (quoteChar) {
		var quoteString = _elm_lang$core$String$fromChar(quoteChar);
		return A2(
			_elm_tools$parser$Parser_ops['|.'],
			A2(
				_elm_tools$parser$Parser_ops['|='],
				A2(
					_elm_tools$parser$Parser_ops['|.'],
					_elm_tools$parser$Parser$succeed(
						_user$project$Lang$EString(quoteString)),
					_elm_tools$parser$Parser$symbol(quoteString)),
				A2(
					_elm_tools$parser$Parser$keep,
					_elm_tools$parser$Parser$zeroOrMore,
					function (c) {
						return !_elm_lang$core$Native_Utils.eq(c, quoteChar);
					})),
			_elm_tools$parser$Parser$symbol(quoteString));
	};
	return A2(
		_elm_tools$parser$Parser$inContext,
		'string',
		_user$project$FastParser$trackInfo(
			_elm_tools$parser$Parser$oneOf(
				A2(
					_elm_lang$core$List$map,
					stringHelper,
					{
						ctor: '::',
						_0: _elm_lang$core$Native_Utils.chr('\''),
						_1: {
							ctor: '::',
							_0: _elm_lang$core$Native_Utils.chr('\"'),
							_1: {ctor: '[]'}
						}
					}))));
}();
var _user$project$FastParser$bool = A2(
	_elm_tools$parser$Parser$inContext,
	'bool',
	_user$project$FastParser$trackInfo(
		A2(
			_elm_tools$parser$Parser$map,
			_user$project$Lang$EBool,
			_elm_tools$parser$Parser$oneOf(
				{
					ctor: '::',
					_0: A2(
						_elm_tools$parser$Parser$map,
						_elm_lang$core$Basics$always(true),
						_elm_tools$parser$Parser$keyword('true')),
					_1: {
						ctor: '::',
						_0: A2(
							_elm_tools$parser$Parser$map,
							_elm_lang$core$Basics$always(false),
							_elm_tools$parser$Parser$keyword('false')),
						_1: {ctor: '[]'}
					}
				}))));
var _user$project$FastParser$null = A2(
	_elm_tools$parser$Parser$inContext,
	'null',
	_user$project$FastParser$trackInfo(
		A2(
			_elm_tools$parser$Parser$map,
			_elm_lang$core$Basics$always(_user$project$Lang$ENull),
			_elm_tools$parser$Parser$keyword('null'))));
var _user$project$FastParser$baseValue = A2(
	_elm_tools$parser$Parser$inContext,
	'base value',
	_elm_tools$parser$Parser$oneOf(
		{
			ctor: '::',
			_0: _user$project$FastParser$string,
			_1: {
				ctor: '::',
				_0: _user$project$FastParser$bool,
				_1: {
					ctor: '::',
					_0: _user$project$FastParser$null,
					_1: {ctor: '[]'}
				}
			}
		}));
var _user$project$FastParser$baseValuePattern = _user$project$FastParser$mapPat_(
	A2(
		_elm_tools$parser$Parser$inContext,
		'base value pattern',
		A2(_user$project$FastParser$spacesBefore, _user$project$Lang$PBase, _user$project$FastParser$baseValue)));
var _user$project$FastParser$baseValueExpression = _user$project$FastParser$mapExp_(
	A2(_user$project$FastParser$spacesBefore, _user$project$Lang$EBase, _user$project$FastParser$baseValue));
var _user$project$FastParser$variableIdentifierString = A2(
	_elm_tools$parser$Parser$inContext,
	'variable identifier string',
	_user$project$FastParser$trackInfo(
		A3(_elm_tools$parser$Parser_LanguageKit$variable, _user$project$FastParser$validVariableIdentifierFirstChar, _user$project$FastParser$validIdentifierRestChar, _user$project$FastParser$keywords)));
var _user$project$FastParser$variablePattern = A2(
	_elm_tools$parser$Parser$inContext,
	'variable pattern',
	_user$project$FastParser$namePattern(_user$project$FastParser$variableIdentifierString));
var _user$project$FastParser$variableType = A2(
	_elm_tools$parser$Parser$inContext,
	'variable type',
	A2(_user$project$FastParser$spacesBefore, _user$project$Lang$TVar, _user$project$FastParser$variableIdentifierString));
var _user$project$FastParser$variableExpression = _user$project$FastParser$mapExp_(
	A2(_user$project$FastParser$spacesBefore, _user$project$Lang$EVar, _user$project$FastParser$variableIdentifierString));
var _user$project$FastParser$typeIdentifierString = A2(
	_elm_tools$parser$Parser$inContext,
	'type identifier string',
	_user$project$FastParser$trackInfo(
		A3(_elm_tools$parser$Parser_LanguageKit$variable, _user$project$FastParser$validTypeIdentifierFirstChar, _user$project$FastParser$validIdentifierRestChar, _user$project$FastParser$keywords)));
var _user$project$FastParser$typePattern = A2(
	_elm_tools$parser$Parser$inContext,
	'type pattern',
	_user$project$FastParser$namePattern(_user$project$FastParser$typeIdentifierString));
var _user$project$FastParser$namedType = A2(
	_elm_tools$parser$Parser$inContext,
	'named type',
	A2(_user$project$FastParser$spacesBefore, _user$project$Lang$TNamed, _user$project$FastParser$typeIdentifierString));
var _user$project$FastParser$topLevelComment = A2(
	_elm_tools$parser$Parser$inContext,
	'top-level comment',
	A3(
		_elm_tools$parser$Parser$delayedCommitMap,
		F2(
			function (wsStart, _p53) {
				var _p54 = _p53;
				var _p55 = _p54._1;
				return A3(
					_user$project$Lang$withInfo,
					function (rest) {
						return _user$project$Lang$exp_(
							A3(_user$project$Lang$EComment, wsStart, _p55.val, rest));
					},
					_p54._0.start,
					_p55.end);
			}),
		_user$project$FastParser$spaces,
		A2(
			_elm_tools$parser$Parser_ops['|.'],
			A2(
				_elm_tools$parser$Parser_ops['|='],
				A2(
					_elm_tools$parser$Parser_ops['|='],
					_elm_tools$parser$Parser$succeed(
						F2(
							function (v0, v1) {
								return {ctor: '_Tuple2', _0: v0, _1: v1};
							})),
					_user$project$FastParser$trackInfo(
						_elm_tools$parser$Parser$symbol(';'))),
				_user$project$FastParser$trackInfo(
					A2(
						_elm_tools$parser$Parser$keep,
						_elm_tools$parser$Parser$zeroOrMore,
						function (c) {
							return !_elm_lang$core$Native_Utils.eq(
								c,
								_elm_lang$core$Native_Utils.chr('\n'));
						}))),
			_elm_tools$parser$Parser$oneOf(
				{
					ctor: '::',
					_0: _elm_tools$parser$Parser$symbol('\n'),
					_1: {
						ctor: '::',
						_0: _elm_tools$parser$Parser$end,
						_1: {ctor: '[]'}
					}
				}))));
var _user$project$FastParser$topLevelOption = A2(
	_elm_tools$parser$Parser$inContext,
	'top-level option',
	A2(
		_user$project$FastParser$spacesBefore,
		F3(
			function (wsStart, _p56, rest) {
				var _p57 = _p56;
				return _user$project$Lang$exp_(
					A5(_user$project$Lang$EOption, wsStart, _p57._0, _p57._1, _p57._2, rest));
			}),
		_user$project$FastParser$trackInfo(
			A2(
				_elm_tools$parser$Parser_ops['|.'],
				A2(
					_elm_tools$parser$Parser_ops['|='],
					A2(
						_elm_tools$parser$Parser_ops['|='],
						A2(
							_elm_tools$parser$Parser_ops['|.'],
							A2(
								_elm_tools$parser$Parser_ops['|='],
								A2(
									_elm_tools$parser$Parser_ops['|.'],
									A2(
										_elm_tools$parser$Parser_ops['|.'],
										_elm_tools$parser$Parser$succeed(
											F3(
												function (v0, v1, v2) {
													return {ctor: '_Tuple3', _0: v0, _1: v1, _2: v2};
												})),
										_elm_tools$parser$Parser$symbol('#')),
									_user$project$FastParser$spaces),
								_user$project$FastParser$trackInfo(
									A2(
										_elm_tools$parser$Parser$keep,
										_elm_tools$parser$Parser$zeroOrMore,
										function (c) {
											return (!_elm_lang$core$Native_Utils.eq(
												c,
												_elm_lang$core$Native_Utils.chr('\n'))) && ((!_elm_lang$core$Native_Utils.eq(
												c,
												_elm_lang$core$Native_Utils.chr(' '))) && (!_elm_lang$core$Native_Utils.eq(
												c,
												_elm_lang$core$Native_Utils.chr(':'))));
										}))),
							_elm_tools$parser$Parser$symbol(':')),
						_user$project$FastParser$spaces),
					_user$project$FastParser$trackInfo(
						A2(
							_elm_tools$parser$Parser$keep,
							_elm_tools$parser$Parser$zeroOrMore,
							function (c) {
								return !_elm_lang$core$Native_Utils.eq(
									c,
									_elm_lang$core$Native_Utils.chr('\n'));
							}))),
				_elm_tools$parser$Parser$symbol('\n')))));
var _user$project$FastParser$implicitMain = function () {
	var builder = function (p) {
		var withCorrectInfo = function (x) {
			return A3(_user$project$Lang$withInfo, x, p, p);
		};
		var name = function (_p58) {
			return withCorrectInfo(
				_user$project$Lang$pat_(_p58));
		}(
			A3(
				_user$project$Lang$PVar,
				_user$project$Lang$space1,
				'_IMPLICIT_MAIN',
				_user$project$Lang$withDummyInfo(_user$project$Lang$NoWidgetDecl)));
		var binding = function (_p59) {
			return withCorrectInfo(
				_user$project$Lang$exp_(_p59));
		}(
			A2(
				_user$project$Lang$EBase,
				_user$project$Lang$space1,
				A2(_user$project$Lang$EString, _user$project$Lang$defaultQuoteChar, '...')));
		var body = function (_p60) {
			return withCorrectInfo(
				_user$project$Lang$exp_(_p60));
		}(
			A2(_user$project$Lang$EVar, _user$project$Lang$space1, 'main'));
		return function (_p61) {
			return withCorrectInfo(
				_user$project$Lang$exp_(_p61));
		}(
			A7(_user$project$Lang$ELet, _user$project$Lang$newline2, _user$project$Lang$Let, false, name, binding, body, _user$project$Lang$space0));
	};
	return A2(
		_elm_tools$parser$Parser_ops['|='],
		_elm_tools$parser$Parser$succeed(builder),
		_user$project$FastParser$getPos);
}();
var _user$project$FastParser$guard = F2(
	function (failReason, pred) {
		return pred ? _elm_tools$parser$Parser$succeed(
			{ctor: '_Tuple0'}) : _elm_tools$parser$Parser$fail(failReason);
	});
var _user$project$FastParser$guardSpace = _user$project$FastParser$trackInfo(
	A2(
		_elm_tools$parser$Parser$andThen,
		function (_p62) {
			var _p63 = _p62;
			var _p64 = _p63._0;
			return A2(
				_user$project$FastParser$guard,
				'expecting space',
				_user$project$FastParser$isOnlySpaces(
					A3(_elm_lang$core$String$slice, _p64, _p64 + 1, _p63._1)));
		},
		A2(
			_elm_tools$parser$Parser_ops['|='],
			A2(
				_elm_tools$parser$Parser_ops['|='],
				_elm_tools$parser$Parser$succeed(
					F2(
						function (v0, v1) {
							return {ctor: '_Tuple2', _0: v0, _1: v1};
						})),
				_elm_tools$parser$Parser_LowLevel$getOffset),
			_elm_tools$parser$Parser_LowLevel$getSource)));
var _user$project$FastParser$spacedKeyword = function (kword) {
	return _user$project$FastParser$trackInfo(
		A2(
			_elm_tools$parser$Parser_ops['|.'],
			A2(
				_elm_tools$parser$Parser_ops['|.'],
				_elm_tools$parser$Parser$succeed(
					{ctor: '_Tuple0'}),
				_elm_tools$parser$Parser$keyword(kword)),
			_user$project$FastParser$guardSpace));
};
var _user$project$FastParser$unionType = A2(
	_elm_tools$parser$Parser$inContext,
	'union type',
	_elm_tools$parser$Parser$lazy(
		function (_p65) {
			return A2(
				_user$project$FastParser$parenBlock,
				_user$project$Lang$TUnion,
				A2(
					_elm_tools$parser$Parser_ops['|='],
					A2(
						_elm_tools$parser$Parser_ops['|.'],
						_elm_tools$parser$Parser$succeed(_elm_lang$core$Basics$identity),
						_user$project$FastParser$spacedKeyword('union')),
					A2(_elm_tools$parser$Parser$repeat, _elm_tools$parser$Parser$oneOrMore, _user$project$FastParser$typ)));
		}));
var _user$project$FastParser$typ = A2(
	_elm_tools$parser$Parser$inContext,
	'type',
	_elm_tools$parser$Parser$lazy(
		function (_p66) {
			return _elm_tools$parser$Parser$oneOf(
				{
					ctor: '::',
					_0: _user$project$FastParser$nullType,
					_1: {
						ctor: '::',
						_0: _user$project$FastParser$numType,
						_1: {
							ctor: '::',
							_0: _user$project$FastParser$boolType,
							_1: {
								ctor: '::',
								_0: _user$project$FastParser$stringType,
								_1: {
									ctor: '::',
									_0: _user$project$FastParser$wildcardType,
									_1: {
										ctor: '::',
										_0: _elm_tools$parser$Parser$lazy(
											function (_p67) {
												return _user$project$FastParser$functionType;
											}),
										_1: {
											ctor: '::',
											_0: _elm_tools$parser$Parser$lazy(
												function (_p68) {
													return _user$project$FastParser$listType;
												}),
											_1: {
												ctor: '::',
												_0: _elm_tools$parser$Parser$lazy(
													function (_p69) {
														return _user$project$FastParser$dictType;
													}),
												_1: {
													ctor: '::',
													_0: _elm_tools$parser$Parser$lazy(
														function (_p70) {
															return _user$project$FastParser$tupleType;
														}),
													_1: {
														ctor: '::',
														_0: _elm_tools$parser$Parser$lazy(
															function (_p71) {
																return _user$project$FastParser$forallType;
															}),
														_1: {
															ctor: '::',
															_0: _elm_tools$parser$Parser$lazy(
																function (_p72) {
																	return _user$project$FastParser$unionType;
																}),
															_1: {
																ctor: '::',
																_0: _user$project$FastParser$namedType,
																_1: {
																	ctor: '::',
																	_0: _user$project$FastParser$variableType,
																	_1: {ctor: '[]'}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				});
		}));
var _user$project$FastParser$dictType = A2(
	_elm_tools$parser$Parser$inContext,
	'dictionary type',
	_elm_tools$parser$Parser$lazy(
		function (_p73) {
			return A2(
				_user$project$FastParser$parenBlock,
				F3(
					function (wsStart, _p74, wsEnd) {
						var _p75 = _p74;
						return A4(_user$project$Lang$TDict, wsStart, _p75._0, _p75._1, wsEnd);
					}),
				A2(
					_elm_tools$parser$Parser_ops['|='],
					A2(
						_elm_tools$parser$Parser_ops['|='],
						A2(
							_elm_tools$parser$Parser_ops['|.'],
							_elm_tools$parser$Parser$succeed(
								F2(
									function (v0, v1) {
										return {ctor: '_Tuple2', _0: v0, _1: v1};
									})),
							_user$project$FastParser$spacedKeyword('TDict')),
						_user$project$FastParser$typ),
					_user$project$FastParser$typ));
		}));
var _user$project$FastParser$forallType = function () {
	var wsIdentifierPair = A3(
		_elm_tools$parser$Parser$delayedCommitMap,
		F2(
			function (ws, name) {
				return {ctor: '_Tuple2', _0: ws, _1: name.val};
			}),
		_user$project$FastParser$spaces,
		_user$project$FastParser$variableIdentifierString);
	var quantifiers = _elm_tools$parser$Parser$oneOf(
		{
			ctor: '::',
			_0: A2(
				_elm_tools$parser$Parser$inContext,
				'forall type (one)',
				A2(_elm_tools$parser$Parser$map, _user$project$Lang$One, wsIdentifierPair)),
			_1: {
				ctor: '::',
				_0: A2(
					_elm_tools$parser$Parser$inContext,
					'forall type (many) ',
					_user$project$FastParser$untrackInfo(
						A2(
							_user$project$FastParser$parenBlock,
							_user$project$Lang$Many,
							A2(_elm_tools$parser$Parser$repeat, _elm_tools$parser$Parser$zeroOrMore, wsIdentifierPair)))),
				_1: {ctor: '[]'}
			}
		});
	return A2(
		_elm_tools$parser$Parser$inContext,
		'forall type',
		_elm_tools$parser$Parser$lazy(
			function (_p76) {
				return A2(
					_user$project$FastParser$parenBlock,
					F3(
						function (wsStart, _p77, wsEnd) {
							var _p78 = _p77;
							return A4(_user$project$Lang$TForall, wsStart, _p78._0, _p78._1, wsEnd);
						}),
					A2(
						_elm_tools$parser$Parser_ops['|='],
						A2(
							_elm_tools$parser$Parser_ops['|='],
							A2(
								_elm_tools$parser$Parser_ops['|.'],
								_elm_tools$parser$Parser$succeed(
									F2(
										function (v0, v1) {
											return {ctor: '_Tuple2', _0: v0, _1: v1};
										})),
								_user$project$FastParser$spacedKeyword('forall')),
							quantifiers),
						_user$project$FastParser$typ));
			}));
}();
var _user$project$FastParser$functionType = _elm_tools$parser$Parser$lazy(
	function (_p79) {
		return A2(
			_elm_tools$parser$Parser$inContext,
			'function type',
			A2(
				_user$project$FastParser$parenBlock,
				_user$project$Lang$TArrow,
				A2(
					_elm_tools$parser$Parser_ops['|='],
					A2(
						_elm_tools$parser$Parser_ops['|.'],
						_elm_tools$parser$Parser$succeed(_elm_lang$core$Basics$identity),
						_user$project$FastParser$spacedKeyword('->')),
					A2(_elm_tools$parser$Parser$repeat, _elm_tools$parser$Parser$oneOrMore, _user$project$FastParser$typ))));
	});
var _user$project$FastParser$listType = A2(
	_elm_tools$parser$Parser$inContext,
	'list type',
	_elm_tools$parser$Parser$lazy(
		function (_p80) {
			return A2(
				_user$project$FastParser$parenBlock,
				_user$project$Lang$TList,
				A2(
					_elm_tools$parser$Parser_ops['|='],
					A2(
						_elm_tools$parser$Parser_ops['|.'],
						_elm_tools$parser$Parser$succeed(_elm_lang$core$Basics$identity),
						_user$project$FastParser$spacedKeyword('List')),
					_user$project$FastParser$typ));
		}));
var _user$project$FastParser$tupleType = _elm_tools$parser$Parser$lazy(
	function (_p81) {
		return _user$project$FastParser$genericList(
			{
				generalContext: 'tuple type',
				listLiteralContext: 'tuple type list literal',
				multiConsContext: 'tuple type multi cons literal',
				listLiteralCombiner: F3(
					function (wsStart, heads, wsEnd) {
						return A5(_user$project$Lang$TTuple, wsStart, heads, _user$project$Lang$space0, _elm_lang$core$Maybe$Nothing, wsEnd);
					}),
				multiConsCombiner: F5(
					function (wsStart, heads, wsBar, tail, wsEnd) {
						return A5(
							_user$project$Lang$TTuple,
							wsStart,
							heads,
							wsBar,
							_elm_lang$core$Maybe$Just(tail),
							wsEnd);
					}),
				elem: _user$project$FastParser$typ
			});
	});
var _user$project$FastParser$parseT = _elm_tools$parser$Parser$run(_user$project$FastParser$typ);
var _user$project$FastParser$topLevelTypeDeclaration = A2(
	_elm_tools$parser$Parser$inContext,
	'top-level type declaration',
	A2(
		_user$project$FastParser$parenBlock,
		F4(
			function (wsStart, _p82, wsEnd, rest) {
				var _p83 = _p82;
				return _user$project$Lang$exp_(
					A5(_user$project$Lang$ETyp, wsStart, _p83._0, _p83._1, rest, wsEnd));
			}),
		A2(
			_elm_tools$parser$Parser_ops['|='],
			A2(
				_elm_tools$parser$Parser_ops['|='],
				A2(
					_elm_tools$parser$Parser_ops['|.'],
					_elm_tools$parser$Parser$succeed(
						F2(
							function (v0, v1) {
								return {ctor: '_Tuple2', _0: v0, _1: v1};
							})),
					_user$project$FastParser$spacedKeyword('typ')),
				_user$project$FastParser$variablePattern),
			_user$project$FastParser$typ)));
var _user$project$FastParser$topLevelTypeAlias = A2(
	_elm_tools$parser$Parser$inContext,
	'top-level type alias',
	A3(
		_elm_tools$parser$Parser$delayedCommitMap,
		F2(
			function (_p85, _p84) {
				var _p86 = _p85;
				var _p87 = _p84;
				return A3(
					_user$project$Lang$withInfo,
					function (rest) {
						return _user$project$Lang$exp_(
							A5(_user$project$Lang$ETypeAlias, _p86._0, _p86._2, _p87._0, rest, _p87._1));
					},
					_p86._1.start,
					_p87._2.end);
			}),
		A2(
			_elm_tools$parser$Parser_ops['|='],
			A2(
				_elm_tools$parser$Parser_ops['|.'],
				A2(
					_elm_tools$parser$Parser_ops['|='],
					A2(
						_elm_tools$parser$Parser_ops['|='],
						_elm_tools$parser$Parser$succeed(
							F3(
								function (v0, v1, v2) {
									return {ctor: '_Tuple3', _0: v0, _1: v1, _2: v2};
								})),
						_user$project$FastParser$spaces),
					_user$project$FastParser$trackInfo(
						_elm_tools$parser$Parser$symbol('('))),
				_user$project$FastParser$spacedKeyword('def')),
			_user$project$FastParser$typePattern),
		A2(
			_elm_tools$parser$Parser_ops['|='],
			A2(
				_elm_tools$parser$Parser_ops['|='],
				A2(
					_elm_tools$parser$Parser_ops['|='],
					_elm_tools$parser$Parser$succeed(
						F3(
							function (v0, v1, v2) {
								return {ctor: '_Tuple3', _0: v0, _1: v1, _2: v2};
							})),
					_user$project$FastParser$typ),
				_user$project$FastParser$spaces),
			_user$project$FastParser$trackInfo(
				_elm_tools$parser$Parser$symbol(')')))));
var _user$project$FastParser$token = function (s) {
	return A2(
		_elm_tools$parser$Parser$map,
		_elm_lang$core$Basics$always(s),
		_elm_tools$parser$Parser$keyword(s));
};
var _user$project$FastParser$frozenAnnotation = A2(
	_elm_tools$parser$Parser$inContext,
	'frozen annotation',
	_user$project$FastParser$trackInfo(
		_elm_tools$parser$Parser$oneOf(
			A2(
				_elm_lang$core$List$map,
				_user$project$FastParser$token,
				{
					ctor: '::',
					_0: _user$project$Lang$frozen,
					_1: {
						ctor: '::',
						_0: _user$project$Lang$thawed,
						_1: {
							ctor: '::',
							_0: _user$project$Lang$assignOnlyOnce,
							_1: {
								ctor: '::',
								_0: _user$project$Lang$unann,
								_1: {ctor: '[]'}
							}
						}
					}
				}))));
var _user$project$FastParser$try = function (parser) {
	return A3(
		_elm_tools$parser$Parser$delayedCommitMap,
		_elm_lang$core$Basics$always,
		parser,
		_elm_tools$parser$Parser$succeed(
			{ctor: '_Tuple0'}));
};
var _user$project$FastParser$num = function () {
	var sign = _elm_tools$parser$Parser$oneOf(
		{
			ctor: '::',
			_0: A2(
				_elm_tools$parser$Parser_ops['|.'],
				_elm_tools$parser$Parser$succeed(-1),
				_elm_tools$parser$Parser$symbol('-')),
			_1: {
				ctor: '::',
				_0: _elm_tools$parser$Parser$succeed(1),
				_1: {ctor: '[]'}
			}
		});
	return _user$project$FastParser$try(
		A2(
			_elm_tools$parser$Parser$inContext,
			'number',
			_user$project$FastParser$trackInfo(
				A2(
					_elm_tools$parser$Parser_ops['|='],
					A2(
						_elm_tools$parser$Parser_ops['|='],
						_elm_tools$parser$Parser$succeed(
							F2(
								function (s, n) {
									return s * n;
								})),
						sign),
					_elm_tools$parser$Parser$float))));
}();
var _user$project$FastParser$widgetDecl = function (cap) {
	var combiner = F3(
		function (a, tok, b) {
			return A2(
				_elm_lang$core$List$all,
				_user$project$FastParser$isInt,
				{
					ctor: '::',
					_0: a.val,
					_1: {
						ctor: '::',
						_0: b.val,
						_1: {ctor: '[]'}
					}
				}) ? A5(
				_user$project$Lang$IntSlider,
				A2(_user$project$Lang$mapInfo, _elm_lang$core$Basics$floor, a),
				tok,
				A2(_user$project$Lang$mapInfo, _elm_lang$core$Basics$floor, b),
				cap,
				false) : A5(_user$project$Lang$NumSlider, a, tok, b, cap, false);
		});
	return A2(
		_elm_tools$parser$Parser$inContext,
		'widget declaration',
		_user$project$FastParser$trackInfo(
			_elm_tools$parser$Parser$oneOf(
				{
					ctor: '::',
					_0: A2(
						_elm_tools$parser$Parser_ops['|.'],
						A2(
							_elm_tools$parser$Parser_ops['|='],
							A2(
								_elm_tools$parser$Parser_ops['|='],
								A2(
									_elm_tools$parser$Parser_ops['|='],
									A2(
										_elm_tools$parser$Parser_ops['|.'],
										_elm_tools$parser$Parser$succeed(combiner),
										_elm_tools$parser$Parser$symbol('{')),
									_user$project$FastParser$num),
								_user$project$FastParser$trackInfo(
									_user$project$FastParser$token('-'))),
							_user$project$FastParser$num),
						_elm_tools$parser$Parser$symbol('}')),
					_1: {
						ctor: '::',
						_0: _elm_tools$parser$Parser$succeed(_user$project$Lang$NoWidgetDecl),
						_1: {ctor: '[]'}
					}
				})));
};
var _user$project$FastParser$constantPattern = _user$project$FastParser$mapPat_(
	A2(
		_elm_tools$parser$Parser$inContext,
		'constant pattern',
		A2(_user$project$FastParser$spacesBefore, _user$project$Lang$PConst, _user$project$FastParser$num)));
var _user$project$FastParser$pattern = A2(
	_elm_tools$parser$Parser$inContext,
	'pattern',
	_elm_tools$parser$Parser$oneOf(
		{
			ctor: '::',
			_0: _elm_tools$parser$Parser$lazy(
				function (_p88) {
					return _user$project$FastParser$patternList;
				}),
			_1: {
				ctor: '::',
				_0: _elm_tools$parser$Parser$lazy(
					function (_p89) {
						return _user$project$FastParser$asPattern;
					}),
				_1: {
					ctor: '::',
					_0: _user$project$FastParser$constantPattern,
					_1: {
						ctor: '::',
						_0: _user$project$FastParser$baseValuePattern,
						_1: {
							ctor: '::',
							_0: _user$project$FastParser$variablePattern,
							_1: {ctor: '[]'}
						}
					}
				}
			}
		}));
var _user$project$FastParser$asPattern = _user$project$FastParser$mapPat_(
	A2(
		_elm_tools$parser$Parser$inContext,
		'as pattern',
		_elm_tools$parser$Parser$lazy(
			function (_p90) {
				return A3(
					_elm_tools$parser$Parser$delayedCommitMap,
					F2(
						function (_p91, pat) {
							var _p92 = _p91;
							var _p93 = _p92._1;
							return A3(
								_user$project$Lang$withInfo,
								A4(_user$project$Lang$PAs, _p92._0, _p93.val, _p92._2, pat),
								_p93.start,
								pat.end);
						}),
					A2(
						_elm_tools$parser$Parser_ops['|.'],
						A2(
							_elm_tools$parser$Parser_ops['|='],
							A2(
								_elm_tools$parser$Parser_ops['|='],
								A2(
									_elm_tools$parser$Parser_ops['|='],
									_elm_tools$parser$Parser$succeed(
										F3(
											function (v0, v1, v2) {
												return {ctor: '_Tuple3', _0: v0, _1: v1, _2: v2};
											})),
									_user$project$FastParser$spaces),
								_user$project$FastParser$variableIdentifierString),
							_user$project$FastParser$spaces),
						_elm_tools$parser$Parser$symbol('@')),
					_user$project$FastParser$pattern);
			})));
var _user$project$FastParser$patternList = _user$project$FastParser$mapPat_(
	_elm_tools$parser$Parser$lazy(
		function (_p94) {
			return _user$project$FastParser$genericList(
				{
					generalContext: 'pattern list',
					listLiteralContext: 'pattern list literal',
					multiConsContext: 'pattern multi cons literal',
					listLiteralCombiner: F3(
						function (wsStart, heads, wsEnd) {
							return A5(_user$project$Lang$PList, wsStart, heads, _user$project$Lang$space0, _elm_lang$core$Maybe$Nothing, wsEnd);
						}),
					multiConsCombiner: F5(
						function (wsStart, heads, wsBar, tail, wsEnd) {
							return A5(
								_user$project$Lang$PList,
								wsStart,
								heads,
								wsBar,
								_elm_lang$core$Maybe$Just(tail),
								wsEnd);
						}),
					elem: _user$project$FastParser$pattern
				});
		}));
var _user$project$FastParser$constantExpression = _user$project$FastParser$mapExp_(
	A3(
		_elm_tools$parser$Parser$delayedCommitMap,
		F2(
			function (ws, _p95) {
				var _p96 = _p95;
				var _p98 = _p96._2;
				var _p97 = _p96._0;
				return A3(
					_user$project$Lang$withInfo,
					A4(
						_user$project$Lang$EConst,
						ws,
						_p97.val,
						A2(_user$project$FastParser$dummyLocWithDebugInfo, _p96._1.val, _p97.val),
						_p98),
					_p97.start,
					_p98.end);
			}),
		_user$project$FastParser$spaces,
		A2(
			_elm_tools$parser$Parser_ops['|='],
			A2(
				_elm_tools$parser$Parser_ops['|='],
				A2(
					_elm_tools$parser$Parser_ops['|='],
					_elm_tools$parser$Parser$succeed(
						F3(
							function (v0, v1, v2) {
								return {ctor: '_Tuple3', _0: v0, _1: v1, _2: v2};
							})),
					_user$project$FastParser$num),
				_user$project$FastParser$frozenAnnotation),
			_user$project$FastParser$widgetDecl(_elm_lang$core$Maybe$Nothing))));
var _user$project$FastParser$singleton = function (x) {
	return {
		ctor: '::',
		_0: x,
		_1: {ctor: '[]'}
	};
};
var _user$project$FastParser$function = function () {
	var parameters = _elm_tools$parser$Parser$oneOf(
		{
			ctor: '::',
			_0: A2(_elm_tools$parser$Parser$map, _user$project$FastParser$singleton, _user$project$FastParser$pattern),
			_1: {
				ctor: '::',
				_0: _user$project$FastParser$untrackInfo(
					_user$project$FastParser$parenBlockIgnoreWS(
						A2(_elm_tools$parser$Parser$repeat, _elm_tools$parser$Parser$oneOrMore, _user$project$FastParser$pattern))),
				_1: {ctor: '[]'}
			}
		});
	return _user$project$FastParser$mapExp_(
		A2(
			_elm_tools$parser$Parser$inContext,
			'function',
			_elm_tools$parser$Parser$lazy(
				function (_p99) {
					return A2(
						_user$project$FastParser$parenBlock,
						F3(
							function (wsStart, _p100, wsEnd) {
								var _p101 = _p100;
								return A4(_user$project$Lang$EFun, wsStart, _p101._0, _p101._1, wsEnd);
							}),
						A2(
							_elm_tools$parser$Parser_ops['|='],
							A2(
								_elm_tools$parser$Parser_ops['|='],
								A2(
									_elm_tools$parser$Parser_ops['|.'],
									_elm_tools$parser$Parser$succeed(
										F2(
											function (v0, v1) {
												return {ctor: '_Tuple2', _0: v0, _1: v1};
											})),
									_elm_tools$parser$Parser$symbol('\\')),
								parameters),
							_user$project$FastParser$exp));
				})));
}();
var _user$project$FastParser$exp = A2(
	_elm_tools$parser$Parser$inContext,
	'expression',
	_elm_tools$parser$Parser$lazy(
		function (_p102) {
			return _elm_tools$parser$Parser$oneOf(
				{
					ctor: '::',
					_0: _user$project$FastParser$constantExpression,
					_1: {
						ctor: '::',
						_0: _user$project$FastParser$baseValueExpression,
						_1: {
							ctor: '::',
							_0: _elm_tools$parser$Parser$lazy(
								function (_p103) {
									return _user$project$FastParser$typeAlias;
								}),
							_1: {
								ctor: '::',
								_0: _elm_tools$parser$Parser$lazy(
									function (_p104) {
										return _user$project$FastParser$conditional;
									}),
								_1: {
									ctor: '::',
									_0: _elm_tools$parser$Parser$lazy(
										function (_p105) {
											return _user$project$FastParser$letBinding;
										}),
									_1: {
										ctor: '::',
										_0: _elm_tools$parser$Parser$lazy(
											function (_p106) {
												return _user$project$FastParser$caseExpression;
											}),
										_1: {
											ctor: '::',
											_0: _elm_tools$parser$Parser$lazy(
												function (_p107) {
													return _user$project$FastParser$typeCaseExpression;
												}),
											_1: {
												ctor: '::',
												_0: _elm_tools$parser$Parser$lazy(
													function (_p108) {
														return _user$project$FastParser$typeDeclaration;
													}),
												_1: {
													ctor: '::',
													_0: _elm_tools$parser$Parser$lazy(
														function (_p109) {
															return _user$project$FastParser$typeAnnotation;
														}),
													_1: {
														ctor: '::',
														_0: _elm_tools$parser$Parser$lazy(
															function (_p110) {
																return _user$project$FastParser$list;
															}),
														_1: {
															ctor: '::',
															_0: _elm_tools$parser$Parser$lazy(
																function (_p111) {
																	return _user$project$FastParser$function;
																}),
															_1: {
																ctor: '::',
																_0: _elm_tools$parser$Parser$lazy(
																	function (_p112) {
																		return _user$project$FastParser$functionApplication;
																	}),
																_1: {
																	ctor: '::',
																	_0: _elm_tools$parser$Parser$lazy(
																		function (_p113) {
																			return _user$project$FastParser$operator;
																		}),
																	_1: {
																		ctor: '::',
																		_0: _elm_tools$parser$Parser$lazy(
																			function (_p114) {
																				return _user$project$FastParser$comment;
																			}),
																		_1: {
																			ctor: '::',
																			_0: _elm_tools$parser$Parser$lazy(
																				function (_p115) {
																					return _user$project$FastParser$option;
																				}),
																			_1: {
																				ctor: '::',
																				_0: _user$project$FastParser$variableExpression,
																				_1: {ctor: '[]'}
																			}
																		}
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				});
		}));
var _user$project$FastParser$caseExpression = _elm_tools$parser$Parser$lazy(
	function (_p116) {
		return A6(_user$project$FastParser$genericCase, 'case expression', 'case', _user$project$Lang$ECase, _user$project$Lang$Branch_, _user$project$FastParser$exp, _user$project$FastParser$pattern);
	});
var _user$project$FastParser$genericCase = F6(
	function (context, kword, combiner, branchCombiner, parser, branchParser) {
		var path = A2(
			_elm_tools$parser$Parser$inContext,
			A2(_elm_lang$core$Basics_ops['++'], context, ' path'),
			_elm_tools$parser$Parser$lazy(
				function (_p117) {
					return A2(
						_user$project$FastParser$parenBlock,
						F3(
							function (wsStart, _p118, wsEnd) {
								var _p119 = _p118;
								return A4(branchCombiner, wsStart, _p119._0, _p119._1, wsEnd);
							}),
						A2(
							_elm_tools$parser$Parser_ops['|='],
							A2(
								_elm_tools$parser$Parser_ops['|='],
								_elm_tools$parser$Parser$succeed(
									F2(
										function (v0, v1) {
											return {ctor: '_Tuple2', _0: v0, _1: v1};
										})),
								branchParser),
							_user$project$FastParser$exp));
				}));
		return _user$project$FastParser$mapExp_(
			A2(
				_elm_tools$parser$Parser$inContext,
				context,
				_elm_tools$parser$Parser$lazy(
					function (_p120) {
						return A2(
							_user$project$FastParser$parenBlock,
							F3(
								function (wsStart, _p121, wsEnd) {
									var _p122 = _p121;
									return A4(combiner, wsStart, _p122._0, _p122._1, wsEnd);
								}),
							A2(
								_elm_tools$parser$Parser_ops['|='],
								A2(
									_elm_tools$parser$Parser_ops['|='],
									A2(
										_elm_tools$parser$Parser_ops['|.'],
										_elm_tools$parser$Parser$succeed(
											F2(
												function (v0, v1) {
													return {ctor: '_Tuple2', _0: v0, _1: v1};
												})),
										_user$project$FastParser$spacedKeyword(kword)),
									parser),
								A2(_elm_tools$parser$Parser$repeat, _elm_tools$parser$Parser$zeroOrMore, path)));
					})));
	});
var _user$project$FastParser$comment = _user$project$FastParser$mapExp_(
	A2(
		_elm_tools$parser$Parser$inContext,
		'comment',
		_elm_tools$parser$Parser$lazy(
			function (_p123) {
				return A3(
					_elm_tools$parser$Parser$delayedCommitMap,
					F2(
						function (wsStart, _p124) {
							var _p125 = _p124;
							var _p126 = _p125._1;
							return A3(
								_user$project$Lang$withInfo,
								A3(_user$project$Lang$EComment, wsStart, _p126.val, _p125._2),
								_p125._0.start,
								_p126.end);
						}),
					_user$project$FastParser$spaces,
					A2(
						_elm_tools$parser$Parser_ops['|='],
						A2(
							_elm_tools$parser$Parser_ops['|.'],
							A2(
								_elm_tools$parser$Parser_ops['|='],
								A2(
									_elm_tools$parser$Parser_ops['|='],
									_elm_tools$parser$Parser$succeed(
										F3(
											function (v0, v1, v2) {
												return {ctor: '_Tuple3', _0: v0, _1: v1, _2: v2};
											})),
									_user$project$FastParser$trackInfo(
										_elm_tools$parser$Parser$symbol(';'))),
								_user$project$FastParser$trackInfo(
									A2(
										_elm_tools$parser$Parser$keep,
										_elm_tools$parser$Parser$zeroOrMore,
										function (c) {
											return !_elm_lang$core$Native_Utils.eq(
												c,
												_elm_lang$core$Native_Utils.chr('\n'));
										}))),
							_elm_tools$parser$Parser$symbol('\n')),
						_user$project$FastParser$exp));
			})));
var _user$project$FastParser$conditional = _user$project$FastParser$mapExp_(
	A2(
		_elm_tools$parser$Parser$inContext,
		'conditional',
		_elm_tools$parser$Parser$lazy(
			function (_p127) {
				return A2(
					_user$project$FastParser$parenBlock,
					F3(
						function (wsStart, _p128, wsEnd) {
							var _p129 = _p128;
							return A5(_user$project$Lang$EIf, wsStart, _p129._0, _p129._1, _p129._2, wsEnd);
						}),
					A2(
						_elm_tools$parser$Parser_ops['|='],
						A2(
							_elm_tools$parser$Parser_ops['|='],
							A2(
								_elm_tools$parser$Parser_ops['|='],
								A2(
									_elm_tools$parser$Parser_ops['|.'],
									_elm_tools$parser$Parser$succeed(
										F3(
											function (v0, v1, v2) {
												return {ctor: '_Tuple3', _0: v0, _1: v1, _2: v2};
											})),
									_user$project$FastParser$spacedKeyword('if')),
								_user$project$FastParser$exp),
							_user$project$FastParser$exp),
						_user$project$FastParser$exp));
			})));
var _user$project$FastParser$functionApplication = _user$project$FastParser$mapExp_(
	A2(
		_elm_tools$parser$Parser$inContext,
		'function application',
		_elm_tools$parser$Parser$lazy(
			function (_p130) {
				return A2(
					_user$project$FastParser$parenBlock,
					F3(
						function (wsStart, _p131, wsEnd) {
							var _p132 = _p131;
							return A4(_user$project$Lang$EApp, wsStart, _p132._0, _p132._1, wsEnd);
						}),
					A2(
						_elm_tools$parser$Parser_ops['|='],
						A2(
							_elm_tools$parser$Parser_ops['|='],
							_elm_tools$parser$Parser$succeed(
								F2(
									function (v0, v1) {
										return {ctor: '_Tuple2', _0: v0, _1: v1};
									})),
							_user$project$FastParser$exp),
						A2(_elm_tools$parser$Parser$repeat, _elm_tools$parser$Parser$oneOrMore, _user$project$FastParser$exp)));
			})));
var _user$project$FastParser$letBinding = A2(
	_elm_tools$parser$Parser$inContext,
	'let binding',
	_elm_tools$parser$Parser$lazy(
		function (_p133) {
			return _elm_tools$parser$Parser$oneOf(
				{
					ctor: '::',
					_0: _user$project$FastParser$recursiveLetBinding,
					_1: {
						ctor: '::',
						_0: _user$project$FastParser$simpleLetBinding,
						_1: {
							ctor: '::',
							_0: _user$project$FastParser$recursiveDefBinding,
							_1: {
								ctor: '::',
								_0: _user$project$FastParser$simpleDefBinding,
								_1: {ctor: '[]'}
							}
						}
					}
				});
		}));
var _user$project$FastParser$recursiveDefBinding = _elm_tools$parser$Parser$lazy(
	function (_p134) {
		return A3(_user$project$FastParser$genericDefBinding, 'recursive def binding', 'defrec', true);
	});
var _user$project$FastParser$genericDefBinding = F3(
	function (context, kword, isRec) {
		return _user$project$FastParser$mapExp_(
			A2(
				_elm_tools$parser$Parser$inContext,
				context,
				A3(
					_elm_tools$parser$Parser$delayedCommitMap,
					F2(
						function (_p136, _p135) {
							var _p137 = _p136;
							var _p138 = _p135;
							return A3(
								_user$project$Lang$withInfo,
								A7(_user$project$Lang$ELet, _p137._0, _user$project$Lang$Def, isRec, _p138._0, _p138._1, _p138._4, _p138._2),
								_p137._1.start,
								_p138._3.end);
						}),
					A2(
						_elm_tools$parser$Parser_ops['|='],
						A2(
							_elm_tools$parser$Parser_ops['|='],
							_elm_tools$parser$Parser$succeed(
								F2(
									function (v0, v1) {
										return {ctor: '_Tuple2', _0: v0, _1: v1};
									})),
							_user$project$FastParser$spaces),
						_user$project$FastParser$trackInfo(
							_elm_tools$parser$Parser$symbol('('))),
					A2(
						_elm_tools$parser$Parser_ops['|='],
						A2(
							_elm_tools$parser$Parser_ops['|='],
							A2(
								_elm_tools$parser$Parser_ops['|='],
								A2(
									_elm_tools$parser$Parser_ops['|='],
									A2(
										_elm_tools$parser$Parser_ops['|='],
										A2(
											_elm_tools$parser$Parser_ops['|.'],
											_elm_tools$parser$Parser$succeed(
												F5(
													function (v0, v1, v2, v3, v4) {
														return {ctor: '_Tuple5', _0: v0, _1: v1, _2: v2, _3: v3, _4: v4};
													})),
											_user$project$FastParser$spacedKeyword(kword)),
										_user$project$FastParser$pattern),
									_user$project$FastParser$exp),
								_user$project$FastParser$spaces),
							_user$project$FastParser$trackInfo(
								_elm_tools$parser$Parser$symbol(')'))),
						_user$project$FastParser$exp))));
	});
var _user$project$FastParser$recursiveLetBinding = _elm_tools$parser$Parser$lazy(
	function (_p139) {
		return A3(_user$project$FastParser$genericLetBinding, 'recursive let binding', 'letrec', true);
	});
var _user$project$FastParser$genericLetBinding = F3(
	function (context, kword, isRec) {
		return _user$project$FastParser$mapExp_(
			A2(
				_elm_tools$parser$Parser$inContext,
				context,
				A2(
					_user$project$FastParser$parenBlock,
					F3(
						function (wsStart, _p140, wsEnd) {
							var _p141 = _p140;
							return A7(_user$project$Lang$ELet, wsStart, _user$project$Lang$Let, isRec, _p141._0, _p141._1, _p141._2, wsEnd);
						}),
					A2(
						_elm_tools$parser$Parser_ops['|='],
						A2(
							_elm_tools$parser$Parser_ops['|='],
							A2(
								_elm_tools$parser$Parser_ops['|='],
								A2(
									_elm_tools$parser$Parser_ops['|.'],
									_elm_tools$parser$Parser$succeed(
										F3(
											function (v0, v1, v2) {
												return {ctor: '_Tuple3', _0: v0, _1: v1, _2: v2};
											})),
									_user$project$FastParser$spacedKeyword(kword)),
								_user$project$FastParser$pattern),
							_user$project$FastParser$exp),
						_user$project$FastParser$exp))));
	});
var _user$project$FastParser$simpleDefBinding = _elm_tools$parser$Parser$lazy(
	function (_p142) {
		return A3(_user$project$FastParser$genericDefBinding, 'non-recursive def binding', 'def', false);
	});
var _user$project$FastParser$simpleLetBinding = _elm_tools$parser$Parser$lazy(
	function (_p143) {
		return A3(_user$project$FastParser$genericLetBinding, 'non-recursive let binding', 'let', false);
	});
var _user$project$FastParser$list = _user$project$FastParser$mapExp_(
	_elm_tools$parser$Parser$lazy(
		function (_p144) {
			return _user$project$FastParser$genericList(
				{
					generalContext: 'list',
					listLiteralContext: 'list literal',
					multiConsContext: 'multi cons literal',
					listLiteralCombiner: F3(
						function (wsStart, heads, wsEnd) {
							return A5(_user$project$Lang$EList, wsStart, heads, _user$project$Lang$space0, _elm_lang$core$Maybe$Nothing, wsEnd);
						}),
					multiConsCombiner: F5(
						function (wsStart, heads, wsBar, tail, wsEnd) {
							return A5(
								_user$project$Lang$EList,
								wsStart,
								heads,
								wsBar,
								_elm_lang$core$Maybe$Just(tail),
								wsEnd);
						}),
					elem: _user$project$FastParser$exp
				});
		}));
var _user$project$FastParser$operator = _user$project$FastParser$mapExp_(
	function () {
		var op = _user$project$FastParser$trackInfo(
			_elm_tools$parser$Parser$oneOf(
				{
					ctor: '::',
					_0: A2(
						_elm_tools$parser$Parser_ops['|.'],
						_elm_tools$parser$Parser$succeed(_user$project$Lang$Pi),
						_elm_tools$parser$Parser$keyword('pi')),
					_1: {
						ctor: '::',
						_0: A2(
							_elm_tools$parser$Parser_ops['|.'],
							_elm_tools$parser$Parser$succeed(_user$project$Lang$DictEmpty),
							_elm_tools$parser$Parser$keyword('empty')),
						_1: {
							ctor: '::',
							_0: A2(
								_elm_tools$parser$Parser_ops['|.'],
								_elm_tools$parser$Parser$succeed(_user$project$Lang$Cos),
								_user$project$FastParser$spacedKeyword('cos')),
							_1: {
								ctor: '::',
								_0: A2(
									_elm_tools$parser$Parser_ops['|.'],
									_elm_tools$parser$Parser$succeed(_user$project$Lang$Sin),
									_user$project$FastParser$spacedKeyword('sin')),
								_1: {
									ctor: '::',
									_0: A2(
										_elm_tools$parser$Parser_ops['|.'],
										_elm_tools$parser$Parser$succeed(_user$project$Lang$ArcCos),
										_user$project$FastParser$spacedKeyword('arccos')),
									_1: {
										ctor: '::',
										_0: A2(
											_elm_tools$parser$Parser_ops['|.'],
											_elm_tools$parser$Parser$succeed(_user$project$Lang$ArcSin),
											_user$project$FastParser$spacedKeyword('arcsin')),
										_1: {
											ctor: '::',
											_0: A2(
												_elm_tools$parser$Parser_ops['|.'],
												_elm_tools$parser$Parser$succeed(_user$project$Lang$Floor),
												_user$project$FastParser$spacedKeyword('floor')),
											_1: {
												ctor: '::',
												_0: A2(
													_elm_tools$parser$Parser_ops['|.'],
													_elm_tools$parser$Parser$succeed(_user$project$Lang$Ceil),
													_user$project$FastParser$spacedKeyword('ceiling')),
												_1: {
													ctor: '::',
													_0: A2(
														_elm_tools$parser$Parser_ops['|.'],
														_elm_tools$parser$Parser$succeed(_user$project$Lang$Round),
														_user$project$FastParser$spacedKeyword('round')),
													_1: {
														ctor: '::',
														_0: A2(
															_elm_tools$parser$Parser_ops['|.'],
															_elm_tools$parser$Parser$succeed(_user$project$Lang$ToStr),
															_user$project$FastParser$spacedKeyword('toString')),
														_1: {
															ctor: '::',
															_0: A2(
																_elm_tools$parser$Parser_ops['|.'],
																_elm_tools$parser$Parser$succeed(_user$project$Lang$Sqrt),
																_user$project$FastParser$spacedKeyword('sqrt')),
															_1: {
																ctor: '::',
																_0: A2(
																	_elm_tools$parser$Parser_ops['|.'],
																	_elm_tools$parser$Parser$succeed(_user$project$Lang$Explode),
																	_user$project$FastParser$spacedKeyword('explode')),
																_1: {
																	ctor: '::',
																	_0: A2(
																		_elm_tools$parser$Parser_ops['|.'],
																		_elm_tools$parser$Parser$succeed(_user$project$Lang$Plus),
																		_user$project$FastParser$spacedKeyword('+')),
																	_1: {
																		ctor: '::',
																		_0: A2(
																			_elm_tools$parser$Parser_ops['|.'],
																			_elm_tools$parser$Parser$succeed(_user$project$Lang$Minus),
																			_user$project$FastParser$spacedKeyword('-')),
																		_1: {
																			ctor: '::',
																			_0: A2(
																				_elm_tools$parser$Parser_ops['|.'],
																				_elm_tools$parser$Parser$succeed(_user$project$Lang$Mult),
																				_user$project$FastParser$spacedKeyword('*')),
																			_1: {
																				ctor: '::',
																				_0: A2(
																					_elm_tools$parser$Parser_ops['|.'],
																					_elm_tools$parser$Parser$succeed(_user$project$Lang$Div),
																					_user$project$FastParser$spacedKeyword('/')),
																				_1: {
																					ctor: '::',
																					_0: A2(
																						_elm_tools$parser$Parser_ops['|.'],
																						_elm_tools$parser$Parser$succeed(_user$project$Lang$Lt),
																						_user$project$FastParser$spacedKeyword('<')),
																					_1: {
																						ctor: '::',
																						_0: A2(
																							_elm_tools$parser$Parser_ops['|.'],
																							_elm_tools$parser$Parser$succeed(_user$project$Lang$Eq),
																							_user$project$FastParser$spacedKeyword('=')),
																						_1: {
																							ctor: '::',
																							_0: A2(
																								_elm_tools$parser$Parser_ops['|.'],
																								_elm_tools$parser$Parser$succeed(_user$project$Lang$Mod),
																								_user$project$FastParser$spacedKeyword('mod')),
																							_1: {
																								ctor: '::',
																								_0: A2(
																									_elm_tools$parser$Parser_ops['|.'],
																									_elm_tools$parser$Parser$succeed(_user$project$Lang$Pow),
																									_user$project$FastParser$spacedKeyword('pow')),
																								_1: {
																									ctor: '::',
																									_0: A2(
																										_elm_tools$parser$Parser_ops['|.'],
																										_elm_tools$parser$Parser$succeed(_user$project$Lang$ArcTan2),
																										_user$project$FastParser$spacedKeyword('arctan2')),
																									_1: {
																										ctor: '::',
																										_0: A2(
																											_elm_tools$parser$Parser_ops['|.'],
																											_elm_tools$parser$Parser$succeed(_user$project$Lang$DictInsert),
																											_user$project$FastParser$spacedKeyword('insert')),
																										_1: {
																											ctor: '::',
																											_0: A2(
																												_elm_tools$parser$Parser_ops['|.'],
																												_elm_tools$parser$Parser$succeed(_user$project$Lang$DictGet),
																												_user$project$FastParser$spacedKeyword('get')),
																											_1: {
																												ctor: '::',
																												_0: A2(
																													_elm_tools$parser$Parser_ops['|.'],
																													_elm_tools$parser$Parser$succeed(_user$project$Lang$DictRemove),
																													_user$project$FastParser$spacedKeyword('remove')),
																												_1: {
																													ctor: '::',
																													_0: A2(
																														_elm_tools$parser$Parser_ops['|.'],
																														_elm_tools$parser$Parser$succeed(_user$project$Lang$DebugLog),
																														_user$project$FastParser$spacedKeyword('debug')),
																													_1: {ctor: '[]'}
																												}
																											}
																										}
																									}
																								}
																							}
																						}
																					}
																				}
																			}
																		}
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}));
		return A2(
			_elm_tools$parser$Parser$inContext,
			'operator',
			_elm_tools$parser$Parser$lazy(
				function (_p145) {
					return A2(
						_user$project$FastParser$parenBlock,
						F3(
							function (wsStart, _p146, wsEnd) {
								var _p147 = _p146;
								return A4(_user$project$Lang$EOp, wsStart, _p147._0, _p147._1, wsEnd);
							}),
						A2(
							_elm_tools$parser$Parser_ops['|='],
							A2(
								_elm_tools$parser$Parser_ops['|='],
								_elm_tools$parser$Parser$succeed(
									F2(
										function (v0, v1) {
											return {ctor: '_Tuple2', _0: v0, _1: v1};
										})),
								op),
							A2(_elm_tools$parser$Parser$repeat, _elm_tools$parser$Parser$zeroOrMore, _user$project$FastParser$exp)));
				}));
	}());
var _user$project$FastParser$option = _user$project$FastParser$mapExp_(
	A2(
		_elm_tools$parser$Parser$inContext,
		'option',
		_elm_tools$parser$Parser$lazy(
			function (_p148) {
				return A3(
					_elm_tools$parser$Parser$delayedCommitMap,
					F2(
						function (wsStart, _p149) {
							var _p150 = _p149;
							var _p151 = _p150._3;
							return A3(
								_user$project$Lang$withInfo,
								A5(_user$project$Lang$EOption, wsStart, _p150._1, _p150._2, _p151, _p150._4),
								_p150._0.start,
								_p151.end);
						}),
					_user$project$FastParser$spaces,
					A2(
						_elm_tools$parser$Parser_ops['|='],
						A2(
							_elm_tools$parser$Parser_ops['|.'],
							A2(
								_elm_tools$parser$Parser_ops['|='],
								A2(
									_elm_tools$parser$Parser_ops['|='],
									A2(
										_elm_tools$parser$Parser_ops['|.'],
										A2(
											_elm_tools$parser$Parser_ops['|='],
											A2(
												_elm_tools$parser$Parser_ops['|.'],
												A2(
													_elm_tools$parser$Parser_ops['|='],
													_elm_tools$parser$Parser$succeed(
														F5(
															function (v0, v1, v2, v3, v4) {
																return {ctor: '_Tuple5', _0: v0, _1: v1, _2: v2, _3: v3, _4: v4};
															})),
													_user$project$FastParser$trackInfo(
														_elm_tools$parser$Parser$symbol('#'))),
												_user$project$FastParser$spaces),
											_user$project$FastParser$trackInfo(
												A2(
													_elm_tools$parser$Parser$keep,
													_elm_tools$parser$Parser$zeroOrMore,
													function (c) {
														return (!_elm_lang$core$Native_Utils.eq(
															c,
															_elm_lang$core$Native_Utils.chr('\n'))) && ((!_elm_lang$core$Native_Utils.eq(
															c,
															_elm_lang$core$Native_Utils.chr(' '))) && (!_elm_lang$core$Native_Utils.eq(
															c,
															_elm_lang$core$Native_Utils.chr(':'))));
													}))),
										_elm_tools$parser$Parser$symbol(':')),
									_user$project$FastParser$spaces),
								_user$project$FastParser$trackInfo(
									A2(
										_elm_tools$parser$Parser$keep,
										_elm_tools$parser$Parser$zeroOrMore,
										function (c) {
											return !_elm_lang$core$Native_Utils.eq(
												c,
												_elm_lang$core$Native_Utils.chr('\n'));
										}))),
							_elm_tools$parser$Parser$symbol('\n')),
						_user$project$FastParser$exp));
			})));
var _user$project$FastParser$typeAlias = _user$project$FastParser$mapExp_(
	A2(
		_elm_tools$parser$Parser$inContext,
		'type alias',
		A3(
			_elm_tools$parser$Parser$delayedCommitMap,
			F2(
				function (_p153, _p152) {
					var _p154 = _p153;
					var _p155 = _p152;
					return A3(
						_user$project$Lang$withInfo,
						A5(_user$project$Lang$ETypeAlias, _p154._0, _p154._2, _p155._0, _p155._3, _p155._1),
						_p154._1.start,
						_p155._2.end);
				}),
			A2(
				_elm_tools$parser$Parser_ops['|='],
				A2(
					_elm_tools$parser$Parser_ops['|.'],
					A2(
						_elm_tools$parser$Parser_ops['|='],
						A2(
							_elm_tools$parser$Parser_ops['|='],
							_elm_tools$parser$Parser$succeed(
								F3(
									function (v0, v1, v2) {
										return {ctor: '_Tuple3', _0: v0, _1: v1, _2: v2};
									})),
							_user$project$FastParser$spaces),
						_user$project$FastParser$trackInfo(
							_elm_tools$parser$Parser$symbol('('))),
					_user$project$FastParser$spacedKeyword('def ')),
				_user$project$FastParser$typePattern),
			A2(
				_elm_tools$parser$Parser_ops['|='],
				A2(
					_elm_tools$parser$Parser_ops['|='],
					A2(
						_elm_tools$parser$Parser_ops['|='],
						A2(
							_elm_tools$parser$Parser_ops['|='],
							_elm_tools$parser$Parser$succeed(
								F4(
									function (v0, v1, v2, v3) {
										return {ctor: '_Tuple4', _0: v0, _1: v1, _2: v2, _3: v3};
									})),
							_user$project$FastParser$typ),
						_user$project$FastParser$spaces),
					_user$project$FastParser$trackInfo(
						_elm_tools$parser$Parser$symbol(')'))),
				_user$project$FastParser$exp))));
var _user$project$FastParser$typeAnnotation = _user$project$FastParser$mapExp_(
	A2(
		_elm_tools$parser$Parser$inContext,
		'type annotation',
		_elm_tools$parser$Parser$lazy(
			function (_p156) {
				return A2(
					_user$project$FastParser$parenBlock,
					F3(
						function (wsStart, _p157, wsEnd) {
							var _p158 = _p157;
							return A5(_user$project$Lang$EColonType, wsStart, _p158._0, _p158._1, _p158._2, wsEnd);
						}),
					A3(
						_elm_tools$parser$Parser$delayedCommitMap,
						F2(
							function (_p159, t) {
								var _p160 = _p159;
								return {ctor: '_Tuple3', _0: _p160._0, _1: _p160._1, _2: t};
							}),
						A2(
							_elm_tools$parser$Parser_ops['|.'],
							A2(
								_elm_tools$parser$Parser_ops['|='],
								A2(
									_elm_tools$parser$Parser_ops['|='],
									_elm_tools$parser$Parser$succeed(
										F2(
											function (v0, v1) {
												return {ctor: '_Tuple2', _0: v0, _1: v1};
											})),
									_user$project$FastParser$exp),
								_user$project$FastParser$spaces),
							_elm_tools$parser$Parser$symbol(':')),
						_user$project$FastParser$typ));
			})));
var _user$project$FastParser$typeCaseExpression = _elm_tools$parser$Parser$lazy(
	function (_p161) {
		return A6(_user$project$FastParser$genericCase, 'type case expression', 'typecase', _user$project$Lang$ETypeCase, _user$project$Lang$TBranch_, _user$project$FastParser$pattern, _user$project$FastParser$typ);
	});
var _user$project$FastParser$typeDeclaration = _user$project$FastParser$mapExp_(
	A2(
		_elm_tools$parser$Parser$inContext,
		'type declaration',
		A3(
			_elm_tools$parser$Parser$delayedCommitMap,
			F2(
				function (_p163, _p162) {
					var _p164 = _p163;
					var _p165 = _p162;
					return A3(
						_user$project$Lang$withInfo,
						A5(_user$project$Lang$ETyp, _p164._0, _p165._0, _p165._1, _p165._4, _p165._2),
						_p164._1.start,
						_p165._3.end);
				}),
			A2(
				_elm_tools$parser$Parser_ops['|='],
				A2(
					_elm_tools$parser$Parser_ops['|='],
					_elm_tools$parser$Parser$succeed(
						F2(
							function (v0, v1) {
								return {ctor: '_Tuple2', _0: v0, _1: v1};
							})),
					_user$project$FastParser$spaces),
				_user$project$FastParser$trackInfo(
					_elm_tools$parser$Parser$symbol('('))),
			A2(
				_elm_tools$parser$Parser_ops['|='],
				A2(
					_elm_tools$parser$Parser_ops['|='],
					A2(
						_elm_tools$parser$Parser_ops['|='],
						A2(
							_elm_tools$parser$Parser_ops['|='],
							A2(
								_elm_tools$parser$Parser_ops['|='],
								A2(
									_elm_tools$parser$Parser_ops['|.'],
									_elm_tools$parser$Parser$succeed(
										F5(
											function (v0, v1, v2, v3, v4) {
												return {ctor: '_Tuple5', _0: v0, _1: v1, _2: v2, _3: v3, _4: v4};
											})),
									_user$project$FastParser$spacedKeyword('typ')),
								_user$project$FastParser$variablePattern),
							_user$project$FastParser$typ),
						_user$project$FastParser$spaces),
					_user$project$FastParser$trackInfo(
						_elm_tools$parser$Parser$symbol(')'))),
				_user$project$FastParser$exp))));
var _user$project$FastParser$genericTopLevelDef = F3(
	function (context, kword, isRec) {
		return A2(
			_elm_tools$parser$Parser$inContext,
			context,
			A2(
				_user$project$FastParser$parenBlock,
				F4(
					function (wsStart, _p166, wsEnd, rest) {
						var _p167 = _p166;
						return _user$project$Lang$exp_(
							A7(_user$project$Lang$ELet, wsStart, _user$project$Lang$Def, isRec, _p167._0, _p167._1, rest, wsEnd));
					}),
				A2(
					_elm_tools$parser$Parser_ops['|='],
					A2(
						_elm_tools$parser$Parser_ops['|='],
						A2(
							_elm_tools$parser$Parser_ops['|.'],
							_elm_tools$parser$Parser$succeed(
								F2(
									function (v0, v1) {
										return {ctor: '_Tuple2', _0: v0, _1: v1};
									})),
							_user$project$FastParser$spacedKeyword(kword)),
						_user$project$FastParser$pattern),
					_user$project$FastParser$exp)));
	});
var _user$project$FastParser$recursiveTopLevelDef = A3(_user$project$FastParser$genericTopLevelDef, 'top-level recursive def binding', 'defrec', true);
var _user$project$FastParser$simpleTopLevelDef = A3(_user$project$FastParser$genericTopLevelDef, 'top-level non-recursive def binding', 'def', false);
var _user$project$FastParser$topLevelDef = A2(
	_elm_tools$parser$Parser$inContext,
	'top-level def binding',
	_elm_tools$parser$Parser$oneOf(
		{
			ctor: '::',
			_0: _user$project$FastParser$recursiveTopLevelDef,
			_1: {
				ctor: '::',
				_0: _user$project$FastParser$simpleTopLevelDef,
				_1: {ctor: '[]'}
			}
		}));
var _user$project$FastParser$topLevelExp = A2(
	_elm_tools$parser$Parser$inContext,
	'top-level expression',
	_elm_tools$parser$Parser$oneOf(
		{
			ctor: '::',
			_0: _user$project$FastParser$topLevelTypeAlias,
			_1: {
				ctor: '::',
				_0: _user$project$FastParser$topLevelDef,
				_1: {
					ctor: '::',
					_0: _user$project$FastParser$topLevelTypeDeclaration,
					_1: {
						ctor: '::',
						_0: _user$project$FastParser$topLevelComment,
						_1: {
							ctor: '::',
							_0: _user$project$FastParser$topLevelOption,
							_1: {ctor: '[]'}
						}
					}
				}
			}
		}));
var _user$project$FastParser$allTopLevelExps = A2(_elm_tools$parser$Parser$repeat, _elm_tools$parser$Parser$zeroOrMore, _user$project$FastParser$topLevelExp);
var _user$project$FastParser$mainExp = _elm_tools$parser$Parser$oneOf(
	{
		ctor: '::',
		_0: _user$project$FastParser$exp,
		_1: {
			ctor: '::',
			_0: _user$project$FastParser$implicitMain,
			_1: {ctor: '[]'}
		}
	});
var _user$project$FastParser$program = A2(
	_elm_tools$parser$Parser_ops['|.'],
	A2(
		_elm_tools$parser$Parser_ops['|.'],
		A2(
			_elm_tools$parser$Parser_ops['|='],
			A2(
				_elm_tools$parser$Parser_ops['|='],
				_elm_tools$parser$Parser$succeed(_user$project$FastParser$fuseTopLevelExps),
				_user$project$FastParser$allTopLevelExps),
			_user$project$FastParser$mainExp),
		_user$project$FastParser$spaces),
	_elm_tools$parser$Parser$end);
var _user$project$FastParser$parseE_ = function (f) {
	return _elm_tools$parser$Parser$run(
		A2(_elm_tools$parser$Parser$map, f, _user$project$FastParser$program));
};
var _user$project$FastParser$_p168 = A2(
	_user$project$FastParser$freshenClean,
	1,
	A2(
		_user$project$Utils$fromOkay,
		'parse prelude',
		A2(_user$project$FastParser$parseE_, _elm_lang$core$Basics$identity, _user$project$PreludeGenerated$src)));
var _user$project$FastParser$prelude = _user$project$FastParser$_p168._0;
var _user$project$FastParser$initK = _user$project$FastParser$_p168._1;
var _user$project$FastParser$isPreludeLocId = function (k) {
	return _elm_lang$core$Native_Utils.cmp(k, _user$project$FastParser$initK) < 0;
};
var _user$project$FastParser$isPreludeLoc = function (_p169) {
	var _p170 = _p169;
	return _user$project$FastParser$isPreludeLocId(_p170._0);
};
var _user$project$FastParser$isPreludeEId = function (k) {
	return _elm_lang$core$Native_Utils.cmp(k, _user$project$FastParser$initK) < 0;
};
var _user$project$FastParser$duplicateAndAllIds = function (exp) {
	return A3(
		_elm_lang$core$List$foldl,
		F2(
			function (id, _p171) {
				var _p172 = _p171;
				var _p174 = _p172._1;
				var _p173 = _p172._0;
				return (_elm_lang$core$Native_Utils.cmp(id, _user$project$FastParser$initK) > -1) ? (A2(_elm_lang$core$Set$member, id, _p174) ? {
					ctor: '_Tuple2',
					_0: A2(_elm_lang$core$Set$insert, id, _p173),
					_1: _p174
				} : {
					ctor: '_Tuple2',
					_0: _p173,
					_1: A2(_elm_lang$core$Set$insert, id, _p174)
				}) : {ctor: '_Tuple2', _0: _p173, _1: _p174};
			}),
		{ctor: '_Tuple2', _0: _elm_lang$core$Set$empty, _1: _elm_lang$core$Set$empty},
		_user$project$FastParser$allIdsRaw(exp));
};
var _user$project$FastParser$freshen = function (e) {
	var _p175 = _user$project$FastParser$duplicateAndAllIds(e);
	var duplicateIds = _p175._0;
	var allIds = _p175._1;
	var idsToPreserve = A2(_elm_lang$core$Set$diff, allIds, duplicateIds);
	var startK = _user$project$Utils$fromJust(
		_elm_lang$core$List$maximum(
			{
				ctor: '::',
				_0: _user$project$FastParser$initK,
				_1: _elm_lang$core$Set$toList(allIds)
			})) + 1;
	var _p176 = A3(_user$project$FastParser$freshenPreserving, idsToPreserve, startK, e);
	var result = _p176._0;
	return result;
};
var _user$project$FastParser$parseE = _user$project$FastParser$parseE_(_user$project$FastParser$freshen);
var _user$project$FastParser$allIds = function (exp) {
	return _elm_lang$core$Tuple$second(
		_user$project$FastParser$duplicateAndAllIds(exp));
};
var _user$project$FastParser$preludeIds = _user$project$FastParser$allIds(_user$project$FastParser$prelude);
var _user$project$FastParser$maxId = function (exp) {
	var ids = _user$project$FastParser$allIds(exp);
	return _user$project$Utils$fromJust(
		_elm_lang$core$List$maximum(
			{
				ctor: '::',
				_0: _user$project$FastParser$initK,
				_1: _elm_lang$core$Set$toList(ids)
			}));
};
var _user$project$FastParser$preludeSubst = A2(_user$project$FastParser$substPlusOf_, _elm_lang$core$Dict$empty, _user$project$FastParser$prelude);
var _user$project$FastParser$substPlusOf = function (e) {
	return A2(_user$project$FastParser$substPlusOf_, _user$project$FastParser$preludeSubst, e);
};
var _user$project$FastParser$substOf = function (_p177) {
	return A2(
		_elm_lang$core$Dict$map,
		_elm_lang$core$Basics$always(
			function (_) {
				return _.val;
			}),
		_user$project$FastParser$substPlusOf(_p177));
};
var _user$project$FastParser$substStrOf = function (_p178) {
	return A2(
		_elm_lang$core$Dict$map,
		_elm_lang$core$Basics$always(_elm_lang$core$Basics$toString),
		_user$project$FastParser$substOf(_p178));
};

var _user$project$Config$params = {
	strVersion: 'v0.6.3',
	debugLayout: false,
	wGut: 10,
	topSection: {h: 38, wLogo: 25, wBtnO: 180, hBtnO: 25, wJunk: 250},
	botSection: {h: 60},
	mainSection: {
		widgets: {wBtn: 120, wBtnWide: 140, hBtn: 25, font: 'Helvetica, sans-serif', fontSize: '10pt'},
		vertical: {hExtra: 6, wGut: 10},
		horizontal: {wExtra: 15, hGut: 10},
		canvas: {border: '2px solid darkGray', hZoneInfo: 40},
		codebox: {border: '2px solid darkGray', font: 'Courier, monospace', fontSize: '12pt'},
		uiWidgets: {pad: 5, wSlider: 100, hSlider: 25, wCaption: 100, rBall: '10px', fontSize: '11pt', font: 'Tahoma, sans-serif'}
	}
};
var _user$project$Config$computeLayoutInfo = function (model) {
	var hBot = _user$project$Config$params.botSection.h;
	var hTop = _user$project$Config$params.topSection.h;
	var hWindow = model.dimensions.height;
	var hCodebox = (hWindow - (hTop + hBot)) - 3;
	var hCanvas = hCodebox;
	var wWindow = model.dimensions.width;
	var wCodebox = ((wWindow / 2) | 0) - 10;
	var wCanvas = wCodebox;
	var wSideGutter = _user$project$Config$params.wGut;
	return {hTop: hTop, hBot: hBot, hMid: hCodebox, wCodebox: wCodebox, hCodebox: hCodebox, wCanvas: wCanvas, hCanvas: hCanvas, xCanvas: wCodebox, yCanvas: hCodebox};
};
var _user$project$Config$debugLog = F3(
	function (b, s, x) {
		return b ? A2(_elm_lang$core$Debug$log, s, x) : x;
	});
var _user$project$Config$debugTypeChecker = true;
var _user$project$Config$debugStorage = false;
var _user$project$Config$debugSync = false;
var _user$project$Config$debugController = false;
var _user$project$Config$debugView = false;
var _user$project$Config$debugParser = false;

var _user$project$LangUnparser$unparseTypeWithUniformWhitespace = function (tipe) {
	var recurse = function (t) {
		return _user$project$LangUnparser$unparseTypeWithUniformWhitespace(t);
	};
	var _p0 = tipe.val;
	switch (_p0.ctor) {
		case 'TNum':
			return A2(_elm_lang$core$Basics_ops['++'], ' ', 'Num');
		case 'TBool':
			return A2(_elm_lang$core$Basics_ops['++'], ' ', 'Bool');
		case 'TString':
			return A2(_elm_lang$core$Basics_ops['++'], ' ', 'String');
		case 'TNull':
			return A2(_elm_lang$core$Basics_ops['++'], ' ', 'Null');
		case 'TList':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				' ',
				A2(
					_elm_lang$core$Basics_ops['++'],
					'(List',
					A2(
						_elm_lang$core$Basics_ops['++'],
						recurse(_p0._1),
						A2(_elm_lang$core$Basics_ops['++'], ' ', ')'))));
		case 'TDict':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				' ',
				A2(
					_elm_lang$core$Basics_ops['++'],
					'(Dict',
					A2(
						_elm_lang$core$Basics_ops['++'],
						recurse(_p0._1),
						A2(
							_elm_lang$core$Basics_ops['++'],
							recurse(_p0._2),
							A2(_elm_lang$core$Basics_ops['++'], ' ', ')')))));
		case 'TTuple':
			var _p2 = _p0._1;
			var _p1 = _p0._3;
			if (_p1.ctor === 'Just') {
				return A2(
					_elm_lang$core$Basics_ops['++'],
					' ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						'[',
						A2(
							_elm_lang$core$Basics_ops['++'],
							_elm_lang$core$String$concat(
								A2(_elm_lang$core$List$map, recurse, _p2)),
							A2(
								_elm_lang$core$Basics_ops['++'],
								' ',
								A2(
									_elm_lang$core$Basics_ops['++'],
									'|',
									A2(
										_elm_lang$core$Basics_ops['++'],
										recurse(_p1._0),
										A2(_elm_lang$core$Basics_ops['++'], ' ', ']')))))));
			} else {
				return A2(
					_elm_lang$core$Basics_ops['++'],
					' ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						'[',
						A2(
							_elm_lang$core$Basics_ops['++'],
							_elm_lang$core$String$concat(
								A2(_elm_lang$core$List$map, recurse, _p2)),
							A2(_elm_lang$core$Basics_ops['++'], ' ', ']'))));
			}
		case 'TArrow':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				' ',
				A2(
					_elm_lang$core$Basics_ops['++'],
					'(->',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_elm_lang$core$String$concat(
							A2(_elm_lang$core$List$map, recurse, _p0._1)),
						A2(_elm_lang$core$Basics_ops['++'], ' ', ')'))));
		case 'TUnion':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				' ',
				A2(
					_elm_lang$core$Basics_ops['++'],
					'(union',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_elm_lang$core$String$concat(
							A2(_elm_lang$core$List$map, recurse, _p0._1)),
						A2(_elm_lang$core$Basics_ops['++'], ' ', ')'))));
		case 'TNamed':
			switch (_p0._1) {
				case 'Num':
					return A2(_elm_lang$core$Basics_ops['++'], ' ', 'Bad_NUM');
				case 'Bool':
					return A2(_elm_lang$core$Basics_ops['++'], ' ', 'Bad_BOOL');
				case 'String':
					return A2(_elm_lang$core$Basics_ops['++'], ' ', 'Bad_STRING');
				case 'Null':
					return A2(_elm_lang$core$Basics_ops['++'], ' ', 'Bad_NULL');
				default:
					return A2(_elm_lang$core$Basics_ops['++'], ' ', _p0._1);
			}
		case 'TVar':
			return A2(_elm_lang$core$Basics_ops['++'], ' ', _p0._1);
		case 'TWildcard':
			return A2(_elm_lang$core$Basics_ops['++'], ' ', '_');
		default:
			var strVar = function (_p3) {
				var _p4 = _p3;
				return A2(_elm_lang$core$Basics_ops['++'], ' ', _p4._1);
			};
			var sVars = function () {
				var _p5 = _p0._1;
				if (_p5.ctor === 'One') {
					return strVar(_p5._0);
				} else {
					return A2(
						_elm_lang$core$Basics_ops['++'],
						' ',
						_user$project$Utils$parens(
							A2(
								_elm_lang$core$Basics_ops['++'],
								_elm_lang$core$String$concat(
									A2(_elm_lang$core$List$map, strVar, _p5._1)),
								' ')));
				}
			}();
			return A2(
				_elm_lang$core$Basics_ops['++'],
				' ',
				_user$project$Utils$parens(
					A2(
						_elm_lang$core$Basics_ops['++'],
						'forall',
						A2(
							_elm_lang$core$Basics_ops['++'],
							sVars,
							A2(
								_elm_lang$core$Basics_ops['++'],
								recurse(_p0._2),
								' ')))));
	}
};
var _user$project$LangUnparser$unparseType = function (tipe) {
	var _p6 = tipe.val;
	switch (_p6.ctor) {
		case 'TNum':
			return A2(_elm_lang$core$Basics_ops['++'], _p6._0.val, 'Num');
		case 'TBool':
			return A2(_elm_lang$core$Basics_ops['++'], _p6._0.val, 'Bool');
		case 'TString':
			return A2(_elm_lang$core$Basics_ops['++'], _p6._0.val, 'String');
		case 'TNull':
			return A2(_elm_lang$core$Basics_ops['++'], _p6._0.val, 'Null');
		case 'TList':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p6._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'(List',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_user$project$LangUnparser$unparseType(_p6._1),
						A2(_elm_lang$core$Basics_ops['++'], _p6._2.val, ')'))));
		case 'TDict':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p6._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'(Dict',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_user$project$LangUnparser$unparseType(_p6._1),
						A2(
							_elm_lang$core$Basics_ops['++'],
							_user$project$LangUnparser$unparseType(_p6._2),
							A2(_elm_lang$core$Basics_ops['++'], _p6._3.val, ')')))));
		case 'TTuple':
			var _p10 = _p6._4;
			var _p9 = _p6._0;
			var _p8 = _p6._1;
			var _p7 = _p6._3;
			if (_p7.ctor === 'Just') {
				return A2(
					_elm_lang$core$Basics_ops['++'],
					_p9.val,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'[',
						A2(
							_elm_lang$core$Basics_ops['++'],
							_elm_lang$core$String$concat(
								A2(_elm_lang$core$List$map, _user$project$LangUnparser$unparseType, _p8)),
							A2(
								_elm_lang$core$Basics_ops['++'],
								_p6._2.val,
								A2(
									_elm_lang$core$Basics_ops['++'],
									'|',
									A2(
										_elm_lang$core$Basics_ops['++'],
										_user$project$LangUnparser$unparseType(_p7._0),
										A2(_elm_lang$core$Basics_ops['++'], _p10.val, ']')))))));
			} else {
				return A2(
					_elm_lang$core$Basics_ops['++'],
					_p9.val,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'[',
						A2(
							_elm_lang$core$Basics_ops['++'],
							_elm_lang$core$String$concat(
								A2(_elm_lang$core$List$map, _user$project$LangUnparser$unparseType, _p8)),
							A2(_elm_lang$core$Basics_ops['++'], _p10.val, ']'))));
			}
		case 'TArrow':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p6._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'(->',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_elm_lang$core$String$concat(
							A2(_elm_lang$core$List$map, _user$project$LangUnparser$unparseType, _p6._1)),
						A2(_elm_lang$core$Basics_ops['++'], _p6._2.val, ')'))));
		case 'TUnion':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p6._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'(union',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_elm_lang$core$String$concat(
							A2(_elm_lang$core$List$map, _user$project$LangUnparser$unparseType, _p6._1)),
						A2(_elm_lang$core$Basics_ops['++'], _p6._2.val, ')'))));
		case 'TNamed':
			switch (_p6._1) {
				case 'Num':
					return A2(_elm_lang$core$Basics_ops['++'], _p6._0.val, 'Bad_NUM');
				case 'Bool':
					return A2(_elm_lang$core$Basics_ops['++'], _p6._0.val, 'Bad_BOOL');
				case 'String':
					return A2(_elm_lang$core$Basics_ops['++'], _p6._0.val, 'Bad_STRING');
				case 'Null':
					return A2(_elm_lang$core$Basics_ops['++'], _p6._0.val, 'Bad_NULL');
				default:
					return A2(_elm_lang$core$Basics_ops['++'], _p6._0.val, _p6._1);
			}
		case 'TVar':
			return A2(_elm_lang$core$Basics_ops['++'], _p6._0.val, _p6._1);
		case 'TWildcard':
			return A2(_elm_lang$core$Basics_ops['++'], _p6._0.val, '_');
		default:
			var strVar = function (_p11) {
				var _p12 = _p11;
				return A2(_elm_lang$core$Basics_ops['++'], _p12._0.val, _p12._1);
			};
			var sVars = function () {
				var _p13 = _p6._1;
				if (_p13.ctor === 'One') {
					return strVar(_p13._0);
				} else {
					return A2(
						_elm_lang$core$Basics_ops['++'],
						_p13._0.val,
						_user$project$Utils$parens(
							A2(
								_elm_lang$core$Basics_ops['++'],
								_elm_lang$core$String$concat(
									A2(_elm_lang$core$List$map, strVar, _p13._1)),
								_p13._2.val)));
				}
			}();
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p6._0.val,
				_user$project$Utils$parens(
					A2(
						_elm_lang$core$Basics_ops['++'],
						'forall',
						A2(
							_elm_lang$core$Basics_ops['++'],
							sVars,
							A2(
								_elm_lang$core$Basics_ops['++'],
								_user$project$LangUnparser$unparseType(_p6._2),
								_p6._3.val)))));
	}
};
var _user$project$LangUnparser$unparseWD = function (wd) {
	var strHidden = function (bool) {
		return bool ? ',\"hidden\"' : '';
	};
	var _p14 = wd.val;
	switch (_p14.ctor) {
		case 'NoWidgetDecl':
			return '';
		case 'IntSlider':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				'{',
				A2(
					_elm_lang$core$Basics_ops['++'],
					_elm_lang$core$Basics$toString(_p14._0.val),
					A2(
						_elm_lang$core$Basics_ops['++'],
						_p14._1.val,
						A2(
							_elm_lang$core$Basics_ops['++'],
							_elm_lang$core$Basics$toString(_p14._2.val),
							A2(
								_elm_lang$core$Basics_ops['++'],
								strHidden(_p14._4),
								'}')))));
		default:
			return A2(
				_elm_lang$core$Basics_ops['++'],
				'{',
				A2(
					_elm_lang$core$Basics_ops['++'],
					_elm_lang$core$Basics$toString(_p14._0.val),
					A2(
						_elm_lang$core$Basics_ops['++'],
						_p14._1.val,
						A2(
							_elm_lang$core$Basics_ops['++'],
							_elm_lang$core$Basics$toString(_p14._2.val),
							A2(
								_elm_lang$core$Basics_ops['++'],
								strHidden(_p14._4),
								'}')))));
	}
};
var _user$project$LangUnparser$unparseWDWithUniformWhitespace = _user$project$LangUnparser$unparseWD;
var _user$project$LangUnparser$escapeQuotes = F2(
	function (quoteChar, string) {
		return A4(
			_elm_lang$core$Regex$replace,
			_elm_lang$core$Regex$All,
			_elm_lang$core$Regex$regex(quoteChar),
			function (_p15) {
				return A2(_elm_lang$core$Basics_ops['++'], '\\', quoteChar);
			},
			A4(
				_elm_lang$core$Regex$replace,
				_elm_lang$core$Regex$All,
				_elm_lang$core$Regex$regex(
					_elm_lang$core$Regex$escape('\\')),
				function (_p16) {
					return '\\\\';
				},
				string));
	});
var _user$project$LangUnparser$unparseBaseVal = function (bv) {
	var _p17 = bv;
	switch (_p17.ctor) {
		case 'EBool':
			if (_p17._0 === true) {
				return 'true';
			} else {
				return 'false';
			}
		case 'EString':
			var _p18 = _p17._0;
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p18,
				A2(
					_elm_lang$core$Basics_ops['++'],
					A2(_user$project$LangUnparser$escapeQuotes, _p18, _p17._1),
					_p18));
		default:
			return 'null';
	}
};
var _user$project$LangUnparser$unparseBaseValWithUniformWhitespace = _user$project$LangUnparser$unparseBaseVal;
var _user$project$LangUnparser$unparsePatWithUniformWhitespace = F2(
	function (includeWidgetDecls, pat) {
		var recurse = function (p) {
			return A2(_user$project$LangUnparser$unparsePatWithUniformWhitespace, includeWidgetDecls, p);
		};
		var _p19 = pat.val.p__;
		switch (_p19.ctor) {
			case 'PVar':
				return A2(
					_elm_lang$core$Basics_ops['++'],
					' ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_p19._1,
						includeWidgetDecls ? _user$project$LangUnparser$unparseWDWithUniformWhitespace(_p19._2) : ''));
			case 'PList':
				if (_p19._3.ctor === 'Nothing') {
					return A2(
						_elm_lang$core$Basics_ops['++'],
						' ',
						A2(
							_elm_lang$core$Basics_ops['++'],
							'[',
							A2(
								_elm_lang$core$Basics_ops['++'],
								_elm_lang$core$String$concat(
									A2(_elm_lang$core$List$map, recurse, _p19._1)),
								A2(_elm_lang$core$Basics_ops['++'], ' ', ']'))));
				} else {
					return A2(
						_elm_lang$core$Basics_ops['++'],
						' ',
						A2(
							_elm_lang$core$Basics_ops['++'],
							'[',
							A2(
								_elm_lang$core$Basics_ops['++'],
								_elm_lang$core$String$concat(
									A2(_elm_lang$core$List$map, recurse, _p19._1)),
								A2(
									_elm_lang$core$Basics_ops['++'],
									' ',
									A2(
										_elm_lang$core$Basics_ops['++'],
										'|',
										A2(
											_elm_lang$core$Basics_ops['++'],
											recurse(_p19._3._0),
											A2(_elm_lang$core$Basics_ops['++'], ' ', ']')))))));
				}
			case 'PConst':
				return A2(
					_elm_lang$core$Basics_ops['++'],
					' ',
					_user$project$Lang$strNum(_p19._1));
			case 'PBase':
				return A2(
					_elm_lang$core$Basics_ops['++'],
					' ',
					_user$project$LangUnparser$unparseBaseValWithUniformWhitespace(_p19._1));
			default:
				return A2(
					_elm_lang$core$Basics_ops['++'],
					' ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_p19._1,
						A2(
							_elm_lang$core$Basics_ops['++'],
							' ',
							A2(
								_elm_lang$core$Basics_ops['++'],
								'@',
								recurse(_p19._3)))));
		}
	});
var _user$project$LangUnparser$unparseWithUniformWhitespace = F3(
	function (includeWidgetDecls, includeConstAnnotations, exp) {
		var recurse = function (e) {
			return A3(_user$project$LangUnparser$unparseWithUniformWhitespace, includeWidgetDecls, includeConstAnnotations, e);
		};
		var recursePat = function (e) {
			return A2(_user$project$LangUnparser$unparsePatWithUniformWhitespace, includeWidgetDecls, e);
		};
		var _p20 = exp.val.e__;
		switch (_p20.ctor) {
			case 'EBase':
				return A2(
					_elm_lang$core$Basics_ops['++'],
					' ',
					_user$project$LangUnparser$unparseBaseValWithUniformWhitespace(_p20._1));
			case 'EConst':
				var _p21 = _p20._2;
				var b = _p21._1;
				return A2(
					_elm_lang$core$Basics_ops['++'],
					' ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_elm_lang$core$Basics$toString(_p20._1),
						A2(
							_elm_lang$core$Basics_ops['++'],
							includeConstAnnotations ? b : '',
							includeWidgetDecls ? _user$project$LangUnparser$unparseWDWithUniformWhitespace(_p20._3) : '')));
			case 'EVar':
				return A2(_elm_lang$core$Basics_ops['++'], ' ', _p20._1);
			case 'EFun':
				if ((_p20._1.ctor === '::') && (_p20._1._1.ctor === '[]')) {
					return A2(
						_elm_lang$core$Basics_ops['++'],
						' ',
						A2(
							_elm_lang$core$Basics_ops['++'],
							'(\\',
							A2(
								_elm_lang$core$Basics_ops['++'],
								recursePat(_p20._1._0),
								A2(
									_elm_lang$core$Basics_ops['++'],
									recurse(_p20._2),
									A2(_elm_lang$core$Basics_ops['++'], ' ', ')')))));
				} else {
					return A2(
						_elm_lang$core$Basics_ops['++'],
						' ',
						A2(
							_elm_lang$core$Basics_ops['++'],
							'(\\(',
							A2(
								_elm_lang$core$Basics_ops['++'],
								_elm_lang$core$String$concat(
									A2(_elm_lang$core$List$map, recursePat, _p20._1)),
								A2(
									_elm_lang$core$Basics_ops['++'],
									')',
									A2(
										_elm_lang$core$Basics_ops['++'],
										recurse(_p20._2),
										A2(_elm_lang$core$Basics_ops['++'], ' ', ')'))))));
				}
			case 'EApp':
				return A2(
					_elm_lang$core$Basics_ops['++'],
					' ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						'(',
						A2(
							_elm_lang$core$Basics_ops['++'],
							recurse(_p20._1),
							A2(
								_elm_lang$core$Basics_ops['++'],
								_elm_lang$core$String$concat(
									A2(_elm_lang$core$List$map, recurse, _p20._2)),
								A2(_elm_lang$core$Basics_ops['++'], ' ', ')')))));
			case 'EList':
				if (_p20._3.ctor === 'Nothing') {
					return A2(
						_elm_lang$core$Basics_ops['++'],
						' ',
						A2(
							_elm_lang$core$Basics_ops['++'],
							'[',
							A2(
								_elm_lang$core$Basics_ops['++'],
								_elm_lang$core$String$concat(
									A2(_elm_lang$core$List$map, recurse, _p20._1)),
								A2(_elm_lang$core$Basics_ops['++'], ' ', ']'))));
				} else {
					return A2(
						_elm_lang$core$Basics_ops['++'],
						' ',
						A2(
							_elm_lang$core$Basics_ops['++'],
							'[',
							A2(
								_elm_lang$core$Basics_ops['++'],
								_elm_lang$core$String$concat(
									A2(_elm_lang$core$List$map, recurse, _p20._1)),
								A2(
									_elm_lang$core$Basics_ops['++'],
									' ',
									A2(
										_elm_lang$core$Basics_ops['++'],
										'|',
										A2(
											_elm_lang$core$Basics_ops['++'],
											recurse(_p20._3._0),
											A2(_elm_lang$core$Basics_ops['++'], ' ', ']')))))));
				}
			case 'EOp':
				return A2(
					_elm_lang$core$Basics_ops['++'],
					' ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						'(',
						A2(
							_elm_lang$core$Basics_ops['++'],
							_user$project$Lang$strOp(_p20._1.val),
							A2(
								_elm_lang$core$Basics_ops['++'],
								_elm_lang$core$String$concat(
									A2(_elm_lang$core$List$map, recurse, _p20._2)),
								A2(_elm_lang$core$Basics_ops['++'], ' ', ')')))));
			case 'EIf':
				return A2(
					_elm_lang$core$Basics_ops['++'],
					' ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						'(if',
						A2(
							_elm_lang$core$Basics_ops['++'],
							recurse(_p20._1),
							A2(
								_elm_lang$core$Basics_ops['++'],
								recurse(_p20._2),
								A2(
									_elm_lang$core$Basics_ops['++'],
									recurse(_p20._3),
									A2(_elm_lang$core$Basics_ops['++'], ' ', ')'))))));
			case 'ELet':
				if (_p20._1.ctor === 'Let') {
					var tok = _p20._2 ? 'letrec' : 'let';
					return A2(
						_elm_lang$core$Basics_ops['++'],
						' ',
						A2(
							_elm_lang$core$Basics_ops['++'],
							'(',
							A2(
								_elm_lang$core$Basics_ops['++'],
								tok,
								A2(
									_elm_lang$core$Basics_ops['++'],
									recursePat(_p20._3),
									A2(
										_elm_lang$core$Basics_ops['++'],
										recurse(_p20._4),
										A2(
											_elm_lang$core$Basics_ops['++'],
											recurse(_p20._5),
											A2(_elm_lang$core$Basics_ops['++'], ' ', ')')))))));
				} else {
					var tok = _p20._2 ? 'defrec' : 'def';
					return A2(
						_elm_lang$core$Basics_ops['++'],
						' ',
						A2(
							_elm_lang$core$Basics_ops['++'],
							'(',
							A2(
								_elm_lang$core$Basics_ops['++'],
								tok,
								A2(
									_elm_lang$core$Basics_ops['++'],
									recursePat(_p20._3),
									A2(
										_elm_lang$core$Basics_ops['++'],
										recurse(_p20._4),
										A2(
											_elm_lang$core$Basics_ops['++'],
											' ',
											A2(
												_elm_lang$core$Basics_ops['++'],
												')',
												recurse(_p20._5))))))));
				}
			case 'ECase':
				var branchesStr = _elm_lang$core$String$concat(
					A2(
						_elm_lang$core$List$map,
						function (_p22) {
							var _p23 = _p22;
							return A2(
								_elm_lang$core$Basics_ops['++'],
								' ',
								A2(
									_elm_lang$core$Basics_ops['++'],
									'(',
									A2(
										_elm_lang$core$Basics_ops['++'],
										recursePat(_p23._1),
										A2(
											_elm_lang$core$Basics_ops['++'],
											recurse(_p23._2),
											A2(_elm_lang$core$Basics_ops['++'], ' ', ')')))));
						},
						A2(
							_elm_lang$core$List$map,
							function (_) {
								return _.val;
							},
							_p20._2)));
				return A2(
					_elm_lang$core$Basics_ops['++'],
					' ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						'(case',
						A2(
							_elm_lang$core$Basics_ops['++'],
							recurse(_p20._1),
							A2(
								_elm_lang$core$Basics_ops['++'],
								branchesStr,
								A2(_elm_lang$core$Basics_ops['++'], ' ', ')')))));
			case 'ETypeCase':
				var tbranchesStr = _elm_lang$core$String$concat(
					A2(
						_elm_lang$core$List$map,
						function (_p24) {
							var _p25 = _p24;
							return A2(
								_elm_lang$core$Basics_ops['++'],
								' ',
								A2(
									_elm_lang$core$Basics_ops['++'],
									'(',
									A2(
										_elm_lang$core$Basics_ops['++'],
										_user$project$LangUnparser$unparseTypeWithUniformWhitespace(_p25._1),
										A2(
											_elm_lang$core$Basics_ops['++'],
											recurse(_p25._2),
											A2(_elm_lang$core$Basics_ops['++'], ' ', ')')))));
						},
						A2(
							_elm_lang$core$List$map,
							function (_) {
								return _.val;
							},
							_p20._2)));
				return A2(
					_elm_lang$core$Basics_ops['++'],
					' ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						'(typecase',
						A2(
							_elm_lang$core$Basics_ops['++'],
							recursePat(_p20._1),
							A2(
								_elm_lang$core$Basics_ops['++'],
								tbranchesStr,
								A2(_elm_lang$core$Basics_ops['++'], ' ', ')')))));
			case 'EComment':
				return A2(
					_elm_lang$core$Basics_ops['++'],
					' ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						';',
						A2(
							_elm_lang$core$Basics_ops['++'],
							_p20._1,
							A2(
								_elm_lang$core$Basics_ops['++'],
								'\n',
								recurse(_p20._2)))));
			case 'EOption':
				return A2(
					_elm_lang$core$Basics_ops['++'],
					' ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						'# ',
						A2(
							_elm_lang$core$Basics_ops['++'],
							_p20._1.val,
							A2(
								_elm_lang$core$Basics_ops['++'],
								':',
								A2(
									_elm_lang$core$Basics_ops['++'],
									' ',
									A2(
										_elm_lang$core$Basics_ops['++'],
										_p20._3.val,
										A2(
											_elm_lang$core$Basics_ops['++'],
											'\n',
											recurse(_p20._4))))))));
			case 'ETyp':
				return A2(
					_elm_lang$core$Basics_ops['++'],
					' ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						'(typ',
						A2(
							_elm_lang$core$Basics_ops['++'],
							recursePat(_p20._1),
							A2(
								_elm_lang$core$Basics_ops['++'],
								_user$project$LangUnparser$unparseTypeWithUniformWhitespace(_p20._2),
								A2(
									_elm_lang$core$Basics_ops['++'],
									' ',
									A2(
										_elm_lang$core$Basics_ops['++'],
										')',
										recurse(_p20._3)))))));
			case 'EColonType':
				return A2(
					_elm_lang$core$Basics_ops['++'],
					' ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						'(',
						A2(
							_elm_lang$core$Basics_ops['++'],
							recurse(_p20._1),
							A2(
								_elm_lang$core$Basics_ops['++'],
								' ',
								A2(
									_elm_lang$core$Basics_ops['++'],
									':',
									A2(
										_elm_lang$core$Basics_ops['++'],
										_user$project$LangUnparser$unparseTypeWithUniformWhitespace(_p20._3),
										A2(_elm_lang$core$Basics_ops['++'], ' ', ')')))))));
			default:
				return A2(
					_elm_lang$core$Basics_ops['++'],
					' ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						'(def',
						A2(
							_elm_lang$core$Basics_ops['++'],
							recursePat(_p20._1),
							A2(
								_elm_lang$core$Basics_ops['++'],
								_user$project$LangUnparser$unparseTypeWithUniformWhitespace(_p20._2),
								A2(
									_elm_lang$core$Basics_ops['++'],
									' ',
									A2(
										_elm_lang$core$Basics_ops['++'],
										')',
										recurse(_p20._3)))))));
		}
	});
var _user$project$LangUnparser$unparsePat = function (pat) {
	var _p26 = pat.val.p__;
	switch (_p26.ctor) {
		case 'PVar':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p26._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					_p26._1,
					_user$project$LangUnparser$unparseWD(_p26._2)));
		case 'PList':
			if (_p26._3.ctor === 'Nothing') {
				return A2(
					_elm_lang$core$Basics_ops['++'],
					_p26._0.val,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'[',
						A2(
							_elm_lang$core$Basics_ops['++'],
							_elm_lang$core$String$concat(
								A2(_elm_lang$core$List$map, _user$project$LangUnparser$unparsePat, _p26._1)),
							A2(_elm_lang$core$Basics_ops['++'], _p26._4.val, ']'))));
			} else {
				return A2(
					_elm_lang$core$Basics_ops['++'],
					_p26._0.val,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'[',
						A2(
							_elm_lang$core$Basics_ops['++'],
							_elm_lang$core$String$concat(
								A2(_elm_lang$core$List$map, _user$project$LangUnparser$unparsePat, _p26._1)),
							A2(
								_elm_lang$core$Basics_ops['++'],
								_p26._2.val,
								A2(
									_elm_lang$core$Basics_ops['++'],
									'|',
									A2(
										_elm_lang$core$Basics_ops['++'],
										_user$project$LangUnparser$unparsePat(_p26._3._0),
										A2(_elm_lang$core$Basics_ops['++'], _p26._4.val, ']')))))));
			}
		case 'PConst':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p26._0.val,
				_user$project$Lang$strNum(_p26._1));
		case 'PBase':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p26._0.val,
				_user$project$LangUnparser$unparseBaseVal(_p26._1));
		default:
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p26._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					_p26._1,
					A2(
						_elm_lang$core$Basics_ops['++'],
						_p26._2.val,
						A2(
							_elm_lang$core$Basics_ops['++'],
							'@',
							_user$project$LangUnparser$unparsePat(_p26._3)))));
	}
};
var _user$project$LangUnparser$unparsePatWithIds = function (pat) {
	var pidTag = A2(
		_elm_lang$core$Basics_ops['++'],
		'',
		A2(
			_elm_lang$core$Basics_ops['++'],
			_elm_lang$core$Basics$toString(pat.val.pid),
			''));
	var _p27 = pat.val.p__;
	switch (_p27.ctor) {
		case 'PVar':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p27._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					_p27._1,
					A2(
						_elm_lang$core$Basics_ops['++'],
						_user$project$LangUnparser$unparseWD(_p27._2),
						pidTag)));
		case 'PList':
			if (_p27._3.ctor === 'Nothing') {
				return A2(
					_elm_lang$core$Basics_ops['++'],
					_p27._0.val,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'[',
						A2(
							_elm_lang$core$Basics_ops['++'],
							_elm_lang$core$String$concat(
								A2(_elm_lang$core$List$map, _user$project$LangUnparser$unparsePatWithIds, _p27._1)),
							A2(
								_elm_lang$core$Basics_ops['++'],
								_p27._4.val,
								A2(_elm_lang$core$Basics_ops['++'], ']', pidTag)))));
			} else {
				return A2(
					_elm_lang$core$Basics_ops['++'],
					_p27._0.val,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'[',
						A2(
							_elm_lang$core$Basics_ops['++'],
							_elm_lang$core$String$concat(
								A2(_elm_lang$core$List$map, _user$project$LangUnparser$unparsePatWithIds, _p27._1)),
							A2(
								_elm_lang$core$Basics_ops['++'],
								_p27._2.val,
								A2(
									_elm_lang$core$Basics_ops['++'],
									'|',
									A2(
										_elm_lang$core$Basics_ops['++'],
										_user$project$LangUnparser$unparsePatWithIds(_p27._3._0),
										A2(
											_elm_lang$core$Basics_ops['++'],
											_p27._4.val,
											A2(_elm_lang$core$Basics_ops['++'], ']', pidTag))))))));
			}
		case 'PConst':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p27._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					_user$project$Lang$strNum(_p27._1),
					pidTag));
		case 'PBase':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p27._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					_user$project$LangUnparser$unparseBaseVal(_p27._1),
					pidTag));
		default:
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p27._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					_p27._1,
					A2(
						_elm_lang$core$Basics_ops['++'],
						pidTag,
						A2(
							_elm_lang$core$Basics_ops['++'],
							_p27._2.val,
							A2(
								_elm_lang$core$Basics_ops['++'],
								'@',
								_user$project$LangUnparser$unparsePatWithIds(_p27._3))))));
	}
};
var _user$project$LangUnparser$unparse_ = function (e) {
	var _p28 = e.val.e__;
	switch (_p28.ctor) {
		case 'EBase':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p28._0.val,
				_user$project$LangUnparser$unparseBaseVal(_p28._1));
		case 'EConst':
			var _p29 = _p28._2;
			var b = _p29._1;
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p28._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					_elm_lang$core$Basics$toString(_p28._1),
					A2(
						_elm_lang$core$Basics_ops['++'],
						b,
						_user$project$LangUnparser$unparseWD(_p28._3))));
		case 'EVar':
			return A2(_elm_lang$core$Basics_ops['++'], _p28._0.val, _p28._1);
		case 'EFun':
			if ((_p28._1.ctor === '::') && (_p28._1._1.ctor === '[]')) {
				return A2(
					_elm_lang$core$Basics_ops['++'],
					_p28._0.val,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'(\\',
						A2(
							_elm_lang$core$Basics_ops['++'],
							_user$project$LangUnparser$unparsePat(_p28._1._0),
							A2(
								_elm_lang$core$Basics_ops['++'],
								_user$project$LangUnparser$unparse_(_p28._2),
								A2(_elm_lang$core$Basics_ops['++'], _p28._3.val, ')')))));
			} else {
				return A2(
					_elm_lang$core$Basics_ops['++'],
					_p28._0.val,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'(\\(',
						A2(
							_elm_lang$core$Basics_ops['++'],
							_elm_lang$core$String$concat(
								A2(_elm_lang$core$List$map, _user$project$LangUnparser$unparsePat, _p28._1)),
							A2(
								_elm_lang$core$Basics_ops['++'],
								')',
								A2(
									_elm_lang$core$Basics_ops['++'],
									_user$project$LangUnparser$unparse_(_p28._2),
									A2(_elm_lang$core$Basics_ops['++'], _p28._3.val, ')'))))));
			}
		case 'EApp':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p28._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'(',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_user$project$LangUnparser$unparse_(_p28._1),
						A2(
							_elm_lang$core$Basics_ops['++'],
							_elm_lang$core$String$concat(
								A2(_elm_lang$core$List$map, _user$project$LangUnparser$unparse_, _p28._2)),
							A2(_elm_lang$core$Basics_ops['++'], _p28._3.val, ')')))));
		case 'EList':
			if (_p28._3.ctor === 'Nothing') {
				return A2(
					_elm_lang$core$Basics_ops['++'],
					_p28._0.val,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'[',
						A2(
							_elm_lang$core$Basics_ops['++'],
							_elm_lang$core$String$concat(
								A2(_elm_lang$core$List$map, _user$project$LangUnparser$unparse_, _p28._1)),
							A2(_elm_lang$core$Basics_ops['++'], _p28._4.val, ']'))));
			} else {
				return A2(
					_elm_lang$core$Basics_ops['++'],
					_p28._0.val,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'[',
						A2(
							_elm_lang$core$Basics_ops['++'],
							_elm_lang$core$String$concat(
								A2(_elm_lang$core$List$map, _user$project$LangUnparser$unparse_, _p28._1)),
							A2(
								_elm_lang$core$Basics_ops['++'],
								_p28._2.val,
								A2(
									_elm_lang$core$Basics_ops['++'],
									'|',
									A2(
										_elm_lang$core$Basics_ops['++'],
										_user$project$LangUnparser$unparse_(_p28._3._0),
										A2(_elm_lang$core$Basics_ops['++'], _p28._4.val, ']')))))));
			}
		case 'EOp':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p28._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'(',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_user$project$Lang$strOp(_p28._1.val),
						A2(
							_elm_lang$core$Basics_ops['++'],
							_elm_lang$core$String$concat(
								A2(_elm_lang$core$List$map, _user$project$LangUnparser$unparse_, _p28._2)),
							A2(_elm_lang$core$Basics_ops['++'], _p28._3.val, ')')))));
		case 'EIf':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p28._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'(if',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_user$project$LangUnparser$unparse_(_p28._1),
						A2(
							_elm_lang$core$Basics_ops['++'],
							_user$project$LangUnparser$unparse_(_p28._2),
							A2(
								_elm_lang$core$Basics_ops['++'],
								_user$project$LangUnparser$unparse_(_p28._3),
								A2(_elm_lang$core$Basics_ops['++'], _p28._4.val, ')'))))));
		case 'ELet':
			if (_p28._1.ctor === 'Let') {
				var _p31 = _p28._3;
				var _p30 = _p31.val.p__;
				if ((_p30.ctor === 'PVar') && (_p30._1 === '_IMPLICIT_MAIN')) {
					return '';
				} else {
					var tok = _p28._2 ? 'letrec' : 'let';
					return A2(
						_elm_lang$core$Basics_ops['++'],
						_p28._0.val,
						A2(
							_elm_lang$core$Basics_ops['++'],
							'(',
							A2(
								_elm_lang$core$Basics_ops['++'],
								tok,
								A2(
									_elm_lang$core$Basics_ops['++'],
									_user$project$LangUnparser$unparsePat(_p31),
									A2(
										_elm_lang$core$Basics_ops['++'],
										_user$project$LangUnparser$unparse_(_p28._4),
										A2(
											_elm_lang$core$Basics_ops['++'],
											_user$project$LangUnparser$unparse_(_p28._5),
											A2(_elm_lang$core$Basics_ops['++'], _p28._6.val, ')')))))));
				}
			} else {
				var tok = _p28._2 ? 'defrec' : 'def';
				return A2(
					_elm_lang$core$Basics_ops['++'],
					_p28._0.val,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'(',
						A2(
							_elm_lang$core$Basics_ops['++'],
							tok,
							A2(
								_elm_lang$core$Basics_ops['++'],
								_user$project$LangUnparser$unparsePat(_p28._3),
								A2(
									_elm_lang$core$Basics_ops['++'],
									_user$project$LangUnparser$unparse_(_p28._4),
									A2(
										_elm_lang$core$Basics_ops['++'],
										_p28._6.val,
										A2(
											_elm_lang$core$Basics_ops['++'],
											')',
											_user$project$LangUnparser$unparse_(_p28._5))))))));
			}
		case 'ECase':
			var branchesStr = _elm_lang$core$String$concat(
				A2(
					_elm_lang$core$List$map,
					function (_p32) {
						var _p33 = _p32;
						return A2(
							_elm_lang$core$Basics_ops['++'],
							_p33._0.val,
							A2(
								_elm_lang$core$Basics_ops['++'],
								'(',
								A2(
									_elm_lang$core$Basics_ops['++'],
									_user$project$LangUnparser$unparsePat(_p33._1),
									A2(
										_elm_lang$core$Basics_ops['++'],
										_user$project$LangUnparser$unparse_(_p33._2),
										A2(_elm_lang$core$Basics_ops['++'], _p33._3.val, ')')))));
					},
					A2(
						_elm_lang$core$List$map,
						function (_) {
							return _.val;
						},
						_p28._2)));
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p28._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'(case',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_user$project$LangUnparser$unparse_(_p28._1),
						A2(
							_elm_lang$core$Basics_ops['++'],
							branchesStr,
							A2(_elm_lang$core$Basics_ops['++'], _p28._3.val, ')')))));
		case 'ETypeCase':
			var tbranchesStr = _elm_lang$core$String$concat(
				A2(
					_elm_lang$core$List$map,
					function (_p34) {
						var _p35 = _p34;
						return A2(
							_elm_lang$core$Basics_ops['++'],
							_p35._0.val,
							A2(
								_elm_lang$core$Basics_ops['++'],
								'(',
								A2(
									_elm_lang$core$Basics_ops['++'],
									_user$project$LangUnparser$unparseType(_p35._1),
									A2(
										_elm_lang$core$Basics_ops['++'],
										_user$project$LangUnparser$unparse_(_p35._2),
										A2(_elm_lang$core$Basics_ops['++'], _p35._3.val, ')')))));
					},
					A2(
						_elm_lang$core$List$map,
						function (_) {
							return _.val;
						},
						_p28._2)));
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p28._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'(typecase',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_user$project$LangUnparser$unparsePat(_p28._1),
						A2(
							_elm_lang$core$Basics_ops['++'],
							tbranchesStr,
							A2(_elm_lang$core$Basics_ops['++'], _p28._3.val, ')')))));
		case 'EComment':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p28._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					';',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_p28._1,
						A2(
							_elm_lang$core$Basics_ops['++'],
							'\n',
							_user$project$LangUnparser$unparse_(_p28._2)))));
		case 'EOption':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p28._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'# ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_p28._1.val,
						A2(
							_elm_lang$core$Basics_ops['++'],
							':',
							A2(
								_elm_lang$core$Basics_ops['++'],
								_p28._2.val,
								A2(
									_elm_lang$core$Basics_ops['++'],
									_p28._3.val,
									A2(
										_elm_lang$core$Basics_ops['++'],
										'\n',
										_user$project$LangUnparser$unparse_(_p28._4))))))));
		case 'ETyp':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p28._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'(typ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_user$project$LangUnparser$unparsePat(_p28._1),
						A2(
							_elm_lang$core$Basics_ops['++'],
							_user$project$LangUnparser$unparseType(_p28._2),
							A2(
								_elm_lang$core$Basics_ops['++'],
								_p28._4.val,
								A2(
									_elm_lang$core$Basics_ops['++'],
									')',
									_user$project$LangUnparser$unparse_(_p28._3)))))));
		case 'EColonType':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p28._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'(',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_user$project$LangUnparser$unparse_(_p28._1),
						A2(
							_elm_lang$core$Basics_ops['++'],
							_p28._2.val,
							A2(
								_elm_lang$core$Basics_ops['++'],
								':',
								A2(
									_elm_lang$core$Basics_ops['++'],
									_user$project$LangUnparser$unparseType(_p28._3),
									A2(_elm_lang$core$Basics_ops['++'], _p28._4.val, ')')))))));
		default:
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p28._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'(def',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_user$project$LangUnparser$unparsePat(_p28._1),
						A2(
							_elm_lang$core$Basics_ops['++'],
							_user$project$LangUnparser$unparseType(_p28._2),
							A2(
								_elm_lang$core$Basics_ops['++'],
								_p28._4.val,
								A2(
									_elm_lang$core$Basics_ops['++'],
									')',
									_user$project$LangUnparser$unparse_(_p28._3)))))));
	}
};
var _user$project$LangUnparser$unparse = function (e) {
	return _user$project$LangUnparser$unparse_(e);
};
var _user$project$LangUnparser$unparseWithIds = function (e) {
	var eidTag = A2(
		_elm_lang$core$Basics_ops['++'],
		'<',
		A2(
			_elm_lang$core$Basics_ops['++'],
			_elm_lang$core$Basics$toString(e.val.eid),
			'>'));
	var _p36 = e.val.e__;
	switch (_p36.ctor) {
		case 'EBase':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p36._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					_user$project$LangUnparser$unparseBaseVal(_p36._1),
					eidTag));
		case 'EConst':
			var _p37 = _p36._2;
			var locId = _p37._0;
			var b = _p37._1;
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p36._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					_elm_lang$core$Basics$toString(_p36._1),
					A2(
						_elm_lang$core$Basics_ops['++'],
						b,
						A2(
							_elm_lang$core$Basics_ops['++'],
							_user$project$LangUnparser$unparseWD(_p36._3),
							A2(
								_elm_lang$core$Basics_ops['++'],
								'{',
								A2(
									_elm_lang$core$Basics_ops['++'],
									_elm_lang$core$Basics$toString(locId),
									A2(_elm_lang$core$Basics_ops['++'], '}', eidTag)))))));
		case 'EVar':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p36._0.val,
				A2(_elm_lang$core$Basics_ops['++'], _p36._1, eidTag));
		case 'EFun':
			if ((_p36._1.ctor === '::') && (_p36._1._1.ctor === '[]')) {
				return A2(
					_elm_lang$core$Basics_ops['++'],
					_p36._0.val,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'(',
						A2(
							_elm_lang$core$Basics_ops['++'],
							eidTag,
							A2(
								_elm_lang$core$Basics_ops['++'],
								'\\',
								A2(
									_elm_lang$core$Basics_ops['++'],
									_user$project$LangUnparser$unparsePatWithIds(_p36._1._0),
									A2(
										_elm_lang$core$Basics_ops['++'],
										_user$project$LangUnparser$unparseWithIds(_p36._2),
										A2(_elm_lang$core$Basics_ops['++'], _p36._3.val, ')')))))));
			} else {
				return A2(
					_elm_lang$core$Basics_ops['++'],
					_p36._0.val,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'(',
						A2(
							_elm_lang$core$Basics_ops['++'],
							eidTag,
							A2(
								_elm_lang$core$Basics_ops['++'],
								'\\(',
								A2(
									_elm_lang$core$Basics_ops['++'],
									_elm_lang$core$String$concat(
										A2(_elm_lang$core$List$map, _user$project$LangUnparser$unparsePatWithIds, _p36._1)),
									A2(
										_elm_lang$core$Basics_ops['++'],
										')',
										A2(
											_elm_lang$core$Basics_ops['++'],
											_user$project$LangUnparser$unparseWithIds(_p36._2),
											A2(_elm_lang$core$Basics_ops['++'], _p36._3.val, ')'))))))));
			}
		case 'EApp':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p36._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'(',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_user$project$LangUnparser$unparseWithIds(_p36._1),
						A2(
							_elm_lang$core$Basics_ops['++'],
							_elm_lang$core$String$concat(
								A2(_elm_lang$core$List$map, _user$project$LangUnparser$unparseWithIds, _p36._2)),
							A2(
								_elm_lang$core$Basics_ops['++'],
								_p36._3.val,
								A2(_elm_lang$core$Basics_ops['++'], ')', eidTag))))));
		case 'EList':
			if (_p36._3.ctor === 'Nothing') {
				return A2(
					_elm_lang$core$Basics_ops['++'],
					_p36._0.val,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'[',
						A2(
							_elm_lang$core$Basics_ops['++'],
							_elm_lang$core$String$concat(
								A2(_elm_lang$core$List$map, _user$project$LangUnparser$unparseWithIds, _p36._1)),
							A2(
								_elm_lang$core$Basics_ops['++'],
								_p36._4.val,
								A2(_elm_lang$core$Basics_ops['++'], ']', eidTag)))));
			} else {
				return A2(
					_elm_lang$core$Basics_ops['++'],
					_p36._0.val,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'[',
						A2(
							_elm_lang$core$Basics_ops['++'],
							_elm_lang$core$String$concat(
								A2(_elm_lang$core$List$map, _user$project$LangUnparser$unparseWithIds, _p36._1)),
							A2(
								_elm_lang$core$Basics_ops['++'],
								_p36._2.val,
								A2(
									_elm_lang$core$Basics_ops['++'],
									'|',
									A2(
										_elm_lang$core$Basics_ops['++'],
										_user$project$LangUnparser$unparseWithIds(_p36._3._0),
										A2(
											_elm_lang$core$Basics_ops['++'],
											_p36._4.val,
											A2(_elm_lang$core$Basics_ops['++'], ']', eidTag))))))));
			}
		case 'EOp':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p36._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'(',
					A2(
						_elm_lang$core$Basics_ops['++'],
						eidTag,
						A2(
							_elm_lang$core$Basics_ops['++'],
							_user$project$Lang$strOp(_p36._1.val),
							A2(
								_elm_lang$core$Basics_ops['++'],
								_elm_lang$core$String$concat(
									A2(_elm_lang$core$List$map, _user$project$LangUnparser$unparseWithIds, _p36._2)),
								A2(_elm_lang$core$Basics_ops['++'], _p36._3.val, ')'))))));
		case 'EIf':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p36._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'(',
					A2(
						_elm_lang$core$Basics_ops['++'],
						eidTag,
						A2(
							_elm_lang$core$Basics_ops['++'],
							'if',
							A2(
								_elm_lang$core$Basics_ops['++'],
								_user$project$LangUnparser$unparseWithIds(_p36._1),
								A2(
									_elm_lang$core$Basics_ops['++'],
									_user$project$LangUnparser$unparseWithIds(_p36._2),
									A2(
										_elm_lang$core$Basics_ops['++'],
										_user$project$LangUnparser$unparseWithIds(_p36._3),
										A2(_elm_lang$core$Basics_ops['++'], _p36._4.val, ')'))))))));
		case 'ELet':
			if (_p36._1.ctor === 'Let') {
				var tok = _p36._2 ? 'letrec' : 'let';
				return A2(
					_elm_lang$core$Basics_ops['++'],
					_p36._0.val,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'(',
						A2(
							_elm_lang$core$Basics_ops['++'],
							eidTag,
							A2(
								_elm_lang$core$Basics_ops['++'],
								tok,
								A2(
									_elm_lang$core$Basics_ops['++'],
									_user$project$LangUnparser$unparsePatWithIds(_p36._3),
									A2(
										_elm_lang$core$Basics_ops['++'],
										_user$project$LangUnparser$unparseWithIds(_p36._4),
										A2(
											_elm_lang$core$Basics_ops['++'],
											_user$project$LangUnparser$unparseWithIds(_p36._5),
											A2(_elm_lang$core$Basics_ops['++'], _p36._6.val, ')'))))))));
			} else {
				var tok = _p36._2 ? 'defrec' : 'def';
				return A2(
					_elm_lang$core$Basics_ops['++'],
					_p36._0.val,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'(',
						A2(
							_elm_lang$core$Basics_ops['++'],
							eidTag,
							A2(
								_elm_lang$core$Basics_ops['++'],
								tok,
								A2(
									_elm_lang$core$Basics_ops['++'],
									_user$project$LangUnparser$unparsePatWithIds(_p36._3),
									A2(
										_elm_lang$core$Basics_ops['++'],
										_user$project$LangUnparser$unparseWithIds(_p36._4),
										A2(
											_elm_lang$core$Basics_ops['++'],
											_p36._6.val,
											A2(
												_elm_lang$core$Basics_ops['++'],
												')',
												_user$project$LangUnparser$unparseWithIds(_p36._5)))))))));
			}
		case 'ECase':
			var branchesStr = _elm_lang$core$String$concat(
				A2(
					_elm_lang$core$List$map,
					function (_p38) {
						var _p39 = _p38;
						return A2(
							_elm_lang$core$Basics_ops['++'],
							_p39._0.val,
							A2(
								_elm_lang$core$Basics_ops['++'],
								'(',
								A2(
									_elm_lang$core$Basics_ops['++'],
									_user$project$LangUnparser$unparsePatWithIds(_p39._1),
									A2(
										_elm_lang$core$Basics_ops['++'],
										_user$project$LangUnparser$unparseWithIds(_p39._2),
										A2(_elm_lang$core$Basics_ops['++'], _p39._3.val, ')')))));
					},
					A2(
						_elm_lang$core$List$map,
						function (_) {
							return _.val;
						},
						_p36._2)));
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p36._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'(',
					A2(
						_elm_lang$core$Basics_ops['++'],
						eidTag,
						A2(
							_elm_lang$core$Basics_ops['++'],
							'case',
							A2(
								_elm_lang$core$Basics_ops['++'],
								_user$project$LangUnparser$unparseWithIds(_p36._1),
								A2(
									_elm_lang$core$Basics_ops['++'],
									branchesStr,
									A2(_elm_lang$core$Basics_ops['++'], _p36._3.val, ')')))))));
		case 'ETypeCase':
			var tbranchesStr = _elm_lang$core$String$concat(
				A2(
					_elm_lang$core$List$map,
					function (_p40) {
						var _p41 = _p40;
						return A2(
							_elm_lang$core$Basics_ops['++'],
							_p41._0.val,
							A2(
								_elm_lang$core$Basics_ops['++'],
								'(',
								A2(
									_elm_lang$core$Basics_ops['++'],
									_user$project$LangUnparser$unparseType(_p41._1),
									A2(
										_elm_lang$core$Basics_ops['++'],
										_user$project$LangUnparser$unparseWithIds(_p41._2),
										A2(_elm_lang$core$Basics_ops['++'], _p41._3.val, ')')))));
					},
					A2(
						_elm_lang$core$List$map,
						function (_) {
							return _.val;
						},
						_p36._2)));
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p36._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'(',
					A2(
						_elm_lang$core$Basics_ops['++'],
						eidTag,
						A2(
							_elm_lang$core$Basics_ops['++'],
							'typecase',
							A2(
								_elm_lang$core$Basics_ops['++'],
								_user$project$LangUnparser$unparsePatWithIds(_p36._1),
								A2(
									_elm_lang$core$Basics_ops['++'],
									tbranchesStr,
									A2(_elm_lang$core$Basics_ops['++'], _p36._3.val, ')')))))));
		case 'EComment':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p36._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					';',
					A2(
						_elm_lang$core$Basics_ops['++'],
						eidTag,
						A2(
							_elm_lang$core$Basics_ops['++'],
							_p36._1,
							A2(
								_elm_lang$core$Basics_ops['++'],
								'\n',
								_user$project$LangUnparser$unparseWithIds(_p36._2))))));
		case 'EOption':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p36._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'#',
					A2(
						_elm_lang$core$Basics_ops['++'],
						eidTag,
						A2(
							_elm_lang$core$Basics_ops['++'],
							' ',
							A2(
								_elm_lang$core$Basics_ops['++'],
								_p36._1.val,
								A2(
									_elm_lang$core$Basics_ops['++'],
									':',
									A2(
										_elm_lang$core$Basics_ops['++'],
										_p36._2.val,
										A2(
											_elm_lang$core$Basics_ops['++'],
											_p36._3.val,
											A2(
												_elm_lang$core$Basics_ops['++'],
												'\n',
												_user$project$LangUnparser$unparseWithIds(_p36._4))))))))));
		case 'ETyp':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p36._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'(',
					A2(
						_elm_lang$core$Basics_ops['++'],
						eidTag,
						A2(
							_elm_lang$core$Basics_ops['++'],
							'typ',
							A2(
								_elm_lang$core$Basics_ops['++'],
								_user$project$LangUnparser$unparsePatWithIds(_p36._1),
								A2(
									_elm_lang$core$Basics_ops['++'],
									_user$project$LangUnparser$unparseType(_p36._2),
									A2(
										_elm_lang$core$Basics_ops['++'],
										_p36._4.val,
										A2(
											_elm_lang$core$Basics_ops['++'],
											')',
											_user$project$LangUnparser$unparseWithIds(_p36._3)))))))));
		case 'EColonType':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p36._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'(',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_user$project$LangUnparser$unparseWithIds(_p36._1),
						A2(
							_elm_lang$core$Basics_ops['++'],
							_p36._2.val,
							A2(
								_elm_lang$core$Basics_ops['++'],
								':',
								A2(
									_elm_lang$core$Basics_ops['++'],
									eidTag,
									A2(
										_elm_lang$core$Basics_ops['++'],
										_user$project$LangUnparser$unparseType(_p36._3),
										A2(_elm_lang$core$Basics_ops['++'], _p36._4.val, ')'))))))));
		default:
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_p36._0.val,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'(',
					A2(
						_elm_lang$core$Basics_ops['++'],
						eidTag,
						A2(
							_elm_lang$core$Basics_ops['++'],
							'def',
							A2(
								_elm_lang$core$Basics_ops['++'],
								_user$project$LangUnparser$unparsePatWithIds(_p36._1),
								A2(
									_elm_lang$core$Basics_ops['++'],
									_user$project$LangUnparser$unparseType(_p36._2),
									A2(
										_elm_lang$core$Basics_ops['++'],
										_p36._4.val,
										A2(
											_elm_lang$core$Basics_ops['++'],
											')',
											_user$project$LangUnparser$unparseWithIds(_p36._3)))))))));
	}
};
var _user$project$LangUnparser$bumpCol = F2(
	function (n, pos) {
		return _elm_lang$core$Native_Utils.update(
			pos,
			{col: n + pos.col});
	});
var _user$project$LangUnparser$incCol = _user$project$LangUnparser$bumpCol(1);
var _user$project$LangUnparser$debugLog = _user$project$Config$debugLog(_user$project$Config$debugParser);

var _user$project$Types$dummyAceTypeInfo = {
	annotations: {ctor: '[]'},
	highlights: {ctor: '[]'},
	tooltips: {ctor: '[]'}
};
var _user$project$Types$aceTypeInfo = function (typeInfo) {
	var errorAnnots = A2(
		_elm_lang$core$List$map,
		function (i) {
			return {row: i, text: 'Type Error...', type_: 'error'};
		},
		_elm_lang$core$Set$toList(
			A3(
				_elm_lang$core$List$foldr,
				F2(
					function (typeError, acc) {
						return A2(_elm_lang$core$Set$insert, typeError.pos.line - 1, acc);
					}),
				_elm_lang$core$Set$empty,
				typeInfo.typeErrors)));
	var _p0 = A3(
		_elm_lang$core$List$foldr,
		F2(
			function (typeError, _p1) {
				var _p2 = _p1;
				var _p3 = {ctor: '_Tuple2', _0: typeError.pos.line - 1, _1: typeError.pos.col - 1};
				var i = _p3._0;
				var j = _p3._1;
				var tip = {row: i, col: j, text: typeError.val};
				var marker = {
					color: 'orange',
					range: {
						start: {row: i + 1, column: j + 1},
						end: {row: i + 1, column: j + 2}
					}
				};
				return {
					ctor: '_Tuple2',
					_0: {ctor: '::', _0: tip, _1: _p2._0},
					_1: {ctor: '::', _0: marker, _1: _p2._1}
				};
			}),
		{
			ctor: '_Tuple2',
			_0: {ctor: '[]'},
			_1: {ctor: '[]'}
		},
		typeInfo.typeErrors);
	var errorTips = _p0._0;
	var errorHighlights = _p0._1;
	var varTypeTips = A3(
		_elm_lang$core$List$foldr,
		F2(
			function (_p4, acc) {
				var _p5 = _p4;
				var _p8 = _p5._0;
				var _p7 = _p5._1;
				var s1 = _elm_lang$core$String$trim(
					_user$project$LangUnparser$unparsePat(_p8));
				var _p6 = {
					ctor: '_Tuple2',
					_0: A2(_elm_lang$core$Dict$get, _p7, typeInfo.finalTypes),
					_1: A2(_elm_lang$core$Dict$get, _p7, typeInfo.rawTypes)
				};
				_v2_2:
				do {
					if (_p6.ctor === '_Tuple2') {
						if ((_p6._0.ctor === 'Just') && (_p6._0._0.ctor === 'Just')) {
							var text = A2(
								_elm_lang$core$Basics_ops['++'],
								s1,
								A2(
									_elm_lang$core$Basics_ops['++'],
									' : ',
									A2(
										_elm_lang$core$Basics_ops['++'],
										_elm_lang$core$String$trim(
											_user$project$LangUnparser$unparseType(_p6._0._0._0)),
										' ')));
							return {
								ctor: '::',
								_0: {row: _p8.start.line - 1, col: _p8.start.col - 1, text: text},
								_1: acc
							};
						} else {
							if (((_p6._1.ctor === 'Just') && (_p6._1._0.ctor === '_Tuple2')) && (_p6._1._0._1.ctor === 'Just')) {
								var text = A2(
									_elm_lang$core$Basics_ops['++'],
									s1,
									A2(
										_elm_lang$core$Basics_ops['++'],
										' : ',
										A2(
											_elm_lang$core$Basics_ops['++'],
											_elm_lang$core$String$trim(
												_user$project$LangUnparser$unparseType(_p6._1._0._1._0)),
											' ')));
								return {
									ctor: '::',
									_0: {row: _p8.start.line - 1, col: _p8.start.col - 1, text: text},
									_1: acc
								};
							} else {
								break _v2_2;
							}
						}
					} else {
						break _v2_2;
					}
				} while(false);
				return acc;
			}),
		{ctor: '[]'},
		typeInfo.namedExps);
	var expTypeTips = A3(
		_elm_lang$core$Dict$foldr,
		F3(
			function (eid, _p9, acc) {
				var _p10 = _p9;
				var _p12 = _p10._0;
				var record = function (t) {
					var text = _elm_lang$core$String$trim(
						_user$project$LangUnparser$unparseType(t));
					return {row: _p12.line - 1, col: _p12.col - 1, text: text};
				};
				var _p11 = {
					ctor: '_Tuple2',
					_0: A2(_elm_lang$core$Dict$get, eid, typeInfo.finalTypes),
					_1: _p10._1
				};
				_v4_2:
				do {
					if (_p11.ctor === '_Tuple2') {
						if ((_p11._0.ctor === 'Just') && (_p11._0._0.ctor === 'Just')) {
							return {
								ctor: '::',
								_0: record(_p11._0._0._0),
								_1: acc
							};
						} else {
							if (_p11._1.ctor === 'Just') {
								return {
									ctor: '::',
									_0: record(_p11._1._0),
									_1: acc
								};
							} else {
								break _v4_2;
							}
						}
					} else {
						break _v4_2;
					}
				} while(false);
				return acc;
			}),
		{ctor: '[]'},
		typeInfo.rawTypes);
	return {
		annotations: errorAnnots,
		highlights: errorHighlights,
		tooltips: A2(
			_elm_lang$core$Basics_ops['++'],
			varTypeTips,
			A2(_elm_lang$core$Basics_ops['++'], expTypeTips, errorTips))
	};
};
var _user$project$Types$preludeTypeEnv = {ctor: '[]'};
var _user$project$Types$initTypeInfo = {
	constraints: {ctor: '[]'},
	activeConstraints: {ctor: '[]'},
	typeErrors: {ctor: '[]'},
	rawTypes: _elm_lang$core$Dict$empty,
	finalTypes: _elm_lang$core$Dict$empty,
	namedExps: {ctor: '[]'},
	constraintCount: 0,
	constraintVarCount: 0,
	preludeTypeEnv: _elm_lang$core$Maybe$Nothing
};
var _user$project$Types$applyUnifier = function (unifier) {
	return _user$project$Lang$mapType(
		function (t) {
			var _p13 = t.val;
			if (_p13.ctor === 'TVar') {
				var _p14 = A2(_user$project$Utils$maybeFind, _p13._1, unifier);
				if (_p14.ctor === 'Just') {
					return _p14._0;
				} else {
					return t;
				}
			} else {
				return t;
			}
		});
};
var _user$project$Types$applyUnifierToConstraints = function (unifier) {
	return _elm_lang$core$List$map(
		_elm_lang$core$Tuple$mapSecond(
			function (_p15) {
				var _p16 = _p15;
				return {
					ctor: '_Tuple2',
					_0: A2(_user$project$Types$applyUnifier, unifier, _p16._0),
					_1: A2(_user$project$Types$applyUnifier, unifier, _p16._1)
				};
			}));
};
var _user$project$Types$rewriteArrow = F2(
	function (unifier, _p17) {
		var _p18 = _p17;
		var argTypes_ = A2(
			_elm_lang$core$List$map,
			_user$project$Types$applyUnifier(unifier),
			_p18._0);
		var retType_ = A2(_user$project$Types$applyUnifier, unifier, _p18._1);
		return {ctor: '_Tuple2', _0: argTypes_, _1: retType_};
	});
var _user$project$Types$strUnifier = function (_p19) {
	return _user$project$Utils$bracks(
		_user$project$Utils$spaces(
			A2(
				_elm_lang$core$List$map,
				function (_p20) {
					var _p21 = _p20;
					return A2(
						_elm_lang$core$Basics_ops['++'],
						_p21._0,
						A2(
							_elm_lang$core$Basics_ops['++'],
							'=',
							_elm_lang$core$String$trim(
								_user$project$LangUnparser$unparseType(_p21._1))));
				},
				_p19)));
};
var _user$project$Types$bindSubtypeResult = F2(
	function (f, res1) {
		var _p22 = res1.result;
		if (_p22.ctor === 'Err') {
			return {
				result: _elm_lang$core$Result$Err(_p22._0),
				typeInfo: res1.typeInfo
			};
		} else {
			return f(res1.typeInfo);
		}
	});
var _user$project$Types$tryCatchAlls = F2(
	function (err, list) {
		tryCatchAlls:
		while (true) {
			var _p23 = list;
			if (_p23.ctor === '[]') {
				return err;
			} else {
				var _p24 = _p23._0(
					{ctor: '_Tuple0'});
				if (_p24.ctor === 'Nothing') {
					var _v13 = err,
						_v14 = _p23._1;
					err = _v13;
					list = _v14;
					continue tryCatchAlls;
				} else {
					return {
						result: _elm_lang$core$Result$Ok(
							{ctor: '_Tuple0'}),
						typeInfo: _p24._0
					};
				}
			}
		}
	});
var _user$project$Types$propagateResult = function (result) {
	return result;
};
var _user$project$Types$isConstraintVar = function (a) {
	var _p25 = A2(_user$project$Utils$munchString, '_x', a);
	if (_p25.ctor === 'Nothing') {
		return false;
	} else {
		return true;
	}
};
var _user$project$Types$constraintVarsOf = function (ts) {
	return A3(
		_elm_lang$core$List$foldl,
		F2(
			function (argType, acc) {
				var _p26 = argType.val;
				if (_p26.ctor === 'TVar') {
					var _p27 = _p26._1;
					return _user$project$Types$isConstraintVar(_p27) ? A2(_elm_lang$core$Set$insert, _p27, acc) : acc;
				} else {
					return acc;
				}
			}),
		_elm_lang$core$Set$empty,
		ts);
};
var _user$project$Types$constraintVarsOfArrow = function (_p28) {
	var _p29 = _p28;
	return _user$project$Types$constraintVarsOf(
		A2(
			_elm_lang$core$Basics_ops['++'],
			_p29._0,
			{
				ctor: '::',
				_0: _p29._1,
				_1: {ctor: '[]'}
			}));
};
var _user$project$Types$checkSubtypeTVar = F3(
	function (t, okConstrain, err) {
		var _p30 = t.val;
		if (_p30.ctor === 'TVar') {
			if (_user$project$Types$isConstraintVar(_p30._1)) {
				var result = okConstrain;
				return _elm_lang$core$Maybe$Just(result.typeInfo);
			} else {
				return _elm_lang$core$Maybe$Nothing;
			}
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$Types$splitTypesInArrow = function (ts) {
	var n = _elm_lang$core$List$length(ts);
	var argTypes = A2(_elm_lang$core$List$take, n - 1, ts);
	var _p31 = A2(_elm_lang$core$List$drop, n - 1, ts);
	if ((_p31.ctor === '::') && (_p31._1.ctor === '[]')) {
		return {ctor: '_Tuple2', _0: argTypes, _1: _p31._0};
	} else {
		return _elm_lang$core$Native_Utils.crashCase(
			'Types',
			{
				start: {line: 511, column: 3},
				end: {line: 513, column: 52}
			},
			_p31)('splitTypesInArrow');
	}
};
var _user$project$Types$isArrowTemplate = function (tipe) {
	var _p33 = tipe.val;
	if (_p33.ctor === 'TArrow') {
		var _p34 = _p33._1;
		return _elm_lang$core$Set$isEmpty(
			_user$project$Types$constraintVarsOf(_p34)) ? _elm_lang$core$Maybe$Nothing : _elm_lang$core$Maybe$Just(
			_user$project$Types$splitTypesInArrow(_p34));
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$Types$stripArrow = function (t) {
	var _p35 = t.val;
	if (_p35.ctor === 'TArrow') {
		return _elm_lang$core$Maybe$Just(
			_user$project$Types$splitTypesInArrow(_p35._1));
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$Types$stripPolymorphicArrow = function (t) {
	var _p36 = t.val;
	if (_p36.ctor === 'TForall') {
		if (_p36._1.ctor === 'One') {
			return A2(
				_user$project$Utils$bindMaybe,
				function (arrow) {
					return _elm_lang$core$Maybe$Just(
						{
							ctor: '_Tuple2',
							_0: {
								ctor: '::',
								_0: _elm_lang$core$Tuple$second(_p36._1._0),
								_1: {ctor: '[]'}
							},
							_1: arrow
						});
				},
				_user$project$Types$stripArrow(_p36._2));
		} else {
			return A2(
				_user$project$Utils$bindMaybe,
				function (arrow) {
					return _elm_lang$core$Maybe$Just(
						{
							ctor: '_Tuple2',
							_0: A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$second, _p36._1._1),
							_1: arrow
						});
				},
				_user$project$Types$stripArrow(_p36._2));
		}
	} else {
		return A2(
			_user$project$Utils$bindMaybe,
			function (arrow) {
				return _elm_lang$core$Maybe$Just(
					{
						ctor: '_Tuple2',
						_0: {ctor: '[]'},
						_1: arrow
					});
			},
			_user$project$Types$stripArrow(t));
	}
};
var _user$project$Types$generateConstraintVars = F2(
	function (n, typeInfo) {
		var k = typeInfo.constraintVarCount;
		var vars = A2(
			_elm_lang$core$List$map,
			function (i) {
				return A2(
					_elm_lang$core$Basics_ops['++'],
					'_x',
					_elm_lang$core$Basics$toString(i));
			},
			A2(_elm_lang$core$List$range, k + 1, k + n));
		return {
			ctor: '_Tuple2',
			_0: vars,
			_1: _elm_lang$core$Native_Utils.update(
				typeInfo,
				{constraintVarCount: k + n})
		};
	});
var _user$project$Types$addTypeErrorAt = F3(
	function (pos, typeError, typeInfo) {
		return _elm_lang$core$Native_Utils.update(
			typeInfo,
			{
				typeErrors: {
					ctor: '::',
					_0: A2(_user$project$Lang$WithPos, typeError, pos),
					_1: typeInfo.typeErrors
				}
			});
	});
var _user$project$Types$finishSynthesizeWithError = F3(
	function (pos, error, typeInfo) {
		return {
			result: _elm_lang$core$Maybe$Nothing,
			typeInfo: A3(_user$project$Types$addTypeErrorAt, pos, error, typeInfo)
		};
	});
var _user$project$Types$addFinalType = F3(
	function (eid, mt, typeInfo) {
		return _elm_lang$core$Native_Utils.update(
			typeInfo,
			{
				finalTypes: A3(_elm_lang$core$Dict$insert, eid, mt, typeInfo.finalTypes)
			});
	});
var _user$project$Types$addRawType = F4(
	function (eid, pos, mt, typeInfo) {
		return _elm_lang$core$Native_Utils.update(
			typeInfo,
			{
				rawTypes: A3(
					_elm_lang$core$Dict$insert,
					eid,
					{ctor: '_Tuple2', _0: pos, _1: mt},
					typeInfo.rawTypes)
			});
	});
var _user$project$Types$finishSynthesizeWithType = F4(
	function (eid, pos, tipe, typeInfo) {
		return {
			result: _elm_lang$core$Maybe$Just(tipe),
			typeInfo: A4(
				_user$project$Types$addRawType,
				eid,
				pos,
				_elm_lang$core$Maybe$Just(tipe),
				typeInfo)
		};
	});
var _user$project$Types$addNamedExp = F3(
	function (p, eid, typeInfo) {
		return _elm_lang$core$Native_Utils.update(
			typeInfo,
			{
				namedExps: {
					ctor: '::',
					_0: {ctor: '_Tuple2', _0: p, _1: eid},
					_1: typeInfo.namedExps
				}
			});
	});
var _user$project$Types$addRawConstraints = F2(
	function (constraints, typeInfo) {
		var k = typeInfo.constraintCount;
		var n = _elm_lang$core$List$length(constraints);
		var constraints_ = A2(
			_user$project$Utils$zip,
			A2(_elm_lang$core$List$range, k + 1, k + n),
			constraints);
		return _elm_lang$core$Native_Utils.update(
			typeInfo,
			{
				constraints: A2(_elm_lang$core$Basics_ops['++'], constraints_, typeInfo.constraints),
				activeConstraints: A2(_elm_lang$core$Basics_ops['++'], constraints_, typeInfo.activeConstraints),
				constraintCount: k + n
			});
	});
var _user$project$Types$expandTypeAlias = F2(
	function (typeEnv, x) {
		expandTypeAlias:
		while (true) {
			var check = function (pts) {
				check:
				while (true) {
					var _p37 = pts;
					if (_p37.ctor === '[]') {
						return _elm_lang$core$Maybe$Nothing;
					} else {
						var _p40 = _p37._0._1;
						var _p39 = _p37._1;
						var _p38 = {ctor: '_Tuple2', _0: _p37._0._0.val.p__, _1: _p40.val};
						_v24_2:
						do {
							if (_p38.ctor === '_Tuple2') {
								switch (_p38._0.ctor) {
									case 'PVar':
										if (_elm_lang$core$Native_Utils.eq(x, _p38._0._1)) {
											return _elm_lang$core$Maybe$Just(_p40);
										} else {
											var _v25 = _p39;
											pts = _v25;
											continue check;
										}
									case 'PList':
										if (((_p38._0._3.ctor === 'Nothing') && (_p38._1.ctor === 'TTuple')) && (_p38._1._3.ctor === 'Nothing')) {
											var _v26 = A2(
												_elm_lang$core$Basics_ops['++'],
												A2(_user$project$Utils$zip, _p38._0._1, _p38._1._1),
												_p39);
											pts = _v26;
											continue check;
										} else {
											break _v24_2;
										}
									default:
										break _v24_2;
								}
							} else {
								break _v24_2;
							}
						} while(false);
						return _elm_lang$core$Maybe$Nothing;
					}
				}
			};
			var _p41 = typeEnv;
			if (_p41.ctor === '::') {
				if (_p41._0.ctor === 'TypeAlias') {
					var _p42 = check(
						{
							ctor: '::',
							_0: {ctor: '_Tuple2', _0: _p41._0._0, _1: _p41._0._1},
							_1: {ctor: '[]'}
						});
					if (_p42.ctor === 'Just') {
						return _elm_lang$core$Maybe$Just(_p42._0);
					} else {
						var _v29 = _p41._1,
							_v30 = x;
						typeEnv = _v29;
						x = _v30;
						continue expandTypeAlias;
					}
				} else {
					var _v31 = _p41._1,
						_v32 = x;
					typeEnv = _v31;
					x = _v32;
					continue expandTypeAlias;
				}
			} else {
				return _elm_lang$core$Maybe$Nothing;
			}
		}
	});
var _user$project$Types$lookupTypeAlias = F2(
	function (typeEnv, x) {
		var _p43 = A2(_user$project$Types$expandTypeAlias, typeEnv, x);
		if (_p43.ctor === 'Just') {
			return true;
		} else {
			return false;
		}
	});
var _user$project$Types$lookupTypAnnotation_ = F2(
	function (typeEnv, x) {
		lookupTypAnnotation_:
		while (true) {
			var _p44 = typeEnv;
			if (_p44.ctor === '[]') {
				return _elm_lang$core$Maybe$Nothing;
			} else {
				switch (_p44._0.ctor) {
					case 'TypeVar':
						var _v35 = _p44._1,
							_v36 = x;
						typeEnv = _v35;
						x = _v36;
						continue lookupTypAnnotation_;
					case 'TypeAlias':
						var _v37 = _p44._1,
							_v38 = x;
						typeEnv = _v37;
						x = _v38;
						continue lookupTypAnnotation_;
					case 'CheckType':
						if (_elm_lang$core$Native_Utils.eq(x, _p44._0._0)) {
							return _elm_lang$core$Maybe$Just(_p44._0._1);
						} else {
							var _v39 = _p44._1,
								_v40 = x;
							typeEnv = _v39;
							x = _v40;
							continue lookupTypAnnotation_;
						}
					default:
						if (_elm_lang$core$Native_Utils.eq(x, _p44._0._0)) {
							return _elm_lang$core$Maybe$Nothing;
						} else {
							var _v41 = _p44._1,
								_v42 = x;
							typeEnv = _v41;
							x = _v42;
							continue lookupTypAnnotation_;
						}
				}
			}
		}
	});
var _user$project$Types$lookupTypAnnotation = F2(
	function (typeEnv, p) {
		var _p45 = p.val.p__;
		if (_p45.ctor === 'PVar') {
			return A2(_user$project$Types$lookupTypAnnotation_, typeEnv, _p45._1);
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$Types$lookupVar = F2(
	function (typeEnv, x) {
		lookupVar:
		while (true) {
			var _p46 = typeEnv;
			if (_p46.ctor === '[]') {
				return _elm_lang$core$Maybe$Nothing;
			} else {
				switch (_p46._0.ctor) {
					case 'TypeVar':
						var _v45 = _p46._1,
							_v46 = x;
						typeEnv = _v45;
						x = _v46;
						continue lookupVar;
					case 'TypeAlias':
						var _v47 = _p46._1,
							_v48 = x;
						typeEnv = _v47;
						x = _v48;
						continue lookupVar;
					case 'HasType':
						if (_elm_lang$core$Native_Utils.eq(x, _p46._0._0)) {
							return _elm_lang$core$Maybe$Just(_p46._0._1);
						} else {
							var _v49 = _p46._1,
								_v50 = x;
							typeEnv = _v49;
							x = _v50;
							continue lookupVar;
						}
					default:
						if (_elm_lang$core$Native_Utils.eq(x, _p46._0._0)) {
							return _elm_lang$core$Maybe$Nothing;
						} else {
							var _v51 = _p46._1,
								_v52 = x;
							typeEnv = _v51;
							x = _v52;
							continue lookupVar;
						}
				}
			}
		}
	});
var _user$project$Types$strRawConstraint = function (_p47) {
	var _p48 = _p47;
	return _user$project$Utils$spaces(
		{
			ctor: '::',
			_0: _elm_lang$core$String$trim(
				_user$project$LangUnparser$unparseType(_p48._0)),
			_1: {
				ctor: '::',
				_0: '=',
				_1: {
					ctor: '::',
					_0: _elm_lang$core$String$trim(
						_user$project$LangUnparser$unparseType(_p48._1)),
					_1: {ctor: '[]'}
				}
			}
		});
};
var _user$project$Types$strConstraint = function (_p49) {
	var _p50 = _p49;
	return _user$project$Utils$spaces(
		{
			ctor: '::',
			_0: _user$project$Utils$bracks(
				_elm_lang$core$Basics$toString(_p50._0)),
			_1: {
				ctor: '::',
				_0: _user$project$Types$strRawConstraint(_p50._1),
				_1: {ctor: '[]'}
			}
		});
};
var _user$project$Types$strEInfo = function (eInfo) {
	return _user$project$Utils$spaces(
		{
			ctor: '::',
			_0: _elm_lang$core$Basics$toString(eInfo.val),
			_1: {
				ctor: '::',
				_0: _user$project$Lang$strPos(eInfo.start),
				_1: {ctor: '[]'}
			}
		});
};
var _user$project$Types$eInfoOf = function (e) {
	return {val: e.val.eid, start: e.start, end: e.end};
};
var _user$project$Types$tForall = F2(
	function (vars, t) {
		var _p51 = vars;
		if (_p51.ctor === '[]') {
			return _elm_lang$core$Native_Utils.crashCase(
				'Types',
				{
					start: {line: 187, column: 3},
					end: {line: 191, column: 84}
				},
				_p51)('tForall: no vars');
		} else {
			if (_p51._1.ctor === '[]') {
				return _user$project$Lang$withDummyRange(
					A4(
						_user$project$Lang$TForall,
						_user$project$Lang$space1,
						_user$project$Lang$One(
							{ctor: '_Tuple2', _0: _user$project$Lang$space1, _1: _p51._0}),
						t,
						_user$project$Lang$space0));
			} else {
				var typeVars = {
					ctor: '::',
					_0: {ctor: '_Tuple2', _0: _user$project$Lang$space0, _1: _p51._0},
					_1: A2(
						_elm_lang$core$List$map,
						function (a) {
							return {ctor: '_Tuple2', _0: _user$project$Lang$space1, _1: a};
						},
						_p51._1)
				};
				return _user$project$Lang$withDummyRange(
					A4(
						_user$project$Lang$TForall,
						_user$project$Lang$space1,
						A3(_user$project$Lang$Many, _user$project$Lang$space1, typeVars, _user$project$Lang$space0),
						t,
						_user$project$Lang$space0));
			}
		}
	});
var _user$project$Types$tArrow = function (_p53) {
	var _p54 = _p53;
	return _user$project$Lang$withDummyRange(
		A3(
			_user$project$Lang$TArrow,
			_user$project$Lang$space1,
			A2(
				_elm_lang$core$Basics_ops['++'],
				_p54._0,
				{
					ctor: '::',
					_0: _p54._1,
					_1: {ctor: '[]'}
				}),
			_user$project$Lang$space0));
};
var _user$project$Types$tPolyArrow = F2(
	function (vars, arrowType) {
		return A2(
			_user$project$Types$tForall,
			vars,
			_user$project$Types$tArrow(arrowType));
	});
var _user$project$Types$tUnion = function (ts) {
	return _user$project$Lang$withDummyRange(
		A3(_user$project$Lang$TUnion, _user$project$Lang$space1, ts, _user$project$Lang$space0));
};
var _user$project$Types$tList = function (t) {
	return _user$project$Lang$withDummyRange(
		A3(_user$project$Lang$TList, _user$project$Lang$space1, t, _user$project$Lang$space0));
};
var _user$project$Types$joinTypes_ = F2(
	function (t1, t2) {
		var err = _elm_lang$core$Result$Err(
			_user$project$Utils$spaces(
				{
					ctor: '::',
					_0: 'joinTypes failed:',
					_1: {
						ctor: '::',
						_0: _user$project$LangUnparser$unparseType(t1),
						_1: {
							ctor: '::',
							_0: _user$project$LangUnparser$unparseType(t2),
							_1: {ctor: '[]'}
						}
					}
				}));
		var _p55 = {ctor: '_Tuple2', _0: t1.val, _1: t2.val};
		_v57_3:
		do {
			if (_p55.ctor === '_Tuple2') {
				switch (_p55._1.ctor) {
					case 'TList':
						if (((_p55._0.ctor === 'TTuple') && (_p55._0._1.ctor === '[]')) && (_p55._0._3.ctor === 'Nothing')) {
							return _elm_lang$core$Result$Ok(t2);
						} else {
							break _v57_3;
						}
					case 'TTuple':
						if (((_p55._0.ctor === 'TTuple') && (_p55._0._1.ctor === '[]')) && (_p55._0._3.ctor === 'Nothing')) {
							var _p56 = _user$project$Types$joinManyTypes(_p55._1._1);
							if (_p56.ctor === 'Err') {
								return err;
							} else {
								var _p59 = _p56._0;
								var _p57 = _p55._1._3;
								if (_p57.ctor === 'Nothing') {
									return _elm_lang$core$Result$Ok(
										_user$project$Types$tList(_p59));
								} else {
									var _p58 = A2(
										_user$project$Types$joinTypes,
										_user$project$Types$tList(_p59),
										_p57._0);
									if (_p58.ctor === 'Err') {
										return err;
									} else {
										return _elm_lang$core$Result$Ok(_p58._0);
									}
								}
							}
						} else {
							break _v57_3;
						}
					case 'TUnion':
						var _p62 = _p55._1._1;
						var someEqualType = A3(
							_elm_lang$core$List$foldl,
							F2(
								function (tipe2, acc) {
									var _p60 = acc;
									if (_p60.ctor === 'Just') {
										return _elm_lang$core$Maybe$Just(
											{ctor: '_Tuple0'});
									} else {
										return A2(_user$project$Types$checkEqualType, t1, tipe2) ? _elm_lang$core$Maybe$Just(
											{ctor: '_Tuple0'}) : _elm_lang$core$Maybe$Nothing;
									}
								}),
							_elm_lang$core$Maybe$Nothing,
							_p62);
						var _p61 = someEqualType;
						if (_p61.ctor === 'Just') {
							return _elm_lang$core$Result$Ok(t2);
						} else {
							return _elm_lang$core$Result$Ok(
								_user$project$Types$tUnion(
									{ctor: '::', _0: t1, _1: _p62}));
						}
					default:
						break _v57_3;
				}
			} else {
				break _v57_3;
			}
		} while(false);
		return _elm_lang$core$Result$Ok(
			_user$project$Types$tUnion(
				{
					ctor: '::',
					_0: t1,
					_1: {
						ctor: '::',
						_0: t2,
						_1: {ctor: '[]'}
					}
				}));
	});
var _user$project$Types$checkEqualType = F2(
	function (tipe1, tipe2) {
		var dummyTypeEnv = {ctor: '[]'};
		var result = A4(_user$project$Types$checkEquivType, _user$project$Types$initTypeInfo, dummyTypeEnv, tipe1, tipe2);
		var _p63 = result.result;
		if (_p63.ctor === 'Err') {
			return false;
		} else {
			return _elm_lang$core$Native_Utils.eq(
				result.typeInfo.constraints,
				{ctor: '[]'});
		}
	});
var _user$project$Types$checkEquivType = F4(
	function (typeInfo, typeEnv, tipe1, tipe2) {
		return A2(
			_user$project$Types$bindSubtypeResult,
			function (typeInfo_) {
				return A4(_user$project$Types$checkSubtype, typeInfo_, typeEnv, tipe2, tipe1);
			},
			A4(_user$project$Types$checkSubtype, typeInfo, typeEnv, tipe1, tipe2));
	});
var _user$project$Types$checkSubtype = F4(
	function (typeInfo, typeEnv, tipe1, tipe2) {
		checkSubtype:
		while (true) {
			var errAdd = function (msg) {
				return {
					typeInfo: typeInfo,
					result: _elm_lang$core$Result$Err(
						_user$project$Utils$spaces(
							{
								ctor: '::',
								_0: 'checkSubtype failed:',
								_1: {
									ctor: '::',
									_0: _elm_lang$core$String$trim(
										_user$project$LangUnparser$unparseType(tipe1)),
									_1: {
										ctor: '::',
										_0: ' <: ',
										_1: {
											ctor: '::',
											_0: _elm_lang$core$String$trim(
												_user$project$LangUnparser$unparseType(tipe2)),
											_1: {
												ctor: '::',
												_0: msg,
												_1: {ctor: '[]'}
											}
										}
									}
								}
							}))
				};
			};
			var err = errAdd('');
			var ok = {
				typeInfo: typeInfo,
				result: _elm_lang$core$Result$Ok(
					{ctor: '_Tuple0'})
			};
			var okConstrain = {
				result: _elm_lang$core$Result$Ok(
					{ctor: '_Tuple0'}),
				typeInfo: A2(
					_user$project$Types$addRawConstraints,
					{
						ctor: '::',
						_0: {ctor: '_Tuple2', _0: tipe1, _1: tipe2},
						_1: {ctor: '[]'}
					},
					typeInfo)
			};
			var _p64 = {ctor: '_Tuple2', _0: tipe1.val, _1: tipe2.val};
			_v64_15:
			do {
				_v64_6:
				do {
					if (_p64.ctor === '_Tuple2') {
						switch (_p64._0.ctor) {
							case 'TNum':
								switch (_p64._1.ctor) {
									case 'TNum':
										return ok;
									case 'TNamed':
										break _v64_6;
									default:
										break _v64_15;
								}
							case 'TBool':
								switch (_p64._1.ctor) {
									case 'TBool':
										return ok;
									case 'TNamed':
										break _v64_6;
									default:
										break _v64_15;
								}
							case 'TString':
								switch (_p64._1.ctor) {
									case 'TString':
										return ok;
									case 'TNamed':
										break _v64_6;
									default:
										break _v64_15;
								}
							case 'TNull':
								switch (_p64._1.ctor) {
									case 'TNull':
										return ok;
									case 'TNamed':
										break _v64_6;
									default:
										break _v64_15;
								}
							case 'TNamed':
								if (_p64._1.ctor === 'TNamed') {
									var _p68 = _p64._1._1;
									var _p67 = _p64._0._1;
									if (_elm_lang$core$Native_Utils.eq(_p67, _p68)) {
										return ok;
									} else {
										var maybeNewGoal = function () {
											var _p65 = {
												ctor: '_Tuple2',
												_0: A2(_user$project$Types$expandTypeAlias, typeEnv, _p67),
												_1: A2(_user$project$Types$expandTypeAlias, typeEnv, _p68)
											};
											if (_p65._0.ctor === 'Just') {
												if (_p65._1.ctor === 'Just') {
													return _elm_lang$core$Maybe$Just(
														{ctor: '_Tuple2', _0: _p65._0._0, _1: _p65._1._0});
												} else {
													return _elm_lang$core$Maybe$Just(
														{ctor: '_Tuple2', _0: _p65._0._0, _1: tipe2});
												}
											} else {
												if (_p65._1.ctor === 'Just') {
													return _elm_lang$core$Maybe$Just(
														{ctor: '_Tuple2', _0: tipe1, _1: _p65._1._0});
												} else {
													return _elm_lang$core$Maybe$Nothing;
												}
											}
										}();
										var _p66 = maybeNewGoal;
										if (_p66.ctor === 'Just') {
											var _v67 = typeInfo,
												_v68 = typeEnv,
												_v69 = _p66._0._0,
												_v70 = _p66._0._1;
											typeInfo = _v67;
											typeEnv = _v68;
											tipe1 = _v69;
											tipe2 = _v70;
											continue checkSubtype;
										} else {
											return err;
										}
									}
								} else {
									var _p69 = A2(_user$project$Types$expandTypeAlias, typeEnv, _p64._0._1);
									if (_p69.ctor === 'Just') {
										var _v72 = typeInfo,
											_v73 = typeEnv,
											_v74 = _p69._0,
											_v75 = tipe2;
										typeInfo = _v72;
										typeEnv = _v73;
										tipe1 = _v74;
										tipe2 = _v75;
										continue checkSubtype;
									} else {
										return err;
									}
								}
							case 'TUnion':
								switch (_p64._1.ctor) {
									case 'TNamed':
										break _v64_6;
									case 'TUnion':
										var allOk = A3(
											_elm_lang$core$List$foldl,
											function (t1) {
												return _user$project$Utils$bindMaybe(
													function (acc) {
														return A4(_user$project$Types$checkSubtypeSomeRight, acc, typeEnv, t1, _p64._1._1);
													});
											},
											_elm_lang$core$Maybe$Just(typeInfo),
											_p64._0._1);
										var _p71 = allOk;
										if (_p71.ctor === 'Nothing') {
											return err;
										} else {
											return {
												result: _elm_lang$core$Result$Ok(
													{ctor: '_Tuple0'}),
												typeInfo: _p71._0
											};
										}
									default:
										break _v64_15;
								}
							case 'TList':
								switch (_p64._1.ctor) {
									case 'TNamed':
										break _v64_6;
									case 'TList':
										var _v77 = typeInfo,
											_v78 = typeEnv,
											_v79 = _p64._0._1,
											_v80 = _p64._1._1;
										typeInfo = _v77;
										typeEnv = _v78;
										tipe1 = _v79;
										tipe2 = _v80;
										continue checkSubtype;
									default:
										break _v64_15;
								}
							case 'TDict':
								switch (_p64._1.ctor) {
									case 'TNamed':
										break _v64_6;
									case 'TDict':
										return A2(
											_user$project$Types$bindSubtypeResult,
											function (typeInfo_) {
												return A4(_user$project$Types$checkSubtype, typeInfo_, typeEnv, _p64._0._2, _p64._1._2);
											},
											A4(_user$project$Types$checkEquivType, typeInfo, typeEnv, _p64._0._1, _p64._1._1));
									default:
										break _v64_15;
								}
							case 'TTuple':
								switch (_p64._1.ctor) {
									case 'TNamed':
										break _v64_6;
									case 'TTuple':
										var _p72 = A2(_user$project$Utils$maybeZip, _p64._0._1, _p64._1._1);
										if (_p72.ctor === 'Nothing') {
											return errAdd('lengths of tuple types are not equal');
										} else {
											return A2(
												_user$project$Types$bindSubtypeResult,
												function (typeInfo_) {
													return A4(_user$project$Types$checkSubMaybeType, typeInfo_, typeEnv, _p64._0._3, _p64._1._3);
												},
												A3(_user$project$Types$checkSubtypeList, typeInfo, typeEnv, _p72._0));
										}
									case 'TList':
										if (_p64._0._3.ctor === 'Nothing') {
											var _p73 = _p64._0._1;
											var n = _elm_lang$core$List$length(_p73);
											return A3(
												_user$project$Types$checkSubtypeList,
												typeInfo,
												typeEnv,
												A2(
													_user$project$Utils$zip,
													_p73,
													A2(_elm_lang$core$List$repeat, n, _p64._1._1)));
										} else {
											var _p74 = _p64._0._3._0.val;
											if (_p74.ctor === 'TList') {
												var ts_ = A2(
													_elm_lang$core$Basics_ops['++'],
													_p64._0._1,
													{
														ctor: '::',
														_0: _p74._1,
														_1: {ctor: '[]'}
													});
												var n = _elm_lang$core$List$length(ts_);
												return A3(
													_user$project$Types$checkSubtypeList,
													typeInfo,
													typeEnv,
													A2(
														_user$project$Utils$zip,
														ts_,
														A2(_elm_lang$core$List$repeat, n, _p64._1._1)));
											} else {
												return errAdd('the rest type of the tuple is not a list type');
											}
										}
									default:
										break _v64_15;
								}
							case 'TArrow':
								switch (_p64._1.ctor) {
									case 'TNamed':
										break _v64_6;
									case 'TArrow':
										var _p75 = _user$project$Types$splitTypesInArrow(_p64._0._1);
										var args1 = _p75._0;
										var ret1 = _p75._1;
										var _p76 = _user$project$Types$splitTypesInArrow(_p64._1._1);
										var args2 = _p76._0;
										var ret2 = _p76._1;
										var _p77 = A2(_user$project$Utils$maybeZip, args2, args1);
										if (_p77.ctor === 'Nothing') {
											return err;
										} else {
											var result = A3(_user$project$Types$checkSubtypeList, typeInfo, typeEnv, _p77._0);
											var _p78 = result.result;
											if (_p78.ctor === 'Err') {
												return err;
											} else {
												var _v85 = result.typeInfo,
													_v86 = typeEnv,
													_v87 = ret1,
													_v88 = ret2;
												typeInfo = _v85;
												typeEnv = _v86;
												tipe1 = _v87;
												tipe2 = _v88;
												continue checkSubtype;
											}
										}
									default:
										break _v64_15;
								}
							case 'TVar':
								switch (_p64._1.ctor) {
									case 'TNamed':
										break _v64_6;
									case 'TVar':
										var _p80 = _p64._1._1;
										var _p79 = _p64._0._1;
										return (_user$project$Types$isConstraintVar(_p79) && _user$project$Types$isConstraintVar(_p80)) ? (_elm_lang$core$Native_Utils.eq(_p79, _p80) ? ok : okConstrain) : (_user$project$Types$isConstraintVar(_p79) ? okConstrain : (_user$project$Types$isConstraintVar(_p80) ? okConstrain : (_elm_lang$core$Native_Utils.eq(_p79, _p80) ? ok : err)));
									default:
										break _v64_15;
								}
							default:
								if (_p64._1.ctor === 'TNamed') {
									break _v64_6;
								} else {
									break _v64_15;
								}
						}
					} else {
						break _v64_15;
					}
				} while(false);
				var _p70 = A2(_user$project$Types$expandTypeAlias, typeEnv, _p64._1._1);
				if (_p70.ctor === 'Just') {
					var _v90 = typeInfo,
						_v91 = typeEnv,
						_v92 = tipe1,
						_v93 = _p70._0;
					typeInfo = _v90;
					typeEnv = _v91;
					tipe1 = _v92;
					tipe2 = _v93;
					continue checkSubtype;
				} else {
					return err;
				}
			} while(false);
			return A2(
				_user$project$Types$tryCatchAlls,
				err,
				{
					ctor: '::',
					_0: function (_p81) {
						var _p82 = _p81;
						return A3(_user$project$Types$checkSubtypeTVar, tipe1, okConstrain, err);
					},
					_1: {
						ctor: '::',
						_0: function (_p83) {
							var _p84 = _p83;
							return A3(_user$project$Types$checkSubtypeTVar, tipe2, okConstrain, err);
						},
						_1: {
							ctor: '::',
							_0: function (_p85) {
								var _p86 = _p85;
								return A4(_user$project$Types$checkSubtypeUnionRight, typeInfo, typeEnv, tipe1, tipe2);
							},
							_1: {
								ctor: '::',
								_0: function (_p87) {
									var _p88 = _p87;
									return A4(_user$project$Types$checkSubtypeUnionLeft, typeInfo, typeEnv, tipe1, tipe2);
								},
								_1: {
									ctor: '::',
									_0: function (_p89) {
										var _p90 = _p89;
										return A4(_user$project$Types$checkSubtypeFoldLeft, typeInfo, typeEnv, tipe1, tipe2);
									},
									_1: {
										ctor: '::',
										_0: function (_p91) {
											var _p92 = _p91;
											return A4(_user$project$Types$checkSubtypeSingletonUnion, typeInfo, typeEnv, tipe1, tipe2);
										},
										_1: {ctor: '[]'}
									}
								}
							}
						}
					}
				});
		}
	});
var _user$project$Types$checkSubMaybeType = F4(
	function (typeInfo, typeEnv, mt1, mt2) {
		var _p93 = {ctor: '_Tuple2', _0: mt1, _1: mt2};
		_v100_2:
		do {
			if (_p93.ctor === '_Tuple2') {
				if (_p93._0.ctor === 'Just') {
					if (_p93._1.ctor === 'Just') {
						return A4(_user$project$Types$checkSubtype, typeInfo, typeEnv, _p93._0._0, _p93._1._0);
					} else {
						break _v100_2;
					}
				} else {
					if (_p93._1.ctor === 'Nothing') {
						return {
							result: _elm_lang$core$Result$Ok(
								{ctor: '_Tuple0'}),
							typeInfo: typeInfo
						};
					} else {
						break _v100_2;
					}
				}
			} else {
				break _v100_2;
			}
		} while(false);
		return {
			result: _elm_lang$core$Result$Err('checkSubMaybeType failed...'),
			typeInfo: typeInfo
		};
	});
var _user$project$Types$checkSubtypeFoldLeft = F4(
	function (typeInfo, typeEnv, tipe1, tipe2) {
		var _p94 = _user$project$Types$coerceTupleToList(tipe1);
		if ((_p94.ctor === 'Just') && (_p94._0.ctor === 'Ok')) {
			var result = A4(_user$project$Types$checkSubtype, typeInfo, typeEnv, _p94._0._0, tipe2);
			var _p95 = result.result;
			if (_p95.ctor === 'Ok') {
				return _elm_lang$core$Maybe$Just(result.typeInfo);
			} else {
				return _elm_lang$core$Maybe$Nothing;
			}
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$Types$coerceTupleToList = function (t) {
	var _p96 = t.val;
	if (_p96.ctor === 'TTuple') {
		if (_p96._1.ctor === '[]') {
			return _elm_lang$core$Maybe$Nothing;
		} else {
			var _p97 = _user$project$Types$joinManyTypes(_p96._1);
			if (_p97.ctor === 'Err') {
				return _elm_lang$core$Maybe$Just(
					_elm_lang$core$Result$Err(_p97._0));
			} else {
				var _p100 = _p97._0;
				var _p98 = _p96._3;
				if (_p98.ctor === 'Nothing') {
					return _elm_lang$core$Maybe$Just(
						_elm_lang$core$Result$Ok(
							_user$project$Types$tList(_p100)));
				} else {
					var _p99 = A2(
						_user$project$Types$joinTypes,
						_user$project$Types$tList(_p100),
						_p98._0);
					if (_p99.ctor === 'Err') {
						return _elm_lang$core$Maybe$Just(
							_elm_lang$core$Result$Err(_p99._0));
					} else {
						return _elm_lang$core$Maybe$Just(
							_elm_lang$core$Result$Ok(_p99._0));
					}
				}
			}
		}
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$Types$joinManyTypes = function (ts) {
	var _p101 = ts;
	if (_p101.ctor === '[]') {
		return _elm_lang$core$Native_Utils.crashCase(
			'Types',
			{
				start: {line: 1524, column: 3},
				end: {line: 1531, column: 19}
			},
			_p101)('joinManyTypes: empty list');
	} else {
		return A3(
			_elm_lang$core$List$foldl,
			F2(
				function (tNext, acc) {
					var _p103 = acc;
					if (_p103.ctor === 'Err') {
						return _elm_lang$core$Result$Err(_p103._0);
					} else {
						return A2(_user$project$Types$joinTypes, tNext, _p103._0);
					}
				}),
			_elm_lang$core$Result$Ok(_p101._0),
			_p101._1);
	}
};
var _user$project$Types$joinTypes = F2(
	function (t1, t2) {
		var dummyTypeInfo = _user$project$Types$initTypeInfo;
		var dummyTypeEnv = {ctor: '[]'};
		var _p104 = A4(_user$project$Types$checkSubtype, dummyTypeInfo, dummyTypeEnv, t1, t2).result;
		if ((_p104.ctor === 'Ok') && (_p104._0.ctor === '_Tuple0')) {
			return _elm_lang$core$Result$Ok(t2);
		} else {
			var _p105 = A4(_user$project$Types$checkSubtype, dummyTypeInfo, dummyTypeEnv, t2, t1).result;
			if ((_p105.ctor === 'Ok') && (_p105._0.ctor === '_Tuple0')) {
				return _elm_lang$core$Result$Ok(t1);
			} else {
				var _p106 = A2(_user$project$Types$joinTypes_, t1, t2);
				if (_p106.ctor === 'Ok') {
					return _elm_lang$core$Result$Ok(_p106._0);
				} else {
					return A2(_user$project$Types$joinTypes_, t2, t1);
				}
			}
		}
	});
var _user$project$Types$checkSubtypeList = F3(
	function (typeInfo, typeEnv, list) {
		var _p107 = A3(
			_elm_lang$core$List$foldl,
			F2(
				function (_p109, _p108) {
					var _p110 = _p109;
					var _p111 = _p108;
					var _p114 = _p111._1;
					var _p113 = _p111._0;
					var _p112 = _p113;
					if (_p112.ctor === 'Err') {
						return {ctor: '_Tuple2', _0: _p113, _1: _p114};
					} else {
						var nextResult = A4(_user$project$Types$checkSubtype, _p114, typeEnv, _p110._0, _p110._1);
						return {ctor: '_Tuple2', _0: nextResult.result, _1: nextResult.typeInfo};
					}
				}),
			{
				ctor: '_Tuple2',
				_0: _elm_lang$core$Result$Ok(
					{ctor: '_Tuple0'}),
				_1: typeInfo
			},
			list);
		var result = _p107._0;
		var typeInfo_ = _p107._1;
		return {result: result, typeInfo: typeInfo_};
	});
var _user$project$Types$checkSubtypeSingletonUnion = F4(
	function (typeInfo, typeEnv, tipe1, tipe2) {
		var _p115 = tipe1.val;
		if (((_p115.ctor === 'TUnion') && (_p115._1.ctor === '::')) && (_p115._1._1.ctor === '[]')) {
			var result = A4(_user$project$Types$checkSubtype, typeInfo, typeEnv, _p115._1._0, tipe2);
			var _p116 = result.result;
			if (_p116.ctor === 'Ok') {
				return _elm_lang$core$Maybe$Just(result.typeInfo);
			} else {
				return _elm_lang$core$Maybe$Nothing;
			}
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$Types$checkSubtypeSomeRight = F4(
	function (typeInfo, typeEnv, t1, ts2) {
		return A3(
			_elm_lang$core$List$foldl,
			F2(
				function (t2, acc) {
					var _p117 = acc;
					if (_p117.ctor === 'Just') {
						return acc;
					} else {
						var result = A4(_user$project$Types$checkSubtype, typeInfo, typeEnv, t1, t2);
						var _p118 = result.result;
						if (_p118.ctor === 'Ok') {
							return _elm_lang$core$Maybe$Just(result.typeInfo);
						} else {
							return _elm_lang$core$Maybe$Nothing;
						}
					}
				}),
			_elm_lang$core$Maybe$Nothing,
			ts2);
	});
var _user$project$Types$checkSubtypeUnionLeft = F4(
	function (typeInfo, typeEnv, tipe1, tipe2) {
		var _p119 = {ctor: '_Tuple2', _0: tipe1.val, _1: tipe2.val};
		if ((_p119.ctor === '_Tuple2') && (_p119._0.ctor === 'TUnion')) {
			var _p121 = _p119._0._1;
			var obligations = A2(
				_user$project$Utils$zip,
				_p121,
				A2(
					_elm_lang$core$List$repeat,
					_elm_lang$core$List$length(_p121),
					tipe2));
			var result = A3(_user$project$Types$checkSubtypeList, typeInfo, typeEnv, obligations);
			var _p120 = result.result;
			if (_p120.ctor === 'Ok') {
				return _elm_lang$core$Maybe$Just(result.typeInfo);
			} else {
				return _elm_lang$core$Maybe$Nothing;
			}
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$Types$checkSubtypeUnionRight = F4(
	function (typeInfo, typeEnv, tipe1, tipe2) {
		var _p122 = {ctor: '_Tuple2', _0: tipe1.val, _1: tipe2.val};
		if ((_p122.ctor === '_Tuple2') && (_p122._1.ctor === 'TUnion')) {
			return A2(
				_user$project$Utils$bindMaybe,
				_elm_lang$core$Maybe$Just,
				A4(_user$project$Types$checkSubtypeSomeRight, typeInfo, typeEnv, tipe1, _p122._1._1));
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$Types$subtractType = F2(
	function (union1, tipe2) {
		var _p123 = tipe2.val;
		if (_p123.ctor === 'TUnion') {
			return A3(
				_elm_lang$core$List$foldl,
				_elm_lang$core$Basics$flip(_user$project$Types$subtractType),
				union1,
				_p123._1);
		} else {
			return A3(
				_elm_lang$core$List$foldl,
				F2(
					function (t1, acc) {
						return A2(_user$project$Types$checkEqualType, t1, tipe2) ? acc : {ctor: '::', _0: t1, _1: acc};
					}),
				{ctor: '[]'},
				union1);
		}
	});
var _user$project$Types$checkSubtypeSimple = F3(
	function (typeEnv, tipe1, tipe2) {
		var result = A4(_user$project$Types$checkSubtype, _user$project$Types$initTypeInfo, typeEnv, tipe1, tipe2);
		var _p124 = result.result;
		if (_p124.ctor === 'Err') {
			return false;
		} else {
			return true;
		}
	});
var _user$project$Types$unify = F5(
	function (typeEnv, vars, accActive, accUnifier, cs) {
		var _p125 = cs;
		if (_p125.ctor === '[]') {
			return _elm_lang$core$Result$Ok(
				{ctor: '_Tuple2', _0: accUnifier, _1: accActive});
		} else {
			var _p142 = _p125._1;
			var _p141 = _p125._0;
			var recurse = A2(_user$project$Types$unify, typeEnv, vars);
			var _p126 = _p141;
			var id = _p126._0;
			var t1 = _p126._1._0;
			var t2 = _p126._1._1;
			var err = _user$project$Utils$spaces(
				{
					ctor: '::',
					_0: 'Unification failure:',
					_1: {
						ctor: '::',
						_0: _elm_lang$core$String$trim(
							_user$project$LangUnparser$unparseType(t1)),
						_1: {
							ctor: '::',
							_0: _elm_lang$core$String$trim(
								_user$project$LangUnparser$unparseType(t2)),
							_1: {ctor: '[]'}
						}
					}
				});
			if (A2(_user$project$Types$checkEqualType, t1, t2)) {
				return A3(recurse, accActive, accUnifier, _p142);
			} else {
				var _p127 = {ctor: '_Tuple2', _0: t1.val, _1: t2.val};
				_v125_10:
				do {
					_v125_9:
					do {
						_v125_2:
						do {
							_v125_1:
							do {
								if (_p127.ctor === '_Tuple2') {
									switch (_p127._0.ctor) {
										case 'TVar':
											switch (_p127._1.ctor) {
												case 'TVar':
													var _p129 = _p127._1._1;
													var _p128 = _p127._0._1;
													return A2(_elm_lang$core$List$member, _p128, vars) ? A3(
														recurse,
														accActive,
														{
															ctor: '::',
															_0: {ctor: '_Tuple2', _0: _p128, _1: t2},
															_1: accUnifier
														},
														A2(
															_user$project$Types$applyUnifierToConstraints,
															{
																ctor: '::',
																_0: {ctor: '_Tuple2', _0: _p128, _1: t2},
																_1: {ctor: '[]'}
															},
															_p142)) : (A2(_elm_lang$core$List$member, _p129, vars) ? A3(
														recurse,
														accActive,
														{
															ctor: '::',
															_0: {ctor: '_Tuple2', _0: _p129, _1: t1},
															_1: accUnifier
														},
														A2(
															_user$project$Types$applyUnifierToConstraints,
															{
																ctor: '::',
																_0: {ctor: '_Tuple2', _0: _p129, _1: t1},
																_1: {ctor: '[]'}
															},
															_p142)) : A3(
														recurse,
														{ctor: '::', _0: _p141, _1: accActive},
														accUnifier,
														_p142));
												case 'TNamed':
													break _v125_1;
												default:
													break _v125_1;
											}
										case 'TArrow':
											switch (_p127._1.ctor) {
												case 'TVar':
													break _v125_2;
												case 'TArrow':
													var _p132 = A2(_user$project$Utils$maybeZip, _p127._0._1, _p127._1._1);
													if (_p132.ctor === 'Nothing') {
														return _elm_lang$core$Result$Err('unify TArrow: different arity');
													} else {
														var induced = A2(
															_elm_lang$core$List$map,
															function (raw) {
																return {ctor: '_Tuple2', _0: -1, _1: raw};
															},
															_p132._0);
														return A3(
															recurse,
															accActive,
															accUnifier,
															A2(_elm_lang$core$Basics_ops['++'], induced, _p142));
													}
												case 'TNamed':
													break _v125_9;
												default:
													break _v125_10;
											}
										case 'TTuple':
											switch (_p127._1.ctor) {
												case 'TVar':
													break _v125_2;
												case 'TTuple':
													var _p133 = A2(_user$project$Utils$maybeZip, _p127._0._1, _p127._1._1);
													if (_p133.ctor === 'Nothing') {
														return _elm_lang$core$Result$Err('unify TTuple: different arity');
													} else {
														var induced = A2(
															_elm_lang$core$List$map,
															function (raw) {
																return {ctor: '_Tuple2', _0: -1, _1: raw};
															},
															_p133._0);
														var _p134 = {ctor: '_Tuple2', _0: _p127._0._3, _1: _p127._1._3};
														_v128_2:
														do {
															if (_p134.ctor === '_Tuple2') {
																if (_p134._0.ctor === 'Nothing') {
																	if (_p134._1.ctor === 'Nothing') {
																		return A3(
																			recurse,
																			accActive,
																			accUnifier,
																			A2(_elm_lang$core$Basics_ops['++'], induced, _p142));
																	} else {
																		break _v128_2;
																	}
																} else {
																	if (_p134._1.ctor === 'Just') {
																		var induced_ = {
																			ctor: '::',
																			_0: {
																				ctor: '_Tuple2',
																				_0: -1,
																				_1: {ctor: '_Tuple2', _0: _p134._0._0, _1: _p134._1._0}
																			},
																			_1: induced
																		};
																		return A3(
																			recurse,
																			accActive,
																			accUnifier,
																			A2(_elm_lang$core$Basics_ops['++'], induced_, _p142));
																	} else {
																		break _v128_2;
																	}
																}
															} else {
																break _v128_2;
															}
														} while(false);
														return _elm_lang$core$Result$Err('unify TTuple: rest types don\'t match');
													}
												case 'TNamed':
													break _v125_9;
												default:
													break _v125_10;
											}
										case 'TList':
											switch (_p127._1.ctor) {
												case 'TVar':
													break _v125_2;
												case 'TList':
													var induced = {
														ctor: '::',
														_0: {
															ctor: '_Tuple2',
															_0: -1,
															_1: {ctor: '_Tuple2', _0: _p127._0._1, _1: _p127._1._1}
														},
														_1: {ctor: '[]'}
													};
													return A3(
														recurse,
														accActive,
														accUnifier,
														A2(_elm_lang$core$Basics_ops['++'], induced, _p142));
												case 'TTuple':
													var _p136 = _p127._0._1;
													var induced = A2(
														_elm_lang$core$List$map,
														function (ti) {
															return {
																ctor: '_Tuple2',
																_0: -1,
																_1: {ctor: '_Tuple2', _0: _p136, _1: ti}
															};
														},
														_p127._1._1);
													var induced_ = function () {
														var _p135 = _p127._1._3;
														if (_p135.ctor === 'Nothing') {
															return induced;
														} else {
															return {
																ctor: '::',
																_0: {
																	ctor: '_Tuple2',
																	_0: -1,
																	_1: {
																		ctor: '_Tuple2',
																		_0: _user$project$Types$tList(_p136),
																		_1: _p135._0
																	}
																},
																_1: induced
															};
														}
													}();
													return A3(
														recurse,
														accActive,
														accUnifier,
														A2(_elm_lang$core$Basics_ops['++'], induced_, _p142));
												case 'TNamed':
													break _v125_9;
												default:
													break _v125_10;
											}
										case 'TNamed':
											switch (_p127._1.ctor) {
												case 'TVar':
													break _v125_2;
												case 'TNamed':
													var maybeNewGoal = function () {
														var _p137 = {
															ctor: '_Tuple2',
															_0: A2(_user$project$Types$expandTypeAlias, typeEnv, _p127._0._1),
															_1: A2(_user$project$Types$expandTypeAlias, typeEnv, _p127._1._1)
														};
														if (_p137._0.ctor === 'Just') {
															if (_p137._1.ctor === 'Just') {
																return _elm_lang$core$Maybe$Just(
																	{ctor: '_Tuple2', _0: _p137._0._0, _1: _p137._1._0});
															} else {
																return _elm_lang$core$Maybe$Just(
																	{ctor: '_Tuple2', _0: _p137._0._0, _1: t2});
															}
														} else {
															if (_p137._1.ctor === 'Just') {
																return _elm_lang$core$Maybe$Just(
																	{ctor: '_Tuple2', _0: t1, _1: _p137._1._0});
															} else {
																return _elm_lang$core$Maybe$Nothing;
															}
														}
													}();
													var _p138 = maybeNewGoal;
													if (_p138.ctor === 'Just') {
														var induced = {
															ctor: '::',
															_0: {
																ctor: '_Tuple2',
																_0: -1,
																_1: {ctor: '_Tuple2', _0: _p138._0._0, _1: _p138._0._1}
															},
															_1: {ctor: '[]'}
														};
														return A3(
															recurse,
															accActive,
															accUnifier,
															A2(_elm_lang$core$Basics_ops['++'], induced, _p142));
													} else {
														return _elm_lang$core$Result$Err(err);
													}
												default:
													var _p139 = A2(_user$project$Types$expandTypeAlias, typeEnv, _p127._0._1);
													if (_p139.ctor === 'Just') {
														var induced = {
															ctor: '::',
															_0: {
																ctor: '_Tuple2',
																_0: -1,
																_1: {ctor: '_Tuple2', _0: _p139._0, _1: t2}
															},
															_1: {ctor: '[]'}
														};
														return A3(
															recurse,
															accActive,
															accUnifier,
															A2(_elm_lang$core$Basics_ops['++'], induced, _p142));
													} else {
														return _elm_lang$core$Result$Err(err);
													}
											}
										default:
											switch (_p127._1.ctor) {
												case 'TVar':
													break _v125_2;
												case 'TNamed':
													break _v125_9;
												default:
													break _v125_10;
											}
									}
								} else {
									break _v125_10;
								}
							} while(false);
							var _p130 = _p127._0._1;
							return A2(_elm_lang$core$List$member, _p130, vars) ? A3(
								recurse,
								accActive,
								{
									ctor: '::',
									_0: {ctor: '_Tuple2', _0: _p130, _1: t2},
									_1: accUnifier
								},
								A2(
									_user$project$Types$applyUnifierToConstraints,
									{
										ctor: '::',
										_0: {ctor: '_Tuple2', _0: _p130, _1: t2},
										_1: {ctor: '[]'}
									},
									_p142)) : A3(
								recurse,
								{ctor: '::', _0: _p141, _1: accActive},
								accUnifier,
								_p142);
						} while(false);
						var _p131 = _p127._1._1;
						return A2(_elm_lang$core$List$member, _p131, vars) ? A3(
							recurse,
							accActive,
							{
								ctor: '::',
								_0: {ctor: '_Tuple2', _0: _p131, _1: t1},
								_1: accUnifier
							},
							A2(
								_user$project$Types$applyUnifierToConstraints,
								{
									ctor: '::',
									_0: {ctor: '_Tuple2', _0: _p131, _1: t1},
									_1: {ctor: '[]'}
								},
								_p142)) : A3(
							recurse,
							{ctor: '::', _0: _p141, _1: accActive},
							accUnifier,
							_p142);
					} while(false);
					var _p140 = A2(_user$project$Types$expandTypeAlias, typeEnv, _p127._1._1);
					if (_p140.ctor === 'Just') {
						var induced = {
							ctor: '::',
							_0: {
								ctor: '_Tuple2',
								_0: -1,
								_1: {ctor: '_Tuple2', _0: t1, _1: _p140._0}
							},
							_1: {ctor: '[]'}
						};
						return A3(
							recurse,
							accActive,
							accUnifier,
							A2(_elm_lang$core$Basics_ops['++'], induced, _p142));
					} else {
						return _elm_lang$core$Result$Err(err);
					}
				} while(false);
				return A3(_user$project$Types$checkSubtypeSimple, typeEnv, t1, t2) ? A3(recurse, accActive, accUnifier, _p142) : (A3(_user$project$Types$checkSubtypeSimple, typeEnv, t2, t1) ? A3(recurse, accActive, accUnifier, _p142) : _elm_lang$core$Result$Err(err));
			}
		}
	});
var _user$project$Types$tTupleRest = F2(
	function (ts, tRest) {
		return _user$project$Lang$withDummyRange(
			A5(_user$project$Lang$TTuple, _user$project$Lang$space1, ts, _user$project$Lang$space0, tRest, _user$project$Lang$space0));
	});
var _user$project$Types$tTuple = function (ts) {
	return A2(_user$project$Types$tTupleRest, ts, _elm_lang$core$Maybe$Nothing);
};
var _user$project$Types$tVar = function (x) {
	return _user$project$Lang$withDummyRange(
		A2(_user$project$Lang$TVar, _user$project$Lang$space1, x));
};
var _user$project$Types$newArrowTemplate = F2(
	function (typeInfo, n) {
		var _p143 = A2(_user$project$Types$generateConstraintVars, 1 + n, typeInfo);
		var constraintVars = _p143._0;
		var typeInfo_ = _p143._1;
		var arrow = _user$project$Types$splitTypesInArrow(
			A2(_elm_lang$core$List$map, _user$project$Types$tVar, constraintVars));
		return {ctor: '_Tuple2', _0: arrow, _1: typeInfo_};
	});
var _user$project$Types$instantiatePolyArrowWithConstraintVars = F2(
	function (typeInfo, _p144) {
		var _p145 = _p144;
		var _p147 = _p145._0;
		var _p146 = A2(
			_user$project$Types$generateConstraintVars,
			_elm_lang$core$List$length(_p147),
			typeInfo);
		var constraintVars = _p146._0;
		var typeInfo_ = _p146._1;
		var subst = A3(
			_elm_lang$core$List$map2,
			F2(
				function (x, y) {
					return {
						ctor: '_Tuple2',
						_0: x,
						_1: _user$project$Types$tVar(y)
					};
				}),
			_p147,
			constraintVars);
		var argTypes_ = A2(
			_elm_lang$core$List$map,
			_user$project$Types$applyUnifier(subst),
			_p145._1._0);
		var retType_ = A2(_user$project$Types$applyUnifier, subst, _p145._1._1);
		return {
			result: {
				ctor: '_Tuple2',
				_0: constraintVars,
				_1: {ctor: '_Tuple2', _0: argTypes_, _1: retType_}
			},
			typeInfo: typeInfo_
		};
	});
var _user$project$Types$instantiateTypeWithConstraintVars = F2(
	function (typeInfo, t) {
		var _p148 = _user$project$Types$stripPolymorphicArrow(t);
		if (_p148.ctor === 'Nothing') {
			return {
				result: {
					ctor: '_Tuple2',
					_0: {ctor: '[]'},
					_1: t
				},
				typeInfo: typeInfo
			};
		} else {
			var result = A2(_user$project$Types$instantiatePolyArrowWithConstraintVars, typeInfo, _p148._0);
			var _p149 = result.result;
			var constraintVars = _p149._0;
			var arrow = _p149._1;
			return {
				result: {
					ctor: '_Tuple2',
					_0: constraintVars,
					_1: _user$project$Types$tArrow(arrow)
				},
				typeInfo: result.typeInfo
			};
		}
	});
var _user$project$Types$instantiateTypesWithConstraintVars = F2(
	function (typeInfo, ts) {
		var _p150 = A3(
			_elm_lang$core$List$foldl,
			F2(
				function (t, _p151) {
					var _p152 = _p151;
					var result = A2(_user$project$Types$instantiateTypeWithConstraintVars, _p152._2, t);
					var _p153 = result.result;
					var newVars = _p153._0;
					var t_ = _p153._1;
					return {
						ctor: '_Tuple3',
						_0: A2(_elm_lang$core$Basics_ops['++'], _p152._0, newVars),
						_1: A2(
							_elm_lang$core$Basics_ops['++'],
							_p152._1,
							{
								ctor: '::',
								_0: t_,
								_1: {ctor: '[]'}
							}),
						_2: result.typeInfo
					};
				}),
			{
				ctor: '_Tuple3',
				_0: {ctor: '[]'},
				_1: {ctor: '[]'},
				_2: typeInfo
			},
			ts);
		var newVars = _p150._0;
		var newTypes = _p150._1;
		var newTypeInfo = _p150._2;
		return {
			result: {ctor: '_Tuple2', _0: newVars, _1: newTypes},
			typeInfo: newTypeInfo
		};
	});
var _user$project$Types$tNull = _user$project$Lang$withDummyRange(
	_user$project$Lang$TNull(_user$project$Lang$space1));
var _user$project$Types$tString = _user$project$Lang$withDummyRange(
	_user$project$Lang$TString(_user$project$Lang$space1));
var _user$project$Types$tNum = _user$project$Lang$withDummyRange(
	_user$project$Lang$TNum(_user$project$Lang$space1));
var _user$project$Types$parseT = function (s) {
	if (_elm_lang$core$Native_Utils.eq(s, ' Num ')) {
		return _user$project$Types$tNum;
	} else {
		var _p154 = _user$project$FastParser$parseT(s);
		if (_p154.ctor === 'Err') {
			return _elm_lang$core$Native_Utils.crashCase(
				'Types',
				{
					start: {line: 250, column: 3},
					end: {line: 252, column: 15}
				},
				_p154)(
				A2(_elm_lang$core$Basics_ops['++'], 'bad primitive op type: ', s));
		} else {
			return _p154._0;
		}
	}
};
var _user$project$Types$opTypeTable = A2(
	_elm_lang$core$List$map,
	_elm_lang$core$Tuple$mapSecond(_user$project$Types$parseT),
	{
		ctor: '::',
		_0: {ctor: '_Tuple2', _0: _user$project$Lang$Pi, _1: ' Num '},
		_1: {
			ctor: '::',
			_0: {ctor: '_Tuple2', _0: _user$project$Lang$ToStr, _1: ' (forall a (-> a String))'},
			_1: {
				ctor: '::',
				_0: {ctor: '_Tuple2', _0: _user$project$Lang$DebugLog, _1: ' (forall a (-> a String))'},
				_1: {
					ctor: '::',
					_0: {ctor: '_Tuple2', _0: _user$project$Lang$Eq, _1: ' (forall a (-> a a Bool))'},
					_1: {
						ctor: '::',
						_0: {ctor: '_Tuple2', _0: _user$project$Lang$Cos, _1: ' (-> Num Num)'},
						_1: {
							ctor: '::',
							_0: {ctor: '_Tuple2', _0: _user$project$Lang$Sin, _1: ' (-> Num Num)'},
							_1: {
								ctor: '::',
								_0: {ctor: '_Tuple2', _0: _user$project$Lang$ArcCos, _1: ' (-> Num Num)'},
								_1: {
									ctor: '::',
									_0: {ctor: '_Tuple2', _0: _user$project$Lang$ArcSin, _1: ' (-> Num Num)'},
									_1: {
										ctor: '::',
										_0: {ctor: '_Tuple2', _0: _user$project$Lang$ArcTan2, _1: ' (-> Num Num Num)'},
										_1: {
											ctor: '::',
											_0: {ctor: '_Tuple2', _0: _user$project$Lang$Floor, _1: ' (-> Num Num)'},
											_1: {
												ctor: '::',
												_0: {ctor: '_Tuple2', _0: _user$project$Lang$Ceil, _1: ' (-> Num Num)'},
												_1: {
													ctor: '::',
													_0: {ctor: '_Tuple2', _0: _user$project$Lang$Round, _1: ' (-> Num Num)'},
													_1: {
														ctor: '::',
														_0: {ctor: '_Tuple2', _0: _user$project$Lang$Sqrt, _1: ' (-> Num Num)'},
														_1: {
															ctor: '::',
															_0: {ctor: '_Tuple2', _0: _user$project$Lang$Plus, _1: ' DUMMY'},
															_1: {
																ctor: '::',
																_0: {ctor: '_Tuple2', _0: _user$project$Lang$Minus, _1: ' (-> Num Num Num)'},
																_1: {
																	ctor: '::',
																	_0: {ctor: '_Tuple2', _0: _user$project$Lang$Mult, _1: ' (-> Num Num Num)'},
																	_1: {
																		ctor: '::',
																		_0: {ctor: '_Tuple2', _0: _user$project$Lang$Div, _1: ' (-> Num Num Num)'},
																		_1: {
																			ctor: '::',
																			_0: {ctor: '_Tuple2', _0: _user$project$Lang$Lt, _1: ' (-> Num Num Bool)'},
																			_1: {
																				ctor: '::',
																				_0: {ctor: '_Tuple2', _0: _user$project$Lang$Mod, _1: ' (-> Num Num Num)'},
																				_1: {
																					ctor: '::',
																					_0: {ctor: '_Tuple2', _0: _user$project$Lang$Pow, _1: ' (-> Num Num Num)'},
																					_1: {
																						ctor: '::',
																						_0: {ctor: '_Tuple2', _0: _user$project$Lang$DictEmpty, _1: ' TODO'},
																						_1: {
																							ctor: '::',
																							_0: {ctor: '_Tuple2', _0: _user$project$Lang$DictGet, _1: ' TODO'},
																							_1: {
																								ctor: '::',
																								_0: {ctor: '_Tuple2', _0: _user$project$Lang$DictRemove, _1: ' TODO'},
																								_1: {
																									ctor: '::',
																									_0: {ctor: '_Tuple2', _0: _user$project$Lang$DictInsert, _1: ' TODO'},
																									_1: {ctor: '[]'}
																								}
																							}
																						}
																					}
																				}
																			}
																		}
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	});
var _user$project$Types$opType = function (op) {
	var _p156 = A2(_user$project$Utils$maybeFind, op.val, _user$project$Types$opTypeTable);
	if (_p156.ctor === 'Just') {
		return _p156._0;
	} else {
		return _elm_lang$core$Native_Utils.crashCase(
			'Types',
			{
				start: {line: 256, column: 3},
				end: {line: 258, column: 69}
			},
			_p156)(
			A2(
				_elm_lang$core$Basics_ops['++'],
				'opType not defined: ',
				_user$project$Lang$strOp(op.val)));
	}
};
var _user$project$Types$tBool = _user$project$Lang$withDummyRange(
	_user$project$Lang$TBool(_user$project$Lang$space1));
var _user$project$Types$lookupPat = F2(
	function (typeEnv, p) {
		var _p158 = p.val.p__;
		switch (_p158.ctor) {
			case 'PVar':
				return A2(_user$project$Types$lookupVar, typeEnv, _p158._1);
			case 'PAs':
				return A2(_user$project$Types$lookupVar, typeEnv, _p158._1);
			case 'PConst':
				return _elm_lang$core$Maybe$Just(_user$project$Types$tNum);
			case 'PBase':
				switch (_p158._1.ctor) {
					case 'EBool':
						return _elm_lang$core$Maybe$Just(_user$project$Types$tBool);
					case 'EString':
						return _elm_lang$core$Maybe$Just(_user$project$Types$tString);
					default:
						return _elm_lang$core$Maybe$Just(_user$project$Types$tNull);
				}
			default:
				return A2(
					_user$project$Utils$bindMaybe,
					function (ts) {
						var _p159 = _p158._3;
						if (_p159.ctor === 'Nothing') {
							return _elm_lang$core$Maybe$Just(
								_user$project$Types$tTuple(ts));
						} else {
							return A2(
								_user$project$Utils$bindMaybe,
								function (tRest) {
									return _elm_lang$core$Maybe$Just(
										A2(
											_user$project$Types$tTupleRest,
											ts,
											_elm_lang$core$Maybe$Just(tRest)));
								},
								A2(_user$project$Types$lookupPat, typeEnv, _p159._0));
						}
					},
					_user$project$Utils$projJusts(
						A2(
							_elm_lang$core$List$map,
							_user$project$Types$lookupPat(typeEnv),
							_p158._1)));
		}
	});
var _user$project$Types$sanityChecks = true;
var _user$project$Types$stopAtError = false;
var _user$project$Types$debugLog = _user$project$Config$debugLog(_user$project$Config$debugTypeChecker);
var _user$project$Types$solveConstraintsFor = F3(
	function (typeInfo, typeEnv, vars) {
		var _p160 = A5(
			_user$project$Types$unify,
			typeEnv,
			vars,
			{ctor: '[]'},
			{ctor: '[]'},
			typeInfo.activeConstraints);
		if (_p160.ctor === 'Ok') {
			return {
				result: _elm_lang$core$Result$Ok(
					_elm_lang$core$List$reverse(_p160._0._0)),
				typeInfo: _elm_lang$core$Native_Utils.update(
					typeInfo,
					{
						activeConstraints: _elm_lang$core$List$reverse(_p160._0._1)
					})
			};
		} else {
			var _p161 = A2(
				_user$project$Types$debugLog,
				'TODO display the constraints that failed...',
				{ctor: '_Tuple0'});
			return {
				result: _elm_lang$core$Result$Err(_p160._0),
				typeInfo: typeInfo
			};
		}
	});
var _user$project$Types$solveTemplateArrow = F4(
	function (typeInfo, typeEnv, eFuncInfo, arrow) {
		var vars = _elm_lang$core$Set$toList(
			_user$project$Types$constraintVarsOfArrow(arrow));
		var result = A3(_user$project$Types$solveConstraintsFor, typeInfo, typeEnv, vars);
		var _p162 = result.result;
		if (_p162.ctor === 'Err') {
			return {
				result: _elm_lang$core$Maybe$Nothing,
				typeInfo: A3(_user$project$Types$addTypeErrorAt, eFuncInfo.start, _p162._0, typeInfo)
			};
		} else {
			var arrow_ = A2(_user$project$Types$rewriteArrow, _p162._0, arrow);
			var unconstrainedVars = _elm_lang$core$Set$toList(
				_user$project$Types$constraintVarsOfArrow(arrow_));
			var arrow = function () {
				if (_elm_lang$core$Native_Utils.eq(
					unconstrainedVars,
					{ctor: '[]'})) {
					return _user$project$Types$tArrow(arrow_);
				} else {
					var newTypeVars = A2(
						_elm_lang$core$List$map,
						_elm_lang$core$String$dropLeft(1),
						unconstrainedVars);
					return A2(
						_user$project$Types$tPolyArrow,
						newTypeVars,
						A2(
							_user$project$Types$rewriteArrow,
							A2(
								_elm_lang$core$List$map,
								function (a) {
									return {
										ctor: '_Tuple2',
										_0: a,
										_1: _user$project$Types$tVar(
											A2(_elm_lang$core$String$dropLeft, 1, a))
									};
								},
								unconstrainedVars),
							arrow_));
				}
			}();
			return {
				result: _elm_lang$core$Maybe$Just(arrow),
				typeInfo: A3(
					_user$project$Types$addFinalType,
					eFuncInfo.val,
					_elm_lang$core$Maybe$Just(arrow),
					result.typeInfo)
			};
		}
	});
var _user$project$Types$displayRawTypes = function (typeInfo) {
	return A3(
		_elm_lang$core$Dict$foldl,
		F3(
			function (eid, _p164, _p163) {
				var _p165 = _p164;
				var _p166 = _p163;
				var _p167 = _p165._1;
				if (_p167.ctor === 'Nothing') {
					return {ctor: '_Tuple0'};
				} else {
					var s = _user$project$LangUnparser$unparseType(_p167._0);
					var _p168 = A2(
						_user$project$Types$debugLog,
						'synthesized type: ',
						{ctor: '_Tuple2', _0: eid, _1: s});
					return {ctor: '_Tuple0'};
				}
			}),
		{ctor: '_Tuple0'},
		typeInfo.rawTypes);
};
var _user$project$Types$displayConstraints = function (typeInfo) {
	var display = F2(
		function (cap, constraints) {
			if (_elm_lang$core$Native_Utils.eq(
				constraints,
				{ctor: '[]'})) {
				return {ctor: '_Tuple0'};
			} else {
				var _p169 = A2(
					_user$project$Types$debugLog,
					cap,
					{ctor: '_Tuple0'});
				var _p170 = A3(
					_elm_lang$core$List$foldl,
					function (_p171) {
						return _user$project$Types$debugLog(
							_user$project$Types$strConstraint(_p171));
					},
					{ctor: '_Tuple0'},
					constraints);
				return {ctor: '_Tuple0'};
			}
		});
	var _p172 = A2(display, 'ALL CONSTRAINTS', typeInfo.constraints);
	var _p173 = A2(display, 'ACTIVE CONSTRAINTS', typeInfo.activeConstraints);
	return {ctor: '_Tuple0'};
};
var _user$project$Types$displayNamedExps = function (typeInfo) {
	var _p174 = A2(
		_user$project$Types$debugLog,
		'NAMED EXPS',
		{ctor: '_Tuple0'});
	return A3(
		_elm_lang$core$List$foldr,
		F2(
			function (_p176, _p175) {
				var _p177 = _p176;
				var _p183 = _p177._0;
				var _p182 = _p177._1;
				var _p178 = _p175;
				var s1 = _elm_lang$core$String$trim(
					_user$project$LangUnparser$unparsePat(_p183));
				var _p179 = {
					ctor: '_Tuple2',
					_0: A2(_elm_lang$core$Dict$get, _p182, typeInfo.finalTypes),
					_1: A2(_elm_lang$core$Dict$get, _p182, typeInfo.rawTypes)
				};
				_v148_2:
				do {
					if (_p179.ctor === '_Tuple2') {
						if ((_p179._0.ctor === 'Just') && (_p179._0._0.ctor === 'Just')) {
							var s2 = _elm_lang$core$String$trim(
								_user$project$LangUnparser$unparseType(_p179._0._0._0));
							var _p180 = A2(
								_user$project$Types$debugLog,
								A2(
									_elm_lang$core$Basics_ops['++'],
									s1,
									A2(
										_elm_lang$core$Basics_ops['++'],
										' : ',
										A2(_elm_lang$core$Basics_ops['++'], s2, ' '))),
								_user$project$Lang$strPos(_p183.start));
							return {ctor: '_Tuple0'};
						} else {
							if (((_p179._1.ctor === 'Just') && (_p179._1._0.ctor === '_Tuple2')) && (_p179._1._0._1.ctor === 'Just')) {
								var s2 = _elm_lang$core$String$trim(
									_user$project$LangUnparser$unparseType(_p179._1._0._1._0));
								var _p181 = A2(
									_user$project$Types$debugLog,
									A2(
										_elm_lang$core$Basics_ops['++'],
										s1,
										A2(
											_elm_lang$core$Basics_ops['++'],
											' : ',
											A2(_elm_lang$core$Basics_ops['++'], s2, ' (raw) '))),
									_user$project$Lang$strPos(_p183.start));
								return {ctor: '_Tuple0'};
							} else {
								break _v148_2;
							}
						}
					} else {
						break _v148_2;
					}
				} while(false);
				return {ctor: '_Tuple0'};
			}),
		{ctor: '_Tuple0'},
		typeInfo.namedExps);
};
var _user$project$Types$displayTypeErrors = function (typeInfo) {
	var n = _elm_lang$core$List$length(typeInfo.typeErrors);
	if (_elm_lang$core$Native_Utils.eq(n, 0)) {
		return {ctor: '_Tuple0'};
	} else {
		var _p184 = A2(_user$project$Types$debugLog, '# TYPE ERRORS', n);
		return A3(
			_elm_lang$core$List$foldr,
			F2(
				function (typeError, _p185) {
					var _p186 = _p185;
					var _p187 = A2(
						_user$project$Types$debugLog,
						typeError.val,
						_user$project$Lang$strPos(typeError.pos));
					return {ctor: '_Tuple0'};
				}),
			{ctor: '_Tuple0'},
			typeInfo.typeErrors);
	}
};
var _user$project$Types$displayTypeInfo = function (typeInfo) {
	var _p188 = _user$project$Types$displayTypeErrors(typeInfo);
	return {ctor: '_Tuple0'};
};
var _user$project$Types$valIsType = F2(
	function (val, tipe) {
		var unsupported = function (msg) {
			return _elm_lang$core$Native_Utils.crash(
				'Types',
				{
					start: {line: 88, column: 5},
					end: {line: 88, column: 16}
				})(
				A2(
					_elm_lang$core$Basics_ops['++'],
					'typing values against ',
					A2(_elm_lang$core$Basics_ops['++'], msg, ' is not supported')));
		};
		var _p189 = {ctor: '_Tuple2', _0: val.v_, _1: tipe.val};
		_v150_12:
		do {
			if (_p189.ctor === '_Tuple2') {
				switch (_p189._1.ctor) {
					case 'TNum':
						if (_p189._0.ctor === 'VConst') {
							return true;
						} else {
							break _v150_12;
						}
					case 'TBool':
						if ((_p189._0.ctor === 'VBase') && (_p189._0._0.ctor === 'VBool')) {
							return true;
						} else {
							break _v150_12;
						}
					case 'TString':
						if ((_p189._0.ctor === 'VBase') && (_p189._0._0.ctor === 'VString')) {
							return true;
						} else {
							break _v150_12;
						}
					case 'TNull':
						if ((_p189._0.ctor === 'VBase') && (_p189._0._0.ctor === 'VNull')) {
							return true;
						} else {
							break _v150_12;
						}
					case 'TList':
						if (_p189._0.ctor === 'VList') {
							return A2(
								_elm_lang$core$List$all,
								function (v) {
									return A2(_user$project$Types$valIsType, v, _p189._1._1);
								},
								_p189._0._0);
						} else {
							break _v150_12;
						}
					case 'TDict':
						return unsupported('dictionary types');
					case 'TTuple':
						if (_p189._0.ctor === 'VList') {
							var _p194 = _p189._0._0;
							var _p193 = _p189._1._1;
							var typeListsMatch = A3(
								_elm_lang$core$List$foldl,
								F2(
									function (_p190, res) {
										var _p191 = _p190;
										return res && A2(_user$project$Types$valIsType, _p191._0, _p191._1);
									}),
								true,
								A2(_user$project$Utils$zip, _p194, _p193));
							var _p192 = _p189._1._3;
							if (_p192.ctor === 'Nothing') {
								return typeListsMatch && _elm_lang$core$Native_Utils.eq(
									_elm_lang$core$List$length(_p194),
									_elm_lang$core$List$length(_p193));
							} else {
								return typeListsMatch && ((_elm_lang$core$Native_Utils.cmp(
									_elm_lang$core$List$length(_p194),
									_elm_lang$core$List$length(_p193)) > -1) && A2(
									_elm_lang$core$List$all,
									function (v) {
										return A2(_user$project$Types$valIsType, v, _p192._0);
									},
									A2(
										_elm_lang$core$List$drop,
										_elm_lang$core$List$length(_p193),
										_p194)));
							}
						} else {
							break _v150_12;
						}
					case 'TArrow':
						return unsupported('arrow types');
					case 'TUnion':
						return A2(
							_elm_lang$core$List$any,
							_user$project$Types$valIsType(val),
							_p189._1._1);
					case 'TNamed':
						return unsupported('type aliases');
					case 'TVar':
						return unsupported('type variables');
					case 'TWildcard':
						return true;
					default:
						break _v150_12;
				}
			} else {
				break _v150_12;
			}
		} while(false);
		return false;
	});
var _user$project$Types$identifiersEquivalent = F2(
	function (t1, t2) {
		var flatIdents = function (t) {
			flatIdents:
			while (true) {
				var _p195 = t.val;
				switch (_p195.ctor) {
					case 'TNum':
						return {ctor: '[]'};
					case 'TBool':
						return {ctor: '[]'};
					case 'TString':
						return {ctor: '[]'};
					case 'TNull':
						return {ctor: '[]'};
					case 'TList':
						var _v154 = _p195._1;
						t = _v154;
						continue flatIdents;
					case 'TDict':
						return A2(
							_elm_lang$core$Basics_ops['++'],
							flatIdents(_p195._1),
							flatIdents(_p195._2));
					case 'TTuple':
						var restTypeIdents = function () {
							var _p196 = _p195._3;
							if (_p196.ctor === 'Just') {
								return flatIdents(_p196._0);
							} else {
								return {ctor: '[]'};
							}
						}();
						return A2(
							_elm_lang$core$Basics_ops['++'],
							A2(_elm_lang$core$List$concatMap, flatIdents, _p195._1),
							restTypeIdents);
					case 'TArrow':
						return A2(_elm_lang$core$List$concatMap, flatIdents, _p195._1);
					case 'TUnion':
						return A2(_elm_lang$core$List$concatMap, flatIdents, _p195._1);
					case 'TNamed':
						return {ctor: '[]'};
					case 'TVar':
						return {
							ctor: '::',
							_0: _p195._1,
							_1: {ctor: '[]'}
						};
					case 'TWildcard':
						return {ctor: '[]'};
					default:
						return _elm_lang$core$Native_Utils.crashCase(
							'Types',
							{
								start: {line: 61, column: 5},
								end: {line: 81, column: 73}
							},
							_p195)('identifiersEquiv TForall TODO');
				}
			}
		};
		return A2(
			_user$project$Utils$oneToOneMappingExists,
			flatIdents(t1),
			flatIdents(t2));
	});
var _user$project$Types$astsMatch = F2(
	function (t1, t2) {
		astsMatch:
		while (true) {
			var _p198 = {ctor: '_Tuple2', _0: t1.val, _1: t2.val};
			_v156_14:
			do {
				if (_p198.ctor === '_Tuple2') {
					switch (_p198._0.ctor) {
						case 'TNum':
							if (_p198._1.ctor === 'TNum') {
								return true;
							} else {
								break _v156_14;
							}
						case 'TBool':
							if (_p198._1.ctor === 'TBool') {
								return true;
							} else {
								break _v156_14;
							}
						case 'TString':
							if (_p198._1.ctor === 'TString') {
								return true;
							} else {
								break _v156_14;
							}
						case 'TNull':
							if (_p198._1.ctor === 'TNull') {
								return true;
							} else {
								break _v156_14;
							}
						case 'TList':
							if (_p198._1.ctor === 'TList') {
								var _v157 = _p198._0._1,
									_v158 = _p198._1._1;
								t1 = _v157;
								t2 = _v158;
								continue astsMatch;
							} else {
								break _v156_14;
							}
						case 'TDict':
							if (_p198._1.ctor === 'TDict') {
								return A2(_user$project$Types$astsMatch, _p198._0._1, _p198._1._1) && A2(_user$project$Types$astsMatch, _p198._0._2, _p198._1._2);
							} else {
								break _v156_14;
							}
						case 'TTuple':
							if (_p198._1.ctor === 'TTuple') {
								var maybeRestTypesMatch = function () {
									var _p199 = {ctor: '_Tuple2', _0: _p198._0._3, _1: _p198._1._3};
									_v159_2:
									do {
										if (_p199.ctor === '_Tuple2') {
											if (_p199._0.ctor === 'Nothing') {
												if (_p199._1.ctor === 'Nothing') {
													return true;
												} else {
													break _v159_2;
												}
											} else {
												if (_p199._1.ctor === 'Just') {
													return A2(_user$project$Types$astsMatch, _p199._0._0, _p199._1._0);
												} else {
													break _v159_2;
												}
											}
										} else {
											break _v159_2;
										}
									} while(false);
									return false;
								}();
								return maybeRestTypesMatch && A3(_user$project$Utils$listsEqualBy, _user$project$Types$astsMatch, _p198._0._1, _p198._1._1);
							} else {
								break _v156_14;
							}
						case 'TArrow':
							if (_p198._1.ctor === 'TArrow') {
								return A3(_user$project$Utils$listsEqualBy, _user$project$Types$astsMatch, _p198._0._1, _p198._1._1);
							} else {
								break _v156_14;
							}
						case 'TUnion':
							if (_p198._1.ctor === 'TUnion') {
								return A3(_user$project$Utils$listsEqualBy, _user$project$Types$astsMatch, _p198._0._1, _p198._1._1);
							} else {
								break _v156_14;
							}
						case 'TNamed':
							if (_p198._1.ctor === 'TNamed') {
								return _elm_lang$core$Native_Utils.eq(_p198._0._1, _p198._1._1);
							} else {
								break _v156_14;
							}
						case 'TVar':
							if (_p198._1.ctor === 'TVar') {
								return true;
							} else {
								break _v156_14;
							}
						case 'TWildcard':
							if (_p198._1.ctor === 'TWildcard') {
								return true;
							} else {
								break _v156_14;
							}
						default:
							if (_p198._0._1.ctor === 'One') {
								if ((_p198._1.ctor === 'TForall') && (_p198._1._1.ctor === 'One')) {
									var _v160 = _p198._0._2,
										_v161 = _p198._1._2;
									t1 = _v160;
									t2 = _v161;
									continue astsMatch;
								} else {
									break _v156_14;
								}
							} else {
								if ((_p198._1.ctor === 'TForall') && (_p198._1._1.ctor === 'Many')) {
									return _elm_lang$core$Native_Utils.eq(
										_elm_lang$core$List$length(_p198._0._1._1),
										_elm_lang$core$List$length(_p198._1._1._1)) && A2(_user$project$Types$astsMatch, _p198._0._2, _p198._1._2);
								} else {
									break _v156_14;
								}
							}
					}
				} else {
					break _v156_14;
				}
			} while(false);
			return false;
		}
	});
var _user$project$Types$equal = F2(
	function (t1, t2) {
		return A2(_user$project$Types$astsMatch, t1, t2) && A2(_user$project$Types$identifiersEquivalent, t1, t2);
	});
var _user$project$Types$TypeInfo = F9(
	function (a, b, c, d, e, f, g, h, i) {
		return {constraints: a, activeConstraints: b, typeErrors: c, rawTypes: d, finalTypes: e, namedExps: f, constraintCount: g, constraintVarCount: h, preludeTypeEnv: i};
	});
var _user$project$Types$AceTypeInfo = F3(
	function (a, b, c) {
		return {annotations: a, highlights: b, tooltips: c};
	});
var _user$project$Types$AndTypeInfo = F2(
	function (a, b) {
		return {result: a, typeInfo: b};
	});
var _user$project$Types$TypeAlias = F2(
	function (a, b) {
		return {ctor: 'TypeAlias', _0: a, _1: b};
	});
var _user$project$Types$TypeVar = function (a) {
	return {ctor: 'TypeVar', _0: a};
};
var _user$project$Types$addTypeVarBindings = F2(
	function (typeVars, typeEnv) {
		var newTypeBindings = A2(
			_elm_lang$core$List$map,
			_user$project$Types$TypeVar,
			_elm_lang$core$List$reverse(typeVars));
		return A2(_elm_lang$core$Basics_ops['++'], newTypeBindings, typeEnv);
	});
var _user$project$Types$isWellFormed = F2(
	function (typeEnv, tipe) {
		var _p200 = function () {
			var _p201 = tipe.val;
			if (_p201.ctor === 'TForall') {
				if (_p201._1.ctor === 'Many') {
					return {
						ctor: '_Tuple2',
						_0: A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$second, _p201._1._1),
						_1: _p201._2
					};
				} else {
					return {
						ctor: '_Tuple2',
						_0: {
							ctor: '::',
							_0: _elm_lang$core$Tuple$second(_p201._1._0),
							_1: {ctor: '[]'}
						},
						_1: _p201._2
					};
				}
			} else {
				return {
					ctor: '_Tuple2',
					_0: {ctor: '[]'},
					_1: tipe
				};
			}
		}();
		var prenexVars = _p200._0;
		var tipe_ = _p200._1;
		var typeEnv_ = A2(
			_elm_lang$core$Basics_ops['++'],
			A2(
				_elm_lang$core$List$map,
				_user$project$Types$TypeVar,
				_elm_lang$core$List$reverse(prenexVars)),
			typeEnv);
		var noNestedForalls = A3(
			_user$project$Lang$foldType,
			F2(
				function (t, acc) {
					var _p202 = t.val;
					if (_p202.ctor === 'TForall') {
						return false;
					} else {
						return acc;
					}
				}),
			tipe_,
			true);
		var allVarsBound = A3(
			_user$project$Lang$foldType,
			F2(
				function (t, acc) {
					var _p203 = t.val;
					switch (_p203.ctor) {
						case 'TNamed':
							return acc && A2(_user$project$Types$lookupTypeAlias, typeEnv_, _p203._1);
						case 'TVar':
							var _p204 = _p203._1;
							return _user$project$Types$isConstraintVar(_p204) ? false : (acc && A2(
								_elm_lang$core$List$member,
								_user$project$Types$TypeVar(_p204),
								typeEnv_));
						default:
							return acc;
					}
				}),
			tipe_,
			true);
		return noNestedForalls && allVarsBound;
	});
var _user$project$Types$CheckType = F2(
	function (a, b) {
		return {ctor: 'CheckType', _0: a, _1: b};
	});
var _user$project$Types$addTypBindings = F3(
	function (p, t, typeEnv) {
		var _p205 = p.val.p__;
		if (_p205.ctor === 'PVar') {
			return _elm_lang$core$Result$Ok(
				{
					ctor: '::',
					_0: A2(_user$project$Types$CheckType, _p205._1, t),
					_1: typeEnv
				});
		} else {
			return _elm_lang$core$Native_Utils.crashCase(
				'Types',
				{
					start: {line: 348, column: 3},
					end: {line: 350, column: 88}
				},
				_p205)('addTypBindings: Currently, only (typ x T) is supported.');
		}
	});
var _user$project$Types$HasType = F2(
	function (a, b) {
		return {ctor: 'HasType', _0: a, _1: b};
	});
var _user$project$Types$addBindingsOne = F2(
	function (_p207, acc) {
		addBindingsOne:
		while (true) {
			var _p208 = _p207;
			var _p219 = _p208._1;
			var _p218 = _p208._0;
			var fail = function (s) {
				return _elm_lang$core$Result$Err(
					_user$project$Utils$spaces(
						{
							ctor: '::',
							_0: 'addBindings',
							_1: {
								ctor: '::',
								_0: _user$project$LangUnparser$unparsePat(_p218),
								_1: {
									ctor: '::',
									_0: _user$project$LangUnparser$unparseType(_p219),
									_1: {
										ctor: '::',
										_0: s,
										_1: {ctor: '[]'}
									}
								}
							}
						}));
			};
			var _p209 = {ctor: '_Tuple2', _0: _p218.val.p__, _1: _p219.val};
			_v167_8:
			do {
				if (_p209.ctor === '_Tuple2') {
					switch (_p209._0.ctor) {
						case 'PConst':
							return _elm_lang$core$Result$Ok(acc);
						case 'PBase':
							return _elm_lang$core$Result$Ok(acc);
						case 'PVar':
							if (_p209._0._1 === '_') {
								return _elm_lang$core$Result$Ok(acc);
							} else {
								return _elm_lang$core$Result$Ok(
									{
										ctor: '::',
										_0: A2(_user$project$Types$HasType, _p209._0._1, _p219),
										_1: acc
									});
							}
						case 'PAs':
							var _v168 = {ctor: '_Tuple2', _0: _p209._0._3, _1: _p219},
								_v169 = {
								ctor: '::',
								_0: A2(_user$project$Types$HasType, _p209._0._1, _p219),
								_1: acc
							};
							_p207 = _v168;
							acc = _v169;
							continue addBindingsOne;
						default:
							switch (_p209._1.ctor) {
								case 'TNamed':
									var _p210 = A2(_user$project$Types$expandTypeAlias, acc, _p209._1._1);
									if (_p210.ctor === 'Nothing') {
										return fail('Type alias not defined');
									} else {
										var _v171 = {ctor: '_Tuple2', _0: _p218, _1: _p210._0},
											_v172 = acc;
										_p207 = _v171;
										acc = _v172;
										continue addBindingsOne;
									}
								case 'TTuple':
									var maybeRestBinding = function () {
										var _p211 = {ctor: '_Tuple2', _0: _p209._0._3, _1: _p209._1._3};
										_v173_2:
										do {
											if (_p211.ctor === '_Tuple2') {
												if (_p211._0.ctor === 'Nothing') {
													if (_p211._1.ctor === 'Nothing') {
														return _elm_lang$core$Result$Ok(
															{ctor: '[]'});
													} else {
														break _v173_2;
													}
												} else {
													if (_p211._1.ctor === 'Just') {
														var _p212 = {ctor: '_Tuple2', _0: _p211._0._0.val.p__, _1: _p211._1._0.val};
														if (((_p212.ctor === '_Tuple2') && (_p212._0.ctor === 'PVar')) && (_p212._1.ctor === 'TList')) {
															return _elm_lang$core$Result$Ok(
																{
																	ctor: '::',
																	_0: A2(_user$project$Types$HasType, _p212._0._1, _p212._1._1),
																	_1: {ctor: '[]'}
																});
														} else {
															return fail('PList ERROR 1 TODO');
														}
													} else {
														break _v173_2;
													}
												}
											} else {
												break _v173_2;
											}
										} while(false);
										return fail('PList ERROR 2 TODO');
									}();
									var _p213 = {
										ctor: '_Tuple2',
										_0: A3(_user$project$Types$addBindings, _p209._0._1, _p209._1._1, acc),
										_1: maybeRestBinding
									};
									if (((_p213.ctor === '_Tuple2') && (_p213._0.ctor === 'Ok')) && (_p213._1.ctor === 'Ok')) {
										return _elm_lang$core$Result$Ok(
											A2(_elm_lang$core$Basics_ops['++'], _p213._1._0, _p213._0._0));
									} else {
										return fail('');
									}
								case 'TList':
									var _p217 = _p209._0._1;
									var _p214 = A3(
										_user$project$Types$addBindings,
										_p217,
										A2(
											_elm_lang$core$List$repeat,
											_elm_lang$core$List$length(_p217),
											_p209._1._1),
										acc);
									if (_p214.ctor === 'Err') {
										return fail(_p214._0);
									} else {
										var _p216 = _p214._0;
										var _p215 = _p209._0._3;
										if (_p215.ctor === 'Nothing') {
											return _elm_lang$core$Result$Ok(_p216);
										} else {
											var _v178 = {ctor: '_Tuple2', _0: _p215._0, _1: _p219},
												_v179 = _p216;
											_p207 = _v178;
											acc = _v179;
											continue addBindingsOne;
										}
									}
								default:
									break _v167_8;
							}
					}
				} else {
					break _v167_8;
				}
			} while(false);
			return fail('');
		}
	});
var _user$project$Types$addBindings = F3(
	function (pats, types, typeEnv) {
		var _p220 = A2(_user$project$Utils$maybeZip, pats, types);
		if (_p220.ctor === 'Nothing') {
			return _elm_lang$core$Result$Err('addBindings: can\'t zip');
		} else {
			return A2(_user$project$Types$addBindingsMany, _p220._0, typeEnv);
		}
	});
var _user$project$Types$addBindingsMany = F2(
	function (patsAndTypes, typeEnv) {
		return A3(
			_elm_lang$core$List$foldl,
			F2(
				function (pt, macc) {
					var _p221 = macc;
					if (_p221.ctor === 'Err') {
						return _elm_lang$core$Result$Err(_p221._0);
					} else {
						return A2(_user$project$Types$addBindingsOne, pt, _p221._0);
					}
				}),
			_elm_lang$core$Result$Ok(typeEnv),
			patsAndTypes);
	});
var _user$project$Types$narrowUnionType = F4(
	function (p, tAfterPreviousCases, tThisCase, typeEnv) {
		var tThisCase_ = function () {
			var _p222 = {ctor: '_Tuple2', _0: tThisCase.val, _1: tAfterPreviousCases};
			if ((_p222.ctor === '_Tuple2') && (_p222._0.ctor === 'TWildcard')) {
				if ((_p222._1.ctor === '::') && (_p222._1._1.ctor === '[]')) {
					return _p222._1._0;
				} else {
					return _user$project$Types$tUnion(tAfterPreviousCases);
				}
			} else {
				return tThisCase;
			}
		}();
		var tAfterThisCase = A2(_user$project$Types$subtractType, tAfterPreviousCases, tThisCase_);
		var _p223 = A2(
			_user$project$Types$addBindingsOne,
			{ctor: '_Tuple2', _0: p, _1: tThisCase_},
			typeEnv);
		if (_p223.ctor === 'Err') {
			return _elm_lang$core$Result$Err(_p223._0);
		} else {
			return _elm_lang$core$Result$Ok(
				{ctor: '_Tuple2', _0: tAfterThisCase, _1: _p223._0});
		}
	});
var _user$project$Types$addRecBinding = F4(
	function (rec, p, t, typeEnv) {
		if (!rec) {
			return typeEnv;
		} else {
			var _p224 = p.val.p__;
			if (_p224.ctor === 'PVar') {
				var tMono = function () {
					var _p225 = _user$project$Types$stripPolymorphicArrow(t);
					if (_p225.ctor === 'Nothing') {
						return t;
					} else {
						return _user$project$Types$tArrow(_p225._0._1);
					}
				}();
				return {
					ctor: '::',
					_0: A2(_user$project$Types$HasType, _p224._1, tMono),
					_1: typeEnv
				};
			} else {
				var _p226 = A2(
					_user$project$Types$debugLog,
					'addRecBinding: multi TODO',
					{
						ctor: '_Tuple2',
						_0: _user$project$LangUnparser$unparsePat(p),
						_1: _user$project$LangUnparser$unparseType(t)
					});
				return typeEnv;
			}
		}
	});
var _user$project$Types$synthesizeType = F3(
	function (typeInfo, typeEnv, e) {
		synthesizeType:
		while (true) {
			var finish = {
				withType: A2(_user$project$Types$finishSynthesizeWithType, e.val.eid, e.start),
				withError: _user$project$Types$finishSynthesizeWithError(e.start)
			};
			var _p227 = e.val.e__;
			switch (_p227.ctor) {
				case 'EColonType':
					var _p228 = _p227._3;
					if (!A2(_user$project$Types$isWellFormed, typeEnv, _p228)) {
						var err = _user$project$Utils$spaces(
							{
								ctor: '::',
								_0: _elm_lang$core$Basics$toString(e.val.eid),
								_1: {
									ctor: '::',
									_0: _user$project$Lang$strPos(_p228.start),
									_1: {
										ctor: '::',
										_0: 'Type annotation not well-formed:',
										_1: {
											ctor: '::',
											_0: _elm_lang$core$String$trim(
												_user$project$LangUnparser$unparseType(_p228)),
											_1: {ctor: '[]'}
										}
									}
								}
							});
						return A2(finish.withError, err, typeInfo);
					} else {
						var result1 = A4(_user$project$Types$checkType, typeInfo, typeEnv, _p227._1, _p228);
						return result1.result ? A2(finish.withType, _p228, result1.typeInfo) : {result: _elm_lang$core$Maybe$Nothing, typeInfo: result1.typeInfo};
					}
				case 'EConst':
					return A2(finish.withType, _user$project$Types$tNum, typeInfo);
				case 'EBase':
					var _p229 = _p227._1;
					switch (_p229.ctor) {
						case 'EBool':
							return A2(finish.withType, _user$project$Types$tBool, typeInfo);
						case 'EString':
							return A2(finish.withType, _user$project$Types$tString, typeInfo);
						default:
							return A2(finish.withType, _user$project$Types$tNull, typeInfo);
					}
				case 'EVar':
					var _p231 = _p227._1;
					var _p230 = A2(_user$project$Types$lookupVar, typeEnv, _p231);
					if (_p230.ctor === 'Just') {
						return A2(finish.withType, _p230._0, typeInfo);
					} else {
						var err = _user$project$Utils$spaces(
							{
								ctor: '::',
								_0: _elm_lang$core$Basics$toString(e.val.eid),
								_1: {
									ctor: '::',
									_0: 'var not found: ',
									_1: {
										ctor: '::',
										_0: _p231,
										_1: {ctor: '[]'}
									}
								}
							});
						return A2(finish.withError, err, typeInfo);
					}
				case 'EFun':
					var _p233 = _p227._1;
					var _p232 = A2(
						_user$project$Types$newArrowTemplate,
						typeInfo,
						_elm_lang$core$List$length(_p233));
					var arrow = _p232._0;
					var typeInfo_ = _p232._1;
					return A6(_user$project$Types$tsFun, finish, typeInfo_, typeEnv, _p233, _p227._2, arrow);
				case 'EOp':
					if (_p227._2.ctor === '[]') {
						return A2(
							finish.withType,
							_user$project$Types$opType(_p227._1),
							typeInfo);
					} else {
						var _p237 = _p227._1;
						var _p236 = _p227._2;
						var _p234 = {
							ctor: '_Tuple2',
							_0: _p237.val,
							_1: _user$project$Types$stripPolymorphicArrow(
								_user$project$Types$opType(_p237))
						};
						_v189_0:
						do {
							if (_p234._1.ctor === 'Just') {
								if (_p234._0.ctor === 'Plus') {
									break _v189_0;
								} else {
									if ((_p234._1._0.ctor === '_Tuple2') && (_p234._1._0._0.ctor === '[]')) {
										return A5(_user$project$Types$tsAppMono, finish, typeInfo, typeEnv, _p236, _p234._1._0._1);
									} else {
										return A5(_user$project$Types$tsAppPoly, finish, typeInfo, typeEnv, _p236, _p234._1._0);
									}
								}
							} else {
								if (_p234._0.ctor === 'Plus') {
									break _v189_0;
								} else {
									return A2(finish.withError, 'synthesizeType: EOp ...', typeInfo);
								}
							}
						} while(false);
						var result = A5(
							_user$project$Types$tsAppMono,
							finish,
							typeInfo,
							typeEnv,
							_p236,
							{
								ctor: '_Tuple2',
								_0: {
									ctor: '::',
									_0: _user$project$Types$tNum,
									_1: {
										ctor: '::',
										_0: _user$project$Types$tNum,
										_1: {ctor: '[]'}
									}
								},
								_1: _user$project$Types$tNum
							});
						var _p235 = result.result;
						if (_p235.ctor === 'Just') {
							return result;
						} else {
							return A5(
								_user$project$Types$tsAppMono,
								finish,
								typeInfo,
								typeEnv,
								_p236,
								{
									ctor: '_Tuple2',
									_0: {
										ctor: '::',
										_0: _user$project$Types$tString,
										_1: {
											ctor: '::',
											_0: _user$project$Types$tString,
											_1: {ctor: '[]'}
										}
									},
									_1: _user$project$Types$tString
								});
						}
					}
				case 'EApp':
					var _p240 = _p227._2;
					var result1 = A3(_user$project$Types$synthesizeType, typeInfo, typeEnv, _p227._1);
					var _p238 = result1.result;
					if (_p238.ctor === 'Nothing') {
						return A2(finish.withError, 'synthesizeTyp: EApp ...', result1.typeInfo);
					} else {
						var _p239 = _user$project$Types$stripPolymorphicArrow(_p238._0);
						if (_p239.ctor === 'Just') {
							if ((_p239._0.ctor === '_Tuple2') && (_p239._0._0.ctor === '[]')) {
								return A5(_user$project$Types$tsAppMono, finish, result1.typeInfo, typeEnv, _p240, _p239._0._1);
							} else {
								return A5(_user$project$Types$tsAppPoly, finish, result1.typeInfo, typeEnv, _p240, _p239._0);
							}
						} else {
							var err = 'TS-App: t1 not arrow...';
							return A2(finish.withError, err, result1.typeInfo);
						}
					}
				case 'EList':
					var _p241 = A3(
						_elm_lang$core$List$foldl,
						F2(
							function (ei, _p242) {
								var _p243 = _p242;
								var result = A3(_user$project$Types$synthesizeType, _p243._1, typeEnv, ei);
								return {
									ctor: '_Tuple2',
									_0: {ctor: '::', _0: result.result, _1: _p243._0},
									_1: result.typeInfo
								};
							}),
						{
							ctor: '_Tuple2',
							_0: {ctor: '[]'},
							_1: typeInfo
						},
						_elm_lang$core$List$reverse(_p227._1));
					var maybeTypes = _p241._0;
					var typeInfo_ = _p241._1;
					var _p244 = _user$project$Utils$projJusts(maybeTypes);
					if (_p244.ctor === 'Nothing') {
						return A2(finish.withError, 'synthesizeType: EList 1 ...', typeInfo_);
					} else {
						var _p247 = _p244._0;
						var _p245 = _p227._3;
						if (_p245.ctor === 'Nothing') {
							return A2(
								finish.withType,
								_user$project$Types$tTuple(_p247),
								typeInfo_);
						} else {
							var result = A3(_user$project$Types$synthesizeType, typeInfo_, typeEnv, _p245._0);
							var _p246 = result.result;
							if (_p246.ctor === 'Nothing') {
								return A2(finish.withError, 'synthesizeType: EList 2 ...', result.typeInfo);
							} else {
								return A2(
									finish.withType,
									A2(
										_user$project$Types$tTupleRest,
										_p247,
										_elm_lang$core$Maybe$Just(_p246._0)),
									result.typeInfo);
							}
						}
					}
				case 'EIf':
					var result1 = A4(_user$project$Types$checkType, typeInfo, typeEnv, _p227._1, _user$project$Types$tBool);
					if (!result1.result) {
						return A2(finish.withError, 'synthesizeType: EIf 1 ...', result1.typeInfo);
					} else {
						var result2 = A3(_user$project$Types$synthesizeType, result1.typeInfo, typeEnv, _p227._2);
						var result3 = A3(_user$project$Types$synthesizeType, result2.typeInfo, typeEnv, _p227._3);
						var _p248 = {ctor: '_Tuple2', _0: result2.result, _1: result3.result};
						if (((_p248.ctor === '_Tuple2') && (_p248._0.ctor === 'Just')) && (_p248._1.ctor === 'Just')) {
							var _p249 = A2(_user$project$Types$joinTypes, _p248._0._0, _p248._1._0);
							if (_p249.ctor === 'Ok') {
								return A2(finish.withType, _p249._0, result3.typeInfo);
							} else {
								return A2(finish.withError, 'synthesizeType: EIf 2 ...', result3.typeInfo);
							}
						} else {
							return A2(finish.withError, 'synthesizeType: EIf 3 ...', result3.typeInfo);
						}
					}
				case 'ECase':
					var result1 = A3(_user$project$Types$synthesizeType, typeInfo, typeEnv, _p227._1);
					var _p250 = result1.result;
					if (_p250.ctor === 'Nothing') {
						return A2(finish.withError, 'synthesizeType: ECase ...', result1.typeInfo);
					} else {
						var _p257 = _p250._0;
						var _p251 = _elm_lang$core$Set$isEmpty(
							_user$project$Types$constraintVarsOf(
								{
									ctor: '::',
									_0: _p257,
									_1: {ctor: '[]'}
								})) ? {ctor: '_Tuple0'} : A2(
							_user$project$Types$debugLog,
							'ECase: TODO constraints based on patterns',
							{ctor: '_Tuple0'});
						var maybeThings = A3(
							_elm_lang$core$List$foldl,
							F2(
								function (pe, acc) {
									var _p252 = pe.val;
									var pi = _p252._1;
									var ei = _p252._2;
									var _p253 = {
										ctor: '_Tuple2',
										_0: acc,
										_1: A2(
											_user$project$Types$addBindingsOne,
											{ctor: '_Tuple2', _0: pi, _1: _p257},
											typeEnv)
									};
									if (_p253._0.ctor === 'Ok') {
										if (_p253._1.ctor === 'Ok') {
											return _elm_lang$core$Result$Ok(
												{
													ctor: '::',
													_0: {ctor: '_Tuple2', _0: _p253._1._0, _1: ei},
													_1: _p253._0._0
												});
										} else {
											return _elm_lang$core$Result$Err(_p253._1._0);
										}
									} else {
										return _elm_lang$core$Result$Err(_p253._0._0);
									}
								}),
							_elm_lang$core$Result$Ok(
								{ctor: '[]'}),
							_p227._2);
						var _p254 = maybeThings;
						if (_p254.ctor === 'Err') {
							var err_ = _user$project$Utils$spaces(
								{
									ctor: '::',
									_0: 'ECase: could not typecheck all patterns',
									_1: {
										ctor: '::',
										_0: _p254._0,
										_1: {ctor: '[]'}
									}
								});
							return A2(finish.withError, err_, result1.typeInfo);
						} else {
							var result2 = A2(_user$project$Types$synthesizeBranchTypes, result1.typeInfo, _p254._0);
							var _p255 = _user$project$Utils$projJusts(result2.result);
							if (_p255.ctor === 'Nothing') {
								var err = 'ECase: could not typecheck all branches';
								return A2(finish.withError, err, result2.typeInfo);
							} else {
								var _p256 = _user$project$Types$joinManyTypes(_p255._0);
								if (_p256.ctor === 'Err') {
									return A2(finish.withError, _p256._0, result2.typeInfo);
								} else {
									return A2(finish.withType, _p256._0, result2.typeInfo);
								}
							}
						}
					}
				case 'ETypeCase':
					var _p270 = _p227._1;
					var _p258 = A2(_user$project$Types$lookupPat, typeEnv, _p270);
					if (_p258.ctor === 'Nothing') {
						var err = A2(
							_elm_lang$core$Basics_ops['++'],
							'no type for the pattern: ',
							_user$project$LangUnparser$unparsePat(_p270));
						return {
							result: _elm_lang$core$Maybe$Nothing,
							typeInfo: A3(_user$project$Types$addTypeErrorAt, _p270.start, err, typeInfo)
						};
					} else {
						var _p269 = _p258._0;
						var _p259 = _p269.val;
						if (_p259.ctor === 'TUnion') {
							var _p260 = A3(
								_elm_lang$core$List$foldl,
								F2(
									function (te, _p261) {
										var _p262 = _p261;
										var _p265 = _p262._0;
										var _p263 = te.val;
										var ti = _p263._1;
										var ei = _p263._2;
										var _p264 = {
											ctor: '_Tuple2',
											_0: _p262._1,
											_1: A4(_user$project$Types$narrowUnionType, _p270, _p265, ti, typeEnv)
										};
										if (_p264._0.ctor === 'Ok') {
											if (_p264._1.ctor === 'Ok') {
												return {
													ctor: '_Tuple2',
													_0: _p264._1._0._0,
													_1: _elm_lang$core$Result$Ok(
														{
															ctor: '::',
															_0: {ctor: '_Tuple2', _0: _p264._1._0._1, _1: ei},
															_1: _p264._0._0
														})
												};
											} else {
												return {
													ctor: '_Tuple2',
													_0: _p265,
													_1: _elm_lang$core$Result$Err(_p264._1._0)
												};
											}
										} else {
											return {
												ctor: '_Tuple2',
												_0: _p265,
												_1: _elm_lang$core$Result$Err(_p264._0._0)
											};
										}
									}),
								{
									ctor: '_Tuple2',
									_0: _p259._1,
									_1: _elm_lang$core$Result$Ok(
										{ctor: '[]'})
								},
								_p227._2);
							var maybeThings = _p260._1;
							var _p266 = maybeThings;
							if (_p266.ctor === 'Err') {
								var err_ = _user$project$Utils$spaces(
									{
										ctor: '::',
										_0: 'ETypeCase: could not typecheck all patterns',
										_1: {
											ctor: '::',
											_0: _p266._0,
											_1: {ctor: '[]'}
										}
									});
								return A2(finish.withError, err_, typeInfo);
							} else {
								var result2 = A2(_user$project$Types$synthesizeBranchTypes, typeInfo, _p266._0);
								var _p267 = _user$project$Utils$projJusts(result2.result);
								if (_p267.ctor === 'Nothing') {
									var err = 'ETypeCase: could not typecheck all branches';
									return A2(finish.withError, err, result2.typeInfo);
								} else {
									var _p268 = _user$project$Types$joinManyTypes(_p267._0);
									if (_p268.ctor === 'Err') {
										return A2(finish.withError, _p268._0, result2.typeInfo);
									} else {
										return A2(finish.withType, _p268._0, result2.typeInfo);
									}
								}
							}
						} else {
							var err = A2(
								_elm_lang$core$Basics_ops['++'],
								'pattern is not a union type: ',
								_user$project$LangUnparser$unparseType(_p269));
							return {
								result: _elm_lang$core$Maybe$Nothing,
								typeInfo: A3(_user$project$Types$addTypeErrorAt, _p270.start, err, typeInfo)
							};
						}
					}
				case 'ELet':
					var _p278 = _p227._2;
					var _p277 = _p227._3;
					var _p276 = _p227._5;
					var _p275 = _p227._4;
					var _p271 = {
						ctor: '_Tuple4',
						_0: _p277.val.p__,
						_1: A2(_user$project$Types$lookupTypAnnotation, typeEnv, _p277),
						_2: _p278,
						_3: _p275.val.e__
					};
					_v211_0:
					do {
						if (_p271._1.ctor === 'Nothing') {
							if ((_p271._0.ctor === 'PVar') && (_p271._0._1 === 'dummyPreludeMain')) {
								break _v211_0;
							} else {
								if ((_p271._2 === true) && (_p271._3.ctor === 'EFun')) {
									var _p272 = A2(
										_user$project$Types$newArrowTemplate,
										typeInfo,
										_elm_lang$core$List$length(_p271._3._1));
									var arrow = _p272._0;
									var typeInfo_ = _p272._1;
									var t1 = _user$project$Types$tArrow(arrow);
									var e1_ = A2(
										_user$project$Lang$replaceE__,
										_p275,
										A5(_user$project$Lang$EColonType, _user$project$Lang$space0, _p275, _user$project$Lang$space0, t1, _user$project$Lang$space0));
									var typeEnv_ = A4(_user$project$Types$addRecBinding, true, _p277, t1, typeEnv);
									return A6(_user$project$Types$tsLet, finish.withType, typeInfo_, typeEnv_, _p277, e1_, _p276);
								} else {
									return A6(_user$project$Types$tsLet, finish.withType, typeInfo, typeEnv, _p277, _p275, _p276);
								}
							}
						} else {
							if ((_p271._0.ctor === 'PVar') && (_p271._0._1 === 'dummyPreludeMain')) {
								break _v211_0;
							} else {
								if (_p271._3.ctor === 'EColonType') {
									var _p273 = _p271._1._0;
									if (_elm_lang$core$Native_Utils.eq(_p273, _p271._3._3)) {
										var typeEnv_ = A4(_user$project$Types$addRecBinding, _p278, _p277, _p273, typeEnv);
										return A6(_user$project$Types$tsLet, finish.withType, typeInfo, typeEnv_, _p277, _p275, _p276);
									} else {
										var err = _user$project$Utils$spaces(
											{
												ctor: '::',
												_0: 'checkType',
												_1: {
													ctor: '::',
													_0: _elm_lang$core$Basics$toString(e.val.eid),
													_1: {
														ctor: '::',
														_0: 'Double annotation. Remove one.',
														_1: {ctor: '[]'}
													}
												}
											});
										return A2(finish.withError, err, typeInfo);
									}
								} else {
									var _p274 = _p271._1._0;
									if (!A2(_user$project$Types$isWellFormed, typeEnv, _p274)) {
										var err = _user$project$Utils$spaces(
											{
												ctor: '::',
												_0: _elm_lang$core$Basics$toString(e.val.eid),
												_1: {
													ctor: '::',
													_0: _user$project$Lang$strPos(_p274.start),
													_1: {
														ctor: '::',
														_0: 'Type annotation not well-formed, at def:',
														_1: {
															ctor: '::',
															_0: _elm_lang$core$String$trim(
																_user$project$LangUnparser$unparseType(_p274)),
															_1: {ctor: '[]'}
														}
													}
												}
											});
										if (_user$project$Types$stopAtError) {
											return A2(finish.withError, err, typeInfo);
										} else {
											var t1 = _user$project$Types$tVar('__NO_TYPE__');
											var typeInfo_ = A3(_user$project$Types$addTypeErrorAt, t1.start, err, typeInfo);
											return A7(
												_user$project$Types$tsLetFinishE2,
												finish.withType,
												typeInfo_,
												typeEnv,
												_p277,
												t1,
												_user$project$Types$eInfoOf(_p275),
												_p276);
										}
									} else {
										var typeEnv_ = A4(_user$project$Types$addRecBinding, _p278, _p277, _p274, typeEnv);
										var e1_ = A2(
											_user$project$Lang$replaceE__,
											_p275,
											A5(_user$project$Lang$EColonType, _user$project$Lang$space0, _p275, _user$project$Lang$space0, _p274, _user$project$Lang$space0));
										var e_ = A2(
											_user$project$Lang$replaceE__,
											e,
											A7(_user$project$Lang$ELet, _p227._0, _p227._1, _p278, _p277, e1_, _p276, _p227._6));
										var _v212 = typeInfo,
											_v213 = typeEnv_,
											_v214 = e_;
										typeInfo = _v212;
										typeEnv = _v213;
										e = _v214;
										continue synthesizeType;
									}
								}
							}
						}
					} while(false);
					return {
						result: _elm_lang$core$Maybe$Nothing,
						typeInfo: _elm_lang$core$Native_Utils.update(
							typeInfo,
							{
								preludeTypeEnv: _elm_lang$core$Maybe$Just(typeEnv)
							})
					};
				case 'EComment':
					return _user$project$Types$propagateResult(
						A3(_user$project$Types$synthesizeType, typeInfo, typeEnv, _p227._2));
				case 'EOption':
					return _user$project$Types$propagateResult(
						A3(_user$project$Types$synthesizeType, typeInfo, typeEnv, _p227._4));
				case 'ETyp':
					var _p279 = A3(_user$project$Types$addTypBindings, _p227._1, _p227._2, typeEnv);
					if (_p279.ctor === 'Err') {
						return {result: _elm_lang$core$Maybe$Nothing, typeInfo: typeInfo};
					} else {
						return _user$project$Types$propagateResult(
							A3(_user$project$Types$synthesizeType, typeInfo, _p279._0, _p227._3));
					}
				default:
					var typeEnv_ = {
						ctor: '::',
						_0: A2(_user$project$Types$TypeAlias, _p227._1, _p227._2),
						_1: typeEnv
					};
					return _user$project$Types$propagateResult(
						A3(_user$project$Types$synthesizeType, typeInfo, typeEnv_, _p227._3));
			}
		}
	});
var _user$project$Types$checkType = F4(
	function (typeInfo, typeEnv, e, goalType) {
		checkType:
		while (true) {
			var _p280 = e.val.e__;
			switch (_p280.ctor) {
				case 'EFun':
					var _p281 = _user$project$Types$stripPolymorphicArrow(goalType);
					if (_p281.ctor === 'Nothing') {
						return {typeInfo: typeInfo, result: false};
					} else {
						var _p282 = A3(
							_user$project$Types$addBindings,
							_p280._1,
							_p281._0._1._0,
							A2(_user$project$Types$addTypeVarBindings, _p281._0._0, typeEnv));
						if (_p282.ctor === 'Err') {
							return {
								result: false,
								typeInfo: A3(_user$project$Types$addTypeErrorAt, e.start, _p282._0, typeInfo)
							};
						} else {
							var _v219 = typeInfo,
								_v220 = _p282._0,
								_v221 = _p280._2,
								_v222 = _p281._0._1._1;
							typeInfo = _v219;
							typeEnv = _v220;
							e = _v221;
							goalType = _v222;
							continue checkType;
						}
					}
				case 'EIf':
					var result1 = A4(_user$project$Types$checkType, typeInfo, typeEnv, _p280._1, _user$project$Types$tBool);
					var result2 = A4(_user$project$Types$checkType, result1.typeInfo, typeEnv, _p280._2, goalType);
					var result3 = A4(_user$project$Types$checkType, result2.typeInfo, typeEnv, _p280._3, goalType);
					return {result: result1.result && (result2.result && result3.result), typeInfo: result3.typeInfo};
				case 'ECase':
					var result1 = A3(_user$project$Types$synthesizeType, typeInfo, typeEnv, _p280._1);
					var _p283 = result1.result;
					if (_p283.ctor === 'Nothing') {
						return {result: false, typeInfo: result1.typeInfo};
					} else {
						var result_branches = A3(
							_elm_lang$core$List$foldl,
							F2(
								function (pe, acc) {
									var _p284 = pe.val;
									var pi = _p284._1;
									var ei = _p284._2;
									var _p285 = A2(
										_user$project$Types$addBindingsOne,
										{ctor: '_Tuple2', _0: pi, _1: _p283._0},
										typeEnv);
									if (_p285.ctor === 'Err') {
										return {
											result: false,
											typeInfo: A3(_user$project$Types$addTypeErrorAt, pi.start, _p285._0, acc.typeInfo)
										};
									} else {
										var resulti = A4(_user$project$Types$checkType, acc.typeInfo, _p285._0, ei, goalType);
										return {result: resulti.result && acc.result, typeInfo: resulti.typeInfo};
									}
								}),
							{result: true, typeInfo: result1.typeInfo},
							_p280._2);
						var _p286 = result_branches.result;
						if (_p286 === true) {
							return result_branches;
						} else {
							var err = 'couldn\'t check all branches';
							return {
								result: false,
								typeInfo: A3(_user$project$Types$addTypeErrorAt, e.start, err, result_branches.typeInfo)
							};
						}
					}
				case 'ETypeCase':
					var _p298 = _p280._1;
					var _p287 = A2(_user$project$Types$lookupPat, typeEnv, _p298);
					if (_p287.ctor === 'Nothing') {
						var err = A2(
							_elm_lang$core$Basics_ops['++'],
							'no type for the pattern: ',
							_user$project$LangUnparser$unparsePat(_p298));
						return {
							result: false,
							typeInfo: A3(_user$project$Types$addTypeErrorAt, _p298.start, err, typeInfo)
						};
					} else {
						var _p297 = _p287._0;
						var _p288 = _p297.val;
						if (_p288.ctor === 'TUnion') {
							var _p289 = A3(
								_elm_lang$core$List$foldl,
								F2(
									function (te, _p290) {
										var _p291 = _p290;
										var _p295 = _p291._1;
										var _p294 = _p291._0;
										var _p292 = te.val;
										var ti = _p292._1;
										var ei = _p292._2;
										var _p293 = A4(_user$project$Types$narrowUnionType, _p298, _p294, ti, typeEnv);
										if (_p293.ctor === 'Err') {
											var acc2_ = {
												result: false,
												typeInfo: A3(_user$project$Types$addTypeErrorAt, _p298.start, _p293._0, _p295.typeInfo)
											};
											return {ctor: '_Tuple2', _0: _p294, _1: acc2_};
										} else {
											var resulti = A4(_user$project$Types$checkType, _p295.typeInfo, _p293._0._1, ei, goalType);
											var acc2_ = {result: resulti.result && _p295.result, typeInfo: resulti.typeInfo};
											return {ctor: '_Tuple2', _0: _p293._0._0, _1: acc2_};
										}
									}),
								{
									ctor: '_Tuple2',
									_0: _p288._1,
									_1: {result: true, typeInfo: typeInfo}
								},
								_p280._2);
							var unionResidual = _p289._0;
							var result_branches = _p289._1;
							var _p296 = result_branches.result;
							if (_p296 === true) {
								return result_branches;
							} else {
								var err = 'couldn\'t check all branches';
								return {
									result: false,
									typeInfo: A3(_user$project$Types$addTypeErrorAt, e.start, err, result_branches.typeInfo)
								};
							}
						} else {
							var err = A2(
								_elm_lang$core$Basics_ops['++'],
								'pattern is not a union type: ',
								_user$project$LangUnparser$unparseType(_p297));
							return {
								result: false,
								typeInfo: A3(_user$project$Types$addTypeErrorAt, _p298.start, err, typeInfo)
							};
						}
					}
				case 'EComment':
					var _v231 = typeInfo,
						_v232 = typeEnv,
						_v233 = _p280._2,
						_v234 = goalType;
					typeInfo = _v231;
					typeEnv = _v232;
					e = _v233;
					goalType = _v234;
					continue checkType;
				default:
					var result1 = A3(_user$project$Types$synthesizeType, typeInfo, typeEnv, e);
					var typeInfo1 = result1.typeInfo;
					var _p299 = result1.result;
					if (_p299.ctor === 'Nothing') {
						var err = _user$project$Utils$spaces(
							{
								ctor: '::',
								_0: 'checkType',
								_1: {
									ctor: '::',
									_0: _elm_lang$core$Basics$toString(e.val.eid),
									_1: {
										ctor: '::',
										_0: _elm_lang$core$String$trim(
											_user$project$LangUnparser$unparseType(goalType)),
										_1: {
											ctor: '::',
											_0: 'failed to synthesize a type',
											_1: {ctor: '[]'}
										}
									}
								}
							});
						return {
							result: false,
							typeInfo: A3(_user$project$Types$addTypeErrorAt, e.start, err, typeInfo1)
						};
					} else {
						var result2 = A4(_user$project$Types$checkSubtype, typeInfo1, typeEnv, _p299._0, goalType);
						var _p300 = result2.result;
						if (_p300.ctor === 'Err') {
							var err_ = _user$project$Utils$spaces(
								{
									ctor: '::',
									_0: 'checkType',
									_1: {
										ctor: '::',
										_0: _elm_lang$core$Basics$toString(e.val.eid),
										_1: {
											ctor: '::',
											_0: _p300._0,
											_1: {ctor: '[]'}
										}
									}
								});
							return {
								result: false,
								typeInfo: A3(_user$project$Types$addTypeErrorAt, e.start, err_, result2.typeInfo)
							};
						} else {
							return {result: true, typeInfo: result2.typeInfo};
						}
					}
			}
		}
	});
var _user$project$Types$synthesizeBranchTypes = F2(
	function (typeInfo, list) {
		var _p301 = A3(
			_elm_lang$core$List$foldl,
			F2(
				function (_p303, _p302) {
					var _p304 = _p303;
					var _p305 = _p302;
					var resulti = A3(_user$project$Types$synthesizeType, _p305._1, _p304._0, _p304._1);
					return {
						ctor: '_Tuple2',
						_0: {ctor: '::', _0: resulti.result, _1: _p305._0},
						_1: resulti.typeInfo
					};
				}),
			{
				ctor: '_Tuple2',
				_0: {ctor: '[]'},
				_1: typeInfo
			},
			list);
		var maybeTypes = _p301._0;
		var typeInfo_ = _p301._1;
		return {
			result: _elm_lang$core$List$reverse(maybeTypes),
			typeInfo: typeInfo_
		};
	});
var _user$project$Types$tsAppMono = F5(
	function (finish, typeInfo, typeEnv, eArgs, _p306) {
		var _p307 = _p306;
		var _p315 = _p307._1;
		var _p314 = _p307._0;
		var checkArgs = F2(
			function (argsAndTypes, retType) {
				var _p308 = A3(
					_elm_lang$core$List$foldl,
					F2(
						function (_p310, _p309) {
							var _p311 = _p310;
							var _p312 = _p309;
							var res = A4(_user$project$Types$checkType, _p312._1, typeEnv, _p311._0, _p311._1);
							return {ctor: '_Tuple2', _0: _p312._0 && res.result, _1: res.typeInfo};
						}),
					{ctor: '_Tuple2', _0: true, _1: typeInfo},
					argsAndTypes);
				var argsOkay = _p308._0;
				var typeInfo_ = _p308._1;
				return argsOkay ? A2(finish.withType, retType, typeInfo_) : A2(finish.withError, 'Function arguments don\'t match required types.', typeInfo_);
			});
		var _p313 = {
			ctor: '_Tuple2',
			_0: _elm_lang$core$List$length(eArgs),
			_1: _elm_lang$core$List$length(_p314)
		};
		var nArgs = _p313._0;
		var nTypes = _p313._1;
		if (_elm_lang$core$Native_Utils.eq(nArgs, nTypes)) {
			return A2(
				checkArgs,
				A2(_user$project$Utils$zip, eArgs, _p314),
				_p315);
		} else {
			if (_elm_lang$core$Native_Utils.cmp(nArgs, nTypes) < 0) {
				var argTypes_ = A2(_elm_lang$core$List$take, nArgs, _p314);
				var retType_ = _user$project$Types$tArrow(
					{
						ctor: '_Tuple2',
						_0: A2(_elm_lang$core$List$drop, nArgs, _p314),
						_1: _p315
					});
				return A2(
					checkArgs,
					A2(_user$project$Utils$zip, eArgs, argTypes_),
					retType_);
			} else {
				return A2(finish.withError, 'Too many arguments to this function.', typeInfo);
			}
		}
	});
var _user$project$Types$tsAppPoly = F5(
	function (finish, typeInfo, typeEnv, eArgs, polyArrow) {
		var result = A3(_user$project$Types$synthesizeTypeMany, typeInfo, typeEnv, eArgs);
		var _p316 = _user$project$Utils$projJusts(result.result);
		if (_p316.ctor === 'Nothing') {
			var err = 'Could not typecheck all of the arguments.';
			return A2(finish.withError, err, result.typeInfo);
		} else {
			var result1 = A2(_user$project$Types$instantiatePolyArrowWithConstraintVars, result.typeInfo, polyArrow);
			var result2 = A2(_user$project$Types$instantiateTypesWithConstraintVars, result1.typeInfo, _p316._0);
			var _p317 = result1.result;
			var constraintVars1 = _p317._0;
			var argTypes_ = _p317._1._0;
			var retType_ = _p317._1._1;
			var _p318 = result2.result;
			var constraintVars2 = _p318._0;
			var tActuals_ = _p318._1;
			var typeInfo_ = A2(
				_user$project$Types$addRawConstraints,
				A2(_user$project$Utils$zip, argTypes_, tActuals_),
				result2.typeInfo);
			var constraintVars = A2(_elm_lang$core$Basics_ops['++'], constraintVars1, constraintVars2);
			var result3 = A3(_user$project$Types$solveConstraintsFor, typeInfo_, typeEnv, constraintVars);
			var _p319 = result3.result;
			if (_p319.ctor === 'Err') {
				return A2(finish.withError, _p319._0, typeInfo_);
			} else {
				var _p321 = _p319._0;
				var retType__ = A2(_user$project$Types$applyUnifier, _p321, retType_);
				var _p320 = {
					ctor: '_Tuple2',
					_0: _elm_lang$core$List$length(eArgs),
					_1: _elm_lang$core$List$length(argTypes_)
				};
				var nArgs = _p320._0;
				var nTypes = _p320._1;
				if (_elm_lang$core$Native_Utils.eq(nArgs, nTypes)) {
					return A2(finish.withType, retType__, result3.typeInfo);
				} else {
					if (_elm_lang$core$Native_Utils.cmp(nArgs, nTypes) < 0) {
						var remainingArgTypes_ = A2(
							_elm_lang$core$List$map,
							_user$project$Types$applyUnifier(_p321),
							A2(
								_elm_lang$core$List$drop,
								_elm_lang$core$List$length(eArgs),
								argTypes_));
						return A2(
							finish.withType,
							_user$project$Types$tArrow(
								{ctor: '_Tuple2', _0: remainingArgTypes_, _1: retType__}),
							result3.typeInfo);
					} else {
						return A2(finish.withError, 'Too many arguments to this function.', result3.typeInfo);
					}
				}
			}
		}
	});
var _user$project$Types$synthesizeTypeMany = F3(
	function (typeInfo, typeEnv, es) {
		return A2(
			_user$project$Types$synthesizeBranchTypes,
			typeInfo,
			A2(
				_elm_lang$core$List$map,
				function (ei) {
					return {ctor: '_Tuple2', _0: typeEnv, _1: ei};
				},
				es));
	});
var _user$project$Types$tsFun = F6(
	function (finish, typeInfo, typeEnv, ps, eBody, _p322) {
		var _p323 = _p322;
		var _p327 = _p323._1;
		var _p326 = _p323._0;
		var _p324 = A3(_user$project$Types$addBindings, ps, _p326, typeEnv);
		if (_p324.ctor === 'Err') {
			return A2(finish.withError, _p324._0, typeInfo);
		} else {
			var result1 = A3(_user$project$Types$synthesizeType, typeInfo, _p324._0, eBody);
			var _p325 = result1.result;
			if (_p325.ctor === 'Nothing') {
				return A2(finish.withError, 'can\'t synthesize type for function body', result1.typeInfo);
			} else {
				return A2(
					finish.withType,
					_user$project$Types$tArrow(
						{ctor: '_Tuple2', _0: _p326, _1: _p327}),
					A2(
						_user$project$Types$addRawConstraints,
						{
							ctor: '::',
							_0: {ctor: '_Tuple2', _0: _p327, _1: _p325._0},
							_1: {ctor: '[]'}
						},
						result1.typeInfo));
			}
		}
	});
var _user$project$Types$tsLet = F6(
	function (finishWithType, typeInfo, typeEnv, p, e1, e2) {
		var result1 = A3(_user$project$Types$synthesizeType, typeInfo, typeEnv, e1);
		var _p328 = result1.result;
		if (_p328.ctor === 'Nothing') {
			if (_user$project$Types$stopAtError) {
				return result1;
			} else {
				var t1 = _user$project$Types$tVar('__NO_TYPE__');
				return A7(
					_user$project$Types$tsLetFinishE2,
					finishWithType,
					result1.typeInfo,
					typeEnv,
					p,
					t1,
					_user$project$Types$eInfoOf(e1),
					e2);
			}
		} else {
			var _p331 = _p328._0;
			var result1_ = function () {
				var _p329 = _user$project$Types$isArrowTemplate(_p331);
				if (_p329.ctor === 'Just') {
					return A4(
						_user$project$Types$solveTemplateArrow,
						result1.typeInfo,
						typeEnv,
						_user$project$Types$eInfoOf(e1),
						_p329._0);
				} else {
					return {
						result: _elm_lang$core$Maybe$Just(_p331),
						typeInfo: result1.typeInfo
					};
				}
			}();
			var _p330 = result1_.result;
			if (_p330.ctor === 'Just') {
				return A7(
					_user$project$Types$tsLetFinishE2,
					finishWithType,
					result1_.typeInfo,
					typeEnv,
					p,
					_p330._0,
					_user$project$Types$eInfoOf(e1),
					e2);
			} else {
				if (_user$project$Types$stopAtError) {
					return result1_;
				} else {
					var t1_ = _user$project$Types$tVar('__NO_TYPE__');
					return A7(
						_user$project$Types$tsLetFinishE2,
						finishWithType,
						result1_.typeInfo,
						typeEnv,
						p,
						t1_,
						_user$project$Types$eInfoOf(e1),
						e2);
				}
			}
		}
	});
var _user$project$Types$tsLetFinishE2 = F7(
	function (finishWithType, typeInfo, typeEnv, p, t1, eInfo1, e2) {
		if (!_user$project$Types$sanityChecks) {
			return A7(_user$project$Types$tsLetFinishE2_, finishWithType, typeInfo, typeEnv, p, t1, eInfo1.val, e2);
		} else {
			if (A2(_user$project$Types$isWellFormed, typeEnv, t1)) {
				return A7(_user$project$Types$tsLetFinishE2_, finishWithType, typeInfo, typeEnv, p, t1, eInfo1.val, e2);
			} else {
				var err = _user$project$Utils$spaces(
					{
						ctor: '::',
						_0: '[TYPE SYSTEM BUG]',
						_1: {
							ctor: '::',
							_0: _elm_lang$core$Basics$toString(eInfo1.val),
							_1: {
								ctor: '::',
								_0: _user$project$Lang$strPos(t1.start),
								_1: {
									ctor: '::',
									_0: 'Synthesized type not well-formed:',
									_1: {
										ctor: '::',
										_0: _elm_lang$core$String$trim(
											_user$project$LangUnparser$unparseType(t1)),
										_1: {ctor: '[]'}
									}
								}
							}
						}
					});
				var typeInfo_ = A3(_user$project$Types$addTypeErrorAt, eInfo1.start, err, typeInfo);
				return _user$project$Types$stopAtError ? {result: _elm_lang$core$Maybe$Nothing, typeInfo: typeInfo_} : A7(_user$project$Types$tsLetFinishE2_, finishWithType, typeInfo_, typeEnv, p, t1, eInfo1.val, e2);
			}
		}
	});
var _user$project$Types$tsLetFinishE2_ = F7(
	function (finishWithType, typeInfo, typeEnv, p, t1, e1eid, e2) {
		var _p332 = A3(
			_user$project$Types$addBindings,
			{
				ctor: '::',
				_0: p,
				_1: {ctor: '[]'}
			},
			{
				ctor: '::',
				_0: t1,
				_1: {ctor: '[]'}
			},
			typeEnv);
		if (_p332.ctor === 'Err') {
			return {
				result: _elm_lang$core$Maybe$Nothing,
				typeInfo: A3(_user$project$Types$addTypeErrorAt, p.start, _p332._0, typeInfo)
			};
		} else {
			var typeInfo_ = A3(
				_user$project$Types$addNamedExp,
				p,
				e1eid,
				A3(
					_user$project$Types$addFinalType,
					e1eid,
					_elm_lang$core$Maybe$Just(t1),
					typeInfo));
			var result2 = A3(_user$project$Types$synthesizeType, typeInfo_, _p332._0, e2);
			var _p333 = result2.result;
			if (_p333.ctor === 'Nothing') {
				return {result: _elm_lang$core$Maybe$Nothing, typeInfo: result2.typeInfo};
			} else {
				return A2(finishWithType, _p333._0, result2.typeInfo);
			}
		}
	});
var _user$project$Types$typecheck = function (e) {
	var _p334 = A2(_user$project$Types$debugLog, 'TYPE CHECKING', '...');
	var result = A3(_user$project$Types$synthesizeType, _user$project$Types$initTypeInfo, _user$project$Types$preludeTypeEnv, e);
	var _p335 = _user$project$Types$displayTypeInfo(result.typeInfo);
	return _user$project$Types$aceTypeInfo(result.typeInfo);
};

var _user$project$Eval$btString = function (bt) {
	var _p0 = bt;
	if (_p0.ctor === '[]') {
		return '';
	} else {
		var singleLineExpStrs = A2(
			_elm_lang$core$String$join,
			'\n',
			_elm_lang$core$List$reverse(
				A2(
					_elm_lang$core$List$map,
					function (_p1) {
						return _user$project$Utils$head_(
							_elm_lang$core$String$lines(
								_elm_lang$core$String$trimLeft(
									_user$project$LangUnparser$unparse(_p1))));
					},
					_p0._1)));
		return A2(
			_elm_lang$core$Basics_ops['++'],
			singleLineExpStrs,
			A2(
				_elm_lang$core$Basics_ops['++'],
				'\n',
				_user$project$LangUnparser$unparse(_p0._0)));
	}
};
var _user$project$Eval$errorWithBacktrace = F2(
	function (bt, message) {
		return _user$project$Lang$errorMsg(
			A2(
				_elm_lang$core$Basics_ops['++'],
				_user$project$Eval$btString(bt),
				A2(_elm_lang$core$Basics_ops['++'], '\n', message)));
	});
var _user$project$Eval$crashWithBacktrace = F2(
	function (bt, message) {
		return _user$project$Lang$crashWithMsg(
			A2(
				_elm_lang$core$Basics_ops['++'],
				_user$project$Eval$btString(bt),
				A2(_elm_lang$core$Basics_ops['++'], '\n', message)));
	});
var _user$project$Eval$postProcessWidgets = function (widgets) {
	var dedupedWidgets = A2(_user$project$Utils$dedupBy, _elm_lang$core$Basics$toString, widgets);
	var _p2 = A2(
		_elm_lang$core$List$partition,
		function (widget) {
			var _p3 = widget;
			switch (_p3.ctor) {
				case 'WIntSlider':
					if (_p3._5 === false) {
						return true;
					} else {
						return false;
					}
				case 'WNumSlider':
					if (_p3._5 === false) {
						return true;
					} else {
						return false;
					}
				case 'WPoint':
					return false;
				default:
					return false;
			}
		},
		dedupedWidgets);
	var rangeWidgets = _p2._0;
	var pointWidgets = _p2._1;
	return A2(_elm_lang$core$Basics_ops['++'], rangeWidgets, pointWidgets);
};
var _user$project$Eval$valToDictKey = F2(
	function (bt, val_) {
		var _p4 = val_;
		_v2_5:
		do {
			switch (_p4.ctor) {
				case 'VConst':
					if (_p4._1.ctor === '_Tuple2') {
						return _elm_lang$core$Result$Ok(
							{
								ctor: '_Tuple2',
								_0: _elm_lang$core$Basics$toString(_p4._1._0),
								_1: 'num'
							});
					} else {
						break _v2_5;
					}
				case 'VBase':
					switch (_p4._0.ctor) {
						case 'VBool':
							return _elm_lang$core$Result$Ok(
								{
									ctor: '_Tuple2',
									_0: _elm_lang$core$Basics$toString(_p4._0._0),
									_1: 'bool'
								});
						case 'VString':
							return _elm_lang$core$Result$Ok(
								{
									ctor: '_Tuple2',
									_0: _elm_lang$core$Basics$toString(_p4._0._0),
									_1: 'string'
								});
						default:
							return _elm_lang$core$Result$Ok(
								{ctor: '_Tuple2', _0: '', _1: 'null'});
					}
				case 'VList':
					return A2(
						_elm_lang$core$Result$map,
						function (keyStrings) {
							return {
								ctor: '_Tuple2',
								_0: _elm_lang$core$Basics$toString(keyStrings),
								_1: 'list'
							};
						},
						_user$project$Utils$projOk(
							A2(
								_elm_lang$core$List$map,
								function (_p5) {
									return A2(
										_user$project$Eval$valToDictKey,
										bt,
										function (_) {
											return _.v_;
										}(_p5));
								},
								_p4._0)));
				default:
					break _v2_5;
			}
		} while(false);
		return A2(
			_user$project$Eval$errorWithBacktrace,
			bt,
			A2(
				_elm_lang$core$Basics_ops['++'],
				'Cannot use ',
				A2(
					_elm_lang$core$Basics_ops['++'],
					_user$project$Lang$strVal(
						_user$project$Lang$val(val_)),
					' in a key to a dictionary.')));
	});
var _user$project$Eval$eBaseToVBase = function (eBaseVal) {
	var _p6 = eBaseVal;
	switch (_p6.ctor) {
		case 'EBool':
			return _user$project$Lang$VBool(_p6._0);
		case 'EString':
			return _user$project$Lang$VString(_p6._1);
		default:
			return _user$project$Lang$VNull;
	}
};
var _user$project$Eval$evalDelta = F3(
	function (bt, op, is) {
		var _p7 = {ctor: '_Tuple2', _0: op, _1: is};
		_v4_16:
		do {
			if (_p7.ctor === '_Tuple2') {
				if (_p7._1.ctor === '::') {
					if (_p7._1._1.ctor === '::') {
						if (_p7._1._1._1.ctor === '[]') {
							switch (_p7._0.ctor) {
								case 'Plus':
									return A2(
										F2(
											function (x, y) {
												return x + y;
											}),
										_p7._1._0,
										_p7._1._1._0);
								case 'Minus':
									return A2(
										F2(
											function (x, y) {
												return x - y;
											}),
										_p7._1._0,
										_p7._1._1._0);
								case 'Mult':
									return A2(
										F2(
											function (x, y) {
												return x * y;
											}),
										_p7._1._0,
										_p7._1._1._0);
								case 'Div':
									return A2(
										F2(
											function (x, y) {
												return x / y;
											}),
										_p7._1._0,
										_p7._1._1._0);
								case 'Pow':
									return A2(
										F2(
											function (x, y) {
												return Math.pow(x, y);
											}),
										_p7._1._0,
										_p7._1._1._0);
								case 'Mod':
									return _elm_lang$core$Basics$toFloat(
										A2(
											F2(
												function (x, y) {
													return A2(_elm_lang$core$Basics_ops['%'], x, y);
												}),
											_elm_lang$core$Basics$floor(_p7._1._0),
											_elm_lang$core$Basics$floor(_p7._1._1._0)));
								case 'ArcTan2':
									return A2(_elm_lang$core$Basics$atan2, _p7._1._0, _p7._1._1._0);
								default:
									break _v4_16;
							}
						} else {
							break _v4_16;
						}
					} else {
						switch (_p7._0.ctor) {
							case 'Cos':
								return _elm_lang$core$Basics$cos(_p7._1._0);
							case 'Sin':
								return _elm_lang$core$Basics$sin(_p7._1._0);
							case 'ArcCos':
								return _elm_lang$core$Basics$acos(_p7._1._0);
							case 'ArcSin':
								return _elm_lang$core$Basics$asin(_p7._1._0);
							case 'Floor':
								return _elm_lang$core$Basics$toFloat(
									_elm_lang$core$Basics$floor(_p7._1._0));
							case 'Ceil':
								return _elm_lang$core$Basics$toFloat(
									_elm_lang$core$Basics$ceiling(_p7._1._0));
							case 'Round':
								return _elm_lang$core$Basics$toFloat(
									_elm_lang$core$Basics$round(_p7._1._0));
							case 'Sqrt':
								return _elm_lang$core$Basics$sqrt(_p7._1._0);
							default:
								break _v4_16;
						}
					}
				} else {
					if (_p7._0.ctor === 'Pi') {
						return _elm_lang$core$Basics$pi;
					} else {
						break _v4_16;
					}
				}
			} else {
				break _v4_16;
			}
		} while(false);
		return A2(
			_user$project$Eval$crashWithBacktrace,
			bt,
			A2(
				_elm_lang$core$Basics_ops['++'],
				'Little evaluator bug: Eval.evalDelta ',
				_user$project$Lang$strOp(op)));
	});
var _user$project$Eval$mkCap = F2(
	function (mcap, l) {
		var s = function () {
			var _p8 = {ctor: '_Tuple2', _0: mcap, _1: l};
			if (_p8._0.ctor === 'Just') {
				return _p8._0._0.val;
			} else {
				if (_p8._1._2 === '') {
					return _user$project$Lang$strLoc(l);
				} else {
					return _p8._1._2;
				}
			}
		}();
		return A2(_elm_lang$core$Basics_ops['++'], s, ': ');
	});
var _user$project$Eval$lookupVar = F4(
	function (env, bt, x, pos) {
		var _p9 = A2(_user$project$Utils$maybeFind, x, env);
		if (_p9.ctor === 'Just') {
			return _elm_lang$core$Result$Ok(_p9._0);
		} else {
			return A2(
				_user$project$Eval$errorWithBacktrace,
				bt,
				A2(
					_elm_lang$core$Basics_ops['++'],
					_user$project$Lang$strPos(pos),
					A2(
						_elm_lang$core$Basics_ops['++'],
						' variable not found: ',
						A2(
							_elm_lang$core$Basics_ops['++'],
							x,
							A2(
								_elm_lang$core$Basics_ops['++'],
								'\nVariables in scope: ',
								A2(
									_elm_lang$core$String$join,
									' ',
									A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$first, env)))))));
		}
	});
var _user$project$Eval$typeCaseMatch = F4(
	function (env, bt, pat, tipe) {
		var _p10 = {ctor: '_Tuple2', _0: pat.val.p__, _1: tipe.val};
		_v7_2:
		do {
			if (_p10.ctor === '_Tuple2') {
				switch (_p10._0.ctor) {
					case 'PList':
						if ((_p10._0._3.ctor === 'Nothing') && (_p10._1.ctor === 'TTuple')) {
							var _p16 = _p10._1._1;
							var _p15 = _p10._0._1;
							var typeListsMatch = A2(
								_elm_lang$core$Result$map,
								function (bools) {
									return A2(
										_elm_lang$core$List$all,
										F2(
											function (x, y) {
												return _elm_lang$core$Native_Utils.eq(x, y);
											})(true),
										bools);
								},
								_user$project$Utils$projOk(
									A2(
										_elm_lang$core$List$map,
										function (_p11) {
											var _p12 = _p11;
											return A4(_user$project$Eval$typeCaseMatch, env, bt, _p12._0, _p12._1);
										},
										A2(_user$project$Utils$zip, _p15, _p16))));
							var _p13 = typeListsMatch;
							if (_p13.ctor === 'Err') {
								return _elm_lang$core$Result$Err(_p13._0);
							} else {
								if (_p13._0 === false) {
									return _elm_lang$core$Result$Ok(false);
								} else {
									var _p14 = _p10._1._3;
									if (_p14.ctor === 'Nothing') {
										return _elm_lang$core$Result$Ok(
											_elm_lang$core$Native_Utils.eq(
												_elm_lang$core$List$length(_p15),
												_elm_lang$core$List$length(_p16)));
									} else {
										return (_elm_lang$core$Native_Utils.cmp(
											_elm_lang$core$List$length(_p15),
											_elm_lang$core$List$length(_p16)) > -1) ? A2(
											_elm_lang$core$Result$map,
											function (bools) {
												return A2(
													_elm_lang$core$List$all,
													F2(
														function (x, y) {
															return _elm_lang$core$Native_Utils.eq(x, y);
														})(true),
													bools);
											},
											_user$project$Utils$projOk(
												A2(
													_elm_lang$core$List$map,
													function (p) {
														return A4(_user$project$Eval$typeCaseMatch, env, bt, p, _p14._0);
													},
													A2(
														_elm_lang$core$List$drop,
														_elm_lang$core$List$length(_p16),
														_p15)))) : _elm_lang$core$Result$Ok(false);
									}
								}
							}
						} else {
							break _v7_2;
						}
					case 'PVar':
						return A2(
							_elm_lang$core$Result$map,
							function (val) {
								return A2(_user$project$Types$valIsType, val, tipe);
							},
							A4(_user$project$Eval$lookupVar, env, bt, _p10._0._1, pat.start));
					default:
						break _v7_2;
				}
			} else {
				break _v7_2;
			}
		} while(false);
		return A2(
			_user$project$Eval$errorWithBacktrace,
			bt,
			A2(
				_elm_lang$core$Basics_ops['++'],
				'unexpected pattern in typecase: ',
				A2(
					_elm_lang$core$Basics_ops['++'],
					_user$project$LangUnparser$unparsePat(pat),
					'\n\nAllowed patterns are bare identifiers and [ident1 ident2 ...]')));
	});
var _user$project$Eval$match = function (_p17) {
	var _p18 = _p17;
	var _p27 = _p18._1;
	var _p26 = _p18._0;
	var _p19 = {ctor: '_Tuple2', _0: _p26.val.p__, _1: _p27.v_};
	_v12_7:
	do {
		_v12_4:
		do {
			if (_p19.ctor === '_Tuple2') {
				switch (_p19._0.ctor) {
					case 'PVar':
						return _elm_lang$core$Maybe$Just(
							{
								ctor: '::',
								_0: {ctor: '_Tuple2', _0: _p19._0._1, _1: _p27},
								_1: {ctor: '[]'}
							});
					case 'PAs':
						var _p20 = _user$project$Eval$match(
							{ctor: '_Tuple2', _0: _p19._0._3, _1: _p27});
						if (_p20.ctor === 'Just') {
							return _elm_lang$core$Maybe$Just(
								{
									ctor: '::',
									_0: {ctor: '_Tuple2', _0: _p19._0._1, _1: _p27},
									_1: _p20._0
								});
						} else {
							return _elm_lang$core$Maybe$Nothing;
						}
					case 'PList':
						if (_p19._0._3.ctor === 'Nothing') {
							if (_p19._1.ctor === 'VList') {
								return A2(
									_user$project$Utils$bindMaybe,
									_user$project$Eval$matchList,
									A2(_user$project$Utils$maybeZip, _p19._0._1, _p19._1._0));
							} else {
								break _v12_4;
							}
						} else {
							if (_p19._1.ctor === 'VList') {
								var _p24 = _p19._1._0;
								var _p23 = _p19._0._1;
								var _p21 = {
									ctor: '_Tuple2',
									_0: _elm_lang$core$List$length(_p23),
									_1: _elm_lang$core$List$length(_p24)
								};
								var n = _p21._0;
								var m = _p21._1;
								if (_elm_lang$core$Native_Utils.cmp(n, m) > 0) {
									return _elm_lang$core$Maybe$Nothing;
								} else {
									var _p22 = A2(_user$project$Utils$split, n, _p24);
									var vs1 = _p22._0;
									var vs2 = _p22._1;
									return A2(
										_user$project$Eval$cons,
										{
											ctor: '_Tuple2',
											_0: _p19._0._3._0,
											_1: _user$project$Lang$vList(vs2)
										},
										_user$project$Eval$matchList(
											A2(_user$project$Utils$zip, _p23, vs1)));
								}
							} else {
								break _v12_4;
							}
						}
					case 'PConst':
						if ((_p19._1.ctor === 'VConst') && (_p19._1._1.ctor === '_Tuple2')) {
							return _elm_lang$core$Native_Utils.eq(_p19._0._1, _p19._1._1._0) ? _elm_lang$core$Maybe$Just(
								{ctor: '[]'}) : _elm_lang$core$Maybe$Nothing;
						} else {
							break _v12_7;
						}
					default:
						if (_p19._1.ctor === 'VBase') {
							return _elm_lang$core$Native_Utils.eq(
								_user$project$Eval$eBaseToVBase(_p19._0._1),
								_p19._1._0) ? _elm_lang$core$Maybe$Just(
								{ctor: '[]'}) : _elm_lang$core$Maybe$Nothing;
						} else {
							break _v12_7;
						}
				}
			} else {
				break _v12_7;
			}
		} while(false);
		return _elm_lang$core$Maybe$Nothing;
	} while(false);
	return _elm_lang$core$Native_Utils.crashCase(
		'Eval',
		{
			start: {line: 19, column: 15},
			end: {line: 37, column: 111}
		},
		_p19)(
		A2(
			_elm_lang$core$Basics_ops['++'],
			'Little evaluator bug: Eval.match ',
			A2(
				_elm_lang$core$Basics_ops['++'],
				_elm_lang$core$Basics$toString(_p26.val.p__),
				A2(
					_elm_lang$core$Basics_ops['++'],
					' vs ',
					_elm_lang$core$Basics$toString(_p27.v_)))));
};
var _user$project$Eval$cons = F2(
	function (pv, menv) {
		var _p28 = {
			ctor: '_Tuple2',
			_0: menv,
			_1: _user$project$Eval$match(pv)
		};
		if (((_p28.ctor === '_Tuple2') && (_p28._0.ctor === 'Just')) && (_p28._1.ctor === 'Just')) {
			return _elm_lang$core$Maybe$Just(
				A2(_elm_lang$core$Basics_ops['++'], _p28._1._0, _p28._0._0));
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$Eval$matchList = function (pvs) {
	return A3(
		_elm_lang$core$List$foldl,
		F2(
			function (pv, acc) {
				var _p29 = {
					ctor: '_Tuple2',
					_0: acc,
					_1: _user$project$Eval$match(pv)
				};
				if (((_p29.ctor === '_Tuple2') && (_p29._0.ctor === 'Just')) && (_p29._1.ctor === 'Just')) {
					return _elm_lang$core$Maybe$Just(
						A2(_elm_lang$core$Basics_ops['++'], _p29._1._0, _p29._0._0));
				} else {
					return _elm_lang$core$Maybe$Nothing;
				}
			}),
		_elm_lang$core$Maybe$Just(
			{ctor: '[]'}),
		pvs);
};
var _user$project$Eval$evalBranches = F4(
	function (env, bt, v, bs) {
		return A3(
			_elm_lang$core$List$foldl,
			F2(
				function (_p30, acc) {
					var _p31 = _p30;
					var _p32 = {
						ctor: '_Tuple2',
						_0: acc,
						_1: A2(
							_user$project$Eval$cons,
							{ctor: '_Tuple2', _0: _p31._1, _1: v},
							_elm_lang$core$Maybe$Just(env))
					};
					_v17_3:
					do {
						if (_p32.ctor === '_Tuple2') {
							if (_p32._0.ctor === 'Ok') {
								if (_p32._0._0.ctor === 'Just') {
									return acc;
								} else {
									if (_p32._1.ctor === 'Just') {
										return A2(
											_elm_lang$core$Result$map,
											_elm_lang$core$Maybe$Just,
											A3(_user$project$Eval$eval_, _p32._1._0, bt, _p31._2));
									} else {
										break _v17_3;
									}
								}
							} else {
								return acc;
							}
						} else {
							break _v17_3;
						}
					} while(false);
					return _elm_lang$core$Result$Ok(_elm_lang$core$Maybe$Nothing);
				}),
			_elm_lang$core$Result$Ok(_elm_lang$core$Maybe$Nothing),
			A2(
				_elm_lang$core$List$map,
				function (_) {
					return _.val;
				},
				bs));
	});
var _user$project$Eval$eval_ = F3(
	function (env, bt, e) {
		return A2(
			_elm_lang$core$Result$map,
			_elm_lang$core$Tuple$first,
			A3(_user$project$Eval$eval, env, bt, e));
	});
var _user$project$Eval$eval = F3(
	function (env, bt, e) {
		$eval:
		while (true) {
			var ret = function (v_) {
				return {
					ctor: '_Tuple2',
					_0: {
						ctor: '_Tuple2',
						_0: A2(
							_user$project$Lang$Val,
							v_,
							{
								ctor: '::',
								_0: e.val.eid,
								_1: {ctor: '[]'}
							}),
						_1: {ctor: '[]'}
					},
					_1: env
				};
			};
			var retAdd = F2(
				function (eid, _p33) {
					var _p34 = _p33;
					var _p35 = _p34._0;
					return {
						ctor: '_Tuple2',
						_0: {
							ctor: '_Tuple2',
							_0: A2(
								_user$project$Lang$Val,
								_p35.v_,
								{ctor: '::', _0: eid, _1: _p35.vtrace}),
							_1: {ctor: '[]'}
						},
						_1: _p34._1
					};
				});
			var retAddWs = F2(
				function (eid, _p36) {
					var _p37 = _p36;
					var _p38 = _p37._0._0;
					return {
						ctor: '_Tuple2',
						_0: {
							ctor: '_Tuple2',
							_0: A2(
								_user$project$Lang$Val,
								_p38.v_,
								{ctor: '::', _0: eid, _1: _p38.vtrace}),
							_1: _p37._0._1
						},
						_1: _p37._1
					};
				});
			var retAddThis_ = function (_p39) {
				var _p40 = _p39;
				return A2(
					retAdd,
					e.val.eid,
					{ctor: '_Tuple2', _0: _p40._0, _1: _p40._1});
			};
			var retAddThis = function (v) {
				return retAddThis_(
					{ctor: '_Tuple2', _0: v, _1: env});
			};
			var retBoth = function (_p41) {
				var _p42 = _p41;
				var _p43 = _p42._0;
				return {
					ctor: '_Tuple2',
					_0: {
						ctor: '_Tuple2',
						_0: _elm_lang$core$Native_Utils.update(
							_p43,
							{
								vtrace: {ctor: '::', _0: e.val.eid, _1: _p43.vtrace}
							}),
						_1: _p42._1
					},
					_1: env
				};
			};
			var addWidgets = F2(
				function (ws1, _p44) {
					var _p45 = _p44;
					return {
						ctor: '_Tuple2',
						_0: {
							ctor: '_Tuple2',
							_0: _p45._0._0,
							_1: A2(_elm_lang$core$Basics_ops['++'], ws1, _p45._0._1)
						},
						_1: _p45._1
					};
				});
			var bt_ = (_elm_lang$core$Native_Utils.cmp(e.start.line, 1) > -1) ? {ctor: '::', _0: e, _1: bt} : bt;
			var _p46 = e.val.e__;
			switch (_p46.ctor) {
				case 'EConst':
					var _p49 = _p46._2;
					var _p48 = _p46._1;
					var v_ = A2(
						_user$project$Lang$VConst,
						_elm_lang$core$Maybe$Nothing,
						{
							ctor: '_Tuple2',
							_0: _p48,
							_1: _user$project$Lang$TrLoc(_p49)
						});
					var _p47 = _p46._3.val;
					switch (_p47.ctor) {
						case 'NoWidgetDecl':
							return _elm_lang$core$Result$Ok(
								ret(v_));
						case 'IntSlider':
							return _elm_lang$core$Result$Ok(
								retBoth(
									{
										ctor: '_Tuple2',
										_0: A2(
											_user$project$Lang$Val,
											v_,
											{ctor: '[]'}),
										_1: {
											ctor: '::',
											_0: A6(
												_user$project$Lang$WIntSlider,
												_p47._0.val,
												_p47._2.val,
												A2(_user$project$Eval$mkCap, _p47._3, _p49),
												_elm_lang$core$Basics$floor(_p48),
												_p49,
												_p47._4),
											_1: {ctor: '[]'}
										}
									}));
						default:
							return _elm_lang$core$Result$Ok(
								retBoth(
									{
										ctor: '_Tuple2',
										_0: A2(
											_user$project$Lang$Val,
											v_,
											{ctor: '[]'}),
										_1: {
											ctor: '::',
											_0: A6(
												_user$project$Lang$WNumSlider,
												_p47._0.val,
												_p47._2.val,
												A2(_user$project$Eval$mkCap, _p47._3, _p49),
												_p48,
												_p49,
												_p47._4),
											_1: {ctor: '[]'}
										}
									}));
					}
				case 'EBase':
					return _elm_lang$core$Result$Ok(
						ret(
							_user$project$Lang$VBase(
								_user$project$Eval$eBaseToVBase(_p46._1))));
				case 'EVar':
					return A2(
						_elm_lang$core$Result$map,
						retAddThis,
						A4(
							_user$project$Eval$lookupVar,
							env,
							{ctor: '::', _0: e, _1: bt},
							_p46._1,
							e.start));
				case 'EOp':
					return A2(
						_elm_lang$core$Result$map,
						function (res) {
							return A2(
								retAddWs,
								e.val.eid,
								{ctor: '_Tuple2', _0: res, _1: env});
						},
						A4(
							_user$project$Eval$evalOp,
							env,
							{ctor: '::', _0: e, _1: bt},
							_p46._1,
							_p46._2));
				case 'EList':
					var _p50 = _user$project$Utils$projOk(
						A2(
							_elm_lang$core$List$map,
							A2(_user$project$Eval$eval_, env, bt_),
							_p46._1));
					if (_p50.ctor === 'Err') {
						return _elm_lang$core$Result$Err(_p50._0);
					} else {
						var _p51 = _elm_lang$core$List$unzip(_p50._0);
						var vs = _p51._0;
						var wss = _p51._1;
						var ws = _elm_lang$core$List$concat(wss);
						var _p52 = _p46._3;
						if (_p52.ctor === 'Nothing') {
							return _elm_lang$core$Result$Ok(
								retBoth(
									{
										ctor: '_Tuple2',
										_0: A2(
											_user$project$Lang$Val,
											_user$project$Lang$VList(vs),
											{ctor: '[]'}),
										_1: ws
									}));
						} else {
							var _p55 = _p52._0;
							var _p53 = A3(_user$project$Eval$eval_, env, bt_, _p55);
							if (_p53.ctor === 'Err') {
								return _elm_lang$core$Result$Err(_p53._0);
							} else {
								var _p54 = _p53._0._0.v_;
								if (_p54.ctor === 'VList') {
									return _elm_lang$core$Result$Ok(
										retBoth(
											{
												ctor: '_Tuple2',
												_0: A2(
													_user$project$Lang$Val,
													_user$project$Lang$VList(
														A2(_elm_lang$core$Basics_ops['++'], vs, _p54._0)),
													{ctor: '[]'}),
												_1: A2(_elm_lang$core$Basics_ops['++'], ws, _p53._0._1)
											}));
								} else {
									return A2(
										_user$project$Eval$errorWithBacktrace,
										{ctor: '::', _0: e, _1: bt},
										A2(
											_elm_lang$core$Basics_ops['++'],
											_user$project$Lang$strPos(_p55.start),
											' rest expression not a list.'));
								}
							}
						}
					}
				case 'EIf':
					var _p59 = _p46._1;
					var _p56 = A3(_user$project$Eval$eval_, env, bt, _p59);
					if (_p56.ctor === 'Err') {
						return _elm_lang$core$Result$Err(_p56._0);
					} else {
						var _p58 = _p56._0._1;
						var _p57 = _p56._0._0.v_;
						if ((_p57.ctor === 'VBase') && (_p57._0.ctor === 'VBool')) {
							if (_p57._0._0 === true) {
								return A2(
									_elm_lang$core$Result$map,
									addWidgets(_p58),
									A3(_user$project$Eval$eval, env, bt, _p46._2));
							} else {
								return A2(
									_elm_lang$core$Result$map,
									addWidgets(_p58),
									A3(_user$project$Eval$eval, env, bt, _p46._3));
							}
						} else {
							return A2(
								_user$project$Eval$errorWithBacktrace,
								{ctor: '::', _0: e, _1: bt},
								A2(
									_elm_lang$core$Basics_ops['++'],
									_user$project$Lang$strPos(_p59.start),
									' if-exp expected a Bool but got something else.'));
						}
					}
				case 'ECase':
					var _p62 = _p46._1;
					var _p60 = A3(
						_user$project$Eval$eval_,
						env,
						{ctor: '::', _0: e, _1: bt},
						_p62);
					if (_p60.ctor === 'Err') {
						return _elm_lang$core$Result$Err(_p60._0);
					} else {
						var _p61 = A4(
							_user$project$Eval$evalBranches,
							env,
							{ctor: '::', _0: e, _1: bt},
							_p60._0._0,
							_p46._2);
						if (_p61.ctor === 'Ok') {
							if ((_p61._0.ctor === 'Just') && (_p61._0._0.ctor === '_Tuple2')) {
								return _elm_lang$core$Result$Ok(
									retBoth(
										{
											ctor: '_Tuple2',
											_0: _p61._0._0._0,
											_1: A2(_elm_lang$core$Basics_ops['++'], _p60._0._1, _p61._0._0._1)
										}));
							} else {
								return A2(
									_user$project$Eval$errorWithBacktrace,
									{ctor: '::', _0: e, _1: bt},
									A2(
										_elm_lang$core$Basics_ops['++'],
										_user$project$Lang$strPos(_p62.start),
										' non-exhaustive case statement'));
							}
						} else {
							return _elm_lang$core$Result$Err(_p61._0);
						}
					}
				case 'ETypeCase':
					var _p64 = _p46._1;
					var _p63 = A4(
						_user$project$Eval$evalTBranches,
						env,
						{ctor: '::', _0: e, _1: bt},
						_p64,
						_p46._2);
					if (_p63.ctor === 'Ok') {
						if ((_p63._0.ctor === 'Just') && (_p63._0._0.ctor === '_Tuple2')) {
							return _elm_lang$core$Result$Ok(
								retBoth(
									{ctor: '_Tuple2', _0: _p63._0._0._0, _1: _p63._0._0._1}));
						} else {
							return A2(
								_user$project$Eval$errorWithBacktrace,
								{ctor: '::', _0: e, _1: bt},
								A2(
									_elm_lang$core$Basics_ops['++'],
									_user$project$Lang$strPos(_p64.start),
									' non-exhaustive typecase statement'));
						}
					} else {
						return _elm_lang$core$Result$Err(_p63._0);
					}
				case 'ELet':
					if (_p46._2 === false) {
						var _p78 = _p46._3;
						var _p73 = A3(_user$project$Eval$eval_, env, bt_, _p46._4);
						if (_p73.ctor === 'Err') {
							return _elm_lang$core$Result$Err(_p73._0);
						} else {
							var _p77 = _p73._0._0;
							var _p74 = A2(
								_user$project$Eval$cons,
								{ctor: '_Tuple2', _0: _p78, _1: _p77},
								_elm_lang$core$Maybe$Just(env));
							if (_p74.ctor === 'Just') {
								return A2(
									_elm_lang$core$Result$map,
									function (_p75) {
										return A2(
											addWidgets,
											_p73._0._1,
											A2(retAddWs, e.val.eid, _p75));
									},
									A3(_user$project$Eval$eval, _p74._0, bt_, _p46._5));
							} else {
								return A2(
									_user$project$Eval$errorWithBacktrace,
									{ctor: '::', _0: e, _1: bt},
									A2(
										_elm_lang$core$Basics_ops['++'],
										_user$project$Lang$strPos(e.start),
										A2(
											_elm_lang$core$Basics_ops['++'],
											' could not match pattern ',
											A2(
												_elm_lang$core$Basics_ops['++'],
												function (_p76) {
													return _user$project$Utils$squish(
														_user$project$LangUnparser$unparsePat(_p76));
												}(_p78),
												A2(
													_elm_lang$core$Basics_ops['++'],
													' with ',
													_user$project$Lang$strVal(_p77))))));
							}
						}
					} else {
						var _p85 = _p46._4;
						var _p79 = A3(_user$project$Eval$eval_, env, bt_, _p85);
						if (_p79.ctor === 'Err') {
							return _elm_lang$core$Result$Err(_p79._0);
						} else {
							var _p84 = _p79._0._0;
							var _p80 = {ctor: '_Tuple2', _0: _p46._3.val.p__, _1: _p84.v_};
							_v37_2:
							do {
								if (_p80.ctor === '_Tuple2') {
									switch (_p80._0.ctor) {
										case 'PVar':
											if ((_p80._1.ctor === 'VClosure') && (_p80._1._0.ctor === 'Nothing')) {
												var _p83 = _p80._0._1;
												var _p81 = A2(
													_user$project$Utils$assert,
													'eval letrec',
													_elm_lang$core$Native_Utils.eq(env, _p80._1._3));
												var v1_ = A2(
													_user$project$Lang$Val,
													A4(
														_user$project$Lang$VClosure,
														_elm_lang$core$Maybe$Just(_p83),
														_p80._1._1,
														_p80._1._2,
														env),
													_p84.vtrace);
												var _p82 = A2(
													_user$project$Eval$cons,
													{
														ctor: '_Tuple2',
														_0: _user$project$Lang$pVar(_p83),
														_1: v1_
													},
													_elm_lang$core$Maybe$Just(env));
												if (_p82.ctor === 'Just') {
													return A2(
														_elm_lang$core$Result$map,
														addWidgets(_p79._0._1),
														A3(_user$project$Eval$eval, _p82._0, bt_, _p46._5));
												} else {
													return A2(
														_user$project$Eval$errorWithBacktrace,
														{ctor: '::', _0: e, _1: bt},
														A2(
															_elm_lang$core$Basics_ops['++'],
															_user$project$Lang$strPos(e.start),
															'bad ELet'));
												}
											} else {
												break _v37_2;
											}
										case 'PList':
											return A2(
												_user$project$Eval$errorWithBacktrace,
												{ctor: '::', _0: e, _1: bt},
												A2(
													_elm_lang$core$Basics_ops['++'],
													_user$project$Lang$strPos(_p85.start),
													'mutually recursive functions (i.e. letrec [...] [...] e) \\n                 not yet implemented'));
										default:
											break _v37_2;
									}
								} else {
									break _v37_2;
								}
							} while(false);
							return A2(
								_user$project$Eval$errorWithBacktrace,
								{ctor: '::', _0: e, _1: bt},
								A2(
									_elm_lang$core$Basics_ops['++'],
									_user$project$Lang$strPos(e.start),
									'bad ELet'));
						}
					}
				case 'EColonType':
					var _p94 = _p46._1;
					var _p86 = _p46._3.val;
					if (_p86.ctor === 'TNamed') {
						if (!_elm_lang$core$Native_Utils.eq(
							_elm_lang$core$String$trim(_p86._1),
							'Point')) {
							var _v40 = env,
								_v41 = bt,
								_v42 = _p94;
							env = _v40;
							bt = _v41;
							e = _v42;
							continue $eval;
						} else {
							return A2(
								_elm_lang$core$Result$map,
								function (result) {
									var _p87 = result;
									var v = _p87._0._0;
									var ws = _p87._0._1;
									var env_ = _p87._1;
									var _p88 = v.v_;
									if ((((_p88.ctor === 'VList') && (_p88._0.ctor === '::')) && (_p88._0._1.ctor === '::')) && (_p88._0._1._1.ctor === '[]')) {
										var _p93 = _p88._0._1._0;
										var _p92 = _p88._0._0;
										var _p89 = {ctor: '_Tuple2', _0: _p92.v_, _1: _p93.v_};
										if (((_p89.ctor === '_Tuple2') && (_p89._0.ctor === 'VConst')) && (_p89._1.ctor === 'VConst')) {
											var _p91 = _p89._1._1;
											var _p90 = _p89._0._1;
											var vNew = _elm_lang$core$Native_Utils.update(
												v,
												{
													v_: _user$project$Lang$VList(
														{
															ctor: '::',
															_0: _elm_lang$core$Native_Utils.update(
																_p92,
																{
																	v_: A2(
																		_user$project$Lang$VConst,
																		_elm_lang$core$Maybe$Just(
																			{ctor: '_Tuple2', _0: _user$project$Lang$X, _1: _p91}),
																		_p90)
																}),
															_1: {
																ctor: '::',
																_0: _elm_lang$core$Native_Utils.update(
																	_p93,
																	{
																		v_: A2(
																			_user$project$Lang$VConst,
																			_elm_lang$core$Maybe$Just(
																				{ctor: '_Tuple2', _0: _user$project$Lang$Y, _1: _p90}),
																			_p91)
																	}),
																_1: {ctor: '[]'}
															}
														})
												});
											return {
												ctor: '_Tuple2',
												_0: {
													ctor: '_Tuple2',
													_0: vNew,
													_1: A2(
														_elm_lang$core$Basics_ops['++'],
														ws,
														{
															ctor: '::',
															_0: A2(_user$project$Lang$WPoint, _p90, _p91),
															_1: {ctor: '[]'}
														})
												},
												_1: env_
											};
										} else {
											return result;
										}
									} else {
										return result;
									}
								},
								A3(_user$project$Eval$eval, env, bt, _p94));
						}
					} else {
						var _v45 = env,
							_v46 = bt,
							_v47 = _p94;
						env = _v45;
						bt = _v46;
						e = _v47;
						continue $eval;
					}
				case 'EComment':
					var _v48 = env,
						_v49 = bt,
						_v50 = _p46._2;
					env = _v48;
					bt = _v49;
					e = _v50;
					continue $eval;
				case 'EOption':
					var _v51 = env,
						_v52 = bt,
						_v53 = _p46._4;
					env = _v51;
					bt = _v52;
					e = _v53;
					continue $eval;
				case 'ETyp':
					var _v54 = env,
						_v55 = bt,
						_v56 = _p46._3;
					env = _v54;
					bt = _v55;
					e = _v56;
					continue $eval;
				case 'ETypeAlias':
					var _v57 = env,
						_v58 = bt,
						_v59 = _p46._3;
					env = _v57;
					bt = _v58;
					e = _v59;
					continue $eval;
				case 'EFun':
					if ((_p46._1.ctor === '::') && (_p46._1._1.ctor === '[]')) {
						return _elm_lang$core$Result$Ok(
							ret(
								A4(_user$project$Lang$VClosure, _elm_lang$core$Maybe$Nothing, _p46._1._0, _p46._2, env)));
					} else {
						var _p95 = _p46._2;
						return A2(
							_elm_lang$core$Result$map,
							retAddWs(_p95.val.eid),
							A3(
								_user$project$Eval$eval,
								env,
								bt_,
								A2(_user$project$Lang$desugarEFun, _p46._1, _p95)));
					}
				default:
					if (_p46._2.ctor === '::') {
						if (_p46._2._1.ctor === '[]') {
							var _p72 = _p46._1;
							var _p65 = A3(_user$project$Eval$eval_, env, bt_, _p72);
							if (_p65.ctor === 'Err') {
								return _elm_lang$core$Result$Err(_p65._0);
							} else {
								var _p71 = _p65._0._0;
								var _p66 = A3(_user$project$Eval$eval_, env, bt_, _p46._2._0);
								if (_p66.ctor === 'Err') {
									return _elm_lang$core$Result$Err(_p66._0);
								} else {
									var _p70 = _p66._0._0;
									var ws = A2(_elm_lang$core$Basics_ops['++'], _p65._0._1, _p66._0._1);
									var _p67 = _p71.v_;
									if (_p67.ctor === 'VClosure') {
										if (_p67._0.ctor === 'Nothing') {
											var _p68 = A2(
												_user$project$Eval$cons,
												{ctor: '_Tuple2', _0: _p67._1, _1: _p70},
												_elm_lang$core$Maybe$Just(_p67._3));
											if (_p68.ctor === 'Just') {
												return A2(
													_elm_lang$core$Result$map,
													addWidgets(ws),
													A3(_user$project$Eval$eval, _p68._0, bt_, _p67._2));
											} else {
												return A2(
													_user$project$Eval$errorWithBacktrace,
													{ctor: '::', _0: e, _1: bt},
													A2(
														_elm_lang$core$Basics_ops['++'],
														_user$project$Lang$strPos(_p72.start),
														'bad environment'));
											}
										} else {
											var _p69 = A2(
												_user$project$Eval$cons,
												{
													ctor: '_Tuple2',
													_0: _user$project$Lang$pVar(_p67._0._0),
													_1: _p71
												},
												A2(
													_user$project$Eval$cons,
													{ctor: '_Tuple2', _0: _p67._1, _1: _p70},
													_elm_lang$core$Maybe$Just(_p67._3)));
											if (_p69.ctor === 'Just') {
												return A2(
													_elm_lang$core$Result$map,
													addWidgets(ws),
													A3(_user$project$Eval$eval, _p69._0, bt_, _p67._2));
											} else {
												return A2(
													_user$project$Eval$errorWithBacktrace,
													{ctor: '::', _0: e, _1: bt},
													A2(
														_elm_lang$core$Basics_ops['++'],
														_user$project$Lang$strPos(_p72.start),
														'bad environment'));
											}
										}
									} else {
										return A2(
											_user$project$Eval$errorWithBacktrace,
											{ctor: '::', _0: e, _1: bt},
											A2(
												_elm_lang$core$Basics_ops['++'],
												_user$project$Lang$strPos(_p72.start),
												' not a function'));
									}
								}
							}
						} else {
							return A2(
								_elm_lang$core$Result$map,
								retAddWs(e.val.eid),
								A3(
									_user$project$Eval$eval,
									env,
									bt_,
									A2(_user$project$Lang$desugarEApp, _p46._1, _p46._2)));
						}
					} else {
						return A2(
							_user$project$Eval$errorWithBacktrace,
							{ctor: '::', _0: e, _1: bt},
							A2(
								_elm_lang$core$Basics_ops['++'],
								_user$project$Lang$strPos(_p46._1.start),
								' application with no arguments'));
					}
			}
		}
	});
var _user$project$Eval$evalOp = F4(
	function (env, bt, opWithInfo, es) {
		var _p96 = {ctor: '_Tuple2', _0: opWithInfo.val, _1: opWithInfo.start};
		var op = _p96._0;
		var opStart = _p96._1;
		var argsEvaledRes = _user$project$Utils$projOk(
			A2(
				_elm_lang$core$List$map,
				A2(_user$project$Eval$eval_, env, bt),
				es));
		var _p97 = argsEvaledRes;
		if (_p97.ctor === 'Err') {
			return _elm_lang$core$Result$Err(_p97._0);
		} else {
			var _p98 = _elm_lang$core$List$unzip(_p97._0);
			var vs = _p98._0;
			var wss = _p98._1;
			var error = function (_p99) {
				var _p100 = _p99;
				return A2(
					_user$project$Eval$errorWithBacktrace,
					bt,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'Bad arguments to ',
						A2(
							_elm_lang$core$Basics_ops['++'],
							_user$project$Lang$strOp(op),
							A2(
								_elm_lang$core$Basics_ops['++'],
								' operator ',
								A2(
									_elm_lang$core$Basics_ops['++'],
									_user$project$Lang$strPos(opStart),
									A2(
										_elm_lang$core$Basics_ops['++'],
										':\n',
										_user$project$Utils$lines(
											A2(
												_elm_lang$core$List$map,
												function (_p101) {
													var _p102 = _p101;
													return A2(
														_elm_lang$core$Basics_ops['++'],
														_user$project$Lang$strVal(_p102._0),
														A2(
															_elm_lang$core$Basics_ops['++'],
															' from ',
															_user$project$LangUnparser$unparse(_p102._1)));
												},
												A2(_user$project$Utils$zip, vs, es)))))))));
			};
			var emptyVTrace = function (val_) {
				return A2(
					_user$project$Lang$Val,
					val_,
					{ctor: '[]'});
			};
			var emptyVTraceOk = function (val_) {
				return _elm_lang$core$Result$Ok(
					emptyVTrace(val_));
			};
			var nullaryOp = F2(
				function (args, retVal) {
					var _p103 = args;
					if (_p103.ctor === '[]') {
						return emptyVTraceOk(retVal);
					} else {
						return error(
							{ctor: '_Tuple0'});
					}
				});
			var unaryMathOp = F2(
				function (op, args) {
					var _p104 = args;
					if ((((_p104.ctor === '::') && (_p104._0.ctor === 'VConst')) && (_p104._0._1.ctor === '_Tuple2')) && (_p104._1.ctor === '[]')) {
						return emptyVTraceOk(
							A2(
								_user$project$Lang$VConst,
								_elm_lang$core$Maybe$Nothing,
								{
									ctor: '_Tuple2',
									_0: A3(
										_user$project$Eval$evalDelta,
										bt,
										op,
										{
											ctor: '::',
											_0: _p104._0._1._0,
											_1: {ctor: '[]'}
										}),
									_1: A2(
										_user$project$Lang$TrOp,
										op,
										{
											ctor: '::',
											_0: _p104._0._1._1,
											_1: {ctor: '[]'}
										})
								}));
					} else {
						return error(
							{ctor: '_Tuple0'});
					}
				});
			var binMathOp = F2(
				function (op, args) {
					var _p105 = args;
					if (((((((_p105.ctor === '::') && (_p105._0.ctor === 'VConst')) && (_p105._0._1.ctor === '_Tuple2')) && (_p105._1.ctor === '::')) && (_p105._1._0.ctor === 'VConst')) && (_p105._1._0._1.ctor === '_Tuple2')) && (_p105._1._1.ctor === '[]')) {
						var maybeAxisAndOtherDim = function () {
							var _p106 = {ctor: '_Tuple3', _0: op, _1: _p105._0._0, _2: _p105._1._0._0};
							_v71_3:
							do {
								if (_p106.ctor === '_Tuple3') {
									if (_p106._1.ctor === 'Nothing') {
										if ((_p106._0.ctor === 'Plus') && (_p106._2.ctor === 'Just')) {
											return _elm_lang$core$Maybe$Just(_p106._2._0);
										} else {
											break _v71_3;
										}
									} else {
										if (_p106._2.ctor === 'Nothing') {
											switch (_p106._0.ctor) {
												case 'Plus':
													return _elm_lang$core$Maybe$Just(_p106._1._0);
												case 'Minus':
													return _elm_lang$core$Maybe$Just(_p106._1._0);
												default:
													break _v71_3;
											}
										} else {
											break _v71_3;
										}
									}
								} else {
									break _v71_3;
								}
							} while(false);
							return _elm_lang$core$Maybe$Nothing;
						}();
						return emptyVTraceOk(
							A2(
								_user$project$Lang$VConst,
								maybeAxisAndOtherDim,
								{
									ctor: '_Tuple2',
									_0: A3(
										_user$project$Eval$evalDelta,
										bt,
										op,
										{
											ctor: '::',
											_0: _p105._0._1._0,
											_1: {
												ctor: '::',
												_0: _p105._1._0._1._0,
												_1: {ctor: '[]'}
											}
										}),
									_1: A2(
										_user$project$Lang$TrOp,
										op,
										{
											ctor: '::',
											_0: _p105._0._1._1,
											_1: {
												ctor: '::',
												_0: _p105._1._0._1._1,
												_1: {ctor: '[]'}
											}
										})
								}));
					} else {
						return error(
							{ctor: '_Tuple0'});
					}
				});
			var args = A2(
				_elm_lang$core$List$map,
				function (_) {
					return _.v_;
				},
				vs);
			var newValRes = function () {
				var _p107 = op;
				switch (_p107.ctor) {
					case 'Plus':
						var _p108 = args;
						if (((((((_p108.ctor === '::') && (_p108._0.ctor === 'VBase')) && (_p108._0._0.ctor === 'VString')) && (_p108._1.ctor === '::')) && (_p108._1._0.ctor === 'VBase')) && (_p108._1._0._0.ctor === 'VString')) && (_p108._1._1.ctor === '[]')) {
							return emptyVTraceOk(
								_user$project$Lang$VBase(
									_user$project$Lang$VString(
										A2(_elm_lang$core$Basics_ops['++'], _p108._0._0._0, _p108._1._0._0._0))));
						} else {
							return A2(binMathOp, op, args);
						}
					case 'Minus':
						return A2(binMathOp, op, args);
					case 'Mult':
						return A2(binMathOp, op, args);
					case 'Div':
						return A2(binMathOp, op, args);
					case 'Mod':
						return A2(binMathOp, op, args);
					case 'Pow':
						return A2(binMathOp, op, args);
					case 'ArcTan2':
						return A2(binMathOp, op, args);
					case 'Lt':
						var _p109 = args;
						if (((((((_p109.ctor === '::') && (_p109._0.ctor === 'VConst')) && (_p109._0._1.ctor === '_Tuple2')) && (_p109._1.ctor === '::')) && (_p109._1._0.ctor === 'VConst')) && (_p109._1._0._1.ctor === '_Tuple2')) && (_p109._1._1.ctor === '[]')) {
							return emptyVTraceOk(
								_user$project$Lang$VBase(
									_user$project$Lang$VBool(
										_elm_lang$core$Native_Utils.cmp(_p109._0._1._0, _p109._1._0._1._0) < 0)));
						} else {
							return error(
								{ctor: '_Tuple0'});
						}
					case 'Eq':
						var _p110 = args;
						_v75_2:
						do {
							if (((_p110.ctor === '::') && (_p110._1.ctor === '::')) && (_p110._1._1.ctor === '[]')) {
								switch (_p110._0.ctor) {
									case 'VConst':
										if (((_p110._0._1.ctor === '_Tuple2') && (_p110._1._0.ctor === 'VConst')) && (_p110._1._0._1.ctor === '_Tuple2')) {
											return emptyVTraceOk(
												_user$project$Lang$VBase(
													_user$project$Lang$VBool(
														_elm_lang$core$Native_Utils.eq(_p110._0._1._0, _p110._1._0._1._0))));
										} else {
											break _v75_2;
										}
									case 'VBase':
										if (((_p110._0._0.ctor === 'VString') && (_p110._1._0.ctor === 'VBase')) && (_p110._1._0._0.ctor === 'VString')) {
											return emptyVTraceOk(
												_user$project$Lang$VBase(
													_user$project$Lang$VBool(
														_elm_lang$core$Native_Utils.eq(_p110._0._0._0, _p110._1._0._0._0))));
										} else {
											break _v75_2;
										}
									default:
										break _v75_2;
								}
							} else {
								return error(
									{ctor: '_Tuple0'});
							}
						} while(false);
						return emptyVTraceOk(
							_user$project$Lang$VBase(
								_user$project$Lang$VBool(false)));
					case 'Pi':
						return A2(
							nullaryOp,
							args,
							A2(
								_user$project$Lang$VConst,
								_elm_lang$core$Maybe$Nothing,
								{
									ctor: '_Tuple2',
									_0: _elm_lang$core$Basics$pi,
									_1: A2(
										_user$project$Lang$TrOp,
										op,
										{ctor: '[]'})
								}));
					case 'DictEmpty':
						return A2(
							nullaryOp,
							args,
							_user$project$Lang$VDict(_elm_lang$core$Dict$empty));
					case 'DictInsert':
						var _p111 = vs;
						if ((((_p111.ctor === '::') && (_p111._1.ctor === '::')) && (_p111._1._1.ctor === '::')) && (_p111._1._1._1.ctor === '[]')) {
							var _p112 = _p111._1._1._0.v_;
							if (_p112.ctor === 'VDict') {
								return A2(
									_elm_lang$core$Result$map,
									function (dkey) {
										return emptyVTrace(
											_user$project$Lang$VDict(
												A3(_elm_lang$core$Dict$insert, dkey, _p111._1._0, _p112._0)));
									},
									A2(_user$project$Eval$valToDictKey, bt, _p111._0.v_));
							} else {
								return error(
									{ctor: '_Tuple0'});
							}
						} else {
							return error(
								{ctor: '_Tuple0'});
						}
					case 'DictGet':
						var _p113 = args;
						if ((((_p113.ctor === '::') && (_p113._1.ctor === '::')) && (_p113._1._0.ctor === 'VDict')) && (_p113._1._1.ctor === '[]')) {
							return A2(
								_elm_lang$core$Result$map,
								function (dkey) {
									return A3(
										_user$project$Utils$getWithDefault,
										dkey,
										emptyVTrace(
											_user$project$Lang$VBase(_user$project$Lang$VNull)),
										_p113._1._0._0);
								},
								A2(_user$project$Eval$valToDictKey, bt, _p113._0));
						} else {
							return error(
								{ctor: '_Tuple0'});
						}
					case 'DictRemove':
						var _p114 = args;
						if ((((_p114.ctor === '::') && (_p114._1.ctor === '::')) && (_p114._1._0.ctor === 'VDict')) && (_p114._1._1.ctor === '[]')) {
							return A2(
								_elm_lang$core$Result$map,
								function (dkey) {
									return emptyVTrace(
										_user$project$Lang$VDict(
											A2(_elm_lang$core$Dict$remove, dkey, _p114._1._0._0)));
								},
								A2(_user$project$Eval$valToDictKey, bt, _p114._0));
						} else {
							return error(
								{ctor: '_Tuple0'});
						}
					case 'Cos':
						return A2(unaryMathOp, op, args);
					case 'Sin':
						return A2(unaryMathOp, op, args);
					case 'ArcCos':
						return A2(unaryMathOp, op, args);
					case 'ArcSin':
						return A2(unaryMathOp, op, args);
					case 'Floor':
						return A2(unaryMathOp, op, args);
					case 'Ceil':
						return A2(unaryMathOp, op, args);
					case 'Round':
						return A2(unaryMathOp, op, args);
					case 'Sqrt':
						return A2(unaryMathOp, op, args);
					case 'Explode':
						var _p115 = args;
						if ((((_p115.ctor === '::') && (_p115._0.ctor === 'VBase')) && (_p115._0._0.ctor === 'VString')) && (_p115._1.ctor === '[]')) {
							return emptyVTraceOk(
								_user$project$Lang$VList(
									A2(
										_elm_lang$core$List$map,
										function (_p116) {
											return _user$project$Lang$vStr(
												_elm_lang$core$String$fromChar(_p116));
										},
										_elm_lang$core$String$toList(_p115._0._0._0))));
						} else {
							return error(
								{ctor: '_Tuple0'});
						}
					case 'DebugLog':
						var _p117 = vs;
						if ((_p117.ctor === '::') && (_p117._1.ctor === '[]')) {
							var _p119 = _p117._0;
							var _p118 = A2(
								_elm_lang$core$Debug$log,
								_user$project$Lang$strVal(_p119),
								'');
							return _elm_lang$core$Result$Ok(_p119);
						} else {
							return error(
								{ctor: '_Tuple0'});
						}
					default:
						var _p120 = vs;
						if ((_p120.ctor === '::') && (_p120._1.ctor === '[]')) {
							return emptyVTraceOk(
								_user$project$Lang$VBase(
									_user$project$Lang$VString(
										_user$project$Lang$strVal(_p120._0))));
						} else {
							return error(
								{ctor: '_Tuple0'});
						}
				}
			}();
			var newWidgets = function () {
				var _p121 = {ctor: '_Tuple2', _0: op, _1: args};
				_v83_3:
				do {
					if (((_p121.ctor === '_Tuple2') && (_p121._1.ctor === '::')) && (_p121._1._0.ctor === 'VConst')) {
						if (_p121._1._0._0.ctor === 'Nothing') {
							if ((((((_p121._0.ctor === 'Plus') && (_p121._1._1.ctor === '::')) && (_p121._1._1._0.ctor === 'VConst')) && (_p121._1._1._0._0.ctor === 'Just')) && (_p121._1._1._0._0._0.ctor === '_Tuple2')) && (_p121._1._1._1.ctor === '[]')) {
								var _p129 = _p121._1._1._0._0._0._1;
								var _p128 = _p121._1._1._0._1;
								var _p127 = _p121._1._1._0._0._0._0;
								var _p126 = _elm_lang$core$Native_Utils.eq(_p127, _user$project$Lang$X) ? {ctor: '_Tuple2', _0: _p128, _1: _p129} : {ctor: '_Tuple2', _0: _p129, _1: _p128};
								var baseXNumTr = _p126._0;
								var baseYNumTr = _p126._1;
								return {
									ctor: '::',
									_0: A5(_user$project$Lang$WOffset1D, baseXNumTr, baseYNumTr, _p127, _user$project$Lang$Positive, _p121._1._0._1),
									_1: {ctor: '[]'}
								};
							} else {
								break _v83_3;
							}
						} else {
							if (((((_p121._1._0._0._0.ctor === '_Tuple2') && (_p121._1._1.ctor === '::')) && (_p121._1._1._0.ctor === 'VConst')) && (_p121._1._1._0._0.ctor === 'Nothing')) && (_p121._1._1._1.ctor === '[]')) {
								switch (_p121._0.ctor) {
									case 'Plus':
										var _p125 = _p121._1._0._0._0._1;
										var _p124 = _p121._1._0._1;
										var _p123 = _p121._1._0._0._0._0;
										var _p122 = _elm_lang$core$Native_Utils.eq(_p123, _user$project$Lang$X) ? {ctor: '_Tuple2', _0: _p124, _1: _p125} : {ctor: '_Tuple2', _0: _p125, _1: _p124};
										var baseXNumTr = _p122._0;
										var baseYNumTr = _p122._1;
										return {
											ctor: '::',
											_0: A5(_user$project$Lang$WOffset1D, baseXNumTr, baseYNumTr, _p123, _user$project$Lang$Positive, _p121._1._1._0._1),
											_1: {ctor: '[]'}
										};
									case 'Minus':
										var _p133 = _p121._1._0._0._0._1;
										var _p132 = _p121._1._0._1;
										var _p131 = _p121._1._0._0._0._0;
										var _p130 = _elm_lang$core$Native_Utils.eq(_p131, _user$project$Lang$X) ? {ctor: '_Tuple2', _0: _p132, _1: _p133} : {ctor: '_Tuple2', _0: _p133, _1: _p132};
										var baseXNumTr = _p130._0;
										var baseYNumTr = _p130._1;
										return {
											ctor: '::',
											_0: A5(_user$project$Lang$WOffset1D, baseXNumTr, baseYNumTr, _p131, _user$project$Lang$Negative, _p121._1._1._0._1),
											_1: {ctor: '[]'}
										};
									default:
										break _v83_3;
								}
							} else {
								break _v83_3;
							}
						}
					} else {
						break _v83_3;
					}
				} while(false);
				return {ctor: '[]'};
			}();
			return A2(
				_elm_lang$core$Result$map,
				function (newVal) {
					return {
						ctor: '_Tuple2',
						_0: newVal,
						_1: A2(
							_elm_lang$core$Basics_ops['++'],
							_elm_lang$core$List$concat(wss),
							newWidgets)
					};
				},
				newValRes);
		}
	});
var _user$project$Eval$evalTBranches = F4(
	function (env, bt, pat, tbranches) {
		return A3(
			_elm_lang$core$List$foldl,
			F2(
				function (_p134, acc) {
					var _p135 = _p134;
					var _p136 = {
						ctor: '_Tuple2',
						_0: acc,
						_1: A4(_user$project$Eval$typeCaseMatch, env, bt, pat, _p135._1)
					};
					if (_p136._0.ctor === 'Ok') {
						if (_p136._0._0.ctor === 'Just') {
							return acc;
						} else {
							if (_p136._1.ctor === 'Ok') {
								return _p136._1._0 ? A2(
									_elm_lang$core$Result$map,
									_elm_lang$core$Maybe$Just,
									A3(_user$project$Eval$eval_, env, bt, _p135._2)) : acc;
							} else {
								return _elm_lang$core$Result$Err(_p136._1._0);
							}
						}
					} else {
						return acc;
					}
				}),
			_elm_lang$core$Result$Ok(_elm_lang$core$Maybe$Nothing),
			A2(
				_elm_lang$core$List$map,
				function (_) {
					return _.val;
				},
				tbranches));
	});
var _user$project$Eval$initEnvRes = A2(
	_elm_lang$core$Result$map,
	_elm_lang$core$Tuple$second,
	A3(
		_user$project$Eval$eval,
		{ctor: '[]'},
		{ctor: '[]'},
		_user$project$FastParser$prelude));
var _user$project$Eval$initEnv = A2(_user$project$Utils$fromOk, 'Eval.initEnv', _user$project$Eval$initEnvRes);
var _user$project$Eval$doEval = F2(
	function (initEnv, e) {
		return A2(
			_elm_lang$core$Result$map,
			function (_p137) {
				var _p138 = _p137;
				return {
					ctor: '_Tuple2',
					_0: {
						ctor: '_Tuple2',
						_0: _p138._0._0,
						_1: _user$project$Eval$postProcessWidgets(_p138._0._1)
					},
					_1: _p138._1
				};
			},
			A3(
				_user$project$Eval$eval,
				initEnv,
				{ctor: '[]'},
				e));
	});
var _user$project$Eval$run = function (e) {
	return A2(
		_elm_lang$core$Result$map,
		_elm_lang$core$Tuple$first,
		A2(_user$project$Eval$doEval, _user$project$Eval$initEnv, e));
};
var _user$project$Eval$parseAndRun = function (_p139) {
	return _user$project$Lang$strVal(
		_elm_lang$core$Tuple$first(
			_user$project$Utils$fromOk_(
				_user$project$Eval$run(
					A2(
						_user$project$Utils$fromOkay,
						'parseAndRun',
						_user$project$FastParser$parseE(_p139))))));
};
var _user$project$Eval$parseAndRun_ = function (_p140) {
	return A2(
		_user$project$Lang$strVal_,
		true,
		_elm_lang$core$Tuple$first(
			_user$project$Utils$fromOk_(
				_user$project$Eval$run(
					A2(
						_user$project$Utils$fromOkay,
						'parseAndRun_',
						_user$project$FastParser$parseE(_p140))))));
};

var _user$project$ColorNum$htmlColorNames = A2(
	_elm_lang$core$Basics_ops['++'],
	A2(
		_elm_lang$core$List$map,
		_elm_lang$core$Tuple$mapFirst(_elm_lang$core$String$toLower),
		{
			ctor: '::',
			_0: {
				ctor: '_Tuple2',
				_0: 'AliceBlue',
				_1: {
					ctor: '_Tuple2',
					_0: {ctor: '_Tuple3', _0: 240, _1: 248, _2: 255},
					_1: {ctor: '_Tuple3', _0: 208, _1: 1, _2: 0.97}
				}
			},
			_1: {
				ctor: '::',
				_0: {
					ctor: '_Tuple2',
					_0: 'AntiqueWhite',
					_1: {
						ctor: '_Tuple2',
						_0: {ctor: '_Tuple3', _0: 250, _1: 235, _2: 215},
						_1: {ctor: '_Tuple3', _0: 34, _1: 0.78, _2: 0.91}
					}
				},
				_1: {
					ctor: '::',
					_0: {
						ctor: '_Tuple2',
						_0: 'Aqua',
						_1: {
							ctor: '_Tuple2',
							_0: {ctor: '_Tuple3', _0: 0, _1: 255, _2: 255},
							_1: {ctor: '_Tuple3', _0: 180, _1: 1, _2: 0.5}
						}
					},
					_1: {
						ctor: '::',
						_0: {
							ctor: '_Tuple2',
							_0: 'Aquamarine',
							_1: {
								ctor: '_Tuple2',
								_0: {ctor: '_Tuple3', _0: 127, _1: 255, _2: 212},
								_1: {ctor: '_Tuple3', _0: 160, _1: 1, _2: 0.75}
							}
						},
						_1: {
							ctor: '::',
							_0: {
								ctor: '_Tuple2',
								_0: 'Azure',
								_1: {
									ctor: '_Tuple2',
									_0: {ctor: '_Tuple3', _0: 240, _1: 255, _2: 255},
									_1: {ctor: '_Tuple3', _0: 180, _1: 1, _2: 0.97}
								}
							},
							_1: {
								ctor: '::',
								_0: {
									ctor: '_Tuple2',
									_0: 'Beige',
									_1: {
										ctor: '_Tuple2',
										_0: {ctor: '_Tuple3', _0: 245, _1: 245, _2: 220},
										_1: {ctor: '_Tuple3', _0: 60, _1: 0.56, _2: 0.91}
									}
								},
								_1: {
									ctor: '::',
									_0: {
										ctor: '_Tuple2',
										_0: 'Bisque',
										_1: {
											ctor: '_Tuple2',
											_0: {ctor: '_Tuple3', _0: 255, _1: 228, _2: 196},
											_1: {ctor: '_Tuple3', _0: 33, _1: 1, _2: 0.88}
										}
									},
									_1: {
										ctor: '::',
										_0: {
											ctor: '_Tuple2',
											_0: 'Black',
											_1: {
												ctor: '_Tuple2',
												_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0},
												_1: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0}
											}
										},
										_1: {
											ctor: '::',
											_0: {
												ctor: '_Tuple2',
												_0: 'BlanchedAlmond',
												_1: {
													ctor: '_Tuple2',
													_0: {ctor: '_Tuple3', _0: 255, _1: 235, _2: 205},
													_1: {ctor: '_Tuple3', _0: 36, _1: 1, _2: 0.9}
												}
											},
											_1: {
												ctor: '::',
												_0: {
													ctor: '_Tuple2',
													_0: 'Blue',
													_1: {
														ctor: '_Tuple2',
														_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 255},
														_1: {ctor: '_Tuple3', _0: 240, _1: 1, _2: 0.5}
													}
												},
												_1: {
													ctor: '::',
													_0: {
														ctor: '_Tuple2',
														_0: 'BlueViolet',
														_1: {
															ctor: '_Tuple2',
															_0: {ctor: '_Tuple3', _0: 138, _1: 43, _2: 226},
															_1: {ctor: '_Tuple3', _0: 271, _1: 0.76, _2: 0.53}
														}
													},
													_1: {
														ctor: '::',
														_0: {
															ctor: '_Tuple2',
															_0: 'Brown',
															_1: {
																ctor: '_Tuple2',
																_0: {ctor: '_Tuple3', _0: 165, _1: 42, _2: 42},
																_1: {ctor: '_Tuple3', _0: 0, _1: 0.59, _2: 0.41}
															}
														},
														_1: {
															ctor: '::',
															_0: {
																ctor: '_Tuple2',
																_0: 'BurlyWood',
																_1: {
																	ctor: '_Tuple2',
																	_0: {ctor: '_Tuple3', _0: 222, _1: 184, _2: 135},
																	_1: {ctor: '_Tuple3', _0: 34, _1: 0.57, _2: 0.7}
																}
															},
															_1: {
																ctor: '::',
																_0: {
																	ctor: '_Tuple2',
																	_0: 'CadetBlue',
																	_1: {
																		ctor: '_Tuple2',
																		_0: {ctor: '_Tuple3', _0: 95, _1: 158, _2: 160},
																		_1: {ctor: '_Tuple3', _0: 182, _1: 0.25, _2: 0.5}
																	}
																},
																_1: {
																	ctor: '::',
																	_0: {
																		ctor: '_Tuple2',
																		_0: 'Chartreuse',
																		_1: {
																			ctor: '_Tuple2',
																			_0: {ctor: '_Tuple3', _0: 127, _1: 255, _2: 0},
																			_1: {ctor: '_Tuple3', _0: 90, _1: 1, _2: 0.5}
																		}
																	},
																	_1: {
																		ctor: '::',
																		_0: {
																			ctor: '_Tuple2',
																			_0: 'Chocolate',
																			_1: {
																				ctor: '_Tuple2',
																				_0: {ctor: '_Tuple3', _0: 210, _1: 105, _2: 30},
																				_1: {ctor: '_Tuple3', _0: 25, _1: 0.75, _2: 0.47}
																			}
																		},
																		_1: {
																			ctor: '::',
																			_0: {
																				ctor: '_Tuple2',
																				_0: 'Coral',
																				_1: {
																					ctor: '_Tuple2',
																					_0: {ctor: '_Tuple3', _0: 255, _1: 127, _2: 80},
																					_1: {ctor: '_Tuple3', _0: 16, _1: 1, _2: 0.66}
																				}
																			},
																			_1: {
																				ctor: '::',
																				_0: {
																					ctor: '_Tuple2',
																					_0: 'CornflowerBlue',
																					_1: {
																						ctor: '_Tuple2',
																						_0: {ctor: '_Tuple3', _0: 100, _1: 149, _2: 237},
																						_1: {ctor: '_Tuple3', _0: 219, _1: 0.79, _2: 0.66}
																					}
																				},
																				_1: {
																					ctor: '::',
																					_0: {
																						ctor: '_Tuple2',
																						_0: 'Cornsilk',
																						_1: {
																							ctor: '_Tuple2',
																							_0: {ctor: '_Tuple3', _0: 255, _1: 248, _2: 220},
																							_1: {ctor: '_Tuple3', _0: 48, _1: 1, _2: 0.93}
																						}
																					},
																					_1: {
																						ctor: '::',
																						_0: {
																							ctor: '_Tuple2',
																							_0: 'Crimson',
																							_1: {
																								ctor: '_Tuple2',
																								_0: {ctor: '_Tuple3', _0: 220, _1: 20, _2: 60},
																								_1: {ctor: '_Tuple3', _0: 348, _1: 0.83, _2: 0.47}
																							}
																						},
																						_1: {
																							ctor: '::',
																							_0: {
																								ctor: '_Tuple2',
																								_0: 'Cyan',
																								_1: {
																									ctor: '_Tuple2',
																									_0: {ctor: '_Tuple3', _0: 0, _1: 255, _2: 255},
																									_1: {ctor: '_Tuple3', _0: 180, _1: 1, _2: 0.5}
																								}
																							},
																							_1: {
																								ctor: '::',
																								_0: {
																									ctor: '_Tuple2',
																									_0: 'DarkBlue',
																									_1: {
																										ctor: '_Tuple2',
																										_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 139},
																										_1: {ctor: '_Tuple3', _0: 240, _1: 1, _2: 0.27}
																									}
																								},
																								_1: {
																									ctor: '::',
																									_0: {
																										ctor: '_Tuple2',
																										_0: 'DarkCyan',
																										_1: {
																											ctor: '_Tuple2',
																											_0: {ctor: '_Tuple3', _0: 0, _1: 139, _2: 139},
																											_1: {ctor: '_Tuple3', _0: 180, _1: 1, _2: 0.27}
																										}
																									},
																									_1: {
																										ctor: '::',
																										_0: {
																											ctor: '_Tuple2',
																											_0: 'DarkGoldenRod',
																											_1: {
																												ctor: '_Tuple2',
																												_0: {ctor: '_Tuple3', _0: 184, _1: 134, _2: 11},
																												_1: {ctor: '_Tuple3', _0: 43, _1: 0.89, _2: 0.38}
																											}
																										},
																										_1: {
																											ctor: '::',
																											_0: {
																												ctor: '_Tuple2',
																												_0: 'DarkGray',
																												_1: {
																													ctor: '_Tuple2',
																													_0: {ctor: '_Tuple3', _0: 169, _1: 169, _2: 169},
																													_1: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0.66}
																												}
																											},
																											_1: {
																												ctor: '::',
																												_0: {
																													ctor: '_Tuple2',
																													_0: 'DarkGrey',
																													_1: {
																														ctor: '_Tuple2',
																														_0: {ctor: '_Tuple3', _0: 169, _1: 169, _2: 169},
																														_1: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0.66}
																													}
																												},
																												_1: {
																													ctor: '::',
																													_0: {
																														ctor: '_Tuple2',
																														_0: 'DarkGreen',
																														_1: {
																															ctor: '_Tuple2',
																															_0: {ctor: '_Tuple3', _0: 0, _1: 100, _2: 0},
																															_1: {ctor: '_Tuple3', _0: 120, _1: 1, _2: 0.2}
																														}
																													},
																													_1: {
																														ctor: '::',
																														_0: {
																															ctor: '_Tuple2',
																															_0: 'DarkKhaki',
																															_1: {
																																ctor: '_Tuple2',
																																_0: {ctor: '_Tuple3', _0: 189, _1: 183, _2: 107},
																																_1: {ctor: '_Tuple3', _0: 56, _1: 0.38, _2: 0.58}
																															}
																														},
																														_1: {
																															ctor: '::',
																															_0: {
																																ctor: '_Tuple2',
																																_0: 'DarkMagenta',
																																_1: {
																																	ctor: '_Tuple2',
																																	_0: {ctor: '_Tuple3', _0: 139, _1: 0, _2: 139},
																																	_1: {ctor: '_Tuple3', _0: 300, _1: 1, _2: 0.27}
																																}
																															},
																															_1: {
																																ctor: '::',
																																_0: {
																																	ctor: '_Tuple2',
																																	_0: 'DarkOliveGreen',
																																	_1: {
																																		ctor: '_Tuple2',
																																		_0: {ctor: '_Tuple3', _0: 85, _1: 107, _2: 47},
																																		_1: {ctor: '_Tuple3', _0: 82, _1: 0.39, _2: 0.3}
																																	}
																																},
																																_1: {
																																	ctor: '::',
																																	_0: {
																																		ctor: '_Tuple2',
																																		_0: 'DarkOrange',
																																		_1: {
																																			ctor: '_Tuple2',
																																			_0: {ctor: '_Tuple3', _0: 255, _1: 140, _2: 0},
																																			_1: {ctor: '_Tuple3', _0: 33, _1: 1, _2: 0.5}
																																		}
																																	},
																																	_1: {
																																		ctor: '::',
																																		_0: {
																																			ctor: '_Tuple2',
																																			_0: 'DarkOrchid',
																																			_1: {
																																				ctor: '_Tuple2',
																																				_0: {ctor: '_Tuple3', _0: 153, _1: 50, _2: 204},
																																				_1: {ctor: '_Tuple3', _0: 280, _1: 0.61, _2: 0.5}
																																			}
																																		},
																																		_1: {
																																			ctor: '::',
																																			_0: {
																																				ctor: '_Tuple2',
																																				_0: 'DarkRed',
																																				_1: {
																																					ctor: '_Tuple2',
																																					_0: {ctor: '_Tuple3', _0: 139, _1: 0, _2: 0},
																																					_1: {ctor: '_Tuple3', _0: 0, _1: 1, _2: 0.27}
																																				}
																																			},
																																			_1: {
																																				ctor: '::',
																																				_0: {
																																					ctor: '_Tuple2',
																																					_0: 'DarkSalmon',
																																					_1: {
																																						ctor: '_Tuple2',
																																						_0: {ctor: '_Tuple3', _0: 233, _1: 150, _2: 122},
																																						_1: {ctor: '_Tuple3', _0: 15, _1: 0.72, _2: 0.7}
																																					}
																																				},
																																				_1: {
																																					ctor: '::',
																																					_0: {
																																						ctor: '_Tuple2',
																																						_0: 'DarkSeaGreen',
																																						_1: {
																																							ctor: '_Tuple2',
																																							_0: {ctor: '_Tuple3', _0: 143, _1: 188, _2: 143},
																																							_1: {ctor: '_Tuple3', _0: 120, _1: 0.25, _2: 0.65}
																																						}
																																					},
																																					_1: {
																																						ctor: '::',
																																						_0: {
																																							ctor: '_Tuple2',
																																							_0: 'DarkSlateBlue',
																																							_1: {
																																								ctor: '_Tuple2',
																																								_0: {ctor: '_Tuple3', _0: 72, _1: 61, _2: 139},
																																								_1: {ctor: '_Tuple3', _0: 248, _1: 0.39, _2: 0.39}
																																							}
																																						},
																																						_1: {
																																							ctor: '::',
																																							_0: {
																																								ctor: '_Tuple2',
																																								_0: 'DarkSlateGray',
																																								_1: {
																																									ctor: '_Tuple2',
																																									_0: {ctor: '_Tuple3', _0: 47, _1: 79, _2: 79},
																																									_1: {ctor: '_Tuple3', _0: 180, _1: 0.25, _2: 0.25}
																																								}
																																							},
																																							_1: {
																																								ctor: '::',
																																								_0: {
																																									ctor: '_Tuple2',
																																									_0: 'DarkSlateGrey',
																																									_1: {
																																										ctor: '_Tuple2',
																																										_0: {ctor: '_Tuple3', _0: 47, _1: 79, _2: 79},
																																										_1: {ctor: '_Tuple3', _0: 180, _1: 0.25, _2: 0.25}
																																									}
																																								},
																																								_1: {
																																									ctor: '::',
																																									_0: {
																																										ctor: '_Tuple2',
																																										_0: 'DarkTurquoise',
																																										_1: {
																																											ctor: '_Tuple2',
																																											_0: {ctor: '_Tuple3', _0: 0, _1: 206, _2: 209},
																																											_1: {ctor: '_Tuple3', _0: 181, _1: 1, _2: 0.41}
																																										}
																																									},
																																									_1: {
																																										ctor: '::',
																																										_0: {
																																											ctor: '_Tuple2',
																																											_0: 'DarkViolet',
																																											_1: {
																																												ctor: '_Tuple2',
																																												_0: {ctor: '_Tuple3', _0: 148, _1: 0, _2: 211},
																																												_1: {ctor: '_Tuple3', _0: 282, _1: 1, _2: 0.41}
																																											}
																																										},
																																										_1: {
																																											ctor: '::',
																																											_0: {
																																												ctor: '_Tuple2',
																																												_0: 'DeepPink',
																																												_1: {
																																													ctor: '_Tuple2',
																																													_0: {ctor: '_Tuple3', _0: 255, _1: 20, _2: 147},
																																													_1: {ctor: '_Tuple3', _0: 328, _1: 1, _2: 0.54}
																																												}
																																											},
																																											_1: {
																																												ctor: '::',
																																												_0: {
																																													ctor: '_Tuple2',
																																													_0: 'DeepSkyBlue',
																																													_1: {
																																														ctor: '_Tuple2',
																																														_0: {ctor: '_Tuple3', _0: 0, _1: 191, _2: 255},
																																														_1: {ctor: '_Tuple3', _0: 195, _1: 1, _2: 0.5}
																																													}
																																												},
																																												_1: {
																																													ctor: '::',
																																													_0: {
																																														ctor: '_Tuple2',
																																														_0: 'DimGray',
																																														_1: {
																																															ctor: '_Tuple2',
																																															_0: {ctor: '_Tuple3', _0: 105, _1: 105, _2: 105},
																																															_1: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0.41}
																																														}
																																													},
																																													_1: {
																																														ctor: '::',
																																														_0: {
																																															ctor: '_Tuple2',
																																															_0: 'DimGrey',
																																															_1: {
																																																ctor: '_Tuple2',
																																																_0: {ctor: '_Tuple3', _0: 105, _1: 105, _2: 105},
																																																_1: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0.41}
																																															}
																																														},
																																														_1: {
																																															ctor: '::',
																																															_0: {
																																																ctor: '_Tuple2',
																																																_0: 'DodgerBlue',
																																																_1: {
																																																	ctor: '_Tuple2',
																																																	_0: {ctor: '_Tuple3', _0: 30, _1: 144, _2: 255},
																																																	_1: {ctor: '_Tuple3', _0: 210, _1: 1, _2: 0.56}
																																																}
																																															},
																																															_1: {
																																																ctor: '::',
																																																_0: {
																																																	ctor: '_Tuple2',
																																																	_0: 'FireBrick',
																																																	_1: {
																																																		ctor: '_Tuple2',
																																																		_0: {ctor: '_Tuple3', _0: 178, _1: 34, _2: 34},
																																																		_1: {ctor: '_Tuple3', _0: 0, _1: 0.68, _2: 0.42}
																																																	}
																																																},
																																																_1: {
																																																	ctor: '::',
																																																	_0: {
																																																		ctor: '_Tuple2',
																																																		_0: 'FloralWhite',
																																																		_1: {
																																																			ctor: '_Tuple2',
																																																			_0: {ctor: '_Tuple3', _0: 255, _1: 250, _2: 240},
																																																			_1: {ctor: '_Tuple3', _0: 40, _1: 1, _2: 0.97}
																																																		}
																																																	},
																																																	_1: {
																																																		ctor: '::',
																																																		_0: {
																																																			ctor: '_Tuple2',
																																																			_0: 'ForestGreen',
																																																			_1: {
																																																				ctor: '_Tuple2',
																																																				_0: {ctor: '_Tuple3', _0: 34, _1: 139, _2: 34},
																																																				_1: {ctor: '_Tuple3', _0: 120, _1: 0.61, _2: 0.34}
																																																			}
																																																		},
																																																		_1: {
																																																			ctor: '::',
																																																			_0: {
																																																				ctor: '_Tuple2',
																																																				_0: 'Fuchsia',
																																																				_1: {
																																																					ctor: '_Tuple2',
																																																					_0: {ctor: '_Tuple3', _0: 255, _1: 0, _2: 255},
																																																					_1: {ctor: '_Tuple3', _0: 300, _1: 1, _2: 0.5}
																																																				}
																																																			},
																																																			_1: {
																																																				ctor: '::',
																																																				_0: {
																																																					ctor: '_Tuple2',
																																																					_0: 'Gainsboro',
																																																					_1: {
																																																						ctor: '_Tuple2',
																																																						_0: {ctor: '_Tuple3', _0: 220, _1: 220, _2: 220},
																																																						_1: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0.86}
																																																					}
																																																				},
																																																				_1: {
																																																					ctor: '::',
																																																					_0: {
																																																						ctor: '_Tuple2',
																																																						_0: 'GhostWhite',
																																																						_1: {
																																																							ctor: '_Tuple2',
																																																							_0: {ctor: '_Tuple3', _0: 248, _1: 248, _2: 255},
																																																							_1: {ctor: '_Tuple3', _0: 240, _1: 1, _2: 0.99}
																																																						}
																																																					},
																																																					_1: {
																																																						ctor: '::',
																																																						_0: {
																																																							ctor: '_Tuple2',
																																																							_0: 'Gold',
																																																							_1: {
																																																								ctor: '_Tuple2',
																																																								_0: {ctor: '_Tuple3', _0: 255, _1: 215, _2: 0},
																																																								_1: {ctor: '_Tuple3', _0: 51, _1: 1, _2: 0.5}
																																																							}
																																																						},
																																																						_1: {
																																																							ctor: '::',
																																																							_0: {
																																																								ctor: '_Tuple2',
																																																								_0: 'GoldenRod',
																																																								_1: {
																																																									ctor: '_Tuple2',
																																																									_0: {ctor: '_Tuple3', _0: 218, _1: 165, _2: 32},
																																																									_1: {ctor: '_Tuple3', _0: 43, _1: 0.74, _2: 0.49}
																																																								}
																																																							},
																																																							_1: {
																																																								ctor: '::',
																																																								_0: {
																																																									ctor: '_Tuple2',
																																																									_0: 'Gray',
																																																									_1: {
																																																										ctor: '_Tuple2',
																																																										_0: {ctor: '_Tuple3', _0: 128, _1: 128, _2: 128},
																																																										_1: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0.5}
																																																									}
																																																								},
																																																								_1: {
																																																									ctor: '::',
																																																									_0: {
																																																										ctor: '_Tuple2',
																																																										_0: 'Grey',
																																																										_1: {
																																																											ctor: '_Tuple2',
																																																											_0: {ctor: '_Tuple3', _0: 128, _1: 128, _2: 128},
																																																											_1: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0.5}
																																																										}
																																																									},
																																																									_1: {
																																																										ctor: '::',
																																																										_0: {
																																																											ctor: '_Tuple2',
																																																											_0: 'Green',
																																																											_1: {
																																																												ctor: '_Tuple2',
																																																												_0: {ctor: '_Tuple3', _0: 0, _1: 128, _2: 0},
																																																												_1: {ctor: '_Tuple3', _0: 120, _1: 1, _2: 0.25}
																																																											}
																																																										},
																																																										_1: {
																																																											ctor: '::',
																																																											_0: {
																																																												ctor: '_Tuple2',
																																																												_0: 'GreenYellow',
																																																												_1: {
																																																													ctor: '_Tuple2',
																																																													_0: {ctor: '_Tuple3', _0: 173, _1: 255, _2: 47},
																																																													_1: {ctor: '_Tuple3', _0: 84, _1: 1, _2: 0.59}
																																																												}
																																																											},
																																																											_1: {
																																																												ctor: '::',
																																																												_0: {
																																																													ctor: '_Tuple2',
																																																													_0: 'HoneyDew',
																																																													_1: {
																																																														ctor: '_Tuple2',
																																																														_0: {ctor: '_Tuple3', _0: 240, _1: 255, _2: 240},
																																																														_1: {ctor: '_Tuple3', _0: 120, _1: 1, _2: 0.97}
																																																													}
																																																												},
																																																												_1: {
																																																													ctor: '::',
																																																													_0: {
																																																														ctor: '_Tuple2',
																																																														_0: 'HotPink',
																																																														_1: {
																																																															ctor: '_Tuple2',
																																																															_0: {ctor: '_Tuple3', _0: 255, _1: 105, _2: 180},
																																																															_1: {ctor: '_Tuple3', _0: 330, _1: 1, _2: 0.71}
																																																														}
																																																													},
																																																													_1: {
																																																														ctor: '::',
																																																														_0: {
																																																															ctor: '_Tuple2',
																																																															_0: 'IndianRed ',
																																																															_1: {
																																																																ctor: '_Tuple2',
																																																																_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0},
																																																																_1: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0}
																																																															}
																																																														},
																																																														_1: {
																																																															ctor: '::',
																																																															_0: {
																																																																ctor: '_Tuple2',
																																																																_0: 'Indigo  ',
																																																																_1: {
																																																																	ctor: '_Tuple2',
																																																																	_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0},
																																																																	_1: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0}
																																																																}
																																																															},
																																																															_1: {
																																																																ctor: '::',
																																																																_0: {
																																																																	ctor: '_Tuple2',
																																																																	_0: 'Ivory',
																																																																	_1: {
																																																																		ctor: '_Tuple2',
																																																																		_0: {ctor: '_Tuple3', _0: 255, _1: 255, _2: 240},
																																																																		_1: {ctor: '_Tuple3', _0: 60, _1: 1, _2: 0.97}
																																																																	}
																																																																},
																																																																_1: {
																																																																	ctor: '::',
																																																																	_0: {
																																																																		ctor: '_Tuple2',
																																																																		_0: 'Khaki',
																																																																		_1: {
																																																																			ctor: '_Tuple2',
																																																																			_0: {ctor: '_Tuple3', _0: 240, _1: 230, _2: 140},
																																																																			_1: {ctor: '_Tuple3', _0: 54, _1: 0.77, _2: 0.75}
																																																																		}
																																																																	},
																																																																	_1: {
																																																																		ctor: '::',
																																																																		_0: {
																																																																			ctor: '_Tuple2',
																																																																			_0: 'Lavender',
																																																																			_1: {
																																																																				ctor: '_Tuple2',
																																																																				_0: {ctor: '_Tuple3', _0: 230, _1: 230, _2: 250},
																																																																				_1: {ctor: '_Tuple3', _0: 240, _1: 0.67, _2: 0.94}
																																																																			}
																																																																		},
																																																																		_1: {
																																																																			ctor: '::',
																																																																			_0: {
																																																																				ctor: '_Tuple2',
																																																																				_0: 'LavenderBlush',
																																																																				_1: {
																																																																					ctor: '_Tuple2',
																																																																					_0: {ctor: '_Tuple3', _0: 255, _1: 240, _2: 245},
																																																																					_1: {ctor: '_Tuple3', _0: 340, _1: 1, _2: 0.97}
																																																																				}
																																																																			},
																																																																			_1: {
																																																																				ctor: '::',
																																																																				_0: {
																																																																					ctor: '_Tuple2',
																																																																					_0: 'LawnGreen',
																																																																					_1: {
																																																																						ctor: '_Tuple2',
																																																																						_0: {ctor: '_Tuple3', _0: 124, _1: 252, _2: 0},
																																																																						_1: {ctor: '_Tuple3', _0: 90, _1: 1, _2: 0.49}
																																																																					}
																																																																				},
																																																																				_1: {
																																																																					ctor: '::',
																																																																					_0: {
																																																																						ctor: '_Tuple2',
																																																																						_0: 'LemonChiffon',
																																																																						_1: {
																																																																							ctor: '_Tuple2',
																																																																							_0: {ctor: '_Tuple3', _0: 255, _1: 250, _2: 205},
																																																																							_1: {ctor: '_Tuple3', _0: 54, _1: 1, _2: 0.9}
																																																																						}
																																																																					},
																																																																					_1: {
																																																																						ctor: '::',
																																																																						_0: {
																																																																							ctor: '_Tuple2',
																																																																							_0: 'LightBlue',
																																																																							_1: {
																																																																								ctor: '_Tuple2',
																																																																								_0: {ctor: '_Tuple3', _0: 173, _1: 216, _2: 230},
																																																																								_1: {ctor: '_Tuple3', _0: 195, _1: 0.53, _2: 0.79}
																																																																							}
																																																																						},
																																																																						_1: {
																																																																							ctor: '::',
																																																																							_0: {
																																																																								ctor: '_Tuple2',
																																																																								_0: 'LightCoral',
																																																																								_1: {
																																																																									ctor: '_Tuple2',
																																																																									_0: {ctor: '_Tuple3', _0: 240, _1: 128, _2: 128},
																																																																									_1: {ctor: '_Tuple3', _0: 0, _1: 0.79, _2: 0.72}
																																																																								}
																																																																							},
																																																																							_1: {
																																																																								ctor: '::',
																																																																								_0: {
																																																																									ctor: '_Tuple2',
																																																																									_0: 'LightCyan',
																																																																									_1: {
																																																																										ctor: '_Tuple2',
																																																																										_0: {ctor: '_Tuple3', _0: 224, _1: 255, _2: 255},
																																																																										_1: {ctor: '_Tuple3', _0: 180, _1: 1, _2: 0.94}
																																																																									}
																																																																								},
																																																																								_1: {
																																																																									ctor: '::',
																																																																									_0: {
																																																																										ctor: '_Tuple2',
																																																																										_0: 'LightGoldenRodYellow',
																																																																										_1: {
																																																																											ctor: '_Tuple2',
																																																																											_0: {ctor: '_Tuple3', _0: 250, _1: 250, _2: 210},
																																																																											_1: {ctor: '_Tuple3', _0: 60, _1: 0.8, _2: 0.9}
																																																																										}
																																																																									},
																																																																									_1: {
																																																																										ctor: '::',
																																																																										_0: {
																																																																											ctor: '_Tuple2',
																																																																											_0: 'LightGray',
																																																																											_1: {
																																																																												ctor: '_Tuple2',
																																																																												_0: {ctor: '_Tuple3', _0: 211, _1: 211, _2: 211},
																																																																												_1: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0.83}
																																																																											}
																																																																										},
																																																																										_1: {
																																																																											ctor: '::',
																																																																											_0: {
																																																																												ctor: '_Tuple2',
																																																																												_0: 'LightGrey',
																																																																												_1: {
																																																																													ctor: '_Tuple2',
																																																																													_0: {ctor: '_Tuple3', _0: 211, _1: 211, _2: 211},
																																																																													_1: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0.83}
																																																																												}
																																																																											},
																																																																											_1: {
																																																																												ctor: '::',
																																																																												_0: {
																																																																													ctor: '_Tuple2',
																																																																													_0: 'LightGreen',
																																																																													_1: {
																																																																														ctor: '_Tuple2',
																																																																														_0: {ctor: '_Tuple3', _0: 144, _1: 238, _2: 144},
																																																																														_1: {ctor: '_Tuple3', _0: 120, _1: 0.73, _2: 0.75}
																																																																													}
																																																																												},
																																																																												_1: {
																																																																													ctor: '::',
																																																																													_0: {
																																																																														ctor: '_Tuple2',
																																																																														_0: 'LightPink',
																																																																														_1: {
																																																																															ctor: '_Tuple2',
																																																																															_0: {ctor: '_Tuple3', _0: 255, _1: 182, _2: 193},
																																																																															_1: {ctor: '_Tuple3', _0: 351, _1: 1, _2: 0.86}
																																																																														}
																																																																													},
																																																																													_1: {ctor: '[]'}
																																																																												}
																																																																											}
																																																																										}
																																																																									}
																																																																								}
																																																																							}
																																																																						}
																																																																					}
																																																																				}
																																																																			}
																																																																		}
																																																																	}
																																																																}
																																																															}
																																																														}
																																																													}
																																																												}
																																																											}
																																																										}
																																																									}
																																																								}
																																																							}
																																																						}
																																																					}
																																																				}
																																																			}
																																																		}
																																																	}
																																																}
																																															}
																																														}
																																													}
																																												}
																																											}
																																										}
																																									}
																																								}
																																							}
																																						}
																																					}
																																				}
																																			}
																																		}
																																	}
																																}
																															}
																														}
																													}
																												}
																											}
																										}
																									}
																								}
																							}
																						}
																					}
																				}
																			}
																		}
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}),
	{
		ctor: '::',
		_0: {
			ctor: '_Tuple2',
			_0: 'LightSalmon',
			_1: {
				ctor: '_Tuple2',
				_0: {ctor: '_Tuple3', _0: 255, _1: 160, _2: 122},
				_1: {ctor: '_Tuple3', _0: 17, _1: 1, _2: 0.74}
			}
		},
		_1: {
			ctor: '::',
			_0: {
				ctor: '_Tuple2',
				_0: 'LightSeaGreen',
				_1: {
					ctor: '_Tuple2',
					_0: {ctor: '_Tuple3', _0: 32, _1: 178, _2: 170},
					_1: {ctor: '_Tuple3', _0: 177, _1: 0.7, _2: 0.41}
				}
			},
			_1: {
				ctor: '::',
				_0: {
					ctor: '_Tuple2',
					_0: 'LightSkyBlue',
					_1: {
						ctor: '_Tuple2',
						_0: {ctor: '_Tuple3', _0: 135, _1: 206, _2: 250},
						_1: {ctor: '_Tuple3', _0: 203, _1: 0.92, _2: 0.75}
					}
				},
				_1: {
					ctor: '::',
					_0: {
						ctor: '_Tuple2',
						_0: 'LightSlateGray',
						_1: {
							ctor: '_Tuple2',
							_0: {ctor: '_Tuple3', _0: 119, _1: 136, _2: 153},
							_1: {ctor: '_Tuple3', _0: 210, _1: 0.14, _2: 0.53}
						}
					},
					_1: {
						ctor: '::',
						_0: {
							ctor: '_Tuple2',
							_0: 'LightSlateGrey',
							_1: {
								ctor: '_Tuple2',
								_0: {ctor: '_Tuple3', _0: 119, _1: 136, _2: 153},
								_1: {ctor: '_Tuple3', _0: 210, _1: 0.14, _2: 0.53}
							}
						},
						_1: {
							ctor: '::',
							_0: {
								ctor: '_Tuple2',
								_0: 'LightSteelBlue',
								_1: {
									ctor: '_Tuple2',
									_0: {ctor: '_Tuple3', _0: 176, _1: 196, _2: 222},
									_1: {ctor: '_Tuple3', _0: 214, _1: 0.41, _2: 0.78}
								}
							},
							_1: {
								ctor: '::',
								_0: {
									ctor: '_Tuple2',
									_0: 'LightYellow',
									_1: {
										ctor: '_Tuple2',
										_0: {ctor: '_Tuple3', _0: 255, _1: 255, _2: 224},
										_1: {ctor: '_Tuple3', _0: 60, _1: 1, _2: 0.94}
									}
								},
								_1: {
									ctor: '::',
									_0: {
										ctor: '_Tuple2',
										_0: 'Lime',
										_1: {
											ctor: '_Tuple2',
											_0: {ctor: '_Tuple3', _0: 0, _1: 255, _2: 0},
											_1: {ctor: '_Tuple3', _0: 120, _1: 1, _2: 0.5}
										}
									},
									_1: {
										ctor: '::',
										_0: {
											ctor: '_Tuple2',
											_0: 'LimeGreen',
											_1: {
												ctor: '_Tuple2',
												_0: {ctor: '_Tuple3', _0: 50, _1: 205, _2: 50},
												_1: {ctor: '_Tuple3', _0: 120, _1: 0.61, _2: 0.5}
											}
										},
										_1: {
											ctor: '::',
											_0: {
												ctor: '_Tuple2',
												_0: 'Linen',
												_1: {
													ctor: '_Tuple2',
													_0: {ctor: '_Tuple3', _0: 250, _1: 240, _2: 230},
													_1: {ctor: '_Tuple3', _0: 30, _1: 0.67, _2: 0.94}
												}
											},
											_1: {
												ctor: '::',
												_0: {
													ctor: '_Tuple2',
													_0: 'Magenta',
													_1: {
														ctor: '_Tuple2',
														_0: {ctor: '_Tuple3', _0: 255, _1: 0, _2: 255},
														_1: {ctor: '_Tuple3', _0: 300, _1: 1, _2: 0.5}
													}
												},
												_1: {
													ctor: '::',
													_0: {
														ctor: '_Tuple2',
														_0: 'Maroon',
														_1: {
															ctor: '_Tuple2',
															_0: {ctor: '_Tuple3', _0: 128, _1: 0, _2: 0},
															_1: {ctor: '_Tuple3', _0: 0, _1: 1, _2: 0.25}
														}
													},
													_1: {
														ctor: '::',
														_0: {
															ctor: '_Tuple2',
															_0: 'MediumAquaMarine',
															_1: {
																ctor: '_Tuple2',
																_0: {ctor: '_Tuple3', _0: 102, _1: 205, _2: 170},
																_1: {ctor: '_Tuple3', _0: 160, _1: 0.51, _2: 0.6}
															}
														},
														_1: {
															ctor: '::',
															_0: {
																ctor: '_Tuple2',
																_0: 'MediumBlue',
																_1: {
																	ctor: '_Tuple2',
																	_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 205},
																	_1: {ctor: '_Tuple3', _0: 240, _1: 1, _2: 0.4}
																}
															},
															_1: {
																ctor: '::',
																_0: {
																	ctor: '_Tuple2',
																	_0: 'MediumOrchid',
																	_1: {
																		ctor: '_Tuple2',
																		_0: {ctor: '_Tuple3', _0: 186, _1: 85, _2: 211},
																		_1: {ctor: '_Tuple3', _0: 288, _1: 0.59, _2: 0.58}
																	}
																},
																_1: {
																	ctor: '::',
																	_0: {
																		ctor: '_Tuple2',
																		_0: 'MediumPurple',
																		_1: {
																			ctor: '_Tuple2',
																			_0: {ctor: '_Tuple3', _0: 147, _1: 112, _2: 219},
																			_1: {ctor: '_Tuple3', _0: 260, _1: 0.6, _2: 0.65}
																		}
																	},
																	_1: {
																		ctor: '::',
																		_0: {
																			ctor: '_Tuple2',
																			_0: 'MediumSeaGreen',
																			_1: {
																				ctor: '_Tuple2',
																				_0: {ctor: '_Tuple3', _0: 60, _1: 179, _2: 113},
																				_1: {ctor: '_Tuple3', _0: 147, _1: 0.5, _2: 0.47}
																			}
																		},
																		_1: {
																			ctor: '::',
																			_0: {
																				ctor: '_Tuple2',
																				_0: 'MediumSlateBlue',
																				_1: {
																					ctor: '_Tuple2',
																					_0: {ctor: '_Tuple3', _0: 123, _1: 104, _2: 238},
																					_1: {ctor: '_Tuple3', _0: 249, _1: 0.8, _2: 0.67}
																				}
																			},
																			_1: {
																				ctor: '::',
																				_0: {
																					ctor: '_Tuple2',
																					_0: 'MediumSpringGreen',
																					_1: {
																						ctor: '_Tuple2',
																						_0: {ctor: '_Tuple3', _0: 0, _1: 250, _2: 154},
																						_1: {ctor: '_Tuple3', _0: 157, _1: 1, _2: 0.49}
																					}
																				},
																				_1: {
																					ctor: '::',
																					_0: {
																						ctor: '_Tuple2',
																						_0: 'MediumTurquoise',
																						_1: {
																							ctor: '_Tuple2',
																							_0: {ctor: '_Tuple3', _0: 72, _1: 209, _2: 204},
																							_1: {ctor: '_Tuple3', _0: 178, _1: 0.6, _2: 0.55}
																						}
																					},
																					_1: {
																						ctor: '::',
																						_0: {
																							ctor: '_Tuple2',
																							_0: 'MediumVioletRed',
																							_1: {
																								ctor: '_Tuple2',
																								_0: {ctor: '_Tuple3', _0: 199, _1: 21, _2: 133},
																								_1: {ctor: '_Tuple3', _0: 322, _1: 0.81, _2: 0.43}
																							}
																						},
																						_1: {
																							ctor: '::',
																							_0: {
																								ctor: '_Tuple2',
																								_0: 'MidnightBlue',
																								_1: {
																									ctor: '_Tuple2',
																									_0: {ctor: '_Tuple3', _0: 25, _1: 25, _2: 112},
																									_1: {ctor: '_Tuple3', _0: 240, _1: 0.64, _2: 0.27}
																								}
																							},
																							_1: {
																								ctor: '::',
																								_0: {
																									ctor: '_Tuple2',
																									_0: 'MintCream',
																									_1: {
																										ctor: '_Tuple2',
																										_0: {ctor: '_Tuple3', _0: 245, _1: 255, _2: 250},
																										_1: {ctor: '_Tuple3', _0: 150, _1: 1, _2: 0.98}
																									}
																								},
																								_1: {
																									ctor: '::',
																									_0: {
																										ctor: '_Tuple2',
																										_0: 'MistyRose',
																										_1: {
																											ctor: '_Tuple2',
																											_0: {ctor: '_Tuple3', _0: 255, _1: 228, _2: 225},
																											_1: {ctor: '_Tuple3', _0: 6, _1: 1, _2: 0.94}
																										}
																									},
																									_1: {
																										ctor: '::',
																										_0: {
																											ctor: '_Tuple2',
																											_0: 'Moccasin',
																											_1: {
																												ctor: '_Tuple2',
																												_0: {ctor: '_Tuple3', _0: 255, _1: 228, _2: 181},
																												_1: {ctor: '_Tuple3', _0: 38, _1: 1, _2: 0.85}
																											}
																										},
																										_1: {
																											ctor: '::',
																											_0: {
																												ctor: '_Tuple2',
																												_0: 'NavajoWhite',
																												_1: {
																													ctor: '_Tuple2',
																													_0: {ctor: '_Tuple3', _0: 255, _1: 222, _2: 173},
																													_1: {ctor: '_Tuple3', _0: 36, _1: 1, _2: 0.84}
																												}
																											},
																											_1: {
																												ctor: '::',
																												_0: {
																													ctor: '_Tuple2',
																													_0: 'Navy',
																													_1: {
																														ctor: '_Tuple2',
																														_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 128},
																														_1: {ctor: '_Tuple3', _0: 240, _1: 1, _2: 0.25}
																													}
																												},
																												_1: {
																													ctor: '::',
																													_0: {
																														ctor: '_Tuple2',
																														_0: 'OldLace',
																														_1: {
																															ctor: '_Tuple2',
																															_0: {ctor: '_Tuple3', _0: 253, _1: 245, _2: 230},
																															_1: {ctor: '_Tuple3', _0: 39, _1: 0.85, _2: 0.95}
																														}
																													},
																													_1: {
																														ctor: '::',
																														_0: {
																															ctor: '_Tuple2',
																															_0: 'Olive',
																															_1: {
																																ctor: '_Tuple2',
																																_0: {ctor: '_Tuple3', _0: 128, _1: 128, _2: 0},
																																_1: {ctor: '_Tuple3', _0: 60, _1: 1, _2: 0.25}
																															}
																														},
																														_1: {
																															ctor: '::',
																															_0: {
																																ctor: '_Tuple2',
																																_0: 'OliveDrab',
																																_1: {
																																	ctor: '_Tuple2',
																																	_0: {ctor: '_Tuple3', _0: 107, _1: 142, _2: 35},
																																	_1: {ctor: '_Tuple3', _0: 80, _1: 0.6, _2: 0.35}
																																}
																															},
																															_1: {
																																ctor: '::',
																																_0: {
																																	ctor: '_Tuple2',
																																	_0: 'Orange',
																																	_1: {
																																		ctor: '_Tuple2',
																																		_0: {ctor: '_Tuple3', _0: 255, _1: 165, _2: 0},
																																		_1: {ctor: '_Tuple3', _0: 39, _1: 1, _2: 0.5}
																																	}
																																},
																																_1: {
																																	ctor: '::',
																																	_0: {
																																		ctor: '_Tuple2',
																																		_0: 'OrangeRed',
																																		_1: {
																																			ctor: '_Tuple2',
																																			_0: {ctor: '_Tuple3', _0: 255, _1: 69, _2: 0},
																																			_1: {ctor: '_Tuple3', _0: 16, _1: 1, _2: 0.5}
																																		}
																																	},
																																	_1: {
																																		ctor: '::',
																																		_0: {
																																			ctor: '_Tuple2',
																																			_0: 'Orchid',
																																			_1: {
																																				ctor: '_Tuple2',
																																				_0: {ctor: '_Tuple3', _0: 218, _1: 112, _2: 214},
																																				_1: {ctor: '_Tuple3', _0: 302, _1: 0.59, _2: 0.65}
																																			}
																																		},
																																		_1: {
																																			ctor: '::',
																																			_0: {
																																				ctor: '_Tuple2',
																																				_0: 'PaleGoldenRod',
																																				_1: {
																																					ctor: '_Tuple2',
																																					_0: {ctor: '_Tuple3', _0: 238, _1: 232, _2: 170},
																																					_1: {ctor: '_Tuple3', _0: 55, _1: 0.67, _2: 0.8}
																																				}
																																			},
																																			_1: {
																																				ctor: '::',
																																				_0: {
																																					ctor: '_Tuple2',
																																					_0: 'PaleGreen',
																																					_1: {
																																						ctor: '_Tuple2',
																																						_0: {ctor: '_Tuple3', _0: 152, _1: 251, _2: 152},
																																						_1: {ctor: '_Tuple3', _0: 120, _1: 0.93, _2: 0.79}
																																					}
																																				},
																																				_1: {
																																					ctor: '::',
																																					_0: {
																																						ctor: '_Tuple2',
																																						_0: 'PaleTurquoise',
																																						_1: {
																																							ctor: '_Tuple2',
																																							_0: {ctor: '_Tuple3', _0: 175, _1: 238, _2: 238},
																																							_1: {ctor: '_Tuple3', _0: 180, _1: 0.65, _2: 0.81}
																																						}
																																					},
																																					_1: {
																																						ctor: '::',
																																						_0: {
																																							ctor: '_Tuple2',
																																							_0: 'PaleVioletRed',
																																							_1: {
																																								ctor: '_Tuple2',
																																								_0: {ctor: '_Tuple3', _0: 219, _1: 112, _2: 147},
																																								_1: {ctor: '_Tuple3', _0: 340, _1: 0.6, _2: 0.65}
																																							}
																																						},
																																						_1: {
																																							ctor: '::',
																																							_0: {
																																								ctor: '_Tuple2',
																																								_0: 'PapayaWhip',
																																								_1: {
																																									ctor: '_Tuple2',
																																									_0: {ctor: '_Tuple3', _0: 255, _1: 239, _2: 213},
																																									_1: {ctor: '_Tuple3', _0: 37, _1: 1, _2: 0.92}
																																								}
																																							},
																																							_1: {
																																								ctor: '::',
																																								_0: {
																																									ctor: '_Tuple2',
																																									_0: 'PeachPuff',
																																									_1: {
																																										ctor: '_Tuple2',
																																										_0: {ctor: '_Tuple3', _0: 255, _1: 218, _2: 185},
																																										_1: {ctor: '_Tuple3', _0: 28, _1: 1, _2: 0.86}
																																									}
																																								},
																																								_1: {
																																									ctor: '::',
																																									_0: {
																																										ctor: '_Tuple2',
																																										_0: 'Peru',
																																										_1: {
																																											ctor: '_Tuple2',
																																											_0: {ctor: '_Tuple3', _0: 205, _1: 133, _2: 63},
																																											_1: {ctor: '_Tuple3', _0: 30, _1: 0.59, _2: 0.53}
																																										}
																																									},
																																									_1: {
																																										ctor: '::',
																																										_0: {
																																											ctor: '_Tuple2',
																																											_0: 'Pink',
																																											_1: {
																																												ctor: '_Tuple2',
																																												_0: {ctor: '_Tuple3', _0: 255, _1: 192, _2: 203},
																																												_1: {ctor: '_Tuple3', _0: 350, _1: 1, _2: 0.88}
																																											}
																																										},
																																										_1: {
																																											ctor: '::',
																																											_0: {
																																												ctor: '_Tuple2',
																																												_0: 'Plum',
																																												_1: {
																																													ctor: '_Tuple2',
																																													_0: {ctor: '_Tuple3', _0: 221, _1: 160, _2: 221},
																																													_1: {ctor: '_Tuple3', _0: 300, _1: 0.47, _2: 0.75}
																																												}
																																											},
																																											_1: {
																																												ctor: '::',
																																												_0: {
																																													ctor: '_Tuple2',
																																													_0: 'PowderBlue',
																																													_1: {
																																														ctor: '_Tuple2',
																																														_0: {ctor: '_Tuple3', _0: 176, _1: 224, _2: 230},
																																														_1: {ctor: '_Tuple3', _0: 187, _1: 0.52, _2: 0.8}
																																													}
																																												},
																																												_1: {
																																													ctor: '::',
																																													_0: {
																																														ctor: '_Tuple2',
																																														_0: 'Purple',
																																														_1: {
																																															ctor: '_Tuple2',
																																															_0: {ctor: '_Tuple3', _0: 128, _1: 0, _2: 128},
																																															_1: {ctor: '_Tuple3', _0: 300, _1: 1, _2: 0.25}
																																														}
																																													},
																																													_1: {
																																														ctor: '::',
																																														_0: {
																																															ctor: '_Tuple2',
																																															_0: 'RebeccaPurple',
																																															_1: {
																																																ctor: '_Tuple2',
																																																_0: {ctor: '_Tuple3', _0: 102, _1: 51, _2: 153},
																																																_1: {ctor: '_Tuple3', _0: 270, _1: 0.5, _2: 0.4}
																																															}
																																														},
																																														_1: {
																																															ctor: '::',
																																															_0: {
																																																ctor: '_Tuple2',
																																																_0: 'Red',
																																																_1: {
																																																	ctor: '_Tuple2',
																																																	_0: {ctor: '_Tuple3', _0: 255, _1: 0, _2: 0},
																																																	_1: {ctor: '_Tuple3', _0: 0, _1: 1, _2: 0.5}
																																																}
																																															},
																																															_1: {
																																																ctor: '::',
																																																_0: {
																																																	ctor: '_Tuple2',
																																																	_0: 'RosyBrown',
																																																	_1: {
																																																		ctor: '_Tuple2',
																																																		_0: {ctor: '_Tuple3', _0: 188, _1: 143, _2: 143},
																																																		_1: {ctor: '_Tuple3', _0: 0, _1: 0.25, _2: 0.65}
																																																	}
																																																},
																																																_1: {
																																																	ctor: '::',
																																																	_0: {
																																																		ctor: '_Tuple2',
																																																		_0: 'RoyalBlue',
																																																		_1: {
																																																			ctor: '_Tuple2',
																																																			_0: {ctor: '_Tuple3', _0: 65, _1: 105, _2: 225},
																																																			_1: {ctor: '_Tuple3', _0: 225, _1: 0.73, _2: 0.57}
																																																		}
																																																	},
																																																	_1: {
																																																		ctor: '::',
																																																		_0: {
																																																			ctor: '_Tuple2',
																																																			_0: 'SaddleBrown',
																																																			_1: {
																																																				ctor: '_Tuple2',
																																																				_0: {ctor: '_Tuple3', _0: 139, _1: 69, _2: 19},
																																																				_1: {ctor: '_Tuple3', _0: 25, _1: 0.76, _2: 0.31}
																																																			}
																																																		},
																																																		_1: {
																																																			ctor: '::',
																																																			_0: {
																																																				ctor: '_Tuple2',
																																																				_0: 'Salmon',
																																																				_1: {
																																																					ctor: '_Tuple2',
																																																					_0: {ctor: '_Tuple3', _0: 250, _1: 128, _2: 114},
																																																					_1: {ctor: '_Tuple3', _0: 6, _1: 0.93, _2: 0.71}
																																																				}
																																																			},
																																																			_1: {
																																																				ctor: '::',
																																																				_0: {
																																																					ctor: '_Tuple2',
																																																					_0: 'SandyBrown',
																																																					_1: {
																																																						ctor: '_Tuple2',
																																																						_0: {ctor: '_Tuple3', _0: 244, _1: 164, _2: 96},
																																																						_1: {ctor: '_Tuple3', _0: 28, _1: 0.87, _2: 0.67}
																																																					}
																																																				},
																																																				_1: {
																																																					ctor: '::',
																																																					_0: {
																																																						ctor: '_Tuple2',
																																																						_0: 'SeaGreen',
																																																						_1: {
																																																							ctor: '_Tuple2',
																																																							_0: {ctor: '_Tuple3', _0: 46, _1: 139, _2: 87},
																																																							_1: {ctor: '_Tuple3', _0: 146, _1: 0.5, _2: 0.36}
																																																						}
																																																					},
																																																					_1: {
																																																						ctor: '::',
																																																						_0: {
																																																							ctor: '_Tuple2',
																																																							_0: 'SeaShell',
																																																							_1: {
																																																								ctor: '_Tuple2',
																																																								_0: {ctor: '_Tuple3', _0: 255, _1: 245, _2: 238},
																																																								_1: {ctor: '_Tuple3', _0: 25, _1: 1, _2: 0.97}
																																																							}
																																																						},
																																																						_1: {
																																																							ctor: '::',
																																																							_0: {
																																																								ctor: '_Tuple2',
																																																								_0: 'Sienna',
																																																								_1: {
																																																									ctor: '_Tuple2',
																																																									_0: {ctor: '_Tuple3', _0: 160, _1: 82, _2: 45},
																																																									_1: {ctor: '_Tuple3', _0: 19, _1: 0.56, _2: 0.4}
																																																								}
																																																							},
																																																							_1: {
																																																								ctor: '::',
																																																								_0: {
																																																									ctor: '_Tuple2',
																																																									_0: 'Silver',
																																																									_1: {
																																																										ctor: '_Tuple2',
																																																										_0: {ctor: '_Tuple3', _0: 192, _1: 192, _2: 192},
																																																										_1: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0.75}
																																																									}
																																																								},
																																																								_1: {
																																																									ctor: '::',
																																																									_0: {
																																																										ctor: '_Tuple2',
																																																										_0: 'SkyBlue',
																																																										_1: {
																																																											ctor: '_Tuple2',
																																																											_0: {ctor: '_Tuple3', _0: 135, _1: 206, _2: 235},
																																																											_1: {ctor: '_Tuple3', _0: 197, _1: 0.71, _2: 0.73}
																																																										}
																																																									},
																																																									_1: {
																																																										ctor: '::',
																																																										_0: {
																																																											ctor: '_Tuple2',
																																																											_0: 'SlateBlue',
																																																											_1: {
																																																												ctor: '_Tuple2',
																																																												_0: {ctor: '_Tuple3', _0: 106, _1: 90, _2: 205},
																																																												_1: {ctor: '_Tuple3', _0: 248, _1: 0.53, _2: 0.58}
																																																											}
																																																										},
																																																										_1: {
																																																											ctor: '::',
																																																											_0: {
																																																												ctor: '_Tuple2',
																																																												_0: 'SlateGray',
																																																												_1: {
																																																													ctor: '_Tuple2',
																																																													_0: {ctor: '_Tuple3', _0: 112, _1: 128, _2: 144},
																																																													_1: {ctor: '_Tuple3', _0: 210, _1: 0.13, _2: 0.5}
																																																												}
																																																											},
																																																											_1: {
																																																												ctor: '::',
																																																												_0: {
																																																													ctor: '_Tuple2',
																																																													_0: 'SlateGrey',
																																																													_1: {
																																																														ctor: '_Tuple2',
																																																														_0: {ctor: '_Tuple3', _0: 112, _1: 128, _2: 144},
																																																														_1: {ctor: '_Tuple3', _0: 210, _1: 0.13, _2: 0.5}
																																																													}
																																																												},
																																																												_1: {
																																																													ctor: '::',
																																																													_0: {
																																																														ctor: '_Tuple2',
																																																														_0: 'Snow',
																																																														_1: {
																																																															ctor: '_Tuple2',
																																																															_0: {ctor: '_Tuple3', _0: 255, _1: 250, _2: 250},
																																																															_1: {ctor: '_Tuple3', _0: 0, _1: 1, _2: 0.99}
																																																														}
																																																													},
																																																													_1: {
																																																														ctor: '::',
																																																														_0: {
																																																															ctor: '_Tuple2',
																																																															_0: 'SpringGreen',
																																																															_1: {
																																																																ctor: '_Tuple2',
																																																																_0: {ctor: '_Tuple3', _0: 0, _1: 255, _2: 127},
																																																																_1: {ctor: '_Tuple3', _0: 150, _1: 1, _2: 0.5}
																																																															}
																																																														},
																																																														_1: {
																																																															ctor: '::',
																																																															_0: {
																																																																ctor: '_Tuple2',
																																																																_0: 'SteelBlue',
																																																																_1: {
																																																																	ctor: '_Tuple2',
																																																																	_0: {ctor: '_Tuple3', _0: 70, _1: 130, _2: 180},
																																																																	_1: {ctor: '_Tuple3', _0: 207, _1: 0.44, _2: 0.49}
																																																																}
																																																															},
																																																															_1: {
																																																																ctor: '::',
																																																																_0: {
																																																																	ctor: '_Tuple2',
																																																																	_0: 'Tan',
																																																																	_1: {
																																																																		ctor: '_Tuple2',
																																																																		_0: {ctor: '_Tuple3', _0: 210, _1: 180, _2: 140},
																																																																		_1: {ctor: '_Tuple3', _0: 34, _1: 0.44, _2: 0.69}
																																																																	}
																																																																},
																																																																_1: {
																																																																	ctor: '::',
																																																																	_0: {
																																																																		ctor: '_Tuple2',
																																																																		_0: 'Teal',
																																																																		_1: {
																																																																			ctor: '_Tuple2',
																																																																			_0: {ctor: '_Tuple3', _0: 0, _1: 128, _2: 128},
																																																																			_1: {ctor: '_Tuple3', _0: 180, _1: 1, _2: 0.25}
																																																																		}
																																																																	},
																																																																	_1: {
																																																																		ctor: '::',
																																																																		_0: {
																																																																			ctor: '_Tuple2',
																																																																			_0: 'Thistle',
																																																																			_1: {
																																																																				ctor: '_Tuple2',
																																																																				_0: {ctor: '_Tuple3', _0: 216, _1: 191, _2: 216},
																																																																				_1: {ctor: '_Tuple3', _0: 300, _1: 0.24, _2: 0.8}
																																																																			}
																																																																		},
																																																																		_1: {
																																																																			ctor: '::',
																																																																			_0: {
																																																																				ctor: '_Tuple2',
																																																																				_0: 'Tomato',
																																																																				_1: {
																																																																					ctor: '_Tuple2',
																																																																					_0: {ctor: '_Tuple3', _0: 255, _1: 99, _2: 71},
																																																																					_1: {ctor: '_Tuple3', _0: 9, _1: 1, _2: 0.64}
																																																																				}
																																																																			},
																																																																			_1: {
																																																																				ctor: '::',
																																																																				_0: {
																																																																					ctor: '_Tuple2',
																																																																					_0: 'Turquoise',
																																																																					_1: {
																																																																						ctor: '_Tuple2',
																																																																						_0: {ctor: '_Tuple3', _0: 64, _1: 224, _2: 208},
																																																																						_1: {ctor: '_Tuple3', _0: 174, _1: 0.72, _2: 0.56}
																																																																					}
																																																																				},
																																																																				_1: {
																																																																					ctor: '::',
																																																																					_0: {
																																																																						ctor: '_Tuple2',
																																																																						_0: 'Violet',
																																																																						_1: {
																																																																							ctor: '_Tuple2',
																																																																							_0: {ctor: '_Tuple3', _0: 238, _1: 130, _2: 238},
																																																																							_1: {ctor: '_Tuple3', _0: 300, _1: 0.76, _2: 0.72}
																																																																						}
																																																																					},
																																																																					_1: {
																																																																						ctor: '::',
																																																																						_0: {
																																																																							ctor: '_Tuple2',
																																																																							_0: 'Wheat',
																																																																							_1: {
																																																																								ctor: '_Tuple2',
																																																																								_0: {ctor: '_Tuple3', _0: 245, _1: 222, _2: 179},
																																																																								_1: {ctor: '_Tuple3', _0: 39, _1: 0.77, _2: 0.83}
																																																																							}
																																																																						},
																																																																						_1: {
																																																																							ctor: '::',
																																																																							_0: {
																																																																								ctor: '_Tuple2',
																																																																								_0: 'White',
																																																																								_1: {
																																																																									ctor: '_Tuple2',
																																																																									_0: {ctor: '_Tuple3', _0: 255, _1: 255, _2: 255},
																																																																									_1: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 1}
																																																																								}
																																																																							},
																																																																							_1: {
																																																																								ctor: '::',
																																																																								_0: {
																																																																									ctor: '_Tuple2',
																																																																									_0: 'WhiteSmoke',
																																																																									_1: {
																																																																										ctor: '_Tuple2',
																																																																										_0: {ctor: '_Tuple3', _0: 245, _1: 245, _2: 245},
																																																																										_1: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0.96}
																																																																									}
																																																																								},
																																																																								_1: {
																																																																									ctor: '::',
																																																																									_0: {
																																																																										ctor: '_Tuple2',
																																																																										_0: 'Yellow',
																																																																										_1: {
																																																																											ctor: '_Tuple2',
																																																																											_0: {ctor: '_Tuple3', _0: 255, _1: 255, _2: 0},
																																																																											_1: {ctor: '_Tuple3', _0: 60, _1: 1, _2: 0.5}
																																																																										}
																																																																									},
																																																																									_1: {
																																																																										ctor: '::',
																																																																										_0: {
																																																																											ctor: '_Tuple2',
																																																																											_0: 'YellowGreen',
																																																																											_1: {
																																																																												ctor: '_Tuple2',
																																																																												_0: {ctor: '_Tuple3', _0: 154, _1: 205, _2: 50},
																																																																												_1: {ctor: '_Tuple3', _0: 80, _1: 0.61, _2: 0.5}
																																																																											}
																																																																										},
																																																																										_1: {ctor: '[]'}
																																																																									}
																																																																								}
																																																																							}
																																																																						}
																																																																					}
																																																																				}
																																																																			}
																																																																		}
																																																																	}
																																																																}
																																																															}
																																																														}
																																																													}
																																																												}
																																																											}
																																																										}
																																																									}
																																																								}
																																																							}
																																																						}
																																																					}
																																																				}
																																																			}
																																																		}
																																																	}
																																																}
																																															}
																																														}
																																													}
																																												}
																																											}
																																										}
																																									}
																																								}
																																							}
																																						}
																																					}
																																				}
																																			}
																																		}
																																	}
																																}
																															}
																														}
																													}
																												}
																											}
																										}
																									}
																								}
																							}
																						}
																					}
																				}
																			}
																		}
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	});
var _user$project$ColorNum$convertStringToRgbAndHue = function (_p0) {
	var _p1 = _p0;
	var colorName = _elm_lang$core$String$toLower(_p1._1);
	var values = A2(_user$project$Utils$maybeFind, colorName, _user$project$ColorNum$htmlColorNames);
	return A2(
		_user$project$Utils$mapMaybe,
		function (_p2) {
			var _p3 = _p2;
			var colorNum = _elm_lang$core$Native_Utils.eq(colorName, 'black') ? 360 : (_elm_lang$core$Native_Utils.eq(colorName, 'white') ? 499 : ((A2(_elm_lang$core$String$contains, 'gray', colorName) || A2(_elm_lang$core$String$contains, 'grey', colorName)) ? 450 : _p3._1._0));
			return {
				ctor: '_Tuple3',
				_0: _p1._0,
				_1: {ctor: '_Tuple3', _0: _p3._0._0, _1: _p3._0._1, _2: _p3._0._2},
				_2: colorNum
			};
		},
		values);
};
var _user$project$ColorNum$codes = A2(
	_elm_lang$core$Basics_ops['++'],
	{
		ctor: '::',
		_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 55},
		_1: {
			ctor: '::',
			_0: {ctor: '_Tuple3', _0: 200, _1: 57, _2: 55},
			_1: {
				ctor: '::',
				_0: {ctor: '_Tuple3', _0: 200, _1: 60, _2: 55},
				_1: {
					ctor: '::',
					_0: {ctor: '_Tuple3', _0: 200, _1: 62, _2: 55},
					_1: {
						ctor: '::',
						_0: {ctor: '_Tuple3', _0: 200, _1: 65, _2: 55},
						_1: {
							ctor: '::',
							_0: {ctor: '_Tuple3', _0: 200, _1: 67, _2: 55},
							_1: {
								ctor: '::',
								_0: {ctor: '_Tuple3', _0: 200, _1: 70, _2: 55},
								_1: {
									ctor: '::',
									_0: {ctor: '_Tuple3', _0: 200, _1: 72, _2: 55},
									_1: {
										ctor: '::',
										_0: {ctor: '_Tuple3', _0: 200, _1: 74, _2: 55},
										_1: {
											ctor: '::',
											_0: {ctor: '_Tuple3', _0: 200, _1: 77, _2: 55},
											_1: {
												ctor: '::',
												_0: {ctor: '_Tuple3', _0: 200, _1: 79, _2: 55},
												_1: {
													ctor: '::',
													_0: {ctor: '_Tuple3', _0: 200, _1: 82, _2: 55},
													_1: {
														ctor: '::',
														_0: {ctor: '_Tuple3', _0: 200, _1: 84, _2: 55},
														_1: {
															ctor: '::',
															_0: {ctor: '_Tuple3', _0: 200, _1: 86, _2: 55},
															_1: {
																ctor: '::',
																_0: {ctor: '_Tuple3', _0: 200, _1: 89, _2: 55},
																_1: {
																	ctor: '::',
																	_0: {ctor: '_Tuple3', _0: 200, _1: 91, _2: 55},
																	_1: {
																		ctor: '::',
																		_0: {ctor: '_Tuple3', _0: 200, _1: 94, _2: 55},
																		_1: {
																			ctor: '::',
																			_0: {ctor: '_Tuple3', _0: 200, _1: 96, _2: 55},
																			_1: {
																				ctor: '::',
																				_0: {ctor: '_Tuple3', _0: 200, _1: 99, _2: 55},
																				_1: {
																					ctor: '::',
																					_0: {ctor: '_Tuple3', _0: 200, _1: 101, _2: 55},
																					_1: {
																						ctor: '::',
																						_0: {ctor: '_Tuple3', _0: 200, _1: 103, _2: 55},
																						_1: {
																							ctor: '::',
																							_0: {ctor: '_Tuple3', _0: 200, _1: 106, _2: 55},
																							_1: {
																								ctor: '::',
																								_0: {ctor: '_Tuple3', _0: 200, _1: 108, _2: 55},
																								_1: {
																									ctor: '::',
																									_0: {ctor: '_Tuple3', _0: 200, _1: 111, _2: 55},
																									_1: {
																										ctor: '::',
																										_0: {ctor: '_Tuple3', _0: 200, _1: 113, _2: 55},
																										_1: {
																											ctor: '::',
																											_0: {ctor: '_Tuple3', _0: 200, _1: 115, _2: 55},
																											_1: {
																												ctor: '::',
																												_0: {ctor: '_Tuple3', _0: 200, _1: 118, _2: 55},
																												_1: {
																													ctor: '::',
																													_0: {ctor: '_Tuple3', _0: 200, _1: 120, _2: 55},
																													_1: {
																														ctor: '::',
																														_0: {ctor: '_Tuple3', _0: 200, _1: 123, _2: 55},
																														_1: {
																															ctor: '::',
																															_0: {ctor: '_Tuple3', _0: 200, _1: 125, _2: 55},
																															_1: {
																																ctor: '::',
																																_0: {ctor: '_Tuple3', _0: 200, _1: 128, _2: 55},
																																_1: {
																																	ctor: '::',
																																	_0: {ctor: '_Tuple3', _0: 200, _1: 130, _2: 55},
																																	_1: {
																																		ctor: '::',
																																		_0: {ctor: '_Tuple3', _0: 200, _1: 132, _2: 55},
																																		_1: {
																																			ctor: '::',
																																			_0: {ctor: '_Tuple3', _0: 200, _1: 135, _2: 55},
																																			_1: {
																																				ctor: '::',
																																				_0: {ctor: '_Tuple3', _0: 200, _1: 137, _2: 55},
																																				_1: {
																																					ctor: '::',
																																					_0: {ctor: '_Tuple3', _0: 200, _1: 140, _2: 55},
																																					_1: {
																																						ctor: '::',
																																						_0: {ctor: '_Tuple3', _0: 200, _1: 142, _2: 55},
																																						_1: {
																																							ctor: '::',
																																							_0: {ctor: '_Tuple3', _0: 200, _1: 144, _2: 55},
																																							_1: {
																																								ctor: '::',
																																								_0: {ctor: '_Tuple3', _0: 200, _1: 147, _2: 55},
																																								_1: {
																																									ctor: '::',
																																									_0: {ctor: '_Tuple3', _0: 200, _1: 149, _2: 55},
																																									_1: {
																																										ctor: '::',
																																										_0: {ctor: '_Tuple3', _0: 200, _1: 152, _2: 55},
																																										_1: {
																																											ctor: '::',
																																											_0: {ctor: '_Tuple3', _0: 200, _1: 154, _2: 55},
																																											_1: {
																																												ctor: '::',
																																												_0: {ctor: '_Tuple3', _0: 200, _1: 157, _2: 55},
																																												_1: {
																																													ctor: '::',
																																													_0: {ctor: '_Tuple3', _0: 200, _1: 159, _2: 55},
																																													_1: {
																																														ctor: '::',
																																														_0: {ctor: '_Tuple3', _0: 200, _1: 161, _2: 55},
																																														_1: {
																																															ctor: '::',
																																															_0: {ctor: '_Tuple3', _0: 200, _1: 164, _2: 55},
																																															_1: {
																																																ctor: '::',
																																																_0: {ctor: '_Tuple3', _0: 200, _1: 166, _2: 55},
																																																_1: {
																																																	ctor: '::',
																																																	_0: {ctor: '_Tuple3', _0: 200, _1: 169, _2: 55},
																																																	_1: {
																																																		ctor: '::',
																																																		_0: {ctor: '_Tuple3', _0: 200, _1: 171, _2: 55},
																																																		_1: {
																																																			ctor: '::',
																																																			_0: {ctor: '_Tuple3', _0: 200, _1: 173, _2: 55},
																																																			_1: {
																																																				ctor: '::',
																																																				_0: {ctor: '_Tuple3', _0: 200, _1: 176, _2: 55},
																																																				_1: {
																																																					ctor: '::',
																																																					_0: {ctor: '_Tuple3', _0: 200, _1: 178, _2: 55},
																																																					_1: {
																																																						ctor: '::',
																																																						_0: {ctor: '_Tuple3', _0: 200, _1: 181, _2: 55},
																																																						_1: {
																																																							ctor: '::',
																																																							_0: {ctor: '_Tuple3', _0: 200, _1: 183, _2: 55},
																																																							_1: {
																																																								ctor: '::',
																																																								_0: {ctor: '_Tuple3', _0: 200, _1: 186, _2: 55},
																																																								_1: {
																																																									ctor: '::',
																																																									_0: {ctor: '_Tuple3', _0: 200, _1: 188, _2: 55},
																																																									_1: {
																																																										ctor: '::',
																																																										_0: {ctor: '_Tuple3', _0: 200, _1: 190, _2: 55},
																																																										_1: {
																																																											ctor: '::',
																																																											_0: {ctor: '_Tuple3', _0: 200, _1: 193, _2: 55},
																																																											_1: {
																																																												ctor: '::',
																																																												_0: {ctor: '_Tuple3', _0: 200, _1: 195, _2: 55},
																																																												_1: {
																																																													ctor: '::',
																																																													_0: {ctor: '_Tuple3', _0: 200, _1: 198, _2: 55},
																																																													_1: {
																																																														ctor: '::',
																																																														_0: {ctor: '_Tuple3', _0: 200, _1: 200, _2: 55},
																																																														_1: {
																																																															ctor: '::',
																																																															_0: {ctor: '_Tuple3', _0: 198, _1: 200, _2: 55},
																																																															_1: {
																																																																ctor: '::',
																																																																_0: {ctor: '_Tuple3', _0: 195, _1: 200, _2: 55},
																																																																_1: {
																																																																	ctor: '::',
																																																																	_0: {ctor: '_Tuple3', _0: 193, _1: 200, _2: 55},
																																																																	_1: {
																																																																		ctor: '::',
																																																																		_0: {ctor: '_Tuple3', _0: 190, _1: 200, _2: 55},
																																																																		_1: {
																																																																			ctor: '::',
																																																																			_0: {ctor: '_Tuple3', _0: 188, _1: 200, _2: 55},
																																																																			_1: {
																																																																				ctor: '::',
																																																																				_0: {ctor: '_Tuple3', _0: 186, _1: 200, _2: 55},
																																																																				_1: {
																																																																					ctor: '::',
																																																																					_0: {ctor: '_Tuple3', _0: 183, _1: 200, _2: 55},
																																																																					_1: {
																																																																						ctor: '::',
																																																																						_0: {ctor: '_Tuple3', _0: 181, _1: 200, _2: 55},
																																																																						_1: {
																																																																							ctor: '::',
																																																																							_0: {ctor: '_Tuple3', _0: 178, _1: 200, _2: 55},
																																																																							_1: {
																																																																								ctor: '::',
																																																																								_0: {ctor: '_Tuple3', _0: 176, _1: 200, _2: 55},
																																																																								_1: {
																																																																									ctor: '::',
																																																																									_0: {ctor: '_Tuple3', _0: 173, _1: 200, _2: 55},
																																																																									_1: {
																																																																										ctor: '::',
																																																																										_0: {ctor: '_Tuple3', _0: 171, _1: 200, _2: 55},
																																																																										_1: {
																																																																											ctor: '::',
																																																																											_0: {ctor: '_Tuple3', _0: 169, _1: 200, _2: 55},
																																																																											_1: {
																																																																												ctor: '::',
																																																																												_0: {ctor: '_Tuple3', _0: 166, _1: 200, _2: 55},
																																																																												_1: {
																																																																													ctor: '::',
																																																																													_0: {ctor: '_Tuple3', _0: 164, _1: 200, _2: 55},
																																																																													_1: {
																																																																														ctor: '::',
																																																																														_0: {ctor: '_Tuple3', _0: 161, _1: 200, _2: 55},
																																																																														_1: {
																																																																															ctor: '::',
																																																																															_0: {ctor: '_Tuple3', _0: 159, _1: 200, _2: 55},
																																																																															_1: {
																																																																																ctor: '::',
																																																																																_0: {ctor: '_Tuple3', _0: 157, _1: 200, _2: 55},
																																																																																_1: {
																																																																																	ctor: '::',
																																																																																	_0: {ctor: '_Tuple3', _0: 154, _1: 200, _2: 55},
																																																																																	_1: {
																																																																																		ctor: '::',
																																																																																		_0: {ctor: '_Tuple3', _0: 152, _1: 200, _2: 55},
																																																																																		_1: {
																																																																																			ctor: '::',
																																																																																			_0: {ctor: '_Tuple3', _0: 149, _1: 200, _2: 55},
																																																																																			_1: {
																																																																																				ctor: '::',
																																																																																				_0: {ctor: '_Tuple3', _0: 147, _1: 200, _2: 55},
																																																																																				_1: {
																																																																																					ctor: '::',
																																																																																					_0: {ctor: '_Tuple3', _0: 144, _1: 200, _2: 55},
																																																																																					_1: {
																																																																																						ctor: '::',
																																																																																						_0: {ctor: '_Tuple3', _0: 142, _1: 200, _2: 55},
																																																																																						_1: {
																																																																																							ctor: '::',
																																																																																							_0: {ctor: '_Tuple3', _0: 140, _1: 200, _2: 55},
																																																																																							_1: {
																																																																																								ctor: '::',
																																																																																								_0: {ctor: '_Tuple3', _0: 137, _1: 200, _2: 55},
																																																																																								_1: {
																																																																																									ctor: '::',
																																																																																									_0: {ctor: '_Tuple3', _0: 135, _1: 200, _2: 55},
																																																																																									_1: {
																																																																																										ctor: '::',
																																																																																										_0: {ctor: '_Tuple3', _0: 132, _1: 200, _2: 55},
																																																																																										_1: {
																																																																																											ctor: '::',
																																																																																											_0: {ctor: '_Tuple3', _0: 130, _1: 200, _2: 55},
																																																																																											_1: {
																																																																																												ctor: '::',
																																																																																												_0: {ctor: '_Tuple3', _0: 128, _1: 200, _2: 55},
																																																																																												_1: {
																																																																																													ctor: '::',
																																																																																													_0: {ctor: '_Tuple3', _0: 125, _1: 200, _2: 55},
																																																																																													_1: {
																																																																																														ctor: '::',
																																																																																														_0: {ctor: '_Tuple3', _0: 123, _1: 200, _2: 55},
																																																																																														_1: {
																																																																																															ctor: '::',
																																																																																															_0: {ctor: '_Tuple3', _0: 120, _1: 200, _2: 55},
																																																																																															_1: {
																																																																																																ctor: '::',
																																																																																																_0: {ctor: '_Tuple3', _0: 118, _1: 200, _2: 55},
																																																																																																_1: {
																																																																																																	ctor: '::',
																																																																																																	_0: {ctor: '_Tuple3', _0: 115, _1: 200, _2: 55},
																																																																																																	_1: {
																																																																																																		ctor: '::',
																																																																																																		_0: {ctor: '_Tuple3', _0: 113, _1: 200, _2: 55},
																																																																																																		_1: {
																																																																																																			ctor: '::',
																																																																																																			_0: {ctor: '_Tuple3', _0: 111, _1: 200, _2: 55},
																																																																																																			_1: {
																																																																																																				ctor: '::',
																																																																																																				_0: {ctor: '_Tuple3', _0: 108, _1: 200, _2: 55},
																																																																																																				_1: {
																																																																																																					ctor: '::',
																																																																																																					_0: {ctor: '_Tuple3', _0: 106, _1: 200, _2: 55},
																																																																																																					_1: {
																																																																																																						ctor: '::',
																																																																																																						_0: {ctor: '_Tuple3', _0: 103, _1: 200, _2: 55},
																																																																																																						_1: {
																																																																																																							ctor: '::',
																																																																																																							_0: {ctor: '_Tuple3', _0: 101, _1: 200, _2: 55},
																																																																																																							_1: {
																																																																																																								ctor: '::',
																																																																																																								_0: {ctor: '_Tuple3', _0: 99, _1: 200, _2: 55},
																																																																																																								_1: {
																																																																																																									ctor: '::',
																																																																																																									_0: {ctor: '_Tuple3', _0: 96, _1: 200, _2: 55},
																																																																																																									_1: {
																																																																																																										ctor: '::',
																																																																																																										_0: {ctor: '_Tuple3', _0: 94, _1: 200, _2: 55},
																																																																																																										_1: {
																																																																																																											ctor: '::',
																																																																																																											_0: {ctor: '_Tuple3', _0: 91, _1: 200, _2: 55},
																																																																																																											_1: {
																																																																																																												ctor: '::',
																																																																																																												_0: {ctor: '_Tuple3', _0: 89, _1: 200, _2: 55},
																																																																																																												_1: {
																																																																																																													ctor: '::',
																																																																																																													_0: {ctor: '_Tuple3', _0: 86, _1: 200, _2: 55},
																																																																																																													_1: {
																																																																																																														ctor: '::',
																																																																																																														_0: {ctor: '_Tuple3', _0: 84, _1: 200, _2: 55},
																																																																																																														_1: {
																																																																																																															ctor: '::',
																																																																																																															_0: {ctor: '_Tuple3', _0: 82, _1: 200, _2: 55},
																																																																																																															_1: {
																																																																																																																ctor: '::',
																																																																																																																_0: {ctor: '_Tuple3', _0: 79, _1: 200, _2: 55},
																																																																																																																_1: {
																																																																																																																	ctor: '::',
																																																																																																																	_0: {ctor: '_Tuple3', _0: 77, _1: 200, _2: 55},
																																																																																																																	_1: {
																																																																																																																		ctor: '::',
																																																																																																																		_0: {ctor: '_Tuple3', _0: 74, _1: 200, _2: 55},
																																																																																																																		_1: {
																																																																																																																			ctor: '::',
																																																																																																																			_0: {ctor: '_Tuple3', _0: 72, _1: 200, _2: 55},
																																																																																																																			_1: {
																																																																																																																				ctor: '::',
																																																																																																																				_0: {ctor: '_Tuple3', _0: 70, _1: 200, _2: 55},
																																																																																																																				_1: {
																																																																																																																					ctor: '::',
																																																																																																																					_0: {ctor: '_Tuple3', _0: 67, _1: 200, _2: 55},
																																																																																																																					_1: {
																																																																																																																						ctor: '::',
																																																																																																																						_0: {ctor: '_Tuple3', _0: 65, _1: 200, _2: 55},
																																																																																																																						_1: {
																																																																																																																							ctor: '::',
																																																																																																																							_0: {ctor: '_Tuple3', _0: 62, _1: 200, _2: 55},
																																																																																																																							_1: {
																																																																																																																								ctor: '::',
																																																																																																																								_0: {ctor: '_Tuple3', _0: 60, _1: 200, _2: 55},
																																																																																																																								_1: {
																																																																																																																									ctor: '::',
																																																																																																																									_0: {ctor: '_Tuple3', _0: 57, _1: 200, _2: 55},
																																																																																																																									_1: {
																																																																																																																										ctor: '::',
																																																																																																																										_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 55},
																																																																																																																										_1: {
																																																																																																																											ctor: '::',
																																																																																																																											_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 57},
																																																																																																																											_1: {
																																																																																																																												ctor: '::',
																																																																																																																												_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 60},
																																																																																																																												_1: {
																																																																																																																													ctor: '::',
																																																																																																																													_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 62},
																																																																																																																													_1: {
																																																																																																																														ctor: '::',
																																																																																																																														_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 65},
																																																																																																																														_1: {
																																																																																																																															ctor: '::',
																																																																																																																															_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 67},
																																																																																																																															_1: {
																																																																																																																																ctor: '::',
																																																																																																																																_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 70},
																																																																																																																																_1: {
																																																																																																																																	ctor: '::',
																																																																																																																																	_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 72},
																																																																																																																																	_1: {
																																																																																																																																		ctor: '::',
																																																																																																																																		_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 74},
																																																																																																																																		_1: {
																																																																																																																																			ctor: '::',
																																																																																																																																			_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 77},
																																																																																																																																			_1: {
																																																																																																																																				ctor: '::',
																																																																																																																																				_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 79},
																																																																																																																																				_1: {
																																																																																																																																					ctor: '::',
																																																																																																																																					_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 82},
																																																																																																																																					_1: {
																																																																																																																																						ctor: '::',
																																																																																																																																						_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 84},
																																																																																																																																						_1: {
																																																																																																																																							ctor: '::',
																																																																																																																																							_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 86},
																																																																																																																																							_1: {
																																																																																																																																								ctor: '::',
																																																																																																																																								_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 89},
																																																																																																																																								_1: {
																																																																																																																																									ctor: '::',
																																																																																																																																									_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 91},
																																																																																																																																									_1: {
																																																																																																																																										ctor: '::',
																																																																																																																																										_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 94},
																																																																																																																																										_1: {
																																																																																																																																											ctor: '::',
																																																																																																																																											_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 96},
																																																																																																																																											_1: {
																																																																																																																																												ctor: '::',
																																																																																																																																												_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 99},
																																																																																																																																												_1: {
																																																																																																																																													ctor: '::',
																																																																																																																																													_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 101},
																																																																																																																																													_1: {
																																																																																																																																														ctor: '::',
																																																																																																																																														_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 103},
																																																																																																																																														_1: {
																																																																																																																																															ctor: '::',
																																																																																																																																															_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 106},
																																																																																																																																															_1: {
																																																																																																																																																ctor: '::',
																																																																																																																																																_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 108},
																																																																																																																																																_1: {
																																																																																																																																																	ctor: '::',
																																																																																																																																																	_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 111},
																																																																																																																																																	_1: {
																																																																																																																																																		ctor: '::',
																																																																																																																																																		_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 113},
																																																																																																																																																		_1: {
																																																																																																																																																			ctor: '::',
																																																																																																																																																			_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 115},
																																																																																																																																																			_1: {
																																																																																																																																																				ctor: '::',
																																																																																																																																																				_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 118},
																																																																																																																																																				_1: {
																																																																																																																																																					ctor: '::',
																																																																																																																																																					_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 120},
																																																																																																																																																					_1: {
																																																																																																																																																						ctor: '::',
																																																																																																																																																						_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 123},
																																																																																																																																																						_1: {
																																																																																																																																																							ctor: '::',
																																																																																																																																																							_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 125},
																																																																																																																																																							_1: {
																																																																																																																																																								ctor: '::',
																																																																																																																																																								_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 128},
																																																																																																																																																								_1: {
																																																																																																																																																									ctor: '::',
																																																																																																																																																									_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 130},
																																																																																																																																																									_1: {
																																																																																																																																																										ctor: '::',
																																																																																																																																																										_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 132},
																																																																																																																																																										_1: {
																																																																																																																																																											ctor: '::',
																																																																																																																																																											_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 135},
																																																																																																																																																											_1: {
																																																																																																																																																												ctor: '::',
																																																																																																																																																												_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 137},
																																																																																																																																																												_1: {
																																																																																																																																																													ctor: '::',
																																																																																																																																																													_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 140},
																																																																																																																																																													_1: {
																																																																																																																																																														ctor: '::',
																																																																																																																																																														_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 142},
																																																																																																																																																														_1: {
																																																																																																																																																															ctor: '::',
																																																																																																																																																															_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 144},
																																																																																																																																																															_1: {
																																																																																																																																																																ctor: '::',
																																																																																																																																																																_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 147},
																																																																																																																																																																_1: {
																																																																																																																																																																	ctor: '::',
																																																																																																																																																																	_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 149},
																																																																																																																																																																	_1: {
																																																																																																																																																																		ctor: '::',
																																																																																																																																																																		_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 152},
																																																																																																																																																																		_1: {
																																																																																																																																																																			ctor: '::',
																																																																																																																																																																			_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 154},
																																																																																																																																																																			_1: {
																																																																																																																																																																				ctor: '::',
																																																																																																																																																																				_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 157},
																																																																																																																																																																				_1: {
																																																																																																																																																																					ctor: '::',
																																																																																																																																																																					_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 159},
																																																																																																																																																																					_1: {
																																																																																																																																																																						ctor: '::',
																																																																																																																																																																						_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 161},
																																																																																																																																																																						_1: {
																																																																																																																																																																							ctor: '::',
																																																																																																																																																																							_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 164},
																																																																																																																																																																							_1: {
																																																																																																																																																																								ctor: '::',
																																																																																																																																																																								_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 166},
																																																																																																																																																																								_1: {
																																																																																																																																																																									ctor: '::',
																																																																																																																																																																									_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 169},
																																																																																																																																																																									_1: {
																																																																																																																																																																										ctor: '::',
																																																																																																																																																																										_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 171},
																																																																																																																																																																										_1: {
																																																																																																																																																																											ctor: '::',
																																																																																																																																																																											_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 173},
																																																																																																																																																																											_1: {
																																																																																																																																																																												ctor: '::',
																																																																																																																																																																												_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 176},
																																																																																																																																																																												_1: {
																																																																																																																																																																													ctor: '::',
																																																																																																																																																																													_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 178},
																																																																																																																																																																													_1: {
																																																																																																																																																																														ctor: '::',
																																																																																																																																																																														_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 181},
																																																																																																																																																																														_1: {
																																																																																																																																																																															ctor: '::',
																																																																																																																																																																															_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 183},
																																																																																																																																																																															_1: {
																																																																																																																																																																																ctor: '::',
																																																																																																																																																																																_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 186},
																																																																																																																																																																																_1: {
																																																																																																																																																																																	ctor: '::',
																																																																																																																																																																																	_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 188},
																																																																																																																																																																																	_1: {
																																																																																																																																																																																		ctor: '::',
																																																																																																																																																																																		_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 190},
																																																																																																																																																																																		_1: {
																																																																																																																																																																																			ctor: '::',
																																																																																																																																																																																			_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 193},
																																																																																																																																																																																			_1: {
																																																																																																																																																																																				ctor: '::',
																																																																																																																																																																																				_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 195},
																																																																																																																																																																																				_1: {
																																																																																																																																																																																					ctor: '::',
																																																																																																																																																																																					_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 198},
																																																																																																																																																																																					_1: {
																																																																																																																																																																																						ctor: '::',
																																																																																																																																																																																						_0: {ctor: '_Tuple3', _0: 55, _1: 200, _2: 200},
																																																																																																																																																																																						_1: {
																																																																																																																																																																																							ctor: '::',
																																																																																																																																																																																							_0: {ctor: '_Tuple3', _0: 55, _1: 198, _2: 200},
																																																																																																																																																																																							_1: {
																																																																																																																																																																																								ctor: '::',
																																																																																																																																																																																								_0: {ctor: '_Tuple3', _0: 55, _1: 195, _2: 200},
																																																																																																																																																																																								_1: {
																																																																																																																																																																																									ctor: '::',
																																																																																																																																																																																									_0: {ctor: '_Tuple3', _0: 55, _1: 193, _2: 200},
																																																																																																																																																																																									_1: {
																																																																																																																																																																																										ctor: '::',
																																																																																																																																																																																										_0: {ctor: '_Tuple3', _0: 55, _1: 190, _2: 200},
																																																																																																																																																																																										_1: {
																																																																																																																																																																																											ctor: '::',
																																																																																																																																																																																											_0: {ctor: '_Tuple3', _0: 55, _1: 188, _2: 200},
																																																																																																																																																																																											_1: {
																																																																																																																																																																																												ctor: '::',
																																																																																																																																																																																												_0: {ctor: '_Tuple3', _0: 55, _1: 186, _2: 200},
																																																																																																																																																																																												_1: {
																																																																																																																																																																																													ctor: '::',
																																																																																																																																																																																													_0: {ctor: '_Tuple3', _0: 55, _1: 183, _2: 200},
																																																																																																																																																																																													_1: {
																																																																																																																																																																																														ctor: '::',
																																																																																																																																																																																														_0: {ctor: '_Tuple3', _0: 55, _1: 181, _2: 200},
																																																																																																																																																																																														_1: {
																																																																																																																																																																																															ctor: '::',
																																																																																																																																																																																															_0: {ctor: '_Tuple3', _0: 55, _1: 178, _2: 200},
																																																																																																																																																																																															_1: {
																																																																																																																																																																																																ctor: '::',
																																																																																																																																																																																																_0: {ctor: '_Tuple3', _0: 55, _1: 176, _2: 200},
																																																																																																																																																																																																_1: {
																																																																																																																																																																																																	ctor: '::',
																																																																																																																																																																																																	_0: {ctor: '_Tuple3', _0: 55, _1: 173, _2: 200},
																																																																																																																																																																																																	_1: {
																																																																																																																																																																																																		ctor: '::',
																																																																																																																																																																																																		_0: {ctor: '_Tuple3', _0: 55, _1: 171, _2: 200},
																																																																																																																																																																																																		_1: {
																																																																																																																																																																																																			ctor: '::',
																																																																																																																																																																																																			_0: {ctor: '_Tuple3', _0: 55, _1: 169, _2: 200},
																																																																																																																																																																																																			_1: {
																																																																																																																																																																																																				ctor: '::',
																																																																																																																																																																																																				_0: {ctor: '_Tuple3', _0: 55, _1: 166, _2: 200},
																																																																																																																																																																																																				_1: {
																																																																																																																																																																																																					ctor: '::',
																																																																																																																																																																																																					_0: {ctor: '_Tuple3', _0: 55, _1: 164, _2: 200},
																																																																																																																																																																																																					_1: {
																																																																																																																																																																																																						ctor: '::',
																																																																																																																																																																																																						_0: {ctor: '_Tuple3', _0: 55, _1: 161, _2: 200},
																																																																																																																																																																																																						_1: {
																																																																																																																																																																																																							ctor: '::',
																																																																																																																																																																																																							_0: {ctor: '_Tuple3', _0: 55, _1: 159, _2: 200},
																																																																																																																																																																																																							_1: {
																																																																																																																																																																																																								ctor: '::',
																																																																																																																																																																																																								_0: {ctor: '_Tuple3', _0: 55, _1: 157, _2: 200},
																																																																																																																																																																																																								_1: {
																																																																																																																																																																																																									ctor: '::',
																																																																																																																																																																																																									_0: {ctor: '_Tuple3', _0: 55, _1: 154, _2: 200},
																																																																																																																																																																																																									_1: {
																																																																																																																																																																																																										ctor: '::',
																																																																																																																																																																																																										_0: {ctor: '_Tuple3', _0: 55, _1: 152, _2: 200},
																																																																																																																																																																																																										_1: {
																																																																																																																																																																																																											ctor: '::',
																																																																																																																																																																																																											_0: {ctor: '_Tuple3', _0: 55, _1: 149, _2: 200},
																																																																																																																																																																																																											_1: {
																																																																																																																																																																																																												ctor: '::',
																																																																																																																																																																																																												_0: {ctor: '_Tuple3', _0: 55, _1: 147, _2: 200},
																																																																																																																																																																																																												_1: {
																																																																																																																																																																																																													ctor: '::',
																																																																																																																																																																																																													_0: {ctor: '_Tuple3', _0: 55, _1: 144, _2: 200},
																																																																																																																																																																																																													_1: {
																																																																																																																																																																																																														ctor: '::',
																																																																																																																																																																																																														_0: {ctor: '_Tuple3', _0: 55, _1: 142, _2: 200},
																																																																																																																																																																																																														_1: {
																																																																																																																																																																																																															ctor: '::',
																																																																																																																																																																																																															_0: {ctor: '_Tuple3', _0: 55, _1: 140, _2: 200},
																																																																																																																																																																																																															_1: {
																																																																																																																																																																																																																ctor: '::',
																																																																																																																																																																																																																_0: {ctor: '_Tuple3', _0: 55, _1: 137, _2: 200},
																																																																																																																																																																																																																_1: {
																																																																																																																																																																																																																	ctor: '::',
																																																																																																																																																																																																																	_0: {ctor: '_Tuple3', _0: 55, _1: 135, _2: 200},
																																																																																																																																																																																																																	_1: {
																																																																																																																																																																																																																		ctor: '::',
																																																																																																																																																																																																																		_0: {ctor: '_Tuple3', _0: 55, _1: 132, _2: 200},
																																																																																																																																																																																																																		_1: {
																																																																																																																																																																																																																			ctor: '::',
																																																																																																																																																																																																																			_0: {ctor: '_Tuple3', _0: 55, _1: 130, _2: 200},
																																																																																																																																																																																																																			_1: {
																																																																																																																																																																																																																				ctor: '::',
																																																																																																																																																																																																																				_0: {ctor: '_Tuple3', _0: 55, _1: 128, _2: 200},
																																																																																																																																																																																																																				_1: {
																																																																																																																																																																																																																					ctor: '::',
																																																																																																																																																																																																																					_0: {ctor: '_Tuple3', _0: 55, _1: 125, _2: 200},
																																																																																																																																																																																																																					_1: {
																																																																																																																																																																																																																						ctor: '::',
																																																																																																																																																																																																																						_0: {ctor: '_Tuple3', _0: 55, _1: 123, _2: 200},
																																																																																																																																																																																																																						_1: {
																																																																																																																																																																																																																							ctor: '::',
																																																																																																																																																																																																																							_0: {ctor: '_Tuple3', _0: 55, _1: 120, _2: 200},
																																																																																																																																																																																																																							_1: {
																																																																																																																																																																																																																								ctor: '::',
																																																																																																																																																																																																																								_0: {ctor: '_Tuple3', _0: 55, _1: 118, _2: 200},
																																																																																																																																																																																																																								_1: {
																																																																																																																																																																																																																									ctor: '::',
																																																																																																																																																																																																																									_0: {ctor: '_Tuple3', _0: 55, _1: 115, _2: 200},
																																																																																																																																																																																																																									_1: {
																																																																																																																																																																																																																										ctor: '::',
																																																																																																																																																																																																																										_0: {ctor: '_Tuple3', _0: 55, _1: 113, _2: 200},
																																																																																																																																																																																																																										_1: {
																																																																																																																																																																																																																											ctor: '::',
																																																																																																																																																																																																																											_0: {ctor: '_Tuple3', _0: 55, _1: 111, _2: 200},
																																																																																																																																																																																																																											_1: {
																																																																																																																																																																																																																												ctor: '::',
																																																																																																																																																																																																																												_0: {ctor: '_Tuple3', _0: 55, _1: 108, _2: 200},
																																																																																																																																																																																																																												_1: {
																																																																																																																																																																																																																													ctor: '::',
																																																																																																																																																																																																																													_0: {ctor: '_Tuple3', _0: 55, _1: 106, _2: 200},
																																																																																																																																																																																																																													_1: {
																																																																																																																																																																																																																														ctor: '::',
																																																																																																																																																																																																																														_0: {ctor: '_Tuple3', _0: 55, _1: 103, _2: 200},
																																																																																																																																																																																																																														_1: {
																																																																																																																																																																																																																															ctor: '::',
																																																																																																																																																																																																																															_0: {ctor: '_Tuple3', _0: 55, _1: 101, _2: 200},
																																																																																																																																																																																																																															_1: {
																																																																																																																																																																																																																																ctor: '::',
																																																																																																																																																																																																																																_0: {ctor: '_Tuple3', _0: 55, _1: 99, _2: 200},
																																																																																																																																																																																																																																_1: {
																																																																																																																																																																																																																																	ctor: '::',
																																																																																																																																																																																																																																	_0: {ctor: '_Tuple3', _0: 55, _1: 96, _2: 200},
																																																																																																																																																																																																																																	_1: {
																																																																																																																																																																																																																																		ctor: '::',
																																																																																																																																																																																																																																		_0: {ctor: '_Tuple3', _0: 55, _1: 94, _2: 200},
																																																																																																																																																																																																																																		_1: {
																																																																																																																																																																																																																																			ctor: '::',
																																																																																																																																																																																																																																			_0: {ctor: '_Tuple3', _0: 55, _1: 91, _2: 200},
																																																																																																																																																																																																																																			_1: {
																																																																																																																																																																																																																																				ctor: '::',
																																																																																																																																																																																																																																				_0: {ctor: '_Tuple3', _0: 55, _1: 89, _2: 200},
																																																																																																																																																																																																																																				_1: {
																																																																																																																																																																																																																																					ctor: '::',
																																																																																																																																																																																																																																					_0: {ctor: '_Tuple3', _0: 55, _1: 86, _2: 200},
																																																																																																																																																																																																																																					_1: {
																																																																																																																																																																																																																																						ctor: '::',
																																																																																																																																																																																																																																						_0: {ctor: '_Tuple3', _0: 55, _1: 84, _2: 200},
																																																																																																																																																																																																																																						_1: {
																																																																																																																																																																																																																																							ctor: '::',
																																																																																																																																																																																																																																							_0: {ctor: '_Tuple3', _0: 55, _1: 82, _2: 200},
																																																																																																																																																																																																																																							_1: {
																																																																																																																																																																																																																																								ctor: '::',
																																																																																																																																																																																																																																								_0: {ctor: '_Tuple3', _0: 55, _1: 79, _2: 200},
																																																																																																																																																																																																																																								_1: {
																																																																																																																																																																																																																																									ctor: '::',
																																																																																																																																																																																																																																									_0: {ctor: '_Tuple3', _0: 55, _1: 77, _2: 200},
																																																																																																																																																																																																																																									_1: {
																																																																																																																																																																																																																																										ctor: '::',
																																																																																																																																																																																																																																										_0: {ctor: '_Tuple3', _0: 55, _1: 74, _2: 200},
																																																																																																																																																																																																																																										_1: {
																																																																																																																																																																																																																																											ctor: '::',
																																																																																																																																																																																																																																											_0: {ctor: '_Tuple3', _0: 55, _1: 72, _2: 200},
																																																																																																																																																																																																																																											_1: {
																																																																																																																																																																																																																																												ctor: '::',
																																																																																																																																																																																																																																												_0: {ctor: '_Tuple3', _0: 55, _1: 70, _2: 200},
																																																																																																																																																																																																																																												_1: {
																																																																																																																																																																																																																																													ctor: '::',
																																																																																																																																																																																																																																													_0: {ctor: '_Tuple3', _0: 55, _1: 67, _2: 200},
																																																																																																																																																																																																																																													_1: {
																																																																																																																																																																																																																																														ctor: '::',
																																																																																																																																																																																																																																														_0: {ctor: '_Tuple3', _0: 55, _1: 65, _2: 200},
																																																																																																																																																																																																																																														_1: {
																																																																																																																																																																																																																																															ctor: '::',
																																																																																																																																																																																																																																															_0: {ctor: '_Tuple3', _0: 55, _1: 62, _2: 200},
																																																																																																																																																																																																																																															_1: {
																																																																																																																																																																																																																																																ctor: '::',
																																																																																																																																																																																																																																																_0: {ctor: '_Tuple3', _0: 55, _1: 60, _2: 200},
																																																																																																																																																																																																																																																_1: {
																																																																																																																																																																																																																																																	ctor: '::',
																																																																																																																																																																																																																																																	_0: {ctor: '_Tuple3', _0: 55, _1: 57, _2: 200},
																																																																																																																																																																																																																																																	_1: {
																																																																																																																																																																																																																																																		ctor: '::',
																																																																																																																																																																																																																																																		_0: {ctor: '_Tuple3', _0: 55, _1: 55, _2: 200},
																																																																																																																																																																																																																																																		_1: {
																																																																																																																																																																																																																																																			ctor: '::',
																																																																																																																																																																																																																																																			_0: {ctor: '_Tuple3', _0: 57, _1: 55, _2: 200},
																																																																																																																																																																																																																																																			_1: {
																																																																																																																																																																																																																																																				ctor: '::',
																																																																																																																																																																																																																																																				_0: {ctor: '_Tuple3', _0: 60, _1: 55, _2: 200},
																																																																																																																																																																																																																																																				_1: {
																																																																																																																																																																																																																																																					ctor: '::',
																																																																																																																																																																																																																																																					_0: {ctor: '_Tuple3', _0: 62, _1: 55, _2: 200},
																																																																																																																																																																																																																																																					_1: {
																																																																																																																																																																																																																																																						ctor: '::',
																																																																																																																																																																																																																																																						_0: {ctor: '_Tuple3', _0: 65, _1: 55, _2: 200},
																																																																																																																																																																																																																																																						_1: {
																																																																																																																																																																																																																																																							ctor: '::',
																																																																																																																																																																																																																																																							_0: {ctor: '_Tuple3', _0: 67, _1: 55, _2: 200},
																																																																																																																																																																																																																																																							_1: {
																																																																																																																																																																																																																																																								ctor: '::',
																																																																																																																																																																																																																																																								_0: {ctor: '_Tuple3', _0: 70, _1: 55, _2: 200},
																																																																																																																																																																																																																																																								_1: {
																																																																																																																																																																																																																																																									ctor: '::',
																																																																																																																																																																																																																																																									_0: {ctor: '_Tuple3', _0: 72, _1: 55, _2: 200},
																																																																																																																																																																																																																																																									_1: {
																																																																																																																																																																																																																																																										ctor: '::',
																																																																																																																																																																																																																																																										_0: {ctor: '_Tuple3', _0: 74, _1: 55, _2: 200},
																																																																																																																																																																																																																																																										_1: {
																																																																																																																																																																																																																																																											ctor: '::',
																																																																																																																																																																																																																																																											_0: {ctor: '_Tuple3', _0: 77, _1: 55, _2: 200},
																																																																																																																																																																																																																																																											_1: {
																																																																																																																																																																																																																																																												ctor: '::',
																																																																																																																																																																																																																																																												_0: {ctor: '_Tuple3', _0: 79, _1: 55, _2: 200},
																																																																																																																																																																																																																																																												_1: {
																																																																																																																																																																																																																																																													ctor: '::',
																																																																																																																																																																																																																																																													_0: {ctor: '_Tuple3', _0: 82, _1: 55, _2: 200},
																																																																																																																																																																																																																																																													_1: {
																																																																																																																																																																																																																																																														ctor: '::',
																																																																																																																																																																																																																																																														_0: {ctor: '_Tuple3', _0: 84, _1: 55, _2: 200},
																																																																																																																																																																																																																																																														_1: {
																																																																																																																																																																																																																																																															ctor: '::',
																																																																																																																																																																																																																																																															_0: {ctor: '_Tuple3', _0: 86, _1: 55, _2: 200},
																																																																																																																																																																																																																																																															_1: {ctor: '[]'}
																																																																																																																																																																																																																																																														}
																																																																																																																																																																																																																																																													}
																																																																																																																																																																																																																																																												}
																																																																																																																																																																																																																																																											}
																																																																																																																																																																																																																																																										}
																																																																																																																																																																																																																																																									}
																																																																																																																																																																																																																																																								}
																																																																																																																																																																																																																																																							}
																																																																																																																																																																																																																																																						}
																																																																																																																																																																																																																																																					}
																																																																																																																																																																																																																																																				}
																																																																																																																																																																																																																																																			}
																																																																																																																																																																																																																																																		}
																																																																																																																																																																																																																																																	}
																																																																																																																																																																																																																																																}
																																																																																																																																																																																																																																															}
																																																																																																																																																																																																																																														}
																																																																																																																																																																																																																																													}
																																																																																																																																																																																																																																												}
																																																																																																																																																																																																																																											}
																																																																																																																																																																																																																																										}
																																																																																																																																																																																																																																									}
																																																																																																																																																																																																																																								}
																																																																																																																																																																																																																																							}
																																																																																																																																																																																																																																						}
																																																																																																																																																																																																																																					}
																																																																																																																																																																																																																																				}
																																																																																																																																																																																																																																			}
																																																																																																																																																																																																																																		}
																																																																																																																																																																																																																																	}
																																																																																																																																																																																																																																}
																																																																																																																																																																																																																															}
																																																																																																																																																																																																																														}
																																																																																																																																																																																																																													}
																																																																																																																																																																																																																												}
																																																																																																																																																																																																																											}
																																																																																																																																																																																																																										}
																																																																																																																																																																																																																									}
																																																																																																																																																																																																																								}
																																																																																																																																																																																																																							}
																																																																																																																																																																																																																						}
																																																																																																																																																																																																																					}
																																																																																																																																																																																																																				}
																																																																																																																																																																																																																			}
																																																																																																																																																																																																																		}
																																																																																																																																																																																																																	}
																																																																																																																																																																																																																}
																																																																																																																																																																																																															}
																																																																																																																																																																																																														}
																																																																																																																																																																																																													}
																																																																																																																																																																																																												}
																																																																																																																																																																																																											}
																																																																																																																																																																																																										}
																																																																																																																																																																																																									}
																																																																																																																																																																																																								}
																																																																																																																																																																																																							}
																																																																																																																																																																																																						}
																																																																																																																																																																																																					}
																																																																																																																																																																																																				}
																																																																																																																																																																																																			}
																																																																																																																																																																																																		}
																																																																																																																																																																																																	}
																																																																																																																																																																																																}
																																																																																																																																																																																															}
																																																																																																																																																																																														}
																																																																																																																																																																																													}
																																																																																																																																																																																												}
																																																																																																																																																																																											}
																																																																																																																																																																																										}
																																																																																																																																																																																									}
																																																																																																																																																																																								}
																																																																																																																																																																																							}
																																																																																																																																																																																						}
																																																																																																																																																																																					}
																																																																																																																																																																																				}
																																																																																																																																																																																			}
																																																																																																																																																																																		}
																																																																																																																																																																																	}
																																																																																																																																																																																}
																																																																																																																																																																															}
																																																																																																																																																																														}
																																																																																																																																																																													}
																																																																																																																																																																												}
																																																																																																																																																																											}
																																																																																																																																																																										}
																																																																																																																																																																									}
																																																																																																																																																																								}
																																																																																																																																																																							}
																																																																																																																																																																						}
																																																																																																																																																																					}
																																																																																																																																																																				}
																																																																																																																																																																			}
																																																																																																																																																																		}
																																																																																																																																																																	}
																																																																																																																																																																}
																																																																																																																																																															}
																																																																																																																																																														}
																																																																																																																																																													}
																																																																																																																																																												}
																																																																																																																																																											}
																																																																																																																																																										}
																																																																																																																																																									}
																																																																																																																																																								}
																																																																																																																																																							}
																																																																																																																																																						}
																																																																																																																																																					}
																																																																																																																																																				}
																																																																																																																																																			}
																																																																																																																																																		}
																																																																																																																																																	}
																																																																																																																																																}
																																																																																																																																															}
																																																																																																																																														}
																																																																																																																																													}
																																																																																																																																												}
																																																																																																																																											}
																																																																																																																																										}
																																																																																																																																									}
																																																																																																																																								}
																																																																																																																																							}
																																																																																																																																						}
																																																																																																																																					}
																																																																																																																																				}
																																																																																																																																			}
																																																																																																																																		}
																																																																																																																																	}
																																																																																																																																}
																																																																																																																															}
																																																																																																																														}
																																																																																																																													}
																																																																																																																												}
																																																																																																																											}
																																																																																																																										}
																																																																																																																									}
																																																																																																																								}
																																																																																																																							}
																																																																																																																						}
																																																																																																																					}
																																																																																																																				}
																																																																																																																			}
																																																																																																																		}
																																																																																																																	}
																																																																																																																}
																																																																																																															}
																																																																																																														}
																																																																																																													}
																																																																																																												}
																																																																																																											}
																																																																																																										}
																																																																																																									}
																																																																																																								}
																																																																																																							}
																																																																																																						}
																																																																																																					}
																																																																																																				}
																																																																																																			}
																																																																																																		}
																																																																																																	}
																																																																																																}
																																																																																															}
																																																																																														}
																																																																																													}
																																																																																												}
																																																																																											}
																																																																																										}
																																																																																									}
																																																																																								}
																																																																																							}
																																																																																						}
																																																																																					}
																																																																																				}
																																																																																			}
																																																																																		}
																																																																																	}
																																																																																}
																																																																															}
																																																																														}
																																																																													}
																																																																												}
																																																																											}
																																																																										}
																																																																									}
																																																																								}
																																																																							}
																																																																						}
																																																																					}
																																																																				}
																																																																			}
																																																																		}
																																																																	}
																																																																}
																																																															}
																																																														}
																																																													}
																																																												}
																																																											}
																																																										}
																																																									}
																																																								}
																																																							}
																																																						}
																																																					}
																																																				}
																																																			}
																																																		}
																																																	}
																																																}
																																															}
																																														}
																																													}
																																												}
																																											}
																																										}
																																									}
																																								}
																																							}
																																						}
																																					}
																																				}
																																			}
																																		}
																																	}
																																}
																															}
																														}
																													}
																												}
																											}
																										}
																									}
																								}
																							}
																						}
																					}
																				}
																			}
																		}
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	},
	{
		ctor: '::',
		_0: {ctor: '_Tuple3', _0: 89, _1: 55, _2: 200},
		_1: {
			ctor: '::',
			_0: {ctor: '_Tuple3', _0: 91, _1: 55, _2: 200},
			_1: {
				ctor: '::',
				_0: {ctor: '_Tuple3', _0: 94, _1: 55, _2: 200},
				_1: {
					ctor: '::',
					_0: {ctor: '_Tuple3', _0: 96, _1: 55, _2: 200},
					_1: {
						ctor: '::',
						_0: {ctor: '_Tuple3', _0: 99, _1: 55, _2: 200},
						_1: {
							ctor: '::',
							_0: {ctor: '_Tuple3', _0: 101, _1: 55, _2: 200},
							_1: {
								ctor: '::',
								_0: {ctor: '_Tuple3', _0: 103, _1: 55, _2: 200},
								_1: {
									ctor: '::',
									_0: {ctor: '_Tuple3', _0: 106, _1: 55, _2: 200},
									_1: {
										ctor: '::',
										_0: {ctor: '_Tuple3', _0: 108, _1: 55, _2: 200},
										_1: {
											ctor: '::',
											_0: {ctor: '_Tuple3', _0: 111, _1: 55, _2: 200},
											_1: {
												ctor: '::',
												_0: {ctor: '_Tuple3', _0: 113, _1: 55, _2: 200},
												_1: {
													ctor: '::',
													_0: {ctor: '_Tuple3', _0: 115, _1: 55, _2: 200},
													_1: {
														ctor: '::',
														_0: {ctor: '_Tuple3', _0: 118, _1: 55, _2: 200},
														_1: {
															ctor: '::',
															_0: {ctor: '_Tuple3', _0: 120, _1: 55, _2: 200},
															_1: {
																ctor: '::',
																_0: {ctor: '_Tuple3', _0: 123, _1: 55, _2: 200},
																_1: {
																	ctor: '::',
																	_0: {ctor: '_Tuple3', _0: 125, _1: 55, _2: 200},
																	_1: {
																		ctor: '::',
																		_0: {ctor: '_Tuple3', _0: 128, _1: 55, _2: 200},
																		_1: {
																			ctor: '::',
																			_0: {ctor: '_Tuple3', _0: 130, _1: 55, _2: 200},
																			_1: {
																				ctor: '::',
																				_0: {ctor: '_Tuple3', _0: 132, _1: 55, _2: 200},
																				_1: {
																					ctor: '::',
																					_0: {ctor: '_Tuple3', _0: 135, _1: 55, _2: 200},
																					_1: {
																						ctor: '::',
																						_0: {ctor: '_Tuple3', _0: 137, _1: 55, _2: 200},
																						_1: {
																							ctor: '::',
																							_0: {ctor: '_Tuple3', _0: 140, _1: 55, _2: 200},
																							_1: {
																								ctor: '::',
																								_0: {ctor: '_Tuple3', _0: 142, _1: 55, _2: 200},
																								_1: {
																									ctor: '::',
																									_0: {ctor: '_Tuple3', _0: 144, _1: 55, _2: 200},
																									_1: {
																										ctor: '::',
																										_0: {ctor: '_Tuple3', _0: 147, _1: 55, _2: 200},
																										_1: {
																											ctor: '::',
																											_0: {ctor: '_Tuple3', _0: 149, _1: 55, _2: 200},
																											_1: {
																												ctor: '::',
																												_0: {ctor: '_Tuple3', _0: 152, _1: 55, _2: 200},
																												_1: {
																													ctor: '::',
																													_0: {ctor: '_Tuple3', _0: 154, _1: 55, _2: 200},
																													_1: {
																														ctor: '::',
																														_0: {ctor: '_Tuple3', _0: 157, _1: 55, _2: 200},
																														_1: {
																															ctor: '::',
																															_0: {ctor: '_Tuple3', _0: 159, _1: 55, _2: 200},
																															_1: {
																																ctor: '::',
																																_0: {ctor: '_Tuple3', _0: 161, _1: 55, _2: 200},
																																_1: {
																																	ctor: '::',
																																	_0: {ctor: '_Tuple3', _0: 164, _1: 55, _2: 200},
																																	_1: {
																																		ctor: '::',
																																		_0: {ctor: '_Tuple3', _0: 166, _1: 55, _2: 200},
																																		_1: {
																																			ctor: '::',
																																			_0: {ctor: '_Tuple3', _0: 169, _1: 55, _2: 200},
																																			_1: {
																																				ctor: '::',
																																				_0: {ctor: '_Tuple3', _0: 171, _1: 55, _2: 200},
																																				_1: {
																																					ctor: '::',
																																					_0: {ctor: '_Tuple3', _0: 173, _1: 55, _2: 200},
																																					_1: {
																																						ctor: '::',
																																						_0: {ctor: '_Tuple3', _0: 176, _1: 55, _2: 200},
																																						_1: {
																																							ctor: '::',
																																							_0: {ctor: '_Tuple3', _0: 178, _1: 55, _2: 200},
																																							_1: {
																																								ctor: '::',
																																								_0: {ctor: '_Tuple3', _0: 181, _1: 55, _2: 200},
																																								_1: {
																																									ctor: '::',
																																									_0: {ctor: '_Tuple3', _0: 183, _1: 55, _2: 200},
																																									_1: {
																																										ctor: '::',
																																										_0: {ctor: '_Tuple3', _0: 186, _1: 55, _2: 200},
																																										_1: {
																																											ctor: '::',
																																											_0: {ctor: '_Tuple3', _0: 188, _1: 55, _2: 200},
																																											_1: {
																																												ctor: '::',
																																												_0: {ctor: '_Tuple3', _0: 190, _1: 55, _2: 200},
																																												_1: {
																																													ctor: '::',
																																													_0: {ctor: '_Tuple3', _0: 193, _1: 55, _2: 200},
																																													_1: {
																																														ctor: '::',
																																														_0: {ctor: '_Tuple3', _0: 195, _1: 55, _2: 200},
																																														_1: {
																																															ctor: '::',
																																															_0: {ctor: '_Tuple3', _0: 198, _1: 55, _2: 200},
																																															_1: {
																																																ctor: '::',
																																																_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 200},
																																																_1: {
																																																	ctor: '::',
																																																	_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 198},
																																																	_1: {
																																																		ctor: '::',
																																																		_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 195},
																																																		_1: {
																																																			ctor: '::',
																																																			_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 193},
																																																			_1: {
																																																				ctor: '::',
																																																				_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 190},
																																																				_1: {
																																																					ctor: '::',
																																																					_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 188},
																																																					_1: {
																																																						ctor: '::',
																																																						_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 186},
																																																						_1: {
																																																							ctor: '::',
																																																							_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 183},
																																																							_1: {
																																																								ctor: '::',
																																																								_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 181},
																																																								_1: {
																																																									ctor: '::',
																																																									_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 178},
																																																									_1: {
																																																										ctor: '::',
																																																										_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 176},
																																																										_1: {
																																																											ctor: '::',
																																																											_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 173},
																																																											_1: {
																																																												ctor: '::',
																																																												_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 171},
																																																												_1: {
																																																													ctor: '::',
																																																													_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 169},
																																																													_1: {
																																																														ctor: '::',
																																																														_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 166},
																																																														_1: {
																																																															ctor: '::',
																																																															_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 164},
																																																															_1: {
																																																																ctor: '::',
																																																																_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 161},
																																																																_1: {
																																																																	ctor: '::',
																																																																	_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 159},
																																																																	_1: {
																																																																		ctor: '::',
																																																																		_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 157},
																																																																		_1: {
																																																																			ctor: '::',
																																																																			_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 154},
																																																																			_1: {
																																																																				ctor: '::',
																																																																				_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 152},
																																																																				_1: {
																																																																					ctor: '::',
																																																																					_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 149},
																																																																					_1: {
																																																																						ctor: '::',
																																																																						_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 147},
																																																																						_1: {
																																																																							ctor: '::',
																																																																							_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 144},
																																																																							_1: {
																																																																								ctor: '::',
																																																																								_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 142},
																																																																								_1: {
																																																																									ctor: '::',
																																																																									_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 140},
																																																																									_1: {
																																																																										ctor: '::',
																																																																										_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 137},
																																																																										_1: {
																																																																											ctor: '::',
																																																																											_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 135},
																																																																											_1: {
																																																																												ctor: '::',
																																																																												_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 132},
																																																																												_1: {
																																																																													ctor: '::',
																																																																													_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 130},
																																																																													_1: {
																																																																														ctor: '::',
																																																																														_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 128},
																																																																														_1: {
																																																																															ctor: '::',
																																																																															_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 125},
																																																																															_1: {
																																																																																ctor: '::',
																																																																																_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 123},
																																																																																_1: {
																																																																																	ctor: '::',
																																																																																	_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 120},
																																																																																	_1: {
																																																																																		ctor: '::',
																																																																																		_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 118},
																																																																																		_1: {
																																																																																			ctor: '::',
																																																																																			_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 115},
																																																																																			_1: {
																																																																																				ctor: '::',
																																																																																				_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 113},
																																																																																				_1: {
																																																																																					ctor: '::',
																																																																																					_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 111},
																																																																																					_1: {
																																																																																						ctor: '::',
																																																																																						_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 108},
																																																																																						_1: {
																																																																																							ctor: '::',
																																																																																							_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 106},
																																																																																							_1: {
																																																																																								ctor: '::',
																																																																																								_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 103},
																																																																																								_1: {
																																																																																									ctor: '::',
																																																																																									_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 101},
																																																																																									_1: {
																																																																																										ctor: '::',
																																																																																										_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 99},
																																																																																										_1: {
																																																																																											ctor: '::',
																																																																																											_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 96},
																																																																																											_1: {
																																																																																												ctor: '::',
																																																																																												_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 94},
																																																																																												_1: {
																																																																																													ctor: '::',
																																																																																													_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 91},
																																																																																													_1: {
																																																																																														ctor: '::',
																																																																																														_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 89},
																																																																																														_1: {
																																																																																															ctor: '::',
																																																																																															_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 86},
																																																																																															_1: {
																																																																																																ctor: '::',
																																																																																																_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 84},
																																																																																																_1: {
																																																																																																	ctor: '::',
																																																																																																	_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 82},
																																																																																																	_1: {
																																																																																																		ctor: '::',
																																																																																																		_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 79},
																																																																																																		_1: {
																																																																																																			ctor: '::',
																																																																																																			_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 77},
																																																																																																			_1: {
																																																																																																				ctor: '::',
																																																																																																				_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 74},
																																																																																																				_1: {
																																																																																																					ctor: '::',
																																																																																																					_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 72},
																																																																																																					_1: {
																																																																																																						ctor: '::',
																																																																																																						_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 70},
																																																																																																						_1: {
																																																																																																							ctor: '::',
																																																																																																							_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 67},
																																																																																																							_1: {
																																																																																																								ctor: '::',
																																																																																																								_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 65},
																																																																																																								_1: {
																																																																																																									ctor: '::',
																																																																																																									_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 62},
																																																																																																									_1: {
																																																																																																										ctor: '::',
																																																																																																										_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 60},
																																																																																																										_1: {
																																																																																																											ctor: '::',
																																																																																																											_0: {ctor: '_Tuple3', _0: 200, _1: 55, _2: 57},
																																																																																																											_1: {
																																																																																																												ctor: '::',
																																																																																																												_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0},
																																																																																																												_1: {
																																																																																																													ctor: '::',
																																																																																																													_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0},
																																																																																																													_1: {
																																																																																																														ctor: '::',
																																																																																																														_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0},
																																																																																																														_1: {
																																																																																																															ctor: '::',
																																																																																																															_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0},
																																																																																																															_1: {
																																																																																																																ctor: '::',
																																																																																																																_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0},
																																																																																																																_1: {
																																																																																																																	ctor: '::',
																																																																																																																	_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0},
																																																																																																																	_1: {
																																																																																																																		ctor: '::',
																																																																																																																		_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0},
																																																																																																																		_1: {
																																																																																																																			ctor: '::',
																																																																																																																			_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0},
																																																																																																																			_1: {
																																																																																																																				ctor: '::',
																																																																																																																				_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0},
																																																																																																																				_1: {
																																																																																																																					ctor: '::',
																																																																																																																					_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0},
																																																																																																																					_1: {
																																																																																																																						ctor: '::',
																																																																																																																						_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0},
																																																																																																																						_1: {
																																																																																																																							ctor: '::',
																																																																																																																							_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0},
																																																																																																																							_1: {
																																																																																																																								ctor: '::',
																																																																																																																								_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0},
																																																																																																																								_1: {
																																																																																																																									ctor: '::',
																																																																																																																									_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0},
																																																																																																																									_1: {
																																																																																																																										ctor: '::',
																																																																																																																										_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0},
																																																																																																																										_1: {
																																																																																																																											ctor: '::',
																																																																																																																											_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0},
																																																																																																																											_1: {
																																																																																																																												ctor: '::',
																																																																																																																												_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0},
																																																																																																																												_1: {
																																																																																																																													ctor: '::',
																																																																																																																													_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0},
																																																																																																																													_1: {
																																																																																																																														ctor: '::',
																																																																																																																														_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0},
																																																																																																																														_1: {
																																																																																																																															ctor: '::',
																																																																																																																															_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0},
																																																																																																																															_1: {
																																																																																																																																ctor: '::',
																																																																																																																																_0: {ctor: '_Tuple3', _0: 0, _1: 0, _2: 0},
																																																																																																																																_1: {
																																																																																																																																	ctor: '::',
																																																																																																																																	_0: {ctor: '_Tuple3', _0: 3, _1: 3, _2: 3},
																																																																																																																																	_1: {
																																																																																																																																		ctor: '::',
																																																																																																																																		_0: {ctor: '_Tuple3', _0: 5, _1: 5, _2: 5},
																																																																																																																																		_1: {
																																																																																																																																			ctor: '::',
																																																																																																																																			_0: {ctor: '_Tuple3', _0: 8, _1: 8, _2: 8},
																																																																																																																																			_1: {
																																																																																																																																				ctor: '::',
																																																																																																																																				_0: {ctor: '_Tuple3', _0: 10, _1: 10, _2: 10},
																																																																																																																																				_1: {
																																																																																																																																					ctor: '::',
																																																																																																																																					_0: {ctor: '_Tuple3', _0: 13, _1: 13, _2: 13},
																																																																																																																																					_1: {
																																																																																																																																						ctor: '::',
																																																																																																																																						_0: {ctor: '_Tuple3', _0: 15, _1: 15, _2: 15},
																																																																																																																																						_1: {
																																																																																																																																							ctor: '::',
																																																																																																																																							_0: {ctor: '_Tuple3', _0: 18, _1: 18, _2: 18},
																																																																																																																																							_1: {
																																																																																																																																								ctor: '::',
																																																																																																																																								_0: {ctor: '_Tuple3', _0: 20, _1: 20, _2: 20},
																																																																																																																																								_1: {
																																																																																																																																									ctor: '::',
																																																																																																																																									_0: {ctor: '_Tuple3', _0: 23, _1: 23, _2: 23},
																																																																																																																																									_1: {
																																																																																																																																										ctor: '::',
																																																																																																																																										_0: {ctor: '_Tuple3', _0: 26, _1: 26, _2: 26},
																																																																																																																																										_1: {
																																																																																																																																											ctor: '::',
																																																																																																																																											_0: {ctor: '_Tuple3', _0: 28, _1: 28, _2: 28},
																																																																																																																																											_1: {
																																																																																																																																												ctor: '::',
																																																																																																																																												_0: {ctor: '_Tuple3', _0: 31, _1: 31, _2: 31},
																																																																																																																																												_1: {
																																																																																																																																													ctor: '::',
																																																																																																																																													_0: {ctor: '_Tuple3', _0: 33, _1: 33, _2: 33},
																																																																																																																																													_1: {
																																																																																																																																														ctor: '::',
																																																																																																																																														_0: {ctor: '_Tuple3', _0: 36, _1: 36, _2: 36},
																																																																																																																																														_1: {
																																																																																																																																															ctor: '::',
																																																																																																																																															_0: {ctor: '_Tuple3', _0: 38, _1: 38, _2: 38},
																																																																																																																																															_1: {
																																																																																																																																																ctor: '::',
																																																																																																																																																_0: {ctor: '_Tuple3', _0: 41, _1: 41, _2: 41},
																																																																																																																																																_1: {
																																																																																																																																																	ctor: '::',
																																																																																																																																																	_0: {ctor: '_Tuple3', _0: 43, _1: 43, _2: 43},
																																																																																																																																																	_1: {
																																																																																																																																																		ctor: '::',
																																																																																																																																																		_0: {ctor: '_Tuple3', _0: 46, _1: 46, _2: 46},
																																																																																																																																																		_1: {
																																																																																																																																																			ctor: '::',
																																																																																																																																																			_0: {ctor: '_Tuple3', _0: 48, _1: 48, _2: 48},
																																																																																																																																																			_1: {
																																																																																																																																																				ctor: '::',
																																																																																																																																																				_0: {ctor: '_Tuple3', _0: 51, _1: 51, _2: 51},
																																																																																																																																																				_1: {
																																																																																																																																																					ctor: '::',
																																																																																																																																																					_0: {ctor: '_Tuple3', _0: 54, _1: 54, _2: 54},
																																																																																																																																																					_1: {
																																																																																																																																																						ctor: '::',
																																																																																																																																																						_0: {ctor: '_Tuple3', _0: 56, _1: 56, _2: 56},
																																																																																																																																																						_1: {
																																																																																																																																																							ctor: '::',
																																																																																																																																																							_0: {ctor: '_Tuple3', _0: 59, _1: 59, _2: 59},
																																																																																																																																																							_1: {
																																																																																																																																																								ctor: '::',
																																																																																																																																																								_0: {ctor: '_Tuple3', _0: 61, _1: 61, _2: 61},
																																																																																																																																																								_1: {
																																																																																																																																																									ctor: '::',
																																																																																																																																																									_0: {ctor: '_Tuple3', _0: 64, _1: 64, _2: 64},
																																																																																																																																																									_1: {
																																																																																																																																																										ctor: '::',
																																																																																																																																																										_0: {ctor: '_Tuple3', _0: 66, _1: 66, _2: 66},
																																																																																																																																																										_1: {
																																																																																																																																																											ctor: '::',
																																																																																																																																																											_0: {ctor: '_Tuple3', _0: 69, _1: 69, _2: 69},
																																																																																																																																																											_1: {
																																																																																																																																																												ctor: '::',
																																																																																																																																																												_0: {ctor: '_Tuple3', _0: 71, _1: 71, _2: 71},
																																																																																																																																																												_1: {
																																																																																																																																																													ctor: '::',
																																																																																																																																																													_0: {ctor: '_Tuple3', _0: 74, _1: 74, _2: 74},
																																																																																																																																																													_1: {
																																																																																																																																																														ctor: '::',
																																																																																																																																																														_0: {ctor: '_Tuple3', _0: 77, _1: 77, _2: 77},
																																																																																																																																																														_1: {
																																																																																																																																																															ctor: '::',
																																																																																																																																																															_0: {ctor: '_Tuple3', _0: 79, _1: 79, _2: 79},
																																																																																																																																																															_1: {
																																																																																																																																																																ctor: '::',
																																																																																																																																																																_0: {ctor: '_Tuple3', _0: 82, _1: 82, _2: 82},
																																																																																																																																																																_1: {
																																																																																																																																																																	ctor: '::',
																																																																																																																																																																	_0: {ctor: '_Tuple3', _0: 84, _1: 84, _2: 84},
																																																																																																																																																																	_1: {
																																																																																																																																																																		ctor: '::',
																																																																																																																																																																		_0: {ctor: '_Tuple3', _0: 87, _1: 87, _2: 87},
																																																																																																																																																																		_1: {
																																																																																																																																																																			ctor: '::',
																																																																																																																																																																			_0: {ctor: '_Tuple3', _0: 89, _1: 89, _2: 89},
																																																																																																																																																																			_1: {
																																																																																																																																																																				ctor: '::',
																																																																																																																																																																				_0: {ctor: '_Tuple3', _0: 92, _1: 92, _2: 92},
																																																																																																																																																																				_1: {
																																																																																																																																																																					ctor: '::',
																																																																																																																																																																					_0: {ctor: '_Tuple3', _0: 94, _1: 94, _2: 94},
																																																																																																																																																																					_1: {
																																																																																																																																																																						ctor: '::',
																																																																																																																																																																						_0: {ctor: '_Tuple3', _0: 97, _1: 97, _2: 97},
																																																																																																																																																																						_1: {
																																																																																																																																																																							ctor: '::',
																																																																																																																																																																							_0: {ctor: '_Tuple3', _0: 99, _1: 99, _2: 99},
																																																																																																																																																																							_1: {
																																																																																																																																																																								ctor: '::',
																																																																																																																																																																								_0: {ctor: '_Tuple3', _0: 102, _1: 102, _2: 102},
																																																																																																																																																																								_1: {
																																																																																																																																																																									ctor: '::',
																																																																																																																																																																									_0: {ctor: '_Tuple3', _0: 105, _1: 105, _2: 105},
																																																																																																																																																																									_1: {
																																																																																																																																																																										ctor: '::',
																																																																																																																																																																										_0: {ctor: '_Tuple3', _0: 107, _1: 107, _2: 107},
																																																																																																																																																																										_1: {
																																																																																																																																																																											ctor: '::',
																																																																																																																																																																											_0: {ctor: '_Tuple3', _0: 110, _1: 110, _2: 110},
																																																																																																																																																																											_1: {
																																																																																																																																																																												ctor: '::',
																																																																																																																																																																												_0: {ctor: '_Tuple3', _0: 112, _1: 112, _2: 112},
																																																																																																																																																																												_1: {
																																																																																																																																																																													ctor: '::',
																																																																																																																																																																													_0: {ctor: '_Tuple3', _0: 115, _1: 115, _2: 115},
																																																																																																																																																																													_1: {
																																																																																																																																																																														ctor: '::',
																																																																																																																																																																														_0: {ctor: '_Tuple3', _0: 117, _1: 117, _2: 117},
																																																																																																																																																																														_1: {
																																																																																																																																																																															ctor: '::',
																																																																																																																																																																															_0: {ctor: '_Tuple3', _0: 120, _1: 120, _2: 120},
																																																																																																																																																																															_1: {
																																																																																																																																																																																ctor: '::',
																																																																																																																																																																																_0: {ctor: '_Tuple3', _0: 122, _1: 122, _2: 122},
																																																																																																																																																																																_1: {
																																																																																																																																																																																	ctor: '::',
																																																																																																																																																																																	_0: {ctor: '_Tuple3', _0: 125, _1: 125, _2: 125},
																																																																																																																																																																																	_1: {
																																																																																																																																																																																		ctor: '::',
																																																																																																																																																																																		_0: {ctor: '_Tuple3', _0: 128, _1: 128, _2: 128},
																																																																																																																																																																																		_1: {
																																																																																																																																																																																			ctor: '::',
																																																																																																																																																																																			_0: {ctor: '_Tuple3', _0: 130, _1: 130, _2: 130},
																																																																																																																																																																																			_1: {
																																																																																																																																																																																				ctor: '::',
																																																																																																																																																																																				_0: {ctor: '_Tuple3', _0: 133, _1: 133, _2: 133},
																																																																																																																																																																																				_1: {
																																																																																																																																																																																					ctor: '::',
																																																																																																																																																																																					_0: {ctor: '_Tuple3', _0: 135, _1: 135, _2: 135},
																																																																																																																																																																																					_1: {
																																																																																																																																																																																						ctor: '::',
																																																																																																																																																																																						_0: {ctor: '_Tuple3', _0: 138, _1: 138, _2: 138},
																																																																																																																																																																																						_1: {
																																																																																																																																																																																							ctor: '::',
																																																																																																																																																																																							_0: {ctor: '_Tuple3', _0: 140, _1: 140, _2: 140},
																																																																																																																																																																																							_1: {
																																																																																																																																																																																								ctor: '::',
																																																																																																																																																																																								_0: {ctor: '_Tuple3', _0: 143, _1: 143, _2: 143},
																																																																																																																																																																																								_1: {
																																																																																																																																																																																									ctor: '::',
																																																																																																																																																																																									_0: {ctor: '_Tuple3', _0: 145, _1: 145, _2: 145},
																																																																																																																																																																																									_1: {
																																																																																																																																																																																										ctor: '::',
																																																																																																																																																																																										_0: {ctor: '_Tuple3', _0: 148, _1: 148, _2: 148},
																																																																																																																																																																																										_1: {
																																																																																																																																																																																											ctor: '::',
																																																																																																																																																																																											_0: {ctor: '_Tuple3', _0: 150, _1: 150, _2: 150},
																																																																																																																																																																																											_1: {
																																																																																																																																																																																												ctor: '::',
																																																																																																																																																																																												_0: {ctor: '_Tuple3', _0: 153, _1: 153, _2: 153},
																																																																																																																																																																																												_1: {
																																																																																																																																																																																													ctor: '::',
																																																																																																																																																																																													_0: {ctor: '_Tuple3', _0: 156, _1: 156, _2: 156},
																																																																																																																																																																																													_1: {
																																																																																																																																																																																														ctor: '::',
																																																																																																																																																																																														_0: {ctor: '_Tuple3', _0: 158, _1: 158, _2: 158},
																																																																																																																																																																																														_1: {
																																																																																																																																																																																															ctor: '::',
																																																																																																																																																																																															_0: {ctor: '_Tuple3', _0: 161, _1: 161, _2: 161},
																																																																																																																																																																																															_1: {
																																																																																																																																																																																																ctor: '::',
																																																																																																																																																																																																_0: {ctor: '_Tuple3', _0: 163, _1: 163, _2: 163},
																																																																																																																																																																																																_1: {
																																																																																																																																																																																																	ctor: '::',
																																																																																																																																																																																																	_0: {ctor: '_Tuple3', _0: 166, _1: 166, _2: 166},
																																																																																																																																																																																																	_1: {
																																																																																																																																																																																																		ctor: '::',
																																																																																																																																																																																																		_0: {ctor: '_Tuple3', _0: 168, _1: 168, _2: 168},
																																																																																																																																																																																																		_1: {
																																																																																																																																																																																																			ctor: '::',
																																																																																																																																																																																																			_0: {ctor: '_Tuple3', _0: 171, _1: 171, _2: 171},
																																																																																																																																																																																																			_1: {
																																																																																																																																																																																																				ctor: '::',
																																																																																																																																																																																																				_0: {ctor: '_Tuple3', _0: 173, _1: 173, _2: 173},
																																																																																																																																																																																																				_1: {
																																																																																																																																																																																																					ctor: '::',
																																																																																																																																																																																																					_0: {ctor: '_Tuple3', _0: 176, _1: 176, _2: 176},
																																																																																																																																																																																																					_1: {
																																																																																																																																																																																																						ctor: '::',
																																																																																																																																																																																																						_0: {ctor: '_Tuple3', _0: 179, _1: 179, _2: 179},
																																																																																																																																																																																																						_1: {
																																																																																																																																																																																																							ctor: '::',
																																																																																																																																																																																																							_0: {ctor: '_Tuple3', _0: 181, _1: 181, _2: 181},
																																																																																																																																																																																																							_1: {
																																																																																																																																																																																																								ctor: '::',
																																																																																																																																																																																																								_0: {ctor: '_Tuple3', _0: 184, _1: 184, _2: 184},
																																																																																																																																																																																																								_1: {
																																																																																																																																																																																																									ctor: '::',
																																																																																																																																																																																																									_0: {ctor: '_Tuple3', _0: 186, _1: 186, _2: 186},
																																																																																																																																																																																																									_1: {
																																																																																																																																																																																																										ctor: '::',
																																																																																																																																																																																																										_0: {ctor: '_Tuple3', _0: 189, _1: 189, _2: 189},
																																																																																																																																																																																																										_1: {
																																																																																																																																																																																																											ctor: '::',
																																																																																																																																																																																																											_0: {ctor: '_Tuple3', _0: 191, _1: 191, _2: 191},
																																																																																																																																																																																																											_1: {
																																																																																																																																																																																																												ctor: '::',
																																																																																																																																																																																																												_0: {ctor: '_Tuple3', _0: 194, _1: 194, _2: 194},
																																																																																																																																																																																																												_1: {
																																																																																																																																																																																																													ctor: '::',
																																																																																																																																																																																																													_0: {ctor: '_Tuple3', _0: 196, _1: 196, _2: 196},
																																																																																																																																																																																																													_1: {
																																																																																																																																																																																																														ctor: '::',
																																																																																																																																																																																																														_0: {ctor: '_Tuple3', _0: 199, _1: 199, _2: 199},
																																																																																																																																																																																																														_1: {
																																																																																																																																																																																																															ctor: '::',
																																																																																																																																																																																																															_0: {ctor: '_Tuple3', _0: 201, _1: 201, _2: 201},
																																																																																																																																																																																																															_1: {
																																																																																																																																																																																																																ctor: '::',
																																																																																																																																																																																																																_0: {ctor: '_Tuple3', _0: 204, _1: 204, _2: 204},
																																																																																																																																																																																																																_1: {
																																																																																																																																																																																																																	ctor: '::',
																																																																																																																																																																																																																	_0: {ctor: '_Tuple3', _0: 207, _1: 207, _2: 207},
																																																																																																																																																																																																																	_1: {
																																																																																																																																																																																																																		ctor: '::',
																																																																																																																																																																																																																		_0: {ctor: '_Tuple3', _0: 209, _1: 209, _2: 209},
																																																																																																																																																																																																																		_1: {
																																																																																																																																																																																																																			ctor: '::',
																																																																																																																																																																																																																			_0: {ctor: '_Tuple3', _0: 212, _1: 212, _2: 212},
																																																																																																																																																																																																																			_1: {
																																																																																																																																																																																																																				ctor: '::',
																																																																																																																																																																																																																				_0: {ctor: '_Tuple3', _0: 214, _1: 214, _2: 214},
																																																																																																																																																																																																																				_1: {
																																																																																																																																																																																																																					ctor: '::',
																																																																																																																																																																																																																					_0: {ctor: '_Tuple3', _0: 217, _1: 217, _2: 217},
																																																																																																																																																																																																																					_1: {
																																																																																																																																																																																																																						ctor: '::',
																																																																																																																																																																																																																						_0: {ctor: '_Tuple3', _0: 219, _1: 219, _2: 219},
																																																																																																																																																																																																																						_1: {
																																																																																																																																																																																																																							ctor: '::',
																																																																																																																																																																																																																							_0: {ctor: '_Tuple3', _0: 222, _1: 222, _2: 222},
																																																																																																																																																																																																																							_1: {
																																																																																																																																																																																																																								ctor: '::',
																																																																																																																																																																																																																								_0: {ctor: '_Tuple3', _0: 224, _1: 224, _2: 224},
																																																																																																																																																																																																																								_1: {
																																																																																																																																																																																																																									ctor: '::',
																																																																																																																																																																																																																									_0: {ctor: '_Tuple3', _0: 227, _1: 227, _2: 227},
																																																																																																																																																																																																																									_1: {
																																																																																																																																																																																																																										ctor: '::',
																																																																																																																																																																																																																										_0: {ctor: '_Tuple3', _0: 230, _1: 230, _2: 230},
																																																																																																																																																																																																																										_1: {
																																																																																																																																																																																																																											ctor: '::',
																																																																																																																																																																																																																											_0: {ctor: '_Tuple3', _0: 232, _1: 232, _2: 232},
																																																																																																																																																																																																																											_1: {
																																																																																																																																																																																																																												ctor: '::',
																																																																																																																																																																																																																												_0: {ctor: '_Tuple3', _0: 235, _1: 235, _2: 235},
																																																																																																																																																																																																																												_1: {
																																																																																																																																																																																																																													ctor: '::',
																																																																																																																																																																																																																													_0: {ctor: '_Tuple3', _0: 237, _1: 237, _2: 237},
																																																																																																																																																																																																																													_1: {
																																																																																																																																																																																																																														ctor: '::',
																																																																																																																																																																																																																														_0: {ctor: '_Tuple3', _0: 240, _1: 240, _2: 240},
																																																																																																																																																																																																																														_1: {
																																																																																																																																																																																																																															ctor: '::',
																																																																																																																																																																																																																															_0: {ctor: '_Tuple3', _0: 242, _1: 242, _2: 242},
																																																																																																																																																																																																																															_1: {
																																																																																																																																																																																																																																ctor: '::',
																																																																																																																																																																																																																																_0: {ctor: '_Tuple3', _0: 245, _1: 245, _2: 245},
																																																																																																																																																																																																																																_1: {
																																																																																																																																																																																																																																	ctor: '::',
																																																																																																																																																																																																																																	_0: {ctor: '_Tuple3', _0: 247, _1: 247, _2: 247},
																																																																																																																																																																																																																																	_1: {
																																																																																																																																																																																																																																		ctor: '::',
																																																																																																																																																																																																																																		_0: {ctor: '_Tuple3', _0: 250, _1: 250, _2: 250},
																																																																																																																																																																																																																																		_1: {
																																																																																																																																																																																																																																			ctor: '::',
																																																																																																																																																																																																																																			_0: {ctor: '_Tuple3', _0: 252, _1: 252, _2: 252},
																																																																																																																																																																																																																																			_1: {
																																																																																																																																																																																																																																				ctor: '::',
																																																																																																																																																																																																																																				_0: {ctor: '_Tuple3', _0: 255, _1: 255, _2: 255},
																																																																																																																																																																																																																																				_1: {
																																																																																																																																																																																																																																					ctor: '::',
																																																																																																																																																																																																																																					_0: {ctor: '_Tuple3', _0: 255, _1: 255, _2: 255},
																																																																																																																																																																																																																																					_1: {
																																																																																																																																																																																																																																						ctor: '::',
																																																																																																																																																																																																																																						_0: {ctor: '_Tuple3', _0: 255, _1: 255, _2: 255},
																																																																																																																																																																																																																																						_1: {
																																																																																																																																																																																																																																							ctor: '::',
																																																																																																																																																																																																																																							_0: {ctor: '_Tuple3', _0: 255, _1: 255, _2: 255},
																																																																																																																																																																																																																																							_1: {
																																																																																																																																																																																																																																								ctor: '::',
																																																																																																																																																																																																																																								_0: {ctor: '_Tuple3', _0: 255, _1: 255, _2: 255},
																																																																																																																																																																																																																																								_1: {
																																																																																																																																																																																																																																									ctor: '::',
																																																																																																																																																																																																																																									_0: {ctor: '_Tuple3', _0: 255, _1: 255, _2: 255},
																																																																																																																																																																																																																																									_1: {
																																																																																																																																																																																																																																										ctor: '::',
																																																																																																																																																																																																																																										_0: {ctor: '_Tuple3', _0: 255, _1: 255, _2: 255},
																																																																																																																																																																																																																																										_1: {
																																																																																																																																																																																																																																											ctor: '::',
																																																																																																																																																																																																																																											_0: {ctor: '_Tuple3', _0: 255, _1: 255, _2: 255},
																																																																																																																																																																																																																																											_1: {
																																																																																																																																																																																																																																												ctor: '::',
																																																																																																																																																																																																																																												_0: {ctor: '_Tuple3', _0: 255, _1: 255, _2: 255},
																																																																																																																																																																																																																																												_1: {
																																																																																																																																																																																																																																													ctor: '::',
																																																																																																																																																																																																																																													_0: {ctor: '_Tuple3', _0: 255, _1: 255, _2: 255},
																																																																																																																																																																																																																																													_1: {
																																																																																																																																																																																																																																														ctor: '::',
																																																																																																																																																																																																																																														_0: {ctor: '_Tuple3', _0: 255, _1: 255, _2: 255},
																																																																																																																																																																																																																																														_1: {
																																																																																																																																																																																																																																															ctor: '::',
																																																																																																																																																																																																																																															_0: {ctor: '_Tuple3', _0: 255, _1: 255, _2: 255},
																																																																																																																																																																																																																																															_1: {
																																																																																																																																																																																																																																																ctor: '::',
																																																																																																																																																																																																																																																_0: {ctor: '_Tuple3', _0: 255, _1: 255, _2: 255},
																																																																																																																																																																																																																																																_1: {
																																																																																																																																																																																																																																																	ctor: '::',
																																																																																																																																																																																																																																																	_0: {ctor: '_Tuple3', _0: 255, _1: 255, _2: 255},
																																																																																																																																																																																																																																																	_1: {
																																																																																																																																																																																																																																																		ctor: '::',
																																																																																																																																																																																																																																																		_0: {ctor: '_Tuple3', _0: 255, _1: 255, _2: 255},
																																																																																																																																																																																																																																																		_1: {
																																																																																																																																																																																																																																																			ctor: '::',
																																																																																																																																																																																																																																																			_0: {ctor: '_Tuple3', _0: 255, _1: 255, _2: 255},
																																																																																																																																																																																																																																																			_1: {
																																																																																																																																																																																																																																																				ctor: '::',
																																																																																																																																																																																																																																																				_0: {ctor: '_Tuple3', _0: 255, _1: 255, _2: 255},
																																																																																																																																																																																																																																																				_1: {
																																																																																																																																																																																																																																																					ctor: '::',
																																																																																																																																																																																																																																																					_0: {ctor: '_Tuple3', _0: 255, _1: 255, _2: 255},
																																																																																																																																																																																																																																																					_1: {
																																																																																																																																																																																																																																																						ctor: '::',
																																																																																																																																																																																																																																																						_0: {ctor: '_Tuple3', _0: 255, _1: 255, _2: 255},
																																																																																																																																																																																																																																																						_1: {
																																																																																																																																																																																																																																																							ctor: '::',
																																																																																																																																																																																																																																																							_0: {ctor: '_Tuple3', _0: 255, _1: 255, _2: 255},
																																																																																																																																																																																																																																																							_1: {ctor: '[]'}
																																																																																																																																																																																																																																																						}
																																																																																																																																																																																																																																																					}
																																																																																																																																																																																																																																																				}
																																																																																																																																																																																																																																																			}
																																																																																																																																																																																																																																																		}
																																																																																																																																																																																																																																																	}
																																																																																																																																																																																																																																																}
																																																																																																																																																																																																																																															}
																																																																																																																																																																																																																																														}
																																																																																																																																																																																																																																													}
																																																																																																																																																																																																																																												}
																																																																																																																																																																																																																																											}
																																																																																																																																																																																																																																										}
																																																																																																																																																																																																																																									}
																																																																																																																																																																																																																																								}
																																																																																																																																																																																																																																							}
																																																																																																																																																																																																																																						}
																																																																																																																																																																																																																																					}
																																																																																																																																																																																																																																				}
																																																																																																																																																																																																																																			}
																																																																																																																																																																																																																																		}
																																																																																																																																																																																																																																	}
																																																																																																																																																																																																																																}
																																																																																																																																																																																																																															}
																																																																																																																																																																																																																														}
																																																																																																																																																																																																																													}
																																																																																																																																																																																																																												}
																																																																																																																																																																																																																											}
																																																																																																																																																																																																																										}
																																																																																																																																																																																																																									}
																																																																																																																																																																																																																								}
																																																																																																																																																																																																																							}
																																																																																																																																																																																																																						}
																																																																																																																																																																																																																					}
																																																																																																																																																																																																																				}
																																																																																																																																																																																																																			}
																																																																																																																																																																																																																		}
																																																																																																																																																																																																																	}
																																																																																																																																																																																																																}
																																																																																																																																																																																																															}
																																																																																																																																																																																																														}
																																																																																																																																																																																																													}
																																																																																																																																																																																																												}
																																																																																																																																																																																																											}
																																																																																																																																																																																																										}
																																																																																																																																																																																																									}
																																																																																																																																																																																																								}
																																																																																																																																																																																																							}
																																																																																																																																																																																																						}
																																																																																																																																																																																																					}
																																																																																																																																																																																																				}
																																																																																																																																																																																																			}
																																																																																																																																																																																																		}
																																																																																																																																																																																																	}
																																																																																																																																																																																																}
																																																																																																																																																																																															}
																																																																																																																																																																																														}
																																																																																																																																																																																													}
																																																																																																																																																																																												}
																																																																																																																																																																																											}
																																																																																																																																																																																										}
																																																																																																																																																																																									}
																																																																																																																																																																																								}
																																																																																																																																																																																							}
																																																																																																																																																																																						}
																																																																																																																																																																																					}
																																																																																																																																																																																				}
																																																																																																																																																																																			}
																																																																																																																																																																																		}
																																																																																																																																																																																	}
																																																																																																																																																																																}
																																																																																																																																																																															}
																																																																																																																																																																														}
																																																																																																																																																																													}
																																																																																																																																																																												}
																																																																																																																																																																											}
																																																																																																																																																																										}
																																																																																																																																																																									}
																																																																																																																																																																								}
																																																																																																																																																																							}
																																																																																																																																																																						}
																																																																																																																																																																					}
																																																																																																																																																																				}
																																																																																																																																																																			}
																																																																																																																																																																		}
																																																																																																																																																																	}
																																																																																																																																																																}
																																																																																																																																																															}
																																																																																																																																																														}
																																																																																																																																																													}
																																																																																																																																																												}
																																																																																																																																																											}
																																																																																																																																																										}
																																																																																																																																																									}
																																																																																																																																																								}
																																																																																																																																																							}
																																																																																																																																																						}
																																																																																																																																																					}
																																																																																																																																																				}
																																																																																																																																																			}
																																																																																																																																																		}
																																																																																																																																																	}
																																																																																																																																																}
																																																																																																																																															}
																																																																																																																																														}
																																																																																																																																													}
																																																																																																																																												}
																																																																																																																																											}
																																																																																																																																										}
																																																																																																																																									}
																																																																																																																																								}
																																																																																																																																							}
																																																																																																																																						}
																																																																																																																																					}
																																																																																																																																				}
																																																																																																																																			}
																																																																																																																																		}
																																																																																																																																	}
																																																																																																																																}
																																																																																																																															}
																																																																																																																														}
																																																																																																																													}
																																																																																																																												}
																																																																																																																											}
																																																																																																																										}
																																																																																																																									}
																																																																																																																								}
																																																																																																																							}
																																																																																																																						}
																																																																																																																					}
																																																																																																																				}
																																																																																																																			}
																																																																																																																		}
																																																																																																																	}
																																																																																																																}
																																																																																																															}
																																																																																																														}
																																																																																																													}
																																																																																																												}
																																																																																																											}
																																																																																																										}
																																																																																																									}
																																																																																																								}
																																																																																																							}
																																																																																																						}
																																																																																																					}
																																																																																																				}
																																																																																																			}
																																																																																																		}
																																																																																																	}
																																																																																																}
																																																																																															}
																																																																																														}
																																																																																													}
																																																																																												}
																																																																																											}
																																																																																										}
																																																																																									}
																																																																																								}
																																																																																							}
																																																																																						}
																																																																																					}
																																																																																				}
																																																																																			}
																																																																																		}
																																																																																	}
																																																																																}
																																																																															}
																																																																														}
																																																																													}
																																																																												}
																																																																											}
																																																																										}
																																																																									}
																																																																								}
																																																																							}
																																																																						}
																																																																					}
																																																																				}
																																																																			}
																																																																		}
																																																																	}
																																																																}
																																																															}
																																																														}
																																																													}
																																																												}
																																																											}
																																																										}
																																																									}
																																																								}
																																																							}
																																																						}
																																																					}
																																																				}
																																																			}
																																																		}
																																																	}
																																																}
																																															}
																																														}
																																													}
																																												}
																																											}
																																										}
																																									}
																																								}
																																							}
																																						}
																																					}
																																				}
																																			}
																																		}
																																	}
																																}
																															}
																														}
																													}
																												}
																											}
																										}
																									}
																								}
																							}
																						}
																					}
																				}
																			}
																		}
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	});
var _user$project$ColorNum$dict = function () {
	var f = F2(
		function (_p4, acc) {
			var _p5 = _p4;
			return A3(
				_elm_lang$core$Dict$insert,
				_p5._0 - 1,
				{
					ctor: '::',
					_0: _p5._1._0,
					_1: {
						ctor: '::',
						_0: _p5._1._1,
						_1: {
							ctor: '::',
							_0: _p5._1._2,
							_1: {
								ctor: '::',
								_0: 1.0,
								_1: {ctor: '[]'}
							}
						}
					}
				},
				acc);
		});
	return A3(_user$project$Utils$foldli1, f, _elm_lang$core$Dict$empty, _user$project$ColorNum$codes);
}();
var _user$project$ColorNum$convert = function (i) {
	var _p6 = A2(
		_elm_lang$core$Dict$get,
		_elm_lang$core$Basics$floor(i),
		_user$project$ColorNum$dict);
	if (_p6.ctor === 'Nothing') {
		return {
			ctor: '::',
			_0: 0,
			_1: {
				ctor: '::',
				_0: 0,
				_1: {
					ctor: '::',
					_0: 0,
					_1: {
						ctor: '::',
						_0: 1,
						_1: {ctor: '[]'}
					}
				}
			}
		};
	} else {
		return _p6._0;
	}
};

var _user$project$Either$Right = function (a) {
	return {ctor: 'Right', _0: a};
};
var _user$project$Either$Left = function (a) {
	return {ctor: 'Left', _0: a};
};

var _user$project$LangSvg$fetchMovieDurationAndContinueBool = function (movieVal) {
	var _p0 = _user$project$Lang$unwrapVList(movieVal);
	_v0_2:
	do {
		if (((((_p0.ctor === 'Just') && (_p0._0.ctor === '::')) && (_p0._0._0.ctor === 'VBase')) && (_p0._0._0._0.ctor === 'VString')) && (_p0._0._1.ctor === '::')) {
			if (_p0._0._1._1.ctor === '[]') {
				if ((_p0._0._0._0._0 === 'Static') && (_p0._0._1._0.ctor === 'VClosure')) {
					return {ctor: '_Tuple2', _0: 0.0, _1: false};
				} else {
					break _v0_2;
				}
			} else {
				if ((((((((_p0._0._0._0._0 === 'Dynamic') && (_p0._0._1._0.ctor === 'VConst')) && (_p0._0._1._0._1.ctor === '_Tuple2')) && (_p0._0._1._1._0.ctor === 'VClosure')) && (_p0._0._1._1._1.ctor === '::')) && (_p0._0._1._1._1._0.ctor === 'VBase')) && (_p0._0._1._1._1._0._0.ctor === 'VBool')) && (_p0._0._1._1._1._1.ctor === '[]')) {
					return {ctor: '_Tuple2', _0: _p0._0._1._0._1._0, _1: _p0._0._1._1._1._0._0._0};
				} else {
					break _v0_2;
				}
			}
		} else {
			break _v0_2;
		}
	} while(false);
	return {ctor: '_Tuple2', _0: 0.0, _1: false};
};
var _user$project$LangSvg$fetchMovieCount = function (slideVal) {
	var _p1 = _user$project$Lang$unwrapVList(slideVal);
	if ((((((_p1.ctor === 'Just') && (_p1._0.ctor === '::')) && (_p1._0._0.ctor === 'VConst')) && (_p1._0._0._1.ctor === '_Tuple2')) && (_p1._0._1.ctor === '::')) && (_p1._0._1._1.ctor === '[]')) {
		return _elm_lang$core$Basics$round(_p1._0._0._1._0);
	} else {
		return 1;
	}
};
var _user$project$LangSvg$fetchSlideCount = function (val) {
	var _p2 = _user$project$Lang$unwrapVList(val);
	if ((((((_p2.ctor === 'Just') && (_p2._0.ctor === '::')) && (_p2._0._0.ctor === 'VConst')) && (_p2._0._0._1.ctor === '_Tuple2')) && (_p2._0._1.ctor === '::')) && (_p2._0._1._1.ctor === '[]')) {
		return _elm_lang$core$Basics$round(_p2._0._0._1._0);
	} else {
		return 1;
	}
};
var _user$project$LangSvg$vNumFrozen = function (n) {
	return _user$project$Lang$val(
		A2(
			_user$project$Lang$VConst,
			_elm_lang$core$Maybe$Nothing,
			{
				ctor: '_Tuple2',
				_0: n,
				_1: _user$project$Lang$TrLoc(
					{
						ctor: '_Tuple3',
						_0: -999,
						_1: _user$project$Lang$frozen,
						_2: _elm_lang$core$Basics$toString(n)
					})
			}));
};
var _user$project$LangSvg$vIntFrozen = function (i) {
	return _user$project$LangSvg$vNumFrozen(
		_elm_lang$core$Basics$toFloat(i));
};
var _user$project$LangSvg$fetchSlideVal = F2(
	function (slideNumber, val) {
		var _p3 = _user$project$Lang$unwrapVList(val);
		if (((((((_p3.ctor === 'Just') && (_p3._0.ctor === '::')) && (_p3._0._0.ctor === 'VConst')) && (_p3._0._0._1.ctor === '_Tuple2')) && (_p3._0._1.ctor === '::')) && (_p3._0._1._0.ctor === 'VClosure')) && (_p3._0._1._1.ctor === '[]')) {
			var _p7 = _p3._0._1._0._1;
			var _p4 = _p7.val.p__;
			if (_p4.ctor === 'PVar') {
				var fenv_ = {
					ctor: '::',
					_0: {
						ctor: '_Tuple2',
						_0: _p4._1,
						_1: _user$project$LangSvg$vIntFrozen(slideNumber)
					},
					_1: _p3._0._1._0._3
				};
				return A2(
					_elm_lang$core$Result$map,
					function (_p5) {
						var _p6 = _p5;
						return _p6._0._0;
					},
					A2(_user$project$Eval$doEval, fenv_, _p3._0._1._0._2));
			} else {
				return _elm_lang$core$Result$Err(
					A2(
						_elm_lang$core$Basics_ops['++'],
						'expected slide function to take a single argument, got ',
						_elm_lang$core$Basics$toString(_p7.val.p__)));
			}
		} else {
			return _elm_lang$core$Result$Ok(val);
		}
	});
var _user$project$LangSvg$resolveToMovieCount = F2(
	function (slideNumber, val) {
		return A2(
			_elm_lang$core$Result$map,
			_user$project$LangSvg$fetchMovieCount,
			A2(_user$project$LangSvg$fetchSlideVal, slideNumber, val));
	});
var _user$project$LangSvg$fetchMovieVal = F2(
	function (movieNumber, slideVal) {
		var _p8 = _user$project$Lang$unwrapVList(slideVal);
		if (((((((_p8.ctor === 'Just') && (_p8._0.ctor === '::')) && (_p8._0._0.ctor === 'VConst')) && (_p8._0._0._1.ctor === '_Tuple2')) && (_p8._0._1.ctor === '::')) && (_p8._0._1._0.ctor === 'VClosure')) && (_p8._0._1._1.ctor === '[]')) {
			var _p12 = _p8._0._1._0._1;
			var _p9 = _p12.val.p__;
			if (_p9.ctor === 'PVar') {
				var fenv_ = {
					ctor: '::',
					_0: {
						ctor: '_Tuple2',
						_0: _p9._1,
						_1: _user$project$LangSvg$vIntFrozen(movieNumber)
					},
					_1: _p8._0._1._0._3
				};
				return A2(
					_elm_lang$core$Result$map,
					function (_p10) {
						var _p11 = _p10;
						return _p11._0._0;
					},
					A2(_user$project$Eval$doEval, fenv_, _p8._0._1._0._2));
			} else {
				return _elm_lang$core$Result$Err(
					A2(
						_elm_lang$core$Basics_ops['++'],
						'expected movie function to take a single argument, got ',
						_elm_lang$core$Basics$toString(_p12.val.p__)));
			}
		} else {
			return _elm_lang$core$Result$Ok(slideVal);
		}
	});
var _user$project$LangSvg$fetchMovieFrameVal = F4(
	function (slideNumber, movieNumber, movieTime, movieVal) {
		var _p13 = _user$project$Lang$unwrapVList(movieVal);
		_v9_2:
		do {
			if (((((_p13.ctor === 'Just') && (_p13._0.ctor === '::')) && (_p13._0._0.ctor === 'VBase')) && (_p13._0._0._0.ctor === 'VString')) && (_p13._0._1.ctor === '::')) {
				if (_p13._0._1._1.ctor === '[]') {
					if ((_p13._0._0._0._0 === 'Static') && (_p13._0._1._0.ctor === 'VClosure')) {
						var _p22 = _p13._0._1._0._1;
						var _p14 = _p22.val.p__;
						if (_p14.ctor === 'PVar') {
							var fenv_ = {
								ctor: '::',
								_0: {
									ctor: '_Tuple2',
									_0: _p14._1,
									_1: _user$project$LangSvg$vIntFrozen(slideNumber)
								},
								_1: _p13._0._1._0._3
							};
							var _p17 = A2(
								_elm_lang$core$Result$map,
								function (_p15) {
									var _p16 = _p15;
									return _p16._0._0.v_;
								},
								A2(_user$project$Eval$doEval, fenv_, _p13._0._1._0._2));
							if (_p17.ctor === 'Ok') {
								if (_p17._0.ctor === 'VClosure') {
									var _p21 = _p17._0._1;
									var _p18 = _p21.val.p__;
									if (_p18.ctor === 'PVar') {
										var fenvInner_ = {
											ctor: '::',
											_0: {
												ctor: '_Tuple2',
												_0: _p18._1,
												_1: _user$project$LangSvg$vIntFrozen(movieNumber)
											},
											_1: _p17._0._3
										};
										return A2(
											_elm_lang$core$Result$map,
											function (_p19) {
												var _p20 = _p19;
												return _p20._0._0;
											},
											A2(_user$project$Eval$doEval, fenvInner_, _p17._0._2));
									} else {
										return _elm_lang$core$Result$Err(
											A2(
												_elm_lang$core$Basics_ops['++'],
												'expected static movie frame function to take two arguments, got ',
												_elm_lang$core$Basics$toString(_p21.val.p__)));
									}
								} else {
									return _elm_lang$core$Result$Err(
										A2(
											_elm_lang$core$Basics_ops['++'],
											'expected static movie frame function to take two arguments, got ',
											_elm_lang$core$Basics$toString(_p17._0)));
								}
							} else {
								return _elm_lang$core$Result$Err(_p17._0);
							}
						} else {
							return _elm_lang$core$Result$Err(
								A2(
									_elm_lang$core$Basics_ops['++'],
									'expected static movie frame function to take two arguments, got ',
									_elm_lang$core$Basics$toString(_p22.val.p__)));
						}
					} else {
						break _v9_2;
					}
				} else {
					if ((((((((_p13._0._0._0._0 === 'Dynamic') && (_p13._0._1._0.ctor === 'VConst')) && (_p13._0._1._0._1.ctor === '_Tuple2')) && (_p13._0._1._1._0.ctor === 'VClosure')) && (_p13._0._1._1._1.ctor === '::')) && (_p13._0._1._1._1._0.ctor === 'VBase')) && (_p13._0._1._1._1._0._0.ctor === 'VBool')) && (_p13._0._1._1._1._1.ctor === '[]')) {
						var _p36 = _p13._0._1._1._0._1;
						var _p23 = _p36.val.p__;
						if (_p23.ctor === 'PVar') {
							var fenv_ = {
								ctor: '::',
								_0: {
									ctor: '_Tuple2',
									_0: _p23._1,
									_1: _user$project$LangSvg$vIntFrozen(slideNumber)
								},
								_1: _p13._0._1._1._0._3
							};
							var _p26 = A2(
								_elm_lang$core$Result$map,
								function (_p24) {
									var _p25 = _p24;
									return _p25._0._0.v_;
								},
								A2(_user$project$Eval$doEval, fenv_, _p13._0._1._1._0._2));
							if (_p26.ctor === 'Ok') {
								if (_p26._0.ctor === 'VClosure') {
									var _p35 = _p26._0._1;
									var _p27 = _p35.val.p__;
									if (_p27.ctor === 'PVar') {
										var fenvInner1_ = {
											ctor: '::',
											_0: {
												ctor: '_Tuple2',
												_0: _p27._1,
												_1: _user$project$LangSvg$vIntFrozen(movieNumber)
											},
											_1: _p26._0._3
										};
										var _p30 = A2(
											_elm_lang$core$Result$map,
											function (_p28) {
												var _p29 = _p28;
												return _p29._0._0.v_;
											},
											A2(_user$project$Eval$doEval, fenvInner1_, _p26._0._2));
										if (_p30.ctor === 'Ok') {
											if (_p30._0.ctor === 'VClosure') {
												var _p34 = _p30._0._1;
												var _p31 = _p34.val.p__;
												if (_p31.ctor === 'PVar') {
													var fenvInner2_ = {
														ctor: '::',
														_0: {
															ctor: '_Tuple2',
															_0: _p31._1,
															_1: _user$project$LangSvg$vNumFrozen(movieTime)
														},
														_1: _p30._0._3
													};
													return A2(
														_elm_lang$core$Result$map,
														function (_p32) {
															var _p33 = _p32;
															return _p33._0._0;
														},
														A2(_user$project$Eval$doEval, fenvInner2_, _p30._0._2));
												} else {
													return _elm_lang$core$Result$Err(
														A2(
															_elm_lang$core$Basics_ops['++'],
															'expected dynamic movie frame function to take four arguments, got ',
															_elm_lang$core$Basics$toString(_p34.val.p__)));
												}
											} else {
												return _elm_lang$core$Result$Err(
													A2(
														_elm_lang$core$Basics_ops['++'],
														'expected dynamic movie frame function to take four arguments, got ',
														_elm_lang$core$Basics$toString(_p30._0)));
											}
										} else {
											return _elm_lang$core$Result$Err(_p30._0);
										}
									} else {
										return _elm_lang$core$Result$Err(
											A2(
												_elm_lang$core$Basics_ops['++'],
												'expected dynamic movie frame function to take four arguments, got ',
												_elm_lang$core$Basics$toString(_p35.val.p__)));
									}
								} else {
									return _elm_lang$core$Result$Err(
										A2(
											_elm_lang$core$Basics_ops['++'],
											'expected dynamic movie frame function to take four arguments, got ',
											_elm_lang$core$Basics$toString(_p26._0)));
								}
							} else {
								return _elm_lang$core$Result$Err(_p26._0);
							}
						} else {
							return _elm_lang$core$Result$Err(
								A2(
									_elm_lang$core$Basics_ops['++'],
									'expected dynamic movie frame function to take four arguments, got ',
									_elm_lang$core$Basics$toString(_p36.val.p__)));
						}
					} else {
						break _v9_2;
					}
				}
			} else {
				break _v9_2;
			}
		} while(false);
		return _elm_lang$core$Result$Ok(movieVal);
	});
var _user$project$LangSvg$fetchEverything_ = F4(
	function (slideNumber, movieNumber, movieTime, val) {
		var slideCount = _user$project$LangSvg$fetchSlideCount(val);
		return A2(
			_elm_lang$core$Result$andThen,
			function (slideVal) {
				var movieCount = _user$project$LangSvg$fetchMovieCount(slideVal);
				return A2(
					_elm_lang$core$Result$andThen,
					function (movieVal) {
						var _p37 = _user$project$LangSvg$fetchMovieDurationAndContinueBool(movieVal);
						var movieDuration = _p37._0;
						var $continue = _p37._1;
						return A2(
							_elm_lang$core$Result$map,
							function (movieFrameVal) {
								return {ctor: '_Tuple5', _0: slideCount, _1: movieCount, _2: movieDuration, _3: $continue, _4: movieFrameVal};
							},
							A4(_user$project$LangSvg$fetchMovieFrameVal, slideNumber, movieNumber, movieTime, movieVal));
					},
					A2(_user$project$LangSvg$fetchMovieVal, movieNumber, slideVal));
			},
			A2(_user$project$LangSvg$fetchSlideVal, slideNumber, val));
	});
var _user$project$LangSvg$resolveToMovieFrameVal = F4(
	function (slideNumber, movieNumber, movieTime, val) {
		return A2(
			_elm_lang$core$Result$map,
			function (_p38) {
				var _p39 = _p38;
				return _p39._4;
			},
			A4(_user$project$LangSvg$fetchEverything_, slideNumber, movieNumber, movieTime, val));
	});
var _user$project$LangSvg$foldSlate = F3(
	function (_p40, acc, f) {
		var _p41 = _p40;
		var foldNode = F2(
			function (i, acc) {
				var node = A3(_user$project$Utils$justGet_, 'foldSlate', i, _p41._1);
				var _p42 = node;
				if (_p42.ctor === 'TextNode') {
					return A3(f, i, node, acc);
				} else {
					return A3(
						f,
						i,
						node,
						A3(_elm_lang$core$List$foldl, foldNode, acc, _p42._2));
				}
			});
		return A2(foldNode, _p41._0, acc);
	});
var _user$project$LangSvg$foldSlateNodeInfo = F3(
	function (slate, acc, f) {
		return A3(
			_user$project$LangSvg$foldSlate,
			slate,
			acc,
			F2(
				function (i, node) {
					var _p43 = node;
					if (_p43.ctor === 'TextNode') {
						return f(
							_user$project$Either$Left(
								{ctor: '_Tuple2', _0: i, _1: _p43._0}));
					} else {
						return f(
							_user$project$Either$Right(
								{ctor: '_Tuple3', _0: i, _1: _p43._0, _2: _p43._1}));
					}
				}));
	});
var _user$project$LangSvg$dummySvgVal = function () {
	var zero = _user$project$Lang$vConst(
		{ctor: '_Tuple2', _0: 0, _1: _user$project$Lang$dummyTrace});
	var attrs = _user$project$Lang$vList(
		A2(
			_elm_lang$core$List$map,
			function (k) {
				return _user$project$Lang$vList(
					{
						ctor: '::',
						_0: _user$project$Lang$vStr(k),
						_1: {
							ctor: '::',
							_0: zero,
							_1: {ctor: '[]'}
						}
					});
			},
			{
				ctor: '::',
				_0: 'cx',
				_1: {
					ctor: '::',
					_0: 'cy',
					_1: {
						ctor: '::',
						_0: 'r',
						_1: {ctor: '[]'}
					}
				}
			}));
	var children = _user$project$Lang$vList(
		{ctor: '[]'});
	return _user$project$Lang$vList(
		{
			ctor: '::',
			_0: _user$project$Lang$vStr('circle'),
			_1: {
				ctor: '::',
				_0: attrs,
				_1: {
					ctor: '::',
					_0: children,
					_1: {ctor: '[]'}
				}
			}
		});
}();
var _user$project$LangSvg$justGetSvgNode = F3(
	function (cap, nodeId, _p44) {
		var _p45 = _p44;
		var _p46 = A3(_user$project$Utils$justGet_, cap, nodeId, _p45._1);
		if (_p46.ctor === 'SvgNode') {
			return {ctor: '_Tuple2', _0: _p46._0, _1: _p46._1};
		} else {
			return _elm_lang$core$Native_Utils.crashCase(
				'LangSvg',
				{
					start: {line: 631, column: 3},
					end: {line: 633, column: 64}
				},
				_p46)(
				A2(_elm_lang$core$Basics_ops['++'], cap, ': TextNode ?'));
		}
	});
var _user$project$LangSvg$maybeFindBounds = function (l) {
	var _p48 = A2(_user$project$Utils$maybeFind, 'BOUNDS', l);
	if (_p48.ctor === 'Nothing') {
		return _elm_lang$core$Maybe$Nothing;
	} else {
		var roundBounds = true;
		var _p49 = {ctor: '_Tuple2', _0: _p48._0.av_, _1: roundBounds};
		_v30_2:
		do {
			if ((_p49.ctor === '_Tuple2') && (_p49._0.ctor === 'ABounds')) {
				if (_p49._1 === false) {
					return _elm_lang$core$Maybe$Just(_p49._0._0);
				} else {
					if (_p49._0._0.ctor === '_Tuple4') {
						var f = _elm_lang$core$Tuple$mapFirst(
							function (_p50) {
								return _elm_lang$core$Basics$toFloat(
									_elm_lang$core$Basics$round(_p50));
							});
						return _elm_lang$core$Maybe$Just(
							{
								ctor: '_Tuple4',
								_0: f(_p49._0._0._0),
								_1: f(_p49._0._0._1),
								_2: f(_p49._0._0._2),
								_3: f(_p49._0._0._3)
							});
					} else {
						break _v30_2;
					}
				}
			} else {
				break _v30_2;
			}
		} while(false);
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$LangSvg$maybeFindBlobId = function (l) {
	var _p51 = A2(_user$project$Utils$maybeFind, 'BLOB', l);
	if (_p51.ctor === 'Nothing') {
		return _elm_lang$core$Maybe$Nothing;
	} else {
		var _p52 = _p51._0.av_;
		if (_p52.ctor === 'AString') {
			return _elm_lang$core$Maybe$Just(
				_user$project$Utils$parseInt(_p52._0));
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	}
};
var _user$project$LangSvg$findAVal = F2(
	function (attr, attrs) {
		var _p53 = A2(_user$project$Utils$maybeFind, attr, attrs);
		if (_p53.ctor === 'Just') {
			return _p53._0;
		} else {
			return _elm_lang$core$Native_Utils.crashCase(
				'LangSvg',
				{
					start: {line: 556, column: 3},
					end: {line: 558, column: 53}
				},
				_p53)(
				A2(_elm_lang$core$Basics_ops['++'], 'findAVal: ', attr));
		}
	});
var _user$project$LangSvg$getBoundsAttrs = function (attrs0) {
	return A2(
		_elm_lang$core$Maybe$andThen,
		function (_p55) {
			var _p56 = _p55;
			return A2(
				_elm_lang$core$Maybe$andThen,
				function (_p57) {
					var _p58 = _p57;
					return A2(
						_elm_lang$core$Maybe$andThen,
						function (_p59) {
							var _p60 = _p59;
							return A2(
								_elm_lang$core$Maybe$andThen,
								function (_p61) {
									var _p62 = _p61;
									var _p63 = {ctor: '_Tuple4', _0: _p56._0.av_, _1: _p60._0.av_, _2: _p58._0.av_, _3: _p62._0.av_};
									if (((((((((_p63.ctor === '_Tuple4') && (_p63._0.ctor === 'ANum')) && (_p63._0._0.ctor === '_Tuple2')) && (_p63._1.ctor === 'ANum')) && (_p63._1._0.ctor === '_Tuple2')) && (_p63._2.ctor === 'ANum')) && (_p63._2._0.ctor === '_Tuple2')) && (_p63._3.ctor === 'ANum')) && (_p63._3._0.ctor === '_Tuple2')) {
										return _elm_lang$core$Maybe$Just(
											{ctor: '_Tuple5', _0: _p63._0._0._0, _1: _p63._1._0._0, _2: _p63._2._0._0, _3: _p63._3._0._0, _4: _p62._1});
									} else {
										return _elm_lang$core$Maybe$Nothing;
									}
								},
								A2(_user$project$Utils$maybeRemoveFirst, 'BOT', _p60._1));
						},
						A2(_user$project$Utils$maybeRemoveFirst, 'TOP', _p58._1));
				},
				A2(_user$project$Utils$maybeRemoveFirst, 'RIGHT', _p56._1));
		},
		A2(_user$project$Utils$maybeRemoveFirst, 'LEFT', attrs0));
};
var _user$project$LangSvg$specialAttrs = {
	ctor: '::',
	_0: 'HIDDEN',
	_1: {
		ctor: '::',
		_0: 'ZONES',
		_1: {ctor: '[]'}
	}
};
var _user$project$LangSvg$removeSpecialAttrs = _elm_lang$core$List$filter(
	function (_p64) {
		var _p65 = _p64;
		return !A2(_elm_lang$core$List$member, _p65._0, _user$project$LangSvg$specialAttrs);
	});
var _user$project$LangSvg$strBounds = function (_p66) {
	var _p67 = _p66;
	return _user$project$Utils$spaces(
		A2(
			_elm_lang$core$List$map,
			function (_p68) {
				return _elm_lang$core$Basics$toString(
					_elm_lang$core$Tuple$first(_p68));
			},
			{
				ctor: '::',
				_0: _p67._0,
				_1: {
					ctor: '::',
					_0: _p67._1,
					_1: {
						ctor: '::',
						_0: _p67._2,
						_1: {
							ctor: '::',
							_0: _p67._3,
							_1: {ctor: '[]'}
						}
					}
				}
			}));
};
var _user$project$LangSvg$strTransformCmd = function (cmd) {
	var _p69 = cmd;
	switch (_p69.ctor) {
		case 'Rot':
			var nums = A2(
				_elm_lang$core$List$map,
				function (_p70) {
					return _elm_lang$core$Basics$toString(
						_elm_lang$core$Tuple$first(_p70));
				},
				{
					ctor: '::',
					_0: _p69._0,
					_1: {
						ctor: '::',
						_0: _p69._1,
						_1: {
							ctor: '::',
							_0: _p69._2,
							_1: {ctor: '[]'}
						}
					}
				});
			return A2(
				_elm_lang$core$Basics_ops['++'],
				'rotate',
				_user$project$Utils$parens(
					_user$project$Utils$spaces(nums)));
		case 'Scale':
			var nums = A2(
				_elm_lang$core$List$map,
				function (_p71) {
					return _elm_lang$core$Basics$toString(
						_elm_lang$core$Tuple$first(_p71));
				},
				{
					ctor: '::',
					_0: _p69._0,
					_1: {
						ctor: '::',
						_0: _p69._1,
						_1: {ctor: '[]'}
					}
				});
			return A2(
				_elm_lang$core$Basics_ops['++'],
				'scale',
				_user$project$Utils$parens(
					_user$project$Utils$spaces(nums)));
		default:
			var nums = A2(
				_elm_lang$core$List$map,
				function (_p72) {
					return _elm_lang$core$Basics$toString(
						_elm_lang$core$Tuple$first(_p72));
				},
				{
					ctor: '::',
					_0: _p69._0,
					_1: {
						ctor: '::',
						_0: _p69._1,
						_1: {ctor: '[]'}
					}
				});
			return A2(
				_elm_lang$core$Basics_ops['++'],
				'translate',
				_user$project$Utils$parens(
					_user$project$Utils$spaces(nums)));
	}
};
var _user$project$LangSvg$strAPathCmds = function () {
	var strPt = function (_p73) {
		var _p74 = _p73;
		return A2(
			_elm_lang$core$Basics_ops['++'],
			_elm_lang$core$Basics$toString(
				_elm_lang$core$Tuple$first(_p74._1._0)),
			A2(
				_elm_lang$core$Basics_ops['++'],
				' ',
				_elm_lang$core$Basics$toString(
					_elm_lang$core$Tuple$first(_p74._1._1))));
	};
	var strNum = function (_p75) {
		var _p76 = _p75;
		return _elm_lang$core$Basics$toString(_p76._0);
	};
	var strPathCmd = function (c) {
		var _p77 = c;
		switch (_p77.ctor) {
			case 'CmdZ':
				return _p77._0;
			case 'CmdMLT':
				return _user$project$Utils$spaces(
					{
						ctor: '::',
						_0: _p77._0,
						_1: {
							ctor: '::',
							_0: strPt(_p77._1),
							_1: {ctor: '[]'}
						}
					});
			case 'CmdHV':
				return _user$project$Utils$spaces(
					{
						ctor: '::',
						_0: _p77._0,
						_1: {
							ctor: '::',
							_0: strNum(_p77._1),
							_1: {ctor: '[]'}
						}
					});
			case 'CmdC':
				return _user$project$Utils$spaces(
					{
						ctor: '::',
						_0: _p77._0,
						_1: A2(
							_elm_lang$core$List$map,
							strPt,
							{
								ctor: '::',
								_0: _p77._1,
								_1: {
									ctor: '::',
									_0: _p77._2,
									_1: {
										ctor: '::',
										_0: _p77._3,
										_1: {ctor: '[]'}
									}
								}
							})
					});
			case 'CmdSQ':
				return _user$project$Utils$spaces(
					{
						ctor: '::',
						_0: _p77._0,
						_1: A2(
							_elm_lang$core$List$map,
							strPt,
							{
								ctor: '::',
								_0: _p77._1,
								_1: {
									ctor: '::',
									_0: _p77._2,
									_1: {ctor: '[]'}
								}
							})
					});
			default:
				return _user$project$Utils$spaces(
					{
						ctor: '::',
						_0: _p77._0,
						_1: A2(
							_elm_lang$core$Basics_ops['++'],
							A2(
								_elm_lang$core$List$map,
								strNum,
								{
									ctor: '::',
									_0: _p77._1,
									_1: {
										ctor: '::',
										_0: _p77._2,
										_1: {
											ctor: '::',
											_0: _p77._3,
											_1: {
												ctor: '::',
												_0: _p77._4,
												_1: {
													ctor: '::',
													_0: _p77._5,
													_1: {ctor: '[]'}
												}
											}
										}
									}
								}),
							{
								ctor: '::',
								_0: strPt(_p77._6),
								_1: {ctor: '[]'}
							})
					});
		}
	};
	return function (_p78) {
		return _user$project$Utils$spaces(
			A2(_elm_lang$core$List$map, strPathCmd, _p78));
	};
}();
var _user$project$LangSvg$matchCmd = F2(
	function (cmd, s) {
		var c = _user$project$Utils$unwrap1(
			_elm_lang$core$String$toList(cmd));
		var cs = _elm_lang$core$String$toList(s);
		return A2(
			_elm_lang$core$List$member,
			c,
			A2(
				_elm_lang$core$Basics_ops['++'],
				cs,
				A2(_elm_lang$core$List$map, _elm_lang$core$Char$toLower, cs)));
	});
var _user$project$LangSvg$projConsts = F2(
	function (k, vs) {
		var _p79 = {
			ctor: '_Tuple2',
			_0: _elm_lang$core$Native_Utils.eq(k, 0),
			_1: vs
		};
		_v45_2:
		do {
			if (_p79.ctor === '_Tuple2') {
				if (_p79._0 === true) {
					return {
						ctor: '_Tuple2',
						_0: {ctor: '[]'},
						_1: vs
					};
				} else {
					if (_p79._1.ctor === '::') {
						var _p80 = _p79._1._0.v_;
						if (_p80.ctor === 'VConst') {
							var _p81 = A2(_user$project$LangSvg$projConsts, k - 1, _p79._1._1);
							var l1 = _p81._0;
							var l2 = _p81._1;
							return {
								ctor: '_Tuple2',
								_0: {ctor: '::', _0: _p80._1, _1: l1},
								_1: l2
							};
						} else {
							return _elm_lang$core$Native_Utils.crashCase(
								'LangSvg',
								{
									start: {line: 317, column: 7},
									end: {line: 322, column: 35}
								},
								_p80)('projConsts');
						}
					} else {
						break _v45_2;
					}
				}
			} else {
				break _v45_2;
			}
		} while(false);
		return _elm_lang$core$Native_Utils.crashCase(
			'LangSvg',
			{
				start: {line: 314, column: 3},
				end: {line: 324, column: 31}
			},
			_p79)('projConsts');
	});
var _user$project$LangSvg$addIdPoints = F3(
	function (cmd, counts, pts) {
		var c = _user$project$Utils$unwrap1(
			_elm_lang$core$String$toList(cmd));
		if (_elm_lang$core$Char$isLower(c)) {
			return {
				ctor: '_Tuple2',
				_0: counts,
				_1: A2(
					_elm_lang$core$List$map,
					F2(
						function (v0, v1) {
							return {ctor: '_Tuple2', _0: v0, _1: v1};
						})(_elm_lang$core$Maybe$Nothing),
					pts)
			};
		} else {
			if (_elm_lang$core$Char$isUpper(c)) {
				var _p84 = A3(
					_elm_lang$core$List$foldl,
					F2(
						function (pt, _p85) {
							var _p86 = _p85;
							var _p87 = _p86._0;
							var nextId = 1 + _p87.numPoints;
							var acc1_ = _elm_lang$core$Native_Utils.update(
								_p87,
								{numPoints: nextId});
							var acc2_ = {
								ctor: '::',
								_0: {
									ctor: '_Tuple2',
									_0: _elm_lang$core$Maybe$Just(nextId),
									_1: pt
								},
								_1: _p86._1
							};
							return {ctor: '_Tuple2', _0: acc1_, _1: acc2_};
						}),
					{
						ctor: '_Tuple2',
						_0: counts,
						_1: {ctor: '[]'}
					},
					pts);
				var counts_ = _p84._0;
				var l = _p84._1;
				return {
					ctor: '_Tuple2',
					_0: counts_,
					_1: _elm_lang$core$List$reverse(l)
				};
			} else {
				return _elm_lang$core$Native_Utils.crash(
					'LangSvg',
					{
						start: {line: 311, column: 5},
						end: {line: 311, column: 16}
					})('addIdPoints');
			}
		}
	});
var _user$project$LangSvg_ops = _user$project$LangSvg_ops || {};
_user$project$LangSvg_ops['+++'] = F2(
	function (x, _p88) {
		var _p89 = _p88;
		return {
			ctor: '_Tuple2',
			_0: {ctor: '::', _0: x, _1: _p89._0},
			_1: _p89._1
		};
	});
var _user$project$LangSvg$strRgba_ = function (rgba) {
	return A2(
		_elm_lang$core$Basics_ops['++'],
		'rgba',
		_user$project$Utils$parens(
			_user$project$Utils$commas(
				A2(_elm_lang$core$List$map, _elm_lang$core$Basics$toString, rgba))));
};
var _user$project$LangSvg$strRgba = function (_p90) {
	var _p91 = _p90;
	return _user$project$LangSvg$strRgba_(
		A2(
			_elm_lang$core$List$map,
			_elm_lang$core$Tuple$first,
			{
				ctor: '::',
				_0: _p91._0,
				_1: {
					ctor: '::',
					_0: _p91._1,
					_1: {
						ctor: '::',
						_0: _p91._2,
						_1: {
							ctor: '::',
							_0: _p91._3,
							_1: {ctor: '[]'}
						}
					}
				}
			}));
};
var _user$project$LangSvg$strPoint = function (_p92) {
	var _p93 = _p92;
	var _p94 = _user$project$Utils$unwrap2(
		A2(
			_elm_lang$core$List$map,
			_elm_lang$core$Tuple$first,
			{
				ctor: '::',
				_0: _p93._0,
				_1: {
					ctor: '::',
					_0: _p93._1,
					_1: {ctor: '[]'}
				}
			}));
	var x = _p94._0;
	var y = _p94._1;
	return A2(
		_elm_lang$core$Basics_ops['++'],
		_elm_lang$core$Basics$toString(x),
		A2(
			_elm_lang$core$Basics_ops['++'],
			',',
			_elm_lang$core$Basics$toString(y)));
};
var _user$project$LangSvg$maxStrokeWidthNum = 20;
var _user$project$LangSvg$maxColorNum = 500;
var _user$project$LangSvg$strAVal = function (a) {
	var _p95 = a.av_;
	switch (_p95.ctor) {
		case 'AString':
			return _p95._0;
		case 'ANum':
			return _elm_lang$core$Basics$toString(
				_elm_lang$core$Tuple$first(_p95._0));
		case 'APoints':
			return _user$project$Utils$spaces(
				A2(_elm_lang$core$List$map, _user$project$LangSvg$strPoint, _p95._0));
		case 'ARgba':
			return _user$project$LangSvg$strRgba(_p95._0);
		case 'APath2':
			return _user$project$LangSvg$strAPathCmds(
				_elm_lang$core$Tuple$first(_p95._0));
		case 'ATransform':
			return _user$project$Utils$spaces(
				A2(_elm_lang$core$List$map, _user$project$LangSvg$strTransformCmd, _p95._0));
		case 'ABounds':
			return _user$project$LangSvg$strBounds(_p95._0);
		default:
			if (_p95._0._1.ctor === 'Nothing') {
				return _user$project$LangSvg$strRgba_(
					_user$project$ColorNum$convert(
						_elm_lang$core$Tuple$first(_p95._0._0)));
			} else {
				var _p96 = A2(
					_user$project$Utils$numToColor,
					_user$project$LangSvg$maxColorNum,
					_elm_lang$core$Tuple$first(_p95._0._0));
				var r = _p96._0;
				var g = _p96._1;
				var b = _p96._2;
				return _user$project$LangSvg$strRgba_(
					{
						ctor: '::',
						_0: _elm_lang$core$Basics$toFloat(r),
						_1: {
							ctor: '::',
							_0: _elm_lang$core$Basics$toFloat(g),
							_1: {
								ctor: '::',
								_0: _elm_lang$core$Basics$toFloat(b),
								_1: {
									ctor: '::',
									_0: _p95._0._1._0._0,
									_1: {ctor: '[]'}
								}
							}
						}
					});
			}
	}
};
var _user$project$LangSvg$printAttr = function (_p97) {
	var _p98 = _p97;
	return A2(
		_elm_lang$core$Basics_ops['++'],
		_p98._0,
		A2(
			_elm_lang$core$Basics_ops['++'],
			'=',
			A3(
				_user$project$Utils$delimit,
				'\'',
				'\'',
				_user$project$LangSvg$strAVal(_p98._1))));
};
var _user$project$LangSvg$printAttrs = function (l) {
	var _p99 = l;
	if (_p99.ctor === '[]') {
		return '';
	} else {
		return A2(
			_elm_lang$core$Basics_ops['++'],
			' ',
			_user$project$Utils$spaces(
				A2(_elm_lang$core$List$map, _user$project$LangSvg$printAttr, l)));
	}
};
var _user$project$LangSvg$expectedButGotStr = F2(
	function (x, s) {
		return A2(
			_elm_lang$core$Basics_ops['++'],
			'expected ',
			A2(
				_elm_lang$core$Basics_ops['++'],
				x,
				A2(_elm_lang$core$Basics_ops['++'], ', but got: ', s)));
	});
var _user$project$LangSvg$expectedButGotCrash = F2(
	function (x, s) {
		return _elm_lang$core$Native_Utils.crash(
			'LangSvg',
			{
				start: {line: 57, column: 27},
				end: {line: 57, column: 38}
			})(
			A2(_user$project$LangSvg$expectedButGotStr, x, s));
	});
var _user$project$LangSvg$toNum = function (a) {
	var _p100 = a.av_;
	if (_p100.ctor === 'ANum') {
		return _p100._0;
	} else {
		return A2(
			_user$project$LangSvg$expectedButGotCrash,
			'a number',
			_user$project$LangSvg$strAVal(a));
	}
};
var _user$project$LangSvg$toColorNum = function (a) {
	var _p101 = a.av_;
	if (_p101.ctor === 'AColorNum') {
		return _p101._0;
	} else {
		return A2(
			_user$project$LangSvg$expectedButGotCrash,
			'a color number',
			_user$project$LangSvg$strAVal(a));
	}
};
var _user$project$LangSvg$toNumIsh = function (a) {
	var _p102 = a.av_;
	_v56_2:
	do {
		switch (_p102.ctor) {
			case 'ANum':
				return _p102._0;
			case 'AColorNum':
				if (_p102._0.ctor === '_Tuple2') {
					return _p102._0._0;
				} else {
					break _v56_2;
				}
			default:
				break _v56_2;
		}
	} while(false);
	return A2(
		_user$project$LangSvg$expectedButGotCrash,
		'a number or color number',
		_user$project$LangSvg$strAVal(a));
};
var _user$project$LangSvg$findNumishAttr = F2(
	function (attr, attrs) {
		return _user$project$LangSvg$toNumIsh(
			A2(_user$project$LangSvg$findAVal, attr, attrs));
	});
var _user$project$LangSvg$toPoints = function (a) {
	var _p103 = a.av_;
	if (_p103.ctor === 'APoints') {
		return _p103._0;
	} else {
		return A2(
			_user$project$LangSvg$expectedButGotCrash,
			'a list of points',
			_user$project$LangSvg$strAVal(a));
	}
};
var _user$project$LangSvg$getPolyPoints = function (attrs) {
	var _p104 = A2(_user$project$Utils$maybeFind, 'points', attrs);
	if (_p104.ctor === 'Just') {
		return _user$project$LangSvg$toPoints(_p104._0);
	} else {
		return _elm_lang$core$Native_Utils.crashCase(
			'LangSvg',
			{
				start: {line: 566, column: 3},
				end: {line: 568, column: 45}
			},
			_p104)('getPolyPoints');
	}
};
var _user$project$LangSvg$getPtCount = function (attrs) {
	return _elm_lang$core$List$length(
		_user$project$LangSvg$getPolyPoints(attrs));
};
var _user$project$LangSvg$getPolyPoint = F2(
	function (attrs, i) {
		return A2(
			_user$project$Utils$geti,
			i,
			_user$project$LangSvg$getPolyPoints(attrs));
	});
var _user$project$LangSvg$toPath = function (a) {
	var _p106 = a.av_;
	if (_p106.ctor === 'APath2') {
		return _p106._0;
	} else {
		return A2(
			_user$project$LangSvg$expectedButGotCrash,
			'path commands',
			_user$project$LangSvg$strAVal(a));
	}
};
var _user$project$LangSvg$pathIndexPoints = function (nodeAttrs) {
	var cmds = _elm_lang$core$Tuple$first(
		_user$project$LangSvg$toPath(
			A3(
				_user$project$Utils$find,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'pathPoints nodeAttrs looking for \"d\" in ',
					_elm_lang$core$Basics$toString(nodeAttrs)),
				nodeAttrs,
				'd')));
	var pts = A2(
		_elm_lang$core$List$filterMap,
		function (_p107) {
			var _p108 = _p107;
			var _p109 = _p108._0;
			if (_p109.ctor === 'Nothing') {
				return _elm_lang$core$Maybe$Nothing;
			} else {
				return _elm_lang$core$Maybe$Just(
					{ctor: '_Tuple2', _0: _p109._0, _1: _p108._1});
			}
		},
		A2(
			_elm_lang$core$List$concatMap,
			function (cmd) {
				var _p110 = cmd;
				switch (_p110.ctor) {
					case 'CmdZ':
						return {ctor: '[]'};
					case 'CmdMLT':
						return {
							ctor: '::',
							_0: _p110._1,
							_1: {ctor: '[]'}
						};
					case 'CmdHV':
						return {ctor: '[]'};
					case 'CmdC':
						return {
							ctor: '::',
							_0: _p110._1,
							_1: {
								ctor: '::',
								_0: _p110._2,
								_1: {
									ctor: '::',
									_0: _p110._3,
									_1: {ctor: '[]'}
								}
							}
						};
					case 'CmdSQ':
						return {
							ctor: '::',
							_0: _p110._1,
							_1: {
								ctor: '::',
								_0: _p110._2,
								_1: {ctor: '[]'}
							}
						};
					default:
						return {
							ctor: '::',
							_0: _p110._6,
							_1: {ctor: '[]'}
						};
				}
			},
			cmds));
	return pts;
};
var _user$project$LangSvg$getPathPoint = F2(
	function (attrs, i) {
		var _p111 = A2(
			_user$project$Utils$maybeFind,
			i,
			_user$project$LangSvg$pathIndexPoints(attrs));
		if (_p111.ctor === 'Just') {
			return _p111._0;
		} else {
			return _elm_lang$core$Native_Utils.crashCase(
				'LangSvg',
				{
					start: {line: 572, column: 3},
					end: {line: 574, column: 42}
				},
				_p111)('getPathPoint');
		}
	});
var _user$project$LangSvg$toTransformRot = function (a) {
	var _p113 = a.av_;
	if ((((_p113.ctor === 'ATransform') && (_p113._0.ctor === '::')) && (_p113._0._0.ctor === 'Rot')) && (_p113._0._1.ctor === '[]')) {
		return {ctor: '_Tuple3', _0: _p113._0._0._0, _1: _p113._0._0._1, _2: _p113._0._0._2};
	} else {
		return A2(
			_user$project$LangSvg$expectedButGotCrash,
			'a rotation transform',
			_user$project$LangSvg$strAVal(a));
	}
};
var _user$project$LangSvg$expectedButGot = F2(
	function (x, s) {
		return _elm_lang$core$Result$Err(
			A2(_user$project$LangSvg$expectedButGotStr, x, s));
	});
var _user$project$LangSvg$valToPoint = function (v) {
	var _p114 = v.v_;
	if (_p114.ctor === 'VList') {
		var _p115 = A2(
			_elm_lang$core$List$map,
			function (_) {
				return _.v_;
			},
			_p114._0);
		if (((((_p115.ctor === '::') && (_p115._0.ctor === 'VConst')) && (_p115._1.ctor === '::')) && (_p115._1._0.ctor === 'VConst')) && (_p115._1._1.ctor === '[]')) {
			return _elm_lang$core$Result$Ok(
				{ctor: '_Tuple2', _0: _p115._0._1, _1: _p115._1._0._1});
		} else {
			return A2(
				_user$project$LangSvg$expectedButGot,
				'a point',
				_user$project$Lang$strVal(v));
		}
	} else {
		return A2(
			_user$project$LangSvg$expectedButGot,
			'a point',
			_user$project$Lang$strVal(v));
	}
};
var _user$project$LangSvg$valsToRgba = function (vs) {
	var _p116 = A2(
		_elm_lang$core$List$map,
		function (_) {
			return _.v_;
		},
		vs);
	if (((((((((_p116.ctor === '::') && (_p116._0.ctor === 'VConst')) && (_p116._1.ctor === '::')) && (_p116._1._0.ctor === 'VConst')) && (_p116._1._1.ctor === '::')) && (_p116._1._1._0.ctor === 'VConst')) && (_p116._1._1._1.ctor === '::')) && (_p116._1._1._1._0.ctor === 'VConst')) && (_p116._1._1._1._1.ctor === '[]')) {
		return _elm_lang$core$Result$Ok(
			{ctor: '_Tuple4', _0: _p116._0._1, _1: _p116._1._0._1, _2: _p116._1._1._0._1, _3: _p116._1._1._1._0._1});
	} else {
		return A2(
			_user$project$LangSvg$expectedButGot,
			'rgba',
			_user$project$Lang$strVal(
				_user$project$Lang$vList(vs)));
	}
};
var _user$project$LangSvg$valToBounds = function (vs) {
	var _p117 = A2(
		_elm_lang$core$List$map,
		function (_) {
			return _.v_;
		},
		vs);
	if (((((((((_p117.ctor === '::') && (_p117._0.ctor === 'VConst')) && (_p117._1.ctor === '::')) && (_p117._1._0.ctor === 'VConst')) && (_p117._1._1.ctor === '::')) && (_p117._1._1._0.ctor === 'VConst')) && (_p117._1._1._1.ctor === '::')) && (_p117._1._1._1._0.ctor === 'VConst')) && (_p117._1._1._1._1.ctor === '[]')) {
		return _elm_lang$core$Result$Ok(
			{ctor: '_Tuple4', _0: _p117._0._1, _1: _p117._1._0._1, _2: _p117._1._1._0._1, _3: _p117._1._1._1._0._1});
	} else {
		return A2(
			_user$project$LangSvg$expectedButGot,
			'bounds',
			_user$project$Lang$strVal(
				_user$project$Lang$vList(vs)));
	}
};
var _user$project$LangSvg$attr = _elm_lang$virtual_dom$VirtualDom$attribute;
var _user$project$LangSvg$compileAttr = F2(
	function (k, v) {
		return A2(
			_user$project$LangSvg$attr,
			k,
			_user$project$LangSvg$strAVal(v));
	});
var _user$project$LangSvg$compileAttrs = _elm_lang$core$List$map(
	_elm_lang$core$Basics$uncurry(_user$project$LangSvg$compileAttr));
var _user$project$LangSvg$AVal = F2(
	function (a, b) {
		return {av_: a, vtrace: b};
	});
var _user$project$LangSvg$aVal = A2(
	_elm_lang$core$Basics$flip,
	_user$project$LangSvg$AVal,
	{
		ctor: '::',
		_0: -1,
		_1: {ctor: '[]'}
	});
var _user$project$LangSvg$PathCounts = function (a) {
	return {numPoints: a};
};
var _user$project$LangSvg$ABounds = function (a) {
	return {ctor: 'ABounds', _0: a};
};
var _user$project$LangSvg$ATransform = function (a) {
	return {ctor: 'ATransform', _0: a};
};
var _user$project$LangSvg$aTransform = function (_p118) {
	return _user$project$LangSvg$aVal(
		_user$project$LangSvg$ATransform(_p118));
};
var _user$project$LangSvg$APath2 = function (a) {
	return {ctor: 'APath2', _0: a};
};
var _user$project$LangSvg$aPath2 = function (_p119) {
	return _user$project$LangSvg$aVal(
		_user$project$LangSvg$APath2(_p119));
};
var _user$project$LangSvg$AColorNum = function (a) {
	return {ctor: 'AColorNum', _0: a};
};
var _user$project$LangSvg$aColorNum = function (_p120) {
	return _user$project$LangSvg$aVal(
		_user$project$LangSvg$AColorNum(_p120));
};
var _user$project$LangSvg$ARgba = function (a) {
	return {ctor: 'ARgba', _0: a};
};
var _user$project$LangSvg$APoints = function (a) {
	return {ctor: 'APoints', _0: a};
};
var _user$project$LangSvg$aPoints = function (_p121) {
	return _user$project$LangSvg$aVal(
		_user$project$LangSvg$APoints(_p121));
};
var _user$project$LangSvg$AString = function (a) {
	return {ctor: 'AString', _0: a};
};
var _user$project$LangSvg$aString = function (_p122) {
	return _user$project$LangSvg$aVal(
		_user$project$LangSvg$AString(_p122));
};
var _user$project$LangSvg$addAttrs = F2(
	function (kind, attrs) {
		return _elm_lang$core$Native_Utils.eq(kind, 'svg') ? {
			ctor: '::',
			_0: {
				ctor: '_Tuple2',
				_0: 'xmlns',
				_1: _user$project$LangSvg$aString('http://www.w3.org/2000/svg')
			},
			_1: attrs
		} : attrs;
	});
var _user$project$LangSvg$ANum = function (a) {
	return {ctor: 'ANum', _0: a};
};
var _user$project$LangSvg$aNum = function (_p123) {
	return _user$project$LangSvg$aVal(
		_user$project$LangSvg$ANum(_p123));
};
var _user$project$LangSvg$desugarShapeAttrs = F2(
	function (shape0, attrs0) {
		var mkNum = function (n) {
			return _user$project$LangSvg$aNum(
				{ctor: '_Tuple2', _0: n, _1: _user$project$Lang$dummyTrace});
		};
		return A2(
			_elm_lang$core$Maybe$withDefault,
			{ctor: '_Tuple2', _0: shape0, _1: attrs0},
			function () {
				var _p124 = shape0;
				switch (_p124) {
					case 'BOX':
						return A2(
							_user$project$Utils$mapMaybe,
							function (_p125) {
								var _p126 = _p125;
								var _p128 = _p126._1;
								var _p127 = _p126._0;
								var newAttrs = {
									ctor: '::',
									_0: {
										ctor: '_Tuple2',
										_0: 'x',
										_1: mkNum(_p127)
									},
									_1: {
										ctor: '::',
										_0: {
											ctor: '_Tuple2',
											_0: 'y',
											_1: mkNum(_p128)
										},
										_1: {
											ctor: '::',
											_0: {
												ctor: '_Tuple2',
												_0: 'width',
												_1: mkNum(_p126._2 - _p127)
											},
											_1: {
												ctor: '::',
												_0: {
													ctor: '_Tuple2',
													_0: 'height',
													_1: mkNum(_p126._3 - _p128)
												},
												_1: {ctor: '[]'}
											}
										}
									}
								};
								return {
									ctor: '_Tuple2',
									_0: 'rect',
									_1: A2(_elm_lang$core$Basics_ops['++'], newAttrs, _p126._4)
								};
							},
							_user$project$LangSvg$getBoundsAttrs(attrs0));
					case 'OVAL':
						return A2(
							_user$project$Utils$mapMaybe,
							function (_p129) {
								var _p130 = _p129;
								var _p134 = _p130._1;
								var _p133 = _p130._2;
								var _p132 = _p130._0;
								var _p131 = _p130._3;
								var newAttrs = {
									ctor: '::',
									_0: {
										ctor: '_Tuple2',
										_0: 'cx',
										_1: mkNum(_p132 + ((_p133 - _p132) / 2))
									},
									_1: {
										ctor: '::',
										_0: {
											ctor: '_Tuple2',
											_0: 'cy',
											_1: mkNum(_p134 + ((_p131 - _p134) / 2))
										},
										_1: {
											ctor: '::',
											_0: {
												ctor: '_Tuple2',
												_0: 'rx',
												_1: mkNum((_p133 - _p132) / 2)
											},
											_1: {
												ctor: '::',
												_0: {
													ctor: '_Tuple2',
													_0: 'ry',
													_1: mkNum((_p131 - _p134) / 2)
												},
												_1: {ctor: '[]'}
											}
										}
									}
								};
								return {
									ctor: '_Tuple2',
									_0: 'ellipse',
									_1: A2(_elm_lang$core$Basics_ops['++'], newAttrs, _p130._4)
								};
							},
							_user$project$LangSvg$getBoundsAttrs(attrs0));
					default:
						return _elm_lang$core$Maybe$Nothing;
				}
			}());
	});
var _user$project$LangSvg$printNode = F4(
	function (showGhosts, k, slate, i) {
		var _p135 = A2(_user$project$Utils$justGet, i, slate);
		if (_p135.ctor === 'TextNode') {
			return _p135._0;
		} else {
			var _p138 = _p135._2;
			var _p136 = A2(_user$project$LangSvg$desugarShapeAttrs, _p135._0, _p135._1);
			var kind = _p136._0;
			var l1 = _p136._1;
			var _p137 = {
				ctor: '_Tuple2',
				_0: showGhosts,
				_1: A2(_user$project$Utils$maybeRemoveFirst, 'HIDDEN', l1)
			};
			if (((_p137.ctor === '_Tuple2') && (_p137._0 === false)) && (_p137._1.ctor === 'Just')) {
				return '';
			} else {
				if (_elm_lang$core$Native_Utils.eq(
					_p138,
					{ctor: '[]'})) {
					var l1_ = A2(
						_user$project$LangSvg$addAttrs,
						kind,
						_user$project$LangSvg$removeSpecialAttrs(l1));
					return A2(
						_elm_lang$core$Basics_ops['++'],
						A3(
							_user$project$Utils$delimit,
							'<',
							'>',
							A2(
								_elm_lang$core$Basics_ops['++'],
								kind,
								_user$project$LangSvg$printAttrs(l1_))),
						A3(_user$project$Utils$delimit, '</', '>', kind));
				} else {
					var l1_ = A2(
						_user$project$LangSvg$addAttrs,
						kind,
						_user$project$LangSvg$removeSpecialAttrs(l1));
					return A2(
						_elm_lang$core$Basics_ops['++'],
						A3(
							_user$project$Utils$delimit,
							'<',
							'>',
							A2(
								_elm_lang$core$Basics_ops['++'],
								kind,
								_user$project$LangSvg$printAttrs(l1_))),
						A2(
							_elm_lang$core$Basics_ops['++'],
							'\n',
							A2(
								_elm_lang$core$Basics_ops['++'],
								A4(_user$project$LangSvg$printNodes, showGhosts, k + 1, slate, _p138),
								A2(
									_elm_lang$core$Basics_ops['++'],
									'\n',
									A2(
										_elm_lang$core$Basics_ops['++'],
										_user$project$Lang$tab(k),
										A3(_user$project$Utils$delimit, '</', '>', kind))))));
				}
			}
		}
	});
var _user$project$LangSvg$printNodes = F3(
	function (showGhosts, k, slate) {
		return function (_p139) {
			return _user$project$Utils$lines(
				A2(
					_elm_lang$core$List$map,
					function (_p140) {
						return A2(
							F2(
								function (x, y) {
									return A2(_elm_lang$core$Basics_ops['++'], x, y);
								}),
							_user$project$Lang$tab(k),
							A4(_user$project$LangSvg$printNode, showGhosts, k, slate, _p140));
					},
					_p139));
		};
	});
var _user$project$LangSvg$printSvg = F2(
	function (showGhosts, _p141) {
		var _p142 = _p141;
		var s = A4(_user$project$LangSvg$printNode, showGhosts, 0, _p142._1, _p142._0);
		return A4(
			_elm_lang$core$Regex$replace,
			_elm_lang$core$Regex$All,
			_elm_lang$core$Regex$regex('[ ]+\\n'),
			function (_p143) {
				return '';
			},
			s);
	});
var _user$project$LangSvg$CmdA = F7(
	function (a, b, c, d, e, f, g) {
		return {ctor: 'CmdA', _0: a, _1: b, _2: c, _3: d, _4: e, _5: f, _6: g};
	});
var _user$project$LangSvg$CmdSQ = F3(
	function (a, b, c) {
		return {ctor: 'CmdSQ', _0: a, _1: b, _2: c};
	});
var _user$project$LangSvg$CmdC = F4(
	function (a, b, c, d) {
		return {ctor: 'CmdC', _0: a, _1: b, _2: c, _3: d};
	});
var _user$project$LangSvg$CmdHV = F2(
	function (a, b) {
		return {ctor: 'CmdHV', _0: a, _1: b};
	});
var _user$project$LangSvg$CmdMLT = F2(
	function (a, b) {
		return {ctor: 'CmdMLT', _0: a, _1: b};
	});
var _user$project$LangSvg$CmdZ = function (a) {
	return {ctor: 'CmdZ', _0: a};
};
var _user$project$LangSvg$valsToPath2_ = F2(
	function (counts, vs) {
		var _p144 = vs;
		if (_p144.ctor === '[]') {
			return _elm_lang$core$Result$Ok(
				{
					ctor: '_Tuple2',
					_0: {ctor: '[]'},
					_1: counts
				});
		} else {
			var _p156 = _p144._1;
			var _p145 = _p144._0.v_;
			if ((_p145.ctor === 'VBase') && (_p145._0.ctor === 'VString')) {
				var _p155 = _p145._0._0;
				if (A2(_user$project$LangSvg$matchCmd, _p155, 'Z')) {
					return A2(
						_elm_lang$core$Result$map,
						function (rest) {
							return A2(
								_user$project$LangSvg_ops['+++'],
								_user$project$LangSvg$CmdZ(_p155),
								rest);
						},
						A2(_user$project$LangSvg$valsToPath2_, counts, _p156));
				} else {
					if (A2(_user$project$LangSvg$matchCmd, _p155, 'MLT')) {
						var _p146 = A2(
							_elm_lang$core$Tuple$mapFirst,
							_user$project$Utils$unwrap2,
							A2(_user$project$LangSvg$projConsts, 2, _p156));
						var x = _p146._0._0;
						var y = _p146._0._1;
						var vs__ = _p146._1;
						var _p147 = A2(
							_elm_lang$core$Tuple$mapSecond,
							_user$project$Utils$unwrap1,
							A3(
								_user$project$LangSvg$addIdPoints,
								_p155,
								counts,
								{
									ctor: '::',
									_0: {ctor: '_Tuple2', _0: x, _1: y},
									_1: {ctor: '[]'}
								}));
						var counts_ = _p147._0;
						var pt = _p147._1;
						return A2(
							_elm_lang$core$Result$map,
							function (rest) {
								return A2(
									_user$project$LangSvg_ops['+++'],
									A2(_user$project$LangSvg$CmdMLT, _p155, pt),
									rest);
							},
							A2(_user$project$LangSvg$valsToPath2_, counts_, vs__));
					} else {
						if (A2(_user$project$LangSvg$matchCmd, _p155, 'HV')) {
							var _p148 = A2(
								_elm_lang$core$Tuple$mapFirst,
								_user$project$Utils$unwrap1,
								A2(_user$project$LangSvg$projConsts, 1, _p156));
							var i = _p148._0;
							var vs__ = _p148._1;
							return A2(
								_elm_lang$core$Result$map,
								function (rest) {
									return A2(
										_user$project$LangSvg_ops['+++'],
										A2(_user$project$LangSvg$CmdHV, _p155, i),
										rest);
								},
								A2(_user$project$LangSvg$valsToPath2_, counts, vs__));
						} else {
							if (A2(_user$project$LangSvg$matchCmd, _p155, 'C')) {
								var _p149 = A2(
									_elm_lang$core$Tuple$mapFirst,
									_user$project$Utils$unwrap6,
									A2(_user$project$LangSvg$projConsts, 6, _p156));
								var x1 = _p149._0._0;
								var y1 = _p149._0._1;
								var x2 = _p149._0._2;
								var y2 = _p149._0._3;
								var x = _p149._0._4;
								var y = _p149._0._5;
								var vs__ = _p149._1;
								var _p150 = A2(
									_elm_lang$core$Tuple$mapSecond,
									_user$project$Utils$unwrap3,
									A3(
										_user$project$LangSvg$addIdPoints,
										_p155,
										counts,
										{
											ctor: '::',
											_0: {ctor: '_Tuple2', _0: x1, _1: y1},
											_1: {
												ctor: '::',
												_0: {ctor: '_Tuple2', _0: x2, _1: y2},
												_1: {
													ctor: '::',
													_0: {ctor: '_Tuple2', _0: x, _1: y},
													_1: {ctor: '[]'}
												}
											}
										}));
								var counts_ = _p150._0;
								var pt1 = _p150._1._0;
								var pt2 = _p150._1._1;
								var pt3 = _p150._1._2;
								return A2(
									_elm_lang$core$Result$map,
									function (rest) {
										return A2(
											_user$project$LangSvg_ops['+++'],
											A4(_user$project$LangSvg$CmdC, _p155, pt1, pt2, pt3),
											rest);
									},
									A2(_user$project$LangSvg$valsToPath2_, counts_, vs__));
							} else {
								if (A2(_user$project$LangSvg$matchCmd, _p155, 'SQ')) {
									var _p151 = A2(
										_elm_lang$core$Tuple$mapFirst,
										_user$project$Utils$unwrap4,
										A2(_user$project$LangSvg$projConsts, 4, _p156));
									var x1 = _p151._0._0;
									var y1 = _p151._0._1;
									var x = _p151._0._2;
									var y = _p151._0._3;
									var vs__ = _p151._1;
									var _p152 = A2(
										_elm_lang$core$Tuple$mapSecond,
										_user$project$Utils$unwrap2,
										A3(
											_user$project$LangSvg$addIdPoints,
											_p155,
											counts,
											{
												ctor: '::',
												_0: {ctor: '_Tuple2', _0: x1, _1: y1},
												_1: {
													ctor: '::',
													_0: {ctor: '_Tuple2', _0: x, _1: y},
													_1: {ctor: '[]'}
												}
											}));
									var counts_ = _p152._0;
									var pt1 = _p152._1._0;
									var pt2 = _p152._1._1;
									return A2(
										_elm_lang$core$Result$map,
										function (rest) {
											return A2(
												_user$project$LangSvg_ops['+++'],
												A3(_user$project$LangSvg$CmdSQ, _p155, pt1, pt2),
												rest);
										},
										A2(_user$project$LangSvg$valsToPath2_, counts_, vs__));
								} else {
									if (A2(_user$project$LangSvg$matchCmd, _p155, 'A')) {
										var _p153 = A2(
											_elm_lang$core$Tuple$mapFirst,
											_user$project$Utils$unwrap7,
											A2(_user$project$LangSvg$projConsts, 7, _p156));
										var rx = _p153._0._0;
										var ry = _p153._0._1;
										var axis = _p153._0._2;
										var flag = _p153._0._3;
										var sweep = _p153._0._4;
										var x = _p153._0._5;
										var y = _p153._0._6;
										var vs__ = _p153._1;
										var _p154 = A2(
											_elm_lang$core$Tuple$mapSecond,
											_user$project$Utils$unwrap1,
											A3(
												_user$project$LangSvg$addIdPoints,
												_p155,
												counts,
												{
													ctor: '::',
													_0: {ctor: '_Tuple2', _0: x, _1: y},
													_1: {ctor: '[]'}
												}));
										var counts_ = _p154._0;
										var pt = _p154._1;
										return A2(
											_elm_lang$core$Result$map,
											function (rest) {
												return A2(
													_user$project$LangSvg_ops['+++'],
													A7(_user$project$LangSvg$CmdA, _p155, rx, ry, axis, flag, sweep, pt),
													rest);
											},
											A2(_user$project$LangSvg$valsToPath2_, counts_, vs__));
									} else {
										return _elm_lang$core$Result$Err('valsToPath2_');
									}
								}
							}
						}
					}
				}
			} else {
				return _elm_lang$core$Result$Err('valsToPath2_');
			}
		}
	});
var _user$project$LangSvg$valsToPath2 = _user$project$LangSvg$valsToPath2_(
	{numPoints: 0});
var _user$project$LangSvg$Trans = F2(
	function (a, b) {
		return {ctor: 'Trans', _0: a, _1: b};
	});
var _user$project$LangSvg$Scale = F2(
	function (a, b) {
		return {ctor: 'Scale', _0: a, _1: b};
	});
var _user$project$LangSvg$Rot = F3(
	function (a, b, c) {
		return {ctor: 'Rot', _0: a, _1: b, _2: c};
	});
var _user$project$LangSvg$valToTransformCmd = function (v) {
	var _p157 = v.v_;
	if (_p157.ctor === 'VList') {
		var _p158 = A2(
			_elm_lang$core$List$map,
			function (_) {
				return _.v_;
			},
			_p157._0);
		if (((_p158.ctor === '::') && (_p158._0.ctor === 'VBase')) && (_p158._0._0.ctor === 'VString')) {
			var _p159 = {ctor: '_Tuple2', _0: _p158._0._0._0, _1: _p158._1};
			_v79_3:
			do {
				if (((((_p159.ctor === '_Tuple2') && (_p159._1.ctor === '::')) && (_p159._1._0.ctor === 'VConst')) && (_p159._1._1.ctor === '::')) && (_p159._1._1._0.ctor === 'VConst')) {
					if (_p159._1._1._1.ctor === '::') {
						if (((_p159._0 === 'rotate') && (_p159._1._1._1._0.ctor === 'VConst')) && (_p159._1._1._1._1.ctor === '[]')) {
							return _elm_lang$core$Result$Ok(
								A3(_user$project$LangSvg$Rot, _p159._1._0._1, _p159._1._1._0._1, _p159._1._1._1._0._1));
						} else {
							break _v79_3;
						}
					} else {
						switch (_p159._0) {
							case 'scale':
								return _elm_lang$core$Result$Ok(
									A2(_user$project$LangSvg$Scale, _p159._1._0._1, _p159._1._1._0._1));
							case 'translate':
								return _elm_lang$core$Result$Ok(
									A2(_user$project$LangSvg$Trans, _p159._1._0._1, _p159._1._1._0._1));
							default:
								break _v79_3;
						}
					}
				} else {
					break _v79_3;
				}
			} while(false);
			return A2(
				_user$project$LangSvg$expectedButGot,
				'a transform command',
				_user$project$Lang$strVal(v));
		} else {
			return A2(
				_user$project$LangSvg$expectedButGot,
				'a transform command',
				_user$project$Lang$strVal(v));
		}
	} else {
		return A2(
			_user$project$LangSvg$expectedButGot,
			'a transform command',
			_user$project$Lang$strVal(v));
	}
};
var _user$project$LangSvg$valsToTransform = function (_p160) {
	return _user$project$Utils$projOk(
		A2(_elm_lang$core$List$map, _user$project$LangSvg$valToTransformCmd, _p160));
};
var _user$project$LangSvg$valToAttr = function (v) {
	var _p161 = v.v_;
	if ((((_p161.ctor === 'VList') && (_p161._0.ctor === '::')) && (_p161._0._1.ctor === '::')) && (_p161._0._1._1.ctor === '[]')) {
		var _p169 = _p161._0._1._0;
		var _p162 = {ctor: '_Tuple2', _0: _p161._0._0.v_, _1: _p169.v_};
		if (((_p162.ctor === '_Tuple2') && (_p162._0.ctor === 'VBase')) && (_p162._0._0.ctor === 'VString')) {
			var _p168 = _p162._0._0._0;
			var avRes = function () {
				var _p163 = {ctor: '_Tuple2', _0: _p168, _1: _p162._1};
				_v82_12:
				do {
					if (_p163.ctor === '_Tuple2') {
						switch (_p163._1.ctor) {
							case 'VList':
								switch (_p163._0) {
									case 'points':
										return A2(
											_elm_lang$core$Result$map,
											_user$project$LangSvg$APoints,
											_user$project$Utils$projOk(
												A2(_elm_lang$core$List$map, _user$project$LangSvg$valToPoint, _p163._1._0)));
									case 'fill':
										if ((_p163._1._0.ctor === '::') && (_p163._1._0._1.ctor === '::')) {
											if (_p163._1._0._1._1.ctor === '::') {
												if ((_p163._1._0._1._1._1.ctor === '::') && (_p163._1._0._1._1._1._1.ctor === '[]')) {
													return A2(
														_elm_lang$core$Result$map,
														_user$project$LangSvg$ARgba,
														_user$project$LangSvg$valsToRgba(
															{
																ctor: '::',
																_0: _p163._1._0._0,
																_1: {
																	ctor: '::',
																	_0: _p163._1._0._1._0,
																	_1: {
																		ctor: '::',
																		_0: _p163._1._0._1._1._0,
																		_1: {
																			ctor: '::',
																			_0: _p163._1._0._1._1._1._0,
																			_1: {ctor: '[]'}
																		}
																	}
																}
															}));
												} else {
													break _v82_12;
												}
											} else {
												var _p165 = _p163._1._0._1._0;
												var _p164 = {ctor: '_Tuple2', _0: _p163._1._0._0.v_, _1: _p165.v_};
												if (((_p164.ctor === '_Tuple2') && (_p164._0.ctor === 'VConst')) && (_p164._1.ctor === 'VConst')) {
													return _elm_lang$core$Result$Ok(
														_user$project$LangSvg$AColorNum(
															{
																ctor: '_Tuple2',
																_0: _p164._0._1,
																_1: _elm_lang$core$Maybe$Just(_p164._1._1)
															}));
												} else {
													return _elm_lang$core$Result$Err(
														A2(
															_elm_lang$core$Basics_ops['++'],
															'bad fill: ',
															_user$project$Lang$strVal(_p165)));
												}
											}
										} else {
											break _v82_12;
										}
									case 'stroke':
										if ((_p163._1._0.ctor === '::') && (_p163._1._0._1.ctor === '::')) {
											if (_p163._1._0._1._1.ctor === '::') {
												if ((_p163._1._0._1._1._1.ctor === '::') && (_p163._1._0._1._1._1._1.ctor === '[]')) {
													return A2(
														_elm_lang$core$Result$map,
														_user$project$LangSvg$ARgba,
														_user$project$LangSvg$valsToRgba(
															{
																ctor: '::',
																_0: _p163._1._0._0,
																_1: {
																	ctor: '::',
																	_0: _p163._1._0._1._0,
																	_1: {
																		ctor: '::',
																		_0: _p163._1._0._1._1._0,
																		_1: {
																			ctor: '::',
																			_0: _p163._1._0._1._1._1._0,
																			_1: {ctor: '[]'}
																		}
																	}
																}
															}));
												} else {
													break _v82_12;
												}
											} else {
												var _p167 = _p163._1._0._1._0;
												var _p166 = {ctor: '_Tuple2', _0: _p163._1._0._0.v_, _1: _p167.v_};
												if (((_p166.ctor === '_Tuple2') && (_p166._0.ctor === 'VConst')) && (_p166._1.ctor === 'VConst')) {
													return _elm_lang$core$Result$Ok(
														_user$project$LangSvg$AColorNum(
															{
																ctor: '_Tuple2',
																_0: _p166._0._1,
																_1: _elm_lang$core$Maybe$Just(_p166._1._1)
															}));
												} else {
													return _elm_lang$core$Result$Err(
														A2(
															_elm_lang$core$Basics_ops['++'],
															'bad stroke: ',
															_user$project$Lang$strVal(_p167)));
												}
											}
										} else {
											break _v82_12;
										}
									case 'd':
										return A2(
											_elm_lang$core$Result$map,
											_user$project$LangSvg$APath2,
											_user$project$LangSvg$valsToPath2(_p163._1._0));
									case 'transform':
										return A2(
											_elm_lang$core$Result$map,
											_user$project$LangSvg$ATransform,
											_user$project$LangSvg$valsToTransform(_p163._1._0));
									case 'BOUNDS':
										return A2(
											_elm_lang$core$Result$map,
											_user$project$LangSvg$ABounds,
											_user$project$LangSvg$valToBounds(_p163._1._0));
									default:
										break _v82_12;
								}
							case 'VConst':
								switch (_p163._0) {
									case 'fill':
										return _elm_lang$core$Result$Ok(
											_user$project$LangSvg$AColorNum(
												{ctor: '_Tuple2', _0: _p163._1._1, _1: _elm_lang$core$Maybe$Nothing}));
									case 'stroke':
										return _elm_lang$core$Result$Ok(
											_user$project$LangSvg$AColorNum(
												{ctor: '_Tuple2', _0: _p163._1._1, _1: _elm_lang$core$Maybe$Nothing}));
									default:
										return _elm_lang$core$Result$Ok(
											_user$project$LangSvg$ANum(_p163._1._1));
								}
							case 'VBase':
								if (_p163._1._0.ctor === 'VString') {
									return _elm_lang$core$Result$Ok(
										_user$project$LangSvg$AString(_p163._1._0._0));
								} else {
									break _v82_12;
								}
							default:
								break _v82_12;
						}
					} else {
						break _v82_12;
					}
				} while(false);
				return _elm_lang$core$Result$Err(
					A2(
						_elm_lang$core$Basics_ops['++'],
						'bad SVG attribute value for ',
						A2(
							_elm_lang$core$Basics_ops['++'],
							_p168,
							A2(
								_elm_lang$core$Basics_ops['++'],
								': ',
								_user$project$Lang$strVal(_p169)))));
			}();
			return A2(
				_elm_lang$core$Result$map,
				function (av) {
					return {
						ctor: '_Tuple2',
						_0: _p168,
						_1: A2(_user$project$LangSvg$AVal, av, _p169.vtrace)
					};
				},
				avRes);
		} else {
			return _elm_lang$core$Result$Err(
				A2(
					_elm_lang$core$Basics_ops['++'],
					'malformed attribute pair: ',
					_user$project$Lang$strVal(v)));
		}
	} else {
		return _elm_lang$core$Result$Err(
			A2(
				_elm_lang$core$Basics_ops['++'],
				'malformed attribute list, bad element: ',
				_user$project$Lang$strVal(v)));
	}
};
var _user$project$LangSvg$SvgNode = F3(
	function (a, b, c) {
		return {ctor: 'SvgNode', _0: a, _1: b, _2: c};
	});
var _user$project$LangSvg$dummySvgNode = function () {
	var zero = _user$project$LangSvg$aNum(
		{ctor: '_Tuple2', _0: 0, _1: _user$project$Lang$dummyTrace});
	return A3(
		_user$project$LangSvg$SvgNode,
		'circle',
		A2(
			_elm_lang$core$List$map,
			function (k) {
				return {ctor: '_Tuple2', _0: k, _1: zero};
			},
			{
				ctor: '::',
				_0: 'cx',
				_1: {
					ctor: '::',
					_0: 'cy',
					_1: {
						ctor: '::',
						_0: 'r',
						_1: {ctor: '[]'}
					}
				}
			}),
		{ctor: '[]'});
}();
var _user$project$LangSvg$TextNode = function (a) {
	return {ctor: 'TextNode', _0: a};
};
var _user$project$LangSvg$valToIndexedTree_ = F2(
	function (v, _p170) {
		var _p171 = _p170;
		var _p184 = _p171._0;
		var _p183 = _p171._1;
		var thunk = function (_p172) {
			var _p173 = _p172;
			var _p174 = v.v_;
			if (_p174.ctor === 'VList') {
				var _p175 = A2(
					_elm_lang$core$List$map,
					function (_) {
						return _.v_;
					},
					_p174._0);
				_v88_2:
				do {
					if ((((_p175.ctor === '::') && (_p175._0.ctor === 'VBase')) && (_p175._0._0.ctor === 'VString')) && (_p175._1.ctor === '::')) {
						if (_p175._1._1.ctor === '[]') {
							if (((_p175._0._0._0 === 'TEXT') && (_p175._1._0.ctor === 'VBase')) && (_p175._1._0._0.ctor === 'VString')) {
								return _elm_lang$core$Result$Ok(
									{
										ctor: '_Tuple2',
										_0: 1 + _p184,
										_1: A3(
											_elm_lang$core$Dict$insert,
											_p184,
											_user$project$LangSvg$TextNode(_p175._1._0._0._0),
											_p183)
									});
							} else {
								break _v88_2;
							}
						} else {
							if (((_p175._1._0.ctor === 'VList') && (_p175._1._1._0.ctor === 'VList')) && (_p175._1._1._1.ctor === '[]')) {
								var processChild = F2(
									function (vi, acc) {
										var _p176 = acc;
										if (_p176.ctor === 'Err') {
											return acc;
										} else {
											return A2(
												_elm_lang$core$Result$map,
												function (_p177) {
													var _p178 = _p177;
													var _p179 = _p178._0;
													var a_children_ = {ctor: '::', _0: _p179 - 1, _1: _p176._0._2};
													return {ctor: '_Tuple3', _0: _p179, _1: _p178._1, _2: a_children_};
												},
												A2(
													_user$project$LangSvg$valToIndexedTree_,
													vi,
													{ctor: '_Tuple2', _0: _p176._0._0, _1: _p176._0._1}));
										}
									});
								return A2(
									_elm_lang$core$Result$andThen,
									function (_p180) {
										var _p181 = _p180;
										var _p182 = _p181._0;
										return A2(
											_elm_lang$core$Result$map,
											function (attrs) {
												var node = A3(
													_user$project$LangSvg$SvgNode,
													_p175._0._0._0,
													attrs,
													_elm_lang$core$List$reverse(_p181._2));
												return {
													ctor: '_Tuple2',
													_0: 1 + _p182,
													_1: A3(_elm_lang$core$Dict$insert, _p182, node, _p181._1)
												};
											},
											_user$project$Utils$projOk(
												A2(_elm_lang$core$List$map, _user$project$LangSvg$valToAttr, _p175._1._0._0)));
									},
									A3(
										_elm_lang$core$List$foldl,
										processChild,
										_elm_lang$core$Result$Ok(
											{
												ctor: '_Tuple3',
												_0: _p184,
												_1: _p183,
												_2: {ctor: '[]'}
											}),
										_p175._1._1._0._0));
							} else {
								break _v88_2;
							}
						}
					} else {
						break _v88_2;
					}
				} while(false);
				return A2(
					_user$project$LangSvg$expectedButGot,
					'an SVG node',
					_user$project$Lang$strVal(v));
			} else {
				return A2(
					_user$project$LangSvg$expectedButGot,
					'an SVG node',
					_user$project$Lang$strVal(v));
			}
		};
		return _user$project$Utils$unwrapNestedResult(
			_user$project$ImpureGoodies$crashToError(thunk));
	});
var _user$project$LangSvg$valToIndexedTree = function (v) {
	var thunk = function (_p185) {
		var _p186 = _p185;
		return A2(
			_elm_lang$core$Result$map,
			function (_p187) {
				var _p188 = _p187;
				var rootId = _p188._0 - 1;
				return {ctor: '_Tuple2', _0: rootId, _1: _p188._1};
			},
			A2(
				_user$project$LangSvg$valToIndexedTree_,
				v,
				{ctor: '_Tuple2', _0: 1, _1: _elm_lang$core$Dict$empty}));
	};
	return thunk(
		{ctor: '_Tuple0'});
};
var _user$project$LangSvg$emptyTree = A2(
	_user$project$Utils$fromOk,
	'LangSvg.emptyTree',
	_user$project$LangSvg$valToIndexedTree(
		_user$project$Lang$vList(
			{
				ctor: '::',
				_0: _user$project$Lang$vBase(
					_user$project$Lang$VString('svg')),
				_1: {
					ctor: '::',
					_0: _user$project$Lang$vList(
						{ctor: '[]'}),
					_1: {
						ctor: '::',
						_0: _user$project$Lang$vList(
							{ctor: '[]'}),
						_1: {ctor: '[]'}
					}
				}
			})));
var _user$project$LangSvg$fetchEverything = F4(
	function (slideNumber, movieNumber, movieTime, val) {
		return A2(
			_elm_lang$core$Result$andThen,
			function (_p189) {
				var _p190 = _p189;
				return A2(
					_elm_lang$core$Result$map,
					function (indexedTree) {
						return {ctor: '_Tuple5', _0: _p190._0, _1: _p190._1, _2: _p190._2, _3: _p190._3, _4: indexedTree};
					},
					_user$project$LangSvg$valToIndexedTree(_p190._4));
			},
			A4(_user$project$LangSvg$fetchEverything_, slideNumber, movieNumber, movieTime, val));
	});
var _user$project$LangSvg$resolveToIndexedTree = F4(
	function (slideNumber, movieNumber, movieTime, val) {
		return A2(
			_elm_lang$core$Result$map,
			function (_p191) {
				var _p192 = _p191;
				return _p192._4;
			},
			A4(_user$project$LangSvg$fetchEverything, slideNumber, movieNumber, movieTime, val));
	});

var _user$project$ShapeWidgets$wOpacitySlider = 20;
var _user$project$ShapeWidgets$wStrokeWidthSlider = 60;
var _user$project$ShapeWidgets$wColorSlider = 250;
var _user$project$ShapeWidgets$unparseZone = function (z) {
	var _p0 = z;
	switch (_p0.ctor) {
		case 'ZInterior':
			return 'Interior';
		case 'ZPoint':
			switch (_p0._0.ctor) {
				case 'Point':
					return A2(
						_elm_lang$core$Basics_ops['++'],
						'Point',
						_elm_lang$core$Basics$toString(_p0._0._0));
				case 'TopLeft':
					return 'TopLeft';
				case 'TopRight':
					return 'TopRight';
				case 'BotLeft':
					return 'BotLeft';
				case 'BotRight':
					return 'BotRight';
				case 'TopEdge':
					return 'TopEdge';
				case 'RightEdge':
					return 'RightEdge';
				case 'BotEdge':
					return 'BotEdge';
				case 'LeftEdge':
					return 'LeftEdge';
				case 'Midpoint':
					return _elm_lang$core$Native_Utils.crashCase(
						'ShapeWidgets',
						{
							start: {line: 803, column: 3},
							end: {line: 832, column: 39}
						},
						_p0)(
						A2(
							_elm_lang$core$Basics_ops['++'],
							'unparseZone: ',
							_elm_lang$core$Basics$toString(z)));
				case 'Center':
					return _elm_lang$core$Native_Utils.crashCase(
						'ShapeWidgets',
						{
							start: {line: 803, column: 3},
							end: {line: 832, column: 39}
						},
						_p0)(
						A2(
							_elm_lang$core$Basics_ops['++'],
							'unparseZone: ',
							_elm_lang$core$Basics$toString(z)));
				case 'LonePoint':
					return 'LonePoint';
				default:
					return _elm_lang$core$Native_Utils.crashCase(
						'ShapeWidgets',
						{
							start: {line: 803, column: 3},
							end: {line: 832, column: 39}
						},
						_p0)(
						A2(
							_elm_lang$core$Basics_ops['++'],
							'unparseZone: ',
							_elm_lang$core$Basics$toString(z)));
			}
		case 'ZLineEdge':
			return 'Edge';
		case 'ZPolyEdge':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				'Edge',
				_elm_lang$core$Basics$toString(_p0._0));
		case 'ZOther':
			switch (_p0._0.ctor) {
				case 'FillColor':
					return 'FillBall';
				case 'StrokeColor':
					return 'StrokeBall';
				case 'FillOpacity':
					return 'FillOpacityBall';
				case 'StrokeOpacity':
					return 'StrokeOpacityBall';
				case 'StrokeWidth':
					return 'StrokeWidthBall';
				default:
					return 'RotateBall';
			}
		case 'ZSlider':
			return 'SliderBall';
		default:
			return 'Offset1D';
	}
};
var _user$project$ShapeWidgets$evaluateFeatureEquation = function (eqn) {
	var _p4 = eqn;
	_v1_2:
	do {
		if (_p4.ctor === 'EqnNum') {
			if (_p4._0.ctor === '_Tuple2') {
				return _elm_lang$core$Maybe$Just(_p4._0._0);
			} else {
				break _v1_2;
			}
		} else {
			if (((_p4._1.ctor === '::') && (_p4._1._1.ctor === '::')) && (_p4._1._1._1.ctor === '[]')) {
				var maybePerformBinop = function (op) {
					var maybeLeftResult = _user$project$ShapeWidgets$evaluateFeatureEquation(_p4._1._0);
					var maybeRightResult = _user$project$ShapeWidgets$evaluateFeatureEquation(_p4._1._1._0);
					var _p5 = {ctor: '_Tuple2', _0: maybeLeftResult, _1: maybeRightResult};
					if (((_p5.ctor === '_Tuple2') && (_p5._0.ctor === 'Just')) && (_p5._1.ctor === 'Just')) {
						return _elm_lang$core$Maybe$Just(
							A2(op, _p5._0._0, _p5._1._0));
					} else {
						return _elm_lang$core$Maybe$Nothing;
					}
				};
				var _p6 = _p4._0;
				switch (_p6.ctor) {
					case 'Plus':
						return maybePerformBinop(
							F2(
								function (x, y) {
									return x + y;
								}));
					case 'Minus':
						return maybePerformBinop(
							F2(
								function (x, y) {
									return x - y;
								}));
					case 'Mult':
						return maybePerformBinop(
							F2(
								function (x, y) {
									return x * y;
								}));
					case 'Div':
						return maybePerformBinop(
							F2(
								function (x, y) {
									return x / y;
								}));
					default:
						return _elm_lang$core$Maybe$Nothing;
				}
			} else {
				break _v1_2;
			}
		}
	} while(false);
	return _elm_lang$core$Maybe$Nothing;
};
var _user$project$ShapeWidgets$evaluateFeatureEquation_ = function (_p7) {
	return A2(
		_user$project$Utils$fromJust_,
		'evaluateFeatureEquation_',
		_user$project$ShapeWidgets$evaluateFeatureEquation(_p7));
};
var _user$project$ShapeWidgets$assertString = F2(
	function (string, result) {
		return _elm_lang$core$Native_Utils.eq(result, string) ? string : _elm_lang$core$Native_Utils.crash(
			'ShapeWidgets',
			{
				start: {line: 292, column: 8},
				end: {line: 292, column: 19}
			})(
			_user$project$Utils$spaces(
				{
					ctor: '::',
					_0: 'assertString:',
					_1: {
						ctor: '::',
						_0: result,
						_1: {
							ctor: '::',
							_0: '/= ',
							_1: {
								ctor: '::',
								_0: string,
								_1: {ctor: '[]'}
							}
						}
					}
				}));
	});
var _user$project$ShapeWidgets$shapeKindRegexStr = 'line|rect|circle|ellipse|polygon|path|box|oval|point|offset';
var _user$project$ShapeWidgets$xShapeFeatureRegex = _elm_lang$core$Regex$regex(
	A2(
		_elm_lang$core$Basics_ops['++'],
		'^(',
		A2(_elm_lang$core$Basics_ops['++'], _user$project$ShapeWidgets$shapeKindRegexStr, ')(.*)X(\\d*)$')));
var _user$project$ShapeWidgets$yShapeFeatureRegex = _elm_lang$core$Regex$regex(
	A2(
		_elm_lang$core$Basics_ops['++'],
		'^(',
		A2(_elm_lang$core$Basics_ops['++'], _user$project$ShapeWidgets$shapeKindRegexStr, ')(.*)Y(\\d*)$')));
var _user$project$ShapeWidgets$distanceFeatureRegex = _elm_lang$core$Regex$regex(
	A2(
		_elm_lang$core$Basics_ops['++'],
		'^(',
		A2(_elm_lang$core$Basics_ops['++'], _user$project$ShapeWidgets$shapeKindRegexStr, ')(Width|Height|R|RX|RY)$')));
var _user$project$ShapeWidgets$strOtherFeature = function (otherFeature) {
	var _p8 = otherFeature;
	switch (_p8.ctor) {
		case 'FillColor':
			return 'fill';
		case 'StrokeColor':
			return 'stroke';
		case 'FillOpacity':
			return 'fillOpacity';
		case 'StrokeOpacity':
			return 'strokeOpacity';
		case 'StrokeWidth':
			return 'strokeWidth';
		default:
			return 'rotation';
	}
};
var _user$project$ShapeWidgets$strDistanceFeature = function (distanceFeature) {
	var _p9 = distanceFeature;
	switch (_p9.ctor) {
		case 'Width':
			return 'Width';
		case 'Height':
			return 'Height';
		case 'Radius':
			return 'R';
		case 'RadiusX':
			return 'RX';
		case 'RadiusY':
			return 'RY';
		default:
			return '';
	}
};
var _user$project$ShapeWidgets$strPointFeature = F2(
	function (pointFeature, xy) {
		var _p10 = pointFeature;
		switch (_p10.ctor) {
			case 'TopLeft':
				return A2(_elm_lang$core$Basics_ops['++'], 'TL', xy);
			case 'TopRight':
				return A2(_elm_lang$core$Basics_ops['++'], 'TR', xy);
			case 'BotLeft':
				return A2(_elm_lang$core$Basics_ops['++'], 'BL', xy);
			case 'BotRight':
				return A2(_elm_lang$core$Basics_ops['++'], 'BR', xy);
			case 'TopEdge':
				return A2(_elm_lang$core$Basics_ops['++'], 'TC', xy);
			case 'RightEdge':
				return A2(_elm_lang$core$Basics_ops['++'], 'CR', xy);
			case 'BotEdge':
				return A2(_elm_lang$core$Basics_ops['++'], 'BC', xy);
			case 'LeftEdge':
				return A2(_elm_lang$core$Basics_ops['++'], 'CL', xy);
			case 'Center':
				return A2(_elm_lang$core$Basics_ops['++'], 'C', xy);
			case 'LonePoint':
				return xy;
			case 'Point':
				return A2(
					_elm_lang$core$Basics_ops['++'],
					'Pt',
					A2(
						_elm_lang$core$Basics_ops['++'],
						xy,
						_elm_lang$core$Basics$toString(_p10._0)));
			case 'Midpoint':
				return A2(
					_elm_lang$core$Basics_ops['++'],
					'Midpt',
					A2(
						_elm_lang$core$Basics_ops['++'],
						xy,
						_elm_lang$core$Basics$toString(_p10._0)));
			default:
				return A2(_elm_lang$core$Basics_ops['++'], 'Endpt', xy);
		}
	});
var _user$project$ShapeWidgets$strFeatureNum = F2(
	function (kind, featureNum) {
		var _p11 = {ctor: '_Tuple2', _0: kind, _1: featureNum};
		_v7_5:
		do {
			_v7_4:
			do {
				switch (_p11._1.ctor) {
					case 'XFeat':
						if ((_p11._0 === 'line') && (_p11._1._0.ctor === 'Point')) {
							switch (_p11._1._0._0) {
								case 1:
									return 'X1';
								case 2:
									return 'X2';
								default:
									break _v7_4;
							}
						} else {
							break _v7_4;
						}
					case 'YFeat':
						if ((_p11._0 === 'line') && (_p11._1._0.ctor === 'Point')) {
							switch (_p11._1._0._0) {
								case 1:
									return 'Y1';
								case 2:
									return 'Y2';
								default:
									break _v7_5;
							}
						} else {
							break _v7_5;
						}
					case 'DFeat':
						return _user$project$ShapeWidgets$strDistanceFeature(_p11._1._0);
					default:
						return _user$project$ShapeWidgets$strOtherFeature(_p11._1._0);
				}
			} while(false);
			return A2(_user$project$ShapeWidgets$strPointFeature, _p11._1._0, 'X');
		} while(false);
		return A2(_user$project$ShapeWidgets$strPointFeature, _p11._1._0, 'Y');
	});
var _user$project$ShapeWidgets$unparseFeatureNum = F2(
	function (mKind, featureNum) {
		var _p12 = mKind;
		if (_p12.ctor === 'Just') {
			var _p13 = _p12._0;
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_elm_lang$core$String$toLower(_p13),
				A2(_user$project$ShapeWidgets$strFeatureNum, _p13, featureNum));
		} else {
			return A2(_user$project$ShapeWidgets$strFeatureNum, 'XXX', featureNum);
		}
	});
var _user$project$ShapeWidgets$sanityCheck = F3(
	function (string, kind, featureNum) {
		return A2(
			_user$project$ShapeWidgets$assertString,
			string,
			A2(
				_user$project$ShapeWidgets$unparseFeatureNum,
				_elm_lang$core$Maybe$Just(kind),
				featureNum));
	});
var _user$project$ShapeWidgets$sanityCheckOther = F2(
	function (string, featureNum) {
		return A2(
			_user$project$ShapeWidgets$assertString,
			string,
			A2(_user$project$ShapeWidgets$unparseFeatureNum, _elm_lang$core$Maybe$Nothing, featureNum));
	});
var _user$project$ShapeWidgets$BoxyFeatureEquations = function (a) {
	return function (b) {
		return function (c) {
			return function (d) {
				return function (e) {
					return function (f) {
						return function (g) {
							return function (h) {
								return function (i) {
									return function (j) {
										return function (k) {
											return {left: a, top: b, right: c, bottom: d, cx: e, cy: f, mWidth: g, mHeight: h, mRadius: i, mRadiusX: j, mRadiusY: k};
										};
									};
								};
							};
						};
					};
				};
			};
		};
	};
};
var _user$project$ShapeWidgets$BoxyNums = function (a) {
	return function (b) {
		return function (c) {
			return function (d) {
				return function (e) {
					return function (f) {
						return function (g) {
							return function (h) {
								return function (i) {
									return function (j) {
										return function (k) {
											return {left: a, top: b, right: c, bot: d, width: e, height: f, cx: g, cy: h, rx: i, ry: j, r: k};
										};
									};
								};
							};
						};
					};
				};
			};
		};
	};
};
var _user$project$ShapeWidgets$OtherFeature = function (a) {
	return {ctor: 'OtherFeature', _0: a};
};
var _user$project$ShapeWidgets$DistanceFeature = function (a) {
	return {ctor: 'DistanceFeature', _0: a};
};
var _user$project$ShapeWidgets$PointFeature = function (a) {
	return {ctor: 'PointFeature', _0: a};
};
var _user$project$ShapeWidgets$EndPoint = {ctor: 'EndPoint'};
var _user$project$ShapeWidgets$Midpoint = function (a) {
	return {ctor: 'Midpoint', _0: a};
};
var _user$project$ShapeWidgets$Point = function (a) {
	return {ctor: 'Point', _0: a};
};
var _user$project$ShapeWidgets$polyKindFeatures = F2(
	function (kind, attrs) {
		var cap = 'polyKindFeatures';
		var err = function (s) {
			return _elm_lang$core$Native_Utils.crash(
				'ShapeWidgets',
				{
					start: {line: 62, column: 15},
					end: {line: 62, column: 26}
				})(
				_user$project$Utils$spaces(
					{
						ctor: '::',
						_0: cap,
						_1: {
							ctor: '::',
							_0: kind,
							_1: {
								ctor: '::',
								_0: ': ',
								_1: {
									ctor: '::',
									_0: s,
									_1: {ctor: '[]'}
								}
							}
						}
					}));
		};
		if (_elm_lang$core$Native_Utils.eq(kind, 'polygon')) {
			var _p14 = A3(_user$project$Utils$find, cap, attrs, 'points').av_;
			if (_p14.ctor === 'APoints') {
				return A2(
					_elm_lang$core$List$concatMap,
					function (i) {
						return {
							ctor: '::',
							_0: _user$project$ShapeWidgets$PointFeature(
								_user$project$ShapeWidgets$Point(i)),
							_1: {
								ctor: '::',
								_0: _user$project$ShapeWidgets$PointFeature(
									_user$project$ShapeWidgets$Midpoint(i)),
								_1: {ctor: '[]'}
							}
						};
					},
					A2(
						_elm_lang$core$List$range,
						1,
						_elm_lang$core$List$length(_p14._0)));
			} else {
				return err('polyKindFeatures: points not found');
			}
		} else {
			if (_elm_lang$core$Native_Utils.eq(kind, 'path')) {
				var _p15 = A3(_user$project$Utils$find, cap, attrs, 'd').av_;
				if ((_p15.ctor === 'APath2') && (_p15._0.ctor === '_Tuple2')) {
					return A2(
						_elm_lang$core$List$concatMap,
						function (i) {
							return {
								ctor: '::',
								_0: _user$project$ShapeWidgets$PointFeature(
									_user$project$ShapeWidgets$Point(i)),
								_1: {ctor: '[]'}
							};
						},
						A2(_elm_lang$core$List$range, 1, _p15._0._1.numPoints));
				} else {
					return err('polyKindFeatures: d not found');
				}
			} else {
				return err(
					A2(_elm_lang$core$Basics_ops['++'], 'polyKindFeatures: ', kind));
			}
		}
	});
var _user$project$ShapeWidgets$LonePoint = {ctor: 'LonePoint'};
var _user$project$ShapeWidgets$Center = {ctor: 'Center'};
var _user$project$ShapeWidgets$LeftEdge = {ctor: 'LeftEdge'};
var _user$project$ShapeWidgets$BotEdge = {ctor: 'BotEdge'};
var _user$project$ShapeWidgets$RightEdge = {ctor: 'RightEdge'};
var _user$project$ShapeWidgets$TopEdge = {ctor: 'TopEdge'};
var _user$project$ShapeWidgets$BotRight = {ctor: 'BotRight'};
var _user$project$ShapeWidgets$BotLeft = {ctor: 'BotLeft'};
var _user$project$ShapeWidgets$TopRight = {ctor: 'TopRight'};
var _user$project$ShapeWidgets$TopLeft = {ctor: 'TopLeft'};
var _user$project$ShapeWidgets$eightPointFeatures = A2(
	_elm_lang$core$List$map,
	_user$project$ShapeWidgets$PointFeature,
	{
		ctor: '::',
		_0: _user$project$ShapeWidgets$TopLeft,
		_1: {
			ctor: '::',
			_0: _user$project$ShapeWidgets$TopRight,
			_1: {
				ctor: '::',
				_0: _user$project$ShapeWidgets$BotLeft,
				_1: {
					ctor: '::',
					_0: _user$project$ShapeWidgets$BotRight,
					_1: {
						ctor: '::',
						_0: _user$project$ShapeWidgets$TopEdge,
						_1: {
							ctor: '::',
							_0: _user$project$ShapeWidgets$RightEdge,
							_1: {
								ctor: '::',
								_0: _user$project$ShapeWidgets$BotEdge,
								_1: {
									ctor: '::',
									_0: _user$project$ShapeWidgets$LeftEdge,
									_1: {ctor: '[]'}
								}
							}
						}
					}
				}
			}
		}
	});
var _user$project$ShapeWidgets$ninePointFeatures = A2(
	_elm_lang$core$Basics_ops['++'],
	_user$project$ShapeWidgets$eightPointFeatures,
	{
		ctor: '::',
		_0: _user$project$ShapeWidgets$PointFeature(_user$project$ShapeWidgets$Center),
		_1: {ctor: '[]'}
	});
var _user$project$ShapeWidgets$parseShapeFeaturePoint = function (matches) {
	var _p16 = matches;
	_v11_15:
	do {
		if (((((((_p16.ctor === '::') && (_p16._0.ctor === 'Just')) && (_p16._1.ctor === '::')) && (_p16._1._0.ctor === 'Just')) && (_p16._1._1.ctor === '::')) && (_p16._1._1._0.ctor === 'Just')) && (_p16._1._1._1.ctor === '[]')) {
			switch (_p16._1._0._0) {
				case 'TL':
					if (_p16._1._1._0._0 === '') {
						return _user$project$ShapeWidgets$TopLeft;
					} else {
						break _v11_15;
					}
				case 'TR':
					if (_p16._1._1._0._0 === '') {
						return _user$project$ShapeWidgets$TopRight;
					} else {
						break _v11_15;
					}
				case 'BL':
					if (_p16._1._1._0._0 === '') {
						return _user$project$ShapeWidgets$BotLeft;
					} else {
						break _v11_15;
					}
				case 'BR':
					if (_p16._1._1._0._0 === '') {
						return _user$project$ShapeWidgets$BotRight;
					} else {
						break _v11_15;
					}
				case 'TC':
					if (_p16._1._1._0._0 === '') {
						return _user$project$ShapeWidgets$TopEdge;
					} else {
						break _v11_15;
					}
				case 'CR':
					if (_p16._1._1._0._0 === '') {
						return _user$project$ShapeWidgets$RightEdge;
					} else {
						break _v11_15;
					}
				case 'BC':
					if (_p16._1._1._0._0 === '') {
						return _user$project$ShapeWidgets$BotEdge;
					} else {
						break _v11_15;
					}
				case 'CL':
					if (_p16._1._1._0._0 === '') {
						return _user$project$ShapeWidgets$LeftEdge;
					} else {
						break _v11_15;
					}
				case 'C':
					if (_p16._1._1._0._0 === '') {
						return _user$project$ShapeWidgets$Center;
					} else {
						break _v11_15;
					}
				case '':
					switch (_p16._1._1._0._0) {
						case '':
							return _user$project$ShapeWidgets$LonePoint;
						case '1':
							return _user$project$ShapeWidgets$Point(1);
						case '2':
							return _user$project$ShapeWidgets$Point(2);
						default:
							break _v11_15;
					}
				case 'Pt':
					return _user$project$ShapeWidgets$Point(
						_user$project$Utils$parseInt(_p16._1._1._0._0));
				case 'Midpt':
					return _user$project$ShapeWidgets$Midpoint(
						_user$project$Utils$parseInt(_p16._1._1._0._0));
				case 'Endpt':
					if (_p16._1._1._0._0 === '') {
						return _user$project$ShapeWidgets$EndPoint;
					} else {
						break _v11_15;
					}
				default:
					break _v11_15;
			}
		} else {
			break _v11_15;
		}
	} while(false);
	return _elm_lang$core$Native_Utils.crashCase(
		'ShapeWidgets',
		{
			start: {line: 233, column: 3},
			end: {line: 255, column: 59}
		},
		_p16)(
		A2(
			_elm_lang$core$Basics_ops['++'],
			'parsePoint: ',
			_elm_lang$core$Basics$toString(matches)));
};
var _user$project$ShapeWidgets$Offset = {ctor: 'Offset'};
var _user$project$ShapeWidgets$RadiusY = {ctor: 'RadiusY'};
var _user$project$ShapeWidgets$RadiusX = {ctor: 'RadiusX'};
var _user$project$ShapeWidgets$Radius = {ctor: 'Radius'};
var _user$project$ShapeWidgets$Height = {ctor: 'Height'};
var _user$project$ShapeWidgets$Width = {ctor: 'Width'};
var _user$project$ShapeWidgets$simpleKindFeatures = {
	ctor: '::',
	_0: {
		ctor: '_Tuple2',
		_0: 'rect',
		_1: A2(
			_elm_lang$core$Basics_ops['++'],
			_user$project$ShapeWidgets$ninePointFeatures,
			A2(
				_elm_lang$core$List$map,
				_user$project$ShapeWidgets$DistanceFeature,
				{
					ctor: '::',
					_0: _user$project$ShapeWidgets$Width,
					_1: {
						ctor: '::',
						_0: _user$project$ShapeWidgets$Height,
						_1: {ctor: '[]'}
					}
				}))
	},
	_1: {
		ctor: '::',
		_0: {
			ctor: '_Tuple2',
			_0: 'BOX',
			_1: A2(
				_elm_lang$core$Basics_ops['++'],
				_user$project$ShapeWidgets$ninePointFeatures,
				A2(
					_elm_lang$core$List$map,
					_user$project$ShapeWidgets$DistanceFeature,
					{
						ctor: '::',
						_0: _user$project$ShapeWidgets$Width,
						_1: {
							ctor: '::',
							_0: _user$project$ShapeWidgets$Height,
							_1: {ctor: '[]'}
						}
					}))
		},
		_1: {
			ctor: '::',
			_0: {
				ctor: '_Tuple2',
				_0: 'circle',
				_1: A2(
					_elm_lang$core$Basics_ops['++'],
					_user$project$ShapeWidgets$ninePointFeatures,
					A2(
						_elm_lang$core$List$map,
						_user$project$ShapeWidgets$DistanceFeature,
						{
							ctor: '::',
							_0: _user$project$ShapeWidgets$Radius,
							_1: {ctor: '[]'}
						}))
			},
			_1: {
				ctor: '::',
				_0: {
					ctor: '_Tuple2',
					_0: 'OVAL',
					_1: A2(
						_elm_lang$core$Basics_ops['++'],
						_user$project$ShapeWidgets$ninePointFeatures,
						A2(
							_elm_lang$core$List$map,
							_user$project$ShapeWidgets$DistanceFeature,
							{
								ctor: '::',
								_0: _user$project$ShapeWidgets$RadiusX,
								_1: {
									ctor: '::',
									_0: _user$project$ShapeWidgets$RadiusY,
									_1: {ctor: '[]'}
								}
							}))
				},
				_1: {
					ctor: '::',
					_0: {
						ctor: '_Tuple2',
						_0: 'ellipse',
						_1: A2(
							_elm_lang$core$Basics_ops['++'],
							_user$project$ShapeWidgets$ninePointFeatures,
							A2(
								_elm_lang$core$List$map,
								_user$project$ShapeWidgets$DistanceFeature,
								{
									ctor: '::',
									_0: _user$project$ShapeWidgets$RadiusX,
									_1: {
										ctor: '::',
										_0: _user$project$ShapeWidgets$RadiusY,
										_1: {ctor: '[]'}
									}
								}))
					},
					_1: {
						ctor: '::',
						_0: {
							ctor: '_Tuple2',
							_0: 'line',
							_1: A2(
								_elm_lang$core$List$map,
								_user$project$ShapeWidgets$PointFeature,
								{
									ctor: '::',
									_0: _user$project$ShapeWidgets$Point(1),
									_1: {
										ctor: '::',
										_0: _user$project$ShapeWidgets$Point(2),
										_1: {
											ctor: '::',
											_0: _user$project$ShapeWidgets$Center,
											_1: {ctor: '[]'}
										}
									}
								})
						},
						_1: {ctor: '[]'}
					}
				}
			}
		}
	}
};
var _user$project$ShapeWidgets$featuresOfShape = F2(
	function (kind, attrs) {
		var _p18 = A2(_user$project$Utils$maybeFind, kind, _user$project$ShapeWidgets$simpleKindFeatures);
		if (_p18.ctor === 'Just') {
			return _p18._0;
		} else {
			return A2(_user$project$ShapeWidgets$polyKindFeatures, kind, attrs);
		}
	});
var _user$project$ShapeWidgets$pointFeaturesOfShape = F2(
	function (kind, attrs) {
		return A2(
			_elm_lang$core$List$concatMap,
			function (feature) {
				var _p19 = feature;
				if (_p19.ctor === 'PointFeature') {
					return {
						ctor: '::',
						_0: _p19._0,
						_1: {ctor: '[]'}
					};
				} else {
					return {ctor: '[]'};
				}
			},
			A2(_user$project$ShapeWidgets$featuresOfShape, kind, attrs));
	});
var _user$project$ShapeWidgets$parseDistanceFeature = function (matches) {
	var _p20 = matches;
	_v14_5:
	do {
		if (((((_p20.ctor === '::') && (_p20._0.ctor === 'Just')) && (_p20._1.ctor === '::')) && (_p20._1._0.ctor === 'Just')) && (_p20._1._1.ctor === '[]')) {
			switch (_p20._1._0._0) {
				case 'Width':
					return _user$project$ShapeWidgets$Width;
				case 'Height':
					return _user$project$ShapeWidgets$Height;
				case 'R':
					return _user$project$ShapeWidgets$Radius;
				case 'RX':
					return _user$project$ShapeWidgets$RadiusX;
				case 'RY':
					return _user$project$ShapeWidgets$RadiusY;
				default:
					break _v14_5;
			}
		} else {
			break _v14_5;
		}
	} while(false);
	return _elm_lang$core$Native_Utils.crashCase(
		'ShapeWidgets',
		{
			start: {line: 223, column: 3},
			end: {line: 230, column: 71}
		},
		_p20)(
		A2(
			_elm_lang$core$Basics_ops['++'],
			'parseDistanceFeature: ',
			_elm_lang$core$Basics$toString(matches)));
};
var _user$project$ShapeWidgets$Rotation = {ctor: 'Rotation'};
var _user$project$ShapeWidgets$StrokeWidth = {ctor: 'StrokeWidth'};
var _user$project$ShapeWidgets$StrokeOpacity = {ctor: 'StrokeOpacity'};
var _user$project$ShapeWidgets$StrokeColor = {ctor: 'StrokeColor'};
var _user$project$ShapeWidgets$FillOpacity = {ctor: 'FillOpacity'};
var _user$project$ShapeWidgets$FillColor = {ctor: 'FillColor'};
var _user$project$ShapeWidgets$OFeat = function (a) {
	return {ctor: 'OFeat', _0: a};
};
var _user$project$ShapeWidgets$shapeFill = A2(
	_user$project$ShapeWidgets$sanityCheckOther,
	'fill',
	_user$project$ShapeWidgets$OFeat(_user$project$ShapeWidgets$FillColor));
var _user$project$ShapeWidgets$shapeStroke = A2(
	_user$project$ShapeWidgets$sanityCheckOther,
	'stroke',
	_user$project$ShapeWidgets$OFeat(_user$project$ShapeWidgets$StrokeColor));
var _user$project$ShapeWidgets$shapeFillOpacity = A2(
	_user$project$ShapeWidgets$sanityCheckOther,
	'fillOpacity',
	_user$project$ShapeWidgets$OFeat(_user$project$ShapeWidgets$FillOpacity));
var _user$project$ShapeWidgets$shapeStrokeOpacity = A2(
	_user$project$ShapeWidgets$sanityCheckOther,
	'strokeOpacity',
	_user$project$ShapeWidgets$OFeat(_user$project$ShapeWidgets$StrokeOpacity));
var _user$project$ShapeWidgets$shapeStrokeWidth = A2(
	_user$project$ShapeWidgets$sanityCheckOther,
	'strokeWidth',
	_user$project$ShapeWidgets$OFeat(_user$project$ShapeWidgets$StrokeWidth));
var _user$project$ShapeWidgets$shapeRotation = A2(
	_user$project$ShapeWidgets$sanityCheckOther,
	'rotation',
	_user$project$ShapeWidgets$OFeat(_user$project$ShapeWidgets$Rotation));
var _user$project$ShapeWidgets$DFeat = function (a) {
	return {ctor: 'DFeat', _0: a};
};
var _user$project$ShapeWidgets$YFeat = function (a) {
	return {ctor: 'YFeat', _0: a};
};
var _user$project$ShapeWidgets$XFeat = function (a) {
	return {ctor: 'XFeat', _0: a};
};
var _user$project$ShapeWidgets$featureNumsOfFeature = function (feature) {
	var _p22 = feature;
	switch (_p22.ctor) {
		case 'PointFeature':
			var _p23 = _p22._0;
			return {
				ctor: '::',
				_0: _user$project$ShapeWidgets$XFeat(_p23),
				_1: {
					ctor: '::',
					_0: _user$project$ShapeWidgets$YFeat(_p23),
					_1: {ctor: '[]'}
				}
			};
		case 'DistanceFeature':
			return {
				ctor: '::',
				_0: _user$project$ShapeWidgets$DFeat(_p22._0),
				_1: {ctor: '[]'}
			};
		default:
			return {
				ctor: '::',
				_0: _user$project$ShapeWidgets$OFeat(_p22._0),
				_1: {ctor: '[]'}
			};
	}
};
var _user$project$ShapeWidgets$featureNumsOfShape = F2(
	function (kind, attrs) {
		return A2(
			_elm_lang$core$List$concatMap,
			_user$project$ShapeWidgets$featureNumsOfFeature,
			A2(_user$project$ShapeWidgets$featuresOfShape, kind, attrs));
	});
var _user$project$ShapeWidgets$parseFeatureNum = function (shapeFeature) {
	if (A2(_elm_lang$core$Regex$contains, _user$project$ShapeWidgets$distanceFeatureRegex, shapeFeature)) {
		return _user$project$ShapeWidgets$DFeat(
			_user$project$ShapeWidgets$parseDistanceFeature(
				function (_) {
					return _.submatches;
				}(
					_user$project$Utils$head_(
						A3(
							_elm_lang$core$Regex$find,
							_elm_lang$core$Regex$AtMost(1),
							_user$project$ShapeWidgets$distanceFeatureRegex,
							shapeFeature)))));
	} else {
		if (A2(_elm_lang$core$Regex$contains, _user$project$ShapeWidgets$xShapeFeatureRegex, shapeFeature)) {
			return _user$project$ShapeWidgets$XFeat(
				_user$project$ShapeWidgets$parseShapeFeaturePoint(
					function (_) {
						return _.submatches;
					}(
						_user$project$Utils$head_(
							A3(
								_elm_lang$core$Regex$find,
								_elm_lang$core$Regex$AtMost(1),
								_user$project$ShapeWidgets$xShapeFeatureRegex,
								shapeFeature)))));
		} else {
			if (A2(_elm_lang$core$Regex$contains, _user$project$ShapeWidgets$yShapeFeatureRegex, shapeFeature)) {
				return _user$project$ShapeWidgets$YFeat(
					_user$project$ShapeWidgets$parseShapeFeaturePoint(
						function (_) {
							return _.submatches;
						}(
							_user$project$Utils$head_(
								A3(
									_elm_lang$core$Regex$find,
									_elm_lang$core$Regex$AtMost(1),
									_user$project$ShapeWidgets$yShapeFeatureRegex,
									shapeFeature)))));
			} else {
				var _p24 = shapeFeature;
				switch (_p24) {
					case 'offset':
						return _user$project$ShapeWidgets$DFeat(_user$project$ShapeWidgets$Offset);
					case 'fill':
						return _user$project$ShapeWidgets$OFeat(_user$project$ShapeWidgets$FillColor);
					case 'stroke':
						return _user$project$ShapeWidgets$OFeat(_user$project$ShapeWidgets$StrokeColor);
					case 'fillOpacity':
						return _user$project$ShapeWidgets$OFeat(_user$project$ShapeWidgets$FillOpacity);
					case 'strokeOpacity':
						return _user$project$ShapeWidgets$OFeat(_user$project$ShapeWidgets$StrokeOpacity);
					case 'strokeWidth':
						return _user$project$ShapeWidgets$OFeat(_user$project$ShapeWidgets$StrokeWidth);
					case 'rotation':
						return _user$project$ShapeWidgets$OFeat(_user$project$ShapeWidgets$Rotation);
					default:
						return _elm_lang$core$Native_Utils.crashCase(
							'ShapeWidgets',
							{
								start: {line: 210, column: 5},
								end: {line: 220, column: 62}
							},
							_p24)(
							A2(_elm_lang$core$Basics_ops['++'], 'parseFeatureNum: ', shapeFeature));
				}
			}
		}
	}
};
var _user$project$ShapeWidgets$pointFeatureOf = function (_p26) {
	var _p27 = _p26;
	var _p28 = {
		ctor: '_Tuple2',
		_0: _user$project$ShapeWidgets$parseFeatureNum(_p27._0),
		_1: _user$project$ShapeWidgets$parseFeatureNum(_p27._1)
	};
	if (((_p28.ctor === '_Tuple2') && (_p28._0.ctor === 'XFeat')) && (_p28._1.ctor === 'YFeat')) {
		var _p29 = _p28._0._0;
		return _elm_lang$core$Native_Utils.eq(_p29, _p28._1._0) ? _elm_lang$core$Maybe$Just(_p29) : _elm_lang$core$Maybe$Nothing;
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$ShapeWidgets$selectedPointFeatureOf = F2(
	function (selected1, selected2) {
		selectedPointFeatureOf:
		while (true) {
			var _p30 = selected1;
			var id1 = _p30._0;
			var feature1 = _p30._1;
			var _p31 = selected2;
			var id2 = _p31._0;
			var feature2 = _p31._1;
			if (!_elm_lang$core$Native_Utils.eq(id1, id2)) {
				return _elm_lang$core$Maybe$Nothing;
			} else {
				var _p32 = _user$project$ShapeWidgets$pointFeatureOf(
					{ctor: '_Tuple2', _0: feature1, _1: feature2});
				if (_p32.ctor === 'Just') {
					return _elm_lang$core$Maybe$Just(
						{ctor: '_Tuple2', _0: id1, _1: _p32._0});
				} else {
					var _v20 = selected2,
						_v21 = selected1;
					selected1 = _v20;
					selected2 = _v21;
					continue selectedPointFeatureOf;
				}
			}
		}
	});
var _user$project$ShapeWidgets$zoneToCrosshair = F2(
	function (shape, realZone) {
		var _p33 = realZone;
		if (_p33.ctor === 'ZPoint') {
			var _p34 = _p33._0;
			var xFeature = A2(
				_user$project$ShapeWidgets$unparseFeatureNum,
				_elm_lang$core$Maybe$Just(shape),
				_user$project$ShapeWidgets$XFeat(_p34));
			var yFeature = A2(
				_user$project$ShapeWidgets$unparseFeatureNum,
				_elm_lang$core$Maybe$Just(shape),
				_user$project$ShapeWidgets$YFeat(_p34));
			return _elm_lang$core$Maybe$Just(
				{ctor: '_Tuple2', _0: xFeature, _1: yFeature});
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$ShapeWidgets$EqnOp = F2(
	function (a, b) {
		return {ctor: 'EqnOp', _0: a, _1: b};
	});
var _user$project$ShapeWidgets$plus = F2(
	function (a, b) {
		return A2(
			_user$project$ShapeWidgets$EqnOp,
			_user$project$Lang$Plus,
			{
				ctor: '::',
				_0: a,
				_1: {
					ctor: '::',
					_0: b,
					_1: {ctor: '[]'}
				}
			});
	});
var _user$project$ShapeWidgets$minus = F2(
	function (a, b) {
		return A2(
			_user$project$ShapeWidgets$EqnOp,
			_user$project$Lang$Minus,
			{
				ctor: '::',
				_0: a,
				_1: {
					ctor: '::',
					_0: b,
					_1: {ctor: '[]'}
				}
			});
	});
var _user$project$ShapeWidgets$div = F2(
	function (a, b) {
		return A2(
			_user$project$ShapeWidgets$EqnOp,
			_user$project$Lang$Div,
			{
				ctor: '::',
				_0: a,
				_1: {
					ctor: '::',
					_0: b,
					_1: {ctor: '[]'}
				}
			});
	});
var _user$project$ShapeWidgets$EqnNum = function (a) {
	return {ctor: 'EqnNum', _0: a};
};
var _user$project$ShapeWidgets$two = _user$project$ShapeWidgets$EqnNum(
	{ctor: '_Tuple2', _0: 2, _1: _user$project$Lang$dummyTrace});
var _user$project$ShapeWidgets$widgetFeatureEquation = F3(
	function (featureName, widget, locIdToNumberAndLoc) {
		var _p35 = widget;
		switch (_p35.ctor) {
			case 'WIntSlider':
				var _p36 = A3(_user$project$Utils$justGet_, 'ShapeWidgets.widgetFeatureEquation', _p35._4._0, locIdToNumberAndLoc);
				var n = _p36._0;
				var loc = _p36._1;
				return _user$project$ShapeWidgets$EqnNum(
					{
						ctor: '_Tuple2',
						_0: n,
						_1: _user$project$Lang$TrLoc(loc)
					});
			case 'WNumSlider':
				var _p37 = A3(_user$project$Utils$justGet_, 'ShapeWidgets.widgetFeatureEquation', _p35._4._0, locIdToNumberAndLoc);
				var n = _p37._0;
				var loc = _p37._1;
				return _user$project$ShapeWidgets$EqnNum(
					{
						ctor: '_Tuple2',
						_0: n,
						_1: _user$project$Lang$TrLoc(loc)
					});
			case 'WPoint':
				var featureNum = _user$project$ShapeWidgets$parseFeatureNum(featureName);
				var _p38 = featureNum;
				_v24_2:
				do {
					switch (_p38.ctor) {
						case 'XFeat':
							if (_p38._0.ctor === 'LonePoint') {
								return _user$project$ShapeWidgets$EqnNum(
									{ctor: '_Tuple2', _0: _p35._0._0, _1: _p35._0._1});
							} else {
								break _v24_2;
							}
						case 'YFeat':
							if (_p38._0.ctor === 'LonePoint') {
								return _user$project$ShapeWidgets$EqnNum(
									{ctor: '_Tuple2', _0: _p35._1._0, _1: _p35._1._1});
							} else {
								break _v24_2;
							}
						default:
							break _v24_2;
					}
				} while(false);
				return _elm_lang$core$Native_Utils.crashCase(
					'ShapeWidgets',
					{
						start: {line: 479, column: 7},
						end: {line: 482, column: 132}
					},
					_p38)(
					A2(_elm_lang$core$Basics_ops['++'], 'WPoint only supports XFeat LonePoint and YFeat LonePoint; but asked for ', featureName));
			default:
				var _p48 = _p35._1._1;
				var _p47 = _p35._1._0;
				var _p46 = _p35._0._1;
				var _p45 = _p35._0._0;
				var _p44 = _p35._4._1;
				var _p43 = _p35._4._0;
				var featureNum = _user$project$ShapeWidgets$parseFeatureNum(featureName);
				var op = function () {
					var _p40 = _p35._3;
					if (_p40.ctor === 'Positive') {
						return _user$project$Lang$Plus;
					} else {
						return _user$project$Lang$Minus;
					}
				}();
				var _p41 = {ctor: '_Tuple2', _0: featureNum, _1: _p35._2};
				_v26_5:
				do {
					if (_p41.ctor === '_Tuple2') {
						switch (_p41._0.ctor) {
							case 'DFeat':
								if (_p41._0._0.ctor === 'Offset') {
									return _user$project$ShapeWidgets$EqnNum(
										{ctor: '_Tuple2', _0: _p43, _1: _p44});
								} else {
									break _v26_5;
								}
							case 'XFeat':
								if (_p41._0._0.ctor === 'EndPoint') {
									if (_p41._1.ctor === 'X') {
										return A2(
											_user$project$ShapeWidgets$EqnOp,
											op,
											{
												ctor: '::',
												_0: _user$project$ShapeWidgets$EqnNum(
													{ctor: '_Tuple2', _0: _p45, _1: _p46}),
												_1: {
													ctor: '::',
													_0: _user$project$ShapeWidgets$EqnNum(
														{ctor: '_Tuple2', _0: _p43, _1: _p44}),
													_1: {ctor: '[]'}
												}
											});
									} else {
										return _user$project$ShapeWidgets$EqnNum(
											{ctor: '_Tuple2', _0: _p45, _1: _p46});
									}
								} else {
									break _v26_5;
								}
							case 'YFeat':
								if (_p41._0._0.ctor === 'EndPoint') {
									if (_p41._1.ctor === 'X') {
										return _user$project$ShapeWidgets$EqnNum(
											{ctor: '_Tuple2', _0: _p47, _1: _p48});
									} else {
										return A2(
											_user$project$ShapeWidgets$EqnOp,
											op,
											{
												ctor: '::',
												_0: _user$project$ShapeWidgets$EqnNum(
													{ctor: '_Tuple2', _0: _p47, _1: _p48}),
												_1: {
													ctor: '::',
													_0: _user$project$ShapeWidgets$EqnNum(
														{ctor: '_Tuple2', _0: _p43, _1: _p44}),
													_1: {ctor: '[]'}
												}
											});
									}
								} else {
									break _v26_5;
								}
							default:
								break _v26_5;
						}
					} else {
						break _v26_5;
					}
				} while(false);
				return _elm_lang$core$Native_Utils.crashCase(
					'ShapeWidgets',
					{
						start: {line: 490, column: 7},
						end: {line: 496, column: 152}
					},
					_p41)(
					A2(_elm_lang$core$Basics_ops['++'], 'WOffset1D only supports DFeat Offset, XFeat EndPoint, and YFeat EndPoint; but asked for ', featureName));
		}
	});
var _user$project$ShapeWidgets$boxyFeatureEquationsOf = F2(
	function (kind, attrs) {
		var get = function (attr) {
			return _user$project$ShapeWidgets$EqnNum(
				A2(_user$project$LangSvg$findNumishAttr, attr, attrs));
		};
		var _p49 = kind;
		switch (_p49) {
			case 'rect':
				return {
					left: get('x'),
					top: get('y'),
					right: A2(
						_user$project$ShapeWidgets$plus,
						get('x'),
						get('width')),
					bottom: A2(
						_user$project$ShapeWidgets$plus,
						get('y'),
						get('height')),
					cx: A2(
						_user$project$ShapeWidgets$plus,
						get('x'),
						A2(
							_user$project$ShapeWidgets$div,
							get('width'),
							_user$project$ShapeWidgets$two)),
					cy: A2(
						_user$project$ShapeWidgets$plus,
						get('y'),
						A2(
							_user$project$ShapeWidgets$div,
							get('height'),
							_user$project$ShapeWidgets$two)),
					mWidth: _elm_lang$core$Maybe$Just(
						get('width')),
					mHeight: _elm_lang$core$Maybe$Just(
						get('height')),
					mRadius: _elm_lang$core$Maybe$Nothing,
					mRadiusX: _elm_lang$core$Maybe$Nothing,
					mRadiusY: _elm_lang$core$Maybe$Nothing
				};
			case 'BOX':
				return {
					left: get('LEFT'),
					top: get('TOP'),
					right: get('RIGHT'),
					bottom: get('BOT'),
					cx: A2(
						_user$project$ShapeWidgets$div,
						A2(
							_user$project$ShapeWidgets$plus,
							get('LEFT'),
							get('RIGHT')),
						_user$project$ShapeWidgets$two),
					cy: A2(
						_user$project$ShapeWidgets$div,
						A2(
							_user$project$ShapeWidgets$plus,
							get('TOP'),
							get('BOT')),
						_user$project$ShapeWidgets$two),
					mWidth: _elm_lang$core$Maybe$Just(
						A2(
							_user$project$ShapeWidgets$minus,
							get('RIGHT'),
							get('LEFT'))),
					mHeight: _elm_lang$core$Maybe$Just(
						A2(
							_user$project$ShapeWidgets$minus,
							get('BOT'),
							get('TOP'))),
					mRadius: _elm_lang$core$Maybe$Nothing,
					mRadiusX: _elm_lang$core$Maybe$Nothing,
					mRadiusY: _elm_lang$core$Maybe$Nothing
				};
			case 'OVAL':
				return {
					left: get('LEFT'),
					top: get('TOP'),
					right: get('RIGHT'),
					bottom: get('BOT'),
					cx: A2(
						_user$project$ShapeWidgets$div,
						A2(
							_user$project$ShapeWidgets$plus,
							get('LEFT'),
							get('RIGHT')),
						_user$project$ShapeWidgets$two),
					cy: A2(
						_user$project$ShapeWidgets$div,
						A2(
							_user$project$ShapeWidgets$plus,
							get('TOP'),
							get('BOT')),
						_user$project$ShapeWidgets$two),
					mWidth: _elm_lang$core$Maybe$Nothing,
					mHeight: _elm_lang$core$Maybe$Nothing,
					mRadius: _elm_lang$core$Maybe$Nothing,
					mRadiusX: _elm_lang$core$Maybe$Just(
						A2(
							_user$project$ShapeWidgets$div,
							A2(
								_user$project$ShapeWidgets$minus,
								get('RIGHT'),
								get('LEFT')),
							_user$project$ShapeWidgets$two)),
					mRadiusY: _elm_lang$core$Maybe$Just(
						A2(
							_user$project$ShapeWidgets$div,
							A2(
								_user$project$ShapeWidgets$minus,
								get('BOT'),
								get('TOP')),
							_user$project$ShapeWidgets$two))
				};
			case 'circle':
				return {
					left: A2(
						_user$project$ShapeWidgets$minus,
						get('cx'),
						get('r')),
					top: A2(
						_user$project$ShapeWidgets$minus,
						get('cy'),
						get('r')),
					right: A2(
						_user$project$ShapeWidgets$plus,
						get('cx'),
						get('r')),
					bottom: A2(
						_user$project$ShapeWidgets$plus,
						get('cy'),
						get('r')),
					cx: get('cx'),
					cy: get('cy'),
					mWidth: _elm_lang$core$Maybe$Nothing,
					mHeight: _elm_lang$core$Maybe$Nothing,
					mRadius: _elm_lang$core$Maybe$Just(
						get('r')),
					mRadiusX: _elm_lang$core$Maybe$Nothing,
					mRadiusY: _elm_lang$core$Maybe$Nothing
				};
			case 'ellipse':
				return {
					left: A2(
						_user$project$ShapeWidgets$minus,
						get('cx'),
						get('rx')),
					top: A2(
						_user$project$ShapeWidgets$minus,
						get('cy'),
						get('ry')),
					right: A2(
						_user$project$ShapeWidgets$plus,
						get('cx'),
						get('rx')),
					bottom: A2(
						_user$project$ShapeWidgets$plus,
						get('cy'),
						get('ry')),
					cx: get('cx'),
					cy: get('cy'),
					mWidth: _elm_lang$core$Maybe$Nothing,
					mHeight: _elm_lang$core$Maybe$Nothing,
					mRadius: _elm_lang$core$Maybe$Nothing,
					mRadiusX: _elm_lang$core$Maybe$Just(
						get('rx')),
					mRadiusY: _elm_lang$core$Maybe$Just(
						get('ry'))
				};
			default:
				return _elm_lang$core$Native_Utils.crashCase(
					'ShapeWidgets',
					{
						start: {line: 616, column: 3},
						end: {line: 688, column: 59}
					},
					_p49)(
					A2(_elm_lang$core$Basics_ops['++'], 'boxyFeatureEquationsOf: ', kind));
		}
	});
var _user$project$ShapeWidgets$featureEquationOf = F3(
	function (kind, attrs, featureNum) {
		var get = function (attr) {
			return _user$project$ShapeWidgets$EqnNum(
				A2(_user$project$LangSvg$findNumishAttr, attr, attrs));
		};
		var crash = function (_p51) {
			var _p52 = _p51;
			var s = A2(
				_user$project$ShapeWidgets$unparseFeatureNum,
				_elm_lang$core$Maybe$Just(kind),
				featureNum);
			return _elm_lang$core$Native_Utils.crash(
				'ShapeWidgets',
				{
					start: {line: 507, column: 5},
					end: {line: 507, column: 16}
				})(
				_user$project$Utils$spaces(
					{
						ctor: '::',
						_0: 'featureEquationOf:',
						_1: {
							ctor: '::',
							_0: kind,
							_1: {
								ctor: '::',
								_0: s,
								_1: {ctor: '[]'}
							}
						}
					}));
		};
		var handleLine = function (_p53) {
			var _p54 = _p53;
			var _p55 = featureNum;
			_v30_6:
			do {
				switch (_p55.ctor) {
					case 'XFeat':
						switch (_p55._0.ctor) {
							case 'Point':
								switch (_p55._0._0) {
									case 1:
										return get('x1');
									case 2:
										return get('x2');
									default:
										break _v30_6;
								}
							case 'Center':
								return A2(
									_user$project$ShapeWidgets$div,
									A2(
										_user$project$ShapeWidgets$plus,
										get('x1'),
										get('x2')),
									_user$project$ShapeWidgets$two);
							default:
								break _v30_6;
						}
					case 'YFeat':
						switch (_p55._0.ctor) {
							case 'Point':
								switch (_p55._0._0) {
									case 1:
										return get('y1');
									case 2:
										return get('y2');
									default:
										break _v30_6;
								}
							case 'Center':
								return A2(
									_user$project$ShapeWidgets$div,
									A2(
										_user$project$ShapeWidgets$plus,
										get('y1'),
										get('y2')),
									_user$project$ShapeWidgets$two);
							default:
								break _v30_6;
						}
					default:
						break _v30_6;
				}
			} while(false);
			return crash(
				{ctor: '_Tuple0'});
		};
		var handleBoxyShape = function (_p56) {
			var _p57 = _p56;
			var equations = A2(_user$project$ShapeWidgets$boxyFeatureEquationsOf, kind, attrs);
			var _p58 = featureNum;
			_v32_19:
			do {
				switch (_p58.ctor) {
					case 'XFeat':
						switch (_p58._0.ctor) {
							case 'TopLeft':
								return equations.left;
							case 'TopRight':
								return equations.right;
							case 'BotLeft':
								return equations.left;
							case 'BotRight':
								return equations.right;
							case 'TopEdge':
								return equations.cx;
							case 'BotEdge':
								return equations.cx;
							case 'LeftEdge':
								return equations.left;
							case 'RightEdge':
								return equations.right;
							case 'Center':
								return equations.cx;
							default:
								break _v32_19;
						}
					case 'YFeat':
						switch (_p58._0.ctor) {
							case 'TopLeft':
								return equations.top;
							case 'TopRight':
								return equations.top;
							case 'BotLeft':
								return equations.bottom;
							case 'BotRight':
								return equations.bottom;
							case 'TopEdge':
								return equations.top;
							case 'BotEdge':
								return equations.bottom;
							case 'LeftEdge':
								return equations.cy;
							case 'RightEdge':
								return equations.cy;
							case 'Center':
								return equations.cy;
							default:
								break _v32_19;
						}
					case 'DFeat':
						var _p60 = _p58._0;
						var s = _user$project$ShapeWidgets$strDistanceFeature(_p60);
						var cap = _user$project$Utils$spaces(
							{
								ctor: '::',
								_0: 'shapeFeatureEquationOf:',
								_1: {
									ctor: '::',
									_0: kind,
									_1: {
										ctor: '::',
										_0: s,
										_1: {ctor: '[]'}
									}
								}
							});
						var _p59 = _p60;
						switch (_p59.ctor) {
							case 'Width':
								return A2(_user$project$Utils$fromJust_, cap, equations.mWidth);
							case 'Height':
								return A2(_user$project$Utils$fromJust_, cap, equations.mHeight);
							case 'Radius':
								return A2(_user$project$Utils$fromJust_, cap, equations.mRadius);
							case 'RadiusX':
								return A2(_user$project$Utils$fromJust_, cap, equations.mRadiusX);
							case 'RadiusY':
								return A2(_user$project$Utils$fromJust_, cap, equations.mRadiusY);
							default:
								return crash(
									{ctor: '_Tuple0'});
						}
					default:
						break _v32_19;
				}
			} while(false);
			return crash(
				{ctor: '_Tuple0'});
		};
		var handlePath = function (_p61) {
			var _p62 = _p61;
			var x = function (i) {
				return _user$project$ShapeWidgets$EqnNum(
					_elm_lang$core$Tuple$first(
						A2(_user$project$LangSvg$getPathPoint, attrs, i)));
			};
			var y = function (i) {
				return _user$project$ShapeWidgets$EqnNum(
					_elm_lang$core$Tuple$second(
						A2(_user$project$LangSvg$getPathPoint, attrs, i)));
			};
			var _p63 = featureNum;
			_v35_2:
			do {
				switch (_p63.ctor) {
					case 'XFeat':
						if (_p63._0.ctor === 'Point') {
							return x(_p63._0._0);
						} else {
							break _v35_2;
						}
					case 'YFeat':
						if (_p63._0.ctor === 'Point') {
							return y(_p63._0._0);
						} else {
							break _v35_2;
						}
					default:
						break _v35_2;
				}
			} while(false);
			return crash(
				{ctor: '_Tuple0'});
		};
		var handlePoly = function (_p64) {
			var _p65 = _p64;
			var ptCount = _user$project$LangSvg$getPtCount(attrs);
			var x = function (i) {
				return _user$project$ShapeWidgets$EqnNum(
					_elm_lang$core$Tuple$first(
						A2(_user$project$LangSvg$getPolyPoint, attrs, i)));
			};
			var y = function (i) {
				return _user$project$ShapeWidgets$EqnNum(
					_elm_lang$core$Tuple$second(
						A2(_user$project$LangSvg$getPolyPoint, attrs, i)));
			};
			var _p66 = featureNum;
			_v37_4:
			do {
				switch (_p66.ctor) {
					case 'XFeat':
						switch (_p66._0.ctor) {
							case 'Point':
								return x(_p66._0._0);
							case 'Midpoint':
								var _p67 = _p66._0._0;
								var i2 = _elm_lang$core$Native_Utils.eq(_p67, ptCount) ? 1 : (_p67 + 1);
								return A2(
									_user$project$ShapeWidgets$div,
									A2(
										_user$project$ShapeWidgets$plus,
										x(_p67),
										x(i2)),
									_user$project$ShapeWidgets$two);
							default:
								break _v37_4;
						}
					case 'YFeat':
						switch (_p66._0.ctor) {
							case 'Point':
								return y(_p66._0._0);
							case 'Midpoint':
								var _p68 = _p66._0._0;
								var i2 = _elm_lang$core$Native_Utils.eq(_p68, ptCount) ? 1 : (_p68 + 1);
								return A2(
									_user$project$ShapeWidgets$div,
									A2(
										_user$project$ShapeWidgets$plus,
										y(_p68),
										y(i2)),
									_user$project$ShapeWidgets$two);
							default:
								break _v37_4;
						}
					default:
						break _v37_4;
				}
			} while(false);
			return crash(
				{ctor: '_Tuple0'});
		};
		var _p69 = featureNum;
		if (_p69.ctor === 'OFeat') {
			switch (_p69._0.ctor) {
				case 'FillColor':
					return get('fill');
				case 'StrokeColor':
					return get('stroke');
				case 'StrokeWidth':
					return get('stroke-width');
				case 'FillOpacity':
					var _p70 = A2(_user$project$Utils$find_, attrs, 'fill').av_;
					if (((_p70.ctor === 'AColorNum') && (_p70._0.ctor === '_Tuple2')) && (_p70._0._1.ctor === 'Just')) {
						return _user$project$ShapeWidgets$EqnNum(_p70._0._1._0);
					} else {
						return _elm_lang$core$Native_Utils.crashCase(
							'ShapeWidgets',
							{
								start: {line: 588, column: 7},
								end: {line: 590, column: 92}
							},
							_p70)('featureEquationOf: fillOpacity');
					}
				case 'StrokeOpacity':
					var _p72 = A2(_user$project$Utils$find_, attrs, 'stroke').av_;
					if (((_p72.ctor === 'AColorNum') && (_p72._0.ctor === '_Tuple2')) && (_p72._0._1.ctor === 'Just')) {
						return _user$project$ShapeWidgets$EqnNum(_p72._0._1._0);
					} else {
						return _elm_lang$core$Native_Utils.crashCase(
							'ShapeWidgets',
							{
								start: {line: 592, column: 7},
								end: {line: 594, column: 94}
							},
							_p72)('featureEquationOf: strokeOpacity');
					}
				default:
					var _p74 = _user$project$LangSvg$toTransformRot(
						A2(_user$project$Utils$find_, attrs, 'transform'));
					var rot = _p74._0;
					var cx = _p74._1;
					var cy = _p74._2;
					return _user$project$ShapeWidgets$EqnNum(rot);
			}
		} else {
			var _p75 = kind;
			switch (_p75) {
				case 'line':
					return handleLine(
						{ctor: '_Tuple0'});
				case 'polygon':
					return handlePoly(
						{ctor: '_Tuple0'});
				case 'polyline':
					return handlePoly(
						{ctor: '_Tuple0'});
				case 'path':
					return handlePath(
						{ctor: '_Tuple0'});
				case 'rect':
					return handleBoxyShape(
						{ctor: '_Tuple0'});
				case 'BOX':
					return handleBoxyShape(
						{ctor: '_Tuple0'});
				case 'circle':
					return handleBoxyShape(
						{ctor: '_Tuple0'});
				case 'ellipse':
					return handleBoxyShape(
						{ctor: '_Tuple0'});
				case 'OVAL':
					return handleBoxyShape(
						{ctor: '_Tuple0'});
				default:
					return crash(
						{ctor: '_Tuple0'});
			}
		}
	});
var _user$project$ShapeWidgets$featureEquation = F3(
	function (kind, featureName, nodeAttrs) {
		var featureNum = _user$project$ShapeWidgets$parseFeatureNum(featureName);
		return A3(_user$project$ShapeWidgets$featureEquationOf, kind, nodeAttrs, featureNum);
	});
var _user$project$ShapeWidgets$evaluateLineFeatures = function (attrs) {
	return _user$project$Utils$unwrap6(
		A2(
			_elm_lang$core$List$map,
			function (_p76) {
				return _user$project$ShapeWidgets$evaluateFeatureEquation_(
					A3(_user$project$ShapeWidgets$featureEquationOf, 'line', attrs, _p76));
			},
			{
				ctor: '::',
				_0: _user$project$ShapeWidgets$XFeat(
					_user$project$ShapeWidgets$Point(1)),
				_1: {
					ctor: '::',
					_0: _user$project$ShapeWidgets$YFeat(
						_user$project$ShapeWidgets$Point(1)),
					_1: {
						ctor: '::',
						_0: _user$project$ShapeWidgets$XFeat(
							_user$project$ShapeWidgets$Point(2)),
						_1: {
							ctor: '::',
							_0: _user$project$ShapeWidgets$YFeat(
								_user$project$ShapeWidgets$Point(2)),
							_1: {
								ctor: '::',
								_0: _user$project$ShapeWidgets$XFeat(_user$project$ShapeWidgets$Center),
								_1: {
									ctor: '::',
									_0: _user$project$ShapeWidgets$YFeat(_user$project$ShapeWidgets$Center),
									_1: {ctor: '[]'}
								}
							}
						}
					}
				}
			}));
};
var _user$project$ShapeWidgets$getPointEquations = F3(
	function (kind, attrs, pointFeature) {
		return {
			ctor: '_Tuple2',
			_0: A3(
				_user$project$ShapeWidgets$featureEquationOf,
				kind,
				attrs,
				_user$project$ShapeWidgets$XFeat(pointFeature)),
			_1: A3(
				_user$project$ShapeWidgets$featureEquationOf,
				kind,
				attrs,
				_user$project$ShapeWidgets$YFeat(pointFeature))
		};
	});
var _user$project$ShapeWidgets$getPrimitivePointEquations = F2(
	function (_p77, nodeId) {
		var _p78 = _p77;
		var _p79 = A3(_user$project$Utils$justGet_, 'LangSvg.getPrimitivePoints', nodeId, _p78._1);
		if (_p79.ctor === 'SvgNode') {
			var _p82 = _p79._0;
			var _p81 = _p79._1;
			return A2(
				_elm_lang$core$List$concatMap,
				function (pointFeature) {
					var _p80 = A3(_user$project$ShapeWidgets$getPointEquations, _p82, _p81, pointFeature);
					if (((_p80.ctor === '_Tuple2') && (_p80._0.ctor === 'EqnNum')) && (_p80._1.ctor === 'EqnNum')) {
						return {
							ctor: '::',
							_0: {ctor: '_Tuple2', _0: _p80._0._0, _1: _p80._1._0},
							_1: {ctor: '[]'}
						};
					} else {
						return {ctor: '[]'};
					}
				},
				A2(_user$project$ShapeWidgets$pointFeaturesOfShape, _p82, _p81));
		} else {
			return _elm_lang$core$Native_Utils.crashCase(
				'ShapeWidgets',
				{
					start: {line: 772, column: 3},
					end: {line: 780, column: 47}
				},
				_p79)('LangSvg.getPrimitivePoints');
		}
	});
var _user$project$ShapeWidgets$evaluateBoxyNums = F2(
	function (kind, attrs) {
		var equations = A2(_user$project$ShapeWidgets$boxyFeatureEquationsOf, kind, attrs);
		var _p84 = {
			ctor: '_Tuple6',
			_0: _user$project$ShapeWidgets$evaluateFeatureEquation_(equations.left),
			_1: _user$project$ShapeWidgets$evaluateFeatureEquation_(equations.top),
			_2: _user$project$ShapeWidgets$evaluateFeatureEquation_(equations.right),
			_3: _user$project$ShapeWidgets$evaluateFeatureEquation_(equations.bottom),
			_4: _user$project$ShapeWidgets$evaluateFeatureEquation_(equations.cx),
			_5: _user$project$ShapeWidgets$evaluateFeatureEquation_(equations.cy)
		};
		var left = _p84._0;
		var top = _p84._1;
		var right = _p84._2;
		var bot = _p84._3;
		var cx = _p84._4;
		var cy = _p84._5;
		var height = bot - top;
		var ry = height / 2;
		var width = right - left;
		var rx = width / 2;
		return {left: left, top: top, right: right, bot: bot, width: width, height: height, cx: cx, cy: cy, rx: rx, ry: ry, r: rx};
	});
var _user$project$ShapeWidgets$ZOffset1D = {ctor: 'ZOffset1D'};
var _user$project$ShapeWidgets$ZSlider = {ctor: 'ZSlider'};
var _user$project$ShapeWidgets$ZOther = function (a) {
	return {ctor: 'ZOther', _0: a};
};
var _user$project$ShapeWidgets$toSliderZone = function (s) {
	var _p85 = s;
	switch (_p85) {
		case 'FillBall':
			return _elm_lang$core$Maybe$Just(
				_user$project$ShapeWidgets$ZOther(_user$project$ShapeWidgets$FillColor));
		case 'StrokeBall':
			return _elm_lang$core$Maybe$Just(
				_user$project$ShapeWidgets$ZOther(_user$project$ShapeWidgets$StrokeColor));
		case 'FillOpacityBall':
			return _elm_lang$core$Maybe$Just(
				_user$project$ShapeWidgets$ZOther(_user$project$ShapeWidgets$FillOpacity));
		case 'StrokeOpacityBall':
			return _elm_lang$core$Maybe$Just(
				_user$project$ShapeWidgets$ZOther(_user$project$ShapeWidgets$StrokeOpacity));
		case 'StrokeWidthBall':
			return _elm_lang$core$Maybe$Just(
				_user$project$ShapeWidgets$ZOther(_user$project$ShapeWidgets$StrokeWidth));
		case 'RotateBall':
			return _elm_lang$core$Maybe$Just(
				_user$project$ShapeWidgets$ZOther(_user$project$ShapeWidgets$Rotation));
		case 'SliderBall':
			return _elm_lang$core$Maybe$Just(_user$project$ShapeWidgets$ZSlider);
		default:
			return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$ShapeWidgets$ZPolyEdge = function (a) {
	return {ctor: 'ZPolyEdge', _0: a};
};
var _user$project$ShapeWidgets$ZLineEdge = {ctor: 'ZLineEdge'};
var _user$project$ShapeWidgets$toEdgeZone = function (s) {
	return A2(
		_user$project$Utils$bindMaybe,
		function (suffix) {
			return _elm_lang$core$Native_Utils.eq(suffix, '') ? _elm_lang$core$Maybe$Just(_user$project$ShapeWidgets$ZLineEdge) : _elm_lang$core$Maybe$Just(
				_user$project$ShapeWidgets$ZPolyEdge(
					_user$project$Utils$fromOk_(
						_elm_lang$core$String$toInt(suffix))));
		},
		A2(_user$project$Utils$munchString, 'Edge', s));
};
var _user$project$ShapeWidgets$ZPoint = function (a) {
	return {ctor: 'ZPoint', _0: a};
};
var _user$project$ShapeWidgets$toOtherWidgetZone = function (s) {
	var _p86 = s;
	switch (_p86) {
		case 'LonePoint':
			return _elm_lang$core$Maybe$Just(
				_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$LonePoint));
		case 'Offset1D':
			return _elm_lang$core$Maybe$Just(_user$project$ShapeWidgets$ZOffset1D);
		default:
			return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$ShapeWidgets$toCardinalPointZone = function (s) {
	var _p87 = s;
	switch (_p87) {
		case 'TopLeft':
			return _elm_lang$core$Maybe$Just(
				_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$TopLeft));
		case 'TopRight':
			return _elm_lang$core$Maybe$Just(
				_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$TopRight));
		case 'BotLeft':
			return _elm_lang$core$Maybe$Just(
				_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$BotLeft));
		case 'BotRight':
			return _elm_lang$core$Maybe$Just(
				_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$BotRight));
		case 'TopEdge':
			return _elm_lang$core$Maybe$Just(
				_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$TopEdge));
		case 'BotEdge':
			return _elm_lang$core$Maybe$Just(
				_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$BotEdge));
		case 'LeftEdge':
			return _elm_lang$core$Maybe$Just(
				_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$LeftEdge));
		case 'RightEdge':
			return _elm_lang$core$Maybe$Just(
				_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$RightEdge));
		default:
			return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$ShapeWidgets$toPointZone = function (s) {
	return A2(
		_user$project$Utils$bindMaybe,
		function (suffix) {
			return _elm_lang$core$Native_Utils.eq(suffix, '') ? _elm_lang$core$Maybe$Nothing : _elm_lang$core$Maybe$Just(
				_user$project$ShapeWidgets$ZPoint(
					_user$project$ShapeWidgets$Point(
						_user$project$Utils$fromOk_(
							_elm_lang$core$String$toInt(suffix)))));
		},
		A2(_user$project$Utils$munchString, 'Point', s));
};
var _user$project$ShapeWidgets$ZInterior = {ctor: 'ZInterior'};
var _user$project$ShapeWidgets$toInteriorZone = function (s) {
	var _p88 = s;
	if (_p88 === 'Interior') {
		return _elm_lang$core$Maybe$Just(_user$project$ShapeWidgets$ZInterior);
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$ShapeWidgets$realZoneOf = function (s) {
	return _user$project$Utils$firstMaybe(
		{
			ctor: '::',
			_0: _user$project$ShapeWidgets$toInteriorZone(s),
			_1: {
				ctor: '::',
				_0: _user$project$ShapeWidgets$toOtherWidgetZone(s),
				_1: {
					ctor: '::',
					_0: _user$project$ShapeWidgets$toCardinalPointZone(s),
					_1: {
						ctor: '::',
						_0: _user$project$ShapeWidgets$toSliderZone(s),
						_1: {
							ctor: '::',
							_0: _user$project$ShapeWidgets$toPointZone(s),
							_1: {
								ctor: '::',
								_0: _user$project$ShapeWidgets$toEdgeZone(s),
								_1: {ctor: '[]'}
							}
						}
					}
				}
			}
		});
};
var _user$project$ShapeWidgets$parseZone = function (s) {
	var _p89 = _user$project$ShapeWidgets$realZoneOf(s);
	if (_p89.ctor === 'Just') {
		return _p89._0;
	} else {
		return _elm_lang$core$Native_Utils.crashCase(
			'ShapeWidgets',
			{
				start: {line: 837, column: 3},
				end: {line: 839, column: 49}
			},
			_p89)(
			A2(_elm_lang$core$Basics_ops['++'], 'parseZone: ', s));
	}
};

var _user$project$LocEqn$locEqnToExp = F4(
	function (constantAnnotation, locIdToFrozenNum, locIdToIdent, eqn) {
		var _p0 = eqn;
		switch (_p0.ctor) {
			case 'LocEqnConst':
				return A2(
					_user$project$Lang$eConst,
					_p0._0,
					_user$project$Lang$dummyLoc_(constantAnnotation));
			case 'LocEqnLoc':
				var _p3 = _p0._0;
				var _p1 = A2(_elm_lang$core$Dict$get, _p3, locIdToIdent);
				if (_p1.ctor === 'Just') {
					return _user$project$Lang$eVar(_p1._0);
				} else {
					var _p2 = A2(_elm_lang$core$Dict$get, _p3, locIdToFrozenNum);
					if (_p2.ctor === 'Just') {
						return A2(
							_user$project$Lang$eConst,
							_p2._0,
							_user$project$Lang$dummyLoc_(_user$project$Lang$frozen));
					} else {
						return _user$project$Lang$eVar(
							A2(
								_elm_lang$core$Basics_ops['++'],
								'couldNotFindLocId',
								_elm_lang$core$Basics$toString(_p3)));
					}
				}
			default:
				var childExps = A2(
					_elm_lang$core$List$map,
					A3(_user$project$LocEqn$locEqnToExp, constantAnnotation, locIdToFrozenNum, locIdToIdent),
					_p0._1);
				return A2(_user$project$Lang$eOp, _p0._0, childExps);
		}
	});
var _user$project$LocEqn$locEqnEval_ = function (eqn) {
	var _p4 = eqn;
	switch (_p4.ctor) {
		case 'LocEqnConst':
			return _p4._0;
		case 'LocEqnLoc':
			return _elm_lang$core$Native_Utils.crashCase(
				'LocEqn',
				{
					start: {line: 1203, column: 3},
					end: {line: 1214, column: 101}
				},
				_p4)('shouldn\'t have locs in constantified eqn');
		default:
			if (((_p4._1.ctor === '::') && (_p4._1._1.ctor === '::')) && (_p4._1._1._1.ctor === '[]')) {
				var _p9 = _p4._0;
				var _p6 = {
					ctor: '_Tuple2',
					_0: _user$project$LocEqn$locEqnEval_(_p4._1._0),
					_1: _user$project$LocEqn$locEqnEval_(_p4._1._1._0)
				};
				var leftEvaled = _p6._0;
				var rightEvaled = _p6._1;
				var _p7 = _p9;
				switch (_p7.ctor) {
					case 'Plus':
						return leftEvaled + rightEvaled;
					case 'Minus':
						return leftEvaled - rightEvaled;
					case 'Mult':
						return leftEvaled * rightEvaled;
					case 'Div':
						return leftEvaled / rightEvaled;
					default:
						return _elm_lang$core$Native_Utils.crashCase(
							'LocEqn',
							{
								start: {line: 1208, column: 7},
								end: {line: 1213, column: 77}
							},
							_p7)(
							A2(
								_elm_lang$core$Basics_ops['++'],
								'Unknown loc equation op: ',
								_elm_lang$core$Basics$toString(_p9)));
				}
			} else {
				return _elm_lang$core$Native_Utils.crashCase(
					'LocEqn',
					{
						start: {line: 1203, column: 3},
						end: {line: 1214, column: 101}
					},
					_p4)(
					A2(
						_elm_lang$core$Basics_ops['++'],
						'Loc equation only supports binary operations, but got: ',
						_elm_lang$core$Basics$toString(eqn)));
			}
	}
};
var _user$project$LocEqn$locEqnLocIds = function (eqn) {
	var _p11 = eqn;
	switch (_p11.ctor) {
		case 'LocEqnConst':
			return {ctor: '[]'};
		case 'LocEqnLoc':
			return {
				ctor: '::',
				_0: _p11._0,
				_1: {ctor: '[]'}
			};
		default:
			return A2(_elm_lang$core$List$concatMap, _user$project$LocEqn$locEqnLocIds, _p11._1);
	}
};
var _user$project$LocEqn$locEqnConsts = function (eqn) {
	var _p12 = eqn;
	switch (_p12.ctor) {
		case 'LocEqnConst':
			return {
				ctor: '::',
				_0: _p12._0,
				_1: {ctor: '[]'}
			};
		case 'LocEqnLoc':
			return {ctor: '[]'};
		default:
			return A2(_elm_lang$core$List$concatMap, _user$project$LocEqn$locEqnConsts, _p12._1);
	}
};
var _user$project$LocEqn$locEqnLocIdSet = function (eqn) {
	var _p13 = eqn;
	switch (_p13.ctor) {
		case 'LocEqnConst':
			return _elm_lang$core$Set$empty;
		case 'LocEqnLoc':
			return _elm_lang$core$Set$singleton(_p13._0);
		default:
			return A3(
				_elm_lang$core$List$foldl,
				F2(
					function (child, locs) {
						return A2(
							_elm_lang$core$Set$union,
							locs,
							_user$project$LocEqn$locEqnLocIdSet(child));
					}),
				_elm_lang$core$Set$empty,
				_p13._1);
	}
};
var _user$project$LocEqn$locEqnSize = function (eqn) {
	var _p14 = eqn;
	switch (_p14.ctor) {
		case 'LocEqnConst':
			return 1;
		case 'LocEqnLoc':
			return 1;
		default:
			return 1 + _elm_lang$core$List$sum(
				A2(_elm_lang$core$List$map, _user$project$LocEqn$locEqnSize, _p14._1));
	}
};
var _user$project$LocEqn$atMostNConstants = F2(
	function (n, template) {
		return _elm_lang$core$Native_Utils.cmp(
			_elm_lang$core$List$length(
				_user$project$LocEqn$locEqnConsts(template)),
			n) < 1;
	});
var _user$project$LocEqn$atLeastNLocs = F2(
	function (n, template) {
		return _elm_lang$core$Native_Utils.cmp(
			_elm_lang$core$Set$size(
				_user$project$LocEqn$locEqnLocIdSet(template)),
			n) > -1;
	});
var _user$project$LocEqn$littleConstants = {
	ctor: '::',
	_0: 0,
	_1: {
		ctor: '::',
		_0: 1,
		_1: {
			ctor: '::',
			_0: 2,
			_1: {
				ctor: '::',
				_0: 10,
				_1: {
					ctor: '::',
					_0: 3,
					_1: {
						ctor: '::',
						_0: 20,
						_1: {
							ctor: '::',
							_0: 50,
							_1: {
								ctor: '::',
								_0: 4,
								_1: {
									ctor: '::',
									_0: 300,
									_1: {
										ctor: '::',
										_0: 5,
										_1: {
											ctor: '::',
											_0: 0.5,
											_1: {
												ctor: '::',
												_0: 100,
												_1: {
													ctor: '::',
													_0: 200,
													_1: {
														ctor: '::',
														_0: 30,
														_1: {
															ctor: '::',
															_0: 60,
															_1: {
																ctor: '::',
																_0: 80,
																_1: {
																	ctor: '::',
																	_0: 15,
																	_1: {
																		ctor: '::',
																		_0: 360,
																		_1: {
																			ctor: '::',
																			_0: 180,
																			_1: {
																				ctor: '::',
																				_0: 120,
																				_1: {
																					ctor: '::',
																					_0: 6,
																					_1: {
																						ctor: '::',
																						_0: 150,
																						_1: {
																							ctor: '::',
																							_0: 40,
																							_1: {
																								ctor: '::',
																								_0: 8,
																								_1: {ctor: '[]'}
																							}
																						}
																					}
																				}
																			}
																		}
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
};
var _user$project$LocEqn$maybeExtractUnsharedExpression = F2(
	function (lhs, rhs) {
		var _p15 = {ctor: '_Tuple2', _0: lhs, _1: rhs};
		_v9_3:
		do {
			if (_p15.ctor === '_Tuple2') {
				switch (_p15._0.ctor) {
					case 'LocEqnConst':
						if (_p15._1.ctor === 'LocEqnConst') {
							return _elm_lang$core$Native_Utils.eq(_p15._0._0, _p15._1._0) ? _elm_lang$core$Maybe$Nothing : _elm_lang$core$Maybe$Just(
								{ctor: '_Tuple2', _0: lhs, _1: rhs});
						} else {
							break _v9_3;
						}
					case 'LocEqnLoc':
						if (_p15._1.ctor === 'LocEqnLoc') {
							return _elm_lang$core$Native_Utils.eq(_p15._0._0, _p15._1._0) ? _elm_lang$core$Maybe$Nothing : _elm_lang$core$Maybe$Just(
								{ctor: '_Tuple2', _0: lhs, _1: rhs});
						} else {
							break _v9_3;
						}
					default:
						if (_p15._1.ctor === 'LocEqnOp') {
							var _p19 = _p15._1._1;
							var _p18 = _p15._0._1;
							if (!_elm_lang$core$Native_Utils.eq(_p15._0._0, _p15._1._0)) {
								return _elm_lang$core$Maybe$Just(
									{ctor: '_Tuple2', _0: lhs, _1: rhs});
							} else {
								if (_elm_lang$core$Native_Utils.eq(_p18, _p19)) {
									return _elm_lang$core$Maybe$Nothing;
								} else {
									if (!_elm_lang$core$Native_Utils.eq(
										_elm_lang$core$List$length(_p18),
										_elm_lang$core$List$length(_p19))) {
										return _elm_lang$core$Maybe$Just(
											{ctor: '_Tuple2', _0: lhs, _1: rhs});
									} else {
										var unsharedSubexpressions = A2(
											_elm_lang$core$List$map,
											function (_p16) {
												var _p17 = _p16;
												return A2(_user$project$LocEqn$maybeExtractUnsharedExpression, _p17._0, _p17._1);
											},
											A2(_user$project$Utils$zip, _p18, _p19));
										if (A2(
											_elm_lang$core$List$all,
											F2(
												function (x, y) {
													return _elm_lang$core$Native_Utils.eq(x, y);
												})(_elm_lang$core$Maybe$Nothing),
											unsharedSubexpressions)) {
											return _elm_lang$core$Maybe$Nothing;
										} else {
											if (_elm_lang$core$Native_Utils.cmp(
												A2(
													_user$project$Utils$count,
													F2(
														function (x, y) {
															return !_elm_lang$core$Native_Utils.eq(x, y);
														})(_elm_lang$core$Maybe$Nothing),
													unsharedSubexpressions),
												1) > 0) {
												return _elm_lang$core$Maybe$Just(
													{ctor: '_Tuple2', _0: lhs, _1: rhs});
											} else {
												var justUnsharedSubexpressionPair = A2(
													_user$project$Utils$fromJust_,
													'extractUnsharedExpression this is logically impossible',
													A2(
														_user$project$Utils$findFirst,
														F2(
															function (x, y) {
																return !_elm_lang$core$Native_Utils.eq(x, y);
															})(_elm_lang$core$Maybe$Nothing),
														unsharedSubexpressions));
												return justUnsharedSubexpressionPair;
											}
										}
									}
								}
							}
						} else {
							break _v9_3;
						}
				}
			} else {
				break _v9_3;
			}
		} while(false);
		return _elm_lang$core$Maybe$Just(
			{ctor: '_Tuple2', _0: lhs, _1: rhs});
	});
var _user$project$LocEqn$normPolyPowSortKey = function (_p20) {
	var _p21 = _p20;
	var _p22 = _p21._0;
	if (_p22.ctor === 'NormPolyLoc') {
		return _elm_lang$core$Basics$toFloat(_p22._0);
	} else {
		return 0 - _user$project$Utils$infinity;
	}
};
var _user$project$LocEqn$normPolyPowLocIds = function (_p23) {
	var _p24 = _p23;
	var _p25 = _p24._0;
	if (_p25.ctor === 'NormPolyLoc') {
		return {
			ctor: '::',
			_0: _p25._0,
			_1: {ctor: '[]'}
		};
	} else {
		return {ctor: '[]'};
	}
};
var _user$project$LocEqn$normPolyPowExponentSortNum = function (_p26) {
	var _p27 = _p26;
	var _p28 = _p27._1;
	_v16_2:
	do {
		if (_p28.ctor === 'NormPolyAdd') {
			if (_p28._0.ctor === '[]') {
				return 0;
			} else {
				if ((_p28._0._0._1.ctor === '[]') && (_p28._0._1.ctor === '[]')) {
					return _p28._0._0._0;
				} else {
					break _v16_2;
				}
			}
		} else {
			break _v16_2;
		}
	} while(false);
	return 0 - _user$project$Utils$infinity;
};
var _user$project$LocEqn$normPolyMultTermSortKey = function (_p29) {
	var _p30 = _p29;
	var _p31 = _p30._1;
	var powTermPowers = A2(_elm_lang$core$List$map, _user$project$LocEqn$normPolyPowExponentSortNum, _p31);
	var locIds = A2(_elm_lang$core$List$concatMap, _user$project$LocEqn$normPolyPowLocIds, _p31);
	return {
		ctor: '_Tuple6',
		_0: _elm_lang$core$Basics$negate(
			A2(
				_elm_lang$core$Maybe$withDefault,
				0 - _user$project$Utils$infinity,
				_elm_lang$core$List$maximum(powTermPowers))),
		_1: _elm_lang$core$List$length(_p31),
		_2: A2(
			_elm_lang$core$List$map,
			_elm_lang$core$Basics$negate,
			_elm_lang$core$List$reverse(
				_elm_lang$core$List$sort(powTermPowers))),
		_3: locIds,
		_4: A2(_elm_lang$core$List$map, _elm_lang$core$Basics$negate, powTermPowers),
		_5: _p30._0
	};
};
var _user$project$LocEqn$normPolyPowTermsCompatible = F2(
	function (aPowTerms, bPowTerms) {
		normPolyPowTermsCompatible:
		while (true) {
			var _p32 = {ctor: '_Tuple2', _0: aPowTerms, _1: bPowTerms};
			_v18_2:
			do {
				if (_p32.ctor === '_Tuple2') {
					if (_p32._0.ctor === '[]') {
						if (_p32._1.ctor === '[]') {
							return true;
						} else {
							break _v18_2;
						}
					} else {
						if (_p32._1.ctor === '::') {
							var maybeMatchingTermRemoved = A2(
								_user$project$Utils$maybeFindAndRemoveFirst,
								function (bPowTerm) {
									return _elm_lang$core$Native_Utils.eq(_p32._0._0, bPowTerm);
								},
								bPowTerms);
							var _p33 = maybeMatchingTermRemoved;
							if (_p33.ctor === 'Just') {
								var _v20 = _p32._0._1,
									_v21 = _p33._0._1;
								aPowTerms = _v20;
								bPowTerms = _v21;
								continue normPolyPowTermsCompatible;
							} else {
								return false;
							}
						} else {
							break _v18_2;
						}
					}
				} else {
					break _v18_2;
				}
			} while(false);
			return false;
		}
	});
var _user$project$LocEqn$topLevelMultTerms = function (_p34) {
	var _p35 = _p34;
	return _p35._0;
};
var _user$project$LocEqn$debugLog = _user$project$Config$debugLog(_user$project$Config$debugSync);
var _user$project$LocEqn$locEqnToLittle = F2(
	function (locIdToLittle, eqn) {
		var _p36 = eqn;
		switch (_p36.ctor) {
			case 'LocEqnConst':
				return A2(
					_elm_lang$core$Basics_ops['++'],
					_elm_lang$core$Basics$toString(_p36._0),
					'!');
			case 'LocEqnLoc':
				var _p39 = _p36._0;
				var _p37 = A2(_elm_lang$core$Dict$get, _p39, locIdToLittle);
				if (_p37.ctor === 'Just') {
					return _p37._0;
				} else {
					var _p38 = A2(_user$project$LocEqn$debugLog, 'missing locId', _p39);
					return '?';
				}
			default:
				var childLittleStrs = A2(
					_elm_lang$core$List$map,
					_user$project$LocEqn$locEqnToLittle(locIdToLittle),
					_p36._1);
				return A2(
					_elm_lang$core$Basics_ops['++'],
					'(',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_user$project$Lang$strOp(_p36._0),
						A2(
							_elm_lang$core$Basics_ops['++'],
							' ',
							A2(
								_elm_lang$core$Basics_ops['++'],
								A2(_elm_lang$core$String$join, ' ', childLittleStrs),
								')'))));
		}
	});
var _user$project$LocEqn$LocEqnOp = F2(
	function (a, b) {
		return {ctor: 'LocEqnOp', _0: a, _1: b};
	});
var _user$project$LocEqn$LocEqnLoc = function (a) {
	return {ctor: 'LocEqnLoc', _0: a};
};
var _user$project$LocEqn$locEqnTemplateLocFillings = F2(
	function (locIds, eqn) {
		var _p40 = eqn;
		switch (_p40.ctor) {
			case 'LocEqnConst':
				return {
					ctor: '::',
					_0: eqn,
					_1: {ctor: '[]'}
				};
			case 'LocEqnLoc':
				return A2(_elm_lang$core$List$map, _user$project$LocEqn$LocEqnLoc, locIds);
			default:
				return A2(
					_elm_lang$core$List$map,
					_user$project$LocEqn$LocEqnOp(_p40._0),
					A3(
						_elm_lang$core$List$foldl,
						F2(
							function (child, priorCombos) {
								var thisChildFillings = A2(_user$project$LocEqn$locEqnTemplateLocFillings, locIds, child);
								return A2(
									_elm_lang$core$List$concatMap,
									function (childFilling) {
										return A2(
											_elm_lang$core$List$map,
											function (priorArgs) {
												return A2(
													_elm_lang$core$Basics_ops['++'],
													priorArgs,
													{
														ctor: '::',
														_0: childFilling,
														_1: {ctor: '[]'}
													});
											},
											priorCombos);
									},
									thisChildFillings);
							}),
						{
							ctor: '::',
							_0: {ctor: '[]'},
							_1: {ctor: '[]'}
						},
						_p40._1));
		}
	});
var _user$project$LocEqn$LocEqnConst = function (a) {
	return {ctor: 'LocEqnConst', _0: a};
};
var _user$project$LocEqn$locEqnSimplify = function (eqn) {
	var simplified = function () {
		var _p41 = eqn;
		switch (_p41.ctor) {
			case 'LocEqnConst':
				return eqn;
			case 'LocEqnLoc':
				return eqn;
			default:
				var _p59 = _p41._0;
				var children_ = A2(_elm_lang$core$List$map, _user$project$LocEqn$locEqnSimplify, _p41._1);
				var eqn_ = A2(_user$project$LocEqn$LocEqnOp, _p59, children_);
				var _p42 = children_;
				if (((_p42.ctor === '::') && (_p42._1.ctor === '::')) && (_p42._1._1.ctor === '[]')) {
					var _p57 = _p42._1._0;
					var _p56 = _p42._0;
					var _p43 = _p59;
					switch (_p43.ctor) {
						case 'Plus':
							var _p44 = {ctor: '_Tuple2', _0: _p56, _1: _p57};
							_v29_5:
							do {
								_v29_3:
								do {
									_v29_2:
									do {
										_v29_1:
										do {
											_v29_0:
											do {
												if (_p44.ctor === '_Tuple2') {
													switch (_p44._0.ctor) {
														case 'LocEqnOp':
															switch (_p44._1.ctor) {
																case 'LocEqnConst':
																	if (_p44._1._0 === 0) {
																		break _v29_1;
																	} else {
																		if ((((_p44._0._0.ctor === 'Minus') && (_p44._0._1.ctor === '::')) && (_p44._0._1._1.ctor === '::')) && (_p44._0._1._1._1.ctor === '[]')) {
																			break _v29_2;
																		} else {
																			break _v29_5;
																		}
																	}
																case 'LocEqnOp':
																	if ((((_p44._0._0.ctor === 'Minus') && (_p44._0._1.ctor === '::')) && (_p44._0._1._1.ctor === '::')) && (_p44._0._1._1._1.ctor === '[]')) {
																		break _v29_2;
																	} else {
																		if ((((_p44._1._0.ctor === 'Minus') && (_p44._1._1.ctor === '::')) && (_p44._1._1._1.ctor === '::')) && (_p44._1._1._1._1.ctor === '[]')) {
																			break _v29_3;
																		} else {
																			break _v29_5;
																		}
																	}
																default:
																	if ((((_p44._0._0.ctor === 'Minus') && (_p44._0._1.ctor === '::')) && (_p44._0._1._1.ctor === '::')) && (_p44._0._1._1._1.ctor === '[]')) {
																		break _v29_2;
																	} else {
																		break _v29_5;
																	}
															}
														case 'LocEqnConst':
															switch (_p44._1.ctor) {
																case 'LocEqnOp':
																	if (_p44._0._0 === 0) {
																		break _v29_0;
																	} else {
																		if ((((_p44._1._0.ctor === 'Minus') && (_p44._1._1.ctor === '::')) && (_p44._1._1._1.ctor === '::')) && (_p44._1._1._1._1.ctor === '[]')) {
																			break _v29_3;
																		} else {
																			break _v29_5;
																		}
																	}
																case 'LocEqnConst':
																	if (_p44._0._0 === 0) {
																		break _v29_0;
																	} else {
																		if (_p44._1._0 === 0) {
																			break _v29_1;
																		} else {
																			return _user$project$LocEqn$LocEqnConst(_p44._0._0 + _p44._1._0);
																		}
																	}
																default:
																	if (_p44._0._0 === 0) {
																		break _v29_0;
																	} else {
																		break _v29_5;
																	}
															}
														default:
															switch (_p44._1.ctor) {
																case 'LocEqnConst':
																	if (_p44._1._0 === 0) {
																		break _v29_1;
																	} else {
																		break _v29_5;
																	}
																case 'LocEqnOp':
																	if ((((_p44._1._0.ctor === 'Minus') && (_p44._1._1.ctor === '::')) && (_p44._1._1._1.ctor === '::')) && (_p44._1._1._1._1.ctor === '[]')) {
																		break _v29_3;
																	} else {
																		break _v29_5;
																	}
																default:
																	break _v29_5;
															}
													}
												} else {
													break _v29_5;
												}
											} while(false);
											return _p57;
										} while(false);
										return _p56;
									} while(false);
									return _elm_lang$core$Native_Utils.eq(_p44._0._1._1._0, _p44._1) ? _p44._0._1._0 : eqn_;
								} while(false);
								return _elm_lang$core$Native_Utils.eq(_p44._1._1._1._0, _p44._0) ? _p44._1._1._0 : eqn_;
							} while(false);
							return eqn_;
						case 'Minus':
							var _p45 = {ctor: '_Tuple2', _0: _p56, _1: _p57};
							_v30_10:
							do {
								_v30_7:
								do {
									_v30_6:
									do {
										_v30_0:
										do {
											if (_p45.ctor === '_Tuple2') {
												switch (_p45._1.ctor) {
													case 'LocEqnOp':
														if (((_p45._1._1.ctor === '::') && (_p45._1._1._1.ctor === '::')) && (_p45._1._1._1._1.ctor === '[]')) {
															switch (_p45._1._0.ctor) {
																case 'Mult':
																	switch (_p45._0.ctor) {
																		case 'LocEqnConst':
																			if (_p45._0._0 === 0) {
																				if (_p45._1._1._0.ctor === 'LocEqnConst') {
																					return A2(
																						_user$project$LocEqn$LocEqnOp,
																						_user$project$Lang$Mult,
																						{
																							ctor: '::',
																							_0: _user$project$LocEqn$LocEqnConst(0 - _p45._1._1._0._0),
																							_1: {
																								ctor: '::',
																								_0: _p45._1._1._1._0,
																								_1: {ctor: '[]'}
																							}
																						});
																				} else {
																					if (_p45._1._1._1._0.ctor === 'LocEqnConst') {
																						return A2(
																							_user$project$LocEqn$LocEqnOp,
																							_user$project$Lang$Mult,
																							{
																								ctor: '::',
																								_0: _user$project$LocEqn$LocEqnConst(0 - _p45._1._1._1._0._0),
																								_1: {
																									ctor: '::',
																									_0: _p45._1._1._0,
																									_1: {ctor: '[]'}
																								}
																							});
																					} else {
																						break _v30_10;
																					}
																				}
																			} else {
																				break _v30_10;
																			}
																		case 'LocEqnOp':
																			if ((((_p45._0._0.ctor === 'Plus') && (_p45._0._1.ctor === '::')) && (_p45._0._1._1.ctor === '::')) && (_p45._0._1._1._1.ctor === '[]')) {
																				break _v30_7;
																			} else {
																				break _v30_10;
																			}
																		default:
																			break _v30_10;
																	}
																case 'Div':
																	switch (_p45._0.ctor) {
																		case 'LocEqnConst':
																			if ((_p45._0._0 === 0) && (_p45._1._1._0.ctor === 'LocEqnConst')) {
																				return A2(
																					_user$project$LocEqn$LocEqnOp,
																					_user$project$Lang$Div,
																					{
																						ctor: '::',
																						_0: _user$project$LocEqn$LocEqnConst(0 - _p45._1._1._0._0),
																						_1: {
																							ctor: '::',
																							_0: _p45._1._1._1._0,
																							_1: {ctor: '[]'}
																						}
																					});
																			} else {
																				break _v30_10;
																			}
																		case 'LocEqnOp':
																			if ((((_p45._0._0.ctor === 'Plus') && (_p45._0._1.ctor === '::')) && (_p45._0._1._1.ctor === '::')) && (_p45._0._1._1._1.ctor === '[]')) {
																				break _v30_7;
																			} else {
																				break _v30_10;
																			}
																		default:
																			break _v30_10;
																	}
																case 'Minus':
																	switch (_p45._0.ctor) {
																		case 'LocEqnConst':
																			if (_p45._0._0 === 0) {
																				if ((_p45._1._1._0.ctor === 'LocEqnConst') && (_p45._1._1._0._0 === 0)) {
																					return _p45._1._1._1._0;
																				} else {
																					return A2(
																						_user$project$LocEqn$LocEqnOp,
																						_user$project$Lang$Minus,
																						{
																							ctor: '::',
																							_0: _p45._1._1._1._0,
																							_1: {
																								ctor: '::',
																								_0: _p45._1._1._0,
																								_1: {ctor: '[]'}
																							}
																						});
																				}
																			} else {
																				break _v30_6;
																			}
																		case 'LocEqnOp':
																			break _v30_6;
																		default:
																			break _v30_6;
																	}
																case 'Plus':
																	if (((((_p45._0.ctor === 'LocEqnOp') && (_p45._0._0.ctor === 'Plus')) && (_p45._0._1.ctor === '::')) && (_p45._0._1._1.ctor === '::')) && (_p45._0._1._1._1.ctor === '[]')) {
																		break _v30_7;
																	} else {
																		var _p51 = _p45._0;
																		var _p50 = _p45._1._1._1._0;
																		var _p49 = _p45._1._1._0;
																		return _elm_lang$core$Native_Utils.eq(_p50, _p51) ? A2(
																			_user$project$LocEqn$LocEqnOp,
																			_user$project$Lang$Minus,
																			{
																				ctor: '::',
																				_0: _user$project$LocEqn$LocEqnConst(0),
																				_1: {
																					ctor: '::',
																					_0: _p49,
																					_1: {ctor: '[]'}
																				}
																			}) : (_elm_lang$core$Native_Utils.eq(_p49, _p51) ? A2(
																			_user$project$LocEqn$LocEqnOp,
																			_user$project$Lang$Minus,
																			{
																				ctor: '::',
																				_0: _user$project$LocEqn$LocEqnConst(0),
																				_1: {
																					ctor: '::',
																					_0: _p50,
																					_1: {ctor: '[]'}
																				}
																			}) : eqn_);
																	}
																default:
																	if (((((_p45._0.ctor === 'LocEqnOp') && (_p45._0._0.ctor === 'Plus')) && (_p45._0._1.ctor === '::')) && (_p45._0._1._1.ctor === '::')) && (_p45._0._1._1._1.ctor === '[]')) {
																		break _v30_7;
																	} else {
																		break _v30_10;
																	}
															}
														} else {
															if (((((_p45._0.ctor === 'LocEqnOp') && (_p45._0._0.ctor === 'Plus')) && (_p45._0._1.ctor === '::')) && (_p45._0._1._1.ctor === '::')) && (_p45._0._1._1._1.ctor === '[]')) {
																break _v30_7;
															} else {
																break _v30_10;
															}
														}
													case 'LocEqnConst':
														switch (_p45._0.ctor) {
															case 'LocEqnOp':
																if (_p45._1._0 === 0) {
																	break _v30_0;
																} else {
																	if ((((_p45._0._0.ctor === 'Plus') && (_p45._0._1.ctor === '::')) && (_p45._0._1._1.ctor === '::')) && (_p45._0._1._1._1.ctor === '[]')) {
																		break _v30_7;
																	} else {
																		break _v30_10;
																	}
																}
															case 'LocEqnConst':
																if (_p45._1._0 === 0) {
																	break _v30_0;
																} else {
																	return _user$project$LocEqn$LocEqnConst(_p45._0._0 - _p45._1._0);
																}
															default:
																if (_p45._1._0 === 0) {
																	break _v30_0;
																} else {
																	break _v30_10;
																}
														}
													default:
														if (((((_p45._0.ctor === 'LocEqnOp') && (_p45._0._0.ctor === 'Plus')) && (_p45._0._1.ctor === '::')) && (_p45._0._1._1.ctor === '::')) && (_p45._0._1._1._1.ctor === '[]')) {
															break _v30_7;
														} else {
															break _v30_10;
														}
												}
											} else {
												break _v30_10;
											}
										} while(false);
										return _p56;
									} while(false);
									return A2(
										_user$project$LocEqn$LocEqnOp,
										_user$project$Lang$Plus,
										{
											ctor: '::',
											_0: _p45._0,
											_1: {
												ctor: '::',
												_0: A2(
													_user$project$LocEqn$LocEqnOp,
													_user$project$Lang$Minus,
													{
														ctor: '::',
														_0: _p45._1._1._1._0,
														_1: {
															ctor: '::',
															_0: _p45._1._1._0,
															_1: {ctor: '[]'}
														}
													}),
												_1: {ctor: '[]'}
											}
										});
								} while(false);
								var _p48 = _p45._1;
								var _p47 = _p45._0._1._1._0;
								var _p46 = _p45._0._1._0;
								return _elm_lang$core$Native_Utils.eq(_p47, _p48) ? _p46 : (_elm_lang$core$Native_Utils.eq(_p46, _p48) ? _p47 : eqn_);
							} while(false);
							return _elm_lang$core$Native_Utils.eq(_p56, _p57) ? _user$project$LocEqn$LocEqnConst(0) : eqn_;
						case 'Mult':
							var _p52 = {ctor: '_Tuple2', _0: _p56, _1: _p57};
							_v31_11:
							do {
								_v31_3:
								do {
									_v31_2:
									do {
										_v31_1:
										do {
											_v31_0:
											do {
												if (_p52.ctor === '_Tuple2') {
													switch (_p52._0.ctor) {
														case 'LocEqnConst':
															switch (_p52._1.ctor) {
																case 'LocEqnConst':
																	switch (_p52._0._0) {
																		case 1:
																			break _v31_0;
																		case 0:
																			switch (_p52._1._0) {
																				case 1:
																					break _v31_1;
																				case 0:
																					break _v31_2;
																				default:
																					break _v31_2;
																			}
																		default:
																			switch (_p52._1._0) {
																				case 1:
																					break _v31_1;
																				case 0:
																					break _v31_3;
																				default:
																					return _user$project$LocEqn$LocEqnConst(_p52._0._0 * _p52._1._0);
																			}
																	}
																case 'LocEqnOp':
																	if (((_p52._1._1.ctor === '::') && (_p52._1._1._1.ctor === '::')) && (_p52._1._1._1._1.ctor === '[]')) {
																		switch (_p52._1._0.ctor) {
																			case 'Minus':
																				switch (_p52._0._0) {
																					case 1:
																						break _v31_0;
																					case 0:
																						break _v31_2;
																					case -1:
																						return A2(
																							_user$project$LocEqn$LocEqnOp,
																							_user$project$Lang$Minus,
																							{
																								ctor: '::',
																								_0: _p52._1._1._1._0,
																								_1: {
																									ctor: '::',
																									_0: _p52._1._1._0,
																									_1: {ctor: '[]'}
																								}
																							});
																					default:
																						break _v31_11;
																				}
																			case 'Mult':
																				switch (_p52._0._0) {
																					case 1:
																						break _v31_0;
																					case 0:
																						break _v31_2;
																					default:
																						if (_p52._1._1._0.ctor === 'LocEqnConst') {
																							return A2(
																								_user$project$LocEqn$LocEqnOp,
																								_user$project$Lang$Mult,
																								{
																									ctor: '::',
																									_0: _user$project$LocEqn$LocEqnConst(_p52._0._0 * _p52._1._1._0._0),
																									_1: {
																										ctor: '::',
																										_0: _p52._1._1._1._0,
																										_1: {ctor: '[]'}
																									}
																								});
																						} else {
																							if (_p52._1._1._1._0.ctor === 'LocEqnConst') {
																								return A2(
																									_user$project$LocEqn$LocEqnOp,
																									_user$project$Lang$Mult,
																									{
																										ctor: '::',
																										_0: _user$project$LocEqn$LocEqnConst(_p52._0._0 * _p52._1._1._1._0._0),
																										_1: {
																											ctor: '::',
																											_0: _p52._1._1._0,
																											_1: {ctor: '[]'}
																										}
																									});
																							} else {
																								break _v31_11;
																							}
																						}
																				}
																			default:
																				switch (_p52._0._0) {
																					case 1:
																						break _v31_0;
																					case 0:
																						break _v31_2;
																					default:
																						break _v31_11;
																				}
																		}
																	} else {
																		switch (_p52._0._0) {
																			case 1:
																				break _v31_0;
																			case 0:
																				break _v31_2;
																			default:
																				break _v31_11;
																		}
																	}
																default:
																	switch (_p52._0._0) {
																		case 1:
																			break _v31_0;
																		case 0:
																			break _v31_2;
																		default:
																			break _v31_11;
																	}
															}
														case 'LocEqnOp':
															if (_p52._1.ctor === 'LocEqnConst') {
																if (((_p52._0._1.ctor === '::') && (_p52._0._1._1.ctor === '::')) && (_p52._0._1._1._1.ctor === '[]')) {
																	switch (_p52._0._0.ctor) {
																		case 'Minus':
																			switch (_p52._1._0) {
																				case 1:
																					break _v31_1;
																				case 0:
																					break _v31_3;
																				case -1:
																					return A2(
																						_user$project$LocEqn$LocEqnOp,
																						_user$project$Lang$Minus,
																						{
																							ctor: '::',
																							_0: _p52._0._1._1._0,
																							_1: {
																								ctor: '::',
																								_0: _p52._0._1._0,
																								_1: {ctor: '[]'}
																							}
																						});
																				default:
																					break _v31_11;
																			}
																		case 'Mult':
																			switch (_p52._1._0) {
																				case 1:
																					break _v31_1;
																				case 0:
																					break _v31_3;
																				default:
																					if (_p52._0._1._0.ctor === 'LocEqnConst') {
																						return A2(
																							_user$project$LocEqn$LocEqnOp,
																							_user$project$Lang$Mult,
																							{
																								ctor: '::',
																								_0: _user$project$LocEqn$LocEqnConst(_p52._1._0 * _p52._0._1._0._0),
																								_1: {
																									ctor: '::',
																									_0: _p52._0._1._1._0,
																									_1: {ctor: '[]'}
																								}
																							});
																					} else {
																						if (_p52._0._1._1._0.ctor === 'LocEqnConst') {
																							return A2(
																								_user$project$LocEqn$LocEqnOp,
																								_user$project$Lang$Mult,
																								{
																									ctor: '::',
																									_0: _user$project$LocEqn$LocEqnConst(_p52._1._0 * _p52._0._1._1._0._0),
																									_1: {
																										ctor: '::',
																										_0: _p52._0._1._0,
																										_1: {ctor: '[]'}
																									}
																								});
																						} else {
																							break _v31_11;
																						}
																					}
																			}
																		default:
																			switch (_p52._1._0) {
																				case 1:
																					break _v31_1;
																				case 0:
																					break _v31_3;
																				default:
																					break _v31_11;
																			}
																	}
																} else {
																	switch (_p52._1._0) {
																		case 1:
																			break _v31_1;
																		case 0:
																			break _v31_3;
																		default:
																			break _v31_11;
																	}
																}
															} else {
																break _v31_11;
															}
														default:
															if (_p52._1.ctor === 'LocEqnConst') {
																switch (_p52._1._0) {
																	case 1:
																		break _v31_1;
																	case 0:
																		break _v31_3;
																	default:
																		break _v31_11;
																}
															} else {
																break _v31_11;
															}
													}
												} else {
													break _v31_11;
												}
											} while(false);
											return _p57;
										} while(false);
										return _p56;
									} while(false);
									return _user$project$LocEqn$LocEqnConst(0);
								} while(false);
								return _user$project$LocEqn$LocEqnConst(0);
							} while(false);
							return eqn_;
						case 'Div':
							var _p53 = {ctor: '_Tuple2', _0: _p56, _1: _p57};
							_v32_5:
							do {
								_v32_1:
								do {
									_v32_0:
									do {
										if (_p53.ctor === '_Tuple2') {
											if (_p53._1.ctor === 'LocEqnConst') {
												if (_p53._0.ctor === 'LocEqnConst') {
													switch (_p53._1._0) {
														case 1:
															break _v32_0;
														case -1:
															break _v32_1;
														default:
															var _p54 = _p53._1._0;
															return (!_elm_lang$core$Native_Utils.eq(_p54, 0)) ? _user$project$LocEqn$LocEqnConst(_p53._0._0 / _p54) : eqn_;
													}
												} else {
													switch (_p53._1._0) {
														case 1:
															break _v32_0;
														case -1:
															break _v32_1;
														default:
															var _p55 = _p53._1._0;
															return (!_elm_lang$core$Native_Utils.eq(_p55, 0)) ? A2(
																_user$project$LocEqn$LocEqnOp,
																_user$project$Lang$Mult,
																{
																	ctor: '::',
																	_0: _user$project$LocEqn$LocEqnConst(1 / _p55),
																	_1: {
																		ctor: '::',
																		_0: _p56,
																		_1: {ctor: '[]'}
																	}
																}) : eqn_;
													}
												}
											} else {
												if ((_p53._0.ctor === 'LocEqnConst') && (_p53._0._0 === 0)) {
													return _user$project$LocEqn$LocEqnConst(0);
												} else {
													break _v32_5;
												}
											}
										} else {
											break _v32_5;
										}
									} while(false);
									return _p56;
								} while(false);
								return A2(
									_user$project$LocEqn$LocEqnOp,
									_user$project$Lang$Mult,
									{
										ctor: '::',
										_0: _user$project$LocEqn$LocEqnConst(-1),
										_1: {
											ctor: '::',
											_0: _p56,
											_1: {ctor: '[]'}
										}
									});
							} while(false);
							return (_elm_lang$core$Native_Utils.eq(_p56, _p57) && (!_elm_lang$core$Native_Utils.eq(
								_p57,
								_user$project$LocEqn$LocEqnConst(0)))) ? _user$project$LocEqn$LocEqnConst(1) : eqn_;
						default:
							return eqn_;
					}
				} else {
					return _elm_lang$core$Native_Utils.crashCase(
						'LocEqn',
						{
							start: {line: 53, column: 9},
							end: {line: 146, column: 86}
						},
						_p42)(
						A2(
							_elm_lang$core$Basics_ops['++'],
							'locEqnSimplify: op without 2 children ',
							_elm_lang$core$Basics$toString(eqn)));
				}
		}
	}();
	return _elm_lang$core$Native_Utils.eq(simplified, eqn) ? eqn : A2(
		_user$project$LocEqn$debugLog,
		'double simplification',
		_user$project$LocEqn$locEqnSimplify(simplified));
};
var _user$project$LocEqn$locEqnTemplateConstantFillings = F2(
	function (constants, eqn) {
		var _p60 = eqn;
		switch (_p60.ctor) {
			case 'LocEqnConst':
				return A2(_elm_lang$core$List$map, _user$project$LocEqn$LocEqnConst, constants);
			case 'LocEqnLoc':
				return {
					ctor: '::',
					_0: eqn,
					_1: {ctor: '[]'}
				};
			default:
				return A2(
					_elm_lang$core$List$map,
					_user$project$LocEqn$LocEqnOp(_p60._0),
					A3(
						_elm_lang$core$List$foldl,
						F2(
							function (child, priorCombos) {
								var thisChildFillings = A2(_user$project$LocEqn$locEqnTemplateConstantFillings, constants, child);
								return A2(
									_elm_lang$core$List$concatMap,
									function (childFilling) {
										return A2(
											_elm_lang$core$List$map,
											function (priorArgs) {
												return A2(
													_elm_lang$core$Basics_ops['++'],
													priorArgs,
													{
														ctor: '::',
														_0: childFilling,
														_1: {ctor: '[]'}
													});
											},
											priorCombos);
									},
									thisChildFillings);
							}),
						{
							ctor: '::',
							_0: {ctor: '[]'},
							_1: {ctor: '[]'}
						},
						_p60._1));
		}
	});
var _user$project$LocEqn$locEqnsTemplatesOfSize_ = function (astSize) {
	return (_elm_lang$core$Native_Utils.cmp(astSize, 1) < 0) ? {ctor: '[]'} : (_elm_lang$core$Native_Utils.eq(astSize, 1) ? {
		ctor: '::',
		_0: _user$project$LocEqn$LocEqnConst(-1),
		_1: {
			ctor: '::',
			_0: _user$project$LocEqn$LocEqnLoc(-1),
			_1: {ctor: '[]'}
		}
	} : (_elm_lang$core$Native_Utils.eq(astSize, 2) ? {ctor: '[]'} : A2(
		_elm_lang$core$List$concatMap,
		function (op) {
			return A2(
				_elm_lang$core$List$concatMap,
				function (leftSize) {
					return A2(
						_elm_lang$core$List$concatMap,
						function (leftEqn) {
							var rightSize = (astSize - leftSize) - 1;
							return A2(
								_elm_lang$core$List$map,
								function (rightEqn) {
									return A2(
										_user$project$LocEqn$LocEqnOp,
										op,
										{
											ctor: '::',
											_0: leftEqn,
											_1: {
												ctor: '::',
												_0: rightEqn,
												_1: {ctor: '[]'}
											}
										});
								},
								_user$project$LocEqn$locEqnsTemplatesOfSize_(rightSize));
						},
						_user$project$LocEqn$locEqnsTemplatesOfSize_(leftSize));
				},
				A2(_elm_lang$core$List$range, 1, astSize - 2));
		},
		{
			ctor: '::',
			_0: _user$project$Lang$Plus,
			_1: {
				ctor: '::',
				_0: _user$project$Lang$Minus,
				_1: {
					ctor: '::',
					_0: _user$project$Lang$Mult,
					_1: {
						ctor: '::',
						_0: _user$project$Lang$Div,
						_1: {ctor: '[]'}
					}
				}
			}
		})));
};
var _user$project$LocEqn$locEqnsTemplatesOfSize = F3(
	function (minLocs, maxConsts, astSize) {
		return A2(
			_elm_lang$core$List$filter,
			_user$project$LocEqn$atMostNConstants(maxConsts),
			A2(
				_elm_lang$core$List$filter,
				_user$project$LocEqn$atLeastNLocs(minLocs),
				_user$project$LocEqn$locEqnsTemplatesOfSize_(astSize)));
	});
var _user$project$LocEqn$traceToLocEquation = function (trace) {
	var _p61 = trace;
	if (_p61.ctor === 'TrLoc') {
		switch (_p61._0._0) {
			case 0:
				return _elm_lang$core$Native_Utils.crashCase(
					'LocEqn',
					{
						start: {line: 1218, column: 3},
						end: {line: 1233, column: 55}
					},
					_p61)(
					A2(
						_elm_lang$core$Basics_ops['++'],
						'traceToLocEquation: Found locId of 0 in trace. ',
						_elm_lang$core$Basics$toString(trace)));
			case -999:
				return _user$project$LocEqn$LocEqnConst(
					A2(
						_user$project$Utils$fromOkay,
						'traceToLocEquation',
						_elm_lang$core$String$toFloat(_p61._0._2)));
			default:
				return _user$project$LocEqn$LocEqnLoc(_p61._0._0);
		}
	} else {
		return A2(
			_user$project$LocEqn$LocEqnOp,
			_p61._0,
			A2(_elm_lang$core$List$map, _user$project$LocEqn$traceToLocEquation, _p61._1));
	}
};
var _user$project$LocEqn$constantifyLocs = F2(
	function (locIdToNum, eqn) {
		var _p63 = eqn;
		switch (_p63.ctor) {
			case 'LocEqnConst':
				return eqn;
			case 'LocEqnLoc':
				var _p64 = A2(_elm_lang$core$Dict$get, _p63._0, locIdToNum);
				if (_p64.ctor === 'Just') {
					return _user$project$LocEqn$LocEqnConst(_p64._0);
				} else {
					return eqn;
				}
			default:
				return A2(
					_user$project$LocEqn$LocEqnOp,
					_p63._0,
					A2(
						_elm_lang$core$List$map,
						_user$project$LocEqn$constantifyLocs(locIdToNum),
						_p63._1));
		}
	});
var _user$project$LocEqn$locEqnEval = F2(
	function (locIdToNum, eqn) {
		return _user$project$LocEqn$locEqnEval_(
			A2(_user$project$LocEqn$constantifyLocs, locIdToNum, eqn));
	});
var _user$project$LocEqn$PolyLoc = function (a) {
	return {ctor: 'PolyLoc', _0: a};
};
var _user$project$LocEqn$PolyPow = F2(
	function (a, b) {
		return {ctor: 'PolyPow', _0: a, _1: b};
	});
var _user$project$LocEqn$PolyMult = F2(
	function (a, b) {
		return {ctor: 'PolyMult', _0: a, _1: b};
	});
var _user$project$LocEqn$polyToString = function (poly) {
	var _p65 = poly;
	switch (_p65.ctor) {
		case 'PolyAdd':
			if (_p65._0.ctor === '[]') {
				return '0';
			} else {
				if (((_p65._0._0.ctor === 'PolyMult') && (_p65._0._0._1.ctor === '[]')) && (_p65._0._1.ctor === '[]')) {
					return _elm_lang$core$Basics$toString(_p65._0._0._0);
				} else {
					return A2(
						_elm_lang$core$Basics_ops['++'],
						'(',
						A2(
							_elm_lang$core$Basics_ops['++'],
							A2(
								_elm_lang$core$String$join,
								' + ',
								A2(_elm_lang$core$List$map, _user$project$LocEqn$polyToString, _p65._0)),
							')'));
				}
			}
		case 'PolyMult':
			if (_p65._1.ctor === '[]') {
				return _elm_lang$core$Basics$toString(_p65._0);
			} else {
				if (_p65._0 === 1) {
					return A2(
						_elm_lang$core$String$join,
						'*',
						A2(_elm_lang$core$List$map, _user$project$LocEqn$polyToString, _p65._1));
				} else {
					return A2(
						_elm_lang$core$Basics_ops['++'],
						_elm_lang$core$Basics$toString(_p65._0),
						A2(
							_elm_lang$core$Basics_ops['++'],
							'*',
							_user$project$LocEqn$polyToString(
								A2(_user$project$LocEqn$PolyMult, 1, _p65._1))));
				}
			}
		case 'PolyPow':
			return A2(
				_elm_lang$core$Basics_ops['++'],
				_user$project$LocEqn$polyToString(_p65._0),
				A2(
					_elm_lang$core$Basics_ops['++'],
					'^',
					_user$project$LocEqn$polyToString(_p65._1)));
		default:
			return A2(
				_elm_lang$core$Basics_ops['++'],
				'k',
				_elm_lang$core$Basics$toString(_p65._0));
	}
};
var _user$project$LocEqn$PolyAdd = function (a) {
	return {ctor: 'PolyAdd', _0: a};
};
var _user$project$LocEqn$normPolyAddToPoly = function (normPolyAdd) {
	var _p66 = normPolyAdd;
	if (_p66.ctor === 'NormPolyAdd') {
		return _user$project$LocEqn$PolyAdd(
			A2(_elm_lang$core$List$map, _user$project$LocEqn$normPolyMultToPoly, _p66._0));
	} else {
		return _user$project$LocEqn$PolyLoc(_p66._0);
	}
};
var _user$project$LocEqn$normPolyMultToPoly = function (_p67) {
	var _p68 = _p67;
	return A2(
		_user$project$LocEqn$PolyMult,
		_p68._0,
		A2(_elm_lang$core$List$map, _user$project$LocEqn$normPolyPowToPoly, _p68._1));
};
var _user$project$LocEqn$normPolyPowToPoly = function (_p69) {
	var _p70 = _p69;
	return A2(
		_user$project$LocEqn$PolyPow,
		_user$project$LocEqn$normPolyAddToPoly(_p70._0),
		_user$project$LocEqn$normPolyAddToPoly(_p70._1));
};
var _user$project$LocEqn$normPolyMultToString = function (_p71) {
	return _user$project$LocEqn$polyToString(
		_user$project$LocEqn$normPolyMultToPoly(_p71));
};
var _user$project$LocEqn$normPolyPowToString = function (_p72) {
	return _user$project$LocEqn$polyToString(
		_user$project$LocEqn$normPolyPowToPoly(_p72));
};
var _user$project$LocEqn$normPolyAddToString = function (_p73) {
	return _user$project$LocEqn$polyToString(
		_user$project$LocEqn$normPolyAddToPoly(_p73));
};
var _user$project$LocEqn$locEquationToPoly = function (locEqn) {
	var _p74 = locEqn;
	_v41_6:
	do {
		switch (_p74.ctor) {
			case 'LocEqnConst':
				return A2(
					_user$project$LocEqn$PolyMult,
					_p74._0,
					{ctor: '[]'});
			case 'LocEqnLoc':
				return _user$project$LocEqn$PolyLoc(_p74._0);
			default:
				switch (_p74._0.ctor) {
					case 'Plus':
						return _user$project$LocEqn$PolyAdd(
							A2(_elm_lang$core$List$map, _user$project$LocEqn$locEquationToPoly, _p74._1));
					case 'Minus':
						if (_p74._1.ctor === '::') {
							return _user$project$LocEqn$PolyAdd(
								{
									ctor: '::',
									_0: _user$project$LocEqn$locEquationToPoly(_p74._1._0),
									_1: A2(
										_elm_lang$core$List$map,
										function (child) {
											return A2(
												_user$project$LocEqn$PolyMult,
												-1,
												{
													ctor: '::',
													_0: _user$project$LocEqn$locEquationToPoly(child),
													_1: {ctor: '[]'}
												});
										},
										_p74._1._1)
								});
						} else {
							break _v41_6;
						}
					case 'Mult':
						return A2(
							_user$project$LocEqn$PolyMult,
							1,
							A2(_elm_lang$core$List$map, _user$project$LocEqn$locEquationToPoly, _p74._1));
					case 'Div':
						if (_p74._1.ctor === '::') {
							return A2(
								_user$project$LocEqn$PolyMult,
								1,
								{
									ctor: '::',
									_0: _user$project$LocEqn$locEquationToPoly(_p74._1._0),
									_1: A2(
										_elm_lang$core$List$map,
										function (child) {
											return A2(
												_user$project$LocEqn$PolyPow,
												_user$project$LocEqn$locEquationToPoly(child),
												A2(
													_user$project$LocEqn$PolyMult,
													-1,
													{ctor: '[]'}));
										},
										_p74._1._1)
								});
						} else {
							break _v41_6;
						}
					default:
						break _v41_6;
				}
		}
	} while(false);
	return _elm_lang$core$Native_Utils.crashCase(
		'LocEqn',
		{
			start: {line: 659, column: 3},
			end: {line: 679, column: 111}
		},
		_p74)(
		A2(
			_elm_lang$core$Basics_ops['++'],
			'LocEqn.locEquationToPoly can only handle Plus/Minus/Mult/Div, got ',
			_elm_lang$core$Basics$toString(locEqn)));
};
var _user$project$LocEqn$NormPolyTopLevelAdd = function (a) {
	return {ctor: 'NormPolyTopLevelAdd', _0: a};
};
var _user$project$LocEqn$NormPolyMult = F2(
	function (a, b) {
		return {ctor: 'NormPolyMult', _0: a, _1: b};
	});
var _user$project$LocEqn$normPolyAddTerm = F2(
	function (normPolyMultTerm, normPolyMultTerms) {
		var _p76 = normPolyMultTerm;
		var aCoeff = _p76._0;
		var aPowTerms = _p76._1;
		var maybeMatchingTermRemoved = A2(
			_user$project$Utils$maybeFindAndRemoveFirst,
			function (_p77) {
				var _p78 = _p77;
				return A2(_user$project$LocEqn$normPolyPowTermsCompatible, aPowTerms, _p78._1);
			},
			normPolyMultTerms);
		var results = function () {
			var _p79 = maybeMatchingTermRemoved;
			if (_p79.ctor === 'Just') {
				var _p81 = _p79._0._1;
				var _p80 = _p79._0._0._0;
				return _elm_lang$core$Native_Utils.eq(aCoeff + _p80, 0) ? _p81 : {
					ctor: '::',
					_0: A2(_user$project$LocEqn$NormPolyMult, aCoeff + _p80, _p79._0._0._1),
					_1: _p81
				};
			} else {
				return {ctor: '::', _0: normPolyMultTerm, _1: normPolyMultTerms};
			}
		}();
		return results;
	});
var _user$project$LocEqn$normPolyMultScalarMult = F2(
	function (coeff, _p82) {
		var _p83 = _p82;
		return A2(_user$project$LocEqn$NormPolyMult, coeff * _p83._0, _p83._1);
	});
var _user$project$LocEqn$NormPolyPow = F2(
	function (a, b) {
		return {ctor: 'NormPolyPow', _0: a, _1: b};
	});
var _user$project$LocEqn$NormPolyLoc = function (a) {
	return {ctor: 'NormPolyLoc', _0: a};
};
var _user$project$LocEqn$NormPolyAdd = function (a) {
	return {ctor: 'NormPolyAdd', _0: a};
};
var _user$project$LocEqn$polyZero = _user$project$LocEqn$NormPolyAdd(
	{
		ctor: '::',
		_0: A2(
			_user$project$LocEqn$NormPolyMult,
			0,
			{ctor: '[]'}),
		_1: {ctor: '[]'}
	});
var _user$project$LocEqn$polyOne = _user$project$LocEqn$NormPolyAdd(
	{
		ctor: '::',
		_0: A2(
			_user$project$LocEqn$NormPolyMult,
			1,
			{ctor: '[]'}),
		_1: {ctor: '[]'}
	});
var _user$project$LocEqn$multTerms = function (normPolyAdd) {
	var _p84 = normPolyAdd;
	if (_p84.ctor === 'NormPolyAdd') {
		return _p84._0;
	} else {
		return {
			ctor: '::',
			_0: A2(
				_user$project$LocEqn$NormPolyMult,
				1,
				{
					ctor: '::',
					_0: A2(
						_user$project$LocEqn$NormPolyPow,
						_user$project$LocEqn$NormPolyLoc(_p84._0),
						_user$project$LocEqn$polyOne),
					_1: {ctor: '[]'}
				}),
			_1: {ctor: '[]'}
		};
	}
};
var _user$project$LocEqn$polyConst = function (n) {
	return _user$project$LocEqn$NormPolyAdd(
		{
			ctor: '::',
			_0: A2(
				_user$project$LocEqn$NormPolyMult,
				n,
				{ctor: '[]'}),
			_1: {ctor: '[]'}
		});
};
var _user$project$LocEqn$polyLoc = function (locId) {
	return _user$project$LocEqn$NormPolyAdd(
		{
			ctor: '::',
			_0: A2(
				_user$project$LocEqn$NormPolyMult,
				1,
				{
					ctor: '::',
					_0: A2(
						_user$project$LocEqn$NormPolyPow,
						_user$project$LocEqn$NormPolyLoc(locId),
						_user$project$LocEqn$polyOne),
					_1: {ctor: '[]'}
				}),
			_1: {ctor: '[]'}
		});
};
var _user$project$LocEqn$normPolyAddToNormPoly = function (normPolyAdd) {
	normPolyAddToNormPoly:
	while (true) {
		var _p85 = normPolyAdd;
		if (_p85.ctor === 'NormPolyLoc') {
			var _v47 = _user$project$LocEqn$polyLoc(_p85._0);
			normPolyAdd = _v47;
			continue normPolyAddToNormPoly;
		} else {
			return _user$project$LocEqn$NormPolyTopLevelAdd(_p85._0);
		}
	}
};
var _user$project$LocEqn$normPolyAdd = F2(
	function (aNormPolyAdd, bNormPolyAdd) {
		normPolyAdd:
		while (true) {
			var _p86 = {ctor: '_Tuple2', _0: aNormPolyAdd, _1: bNormPolyAdd};
			if (_p86._0.ctor === 'NormPolyLoc') {
				var _v49 = _user$project$LocEqn$polyLoc(_p86._0._0),
					_v50 = bNormPolyAdd;
				aNormPolyAdd = _v49;
				bNormPolyAdd = _v50;
				continue normPolyAdd;
			} else {
				if (_p86._1.ctor === 'NormPolyLoc') {
					var _v51 = aNormPolyAdd,
						_v52 = _user$project$LocEqn$polyLoc(_p86._1._0);
					aNormPolyAdd = _v51;
					bNormPolyAdd = _v52;
					continue normPolyAdd;
				} else {
					return _user$project$LocEqn$NormPolyAdd(
						A3(
							_elm_lang$core$List$foldl,
							_user$project$LocEqn$normPolyAddTerm,
							{ctor: '[]'},
							A2(_elm_lang$core$Basics_ops['++'], _p86._0._0, _p86._1._0)));
				}
			}
		}
	});
var _user$project$LocEqn$normPolyMultPowTermWithPowTerms = F2(
	function (normPolyPowTerm, normPolyPowTerms) {
		var _p87 = normPolyPowTerm;
		_v53_5:
		do {
			_v53_3:
			do {
				_v53_2:
				do {
					_v53_1:
					do {
						if (_p87._1.ctor === 'NormPolyAdd') {
							if (_p87._1._0.ctor === '[]') {
								return normPolyPowTerms;
							} else {
								if (_p87._0.ctor === 'NormPolyAdd') {
									if (_p87._0._0.ctor === '[]') {
										if (((_p87._1._0._0._0 === 0) && (_p87._1._0._0._1.ctor === '[]')) && (_p87._1._0._1.ctor === '[]')) {
											break _v53_1;
										} else {
											break _v53_2;
										}
									} else {
										if ((_p87._1._0._0._1.ctor === '[]') && (_p87._1._0._1.ctor === '[]')) {
											if ((_p87._0._0._0._1.ctor === '[]') && (_p87._0._0._1.ctor === '[]')) {
												if (_p87._1._0._0._0 === 0) {
													break _v53_1;
												} else {
													if (_p87._0._0._0._0 === 0) {
														break _v53_3;
													} else {
														var _p88 = A2(
															_elm_lang$core$List$partition,
															function (powTerm) {
																var _p89 = powTerm;
																if ((((((((_p89._0.ctor === 'NormPolyAdd') && (_p89._0._0.ctor === '::')) && (_p89._0._0._0._1.ctor === '[]')) && (_p89._0._0._1.ctor === '[]')) && (_p89._1.ctor === 'NormPolyAdd')) && (_p89._1._0.ctor === '::')) && (_p89._1._0._0._1.ctor === '[]')) && (_p89._1._0._1.ctor === '[]')) {
																	return true;
																} else {
																	return false;
																}
															},
															normPolyPowTerms);
														var constantPowTerms = _p88._0;
														var otherPowTerms = _p88._1;
														var constant = _elm_lang$core$List$product(
															A2(
																_elm_lang$core$List$map,
																function (powTerm) {
																	var _p90 = powTerm;
																	if ((((((((_p90._0.ctor === 'NormPolyAdd') && (_p90._0._0.ctor === '::')) && (_p90._0._0._0._1.ctor === '[]')) && (_p90._0._0._1.ctor === '[]')) && (_p90._1.ctor === 'NormPolyAdd')) && (_p90._1._0.ctor === '::')) && (_p90._1._0._0._1.ctor === '[]')) && (_p90._1._0._1.ctor === '[]')) {
																		return Math.pow(_p90._0._0._0._0, _p90._1._0._0._0);
																	} else {
																		return _elm_lang$core$Native_Utils.crashCase(
																			'LocEqn',
																			{
																				start: {line: 402, column: 15},
																				end: {line: 404, column: 124}
																			},
																			_p90)(
																			A2(
																				_elm_lang$core$Basics_ops['++'],
																				'LocEqn.normPolyMultPowTermWithPowTerms shouldn\'t get here, got ',
																				_elm_lang$core$Basics$toString(powTerm)));
																	}
																},
																{ctor: '::', _0: normPolyPowTerm, _1: constantPowTerms}));
														return _elm_lang$core$Native_Utils.eq(constant, 0) ? {
															ctor: '::',
															_0: A2(_user$project$LocEqn$NormPolyPow, _user$project$LocEqn$polyZero, _user$project$LocEqn$polyOne),
															_1: {ctor: '[]'}
														} : {
															ctor: '::',
															_0: A2(
																_user$project$LocEqn$NormPolyPow,
																_user$project$LocEqn$polyConst(constant),
																_user$project$LocEqn$polyOne),
															_1: otherPowTerms
														};
													}
												}
											} else {
												if (_p87._1._0._0._0 === 0) {
													break _v53_1;
												} else {
													break _v53_5;
												}
											}
										} else {
											if (((_p87._0._0._0._0 === 0) && (_p87._0._0._0._1.ctor === '[]')) && (_p87._0._0._1.ctor === '[]')) {
												break _v53_3;
											} else {
												break _v53_5;
											}
										}
									}
								} else {
									if (((_p87._1._0._0._0 === 0) && (_p87._1._0._0._1.ctor === '[]')) && (_p87._1._0._1.ctor === '[]')) {
										break _v53_1;
									} else {
										break _v53_5;
									}
								}
							}
						} else {
							if (_p87._0.ctor === 'NormPolyAdd') {
								if (_p87._0._0.ctor === '[]') {
									break _v53_2;
								} else {
									if (((_p87._0._0._0._0 === 0) && (_p87._0._0._0._1.ctor === '[]')) && (_p87._0._0._1.ctor === '[]')) {
										break _v53_3;
									} else {
										break _v53_5;
									}
								}
							} else {
								break _v53_5;
							}
						}
					} while(false);
					return normPolyPowTerms;
				} while(false);
				return {
					ctor: '::',
					_0: A2(_user$project$LocEqn$NormPolyPow, _user$project$LocEqn$polyZero, _user$project$LocEqn$polyOne),
					_1: {ctor: '[]'}
				};
			} while(false);
			return {
				ctor: '::',
				_0: A2(_user$project$LocEqn$NormPolyPow, _user$project$LocEqn$polyZero, _user$project$LocEqn$polyOne),
				_1: {ctor: '[]'}
			};
		} while(false);
		var _p92 = normPolyPowTerm;
		var termBase = _p92._0;
		var termExponent = _p92._1;
		var maybeMatchingTermRemoved = A2(
			_user$project$Utils$maybeFindAndRemoveFirst,
			function (_p93) {
				var _p94 = _p93;
				return _elm_lang$core$Native_Utils.eq(termBase, _p94._0);
			},
			normPolyPowTerms);
		var _p95 = maybeMatchingTermRemoved;
		if (_p95.ctor === 'Just') {
			var _p97 = _p95._0._1;
			var newExponent = A2(_user$project$LocEqn$normPolyAdd, termExponent, _p95._0._0._1);
			var _p96 = newExponent;
			_v58_2:
			do {
				if (_p96.ctor === 'NormPolyAdd') {
					if (_p96._0.ctor === '[]') {
						return _p97;
					} else {
						if (((_p96._0._0._0 === 0) && (_p96._0._0._1.ctor === '[]')) && (_p96._0._1.ctor === '[]')) {
							return _p97;
						} else {
							break _v58_2;
						}
					}
				} else {
					break _v58_2;
				}
			} while(false);
			return {
				ctor: '::',
				_0: A2(_user$project$LocEqn$NormPolyPow, _p95._0._0._0, newExponent),
				_1: _p97
			};
		} else {
			return {ctor: '::', _0: normPolyPowTerm, _1: normPolyPowTerms};
		}
	});
var _user$project$LocEqn$normPolyMultPowTermWithMultTerm = F2(
	function (normPolyPowTerm, _p98) {
		var _p99 = _p98;
		var _p100 = _p99._0;
		return _elm_lang$core$Native_Utils.eq(_p100, 0) ? A2(
			_user$project$LocEqn$NormPolyMult,
			0,
			{ctor: '[]'}) : A2(
			_user$project$LocEqn$NormPolyMult,
			_p100,
			A3(
				_elm_lang$core$List$foldl,
				_user$project$LocEqn$normPolyMultPowTermWithPowTerms,
				{
					ctor: '::',
					_0: normPolyPowTerm,
					_1: {ctor: '[]'}
				},
				_p99._1));
	});
var _user$project$LocEqn$normPolyMultPowTerm = F2(
	function (normPolyPowTerm, normPolyMultTerms) {
		return A2(
			_elm_lang$core$List$map,
			_user$project$LocEqn$normPolyMultPowTermWithMultTerm(normPolyPowTerm),
			normPolyMultTerms);
	});
var _user$project$LocEqn$normPolyMultTerm = F2(
	function (normPolyMultTerm, normPolyMultTerms) {
		var _p101 = normPolyMultTerm;
		var aCoeff = _p101._0;
		var aPowTerms = _p101._1;
		return _elm_lang$core$Native_Utils.eq(aCoeff, 0) ? {ctor: '[]'} : A2(
			_elm_lang$core$List$map,
			_user$project$LocEqn$normPolyMultScalarMult(aCoeff),
			A3(_elm_lang$core$List$foldl, _user$project$LocEqn$normPolyMultPowTerm, normPolyMultTerms, aPowTerms));
	});
var _user$project$LocEqn$topLevelPolyDistribute = F2(
	function (_p103, _p102) {
		var _p104 = _p103;
		var _p105 = _p102;
		var result = _user$project$LocEqn$NormPolyTopLevelAdd(
			A3(
				_elm_lang$core$List$foldl,
				_user$project$LocEqn$normPolyAddTerm,
				{ctor: '[]'},
				A2(
					_elm_lang$core$List$concatMap,
					function (aMultTerm) {
						return A2(_user$project$LocEqn$normPolyMultTerm, aMultTerm, _p105._0);
					},
					_p104._0)));
		return result;
	});
var _user$project$LocEqn$normPolyToNormPolyAdd = function (_p106) {
	var _p107 = _p106;
	return _user$project$LocEqn$NormPolyAdd(_p107._0);
};
var _user$project$LocEqn$polyScalarMult = F2(
	function (coeff, normPolyAdd) {
		var result = function () {
			var _p108 = normPolyAdd;
			if (_p108.ctor === 'NormPolyAdd') {
				return _elm_lang$core$Native_Utils.eq(coeff, 0) ? _user$project$LocEqn$polyZero : _user$project$LocEqn$NormPolyAdd(
					A2(
						_elm_lang$core$List$map,
						_user$project$LocEqn$normPolyMultScalarMult(coeff),
						_p108._0));
			} else {
				return _user$project$LocEqn$NormPolyAdd(
					{
						ctor: '::',
						_0: A2(
							_user$project$LocEqn$NormPolyMult,
							coeff,
							{
								ctor: '::',
								_0: A2(
									_user$project$LocEqn$NormPolyPow,
									_user$project$LocEqn$NormPolyLoc(_p108._0),
									_user$project$LocEqn$polyOne),
								_1: {ctor: '[]'}
							}),
						_1: {ctor: '[]'}
					});
			}
		}();
		return result;
	});
var _user$project$LocEqn$topLevelPolyScalarMult = F2(
	function (coeff, _p109) {
		var _p110 = _p109;
		return _user$project$LocEqn$normPolyAddToNormPoly(
			A2(
				_user$project$LocEqn$polyScalarMult,
				coeff,
				_user$project$LocEqn$NormPolyAdd(_p110._0)));
	});
var _user$project$LocEqn$normPolyToPoly = function (_p111) {
	var _p112 = _p111;
	return _user$project$LocEqn$normPolyAddToPoly(
		_user$project$LocEqn$NormPolyAdd(_p112._0));
};
var _user$project$LocEqn$normPolyToString = function (_p113) {
	return _user$project$LocEqn$polyToString(
		_user$project$LocEqn$normPolyToPoly(_p113));
};
var _user$project$LocEqn$normPolyAddSort = function (normPolyAdd) {
	var _p114 = normPolyAdd;
	if (_p114.ctor === 'NormPolyLoc') {
		return normPolyAdd;
	} else {
		return _user$project$LocEqn$NormPolyAdd(
			A2(
				_elm_lang$core$List$sortBy,
				_user$project$LocEqn$normPolyMultTermSortKey,
				A2(_elm_lang$core$List$map, _user$project$LocEqn$normPolyMultSort, _p114._0)));
	}
};
var _user$project$LocEqn$normPolyMultSort = function (_p115) {
	var _p116 = _p115;
	return A2(
		_user$project$LocEqn$NormPolyMult,
		_p116._0,
		A2(
			_elm_lang$core$List$sortBy,
			_user$project$LocEqn$normPolyPowSortKey,
			A2(_elm_lang$core$List$map, _user$project$LocEqn$normPolyPowSort, _p116._1)));
};
var _user$project$LocEqn$normPolyPowSort = function (_p117) {
	var _p118 = _p117;
	return A2(
		_user$project$LocEqn$NormPolyPow,
		_user$project$LocEqn$normPolyAddSort(_p118._0),
		_user$project$LocEqn$normPolyAddSort(_p118._1));
};
var _user$project$LocEqn$normPolySort = function (_p119) {
	var _p120 = _p119;
	return _user$project$LocEqn$NormPolyTopLevelAdd(
		A2(
			_elm_lang$core$List$sortBy,
			_user$project$LocEqn$normPolyMultTermSortKey,
			A2(_elm_lang$core$List$map, _user$project$LocEqn$normPolyMultSort, _p120._0)));
};
var _user$project$LocEqn$polyNorm = function (poly) {
	var result = function () {
		var _p121 = poly;
		switch (_p121.ctor) {
			case 'PolyAdd':
				if (_p121._0.ctor === '[]') {
					return _user$project$LocEqn$normPolyAddToNormPoly(_user$project$LocEqn$polyZero);
				} else {
					return _user$project$LocEqn$NormPolyTopLevelAdd(
						A3(
							_elm_lang$core$List$foldl,
							_user$project$LocEqn$normPolyAddTerm,
							{ctor: '[]'},
							A2(
								_elm_lang$core$List$concatMap,
								_user$project$LocEqn$topLevelMultTerms,
								A2(_elm_lang$core$List$map, _user$project$LocEqn$polyNorm, _p121._0))));
				}
			case 'PolyMult':
				if (_p121._1.ctor === '[]') {
					return _user$project$LocEqn$NormPolyTopLevelAdd(
						{
							ctor: '::',
							_0: A2(
								_user$project$LocEqn$NormPolyMult,
								_p121._0,
								{ctor: '[]'}),
							_1: {ctor: '[]'}
						});
				} else {
					return A3(
						_elm_lang$core$List$foldl,
						_user$project$LocEqn$topLevelPolyDistribute,
						_user$project$LocEqn$normPolyAddToNormPoly(_user$project$LocEqn$polyOne),
						A2(
							_elm_lang$core$List$map,
							_user$project$LocEqn$topLevelPolyScalarMult(_p121._0),
							A2(_elm_lang$core$List$map, _user$project$LocEqn$polyNorm, _p121._1)));
				}
			case 'PolyPow':
				var _p122 = {
					ctor: '_Tuple2',
					_0: _user$project$LocEqn$polyNorm(_p121._0),
					_1: _user$project$LocEqn$polyNorm(_p121._1)
				};
				var normBase = _p122._0;
				var normExpon = _p122._1;
				var _p123 = {ctor: '_Tuple2', _0: normBase, _1: normExpon};
				_v71_12:
				do {
					_v71_4:
					do {
						_v71_3:
						do {
							_v71_2:
							do {
								_v71_1:
								do {
									if (_p123.ctor === '_Tuple2') {
										if (_p123._1._0.ctor === '[]') {
											return _user$project$LocEqn$normPolyAddToNormPoly(_user$project$LocEqn$polyOne);
										} else {
											if ((_p123._1._0._0._1.ctor === '[]') && (_p123._1._0._1.ctor === '[]')) {
												if (_p123._0._0.ctor === '[]') {
													switch (_p123._1._0._0._0) {
														case 0:
															break _v71_1;
														case 1:
															break _v71_2;
														default:
															break _v71_3;
													}
												} else {
													if (_p123._0._0._1.ctor === '[]') {
														if (_p123._0._0._0._1.ctor === '[]') {
															switch (_p123._1._0._0._0) {
																case 0:
																	break _v71_1;
																case 1:
																	break _v71_2;
																default:
																	if (_p123._0._0._0._0 === 0) {
																		break _v71_4;
																	} else {
																		return _user$project$LocEqn$normPolyAddToNormPoly(
																			_user$project$LocEqn$polyConst(
																				Math.pow(_p123._0._0._0._0, _p123._1._0._0._0)));
																	}
															}
														} else {
															if (_p123._0._0._0._1._1.ctor === '[]') {
																switch (_p123._1._0._0._0) {
																	case 0:
																		break _v71_1;
																	case 1:
																		break _v71_2;
																	default:
																		var _p124 = _p123._1._0._0._0;
																		return _user$project$LocEqn$NormPolyTopLevelAdd(
																			{
																				ctor: '::',
																				_0: A2(
																					_user$project$LocEqn$NormPolyMult,
																					Math.pow(_p123._0._0._0._0, _p124),
																					{
																						ctor: '::',
																						_0: A2(
																							_user$project$LocEqn$NormPolyPow,
																							_p123._0._0._0._1._0._0,
																							A2(_user$project$LocEqn$polyScalarMult, _p124, _p123._0._0._0._1._0._1)),
																						_1: {ctor: '[]'}
																					}),
																				_1: {ctor: '[]'}
																			});
																}
															} else {
																if (_p123._0._0._0._1._1._1.ctor === '[]') {
																	switch (_p123._1._0._0._0) {
																		case 0:
																			break _v71_1;
																		case 1:
																			break _v71_2;
																		default:
																			var _p125 = _p123._1._0._0._0;
																			return _user$project$LocEqn$NormPolyTopLevelAdd(
																				{
																					ctor: '::',
																					_0: A2(
																						_user$project$LocEqn$NormPolyMult,
																						Math.pow(_p123._0._0._0._0, _p125),
																						{
																							ctor: '::',
																							_0: A2(
																								_user$project$LocEqn$NormPolyPow,
																								_p123._0._0._0._1._0._0,
																								A2(_user$project$LocEqn$polyScalarMult, _p125, _p123._0._0._0._1._0._1)),
																							_1: {
																								ctor: '::',
																								_0: A2(
																									_user$project$LocEqn$NormPolyPow,
																									_p123._0._0._0._1._1._0._0,
																									A2(_user$project$LocEqn$polyScalarMult, _p125, _p123._0._0._0._1._1._0._1)),
																								_1: {ctor: '[]'}
																							}
																						}),
																					_1: {ctor: '[]'}
																				});
																	}
																} else {
																	if (_p123._0._0._0._1._1._1._1.ctor === '[]') {
																		switch (_p123._1._0._0._0) {
																			case 0:
																				break _v71_1;
																			case 1:
																				break _v71_2;
																			default:
																				var _p126 = _p123._1._0._0._0;
																				return _user$project$LocEqn$NormPolyTopLevelAdd(
																					{
																						ctor: '::',
																						_0: A2(
																							_user$project$LocEqn$NormPolyMult,
																							Math.pow(_p123._0._0._0._0, _p126),
																							{
																								ctor: '::',
																								_0: A2(
																									_user$project$LocEqn$NormPolyPow,
																									_p123._0._0._0._1._0._0,
																									A2(_user$project$LocEqn$polyScalarMult, _p126, _p123._0._0._0._1._0._1)),
																								_1: {
																									ctor: '::',
																									_0: A2(
																										_user$project$LocEqn$NormPolyPow,
																										_p123._0._0._0._1._1._0._0,
																										A2(_user$project$LocEqn$polyScalarMult, _p126, _p123._0._0._0._1._1._0._1)),
																									_1: {
																										ctor: '::',
																										_0: A2(
																											_user$project$LocEqn$NormPolyPow,
																											_p123._0._0._0._1._1._1._0._0,
																											A2(_user$project$LocEqn$polyScalarMult, _p126, _p123._0._0._0._1._1._1._0._1)),
																										_1: {ctor: '[]'}
																									}
																								}
																							}),
																						_1: {ctor: '[]'}
																					});
																		}
																	} else {
																		if (_p123._0._0._0._1._1._1._1._1.ctor === '[]') {
																			switch (_p123._1._0._0._0) {
																				case 0:
																					break _v71_1;
																				case 1:
																					break _v71_2;
																				default:
																					var _p127 = _p123._1._0._0._0;
																					return _user$project$LocEqn$NormPolyTopLevelAdd(
																						{
																							ctor: '::',
																							_0: A2(
																								_user$project$LocEqn$NormPolyMult,
																								Math.pow(_p123._0._0._0._0, _p127),
																								{
																									ctor: '::',
																									_0: A2(
																										_user$project$LocEqn$NormPolyPow,
																										_p123._0._0._0._1._0._0,
																										A2(_user$project$LocEqn$polyScalarMult, _p127, _p123._0._0._0._1._0._1)),
																									_1: {
																										ctor: '::',
																										_0: A2(
																											_user$project$LocEqn$NormPolyPow,
																											_p123._0._0._0._1._1._0._0,
																											A2(_user$project$LocEqn$polyScalarMult, _p127, _p123._0._0._0._1._1._0._1)),
																										_1: {
																											ctor: '::',
																											_0: A2(
																												_user$project$LocEqn$NormPolyPow,
																												_p123._0._0._0._1._1._1._0._0,
																												A2(_user$project$LocEqn$polyScalarMult, _p127, _p123._0._0._0._1._1._1._0._1)),
																											_1: {
																												ctor: '::',
																												_0: A2(
																													_user$project$LocEqn$NormPolyPow,
																													_p123._0._0._0._1._1._1._1._0._0,
																													A2(_user$project$LocEqn$polyScalarMult, _p127, _p123._0._0._0._1._1._1._1._0._1)),
																												_1: {ctor: '[]'}
																											}
																										}
																									}
																								}),
																							_1: {ctor: '[]'}
																						});
																			}
																		} else {
																			switch (_p123._1._0._0._0) {
																				case 0:
																					break _v71_1;
																				case 1:
																					break _v71_2;
																				default:
																					if (_p123._0._0._0._1._1._1._1._1._1.ctor === '[]') {
																						var _p128 = _p123._1._0._0._0;
																						return _user$project$LocEqn$NormPolyTopLevelAdd(
																							{
																								ctor: '::',
																								_0: A2(
																									_user$project$LocEqn$NormPolyMult,
																									Math.pow(_p123._0._0._0._0, _p128),
																									{
																										ctor: '::',
																										_0: A2(
																											_user$project$LocEqn$NormPolyPow,
																											_p123._0._0._0._1._0._0,
																											A2(_user$project$LocEqn$polyScalarMult, _p128, _p123._0._0._0._1._0._1)),
																										_1: {
																											ctor: '::',
																											_0: A2(
																												_user$project$LocEqn$NormPolyPow,
																												_p123._0._0._0._1._1._0._0,
																												A2(_user$project$LocEqn$polyScalarMult, _p128, _p123._0._0._0._1._1._0._1)),
																											_1: {
																												ctor: '::',
																												_0: A2(
																													_user$project$LocEqn$NormPolyPow,
																													_p123._0._0._0._1._1._1._0._0,
																													A2(_user$project$LocEqn$polyScalarMult, _p128, _p123._0._0._0._1._1._1._0._1)),
																												_1: {
																													ctor: '::',
																													_0: A2(
																														_user$project$LocEqn$NormPolyPow,
																														_p123._0._0._0._1._1._1._1._0._0,
																														A2(_user$project$LocEqn$polyScalarMult, _p128, _p123._0._0._0._1._1._1._1._0._1)),
																													_1: {
																														ctor: '::',
																														_0: A2(
																															_user$project$LocEqn$NormPolyPow,
																															_p123._0._0._0._1._1._1._1._1._0._0,
																															A2(_user$project$LocEqn$polyScalarMult, _p128, _p123._0._0._0._1._1._1._1._1._0._1)),
																														_1: {ctor: '[]'}
																													}
																												}
																											}
																										}
																									}),
																								_1: {ctor: '[]'}
																							});
																					} else {
																						break _v71_12;
																					}
																			}
																		}
																	}
																}
															}
														}
													} else {
														switch (_p123._1._0._0._0) {
															case 0:
																break _v71_1;
															case 1:
																break _v71_2;
															default:
																var _p129 = _p123._1._0._0._0;
																if ((_elm_lang$core$Native_Utils.cmp(_p129, 0) > 0) && _elm_lang$core$Native_Utils.eq(
																	_p129,
																	_elm_lang$core$Basics$toFloat(
																		_elm_lang$core$Basics$round(_p129)))) {
																	return _user$project$LocEqn$polyNorm(
																		A2(
																			_user$project$LocEqn$PolyMult,
																			1,
																			A2(
																				_elm_lang$core$List$repeat,
																				_elm_lang$core$Basics$round(_p129),
																				_user$project$LocEqn$normPolyToPoly(normBase))));
																} else {
																	if ((_elm_lang$core$Native_Utils.cmp(_p129, 0) < 0) && _elm_lang$core$Native_Utils.eq(
																		_p129,
																		_elm_lang$core$Basics$toFloat(
																			_elm_lang$core$Basics$round(_p129)))) {
																		var denominator = _user$project$LocEqn$polyNorm(
																			A2(
																				_user$project$LocEqn$PolyMult,
																				1,
																				A2(
																					_elm_lang$core$List$repeat,
																					_elm_lang$core$Basics$abs(
																						_elm_lang$core$Basics$round(_p129)),
																					_user$project$LocEqn$normPolyToPoly(normBase))));
																		return _user$project$LocEqn$NormPolyTopLevelAdd(
																			{
																				ctor: '::',
																				_0: A2(
																					_user$project$LocEqn$NormPolyMult,
																					1,
																					{
																						ctor: '::',
																						_0: A2(
																							_user$project$LocEqn$NormPolyPow,
																							_user$project$LocEqn$normPolyToNormPolyAdd(denominator),
																							_user$project$LocEqn$polyConst(-1)),
																						_1: {ctor: '[]'}
																					}),
																				_1: {ctor: '[]'}
																			});
																	} else {
																		return _user$project$LocEqn$NormPolyTopLevelAdd(
																			{
																				ctor: '::',
																				_0: A2(
																					_user$project$LocEqn$NormPolyMult,
																					1,
																					{
																						ctor: '::',
																						_0: A2(
																							_user$project$LocEqn$NormPolyPow,
																							_user$project$LocEqn$normPolyToNormPolyAdd(normBase),
																							_user$project$LocEqn$normPolyToNormPolyAdd(normExpon)),
																						_1: {ctor: '[]'}
																					}),
																				_1: {ctor: '[]'}
																			});
																	}
																}
														}
													}
												}
											} else {
												if (_p123._0._0.ctor === '[]') {
													break _v71_3;
												} else {
													if (((_p123._0._0._0._0 === 0) && (_p123._0._0._0._1.ctor === '[]')) && (_p123._0._0._1.ctor === '[]')) {
														break _v71_4;
													} else {
														break _v71_12;
													}
												}
											}
										}
									} else {
										break _v71_12;
									}
								} while(false);
								return _user$project$LocEqn$normPolyAddToNormPoly(_user$project$LocEqn$polyOne);
							} while(false);
							return normBase;
						} while(false);
						return _user$project$LocEqn$normPolyAddToNormPoly(_user$project$LocEqn$polyZero);
					} while(false);
					return _user$project$LocEqn$normPolyAddToNormPoly(_user$project$LocEqn$polyZero);
				} while(false);
				return _user$project$LocEqn$NormPolyTopLevelAdd(
					{
						ctor: '::',
						_0: A2(
							_user$project$LocEqn$NormPolyMult,
							1,
							{
								ctor: '::',
								_0: A2(
									_user$project$LocEqn$NormPolyPow,
									_user$project$LocEqn$normPolyToNormPolyAdd(normBase),
									_user$project$LocEqn$normPolyToNormPolyAdd(normExpon)),
								_1: {ctor: '[]'}
							}),
						_1: {ctor: '[]'}
					});
			default:
				return _user$project$LocEqn$NormPolyTopLevelAdd(
					{
						ctor: '::',
						_0: A2(
							_user$project$LocEqn$NormPolyMult,
							1,
							{
								ctor: '::',
								_0: A2(
									_user$project$LocEqn$NormPolyPow,
									_user$project$LocEqn$NormPolyLoc(_p121._0),
									_user$project$LocEqn$polyOne),
								_1: {ctor: '[]'}
							}),
						_1: {ctor: '[]'}
					});
		}
	}();
	return _user$project$LocEqn$normPolySort(result);
};
var _user$project$LocEqn$normPolyPowToLocEquation = function (_p130) {
	var _p131 = _p130;
	var _p136 = _p131._1;
	var _p135 = _p131._0;
	var _p132 = _p136;
	_v73_4:
	do {
		if (_p132.ctor === 'NormPolyAdd') {
			if (_p132._0.ctor === '[]') {
				return _user$project$LocEqn$LocEqnConst(1);
			} else {
				if ((_p132._0._0._1.ctor === '[]') && (_p132._0._1.ctor === '[]')) {
					switch (_p132._0._0._0) {
						case 0:
							return _user$project$LocEqn$LocEqnConst(1);
						case 1:
							return _user$project$LocEqn$normPolyAddToLocEquation(_p135);
						default:
							var _p133 = _p132._0._0._0;
							return ((_elm_lang$core$Native_Utils.cmp(_p133, 1) > 0) && _elm_lang$core$Native_Utils.eq(
								_p133,
								_elm_lang$core$Basics$toFloat(
									_elm_lang$core$Basics$round(_p133)))) ? A2(
								_user$project$LocEqn$LocEqnOp,
								_user$project$Lang$Mult,
								{
									ctor: '::',
									_0: _user$project$LocEqn$normPolyAddToLocEquation(_p135),
									_1: {
										ctor: '::',
										_0: _user$project$LocEqn$normPolyPowToLocEquation(
											A2(
												_user$project$LocEqn$NormPolyPow,
												_p135,
												_user$project$LocEqn$NormPolyAdd(
													{
														ctor: '::',
														_0: A2(
															_user$project$LocEqn$NormPolyMult,
															_elm_lang$core$Basics$toFloat(
																_elm_lang$core$Basics$round(_p133)) - 1,
															{ctor: '[]'}),
														_1: {ctor: '[]'}
													}))),
										_1: {ctor: '[]'}
									}
								}) : _elm_lang$core$Native_Utils.crash(
								'LocEqn',
								{
									start: {line: 818, column: 9},
									end: {line: 818, column: 20}
								})(
								A2(
									_elm_lang$core$Basics_ops['++'],
									'LocEqn.normPolyPowToLocEquation unexpected exponent: should only be positive integers >1 by now: got ',
									_elm_lang$core$Basics$toString(
										A2(_user$project$LocEqn$NormPolyPow, _p135, _p136))));
					}
				} else {
					break _v73_4;
				}
			}
		} else {
			break _v73_4;
		}
	} while(false);
	return _elm_lang$core$Native_Utils.crashCase(
		'LocEqn',
		{
			start: {line: 801, column: 3},
			end: {line: 821, column: 169}
		},
		_p132)(
		A2(
			_elm_lang$core$Basics_ops['++'],
			'LocEqn.normPolyPowToLocEquation can\'t handle non-integer, non-constant powers yet: got ',
			_elm_lang$core$Basics$toString(
				A2(_user$project$LocEqn$NormPolyPow, _p135, _p136))));
};
var _user$project$LocEqn$normPolyAddToLocEquation = function (normPolyAdd) {
	var _p137 = normPolyAdd;
	if (_p137.ctor === 'NormPolyLoc') {
		return _user$project$LocEqn$LocEqnLoc(_p137._0);
	} else {
		var _p145 = _p137._0;
		var _p138 = _p145;
		if (_p138.ctor === '[]') {
			return _user$project$LocEqn$LocEqnConst(0);
		} else {
			if (_p138._1.ctor === '[]') {
				return _user$project$LocEqn$normPolyMultToLocEquation(_p138._0);
			} else {
				var _p139 = A2(
					_elm_lang$core$List$partition,
					function (_p140) {
						var _p141 = _p140;
						return _elm_lang$core$Native_Utils.cmp(_p141._0, 0) < 0;
					},
					_p145);
				var negativeTerms = _p139._0;
				var nonNegativeTerms = _p139._1;
				var _p142 = {ctor: '_Tuple2', _0: negativeTerms, _1: nonNegativeTerms};
				if (_p142._1.ctor === '::') {
					if (_p142._1._1.ctor === '::') {
						var remainingTerms = {
							ctor: '::',
							_0: _p142._1._1._0,
							_1: A2(_elm_lang$core$Basics_ops['++'], _p142._1._1._1, negativeTerms)
						};
						return A2(
							_user$project$LocEqn$LocEqnOp,
							_user$project$Lang$Plus,
							{
								ctor: '::',
								_0: _user$project$LocEqn$normPolyMultToLocEquation(_p142._1._0),
								_1: {
									ctor: '::',
									_0: _user$project$LocEqn$normPolyAddToLocEquation(
										_user$project$LocEqn$NormPolyAdd(remainingTerms)),
									_1: {ctor: '[]'}
								}
							});
					} else {
						if (_p142._0.ctor === '::') {
							var negNegativeTerms = A2(
								_elm_lang$core$List$map,
								_user$project$LocEqn$normPolyMultScalarMult(-1),
								negativeTerms);
							return A2(
								_user$project$LocEqn$LocEqnOp,
								_user$project$Lang$Minus,
								{
									ctor: '::',
									_0: _user$project$LocEqn$normPolyMultToLocEquation(_p142._1._0),
									_1: {
										ctor: '::',
										_0: _user$project$LocEqn$normPolyAddToLocEquation(
											_user$project$LocEqn$NormPolyAdd(negNegativeTerms)),
										_1: {ctor: '[]'}
									}
								});
						} else {
							return _elm_lang$core$Native_Utils.crashCase(
								'LocEqn',
								{
									start: {line: 711, column: 11},
									end: {line: 730, column: 122}
								},
								_p142)('LocEqn.normPolyAddToLocEquation shouldn\'t get here; single term handled in earlier case statement');
						}
					}
				} else {
					if (_p142._0.ctor === '::') {
						return A2(
							_user$project$LocEqn$LocEqnOp,
							_user$project$Lang$Plus,
							{
								ctor: '::',
								_0: _user$project$LocEqn$normPolyMultToLocEquation(_p138._0),
								_1: {
									ctor: '::',
									_0: _user$project$LocEqn$normPolyAddToLocEquation(
										_user$project$LocEqn$NormPolyAdd(_p138._1)),
									_1: {ctor: '[]'}
								}
							});
					} else {
						return _elm_lang$core$Native_Utils.crashCase(
							'LocEqn',
							{
								start: {line: 711, column: 11},
								end: {line: 730, column: 122}
							},
							_p142)('LocEqn.normPolyAddToLocEquation shouldn\'t get here; empty term list in earlier case statement');
					}
				}
			}
		}
	}
};
var _user$project$LocEqn$normPolyMultToLocEquation = function (_p146) {
	var _p147 = _p146;
	var _p165 = _p147._0;
	var isNegativeExponent = function (_p148) {
		var _p149 = _p148;
		var _p150 = _p149._1;
		if ((((_p150.ctor === 'NormPolyAdd') && (_p150._0.ctor === '::')) && (_p150._0._0._1.ctor === '[]')) && (_p150._0._1.ctor === '[]')) {
			return _elm_lang$core$Native_Utils.cmp(_p150._0._0._0, 0) < 0;
		} else {
			return false;
		}
	};
	var isZeroExponent = function (_p151) {
		var _p152 = _p151;
		var _p153 = _p152._1;
		_v82_2:
		do {
			if (_p153.ctor === 'NormPolyAdd') {
				if (_p153._0.ctor === '[]') {
					return true;
				} else {
					if ((_p153._0._0._1.ctor === '[]') && (_p153._0._1.ctor === '[]')) {
						return _elm_lang$core$Native_Utils.eq(_p153._0._0._0, 0);
					} else {
						break _v82_2;
					}
				}
			} else {
				break _v82_2;
			}
		} while(false);
		return false;
	};
	var _p154 = A2(_elm_lang$core$List$partition, isZeroExponent, _p147._1);
	var zeroPowers = _p154._0;
	var remainingTerms = _p154._1;
	var _p155 = A2(_elm_lang$core$List$partition, isNegativeExponent, remainingTerms);
	var negativePowers = _p155._0;
	var otherPowers = _p155._1;
	var flipExponentSign = function (_p156) {
		var _p157 = _p156;
		var _p161 = _p157._1;
		var _p160 = _p157._0;
		var _p158 = _p161;
		if ((((_p158.ctor === 'NormPolyAdd') && (_p158._0.ctor === '::')) && (_p158._0._0._1.ctor === '[]')) && (_p158._0._1.ctor === '[]')) {
			return A2(
				_user$project$LocEqn$NormPolyPow,
				_p160,
				_user$project$LocEqn$polyConst(0 - _p158._0._0._0));
		} else {
			return _elm_lang$core$Native_Utils.crashCase(
				'LocEqn',
				{
					start: {line: 755, column: 5},
					end: {line: 757, column: 166}
				},
				_p158)(
				A2(
					_elm_lang$core$Basics_ops['++'],
					'LocEqn.normPolyMultToLocEquation shouldn\'t reach here; got ',
					_elm_lang$core$Basics$toString(
						A2(_user$project$LocEqn$NormPolyPow, _p160, _p161))));
		}
	};
	var _p162 = {ctor: '_Tuple3', _0: negativePowers, _1: otherPowers, _2: _p165};
	_v85_1:
	do {
		_v85_0:
		do {
			if (_p162._0.ctor === '::') {
				if (_p162._2 === 0) {
					break _v85_0;
				} else {
					return A2(
						_user$project$LocEqn$LocEqnOp,
						_user$project$Lang$Div,
						{
							ctor: '::',
							_0: _user$project$LocEqn$normPolyMultToLocEquation(
								A2(_user$project$LocEqn$NormPolyMult, _p165, otherPowers)),
							_1: {
								ctor: '::',
								_0: _user$project$LocEqn$normPolyMultToLocEquation(
									A2(
										_user$project$LocEqn$NormPolyMult,
										1,
										A2(_elm_lang$core$List$map, flipExponentSign, negativePowers))),
								_1: {ctor: '[]'}
							}
						});
				}
			} else {
				switch (_p162._2) {
					case 0:
						break _v85_0;
					case 1:
						if (_p162._1.ctor === '[]') {
							break _v85_1;
						} else {
							var _p163 = otherPowers;
							if (_p163.ctor === '::') {
								if (_p163._1.ctor === '[]') {
									return _user$project$LocEqn$normPolyPowToLocEquation(_p163._0);
								} else {
									return A2(
										_user$project$LocEqn$LocEqnOp,
										_user$project$Lang$Mult,
										{
											ctor: '::',
											_0: _user$project$LocEqn$normPolyPowToLocEquation(_p163._0),
											_1: {
												ctor: '::',
												_0: _user$project$LocEqn$normPolyMultToLocEquation(
													A2(_user$project$LocEqn$NormPolyMult, 1, _p163._1)),
												_1: {ctor: '[]'}
											}
										});
								}
							} else {
								return _elm_lang$core$Native_Utils.crashCase(
									'LocEqn',
									{
										start: {line: 774, column: 7},
										end: {line: 785, column: 112}
									},
									_p163)('LocEqn.normPolyMultToLocEquation shouldn\'t get here; should have at least some terms');
							}
						}
					default:
						if (_p162._1.ctor === '[]') {
							break _v85_1;
						} else {
							return (_elm_lang$core$Native_Utils.cmp(
								_elm_lang$core$Basics$abs(_p165),
								1) > -1) ? A2(
								_user$project$LocEqn$LocEqnOp,
								_user$project$Lang$Mult,
								{
									ctor: '::',
									_0: _user$project$LocEqn$normPolyMultToLocEquation(
										A2(_user$project$LocEqn$NormPolyMult, 1, otherPowers)),
									_1: {
										ctor: '::',
										_0: _user$project$LocEqn$LocEqnConst(_p165),
										_1: {ctor: '[]'}
									}
								}) : A2(
								_user$project$LocEqn$LocEqnOp,
								_user$project$Lang$Div,
								{
									ctor: '::',
									_0: _user$project$LocEqn$normPolyMultToLocEquation(
										A2(_user$project$LocEqn$NormPolyMult, 1, otherPowers)),
									_1: {
										ctor: '::',
										_0: _user$project$LocEqn$LocEqnConst(1 / _p165),
										_1: {ctor: '[]'}
									}
								});
						}
				}
			}
		} while(false);
		return _user$project$LocEqn$LocEqnConst(0);
	} while(false);
	return _user$project$LocEqn$LocEqnConst(_p165);
};
var _user$project$LocEqn$normPolyToLocEquation = function (_p166) {
	var _p167 = _p166;
	return _user$project$LocEqn$normPolyAddToLocEquation(
		_user$project$LocEqn$NormPolyAdd(_p167._0));
};
var _user$project$LocEqn$normalizeSimplify = function (eqn) {
	var polyEqn = _user$project$LocEqn$locEquationToPoly(eqn);
	var normPolyResult = _user$project$LocEqn$polyNorm(polyEqn);
	var littleResult = _user$project$LocEqn$normPolyToLocEquation(normPolyResult);
	return littleResult;
};
var _user$project$LocEqn$locEqnTerms = F2(
	function (targetLocId, eqn) {
		var _p168 = eqn;
		switch (_p168.ctor) {
			case 'LocEqnConst':
				return _elm_lang$core$Maybe$Just(
					{
						ctor: '_Tuple3',
						_0: 1,
						_1: _user$project$LocEqn$LocEqnConst(0),
						_2: eqn
					});
			case 'LocEqnLoc':
				return _elm_lang$core$Native_Utils.eq(_p168._0, targetLocId) ? _elm_lang$core$Maybe$Just(
					{
						ctor: '_Tuple3',
						_0: 1,
						_1: _user$project$LocEqn$LocEqnConst(1),
						_2: _user$project$LocEqn$LocEqnConst(0)
					}) : _elm_lang$core$Maybe$Just(
					{
						ctor: '_Tuple3',
						_0: 1,
						_1: _user$project$LocEqn$LocEqnConst(0),
						_2: eqn
					});
			default:
				var children_ = A2(
					_elm_lang$core$List$map,
					_user$project$LocEqn$locEqnTerms(targetLocId),
					_p168._1);
				var result = function () {
					var _p169 = children_;
					if (((((((_p169.ctor === '::') && (_p169._0.ctor === 'Just')) && (_p169._0._0.ctor === '_Tuple3')) && (_p169._1.ctor === '::')) && (_p169._1._0.ctor === 'Just')) && (_p169._1._0._0.ctor === '_Tuple3')) && (_p169._1._1.ctor === '[]')) {
						var _p178 = _p169._1._0._0._2;
						var _p177 = _p169._1._0._0._0;
						var _p176 = _p169._1._0._0._1;
						var _p175 = _p169._0._0._2;
						var _p174 = _p169._0._0._0;
						var _p173 = _p169._0._0._1;
						var _p170 = _p168._0;
						switch (_p170.ctor) {
							case 'Plus':
								return _elm_lang$core$Native_Utils.eq(_p174, _p177) ? _elm_lang$core$Maybe$Just(
									{
										ctor: '_Tuple3',
										_0: _p174,
										_1: A2(
											_user$project$LocEqn$LocEqnOp,
											_user$project$Lang$Plus,
											{
												ctor: '::',
												_0: _p173,
												_1: {
													ctor: '::',
													_0: _p176,
													_1: {ctor: '[]'}
												}
											}),
										_2: A2(
											_user$project$LocEqn$LocEqnOp,
											_user$project$Lang$Plus,
											{
												ctor: '::',
												_0: _p175,
												_1: {
													ctor: '::',
													_0: _p178,
													_1: {ctor: '[]'}
												}
											})
									}) : _elm_lang$core$Maybe$Nothing;
							case 'Minus':
								return _elm_lang$core$Native_Utils.eq(_p174, _p177) ? _elm_lang$core$Maybe$Just(
									{
										ctor: '_Tuple3',
										_0: _p174,
										_1: A2(
											_user$project$LocEqn$LocEqnOp,
											_user$project$Lang$Minus,
											{
												ctor: '::',
												_0: _p173,
												_1: {
													ctor: '::',
													_0: _p176,
													_1: {ctor: '[]'}
												}
											}),
										_2: A2(
											_user$project$LocEqn$LocEqnOp,
											_user$project$Lang$Minus,
											{
												ctor: '::',
												_0: _p175,
												_1: {
													ctor: '::',
													_0: _p178,
													_1: {ctor: '[]'}
												}
											})
									}) : _elm_lang$core$Maybe$Nothing;
							case 'Mult':
								var _p171 = {ctor: '_Tuple4', _0: _p173, _1: _p175, _2: _p176, _3: _p178};
								_v91_3:
								do {
									if (_p171.ctor === '_Tuple4') {
										if ((_p171._0.ctor === 'LocEqnConst') && (_p171._0._0 === 0)) {
											return _elm_lang$core$Maybe$Just(
												{
													ctor: '_Tuple3',
													_0: _p177,
													_1: A2(
														_user$project$LocEqn$LocEqnOp,
														_user$project$Lang$Mult,
														{
															ctor: '::',
															_0: _p175,
															_1: {
																ctor: '::',
																_0: _p176,
																_1: {ctor: '[]'}
															}
														}),
													_2: A2(
														_user$project$LocEqn$LocEqnOp,
														_user$project$Lang$Mult,
														{
															ctor: '::',
															_0: _p175,
															_1: {
																ctor: '::',
																_0: _p178,
																_1: {ctor: '[]'}
															}
														})
												});
										} else {
											if ((_p171._2.ctor === 'LocEqnConst') && (_p171._2._0 === 0)) {
												return _elm_lang$core$Maybe$Just(
													{
														ctor: '_Tuple3',
														_0: _p174,
														_1: A2(
															_user$project$LocEqn$LocEqnOp,
															_user$project$Lang$Mult,
															{
																ctor: '::',
																_0: _p173,
																_1: {
																	ctor: '::',
																	_0: _p178,
																	_1: {ctor: '[]'}
																}
															}),
														_2: A2(
															_user$project$LocEqn$LocEqnOp,
															_user$project$Lang$Mult,
															{
																ctor: '::',
																_0: _p175,
																_1: {
																	ctor: '::',
																	_0: _p178,
																	_1: {ctor: '[]'}
																}
															})
													});
											} else {
												if ((((_p171._1.ctor === 'LocEqnConst') && (_p171._1._0 === 0)) && (_p171._3.ctor === 'LocEqnConst')) && (_p171._3._0 === 0)) {
													var newPow = _p174 + _p177;
													return _elm_lang$core$Native_Utils.eq(newPow, 0) ? _elm_lang$core$Maybe$Just(
														{
															ctor: '_Tuple3',
															_0: 1,
															_1: _user$project$LocEqn$LocEqnConst(0),
															_2: _user$project$LocEqn$LocEqnConst(1)
														}) : _elm_lang$core$Maybe$Just(
														{
															ctor: '_Tuple3',
															_0: newPow,
															_1: A2(
																_user$project$LocEqn$LocEqnOp,
																_user$project$Lang$Mult,
																{
																	ctor: '::',
																	_0: _p173,
																	_1: {
																		ctor: '::',
																		_0: _p176,
																		_1: {ctor: '[]'}
																	}
																}),
															_2: _user$project$LocEqn$LocEqnConst(0)
														});
												} else {
													break _v91_3;
												}
											}
										}
									} else {
										break _v91_3;
									}
								} while(false);
								return _elm_lang$core$Maybe$Nothing;
							case 'Div':
								var _p172 = {ctor: '_Tuple4', _0: _p173, _1: _p175, _2: _p176, _3: _p178};
								_v92_4:
								do {
									_v92_3:
									do {
										if (_p172.ctor === '_Tuple4') {
											if (_p172._2.ctor === 'LocEqnConst') {
												if ((_p172._3.ctor === 'LocEqnConst') && (_p172._3._0 === 0)) {
													switch (_p172._2._0) {
														case 0:
															return _elm_lang$core$Maybe$Nothing;
														case 1:
															if ((_p172._0.ctor === 'LocEqnConst') && (_p172._0._0 === 0)) {
																return _elm_lang$core$Maybe$Just(
																	{
																		ctor: '_Tuple3',
																		_0: 0 - _p177,
																		_1: A2(
																			_user$project$LocEqn$LocEqnOp,
																			_user$project$Lang$Div,
																			{
																				ctor: '::',
																				_0: _p175,
																				_1: {
																					ctor: '::',
																					_0: _p176,
																					_1: {ctor: '[]'}
																				}
																			}),
																		_2: _user$project$LocEqn$LocEqnConst(0)
																	});
															} else {
																if ((_p172._1.ctor === 'LocEqnConst') && (_p172._1._0 === 0)) {
																	break _v92_3;
																} else {
																	break _v92_4;
																}
															}
														default:
															if ((_p172._1.ctor === 'LocEqnConst') && (_p172._1._0 === 0)) {
																break _v92_3;
															} else {
																break _v92_4;
															}
													}
												} else {
													if (_p172._2._0 === 0) {
														return _elm_lang$core$Maybe$Just(
															{
																ctor: '_Tuple3',
																_0: _p174,
																_1: A2(
																	_user$project$LocEqn$LocEqnOp,
																	_user$project$Lang$Div,
																	{
																		ctor: '::',
																		_0: _p173,
																		_1: {
																			ctor: '::',
																			_0: _p178,
																			_1: {ctor: '[]'}
																		}
																	}),
																_2: A2(
																	_user$project$LocEqn$LocEqnOp,
																	_user$project$Lang$Div,
																	{
																		ctor: '::',
																		_0: _p175,
																		_1: {
																			ctor: '::',
																			_0: _p178,
																			_1: {ctor: '[]'}
																		}
																	})
															});
													} else {
														break _v92_4;
													}
												}
											} else {
												if ((((_p172._1.ctor === 'LocEqnConst') && (_p172._1._0 === 0)) && (_p172._3.ctor === 'LocEqnConst')) && (_p172._3._0 === 0)) {
													break _v92_3;
												} else {
													break _v92_4;
												}
											}
										} else {
											break _v92_4;
										}
									} while(false);
									return _elm_lang$core$Native_Utils.eq(_p174, _p177) ? _elm_lang$core$Maybe$Just(
										{
											ctor: '_Tuple3',
											_0: 1,
											_1: _user$project$LocEqn$LocEqnConst(0),
											_2: A2(
												_user$project$LocEqn$LocEqnOp,
												_user$project$Lang$Div,
												{
													ctor: '::',
													_0: _p173,
													_1: {
														ctor: '::',
														_0: _p176,
														_1: {ctor: '[]'}
													}
												})
										}) : _elm_lang$core$Maybe$Just(
										{
											ctor: '_Tuple3',
											_0: _p177 - _p174,
											_1: A2(
												_user$project$LocEqn$LocEqnOp,
												_user$project$Lang$Div,
												{
													ctor: '::',
													_0: _p173,
													_1: {
														ctor: '::',
														_0: _p176,
														_1: {ctor: '[]'}
													}
												}),
											_2: _user$project$LocEqn$LocEqnConst(0)
										});
								} while(false);
								return (_elm_lang$core$Native_Utils.eq(_p174, _p177) && (_elm_lang$core$Native_Utils.eq(_p173, _p176) && _elm_lang$core$Native_Utils.eq(_p175, _p178))) ? _elm_lang$core$Maybe$Just(
									{
										ctor: '_Tuple3',
										_0: 1,
										_1: _user$project$LocEqn$LocEqnConst(0),
										_2: _user$project$LocEqn$LocEqnConst(1)
									}) : _elm_lang$core$Maybe$Nothing;
							default:
								return _elm_lang$core$Maybe$Nothing;
						}
					} else {
						return _elm_lang$core$Maybe$Nothing;
					}
				}();
				var _p179 = result;
				if (_p179.ctor === 'Just') {
					return _elm_lang$core$Maybe$Just(
						{
							ctor: '_Tuple3',
							_0: _p179._0._0,
							_1: _user$project$LocEqn$normalizeSimplify(_p179._0._1),
							_2: _user$project$LocEqn$normalizeSimplify(_p179._0._2)
						});
				} else {
					return _elm_lang$core$Maybe$Nothing;
				}
		}
	});
var _user$project$LocEqn$solveForLocValue = F4(
	function (targetLocId, subst, eqn, eqnTargetValue) {
		var eqnEqualToZero = A2(
			_user$project$LocEqn$constantifyLocs,
			A2(_elm_lang$core$Dict$remove, targetLocId, subst),
			A2(
				_user$project$LocEqn$LocEqnOp,
				_user$project$Lang$Minus,
				{
					ctor: '::',
					_0: eqn,
					_1: {
						ctor: '::',
						_0: _user$project$LocEqn$LocEqnConst(eqnTargetValue),
						_1: {ctor: '[]'}
					}
				}));
		var _p180 = A2(_user$project$LocEqn$locEqnTerms, targetLocId, eqnEqualToZero);
		if (_p180.ctor === 'Just') {
			var coeffEvaled = A2(_user$project$LocEqn$locEqnEval, _elm_lang$core$Dict$empty, _p180._0._1);
			var restEvaled = A2(_user$project$LocEqn$locEqnEval, _elm_lang$core$Dict$empty, _p180._0._2);
			var x = Math.pow((0 - restEvaled) / coeffEvaled, 1 / _p180._0._0);
			return (_elm_lang$core$Basics$isNaN(x) || _elm_lang$core$Basics$isInfinite(x)) ? _elm_lang$core$Maybe$Nothing : _elm_lang$core$Maybe$Just(x);
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$LocEqn$solveForConst = F3(
	function (subst, eqn, eqnTargetValue) {
		var locifyConstant = function (eqn) {
			var _p181 = eqn;
			switch (_p181.ctor) {
				case 'LocEqnConst':
					return _user$project$LocEqn$LocEqnLoc(-2);
				case 'LocEqnLoc':
					return eqn;
				default:
					return A2(
						_user$project$LocEqn$LocEqnOp,
						_p181._0,
						A2(_elm_lang$core$List$map, locifyConstant, _p181._1));
			}
		};
		return A4(
			_user$project$LocEqn$solveForLocValue,
			-2,
			subst,
			locifyConstant(eqn),
			eqnTargetValue);
	});
var _user$project$LocEqn$locEqnTemplateFillings = F4(
	function (targetValue, subst, locIdSet, template) {
		var allLocFillings = A2(
			_user$project$LocEqn$locEqnTemplateLocFillings,
			_elm_lang$core$Set$toList(locIdSet),
			template);
		var filledWithNiceNumber = A2(
			_elm_lang$core$List$map,
			function (locFilledEqn) {
				return A2(
					_user$project$Utils$head,
					'LocEqn.locEqnTemplateFillings ranking',
					A2(
						_elm_lang$core$List$sortBy,
						function (eqn) {
							return _elm_lang$core$Basics$abs(
								A2(_user$project$LocEqn$locEqnEval, subst, eqn) - targetValue);
						},
						A2(_user$project$LocEqn$locEqnTemplateConstantFillings, _user$project$LocEqn$littleConstants, locFilledEqn)));
			},
			allLocFillings);
		var filledWithExactNumber = function () {
			var fillInConstant = F2(
				function ($const, eqn) {
					var _p182 = eqn;
					switch (_p182.ctor) {
						case 'LocEqnConst':
							return _user$project$LocEqn$LocEqnConst($const);
						case 'LocEqnLoc':
							return eqn;
						default:
							return A2(
								_user$project$LocEqn$LocEqnOp,
								_p182._0,
								A2(
									_elm_lang$core$List$map,
									fillInConstant($const),
									_p182._1));
					}
				});
			return A2(
				_elm_lang$core$List$filterMap,
				function (locFilledEqn) {
					return _elm_lang$core$Native_Utils.eq(
						_elm_lang$core$Set$size(
							_user$project$LocEqn$locEqnLocIdSet(locFilledEqn)),
						_elm_lang$core$List$length(
							_user$project$LocEqn$locEqnLocIds(locFilledEqn))) ? A2(
						_elm_lang$core$Maybe$map,
						function ($const) {
							return A2(fillInConstant, $const, locFilledEqn);
						},
						A3(_user$project$LocEqn$solveForConst, subst, locFilledEqn, targetValue)) : _elm_lang$core$Maybe$Nothing;
				},
				allLocFillings);
		}();
		return A2(_elm_lang$core$Basics_ops['++'], filledWithNiceNumber, filledWithExactNumber);
	});
var _user$project$LocEqn$solveForLocUnchecked = F4(
	function (locId, locIdToNum, lhs, rhs) {
		var maybeEqn = function () {
			var _p183 = A2(_user$project$LocEqn$maybeExtractUnsharedExpression, rhs, lhs);
			if (_p183.ctor === 'Nothing') {
				return _elm_lang$core$Maybe$Nothing;
			} else {
				var rhs__ = A2(_user$project$LocEqn$constantifyLocs, locIdToNum, _p183._0._1);
				var lhs__ = A2(_user$project$LocEqn$constantifyLocs, locIdToNum, _p183._0._0);
				var _p184 = A2(
					_user$project$LocEqn$locEqnTerms,
					locId,
					A2(
						_user$project$LocEqn$LocEqnOp,
						_user$project$Lang$Minus,
						{
							ctor: '::',
							_0: lhs__,
							_1: {
								ctor: '::',
								_0: rhs__,
								_1: {ctor: '[]'}
							}
						}));
				if (_p184.ctor === 'Just') {
					var _p187 = _p184._0._2;
					var _p186 = _p184._0._0;
					var _p185 = _p184._0._1;
					return (_elm_lang$core$Native_Utils.eq(_p186, 0) || _elm_lang$core$Native_Utils.eq(
						_p185,
						_user$project$LocEqn$LocEqnConst(0))) ? _elm_lang$core$Maybe$Nothing : (_elm_lang$core$Native_Utils.eq(_p186, 1) ? _elm_lang$core$Maybe$Just(
						_user$project$LocEqn$normalizeSimplify(
							A2(
								_user$project$LocEqn$LocEqnOp,
								_user$project$Lang$Div,
								{
									ctor: '::',
									_0: A2(
										_user$project$LocEqn$LocEqnOp,
										_user$project$Lang$Minus,
										{
											ctor: '::',
											_0: _user$project$LocEqn$LocEqnConst(0),
											_1: {
												ctor: '::',
												_0: _p187,
												_1: {ctor: '[]'}
											}
										}),
									_1: {
										ctor: '::',
										_0: _p185,
										_1: {ctor: '[]'}
									}
								}))) : (_elm_lang$core$Native_Utils.eq(_p186, -1) ? _elm_lang$core$Maybe$Just(
						_user$project$LocEqn$normalizeSimplify(
							A2(
								_user$project$LocEqn$LocEqnOp,
								_user$project$Lang$Div,
								{
									ctor: '::',
									_0: _p185,
									_1: {
										ctor: '::',
										_0: A2(
											_user$project$LocEqn$LocEqnOp,
											_user$project$Lang$Minus,
											{
												ctor: '::',
												_0: _user$project$LocEqn$LocEqnConst(0),
												_1: {
													ctor: '::',
													_0: _p187,
													_1: {ctor: '[]'}
												}
											}),
										_1: {ctor: '[]'}
									}
								}))) : _elm_lang$core$Maybe$Nothing));
				} else {
					return _elm_lang$core$Maybe$Nothing;
				}
			}
		}();
		return maybeEqn;
	});
var _user$project$LocEqn$solveForLoc = F5(
	function (locId, locIdToNum, subst, lhs, rhs) {
		var _p188 = A4(_user$project$LocEqn$solveForLocUnchecked, locId, locIdToNum, lhs, rhs);
		if (_p188.ctor === 'Just') {
			var _p189 = _p188._0;
			var evaled = A2(_user$project$LocEqn$locEqnEval, subst, _p189);
			return (_elm_lang$core$Basics$isNaN(evaled) || _elm_lang$core$Basics$isInfinite(evaled)) ? _elm_lang$core$Maybe$Nothing : _elm_lang$core$Maybe$Just(_p189);
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});

var _user$project$Solver$isNumBinop = F2(
	function (x, y) {
		return !_elm_lang$core$Native_Utils.eq(x, y);
	})(_user$project$Lang$Lt);
var _user$project$Solver$evalLoc = F2(
	function (subst, tr) {
		var _p0 = tr;
		if (_p0.ctor === 'TrOp') {
			return _elm_lang$core$Maybe$Nothing;
		} else {
			return _elm_lang$core$Maybe$Just(
				A2(_elm_lang$core$Dict$get, _p0._0._0, subst));
		}
	});
var _user$project$Solver$evalTrace = F2(
	function (subst, t) {
		var _p1 = t;
		if (_p1.ctor === 'TrLoc') {
			return A2(_elm_lang$core$Dict$get, _p1._0._0, subst);
		} else {
			return A2(
				_user$project$Utils$mapMaybe,
				A2(
					_user$project$Eval$evalDelta,
					{ctor: '[]'},
					_p1._0),
				_user$project$Utils$projJusts(
					A2(
						_elm_lang$core$List$map,
						_user$project$Solver$evalTrace(subst),
						_p1._1)));
		}
	});
var _user$project$Solver$termSolve = F2(
	function (subst, _p2) {
		var _p3 = _p2;
		var locEqn = _user$project$LocEqn$traceToLocEquation(_p3._1);
		var locIds = _elm_lang$core$Set$toList(
			_user$project$LocEqn$locEqnLocIdSet(locEqn));
		var targetLocId = A2(
			_user$project$Utils$fromJust_,
			'subst should be missing a locId',
			A2(
				_user$project$Utils$findFirst,
				function (locId) {
					return _elm_lang$core$Native_Utils.eq(
						A2(_elm_lang$core$Dict$get, locId, subst),
						_elm_lang$core$Maybe$Nothing);
				},
				locIds));
		return A4(_user$project$LocEqn$solveForLocValue, targetLocId, subst, locEqn, _p3._0);
	});
var _user$project$Solver$debugLog = _user$project$Config$debugLog(_user$project$Config$debugSync);
var _user$project$Solver$maybeFloat = function (n) {
	var thresh = 1000;
	return (_elm_lang$core$Basics$isNaN(n) || _elm_lang$core$Basics$isInfinite(n)) ? A2(_user$project$Solver$debugLog, 'maybeFloat Nothing', _elm_lang$core$Maybe$Nothing) : ((_elm_lang$core$Native_Utils.cmp(
		_elm_lang$core$Basics$abs(n),
		thresh) > 0) ? A2(_user$project$Solver$debugLog, 'maybeFloat (above thresh)', _elm_lang$core$Maybe$Nothing) : _elm_lang$core$Maybe$Just(n));
};
var _user$project$Solver$solveR = F3(
	function (op, n, i) {
		var _p4 = op;
		switch (_p4.ctor) {
			case 'Plus':
				return _user$project$Solver$maybeFloat(n - i);
			case 'Minus':
				return _user$project$Solver$maybeFloat(i - n);
			case 'Mult':
				return _user$project$Solver$maybeFloat(n / i);
			case 'Div':
				return _user$project$Solver$maybeFloat(i / n);
			case 'Pow':
				return _elm_lang$core$Maybe$Just(
					A2(_elm_lang$core$Basics$logBase, i, n));
			case 'Mod':
				return _elm_lang$core$Maybe$Nothing;
			case 'ArcTan2':
				return _user$project$Solver$maybeFloat(
					_elm_lang$core$Basics$tan(n) * i);
			default:
				return _elm_lang$core$Native_Utils.crashCase(
					'Solver',
					{
						start: {line: 133, column: 17},
						end: {line: 141, column: 34}
					},
					_p4)('solveR');
		}
	});
var _user$project$Solver$solveL = F3(
	function (op, n, j) {
		var _p6 = op;
		switch (_p6.ctor) {
			case 'Plus':
				return _user$project$Solver$maybeFloat(n - j);
			case 'Minus':
				return _user$project$Solver$maybeFloat(j + n);
			case 'Mult':
				return _user$project$Solver$maybeFloat(n / j);
			case 'Div':
				return _user$project$Solver$maybeFloat(j * n);
			case 'Pow':
				return _elm_lang$core$Maybe$Just(
					Math.pow(n, 1 / j));
			case 'Mod':
				return _elm_lang$core$Maybe$Nothing;
			case 'ArcTan2':
				return _user$project$Solver$maybeFloat(
					j / _elm_lang$core$Basics$tan(n));
			default:
				return _elm_lang$core$Native_Utils.crashCase(
					'Solver',
					{
						start: {line: 144, column: 17},
						end: {line: 152, column: 32}
					},
					_p6)('solveL');
		}
	});
var _user$project$Solver$solveTopDown = F2(
	function (subst, _p8) {
		var _p9 = _p8;
		var _p22 = _p9._1;
		var _p21 = _p9._0;
		var _p10 = _p22;
		_v6_3:
		do {
			if (_p10.ctor === 'TrLoc') {
				if (_p10._0.ctor === '_Tuple3') {
					var _p11 = A2(_elm_lang$core$Dict$get, _p10._0._0, subst);
					if (_p11.ctor === 'Nothing') {
						return _elm_lang$core$Maybe$Just(_p21);
					} else {
						return _elm_lang$core$Maybe$Nothing;
					}
				} else {
					break _v6_3;
				}
			} else {
				if (_p10._1.ctor === '::') {
					if (_p10._1._1.ctor === '::') {
						if (_p10._1._1._1.ctor === '[]') {
							var _p16 = _p10._1._1._0;
							var _p15 = _p10._1._0;
							var _p14 = _p10._0;
							var left = {
								ctor: '_Tuple2',
								_0: A2(_user$project$Solver$evalTrace, subst, _p15),
								_1: A2(_user$project$Solver$evalLoc, subst, _p16)
							};
							var right = {
								ctor: '_Tuple2',
								_0: A2(_user$project$Solver$evalLoc, subst, _p15),
								_1: A2(_user$project$Solver$evalTrace, subst, _p16)
							};
							var _p12 = {
								ctor: '_Tuple3',
								_0: _user$project$Solver$isNumBinop(_p14),
								_1: left,
								_2: right
							};
							_v8_4:
							do {
								_v8_3:
								do {
									_v8_2:
									do {
										_v8_0:
										do {
											if ((_p12.ctor === '_Tuple3') && (_p12._0 === true)) {
												if ((_p12._1.ctor === '_Tuple2') && (_p12._1._0.ctor === 'Just')) {
													if (_p12._1._1.ctor === 'Just') {
														if (_p12._2.ctor === '_Tuple2') {
															if (_p12._2._0.ctor === 'Just') {
																if (_p12._1._1._0.ctor === 'Nothing') {
																	break _v8_0;
																} else {
																	if ((_p12._2._0._0.ctor === 'Nothing') && (_p12._2._1.ctor === 'Just')) {
																		break _v8_2;
																	} else {
																		break _v8_4;
																	}
																}
															} else {
																if (_p12._1._1._0.ctor === 'Nothing') {
																	break _v8_0;
																} else {
																	if (_p12._2._1.ctor === 'Just') {
																		break _v8_3;
																	} else {
																		break _v8_4;
																	}
																}
															}
														} else {
															if (_p12._1._1._0.ctor === 'Nothing') {
																break _v8_0;
															} else {
																break _v8_4;
															}
														}
													} else {
														return A2(
															_user$project$Utils$bindMaybe,
															function (n) {
																return A2(
																	_user$project$Solver$solveTopDown,
																	subst,
																	{ctor: '_Tuple2', _0: n, _1: _p16});
															},
															A3(_user$project$Solver$solveR, _p14, _p21, _p12._1._0._0));
													}
												} else {
													if (_p12._2.ctor === '_Tuple2') {
														if (_p12._2._0.ctor === 'Just') {
															if ((_p12._2._0._0.ctor === 'Nothing') && (_p12._2._1.ctor === 'Just')) {
																break _v8_2;
															} else {
																break _v8_4;
															}
														} else {
															if (_p12._2._1.ctor === 'Just') {
																break _v8_3;
															} else {
																break _v8_4;
															}
														}
													} else {
														break _v8_4;
													}
												}
											} else {
												break _v8_4;
											}
										} while(false);
										return A3(_user$project$Solver$solveR, _p14, _p21, _p12._1._0._0);
									} while(false);
									return A3(_user$project$Solver$solveL, _p14, _p21, _p12._2._1._0);
								} while(false);
								return A2(
									_user$project$Utils$bindMaybe,
									function (n) {
										return A2(
											_user$project$Solver$solveTopDown,
											subst,
											{ctor: '_Tuple2', _0: n, _1: _p15});
									},
									A3(_user$project$Solver$solveL, _p14, _p21, _p12._2._1._0));
							} while(false);
							var _p13 = A2(
								_user$project$Solver$debugLog,
								'Sync.solveTopDown',
								_user$project$Lang$strTrace(_p22));
							return _elm_lang$core$Maybe$Nothing;
						} else {
							break _v6_3;
						}
					} else {
						var _p17 = A2(_user$project$Solver$evalTrace, subst, _p10._1._0);
						if (_p17.ctor === 'Just') {
							return _elm_lang$core$Maybe$Nothing;
						} else {
							var _p18 = _p10._0;
							switch (_p18.ctor) {
								case 'Cos':
									return _user$project$Solver$maybeFloat(
										_elm_lang$core$Basics$acos(_p21));
								case 'Sin':
									return _user$project$Solver$maybeFloat(
										_elm_lang$core$Basics$asin(_p21));
								case 'ArcCos':
									return _elm_lang$core$Maybe$Just(
										_elm_lang$core$Basics$cos(_p21));
								case 'ArcSin':
									return _elm_lang$core$Maybe$Just(
										_elm_lang$core$Basics$sin(_p21));
								case 'Sqrt':
									return _elm_lang$core$Maybe$Just(_p21 * _p21);
								case 'Round':
									return _elm_lang$core$Maybe$Nothing;
								case 'Floor':
									return _elm_lang$core$Maybe$Nothing;
								case 'Ceil':
									return _elm_lang$core$Maybe$Nothing;
								default:
									var _p19 = A2(_user$project$Solver$debugLog, 'TODO solveTopDown', _p22);
									return _elm_lang$core$Maybe$Nothing;
							}
						}
					}
				} else {
					break _v6_3;
				}
			}
		} while(false);
		var _p20 = A2(_user$project$Solver$debugLog, 'TODO solveTopDown', _p22);
		return _elm_lang$core$Maybe$Nothing;
	});
var _user$project$Solver$solve = F2(
	function (subst, eqn) {
		return A2(
			_user$project$Utils$plusMaybe,
			A2(_user$project$Solver$termSolve, subst, eqn),
			A2(_user$project$Solver$solveTopDown, subst, eqn));
	});
var _user$project$Solver$simpleSolve = F2(
	function (subst, _p23) {
		var _p24 = _p23;
		var _p31 = _p24._1;
		var walkTrace = function (t) {
			var _p25 = t;
			_v12_2:
			do {
				if (_p25.ctor === 'TrLoc') {
					if (_p25._0.ctor === '_Tuple3') {
						var _p26 = A2(_elm_lang$core$Dict$get, _p25._0._0, subst);
						if (_p26.ctor === 'Nothing') {
							return _elm_lang$core$Maybe$Just(
								{ctor: '_Tuple2', _0: 0, _1: 1});
						} else {
							return _elm_lang$core$Maybe$Just(
								{ctor: '_Tuple2', _0: _p26._0, _1: 0});
						}
					} else {
						break _v12_2;
					}
				} else {
					if (_p25._0.ctor === 'Plus') {
						var foo = F2(
							function (mx, macc) {
								var _p27 = {ctor: '_Tuple2', _0: mx, _1: macc};
								if (((((_p27.ctor === '_Tuple2') && (_p27._0.ctor === 'Just')) && (_p27._0._0.ctor === '_Tuple2')) && (_p27._1.ctor === 'Just')) && (_p27._1._0.ctor === '_Tuple2')) {
									return _elm_lang$core$Maybe$Just(
										{ctor: '_Tuple2', _0: _p27._0._0._0 + _p27._1._0._0, _1: _p27._0._0._1 + _p27._1._0._1});
								} else {
									return _elm_lang$core$Maybe$Nothing;
								}
							});
						return A3(
							_elm_lang$core$List$foldl,
							foo,
							_elm_lang$core$Maybe$Just(
								{ctor: '_Tuple2', _0: 0, _1: 0}),
							A2(_elm_lang$core$List$map, walkTrace, _p25._1));
					} else {
						break _v12_2;
					}
				}
			} while(false);
			var _p28 = A2(
				_user$project$Solver$debugLog,
				'Sync.simpleSolve',
				_user$project$Lang$strTrace(_p31));
			return _elm_lang$core$Maybe$Nothing;
		};
		return A2(
			_user$project$Utils$mapMaybe,
			function (_p29) {
				var _p30 = _p29;
				return (_p24._0 - _p30._0) / _p30._1;
			},
			walkTrace(_p31));
	});

var _user$project$Sync$acePos = function (p) {
	return {row: p.line, column: p.col};
};
var _user$project$Sync$aceRange = function (x) {
	return {
		start: _user$project$Sync$acePos(x.start),
		end: _user$project$Sync$acePos(x.end)
	};
};
var _user$project$Sync$makeHighlight = F3(
	function (subst, color, _p0) {
		var _p1 = _p0;
		var _p2 = A2(_elm_lang$core$Dict$get, _p1._0, subst);
		if (_p2.ctor === 'Just') {
			return {
				color: color,
				range: _user$project$Sync$aceRange(_p2._0)
			};
		} else {
			return _elm_lang$core$Native_Utils.crashCase(
				'Sync',
				{
					start: {line: 1186, column: 3},
					end: {line: 1188, column: 63}
				},
				_p2)('makeHighlight: locid not in subst');
		}
	});
var _user$project$Sync$red = 'salmon';
var _user$project$Sync$green = 'limegreen';
var _user$project$Sync$yellow = 'khaki';
var _user$project$Sync$highlightChanges = F3(
	function (initSubstPlus, locs, changes) {
		var _p4 = function () {
			var f = F2(
				function (loc, _p5) {
					var _p6 = _p5;
					var _p14 = _p6._1;
					var _p13 = _p6._0;
					var _p7 = loc;
					var locid = _p7._0;
					var highlight = function (c) {
						return A3(_user$project$Sync$makeHighlight, initSubstPlus, c, loc);
					};
					var _p8 = {
						ctor: '_Tuple2',
						_0: A2(_elm_lang$core$Dict$get, locid, initSubstPlus),
						_1: A2(_elm_lang$core$Dict$get, locid, changes)
					};
					if (_p8._0.ctor === 'Nothing') {
						return _elm_lang$core$Native_Utils.crashCase(
							'Sync',
							{
								start: {line: 1253, column: 7},
								end: {line: 1263, column: 49}
							},
							_p8)('Controller.highlightChanges');
					} else {
						if (_p8._1.ctor === 'Nothing') {
							return {
								ctor: '_Tuple2',
								_0: {
									ctor: '::',
									_0: highlight(_user$project$Sync$yellow),
									_1: _p13
								},
								_1: _p14
							};
						} else {
							if (_p8._1._0.ctor === 'Nothing') {
								return {
									ctor: '_Tuple2',
									_0: {
										ctor: '::',
										_0: highlight(_user$project$Sync$red),
										_1: _p13
									},
									_1: _p14
								};
							} else {
								var _p12 = _p8._1._0._0;
								var _p11 = _p8._0._0;
								if (_elm_lang$core$Native_Utils.eq(_p12, _p11.val)) {
									return {
										ctor: '_Tuple2',
										_0: {
											ctor: '::',
											_0: highlight(_user$project$Sync$yellow),
											_1: _p13
										},
										_1: _p14
									};
								} else {
									var _p10 = {
										ctor: '_Tuple2',
										_0: _user$project$Lang$strNum(_p11.val),
										_1: _user$project$Lang$strNum(_p12)
									};
									var s = _p10._0;
									var s_ = _p10._1;
									var x = {
										ctor: '_Tuple2',
										_0: _user$project$Sync$acePos(_p11.start),
										_1: _elm_lang$core$String$length(s_) - _elm_lang$core$String$length(s)
									};
									return {
										ctor: '_Tuple2',
										_0: {
											ctor: '::',
											_0: highlight(_user$project$Sync$green),
											_1: _p13
										},
										_1: {ctor: '::', _0: x, _1: _p14}
									};
								}
							}
						}
					}
				});
			return A3(
				_elm_lang$core$List$foldl,
				f,
				{
					ctor: '_Tuple2',
					_0: {ctor: '[]'},
					_1: {ctor: '[]'}
				},
				_elm_lang$core$Set$toList(locs));
		}();
		var hi = _p4._0;
		var stringOffsets = _p4._1;
		var hi_ = function () {
			var g = F2(
				function (_p16, _p15) {
					var _p17 = _p16;
					var _p21 = _p17._0;
					var _p18 = _p15;
					var _p20 = _p18._0;
					var _p19 = _p18._1;
					var bump = function (pos) {
						return _elm_lang$core$Native_Utils.update(
							pos,
							{column: pos.column + _p17._1});
					};
					var ret = function (new_) {
						return {ctor: '_Tuple2', _0: _p20, _1: new_};
					};
					return ret(
						(!_elm_lang$core$Native_Utils.eq(_p21.row, _p20.start.row)) ? _p19 : ((_elm_lang$core$Native_Utils.cmp(_p21.column, _p20.start.column) > 0) ? _p19 : (_elm_lang$core$Native_Utils.eq(_p21.column, _p20.start.column) ? {
							start: _p19.start,
							end: bump(_p19.end)
						} : ((_elm_lang$core$Native_Utils.cmp(_p21.column, _p20.start.column) < 0) ? {
							start: bump(_p19.start),
							end: bump(_p19.end)
						} : _elm_lang$core$Native_Utils.crash(
							'Sync',
							{
								start: {line: 1278, column: 11},
								end: {line: 1278, column: 22}
							})('highlightChanges')))));
				});
			return A3(
				_elm_lang$core$Basics$flip,
				_elm_lang$core$List$map,
				hi,
				function (_p22) {
					var _p23 = _p22;
					var _p25 = _p23.range;
					var _p24 = A3(
						_elm_lang$core$List$foldl,
						g,
						{ctor: '_Tuple2', _0: _p25, _1: _p25},
						stringOffsets);
					var range_ = _p24._1;
					return {color: _p23.color, range: range_};
				});
		}();
		return hi_;
	});
var _user$project$Sync$gray = 'lightgray';
var _user$project$Sync$opacityNumPlus = F2(
	function (n, dx) {
		var clamp = A2(_user$project$Utils$clamp, 0.0, 1.0);
		var scale = 1 / _user$project$ShapeWidgets$wOpacitySlider;
		return clamp(
			n + (scale * _elm_lang$core$Basics$toFloat(dx)));
	});
var _user$project$Sync$strokeWidthNumPlus = F2(
	function (n, dx) {
		var scale = 1 / (_user$project$ShapeWidgets$wStrokeWidthSlider / _user$project$LangSvg$maxStrokeWidthNum);
		var clamp = function (_p26) {
			return _elm_lang$core$Basics$toFloat(
				_elm_lang$core$Basics$round(
					A3(_user$project$Utils$clamp, 0, _user$project$LangSvg$maxStrokeWidthNum, _p26)));
		};
		return clamp(
			n + (scale * _elm_lang$core$Basics$toFloat(dx)));
	});
var _user$project$Sync$colorNumPlus = F2(
	function (n, dx) {
		var scale = 1 / (_user$project$ShapeWidgets$wColorSlider / _user$project$LangSvg$maxColorNum);
		var clamp = A2(_user$project$Utils$clamp, 0, _user$project$LangSvg$maxColorNum - 1);
		return clamp(
			n + (scale * _elm_lang$core$Basics$toFloat(dx)));
	});
var _user$project$Sync$addInteriorZone_ = F5(
	function (finishTrigger, pointX, pointY, indexedPoints, result) {
		var xTraces = A2(
			_elm_lang$core$List$map,
			function (_p27) {
				return _elm_lang$core$Tuple$second(
					_elm_lang$core$Tuple$first(
						_elm_lang$core$Tuple$second(_p27)));
			},
			indexedPoints);
		var yTraces = A2(
			_elm_lang$core$List$map,
			function (_p28) {
				return _elm_lang$core$Tuple$second(
					_elm_lang$core$Tuple$second(
						_elm_lang$core$Tuple$second(_p28)));
			},
			indexedPoints);
		return A4(
			finishTrigger,
			_user$project$ShapeWidgets$ZInterior,
			A2(_elm_lang$core$Basics_ops['++'], xTraces, yTraces),
			function (assignedMaybeLocs) {
				var _p29 = _user$project$Utils$projJusts(assignedMaybeLocs);
				if (_p29.ctor === 'Nothing') {
					return {ctor: '[]'};
				} else {
					var _p33 = _p29._0;
					var n = _elm_lang$core$List$length(_p33);
					var xLocs = A2(_elm_lang$core$List$take, (n / 2) | 0, _p33);
					var yLocs = A2(_elm_lang$core$List$drop, (n / 2) | 0, _p33);
					var stuff = A2(
						_user$project$Utils$zip,
						A2(_user$project$Utils$zip, xLocs, yLocs),
						indexedPoints);
					return A3(
						_elm_lang$core$List$foldl,
						F2(
							function (_p30, acc) {
								var _p31 = _p30;
								var _p32 = _p31._1._0;
								return A2(
									_elm_lang$core$Basics_ops['++'],
									A4(
										pointX,
										_p32,
										_elm_lang$core$Maybe$Just(_p31._0._0),
										_p31._1._1._0._0,
										_p31._1._1._0._1),
									A2(
										_elm_lang$core$Basics_ops['++'],
										A4(
											pointY,
											_p32,
											_elm_lang$core$Maybe$Just(_p31._0._1),
											_p31._1._1._1._0,
											_p31._1._1._1._1),
										acc));
							}),
						{ctor: '[]'},
						stuff);
				}
			},
			result);
	});
var _user$project$Sync$addEdgeZones_ = F5(
	function (finishTrigger, pointX, pointY, edges, result) {
		return A3(
			_elm_lang$core$List$foldl,
			F2(
				function (_p34, acc) {
					var _p35 = _p34;
					var _p44 = _p35._1._1._1._1;
					var _p43 = _p35._0._1._1._1;
					var _p42 = _p35._1._1._0._1;
					var _p41 = _p35._0._1._0._1;
					var _p40 = _p35._1._0;
					var _p39 = _p35._0._0;
					return A4(
						finishTrigger,
						_user$project$ShapeWidgets$ZPolyEdge(_p39),
						{
							ctor: '::',
							_0: _p41,
							_1: {
								ctor: '::',
								_0: _p43,
								_1: {
									ctor: '::',
									_0: _p42,
									_1: {
										ctor: '::',
										_0: _p44,
										_1: {ctor: '[]'}
									}
								}
							}
						},
						function (_p36) {
							return function (_p37) {
								var _p38 = _p37;
								return A2(
									_elm_lang$core$Basics_ops['++'],
									A4(pointX, _p39, _p38._0, _p35._0._1._0._0, _p41),
									A2(
										_elm_lang$core$Basics_ops['++'],
										A4(pointY, _p39, _p38._1, _p35._0._1._1._0, _p43),
										A2(
											_elm_lang$core$Basics_ops['++'],
											A4(pointX, _p40, _p38._2, _p35._1._1._0._0, _p42),
											A4(pointY, _p40, _p38._3, _p35._1._1._1._0, _p44))));
							}(
								_user$project$Utils$unwrap4(_p36));
						},
						acc);
				}),
			result,
			edges);
	});
var _user$project$Sync$addPointZones_ = F5(
	function (finishTrigger, pointX, pointY, indexedPoints, result) {
		return A3(
			_elm_lang$core$List$foldl,
			F2(
				function (_p45, acc) {
					var _p46 = _p45;
					var _p52 = _p46._1._1._1;
					var _p51 = _p46._1._0._1;
					var _p50 = _p46._0;
					return A4(
						finishTrigger,
						_user$project$ShapeWidgets$ZPoint(
							_user$project$ShapeWidgets$Point(_p50)),
						{
							ctor: '::',
							_0: _p51,
							_1: {
								ctor: '::',
								_0: _p52,
								_1: {ctor: '[]'}
							}
						},
						function (_p47) {
							return function (_p48) {
								var _p49 = _p48;
								return A2(
									_elm_lang$core$Basics_ops['++'],
									A4(pointX, _p50, _p49._0, _p46._1._0._0, _p51),
									A4(pointY, _p50, _p49._1, _p46._1._1._0, _p52));
							}(
								_user$project$Utils$unwrap2(_p47));
						},
						acc);
				}),
			result,
			indexedPoints);
	});
var _user$project$Sync$mapMaybeToList = F2(
	function (mx, f) {
		var _p53 = mx;
		if (_p53.ctor === 'Nothing') {
			return {ctor: '[]'};
		} else {
			return {
				ctor: '::',
				_0: f(_p53._0),
				_1: {ctor: '[]'}
			};
		}
	});
var _user$project$Sync$solveOne = F4(
	function (subst, _p54, n_, t) {
		var _p55 = _p54;
		var subst_ = A2(_elm_lang$core$Dict$remove, _p55._0, subst);
		var maybeSolution = A2(
			_user$project$Solver$solve,
			subst_,
			{ctor: '_Tuple2', _0: n_, _1: t});
		return maybeSolution;
	});
var _user$project$Sync$pointX_ = F5(
	function (subst, i, xMaybeLoc, x, xTrace) {
		return A2(
			_user$project$Sync$mapMaybeToList,
			xMaybeLoc,
			function (xLoc) {
				return {
					ctor: '_Tuple5',
					_0: A2(
						_elm_lang$core$Basics_ops['++'],
						'X',
						_elm_lang$core$Basics$toString(i)),
					_1: 'dx',
					_2: xLoc,
					_3: xTrace,
					_4: F2(
						function (_p57, _p56) {
							var _p58 = _p56;
							return A4(
								_user$project$Sync$solveOne,
								subst,
								xLoc,
								x + _elm_lang$core$Basics$toFloat(_p58._0),
								xTrace);
						})
				};
			});
	});
var _user$project$Sync$pointY_ = F5(
	function (subst, i, yMaybeLoc, y, yTrace) {
		return A2(
			_user$project$Sync$mapMaybeToList,
			yMaybeLoc,
			function (yLoc) {
				return {
					ctor: '_Tuple5',
					_0: A2(
						_elm_lang$core$Basics_ops['++'],
						'Y',
						_elm_lang$core$Basics$toString(i)),
					_1: 'dy',
					_2: yLoc,
					_3: yTrace,
					_4: F2(
						function (_p60, _p59) {
							var _p61 = _p59;
							return A4(
								_user$project$Sync$solveOne,
								subst,
								yLoc,
								y + _elm_lang$core$Basics$toFloat(_p61._1),
								yTrace);
						})
				};
			});
	});
var _user$project$Sync$convertEmptyToNonEmpty = function (locList) {
	var _p62 = locList;
	if (_p62.ctor === '[]') {
		return {
			ctor: '::',
			_0: _elm_lang$core$Maybe$Nothing,
			_1: {ctor: '[]'}
		};
	} else {
		return A2(_elm_lang$core$List$map, _elm_lang$core$Maybe$Just, locList);
	}
};
var _user$project$Sync$coerceMaybeLoc = function (m) {
	var _p63 = m;
	if (_p63.ctor === 'Just') {
		return _p63._0;
	} else {
		return _user$project$Lang$dummyLoc;
	}
};
var _user$project$Sync$coerceMaybeLocList = _elm_lang$core$List$map(_user$project$Sync$coerceMaybeLoc);
var _user$project$Sync$getCount = F2(
	function (x, dict) {
		return A2(
			_elm_lang$core$Maybe$withDefault,
			0,
			A2(_elm_lang$core$Dict$get, x, dict));
	});
var _user$project$Sync$updateCount = F2(
	function (x, dict) {
		return A3(
			_elm_lang$core$Dict$insert,
			x,
			1 + A2(_user$project$Sync$getCount, x, dict),
			dict);
	});
var _user$project$Sync$updateFairCount = F2(
	function (x, dict) {
		return A2(
			_user$project$Sync$updateCount,
			_user$project$Sync$coerceMaybeLocList(x),
			dict);
	});
var _user$project$Sync$addCount = F3(
	function (k, x, dict) {
		return A3(
			_elm_lang$core$Dict$insert,
			x,
			k + A2(_user$project$Sync$getCount, x, dict),
			dict);
	});
var _user$project$Sync$getFairCount = F2(
	function (x, dict) {
		return A2(
			_user$project$Sync$getCount,
			_user$project$Sync$coerceMaybeLocList(x),
			dict);
	});
var _user$project$Sync$chooseFairLocationAssignment = F2(
	function (locSets, fairCounts) {
		var noAssignment = function (_p64) {
			var _p65 = _p64;
			var allNothings = A2(
				_elm_lang$core$List$repeat,
				_elm_lang$core$List$length(locSets),
				_elm_lang$core$Maybe$Nothing);
			return {ctor: '_Tuple2', _0: allNothings, _1: fairCounts};
		};
		var numCandidates = A3(
			_elm_lang$core$List$foldl,
			F2(
				function (x, y) {
					return x * y;
				}),
			1,
			A2(_elm_lang$core$List$map, _elm_lang$core$Set$size, locSets));
		if (_elm_lang$core$Native_Utils.cmp(numCandidates, 100) > 0) {
			return noAssignment(
				{ctor: '_Tuple0'});
		} else {
			var sorted = A2(
				_elm_lang$core$List$sortBy,
				function (assignment) {
					return A2(_user$project$Sync$getFairCount, assignment, fairCounts);
				},
				_user$project$Utils$oneOfEach(
					A2(
						_elm_lang$core$List$map,
						_user$project$Sync$convertEmptyToNonEmpty,
						A2(_elm_lang$core$List$map, _elm_lang$core$Set$toList, locSets))));
			var _p66 = sorted;
			if (_p66.ctor === '[]') {
				return noAssignment(
					{ctor: '_Tuple0'});
			} else {
				var _p67 = _p66._0;
				var fairCounts_ = A2(_user$project$Sync$updateFairCount, _p67, fairCounts);
				return {ctor: '_Tuple2', _0: _p67, _1: fairCounts_};
			}
		}
	});
var _user$project$Sync$chooseBiased = F2(
	function (biasCounts, locSet) {
		var sorted = A2(
			_elm_lang$core$List$sortBy,
			function (loc) {
				return A2(_user$project$Sync$getCount, loc, biasCounts);
			},
			_elm_lang$core$Set$toList(locSet));
		var _p68 = sorted;
		if (_p68.ctor === '::') {
			return _elm_lang$core$Maybe$Just(_p68._0);
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$Sync$heuristicModes = 3;
var _user$project$Sync$_p69 = _user$project$Utils$unwrap3(
	A2(_elm_lang$core$List$range, 0, _user$project$Sync$heuristicModes - 1));
var _user$project$Sync$heuristicsNone = _user$project$Sync$_p69._0;
var _user$project$Sync$heuristicsFair = _user$project$Sync$_p69._1;
var _user$project$Sync$heuristicsBiased = _user$project$Sync$_p69._2;
var _user$project$Sync$defaultOptions = {thawedByDefault: true, feelingLucky: _user$project$Sync$heuristicsBiased, unfreezeAll: false};
var _user$project$Sync$locsOfTrace = function (opts) {
	var frozenByDefault = !opts.thawedByDefault;
	var notUnfreezeAll = !opts.unfreezeAll;
	var foo = function (t) {
		var _p70 = t;
		if (_p70.ctor === 'TrLoc') {
			var _p72 = _p70._0;
			var _p71 = _p72;
			var b = _p71._1;
			return _user$project$FastParser$isPreludeLoc(_p72) ? _elm_lang$core$Set$empty : ((_elm_lang$core$Native_Utils.eq(b, _user$project$Lang$frozen) && notUnfreezeAll) ? _elm_lang$core$Set$empty : ((_elm_lang$core$Native_Utils.eq(b, _user$project$Lang$unann) && frozenByDefault) ? _elm_lang$core$Set$empty : _elm_lang$core$Set$singleton(_p72)));
		} else {
			return A3(
				_elm_lang$core$List$foldl,
				_elm_lang$core$Set$union,
				_elm_lang$core$Set$empty,
				A2(_elm_lang$core$List$map, foo, _p70._1));
		}
	};
	return function (tr) {
		var s = foo(tr);
		return _elm_lang$core$Native_Utils.eq(opts.feelingLucky, _user$project$Sync$heuristicsNone) ? ((_elm_lang$core$Native_Utils.cmp(
			_elm_lang$core$List$length(
				_elm_lang$core$Set$toList(s)),
			1) < 1) ? s : _elm_lang$core$Set$empty) : s;
	};
};
var _user$project$Sync$locsOfTraces = F2(
	function (options, traces) {
		return A3(
			_elm_lang$core$List$foldl,
			F2(
				function (t, acc) {
					return A2(
						_elm_lang$core$Set$union,
						acc,
						A2(_user$project$Sync$locsOfTrace, options, t));
				}),
			_elm_lang$core$Set$empty,
			traces);
	});
var _user$project$Sync$pickLocs = F3(
	function (options, maybeCounts, traces) {
		var locSets = A2(
			_elm_lang$core$List$map,
			_user$project$Sync$locsOfTrace(options),
			traces);
		var allLocs = A3(_elm_lang$core$List$foldl, _elm_lang$core$Set$union, _elm_lang$core$Set$empty, locSets);
		var _p73 = function () {
			var _p74 = maybeCounts;
			if (_p74.ctor === 'Nothing') {
				return {
					ctor: '_Tuple2',
					_0: A2(
						_elm_lang$core$List$map,
						_elm_lang$core$Basics$always(_elm_lang$core$Maybe$Nothing),
						locSets),
					_1: _elm_lang$core$Maybe$Nothing
				};
			} else {
				if (_p74._0.ctor === 'Left') {
					var _p75 = _p74._0._0;
					return {
						ctor: '_Tuple2',
						_0: A2(
							_elm_lang$core$List$map,
							_user$project$Sync$chooseBiased(_p75),
							locSets),
						_1: _elm_lang$core$Maybe$Just(
							_user$project$Either$Left(_p75))
					};
				} else {
					return A2(
						_elm_lang$core$Tuple$mapSecond,
						function (_p76) {
							return _elm_lang$core$Maybe$Just(
								_user$project$Either$Right(_p76));
						},
						A2(_user$project$Sync$chooseFairLocationAssignment, locSets, _p74._0._0));
				}
			}
		}();
		var assignedMaybeLocs = _p73._0;
		var maybeCounts_ = _p73._1;
		return {ctor: '_Tuple3', _0: assignedMaybeLocs, _1: allLocs, _2: maybeCounts_};
	});
var _user$project$Sync$addTrigger = F6(
	function (options, id, realZone, traces, makeTrigger, _p77) {
		var _p78 = _p77;
		var key = {
			ctor: '_Tuple2',
			_0: id,
			_1: _user$project$ShapeWidgets$unparseZone(realZone)
		};
		var _p79 = A3(_user$project$Sync$pickLocs, options, _p78._1, traces);
		var assignedMaybeLocs = _p79._0;
		var allLocs = _p79._1;
		var maybeCounts_ = _p79._2;
		var trigger = makeTrigger(assignedMaybeLocs);
		var yellowLocs = A3(
			_elm_lang$core$List$foldl,
			F2(
				function (triggerElt, acc) {
					var _p80 = triggerElt;
					var loc = _p80._2;
					return A2(_elm_lang$core$Set$insert, loc, acc);
				}),
			_elm_lang$core$Set$empty,
			trigger);
		var grayLocs = A2(_elm_lang$core$Set$diff, allLocs, yellowLocs);
		var dict_ = A3(
			_elm_lang$core$Dict$insert,
			key,
			{ctor: '_Tuple3', _0: trigger, _1: yellowLocs, _2: grayLocs},
			_p78._0);
		return {ctor: '_Tuple2', _0: dict_, _1: maybeCounts_};
	});
var _user$project$Sync$computeWidgetTriggers = F3(
	function (_p81, widgets, initMaybeCounts) {
		var _p82 = _p81;
		var _p117 = _p82._1;
		var _p116 = _p82._0;
		var wSlider = _user$project$Config$params.mainSection.uiWidgets.wSlider;
		var processWidget = F2(
			function (_p83, accResult) {
				var _p84 = _p83;
				var idAsShape = -2 - _p84._0;
				var _p85 = _p84._1;
				switch (_p85.ctor) {
					case 'WNumSlider':
						var _p92 = _p85._0;
						var _p91 = _p85._1;
						var _p90 = _p85._4;
						var updateX = function (dx) {
							return A3(
								_elm_lang$core$Basics$clamp,
								_p92,
								_p91,
								_p85._3 + ((_elm_lang$core$Basics$toFloat(dx) / _elm_lang$core$Basics$toFloat(wSlider)) * (_p91 - _p92)));
						};
						var options_ = _elm_lang$core$Native_Utils.update(
							_p116,
							{unfreezeAll: true});
						return A6(
							_user$project$Sync$addTrigger,
							options_,
							idAsShape,
							_user$project$ShapeWidgets$ZSlider,
							{
								ctor: '::',
								_0: _user$project$Lang$TrLoc(_p90),
								_1: {ctor: '[]'}
							},
							function (_p86) {
								return function (maybeLoc) {
									return A2(
										_user$project$Sync$mapMaybeToList,
										maybeLoc,
										function (loc_) {
											return {
												ctor: '_Tuple5',
												_0: '',
												_1: 'dx',
												_2: loc_,
												_3: _user$project$Lang$TrLoc(_p90),
												_4: F2(
													function (_p88, _p87) {
														var _p89 = _p87;
														return A4(
															_user$project$Sync$solveOne,
															_p117,
															loc_,
															updateX(_p89._0),
															_user$project$Lang$TrLoc(_p90));
													})
											};
										});
								}(
									_user$project$Utils$unwrap1(_p86));
							},
							accResult);
					case 'WIntSlider':
						var _p98 = _p85._4;
						var _p93 = {
							ctor: '_Tuple3',
							_0: _elm_lang$core$Basics$toFloat(_p85._0),
							_1: _elm_lang$core$Basics$toFloat(_p85._1),
							_2: _elm_lang$core$Basics$toFloat(_p85._3)
						};
						var minVal = _p93._0;
						var maxVal = _p93._1;
						var curVal = _p93._2;
						var updateX = function (dx) {
							return _elm_lang$core$Basics$toFloat(
								_elm_lang$core$Basics$round(
									A3(
										_elm_lang$core$Basics$clamp,
										minVal,
										maxVal,
										curVal + ((_elm_lang$core$Basics$toFloat(dx) / _elm_lang$core$Basics$toFloat(wSlider)) * (maxVal - minVal)))));
						};
						var options_ = _elm_lang$core$Native_Utils.update(
							_p116,
							{unfreezeAll: true});
						return A6(
							_user$project$Sync$addTrigger,
							options_,
							idAsShape,
							_user$project$ShapeWidgets$ZSlider,
							{
								ctor: '::',
								_0: _user$project$Lang$TrLoc(_p98),
								_1: {ctor: '[]'}
							},
							function (_p94) {
								return function (maybeLoc) {
									return A2(
										_user$project$Sync$mapMaybeToList,
										maybeLoc,
										function (loc_) {
											return {
												ctor: '_Tuple5',
												_0: '',
												_1: 'dx',
												_2: loc_,
												_3: _user$project$Lang$TrLoc(_p98),
												_4: F2(
													function (_p96, _p95) {
														var _p97 = _p95;
														return A4(
															_user$project$Sync$solveOne,
															_p117,
															loc_,
															updateX(_p97._0),
															_user$project$Lang$TrLoc(_p98));
													})
											};
										});
								}(
									_user$project$Utils$unwrap1(_p94));
							},
							accResult);
					case 'WPoint':
						var _p109 = _p85._1._1;
						var _p108 = _p85._0._1;
						return A6(
							_user$project$Sync$addTrigger,
							_p116,
							idAsShape,
							_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$LonePoint),
							{
								ctor: '::',
								_0: _p108,
								_1: {
									ctor: '::',
									_0: _p109,
									_1: {ctor: '[]'}
								}
							},
							function (_p99) {
								return function (_p100) {
									var _p101 = _p100;
									return A2(
										_elm_lang$core$Basics_ops['++'],
										A2(
											_user$project$Sync$mapMaybeToList,
											_p101._0,
											function (xLoc) {
												return {
													ctor: '_Tuple5',
													_0: '',
													_1: 'dx',
													_2: xLoc,
													_3: _p108,
													_4: F2(
														function (_p103, _p102) {
															var _p104 = _p102;
															return A4(
																_user$project$Sync$solveOne,
																_p117,
																xLoc,
																_p85._0._0 + _elm_lang$core$Basics$toFloat(_p104._0),
																_p108);
														})
												};
											}),
										A2(
											_user$project$Sync$mapMaybeToList,
											_p101._1,
											function (yLoc) {
												return {
													ctor: '_Tuple5',
													_0: '',
													_1: 'dy',
													_2: yLoc,
													_3: _p109,
													_4: F2(
														function (_p106, _p105) {
															var _p107 = _p105;
															return A4(
																_user$project$Sync$solveOne,
																_p117,
																yLoc,
																_p85._1._0 + _elm_lang$core$Basics$toFloat(_p107._1),
																_p109);
														})
												};
											}));
								}(
									_user$project$Utils$unwrap2(_p99));
							},
							accResult);
					default:
						var _p115 = _p85._2;
						var _p114 = _p85._4._1;
						return A6(
							_user$project$Sync$addTrigger,
							_p116,
							idAsShape,
							_user$project$ShapeWidgets$ZOffset1D,
							{
								ctor: '::',
								_0: _p114,
								_1: {ctor: '[]'}
							},
							function (_p110) {
								return function (maybeLoc) {
									return A2(
										_user$project$Sync$mapMaybeToList,
										maybeLoc,
										function (loc_) {
											return {
												ctor: '_Tuple5',
												_0: '',
												_1: _elm_lang$core$Native_Utils.eq(_p115, _user$project$Lang$X) ? 'dx' : 'dy',
												_2: loc_,
												_3: _p114,
												_4: F2(
													function (_p112, _p111) {
														var _p113 = _p111;
														return A4(
															_user$project$Sync$solveOne,
															_p117,
															loc_,
															A2(
																_elm_lang$core$Native_Utils.eq(_p85._3, _user$project$Lang$Positive) ? F2(
																	function (x, y) {
																		return x + y;
																	}) : F2(
																	function (x, y) {
																		return x - y;
																	}),
																_p85._4._0,
																_elm_lang$core$Native_Utils.eq(_p115, _user$project$Lang$X) ? _elm_lang$core$Basics$toFloat(_p113._0) : _elm_lang$core$Basics$toFloat(_p113._1)),
															_p114);
													})
											};
										});
								}(
									_user$project$Utils$unwrap1(_p110));
							},
							accResult);
				}
			});
		return A3(
			_user$project$Utils$foldli1,
			processWidget,
			{ctor: '_Tuple2', _0: _elm_lang$core$Dict$empty, _1: initMaybeCounts},
			widgets);
	});
var _user$project$Sync$computeRectTriggers = F3(
	function (_p119, maybeCounts, _p118) {
		var _p120 = _p119;
		var _p155 = _p120._1;
		var _p121 = _p118;
		var finishTrigger = A2(_user$project$Sync$addTrigger, _p120._0, _p121._0);
		var _p122 = _user$project$Utils$unwrap4(
			A2(
				_elm_lang$core$List$map,
				function (_p123) {
					return _user$project$LangSvg$toNum(
						A2(_user$project$Utils$find_, _p121._2, _p123));
				},
				{
					ctor: '::',
					_0: 'x',
					_1: {
						ctor: '::',
						_0: 'y',
						_1: {
							ctor: '::',
							_0: 'width',
							_1: {
								ctor: '::',
								_0: 'height',
								_1: {ctor: '[]'}
							}
						}
					}
				}));
		var x = _p122._0._0;
		var xTrace = _p122._0._1;
		var y = _p122._1._0;
		var yTrace = _p122._1._1;
		var w = _p122._2._0;
		var wTrace = _p122._2._1;
		var h = _p122._3._0;
		var hTrace = _p122._3._1;
		var leftEdge = F2(
			function (xMaybeLoc, wMaybeLoc) {
				return A2(
					_elm_lang$core$Basics_ops['++'],
					A2(
						_user$project$Sync$mapMaybeToList,
						xMaybeLoc,
						function (xLoc) {
							return {
								ctor: '_Tuple5',
								_0: 'x',
								_1: 'dx',
								_2: xLoc,
								_3: xTrace,
								_4: F2(
									function (_p125, _p124) {
										var _p126 = _p124;
										return A4(
											_user$project$Sync$solveOne,
											_p155,
											xLoc,
											x + _elm_lang$core$Basics$toFloat(_p126._0),
											xTrace);
									})
							};
						}),
					A2(
						_user$project$Sync$mapMaybeToList,
						wMaybeLoc,
						function (wLoc) {
							return {
								ctor: '_Tuple5',
								_0: 'width',
								_1: 'dx',
								_2: wLoc,
								_3: wTrace,
								_4: F2(
									function (_p128, _p127) {
										var _p129 = _p127;
										return A4(
											_user$project$Sync$solveOne,
											_p155,
											wLoc,
											w - _elm_lang$core$Basics$toFloat(_p129._0),
											wTrace);
									})
							};
						}));
			});
		var rightEdge = function (wMaybeLoc) {
			return A2(
				_user$project$Sync$mapMaybeToList,
				wMaybeLoc,
				function (wLoc) {
					return {
						ctor: '_Tuple5',
						_0: 'width',
						_1: 'dx',
						_2: wLoc,
						_3: wTrace,
						_4: F2(
							function (_p131, _p130) {
								var _p132 = _p130;
								return A4(
									_user$project$Sync$solveOne,
									_p155,
									wLoc,
									w + _elm_lang$core$Basics$toFloat(_p132._0),
									wTrace);
							})
					};
				});
		};
		var topEdge = F2(
			function (yMaybeLoc, hMaybeLoc) {
				return A2(
					_elm_lang$core$Basics_ops['++'],
					A2(
						_user$project$Sync$mapMaybeToList,
						yMaybeLoc,
						function (yLoc) {
							return {
								ctor: '_Tuple5',
								_0: 'y',
								_1: 'dy',
								_2: yLoc,
								_3: yTrace,
								_4: F2(
									function (_p134, _p133) {
										var _p135 = _p133;
										return A4(
											_user$project$Sync$solveOne,
											_p155,
											yLoc,
											y + _elm_lang$core$Basics$toFloat(_p135._1),
											yTrace);
									})
							};
						}),
					A2(
						_user$project$Sync$mapMaybeToList,
						hMaybeLoc,
						function (hLoc) {
							return {
								ctor: '_Tuple5',
								_0: 'height',
								_1: 'dy',
								_2: hLoc,
								_3: hTrace,
								_4: F2(
									function (_p137, _p136) {
										var _p138 = _p136;
										return A4(
											_user$project$Sync$solveOne,
											_p155,
											hLoc,
											h - _elm_lang$core$Basics$toFloat(_p138._1),
											hTrace);
									})
							};
						}));
			});
		var botEdge = function (hMaybeLoc) {
			return A2(
				_user$project$Sync$mapMaybeToList,
				hMaybeLoc,
				function (hLoc) {
					return {
						ctor: '_Tuple5',
						_0: 'height',
						_1: 'dy',
						_2: hLoc,
						_3: hTrace,
						_4: F2(
							function (_p140, _p139) {
								var _p141 = _p139;
								return A4(
									_user$project$Sync$solveOne,
									_p155,
									hLoc,
									h + _elm_lang$core$Basics$toFloat(_p141._1),
									hTrace);
							})
					};
				});
		};
		return A4(
			finishTrigger,
			_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$LeftEdge),
			{
				ctor: '::',
				_0: xTrace,
				_1: {
					ctor: '::',
					_0: wTrace,
					_1: {ctor: '[]'}
				}
			},
			function (assignedMaybeLocs) {
				var _p142 = _user$project$Utils$unwrap2(assignedMaybeLocs);
				var xMaybeLoc = _p142._0;
				var wMaybeLoc = _p142._1;
				return A2(leftEdge, xMaybeLoc, wMaybeLoc);
			},
			A4(
				finishTrigger,
				_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$BotLeft),
				{
					ctor: '::',
					_0: xTrace,
					_1: {
						ctor: '::',
						_0: wTrace,
						_1: {
							ctor: '::',
							_0: hTrace,
							_1: {ctor: '[]'}
						}
					}
				},
				function (assignedMaybeLocs) {
					var _p143 = _user$project$Utils$unwrap3(assignedMaybeLocs);
					var xMaybeLoc = _p143._0;
					var wMaybeLoc = _p143._1;
					var hMaybeLoc = _p143._2;
					return A2(
						_elm_lang$core$Basics_ops['++'],
						A2(leftEdge, xMaybeLoc, wMaybeLoc),
						botEdge(hMaybeLoc));
				},
				A4(
					finishTrigger,
					_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$BotEdge),
					{
						ctor: '::',
						_0: hTrace,
						_1: {ctor: '[]'}
					},
					function (assignedMaybeLocs) {
						var hMaybeLoc = _user$project$Utils$unwrap1(assignedMaybeLocs);
						return botEdge(hMaybeLoc);
					},
					A4(
						finishTrigger,
						_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$BotRight),
						{
							ctor: '::',
							_0: wTrace,
							_1: {
								ctor: '::',
								_0: hTrace,
								_1: {ctor: '[]'}
							}
						},
						function (assignedMaybeLocs) {
							var _p144 = _user$project$Utils$unwrap2(assignedMaybeLocs);
							var wMaybeLoc = _p144._0;
							var hMaybeLoc = _p144._1;
							return A2(
								_elm_lang$core$Basics_ops['++'],
								rightEdge(wMaybeLoc),
								botEdge(hMaybeLoc));
						},
						A4(
							finishTrigger,
							_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$RightEdge),
							{
								ctor: '::',
								_0: wTrace,
								_1: {ctor: '[]'}
							},
							function (assignedMaybeLocs) {
								var wMaybeLoc = _user$project$Utils$unwrap1(assignedMaybeLocs);
								return rightEdge(wMaybeLoc);
							},
							A4(
								finishTrigger,
								_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$TopRight),
								{
									ctor: '::',
									_0: yTrace,
									_1: {
										ctor: '::',
										_0: wTrace,
										_1: {
											ctor: '::',
											_0: hTrace,
											_1: {ctor: '[]'}
										}
									}
								},
								function (assignedMaybeLocs) {
									var _p145 = _user$project$Utils$unwrap3(assignedMaybeLocs);
									var yMaybeLoc = _p145._0;
									var wMaybeLoc = _p145._1;
									var hMaybeLoc = _p145._2;
									return A2(
										_elm_lang$core$Basics_ops['++'],
										A2(topEdge, yMaybeLoc, hMaybeLoc),
										rightEdge(wMaybeLoc));
								},
								A4(
									finishTrigger,
									_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$TopEdge),
									{
										ctor: '::',
										_0: yTrace,
										_1: {
											ctor: '::',
											_0: hTrace,
											_1: {ctor: '[]'}
										}
									},
									function (assignedMaybeLocs) {
										var _p146 = _user$project$Utils$unwrap2(assignedMaybeLocs);
										var yMaybeLoc = _p146._0;
										var hMaybeLoc = _p146._1;
										return A2(topEdge, yMaybeLoc, hMaybeLoc);
									},
									A4(
										finishTrigger,
										_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$TopLeft),
										{
											ctor: '::',
											_0: xTrace,
											_1: {
												ctor: '::',
												_0: yTrace,
												_1: {
													ctor: '::',
													_0: wTrace,
													_1: {
														ctor: '::',
														_0: hTrace,
														_1: {ctor: '[]'}
													}
												}
											}
										},
										function (assignedMaybeLocs) {
											var _p147 = _user$project$Utils$unwrap4(assignedMaybeLocs);
											var xMaybeLoc = _p147._0;
											var yMaybeLoc = _p147._1;
											var wMaybeLoc = _p147._2;
											var hMaybeLoc = _p147._3;
											return A2(
												_elm_lang$core$Basics_ops['++'],
												A2(leftEdge, xMaybeLoc, wMaybeLoc),
												A2(topEdge, yMaybeLoc, hMaybeLoc));
										},
										A4(
											finishTrigger,
											_user$project$ShapeWidgets$ZInterior,
											{
												ctor: '::',
												_0: xTrace,
												_1: {
													ctor: '::',
													_0: yTrace,
													_1: {ctor: '[]'}
												}
											},
											function (assignedMaybeLocs) {
												var _p148 = _user$project$Utils$unwrap2(assignedMaybeLocs);
												var xMaybeLoc = _p148._0;
												var yMaybeLoc = _p148._1;
												return A2(
													_elm_lang$core$Basics_ops['++'],
													A2(
														_user$project$Sync$mapMaybeToList,
														xMaybeLoc,
														function (xLoc) {
															return {
																ctor: '_Tuple5',
																_0: 'x',
																_1: 'dx',
																_2: xLoc,
																_3: xTrace,
																_4: F2(
																	function (_p150, _p149) {
																		var _p151 = _p149;
																		return A4(
																			_user$project$Sync$solveOne,
																			_p155,
																			xLoc,
																			x + _elm_lang$core$Basics$toFloat(_p151._0),
																			xTrace);
																	})
															};
														}),
													A2(
														_user$project$Sync$mapMaybeToList,
														yMaybeLoc,
														function (yLoc) {
															return {
																ctor: '_Tuple5',
																_0: 'y',
																_1: 'dy',
																_2: yLoc,
																_3: yTrace,
																_4: F2(
																	function (_p153, _p152) {
																		var _p154 = _p152;
																		return A4(
																			_user$project$Sync$solveOne,
																			_p155,
																			yLoc,
																			y + _elm_lang$core$Basics$toFloat(_p154._1),
																			yTrace);
																	})
															};
														}));
											},
											{ctor: '_Tuple2', _0: _elm_lang$core$Dict$empty, _1: maybeCounts})))))))));
	});
var _user$project$Sync$computeLineTriggers = F3(
	function (_p157, maybeCounts, _p156) {
		var _p158 = _p157;
		var _p172 = _p158._1;
		var _p159 = _p156;
		var finishTrigger = A2(_user$project$Sync$addTrigger, _p158._0, _p159._0);
		var _p160 = _user$project$Utils$unwrap4(
			A2(
				_elm_lang$core$List$map,
				function (_p161) {
					return _user$project$LangSvg$toNum(
						A2(_user$project$Utils$find_, _p159._2, _p161));
				},
				{
					ctor: '::',
					_0: 'x1',
					_1: {
						ctor: '::',
						_0: 'y1',
						_1: {
							ctor: '::',
							_0: 'x2',
							_1: {
								ctor: '::',
								_0: 'y2',
								_1: {ctor: '[]'}
							}
						}
					}
				}));
		var x1 = _p160._0._0;
		var x1Trace = _p160._0._1;
		var y1 = _p160._1._0;
		var y1Trace = _p160._1._1;
		var x2 = _p160._2._0;
		var x2Trace = _p160._2._1;
		var y2 = _p160._3._0;
		var y2Trace = _p160._3._1;
		var point = F3(
			function (i, xMaybeLoc, yMaybeLoc) {
				var _p162 = _elm_lang$core$Native_Utils.eq(i, 1) ? {ctor: '_Tuple4', _0: x1, _1: x1Trace, _2: y1, _3: y1Trace} : {ctor: '_Tuple4', _0: x2, _1: x2Trace, _2: y2, _3: y2Trace};
				var x = _p162._0;
				var xTrace = _p162._1;
				var y = _p162._2;
				var yTrace = _p162._3;
				return A2(
					_elm_lang$core$Basics_ops['++'],
					A2(
						_user$project$Sync$mapMaybeToList,
						xMaybeLoc,
						function (xLoc) {
							return {
								ctor: '_Tuple5',
								_0: A2(
									_elm_lang$core$Basics_ops['++'],
									'x',
									_elm_lang$core$Basics$toString(i)),
								_1: 'dx',
								_2: xLoc,
								_3: xTrace,
								_4: F2(
									function (_p164, _p163) {
										var _p165 = _p163;
										return A4(
											_user$project$Sync$solveOne,
											_p172,
											xLoc,
											x + _elm_lang$core$Basics$toFloat(_p165._0),
											xTrace);
									})
							};
						}),
					A2(
						_user$project$Sync$mapMaybeToList,
						yMaybeLoc,
						function (yLoc) {
							return {
								ctor: '_Tuple5',
								_0: A2(
									_elm_lang$core$Basics_ops['++'],
									'y',
									_elm_lang$core$Basics$toString(i)),
								_1: 'dy',
								_2: yLoc,
								_3: yTrace,
								_4: F2(
									function (_p167, _p166) {
										var _p168 = _p166;
										return A4(
											_user$project$Sync$solveOne,
											_p172,
											yLoc,
											y + _elm_lang$core$Basics$toFloat(_p168._1),
											yTrace);
									})
							};
						}));
			});
		return A4(
			finishTrigger,
			_user$project$ShapeWidgets$ZLineEdge,
			{
				ctor: '::',
				_0: x1Trace,
				_1: {
					ctor: '::',
					_0: y1Trace,
					_1: {
						ctor: '::',
						_0: x2Trace,
						_1: {
							ctor: '::',
							_0: y2Trace,
							_1: {ctor: '[]'}
						}
					}
				}
			},
			function (assignedMaybeLocs) {
				var _p169 = _user$project$Utils$unwrap4(assignedMaybeLocs);
				var xMaybeLoc1 = _p169._0;
				var yMaybeLoc1 = _p169._1;
				var xMaybeLoc2 = _p169._2;
				var yMaybeLoc2 = _p169._3;
				return A2(
					_elm_lang$core$Basics_ops['++'],
					A3(point, 1, xMaybeLoc1, yMaybeLoc1),
					A3(point, 2, xMaybeLoc2, yMaybeLoc2));
			},
			A4(
				finishTrigger,
				_user$project$ShapeWidgets$ZPoint(
					_user$project$ShapeWidgets$Point(2)),
				{
					ctor: '::',
					_0: x2Trace,
					_1: {
						ctor: '::',
						_0: y2Trace,
						_1: {ctor: '[]'}
					}
				},
				function (assignedMaybeLocs) {
					var _p170 = _user$project$Utils$unwrap2(assignedMaybeLocs);
					var xMaybeLoc2 = _p170._0;
					var yMaybeLoc2 = _p170._1;
					return A3(point, 2, xMaybeLoc2, yMaybeLoc2);
				},
				A4(
					finishTrigger,
					_user$project$ShapeWidgets$ZPoint(
						_user$project$ShapeWidgets$Point(1)),
					{
						ctor: '::',
						_0: x1Trace,
						_1: {
							ctor: '::',
							_0: y1Trace,
							_1: {ctor: '[]'}
						}
					},
					function (assignedMaybeLocs) {
						var _p171 = _user$project$Utils$unwrap2(assignedMaybeLocs);
						var xMaybeLoc1 = _p171._0;
						var yMaybeLoc1 = _p171._1;
						return A3(point, 1, xMaybeLoc1, yMaybeLoc1);
					},
					{ctor: '_Tuple2', _0: _elm_lang$core$Dict$empty, _1: maybeCounts})));
	});
var _user$project$Sync$computeEllipseTriggers = F3(
	function (_p174, maybeCounts, _p173) {
		var _p175 = _p174;
		var _p202 = _p175._1;
		var _p176 = _p173;
		var finishTrigger = A2(_user$project$Sync$addTrigger, _p175._0, _p176._0);
		var _p177 = _user$project$Utils$unwrap4(
			A2(
				_elm_lang$core$List$map,
				function (_p178) {
					return _user$project$LangSvg$toNum(
						A2(_user$project$Utils$find_, _p176._2, _p178));
				},
				{
					ctor: '::',
					_0: 'cx',
					_1: {
						ctor: '::',
						_0: 'cy',
						_1: {
							ctor: '::',
							_0: 'rx',
							_1: {
								ctor: '::',
								_0: 'ry',
								_1: {ctor: '[]'}
							}
						}
					}
				}));
		var cx = _p177._0._0;
		var cxTrace = _p177._0._1;
		var cy = _p177._1._0;
		var cyTrace = _p177._1._1;
		var rx = _p177._2._0;
		var rxTrace = _p177._2._1;
		var ry = _p177._3._0;
		var ryTrace = _p177._3._1;
		var leftEdge = function (rxMaybeLoc) {
			return A2(
				_user$project$Sync$mapMaybeToList,
				rxMaybeLoc,
				function (rxLoc) {
					return {
						ctor: '_Tuple5',
						_0: 'rx',
						_1: 'dx',
						_2: rxLoc,
						_3: rxTrace,
						_4: F2(
							function (_p180, _p179) {
								var _p181 = _p179;
								return A4(
									_user$project$Sync$solveOne,
									_p202,
									rxLoc,
									rx - _elm_lang$core$Basics$toFloat(_p181._0),
									rxTrace);
							})
					};
				});
		};
		var rightEdge = function (rxMaybeLoc) {
			return A2(
				_user$project$Sync$mapMaybeToList,
				rxMaybeLoc,
				function (rxLoc) {
					return {
						ctor: '_Tuple5',
						_0: 'rx',
						_1: 'dx',
						_2: rxLoc,
						_3: rxTrace,
						_4: F2(
							function (_p183, _p182) {
								var _p184 = _p182;
								return A4(
									_user$project$Sync$solveOne,
									_p202,
									rxLoc,
									rx + _elm_lang$core$Basics$toFloat(_p184._0),
									rxTrace);
							})
					};
				});
		};
		var topEdge = function (ryMaybeLoc) {
			return A2(
				_user$project$Sync$mapMaybeToList,
				ryMaybeLoc,
				function (ryLoc) {
					return {
						ctor: '_Tuple5',
						_0: 'ry',
						_1: 'dy',
						_2: ryLoc,
						_3: ryTrace,
						_4: F2(
							function (_p186, _p185) {
								var _p187 = _p185;
								return A4(
									_user$project$Sync$solveOne,
									_p202,
									ryLoc,
									ry - _elm_lang$core$Basics$toFloat(_p187._1),
									ryTrace);
							})
					};
				});
		};
		var botEdge = function (ryMaybeLoc) {
			return A2(
				_user$project$Sync$mapMaybeToList,
				ryMaybeLoc,
				function (ryLoc) {
					return {
						ctor: '_Tuple5',
						_0: 'ry',
						_1: 'dy',
						_2: ryLoc,
						_3: ryTrace,
						_4: F2(
							function (_p189, _p188) {
								var _p190 = _p188;
								return A4(
									_user$project$Sync$solveOne,
									_p202,
									ryLoc,
									ry + _elm_lang$core$Basics$toFloat(_p190._1),
									ryTrace);
							})
					};
				});
		};
		return A4(
			finishTrigger,
			_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$LeftEdge),
			{
				ctor: '::',
				_0: rxTrace,
				_1: {ctor: '[]'}
			},
			function (assignedMaybeLocs) {
				var leftMaybeLoc = _user$project$Utils$unwrap1(assignedMaybeLocs);
				return leftEdge(leftMaybeLoc);
			},
			A4(
				finishTrigger,
				_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$BotLeft),
				{
					ctor: '::',
					_0: rxTrace,
					_1: {
						ctor: '::',
						_0: ryTrace,
						_1: {ctor: '[]'}
					}
				},
				function (assignedMaybeLocs) {
					var _p191 = _user$project$Utils$unwrap2(assignedMaybeLocs);
					var leftMaybeLoc = _p191._0;
					var botMaybeLoc = _p191._1;
					return A2(
						_elm_lang$core$Basics_ops['++'],
						leftEdge(leftMaybeLoc),
						botEdge(botMaybeLoc));
				},
				A4(
					finishTrigger,
					_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$BotEdge),
					{
						ctor: '::',
						_0: ryTrace,
						_1: {ctor: '[]'}
					},
					function (assignedMaybeLocs) {
						var botMaybeLoc = _user$project$Utils$unwrap1(assignedMaybeLocs);
						return botEdge(botMaybeLoc);
					},
					A4(
						finishTrigger,
						_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$BotRight),
						{
							ctor: '::',
							_0: rxTrace,
							_1: {
								ctor: '::',
								_0: ryTrace,
								_1: {ctor: '[]'}
							}
						},
						function (assignedMaybeLocs) {
							var _p192 = _user$project$Utils$unwrap2(assignedMaybeLocs);
							var rightMaybeLoc = _p192._0;
							var botMaybeLoc = _p192._1;
							return A2(
								_elm_lang$core$Basics_ops['++'],
								rightEdge(rightMaybeLoc),
								botEdge(botMaybeLoc));
						},
						A4(
							finishTrigger,
							_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$RightEdge),
							{
								ctor: '::',
								_0: rxTrace,
								_1: {ctor: '[]'}
							},
							function (assignedMaybeLocs) {
								var rightMaybeLoc = _user$project$Utils$unwrap1(assignedMaybeLocs);
								return rightEdge(rightMaybeLoc);
							},
							A4(
								finishTrigger,
								_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$TopRight),
								{
									ctor: '::',
									_0: rxTrace,
									_1: {
										ctor: '::',
										_0: ryTrace,
										_1: {ctor: '[]'}
									}
								},
								function (assignedMaybeLocs) {
									var _p193 = _user$project$Utils$unwrap2(assignedMaybeLocs);
									var rightMaybeLoc = _p193._0;
									var topMaybeLoc = _p193._1;
									return A2(
										_elm_lang$core$Basics_ops['++'],
										rightEdge(rightMaybeLoc),
										topEdge(topMaybeLoc));
								},
								A4(
									finishTrigger,
									_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$TopEdge),
									{
										ctor: '::',
										_0: ryTrace,
										_1: {ctor: '[]'}
									},
									function (assignedMaybeLocs) {
										var topMaybeLoc = _user$project$Utils$unwrap1(assignedMaybeLocs);
										return topEdge(topMaybeLoc);
									},
									A4(
										finishTrigger,
										_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$TopLeft),
										{
											ctor: '::',
											_0: rxTrace,
											_1: {
												ctor: '::',
												_0: ryTrace,
												_1: {ctor: '[]'}
											}
										},
										function (assignedMaybeLocs) {
											var _p194 = _user$project$Utils$unwrap2(assignedMaybeLocs);
											var leftMaybeLoc = _p194._0;
											var topMaybeLoc = _p194._1;
											return A2(
												_elm_lang$core$Basics_ops['++'],
												leftEdge(leftMaybeLoc),
												topEdge(topMaybeLoc));
										},
										A4(
											finishTrigger,
											_user$project$ShapeWidgets$ZInterior,
											{
												ctor: '::',
												_0: cxTrace,
												_1: {
													ctor: '::',
													_0: cyTrace,
													_1: {ctor: '[]'}
												}
											},
											function (assignedMaybeLocs) {
												var _p195 = _user$project$Utils$unwrap2(assignedMaybeLocs);
												var cxMaybeLoc = _p195._0;
												var cyMaybeLoc = _p195._1;
												return A2(
													_elm_lang$core$Basics_ops['++'],
													A2(
														_user$project$Sync$mapMaybeToList,
														cxMaybeLoc,
														function (cxLoc) {
															return {
																ctor: '_Tuple5',
																_0: 'cx',
																_1: 'dx',
																_2: cxLoc,
																_3: cxTrace,
																_4: F2(
																	function (_p197, _p196) {
																		var _p198 = _p196;
																		return A4(
																			_user$project$Sync$solveOne,
																			_p202,
																			cxLoc,
																			cx + _elm_lang$core$Basics$toFloat(_p198._0),
																			cxTrace);
																	})
															};
														}),
													A2(
														_user$project$Sync$mapMaybeToList,
														cyMaybeLoc,
														function (cyLoc) {
															return {
																ctor: '_Tuple5',
																_0: 'cy',
																_1: 'dy',
																_2: cyLoc,
																_3: cyTrace,
																_4: F2(
																	function (_p200, _p199) {
																		var _p201 = _p199;
																		return A4(
																			_user$project$Sync$solveOne,
																			_p202,
																			cyLoc,
																			cy + _elm_lang$core$Basics$toFloat(_p201._1),
																			cyTrace);
																	})
															};
														}));
											},
											{ctor: '_Tuple2', _0: _elm_lang$core$Dict$empty, _1: maybeCounts})))))))));
	});
var _user$project$Sync$computeCircleTriggers = F3(
	function (_p204, maybeCounts, _p203) {
		var _p205 = _p204;
		var _p231 = _p205._1;
		var _p206 = _p203;
		var finishTrigger = A2(_user$project$Sync$addTrigger, _p205._0, _p206._0);
		var co = F2(
			function (x, y) {
				return x * y;
			})(1);
		var contra = F2(
			function (x, y) {
				return x * y;
			})(-1);
		var _p207 = _user$project$Utils$unwrap3(
			A2(
				_elm_lang$core$List$map,
				function (_p208) {
					return _user$project$LangSvg$toNum(
						A2(_user$project$Utils$find_, _p206._2, _p208));
				},
				{
					ctor: '::',
					_0: 'cx',
					_1: {
						ctor: '::',
						_0: 'cy',
						_1: {
							ctor: '::',
							_0: 'r',
							_1: {ctor: '[]'}
						}
					}
				}));
		var cx = _p207._0._0;
		var cxTrace = _p207._0._1;
		var cy = _p207._1._0;
		var cyTrace = _p207._1._1;
		var r = _p207._2._0;
		var rTrace = _p207._2._1;
		var leftEdge = function (rMaybeLoc) {
			return A2(
				_user$project$Sync$mapMaybeToList,
				rMaybeLoc,
				function (rLoc) {
					return {
						ctor: '_Tuple5',
						_0: 'r',
						_1: 'dx',
						_2: rLoc,
						_3: rTrace,
						_4: F2(
							function (_p210, _p209) {
								var _p211 = _p209;
								return A4(
									_user$project$Sync$solveOne,
									_p231,
									rLoc,
									r - _elm_lang$core$Basics$toFloat(_p211._0),
									rTrace);
							})
					};
				});
		};
		var rightEdge = function (rMaybeLoc) {
			return A2(
				_user$project$Sync$mapMaybeToList,
				rMaybeLoc,
				function (rLoc) {
					return {
						ctor: '_Tuple5',
						_0: 'r',
						_1: 'dx',
						_2: rLoc,
						_3: rTrace,
						_4: F2(
							function (_p213, _p212) {
								var _p214 = _p212;
								return A4(
									_user$project$Sync$solveOne,
									_p231,
									rLoc,
									r + _elm_lang$core$Basics$toFloat(_p214._0),
									rTrace);
							})
					};
				});
		};
		var topEdge = function (rMaybeLoc) {
			return A2(
				_user$project$Sync$mapMaybeToList,
				rMaybeLoc,
				function (rLoc) {
					return {
						ctor: '_Tuple5',
						_0: 'r',
						_1: 'dy',
						_2: rLoc,
						_3: rTrace,
						_4: F2(
							function (_p216, _p215) {
								var _p217 = _p215;
								return A4(
									_user$project$Sync$solveOne,
									_p231,
									rLoc,
									r - _elm_lang$core$Basics$toFloat(_p217._1),
									rTrace);
							})
					};
				});
		};
		var botEdge = function (rMaybeLoc) {
			return A2(
				_user$project$Sync$mapMaybeToList,
				rMaybeLoc,
				function (rLoc) {
					return {
						ctor: '_Tuple5',
						_0: 'r',
						_1: 'dy',
						_2: rLoc,
						_3: rTrace,
						_4: F2(
							function (_p219, _p218) {
								var _p220 = _p218;
								return A4(
									_user$project$Sync$solveOne,
									_p231,
									rLoc,
									r + _elm_lang$core$Basics$toFloat(_p220._1),
									rTrace);
							})
					};
				});
		};
		var corner = F3(
			function (rMaybeLoc, fx, fy) {
				return A2(
					_user$project$Sync$mapMaybeToList,
					rMaybeLoc,
					function (rLoc) {
						return {
							ctor: '_Tuple5',
							_0: 'r',
							_1: 'dxy',
							_2: rLoc,
							_3: rTrace,
							_4: F2(
								function (_p222, _p221) {
									var _p223 = _p221;
									var d = A2(
										_elm_lang$core$Basics$max,
										fx(_p223._0),
										fy(_p223._1));
									return A4(
										_user$project$Sync$solveOne,
										_p231,
										rLoc,
										r + _elm_lang$core$Basics$toFloat(d),
										rTrace);
								})
						};
					});
			});
		return A4(
			finishTrigger,
			_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$LeftEdge),
			{
				ctor: '::',
				_0: rTrace,
				_1: {ctor: '[]'}
			},
			function (assignedMaybeLocs) {
				var rMaybeLoc = _user$project$Utils$unwrap1(assignedMaybeLocs);
				return leftEdge(rMaybeLoc);
			},
			A4(
				finishTrigger,
				_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$BotLeft),
				{
					ctor: '::',
					_0: rTrace,
					_1: {ctor: '[]'}
				},
				function (assignedMaybeLocs) {
					var rMaybeLoc = _user$project$Utils$unwrap1(assignedMaybeLocs);
					return A3(corner, rMaybeLoc, contra, co);
				},
				A4(
					finishTrigger,
					_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$BotEdge),
					{
						ctor: '::',
						_0: rTrace,
						_1: {ctor: '[]'}
					},
					function (assignedMaybeLocs) {
						var rMaybeLoc = _user$project$Utils$unwrap1(assignedMaybeLocs);
						return botEdge(rMaybeLoc);
					},
					A4(
						finishTrigger,
						_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$BotRight),
						{
							ctor: '::',
							_0: rTrace,
							_1: {ctor: '[]'}
						},
						function (assignedMaybeLocs) {
							var rMaybeLoc = _user$project$Utils$unwrap1(assignedMaybeLocs);
							return A3(corner, rMaybeLoc, co, co);
						},
						A4(
							finishTrigger,
							_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$RightEdge),
							{
								ctor: '::',
								_0: rTrace,
								_1: {ctor: '[]'}
							},
							function (assignedMaybeLocs) {
								var rMaybeLoc = _user$project$Utils$unwrap1(assignedMaybeLocs);
								return rightEdge(rMaybeLoc);
							},
							A4(
								finishTrigger,
								_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$TopRight),
								{
									ctor: '::',
									_0: rTrace,
									_1: {ctor: '[]'}
								},
								function (assignedMaybeLocs) {
									var rMaybeLoc = _user$project$Utils$unwrap1(assignedMaybeLocs);
									return A3(corner, rMaybeLoc, co, contra);
								},
								A4(
									finishTrigger,
									_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$TopEdge),
									{
										ctor: '::',
										_0: rTrace,
										_1: {ctor: '[]'}
									},
									function (assignedMaybeLocs) {
										var rMaybeLoc = _user$project$Utils$unwrap1(assignedMaybeLocs);
										return topEdge(rMaybeLoc);
									},
									A4(
										finishTrigger,
										_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$TopLeft),
										{
											ctor: '::',
											_0: rTrace,
											_1: {ctor: '[]'}
										},
										function (assignedMaybeLocs) {
											var rMaybeLoc = _user$project$Utils$unwrap1(assignedMaybeLocs);
											return A3(corner, rMaybeLoc, contra, contra);
										},
										A4(
											finishTrigger,
											_user$project$ShapeWidgets$ZInterior,
											{
												ctor: '::',
												_0: cxTrace,
												_1: {
													ctor: '::',
													_0: cyTrace,
													_1: {ctor: '[]'}
												}
											},
											function (assignedMaybeLocs) {
												var _p224 = _user$project$Utils$unwrap2(assignedMaybeLocs);
												var cxMaybeLoc = _p224._0;
												var cyMaybeLoc = _p224._1;
												return A2(
													_elm_lang$core$Basics_ops['++'],
													A2(
														_user$project$Sync$mapMaybeToList,
														cxMaybeLoc,
														function (cxLoc) {
															return {
																ctor: '_Tuple5',
																_0: 'cx',
																_1: 'dx',
																_2: cxLoc,
																_3: cxTrace,
																_4: F2(
																	function (_p226, _p225) {
																		var _p227 = _p225;
																		return A4(
																			_user$project$Sync$solveOne,
																			_p231,
																			cxLoc,
																			cx + _elm_lang$core$Basics$toFloat(_p227._0),
																			cxTrace);
																	})
															};
														}),
													A2(
														_user$project$Sync$mapMaybeToList,
														cyMaybeLoc,
														function (cyLoc) {
															return {
																ctor: '_Tuple5',
																_0: 'cy',
																_1: 'dy',
																_2: cyLoc,
																_3: cyTrace,
																_4: F2(
																	function (_p229, _p228) {
																		var _p230 = _p228;
																		return A4(
																			_user$project$Sync$solveOne,
																			_p231,
																			cyLoc,
																			cy + _elm_lang$core$Basics$toFloat(_p230._1),
																			cyTrace);
																	})
															};
														}));
											},
											{ctor: '_Tuple2', _0: _elm_lang$core$Dict$empty, _1: maybeCounts})))))))));
	});
var _user$project$Sync$computeBoxOrOvalTriggers = F3(
	function (_p233, maybeCounts, _p232) {
		var _p234 = _p233;
		var _p255 = _p234._1;
		var _p235 = _p232;
		var finishTrigger = A2(_user$project$Sync$addTrigger, _p234._0, _p235._0);
		var _p236 = _user$project$Utils$unwrap4(
			A2(
				_elm_lang$core$List$map,
				function (_p237) {
					return _user$project$LangSvg$toNum(
						A2(_user$project$Utils$find_, _p235._2, _p237));
				},
				{
					ctor: '::',
					_0: 'LEFT',
					_1: {
						ctor: '::',
						_0: 'TOP',
						_1: {
							ctor: '::',
							_0: 'RIGHT',
							_1: {
								ctor: '::',
								_0: 'BOT',
								_1: {ctor: '[]'}
							}
						}
					}
				}));
		var left = _p236._0._0;
		var leftTrace = _p236._0._1;
		var top = _p236._1._0;
		var topTrace = _p236._1._1;
		var right = _p236._2._0;
		var rightTrace = _p236._2._1;
		var bot = _p236._3._0;
		var botTrace = _p236._3._1;
		var leftEdge = function (leftMaybeLoc) {
			return A2(
				_user$project$Sync$mapMaybeToList,
				leftMaybeLoc,
				function (leftLoc) {
					return {
						ctor: '_Tuple5',
						_0: 'LEFT',
						_1: 'dx',
						_2: leftLoc,
						_3: leftTrace,
						_4: F2(
							function (_p239, _p238) {
								var _p240 = _p238;
								return A4(
									_user$project$Sync$solveOne,
									_p255,
									leftLoc,
									left + _elm_lang$core$Basics$toFloat(_p240._0),
									leftTrace);
							})
					};
				});
		};
		var rightEdge = function (rightMaybeLoc) {
			return A2(
				_user$project$Sync$mapMaybeToList,
				rightMaybeLoc,
				function (rightLoc) {
					return {
						ctor: '_Tuple5',
						_0: 'RIGHT',
						_1: 'dx',
						_2: rightLoc,
						_3: rightTrace,
						_4: F2(
							function (_p242, _p241) {
								var _p243 = _p241;
								return A4(
									_user$project$Sync$solveOne,
									_p255,
									rightLoc,
									right + _elm_lang$core$Basics$toFloat(_p243._0),
									rightTrace);
							})
					};
				});
		};
		var topEdge = function (topMaybeLoc) {
			return A2(
				_user$project$Sync$mapMaybeToList,
				topMaybeLoc,
				function (topLoc) {
					return {
						ctor: '_Tuple5',
						_0: 'TOP',
						_1: 'dy',
						_2: topLoc,
						_3: topTrace,
						_4: F2(
							function (_p245, _p244) {
								var _p246 = _p244;
								return A4(
									_user$project$Sync$solveOne,
									_p255,
									topLoc,
									top + _elm_lang$core$Basics$toFloat(_p246._1),
									topTrace);
							})
					};
				});
		};
		var botEdge = function (botMaybeLoc) {
			return A2(
				_user$project$Sync$mapMaybeToList,
				botMaybeLoc,
				function (botLoc) {
					return {
						ctor: '_Tuple5',
						_0: 'BOT',
						_1: 'dy',
						_2: botLoc,
						_3: botTrace,
						_4: F2(
							function (_p248, _p247) {
								var _p249 = _p247;
								return A4(
									_user$project$Sync$solveOne,
									_p255,
									botLoc,
									bot + _elm_lang$core$Basics$toFloat(_p249._1),
									botTrace);
							})
					};
				});
		};
		return A4(
			finishTrigger,
			_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$LeftEdge),
			{
				ctor: '::',
				_0: leftTrace,
				_1: {ctor: '[]'}
			},
			function (assignedMaybeLocs) {
				var leftMaybeLoc = _user$project$Utils$unwrap1(assignedMaybeLocs);
				return leftEdge(leftMaybeLoc);
			},
			A4(
				finishTrigger,
				_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$BotLeft),
				{
					ctor: '::',
					_0: leftTrace,
					_1: {
						ctor: '::',
						_0: botTrace,
						_1: {ctor: '[]'}
					}
				},
				function (assignedMaybeLocs) {
					var _p250 = _user$project$Utils$unwrap2(assignedMaybeLocs);
					var leftMaybeLoc = _p250._0;
					var botMaybeLoc = _p250._1;
					return A2(
						_elm_lang$core$Basics_ops['++'],
						leftEdge(leftMaybeLoc),
						botEdge(botMaybeLoc));
				},
				A4(
					finishTrigger,
					_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$BotEdge),
					{
						ctor: '::',
						_0: botTrace,
						_1: {ctor: '[]'}
					},
					function (assignedMaybeLocs) {
						var botMaybeLoc = _user$project$Utils$unwrap1(assignedMaybeLocs);
						return botEdge(botMaybeLoc);
					},
					A4(
						finishTrigger,
						_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$BotRight),
						{
							ctor: '::',
							_0: rightTrace,
							_1: {
								ctor: '::',
								_0: botTrace,
								_1: {ctor: '[]'}
							}
						},
						function (assignedMaybeLocs) {
							var _p251 = _user$project$Utils$unwrap2(assignedMaybeLocs);
							var rightMaybeLoc = _p251._0;
							var botMaybeLoc = _p251._1;
							return A2(
								_elm_lang$core$Basics_ops['++'],
								rightEdge(rightMaybeLoc),
								botEdge(botMaybeLoc));
						},
						A4(
							finishTrigger,
							_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$RightEdge),
							{
								ctor: '::',
								_0: rightTrace,
								_1: {ctor: '[]'}
							},
							function (assignedMaybeLocs) {
								var rightMaybeLoc = _user$project$Utils$unwrap1(assignedMaybeLocs);
								return rightEdge(rightMaybeLoc);
							},
							A4(
								finishTrigger,
								_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$TopRight),
								{
									ctor: '::',
									_0: rightTrace,
									_1: {
										ctor: '::',
										_0: topTrace,
										_1: {ctor: '[]'}
									}
								},
								function (assignedMaybeLocs) {
									var _p252 = _user$project$Utils$unwrap2(assignedMaybeLocs);
									var rightMaybeLoc = _p252._0;
									var topMaybeLoc = _p252._1;
									return A2(
										_elm_lang$core$Basics_ops['++'],
										rightEdge(rightMaybeLoc),
										topEdge(topMaybeLoc));
								},
								A4(
									finishTrigger,
									_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$TopEdge),
									{
										ctor: '::',
										_0: topTrace,
										_1: {ctor: '[]'}
									},
									function (assignedMaybeLocs) {
										var topMaybeLoc = _user$project$Utils$unwrap1(assignedMaybeLocs);
										return topEdge(topMaybeLoc);
									},
									A4(
										finishTrigger,
										_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$TopLeft),
										{
											ctor: '::',
											_0: leftTrace,
											_1: {
												ctor: '::',
												_0: topTrace,
												_1: {ctor: '[]'}
											}
										},
										function (assignedMaybeLocs) {
											var _p253 = _user$project$Utils$unwrap2(assignedMaybeLocs);
											var leftMaybeLoc = _p253._0;
											var topMaybeLoc = _p253._1;
											return A2(
												_elm_lang$core$Basics_ops['++'],
												leftEdge(leftMaybeLoc),
												topEdge(topMaybeLoc));
										},
										A4(
											finishTrigger,
											_user$project$ShapeWidgets$ZInterior,
											{
												ctor: '::',
												_0: leftTrace,
												_1: {
													ctor: '::',
													_0: topTrace,
													_1: {
														ctor: '::',
														_0: rightTrace,
														_1: {
															ctor: '::',
															_0: botTrace,
															_1: {ctor: '[]'}
														}
													}
												}
											},
											function (assignedMaybeLocs) {
												var _p254 = _user$project$Utils$unwrap4(assignedMaybeLocs);
												var leftMaybeLoc = _p254._0;
												var topMaybeLoc = _p254._1;
												var rightMaybeLoc = _p254._2;
												var botMaybeLoc = _p254._3;
												return A2(
													_elm_lang$core$Basics_ops['++'],
													leftEdge(leftMaybeLoc),
													A2(
														_elm_lang$core$Basics_ops['++'],
														topEdge(topMaybeLoc),
														A2(
															_elm_lang$core$Basics_ops['++'],
															rightEdge(rightMaybeLoc),
															botEdge(botMaybeLoc))));
											},
											{ctor: '_Tuple2', _0: _elm_lang$core$Dict$empty, _1: maybeCounts})))))))));
	});
var _user$project$Sync$computePolyTriggers = F3(
	function (_p257, maybeCounts, _p256) {
		var _p258 = _p257;
		var _p260 = _p258._1;
		var _p259 = _p256;
		var finishTrigger = A2(_user$project$Sync$addTrigger, _p258._0, _p259._0);
		var pointX = _user$project$Sync$pointX_(_p260);
		var pointY = _user$project$Sync$pointY_(_p260);
		var addPointZones = A3(_user$project$Sync$addPointZones_, finishTrigger, pointX, pointY);
		var addEdgeZones = A3(_user$project$Sync$addEdgeZones_, finishTrigger, pointX, pointY);
		var addInteriorZone = A3(_user$project$Sync$addInteriorZone_, finishTrigger, pointX, pointY);
		var indexedPoints = A2(
			_user$project$Utils$mapi1,
			_elm_lang$core$Basics$identity,
			_user$project$LangSvg$getPolyPoints(_p259._2));
		var edges = function () {
			if (_elm_lang$core$Native_Utils.eq(_p259._1, 'polygon')) {
				return _user$project$Utils$selfZipCircConsecPairs(indexedPoints);
			} else {
				var n = _elm_lang$core$List$length(indexedPoints);
				return _user$project$Utils$selfZipCircConsecPairs(
					A2(_elm_lang$core$List$take, n - 1, indexedPoints));
			}
		}();
		return A2(
			addInteriorZone,
			indexedPoints,
			A2(
				addEdgeZones,
				edges,
				A2(
					addPointZones,
					indexedPoints,
					{ctor: '_Tuple2', _0: _elm_lang$core$Dict$empty, _1: maybeCounts})));
	});
var _user$project$Sync$computePathTriggers = F3(
	function (_p262, maybeCounts, _p261) {
		var _p263 = _p262;
		var _p265 = _p263._1;
		var _p264 = _p261;
		var finishTrigger = A2(_user$project$Sync$addTrigger, _p263._0, _p264._0);
		var pointX = _user$project$Sync$pointX_(_p265);
		var pointY = _user$project$Sync$pointY_(_p265);
		var addPointZones = A3(_user$project$Sync$addPointZones_, finishTrigger, pointX, pointY);
		var addEdgeZones = A3(_user$project$Sync$addEdgeZones_, finishTrigger, pointX, pointY);
		var addInteriorZone = A3(_user$project$Sync$addInteriorZone_, finishTrigger, pointX, pointY);
		var indexedPoints = _user$project$LangSvg$pathIndexPoints(_p264._2);
		return A2(
			addInteriorZone,
			indexedPoints,
			A2(
				addPointZones,
				indexedPoints,
				{ctor: '_Tuple2', _0: _elm_lang$core$Dict$empty, _1: maybeCounts}));
	});
var _user$project$Sync$computeFillAndStrokeTriggers = F3(
	function (_p267, maybeCounts, _p266) {
		var _p268 = _p267;
		var _p313 = _p268._1;
		var _p269 = _p266;
		var _p312 = _p269._2;
		var finishTrigger = A2(_user$project$Sync$addTrigger, _p268._0, _p269._0);
		var maybeAddColorTrigger = F3(
			function (realZone, fillOrStroke, _p270) {
				var _p271 = _p270;
				var _p278 = _p271._1;
				var _p277 = _p271._0;
				var _p272 = A2(
					_user$project$Utils$mapMaybe,
					function (_) {
						return _.av_;
					},
					A2(_user$project$Utils$maybeFind, fillOrStroke, _p312));
				if ((((_p272.ctor === 'Just') && (_p272._0.ctor === 'AColorNum')) && (_p272._0._0.ctor === '_Tuple2')) && (_p272._0._0._0.ctor === '_Tuple2')) {
					var _p276 = _p272._0._0._0._1;
					return A4(
						finishTrigger,
						realZone,
						{
							ctor: '::',
							_0: _p276,
							_1: {ctor: '[]'}
						},
						function (assignedMaybeLocs) {
							var maybeLoc = _user$project$Utils$unwrap1(assignedMaybeLocs);
							return A2(
								_user$project$Sync$mapMaybeToList,
								maybeLoc,
								function (colorLoc) {
									return {
										ctor: '_Tuple5',
										_0: fillOrStroke,
										_1: 'dx',
										_2: colorLoc,
										_3: _p276,
										_4: F2(
											function (_p274, _p273) {
												var _p275 = _p273;
												var color_ = A2(_user$project$Sync$colorNumPlus, _p272._0._0._0._0, _p275._0);
												return A4(_user$project$Sync$solveOne, _p313, colorLoc, color_, _p276);
											})
									};
								});
						},
						{ctor: '_Tuple2', _0: _p277, _1: _p278});
				} else {
					return {ctor: '_Tuple2', _0: _p277, _1: _p278};
				}
			});
		var maybeAddOpacityTrigger = F3(
			function (realZone, fillOrStroke, _p279) {
				var _p280 = _p279;
				var _p287 = _p280._1;
				var _p286 = _p280._0;
				var _p281 = A2(
					_user$project$Utils$mapMaybe,
					function (_) {
						return _.av_;
					},
					A2(_user$project$Utils$maybeFind, fillOrStroke, _p312));
				if (((((_p281.ctor === 'Just') && (_p281._0.ctor === 'AColorNum')) && (_p281._0._0.ctor === '_Tuple2')) && (_p281._0._0._1.ctor === 'Just')) && (_p281._0._0._1._0.ctor === '_Tuple2')) {
					var _p285 = _p281._0._0._1._0._1;
					return A4(
						finishTrigger,
						realZone,
						{
							ctor: '::',
							_0: _p285,
							_1: {ctor: '[]'}
						},
						function (assignedMaybeLocs) {
							var maybeLoc = _user$project$Utils$unwrap1(assignedMaybeLocs);
							return A2(
								_user$project$Sync$mapMaybeToList,
								maybeLoc,
								function (opacityLoc) {
									return {
										ctor: '_Tuple5',
										_0: A2(_elm_lang$core$Basics_ops['++'], fillOrStroke, 'Opacity'),
										_1: 'dx',
										_2: opacityLoc,
										_3: _p285,
										_4: F2(
											function (_p283, _p282) {
												var _p284 = _p282;
												var opacity_ = A2(_user$project$Sync$opacityNumPlus, _p281._0._0._1._0._0, _p284._0);
												return A4(_user$project$Sync$solveOne, _p313, opacityLoc, opacity_, _p285);
											})
									};
								});
						},
						{ctor: '_Tuple2', _0: _p286, _1: _p287});
				} else {
					return {ctor: '_Tuple2', _0: _p286, _1: _p287};
				}
			});
		var maybeAddStrokeWidthTrigger = F2(
			function (realZone, _p288) {
				var _p289 = _p288;
				var _p296 = _p289._1;
				var _p295 = _p289._0;
				var _p290 = A2(
					_user$project$Utils$mapMaybe,
					function (_) {
						return _.av_;
					},
					A2(_user$project$Utils$maybeFind, 'stroke-width', _p312));
				if (((_p290.ctor === 'Just') && (_p290._0.ctor === 'ANum')) && (_p290._0._0.ctor === '_Tuple2')) {
					var _p294 = _p290._0._0._1;
					return A4(
						finishTrigger,
						realZone,
						{
							ctor: '::',
							_0: _p294,
							_1: {ctor: '[]'}
						},
						function (assignedMaybeLocs) {
							var maybeLoc = _user$project$Utils$unwrap1(assignedMaybeLocs);
							return A2(
								_user$project$Sync$mapMaybeToList,
								maybeLoc,
								function (widthLoc) {
									return {
										ctor: '_Tuple5',
										_0: 'stroke-width',
										_1: 'dx',
										_2: widthLoc,
										_3: _p294,
										_4: F2(
											function (_p292, _p291) {
												var _p293 = _p291;
												var width_ = A2(_user$project$Sync$strokeWidthNumPlus, _p290._0._0._0, _p293._0);
												return A4(_user$project$Sync$solveOne, _p313, widthLoc, width_, _p294);
											})
									};
								});
						},
						{ctor: '_Tuple2', _0: _p295, _1: _p296});
				} else {
					return {ctor: '_Tuple2', _0: _p295, _1: _p296};
				}
			});
		var maybeAddRotationTrigger = F2(
			function (realZone, _p297) {
				var _p298 = _p297;
				var _p311 = _p298._1;
				var _p310 = _p298._0;
				var _p299 = A2(
					_user$project$Utils$mapMaybe,
					function (_) {
						return _.av_;
					},
					A2(_user$project$Utils$maybeFind, 'transform', _p312));
				if ((((((((_p299.ctor === 'Just') && (_p299._0.ctor === 'ATransform')) && (_p299._0._0.ctor === '::')) && (_p299._0._0._0.ctor === 'Rot')) && (_p299._0._0._0._0.ctor === '_Tuple2')) && (_p299._0._0._0._1.ctor === '_Tuple2')) && (_p299._0._0._0._2.ctor === '_Tuple2')) && (_p299._0._0._1.ctor === '[]')) {
					var _p309 = _p299._0._0._0._0._1;
					var _p308 = _p299._0._0._0._2._0;
					var _p307 = _p299._0._0._0._1._0;
					return A4(
						finishTrigger,
						realZone,
						{
							ctor: '::',
							_0: _p309,
							_1: {ctor: '[]'}
						},
						function (assignedMaybeLocs) {
							var maybeLoc = _user$project$Utils$unwrap1(assignedMaybeLocs);
							return A2(
								_user$project$Sync$mapMaybeToList,
								maybeLoc,
								function (rotLoc) {
									return {
										ctor: '_Tuple5',
										_0: 'transformRot',
										_1: 'dxy',
										_2: rotLoc,
										_3: _p309,
										_4: F2(
											function (_p301, _p300) {
												var _p302 = _p301;
												var _p306 = _p302._1;
												var _p305 = _p302._0;
												var _p303 = _p300;
												var _p304 = {ctor: '_Tuple2', _0: _p305 + _p303._0, _1: _p306 + _p303._1};
												var mx1 = _p304._0;
												var my1 = _p304._1;
												var radToDeg = _user$project$Utils$radiansToDegrees;
												var a0 = radToDeg(
													A2(
														_elm_lang$core$Basics$atan2,
														_p308 - _elm_lang$core$Basics$toFloat(_p306),
														_elm_lang$core$Basics$toFloat(_p305) - _p307));
												var a1 = radToDeg(
													A2(
														_elm_lang$core$Basics$atan2,
														_p308 - _elm_lang$core$Basics$toFloat(my1),
														_elm_lang$core$Basics$toFloat(mx1) - _p307));
												return A4(_user$project$Sync$solveOne, _p313, rotLoc, _p299._0._0._0._0._0 + (a0 - a1), _p309);
											})
									};
								});
						},
						{ctor: '_Tuple2', _0: _p310, _1: _p311});
				} else {
					return {ctor: '_Tuple2', _0: _p310, _1: _p311};
				}
			});
		return A2(
			maybeAddRotationTrigger,
			_user$project$ShapeWidgets$ZOther(_user$project$ShapeWidgets$Rotation),
			A2(
				maybeAddStrokeWidthTrigger,
				_user$project$ShapeWidgets$ZOther(_user$project$ShapeWidgets$StrokeWidth),
				A3(
					maybeAddColorTrigger,
					_user$project$ShapeWidgets$ZOther(_user$project$ShapeWidgets$StrokeOpacity),
					'stroke',
					A3(
						maybeAddColorTrigger,
						_user$project$ShapeWidgets$ZOther(_user$project$ShapeWidgets$FillOpacity),
						'fill',
						A3(
							maybeAddColorTrigger,
							_user$project$ShapeWidgets$ZOther(_user$project$ShapeWidgets$StrokeColor),
							'stroke',
							A3(
								maybeAddColorTrigger,
								_user$project$ShapeWidgets$ZOther(_user$project$ShapeWidgets$FillColor),
								'fill',
								{ctor: '_Tuple2', _0: _elm_lang$core$Dict$empty, _1: maybeCounts}))))));
	});
var _user$project$Sync$computeShapeTriggers = F3(
	function (info, slate, initMaybeCounts) {
		var processNode = F2(
			function (nodeInfo, _p314) {
				var _p315 = _p314;
				var _p323 = _p315._1;
				var _p322 = _p315._0;
				var _p316 = nodeInfo;
				if (_p316.ctor === 'Left') {
					return {ctor: '_Tuple2', _0: _p322, _1: _p323};
				} else {
					var _p321 = _p316._0;
					var _p317 = function () {
						var _p318 = _p321;
						var kind = _p318._1;
						var _p319 = kind;
						switch (_p319) {
							case 'line':
								return A3(_user$project$Sync$computeLineTriggers, info, _p323, _p321);
							case 'rect':
								return A3(_user$project$Sync$computeRectTriggers, info, _p323, _p321);
							case 'ellipse':
								return A3(_user$project$Sync$computeEllipseTriggers, info, _p323, _p321);
							case 'circle':
								return A3(_user$project$Sync$computeCircleTriggers, info, _p323, _p321);
							case 'BOX':
								return A3(_user$project$Sync$computeBoxOrOvalTriggers, info, _p323, _p321);
							case 'OVAL':
								return A3(_user$project$Sync$computeBoxOrOvalTriggers, info, _p323, _p321);
							case 'polygon':
								return A3(_user$project$Sync$computePolyTriggers, info, _p323, _p321);
							case 'polyline':
								return A3(_user$project$Sync$computePolyTriggers, info, _p323, _p321);
							case 'path':
								return A3(_user$project$Sync$computePathTriggers, info, _p323, _p321);
							default:
								return {ctor: '_Tuple2', _0: _elm_lang$core$Dict$empty, _1: _p323};
						}
					}();
					var directZoneTriggers = _p317._0;
					var maybeCounts_ = _p317._1;
					var _p320 = A3(_user$project$Sync$computeFillAndStrokeTriggers, info, _p323, _p321);
					var sliderZoneTriggers = _p320._0;
					var maybeCounts__ = _p320._1;
					var dict_ = A2(
						_elm_lang$core$Dict$union,
						sliderZoneTriggers,
						A2(_elm_lang$core$Dict$union, directZoneTriggers, _p322));
					return {ctor: '_Tuple2', _0: dict_, _1: maybeCounts_};
				}
			});
		return A3(
			_user$project$LangSvg$foldSlateNodeInfo,
			slate,
			{ctor: '_Tuple2', _0: _elm_lang$core$Dict$empty, _1: initMaybeCounts},
			processNode);
	});
var _user$project$Sync$toggleHeuristicMode = function (x) {
	var i = A2(_elm_lang$core$Basics_ops['%'], 1 + x, _user$project$Sync$heuristicModes);
	return i;
};
var _user$project$Sync$debugLog = _user$project$Config$debugLog(_user$project$Config$debugSync);
var _user$project$Sync$syncOptionsOf = F2(
	function (oldOptions, e) {
		var _p324 = A2(
			_user$project$Utils$maybeFind,
			'unannotated-numbers',
			_user$project$Lang$getOptions(e));
		if (_p324.ctor === 'Nothing') {
			return oldOptions;
		} else {
			var _p326 = _p324._0;
			if (_elm_lang$core$Native_Utils.eq(_p326, 'n?')) {
				return _elm_lang$core$Native_Utils.update(
					oldOptions,
					{thawedByDefault: true});
			} else {
				if (_elm_lang$core$Native_Utils.eq(_p326, 'n!')) {
					return _elm_lang$core$Native_Utils.update(
						oldOptions,
						{thawedByDefault: false});
				} else {
					var _p325 = A2(_user$project$Sync$debugLog, 'invalid sync option: ', _p326);
					return oldOptions;
				}
			}
		}
	});
var _user$project$Sync$tracesOfAVal = function (aval) {
	var _p327 = aval.av_;
	_v94_7:
	do {
		switch (_p327.ctor) {
			case 'ANum':
				if (_p327._0.ctor === '_Tuple2') {
					return {
						ctor: '::',
						_0: _p327._0._1,
						_1: {ctor: '[]'}
					};
				} else {
					break _v94_7;
				}
			case 'AColorNum':
				if ((_p327._0.ctor === '_Tuple2') && (_p327._0._0.ctor === '_Tuple2')) {
					if (_p327._0._1.ctor === 'Nothing') {
						return {
							ctor: '::',
							_0: _p327._0._0._1,
							_1: {ctor: '[]'}
						};
					} else {
						if (_p327._0._1._0.ctor === '_Tuple2') {
							return {
								ctor: '::',
								_0: _p327._0._0._1,
								_1: {
									ctor: '::',
									_0: _p327._0._1._0._1,
									_1: {ctor: '[]'}
								}
							};
						} else {
							break _v94_7;
						}
					}
				} else {
					break _v94_7;
				}
			case 'APoints':
				return A2(
					_elm_lang$core$List$concatMap,
					function (_p328) {
						var _p329 = _p328;
						return {
							ctor: '::',
							_0: _p329._0._1,
							_1: {
								ctor: '::',
								_0: _p329._1._1,
								_1: {ctor: '[]'}
							}
						};
					},
					_p327._0);
			case 'ATransform':
				if ((((((_p327._0.ctor === '::') && (_p327._0._0.ctor === 'Rot')) && (_p327._0._0._0.ctor === '_Tuple2')) && (_p327._0._0._1.ctor === '_Tuple2')) && (_p327._0._0._2.ctor === '_Tuple2')) && (_p327._0._1.ctor === '[]')) {
					return {
						ctor: '::',
						_0: _p327._0._0._0._1,
						_1: {
							ctor: '::',
							_0: _p327._0._0._1._1,
							_1: {
								ctor: '::',
								_0: _p327._0._0._2._1,
								_1: {ctor: '[]'}
							}
						}
					};
				} else {
					break _v94_7;
				}
			case 'AString':
				return {ctor: '[]'};
			case 'ARgba':
				return {ctor: '[]'};
			default:
				break _v94_7;
		}
	} while(false);
	var _p330 = A2(
		_user$project$Sync$debugLog,
		'tracesOfAVal?',
		_user$project$LangSvg$strAVal(aval));
	return {ctor: '[]'};
};
var _user$project$Sync$getLocationCounts = F2(
	function (options, _p331) {
		var _p332 = _p331;
		var weightedScore = F3(
			function (kind, _p333, acc) {
				var _p334 = _p333;
				var _p336 = _p334._1;
				var k = function () {
					var _p335 = {ctor: '_Tuple3', _0: kind, _1: _p334._0, _2: _p336.av_};
					_v98_4:
					do {
						if (((((_p335.ctor === '_Tuple3') && (_p335._0 === 'BOX')) && (_p335._2.ctor === 'ANum')) && (_p335._2._0.ctor === '_Tuple2')) && (_p335._2._0._1.ctor === 'TrLoc')) {
							switch (_p335._1) {
								case 'LEFT':
									return 2;
								case 'RIGHT':
									return 2;
								case 'TOP':
									return 2;
								case 'BOT':
									return 2;
								default:
									break _v98_4;
							}
						} else {
							break _v98_4;
						}
					} while(false);
					return 1;
				}();
				return A3(
					_elm_lang$core$Set$foldl,
					_user$project$Sync$addCount(k),
					acc,
					A2(
						_user$project$Sync$locsOfTraces,
						options,
						_user$project$Sync$tracesOfAVal(_p336)));
			});
		var addTriggerNode = F2(
			function (nodeInfo, acc) {
				var _p337 = nodeInfo;
				if (_p337.ctor === 'Left') {
					return acc;
				} else {
					return A3(
						_elm_lang$core$List$foldl,
						weightedScore(_p337._0._1),
						acc,
						_p337._0._2);
				}
			});
		var addTriggerWidget = F2(
			function (widget, acc) {
				var _p338 = widget;
				switch (_p338.ctor) {
					case 'WIntSlider':
						return A2(_user$project$Sync$updateCount, _p338._4, acc);
					case 'WNumSlider':
						return A2(_user$project$Sync$updateCount, _p338._4, acc);
					case 'WPoint':
						return A3(
							_elm_lang$core$Set$foldl,
							_user$project$Sync$updateCount,
							acc,
							A2(
								_user$project$Sync$locsOfTraces,
								options,
								{
									ctor: '::',
									_0: _p338._0._1,
									_1: {
										ctor: '::',
										_0: _p338._1._1,
										_1: {ctor: '[]'}
									}
								}));
					default:
						return A3(
							_elm_lang$core$Set$foldl,
							_user$project$Sync$updateCount,
							acc,
							A2(_user$project$Sync$locsOfTrace, options, _p338._4._1));
				}
			});
		var d = A3(_user$project$LangSvg$foldSlateNodeInfo, _p332._0, _elm_lang$core$Dict$empty, addTriggerNode);
		var d_ = A3(_elm_lang$core$List$foldl, addTriggerWidget, d, _p332._1);
		return d_;
	});
var _user$project$Sync$prepareLiveUpdates_ = F3(
	function (options, e, _p339) {
		var _p340 = _p339;
		var _p344 = _p340._1;
		var _p343 = _p340._0;
		var initSubstPlus = _user$project$FastParser$substPlusOf(e);
		var initSubst = A2(
			_elm_lang$core$Dict$map,
			_elm_lang$core$Basics$always(
				function (_) {
					return _.val;
				}),
			initSubstPlus);
		var maybeCounts = _elm_lang$core$Native_Utils.eq(options.feelingLucky, _user$project$Sync$heuristicsFair) ? _elm_lang$core$Maybe$Just(
			_user$project$Either$Right(_elm_lang$core$Dict$empty)) : (_elm_lang$core$Native_Utils.eq(options.feelingLucky, _user$project$Sync$heuristicsBiased) ? _elm_lang$core$Maybe$Just(
			_user$project$Either$Left(
				A2(
					_user$project$Sync$getLocationCounts,
					options,
					{ctor: '_Tuple2', _0: _p343, _1: _p344}))) : _elm_lang$core$Maybe$Nothing);
		var _p341 = A3(
			_user$project$Sync$computeShapeTriggers,
			{ctor: '_Tuple2', _0: options, _1: initSubst},
			_p343,
			maybeCounts);
		var shapeTriggers = _p341._0;
		var maybeCounts_ = _p341._1;
		var _p342 = A3(
			_user$project$Sync$computeWidgetTriggers,
			{ctor: '_Tuple2', _0: options, _1: initSubst},
			_p344,
			maybeCounts_);
		var widgetTriggers = _p342._0;
		var maybeCounts__ = _p342._1;
		return _elm_lang$core$Result$Ok(
			{
				initSubstPlus: initSubstPlus,
				triggers: A2(_elm_lang$core$Dict$union, shapeTriggers, widgetTriggers)
			});
	});
var _user$project$Sync$prepareLiveUpdates = F3(
	function (options, e, _p345) {
		var _p346 = _p345;
		return A3(
			_user$project$Sync$prepareLiveUpdates_,
			options,
			e,
			{ctor: '_Tuple2', _0: _p346._0, _1: _p346._1});
	});
var _user$project$Sync$tracesOfAVals = function (avals) {
	return A3(
		_elm_lang$core$List$foldl,
		F2(
			function (av, acc) {
				return A2(
					_elm_lang$core$Basics_ops['++'],
					_user$project$Sync$tracesOfAVal(av),
					acc);
			}),
		{ctor: '[]'},
		avals);
};
var _user$project$Sync$lookupZoneKey = F2(
	function (zoneKey, info) {
		var errorString = A2(
			_elm_lang$core$Basics_ops['++'],
			'lookupZoneKey: ',
			_elm_lang$core$Basics$toString(zoneKey));
		var $default = function () {
			var _p347 = A2(_user$project$Sync$debugLog, errorString, 'able to avoid this?');
			return {
				ctor: '_Tuple3',
				_0: {ctor: '[]'},
				_1: _elm_lang$core$Set$empty,
				_2: _elm_lang$core$Set$empty
			};
		}();
		var _p348 = zoneKey;
		var id = _p348._0;
		var zoneName = _p348._2;
		return A2(
			_elm_lang$core$Maybe$withDefault,
			$default,
			A2(
				_elm_lang$core$Dict$get,
				{ctor: '_Tuple2', _0: id, _1: zoneName},
				info.triggers));
	});
var _user$project$Sync$prepareLiveTrigger = F5(
	function (info, exp, zoneKey, _p350, _p349) {
		var _p351 = _p350;
		var _p352 = _p349;
		var _p353 = A2(_user$project$Sync$lookupZoneKey, zoneKey, info);
		var trigger = _p353._0;
		var yellowLocs = _p353._1;
		var initSubst = A2(
			_elm_lang$core$Dict$map,
			_elm_lang$core$Basics$always(
				function (_) {
					return _.val;
				}),
			info.initSubstPlus);
		var updates = A3(
			_elm_lang$core$List$foldl,
			F2(
				function (triggerElement, acc) {
					var _p354 = triggerElement;
					var k = _p354._2._0;
					var updateFunction = _p354._4;
					var _p355 = {
						ctor: '_Tuple2',
						_0: A2(_elm_lang$core$Dict$get, k, acc),
						_1: A2(
							updateFunction,
							{ctor: '_Tuple2', _0: _p351._0, _1: _p351._1},
							{ctor: '_Tuple2', _0: _p352._0, _1: _p352._1})
					};
					if (_p355._0.ctor === 'Nothing') {
						return A3(_elm_lang$core$Dict$insert, k, _p355._1, acc);
					} else {
						if (_p355._0._0.ctor === 'Nothing') {
							return A3(_elm_lang$core$Dict$insert, k, _p355._1, acc);
						} else {
							if (_p355._1.ctor === 'Nothing') {
								return acc;
							} else {
								return acc;
							}
						}
					}
				}),
			_elm_lang$core$Dict$empty,
			trigger);
		var newSubst = A3(
			_elm_lang$core$Dict$foldl,
			F3(
				function (k, maybeNum, acc) {
					var _p356 = maybeNum;
					if (_p356.ctor === 'Nothing') {
						return acc;
					} else {
						return A3(_elm_lang$core$Dict$insert, k, _p356._0, acc);
					}
				}),
			initSubst,
			updates);
		var highlights = A3(_user$project$Sync$highlightChanges, info.initSubstPlus, yellowLocs, updates);
		var exp_ = A2(_user$project$Lang$applyLocSubst, newSubst, exp);
		return {ctor: '_Tuple2', _0: exp_, _1: highlights};
	});
var _user$project$Sync$yellowAndGrayHighlights = F2(
	function (zoneKey, info) {
		var subst = info.initSubstPlus;
		var _p357 = A2(_user$project$Sync$lookupZoneKey, zoneKey, info);
		var yellowLocs = _p357._1;
		var grayLocs = _p357._2;
		return A2(
			_elm_lang$core$Basics_ops['++'],
			A2(
				_elm_lang$core$List$map,
				A2(_user$project$Sync$makeHighlight, subst, _user$project$Sync$yellow),
				_elm_lang$core$Set$toList(yellowLocs)),
			A2(
				_elm_lang$core$List$map,
				A2(_user$project$Sync$makeHighlight, subst, _user$project$Sync$gray),
				_elm_lang$core$Set$toList(grayLocs)));
	});
var _user$project$Sync$hoverInfo = F2(
	function (zoneKey, info) {
		var line1 = function () {
			var _p358 = zoneKey;
			var nodeId = _p358._0;
			var shapeKind = _p358._1;
			var zoneName = _p358._2;
			var displayId = (_elm_lang$core$Native_Utils.cmp(nodeId, -2) < 0) ? ((0 - nodeId) - 2) : nodeId;
			return A2(
				_elm_lang$core$Basics_ops['++'],
				A2(
					_elm_lang$core$Basics_ops['++'],
					shapeKind,
					_elm_lang$core$Basics$toString(displayId)),
				A2(_elm_lang$core$Basics_ops['++'], ' ', zoneName));
		}();
		var maybeLine2 = function () {
			var _p359 = A2(_user$project$Sync$lookupZoneKey, zoneKey, info);
			var triggerElements = _p359._0;
			if (_elm_lang$core$Native_Utils.eq(
				triggerElements,
				{ctor: '[]'})) {
				return _elm_lang$core$Maybe$Nothing;
			} else {
				var _p360 = A2(
					_elm_lang$core$List$partition,
					function (_p361) {
						var _p362 = _p361;
						return _elm_lang$core$Native_Utils.eq(_p362._1, 'dx');
					},
					triggerElements);
				var dxElements = _p360._0;
				var list2 = _p360._1;
				var _p363 = A2(
					_elm_lang$core$List$partition,
					function (_p364) {
						var _p365 = _p364;
						return _elm_lang$core$Native_Utils.eq(_p365._1, 'dy');
					},
					list2);
				var dyElements = _p363._0;
				var list3 = _p363._1;
				var _p366 = A2(
					_elm_lang$core$List$partition,
					function (_p367) {
						var _p368 = _p367;
						return _elm_lang$core$Native_Utils.eq(_p368._1, 'dxy');
					},
					list3);
				var dxyElements = _p366._0;
				var otherElements = _p366._1;
				var strElements = F2(
					function (caption, elements) {
						var foo = function (_p369) {
							var _p370 = _p369;
							var _p372 = _p370._2._2;
							var _p371 = _p370._2._0;
							var n = A3(
								_user$project$Utils$justGet_,
								A2(
									_elm_lang$core$Basics_ops['++'],
									'hoverInfo: ',
									_elm_lang$core$Basics$toString(_p371)),
								_p371,
								info.initSubstPlus);
							var locName = _elm_lang$core$Native_Utils.eq(_p372, '') ? A2(
								_elm_lang$core$Basics_ops['++'],
								'loc_',
								_elm_lang$core$Basics$toString(_p371)) : _p372;
							return A2(
								_elm_lang$core$Basics_ops['++'],
								locName,
								_user$project$Utils$parens(
									A2(
										_elm_lang$core$String$left,
										4,
										_elm_lang$core$Basics$toString(n.val))));
						};
						var _p373 = elements;
						if (_p373.ctor === '[]') {
							return {ctor: '[]'};
						} else {
							return {
								ctor: '::',
								_0: A2(
									_elm_lang$core$Basics_ops['++'],
									_user$project$Utils$bracks(caption),
									A2(
										_elm_lang$core$Basics_ops['++'],
										' ',
										_user$project$Utils$spaces(
											A2(_elm_lang$core$List$map, foo, elements)))),
								_1: {ctor: '[]'}
							};
						}
					});
				return _elm_lang$core$Maybe$Just(
					_user$project$Utils$spaces(
						_elm_lang$core$List$concat(
							{
								ctor: '::',
								_0: A2(strElements, 'dx', dxElements),
								_1: {
									ctor: '::',
									_0: A2(strElements, 'dy', dyElements),
									_1: {
										ctor: '::',
										_0: A2(strElements, 'dxy', dxyElements),
										_1: {
											ctor: '::',
											_0: A2(strElements, '...', otherElements),
											_1: {ctor: '[]'}
										}
									}
								}
							})));
			}
		}();
		return {ctor: '_Tuple2', _0: line1, _1: maybeLine2};
	});
var _user$project$Sync$Options = F3(
	function (a, b, c) {
		return {thawedByDefault: a, feelingLucky: b, unfreezeAll: c};
	});
var _user$project$Sync$LiveInfo = F2(
	function (a, b) {
		return {triggers: a, initSubstPlus: b};
	});

var _user$project$DefaultIconTheme$text = '\n; To customize, Save As: __ui__text.little\n\n(def [line2_num line2_x1] [156 41])\n(def line1_y1 36)\n(def line1\n  (let x1 (+ (/ line2_num 2!) (/ line2_x1 2!))\n  (let [x1 y2] [x1 165]\n  (let [color width] [379 15]\n    [ (line color width x1 line1_y1 x1 y2) ]))))\n\n(def line2\n  (let [color width] [379 15]\n    [ (line color width line2_x1 line1_y1 line2_num line1_y1) ]))\n\n(svgViewBox 200 200 (concat [\n  line1\n  line2\n]))\n';
var _user$project$DefaultIconTheme$lambda = '\n; To customize, Save As: __ui__lambda.little\n\n(let [x0 y0 w h delta] [10 10 180 180 10]\n(let [xw yh w2 h2] [(+ x0 w) (+ y0 h) (div w 2) (div h 2)]\n(let poly (\\pts (polygon \'black\' \'none\' 0 pts))\n(svgViewBox 200 200 [\n  (rect \'white\' x0 y0 w h)\n  (poly\n    [[(+ x0 delta) y0]\n     [xw y0]\n     [xw (- yh delta)]])\n  (poly\n    [[x0 (+ y0 delta)]\n     [x0 (- yh delta)]\n     [(- (+ x0 w2) delta) (+ y0 h2)]])\n  (poly\n    [[(+ x0 delta) yh]\n     [(- xw delta) yh]\n     [(+ x0 w2) (+ (+ y0 h2) delta)]])\n]))))\n';
var _user$project$DefaultIconTheme$path = '\n; To customize, Save As: __ui__path.little\n\n(def svgViewBox2 (\\(xMin yMin xMax yMax shapes)\n  (let [smx smy sx sy] [(toString xMin) (toString yMin) (toString xMax) (toString yMax)]\n    [\'svg\'\n      [[\'x\' \'0\'] [\'y\' \'0\'] [\'viewBox\' (joinStrings \' \' [smx smy sx sy])]]\n      shapes])))\n\n(def [rect5_h rect4_y] [131 199])\n(def [rect5_w polygon1_pts_k4931] [12 139])\n(def polygon1_pts_k4924 209.5)\n(def rect3_w 91)\n(def rect2_w 105)\n(def rect1_w 129)\n(def polygon1\n  (let pts_k4930 283\n  (let pts_k4927 256\n  (let pts_k4925 (+ polygon1_pts_k4931 -35!)\n  (let pts_k4913 (+ polygon1_pts_k4931 70!)\n  (let pts_k4919 (+ pts_k4913 (- polygon1_pts_k4931 pts_k4925))\n  (let k4922 (* 0.5! (+ pts_k4913 polygon1_pts_k4931))\n  (let pts [[polygon1_pts_k4931 pts_k4930] [polygon1_pts_k4931 pts_k4927] [pts_k4925 polygon1_pts_k4924] [k4922 78] [pts_k4919 polygon1_pts_k4924] [pts_k4913 pts_k4927] [pts_k4913 pts_k4930]]\n  (let [color strokeColor strokeWidth] [499 365 7]\n    [ (rawPolygon color strokeColor strokeWidth pts 0) ])))))))))\n(def [rect1_h rect1_copy16_y rect1_copy16_h rect2_y] [77 279 17 281])\n(def rect2_h (- (+ (+ rect1_copy16_y rect1_copy16_h) rect1_h) rect2_y))\n\n(def rect2\n  (let x (- (* 0.5! (+ (+ polygon1_pts_k4931 70!) polygon1_pts_k4931)) (* 0.5! rect2_w))\n  (let [fill stroke strokeWidth] [365 216 0]\n  (let rot 0\n    [ (rawRect fill stroke strokeWidth x rect2_y rect2_w rect2_h rot) ]))))\n\n(def rect3\n  (let x (- (* 0.5! (+ (+ polygon1_pts_k4931 70!) polygon1_pts_k4931)) (* 0.5! rect3_w))\n  (let [fill stroke strokeWidth] [408 418 0]\n  (let rot 0\n    [ (rawRect fill stroke strokeWidth x rect2_y rect3_w rect2_h rot) ]))))\n\n(def rect1_copy16\n  (let x (- (* 0.5! (+ (+ polygon1_pts_k4931 70!) polygon1_pts_k4931)) (* 0.5! rect1_w))\n  (let [fill stroke strokeWidth] [365 0 0]\n  (let rot 0\n    [ (rawRect fill stroke strokeWidth x rect1_copy16_y rect1_w rect1_copy16_h rot) ]))))\n\n(def rect1\n  (let [x y w] [138 (+ rect1_copy16_y rect1_copy16_h) 15]\n  (let [fill stroke strokeWidth] [499 410 0]\n  (let rot 0\n    [ (rawRect fill stroke strokeWidth x y w rect1_h rot) ]))))\n\n(def rect4\n  (let h (* 2! (- polygon1_pts_k4924 rect4_y))\n  (let x (+ (* 0.5! (+ (+ polygon1_pts_k4931 70!) polygon1_pts_k4931)) (- rect4_y polygon1_pts_k4924))\n  (let [fill stroke strokeWidth] [365 38 0]\n  (let rot 0\n    [ (rawRect fill stroke strokeWidth x rect4_y h h rot) ])))))\n\n(def rect5\n  (let [x y] [(- (* 0.5! (+ (+ polygon1_pts_k4931 70!) polygon1_pts_k4931)) (* 0.5! rect5_w)) (- rect4_y rect5_h)]\n  (let [fill stroke strokeWidth] [365 266 0]\n  (let rot 0\n    [ (rawRect fill stroke strokeWidth x y rect5_w rect5_h rot) ]))))\n\n(svgViewBox2 60 50 250 350 (concat [\n  polygon1\n  rect2\n  rect3\n  rect1_copy16\n  rect1\n  rect4\n  rect5]))\n';
var _user$project$DefaultIconTheme$polygon = '\n; To customize, Save As: __ui__polygon.little\n\n(def star [(nStar 365 470 7 5 45 90 3.1415 100 110)])\n\n(svgViewBox 200 200\n  star\n)\n';
var _user$project$DefaultIconTheme$ellipse = '\n; To customize, Save As: __ui__ellipse.little\n\n(def ellipse1\n  (let bounds @ [left top right bot] [25 25 175 175]\n  (let [color strokeColor strokeWidth] [365 470 7]\n    [ (oval color strokeColor strokeWidth bounds) ])))\n\n(svgViewBox 200 200 (concat [\n  ellipse1\n]))\n';
var _user$project$DefaultIconTheme$rect = '\n; To customize, Save As: __ui__rect.little\n\n(def rect1\n  (let [x y w h] [25 25 150 150]\n  (let [fill stroke strokeWidth] [365 470 7]\n  (let rot 0\n    [ (rawRect fill stroke strokeWidth x y w h rot) ]))))\n\n(svgViewBox 200 200 (concat [\n  rect1\n]))\n';
var _user$project$DefaultIconTheme$line = '\n; To customize, Save As: __ui__line.little\n\n(def line1\n  (let [x1 y1 x2 y2] [25 25 175 175]\n  (let [color width] [379 7]\n    [ (line color width x1 y1 x2 y2) ])))\n\n(svgViewBox 200 200 (concat [\n  line1\n]))\n';
var _user$project$DefaultIconTheme$pointOrOffset = '\n; To customize, Save As: __ui__pointOrOffset.little\n\n(def [x1 y1] [8 42])\n(def x2 59)\n(def arrowHeadOffset 12)\n(def x11 (- x2 arrowHeadOffset))\n\n(def line1\n  (let [x1 y1 x2 y2] [x1 y1 x2 y1]\n  (let [color width] [\'black\' 1]\n    [ (addAttr (line color width x1 y1 x2 y2) [\"stroke-dasharray\" \"1,1\"]) ])))\n\n(def line2\n  (let [x1 y1 x2 y2] [x11 (+ y1 arrowHeadOffset) x2 y1]\n  (let [color width] [\'black\' 1]\n    [ (addAttr (line color width x1 y1 x2 y2) [\"stroke-dasharray\" \"1,1\"]) ])))\n\n(def line3\n  (let [x1 y1 x2 y2] [x11 (- y1 arrowHeadOffset) x2 y1]\n  (let [color width] [\'black\' 1]\n    [ (addAttr (line color width x1 y1 x2 y2) [\"stroke-dasharray\" \"1,1\"]) ])))\n\n(def circle1\n  (let [cx cy r] [30 13 6]\n  (let fill \'white\'\n    [ (rawCircle fill 360 2 cx cy r) ])))\n\n(def circle2\n  (let [cx cy r] [x1 y1 6]\n  (let fill \'white\'\n    [ (rawCircle fill 360 2 cx cy r) ])))\n\n(svgViewBox 60 60 (concat [\n  circle1\n  circle2\n  line1\n  line2\n  line3\n]))\n';
var _user$project$DefaultIconTheme$cursor = '\n; To customize, Save As: __ui__cursor.little\n\n(def polygon1\n  (let pts_k4913 191\n  (let [pts_k4917 pts_k4911] [114 73]\n  (let k4926 (* 0.5! (+ pts_k4917 pts_k4911))\n  (let pts_k4922 124\n  (let pts_k4910 113\n  (let pts [[30 pts_k4922] [k4926 8] [157 pts_k4922] [pts_k4917 pts_k4910] [pts_k4917 pts_k4913] [pts_k4911 pts_k4913] [pts_k4911 pts_k4910]]\n  (let [color strokeColor strokeWidth] [365 470 7]\n    [ (rawPolygon color strokeColor strokeWidth pts -28.996918547567233) ]))))))))\n\n(svgViewBox 200 200 (concat [\n  polygon1\n]))\n';
var _user$project$DefaultIconTheme$icons = _elm_lang$core$Dict$fromList(
	{
		ctor: '::',
		_0: {ctor: '_Tuple2', _0: 'cursor', _1: _user$project$DefaultIconTheme$cursor},
		_1: {
			ctor: '::',
			_0: {ctor: '_Tuple2', _0: 'pointOrOffset', _1: _user$project$DefaultIconTheme$pointOrOffset},
			_1: {
				ctor: '::',
				_0: {ctor: '_Tuple2', _0: 'text', _1: _user$project$DefaultIconTheme$text},
				_1: {
					ctor: '::',
					_0: {ctor: '_Tuple2', _0: 'line', _1: _user$project$DefaultIconTheme$line},
					_1: {
						ctor: '::',
						_0: {ctor: '_Tuple2', _0: 'rect', _1: _user$project$DefaultIconTheme$rect},
						_1: {
							ctor: '::',
							_0: {ctor: '_Tuple2', _0: 'ellipse', _1: _user$project$DefaultIconTheme$ellipse},
							_1: {
								ctor: '::',
								_0: {ctor: '_Tuple2', _0: 'polygon', _1: _user$project$DefaultIconTheme$polygon},
								_1: {
									ctor: '::',
									_0: {ctor: '_Tuple2', _0: 'path', _1: _user$project$DefaultIconTheme$path},
									_1: {
										ctor: '::',
										_0: {ctor: '_Tuple2', _0: 'lambda', _1: _user$project$DefaultIconTheme$lambda},
										_1: {ctor: '[]'}
									}
								}
							}
						}
					}
				}
			}
		}
	});

var _user$project$ExamplesGenerated$task_lambda = '\n(def rectangle\n  (rect \"black\" 20 30 100 120))\n(def line1\n  (line \"white\" 5 20 30 (+ 20 100) (+ 30 120)))\n(def line2\n  (line \"white\" 5 20 (+ 30 120) (+ 20 (/ 100 2)) (+ 30 (/ 120 2))))\n\n(def logo\n  [rectangle line1 line2])\n\n(def main\n  (draw logo))\n\n\n; The final program should look something like:\n;\n;   (def [x y w h] [20 30 100 120])\n;   (def [fill stroke strokeWidth] [\"black\" \"white\" 5])\n;\n;   (def rectangle\n;     (rect fill x y w h))\n;   (def line1\n;     (line stroke strokeWidth x y (+ x w) (+ y h)))\n;   (def line2\n;     (line stroke strokeWidth x (+ y h) (+ x (/ w 2)) (+ y (/ h 2))))\n;\n;   (def logo\n;     [rectangle line1 line2])\n;\n;   (def main\n;     (draw logo))\n; <!-- PROSE --> <p>The initial program draws a <code>100</code> x <code>120</code> pixel lambda icon at xy-position <code>(20, 30)</code>, but the use of duplicated constants requires many changes if we want to draw the icon at a different position or change the style of the lines.</p><p>PLACEHOLDER INSTRUCTIONS</p><p>Goals:</p><ul><li><p>Define and use four new variables called <code>x</code>, <code>y</code>, <code>w</code>, and <code>h</code> for the x-position, y-position, width, and height, respectively, of the logo. These variables should be defined in a single 4-tuple.</p></li><li><p>Define and use two new variables called <code>stroke</code> and <code>strokeWidth</code> for the color and width, respectively, of the lines. These variables should be defined in a single 2-tuple.</p></li><li><p>Define and use a new variable called <code>fill</code> for the color of the rectangle. This variable should be defined in the same tuple as <code>stroke</code> and <code>strokeWidth</code>.</p></li></ul>\n\n';
var _user$project$ExamplesGenerated$task_four_squares = '\n(def fourSquares\n  (let [x y w] [80 30 100]\n\n    [(rect \"yellowgreen\" (+ x (* 0 w)) (+ y (* 0 w)) w w)\n     (rect \"gold\"        (+ x (* 1 w)) (+ y (* 0 w)) w w)\n     (rect \"royalblue\"   (+ x (* 0 w)) (+ y (* 1 w)) w w)\n     (rect \"salmon\"      (+ x (* 1 w)) (+ y (* 1 w)) w w)\n    ]))\n\n(def main\n  (draw fourSquares))\n\n\n; The final program should look something like:\n;\n;   (def fourSquares (\\(x y w topLeft topRight botLeft botRight)\n;\n;     (let oneCorner (\\(fill num num2)\n;       (rect fill (+ x (* num w)) (+ y (* num2 w)) w w))\n;\n;       [(oneCorner topLeft 0 0)\n;        (oneCorner topRight 1 0)\n;        (oneCorner botLeft 0 1)\n;        (oneCorner botRight 1 1)\n;       ])))\n;\n;   (def main\n;     (draw (fourSquares 80 30 100 \"yellowgreen\" \"gold\" \"royalblue\" \"salmon\")))\n; <!-- PROSE --> <p>PLACEHOLDER INSTRUCTIONS</p><p>Goals:</p><ul><li><p>Introduce a helper function called <code>oneCorner</code> that factors the code that is common to the four calls to <code>rect</code>.</p></li><li><p>Turn <code>fourSquares</code> into a function takes <code>x</code>, <code>y</code>, and <code>w</code> arguments, as well as color arguments called <code>topLeft</code>, <code>topRight</code>, <code>botLeft</code>, and <code>botRight</code>.</p></li></ul>\n\n';
var _user$project$ExamplesGenerated$task_target = '\n(def ring (\\i\n  (let fill (if (= 0 (mod i 2)) \"firebrick\" \"lightgray\")\n  (circle fill 150 150 (* 30 i)))))\n\n(def target (\\(startIndex endIndex)\n  (map ring (reverse (range startIndex endIndex)))))\n\n(def main\n  (draw (target 1 4)))\n\n\n; The final program should look something like:\n;\n;   (def target (\\(numRings cx cy num)\n;     (let ring (\\i\n;       (let fill (if (= 0 (mod i 2)) \"firebrick\" \"lightgray\")\n;       (circle fill cx cy (* num i))))\n;       (map ring (reverse (range 1 numRings))))))\n;\n;   (def main\n;     (draw (target 4 150 150 30)))\n; <!-- PROSE --> <p>PLACEHOLDER INSTRUCTIONS</p><p>Goals:</p><ul><li><p>Remove the <code>startIndex</code> argument; its value should always be <code>1</code>.</p></li><li><p>Rename <code>endIndex</code> to <code>numRings</code>.</p></li><li><p>Move the <code>ring</code> function inside the <code>target</code> definition.</p></li><li><p>Add the center position and ring width as arguments to <code>target</code>.</p></li></ul>\n\n';
var _user$project$ExamplesGenerated$task_three_rectangles = '\n(def rect1\n  (let [fill x y w h] [\"red\" 30 30 50 70]\n    (rect fill x y w h)))\n\n(def rect2\n  (let [fill x y w h] [\"green\" 109 53 50 70]\n    (rect fill x y w h)))\n\n(def rect3\n  (let [fill x y w h] [\"blue\" 192 35 50 70]\n    (rect fill x y w h)))\n\n(def main\n  (draw [ rect1 rect2 rect3 ]))\n\n\n; The final program should look something like:\n;\n;   (def rect_50_70 (\\(fill x y)\n;     (let [w h] [50 70]\n;       (rect fill x y w h))))\n;\n;   (def rect1\n;     (rect_50_70 \"red\" 30 30))\n;\n;   (def rect2\n;     (rect_50_70 \"green\" 109 53))\n;\n;   (def rect3\n;     (rect_50_70 \"blue\" 192 35))\n;\n;   (def main\n;     (draw [ rect1 rect2 rect3 ]))\n; <!-- PROSE --> <p>PLACEHOLDER INSTRUCTIONS</p><p>Goals:</p><ul><li>The three rectangle definitions share a lot of identical code. Create a function <code>rect_50_70</code> that generates a <code>50</code> x <code>70</code> rectangle given color and position arguments, and define <code>rect1</code>, <code>rect2</code>, and <code>rect3</code> in terms of <code>rect_50_70</code>.</li></ul>\n\n';
var _user$project$ExamplesGenerated$task_two_circles = '\n(def connectedCircles\n  (let startX 50\n  (let endY 50\n  (let startY 70\n  (let endX 150\n  [(circle \"gray\" startX startY 30)\n   (circle \"gray\" endX endY 30)\n   (line \"gray\" 10 startX startY endX endY)\n  ])))))\n\n(def main\n  (draw connectedCircles))\n\n\n; The final program should look something like:\n;\n;   (def connectedCircles (\\(startX startY endX endY)\n;     [(circle \"gray\" startX startY 30)\n;      (circle \"gray\" endX endY 30)\n;      (line \"gray\" 10 startX startY endX endY)\n;     ]))\n;\n;   (def main\n;     (draw (connectedCircles 50 70 150 50)))\n; <!-- PROSE --> <p>PLACEHOLDER INSTRUCTIONS</p><p>Goals:</p><ul><li>Turn <code>connectedCirlces</code> into a function takes <code>startX</code>, <code>startY</code>, <code>endX</code>, and <code>endY</code> arguments, and draws two gray circles at <code>(startX, startY)</code> and <code>(endX, endY)</code> connected by a line.</li></ul>\n\n';
var _user$project$ExamplesGenerated$task_one_rectangle = '\n(def rect1\n  (let x 20\n  (let y 20\n  (let height 250\n  (let width 80\n  (let fill \"black\"\n    (rect fill x y height width)))))))\n\n(def main\n  (draw [ rect1 ]))\n\n\n; The final program should look something like:\n;\n;   (def rect1\n;     (let [fill x y width height] [\"black\" 20 20 80 250]\n;       (rect fill x y width height)))\n;\n;   (def main\n;     (draw [ rect1 ]))\n; <!-- PROSE --> <p>PLACEHOLDER INSTRUCTIONS</p><p>Goals:</p><ul><li><p>The programmer intended the rectangle to be <code>250</code> pixels tall and <code>80</code> pixels wide, but the <code>height</code> and <code>width</code> arguments to <code>rect</code> are in the wrong order. Swap them.</p></li><li><p>Rearrange the five variable definitions into a single tuple definition. The order of variables should match the order of arguments to <code>rect</code>.</p></li></ul>\n\n';
var _user$project$ExamplesGenerated$tutorial_step_23 = '\n(def main\n  (draw []))\n; <!-- PROSE --> <p>As a final recap, there are two general mechanisms for invoking code transformation tools:</p><ul class=\"_12\"><li class=\"_1\"><h3>Text-Select Mode</h3><p><strong>(Step 1)</strong> Text-select something in the code.</p><p><strong>(Step 2a)</strong> Right-click and select a tool from pop-up menu, or</p><p><strong>(Step 2b)</strong> Select a tool from the Code Tools menu.</p><p><strong>(Step 3)</strong> Follow any instructions and finish.</p><p>In Text-Select Mode, a SINGLE, primary argument is selected FIRST, then the desired code tool is selected, and then the rest of the arguments are selected AFTERWARD (as required by the configuration panel).</p></li><li class=\"_2\"><h3>Box-Select Mode</h3><p><strong>(Step 1)</strong> Hold down Shift, hover and click boxes for all items involved for the desired code tool (then release Shift key).</p><p><strong>(Step 2)</strong> Select a tool from pop-up menu.</p><p><strong>(Step 3)</strong> Follow any instructions and finish.</p><p>In Box-Select Mode, ALL arguments are selected first, BEFORE the desired code tool is selected.</p></li></ul><p>Note that regardless of the method of selection, the Escape key will always deselect all selected boxes and cancel any pop-up menus.</p><h3 id=\"exercises\">Exercises</h3><ol style=\"list-style-type: decimal\"><li>Try the Help menu at the top of the screen; you\'ll find these summary instructions there.</li></ol>\n\n';
var _user$project$ExamplesGenerated$tutorial_step_22 = '\n(def square (\\fill (\\(w x y)\n  (rect fill x y w w))))\n\n(def redSquare (square \"salmon\"))\n\n(def yellowSquare (square \"gold\"))\n\n(def greenSquare (square \"yellowgreen\"))\n\n(def main\n  (draw\n    [(redSquare 50 80 50)\n     (yellowSquare 70 70 110)\n     (greenSquare 90 60 190)]))\n; <!-- PROSE --> <p>Lastly, because the three definitions <code>redSquare</code>, <code>yellowSquare</code>, and <code>greenSquare</code> are short, we\'d like to group them into a single tuple definition (on a single line) to save some space.</p><p>We can use the <em>Move Definition</em> tool again, this time to group definitions into a tuple. To do so, we will select only variable names (rather than entire <code>(def ...)</code> expressions) and whitespace next to variables (rather than above or below <code>(def ...)</code> expressions).</p><ul class=\"_12\"><li class=\"_1\"><h3>Text-Select Mode</h3><p>Text-select <code>redSquare</code> in the <code>(def redSquare ...)</code> expression. Then, either right-click the editor or click on the Code Tools menu at the top of the screen. From either of these menus, select <em>Move Definition</em>. Click on <code>yellowSquare</code> in the <code>(def yellowSquare ...)</code> definition. Then, click the whitespace between the keyword <code>def</code> and the variable <code>greenSquare</code>. Click on the single option from the results list.</p></li><li class=\"_2\"><h3>Box-Select Mode</h3><p>Hold down the Shift key and hover over <code>redSquare</code> in <code>(def redSquare   ...)</code>, then click. Next, hover over <code>yellowSquare</code> in <code>(def yellowSquare ...)</code>, then click. Then, click on the whitespace between the keyword <code>def</code> and the variable <code>greenSquare</code>. Under the <em>Move Definition</em> tool in the pop-up menu, select the single option from the results list.</p></li></ul><h3 id=\"exercises\">Exercises</h3><ol style=\"list-style-type: decimal\"><li>Perform the transformation with each of the two interactions. Use Undo after each to reset the program.</li></ol>\n\n';
var _user$project$ExamplesGenerated$tutorial_step_21 = '\n(def square (\\fill (\\(w x y)\n  (rect fill x y w w))))\n\n(def redSquare (square \"salmon\"))\n\n(def greenSquare (square \"yellowgreen\"))\n\n(def yellowSquare (square \"gold\"))\n\n(def main\n  (draw\n    [(redSquare 50 80 50)\n     (yellowSquare 70 70 110)\n     (greenSquare 90 60 190)]))\n; <!-- PROSE --> <p>A couple more things before we\'re done! We\'d like to reorder the function definitions to match the order in which we use them, just for the sake of consistency (red, yellow, then green).</p><p>To do so, we can use the <em>Move Definition</em> tool.</p><ul class=\"_12\"><li class=\"_1\"><h3>Text-Select Mode</h3><p>Text-select the entire <code>(def greenSquare ...)</code> expression starting from its opening parenthesis until its closing parenthesis. Then, either right-click the editor or click on the Code Tools menu at the top of the screen. From either of these menus, select <em>Move Definition</em>. Click on the whitespace below the <code>yellowSquare</code> definition (above the <code>main</code> definition). Click on the single option from the results list.</p></li><li class=\"_2\"><h3>Box-Select Mode</h3><p>Hold down the Shift key and hover over the keyword <code>def</code> in <code>(def   greenSquare ...)</code>, then click. Then, click on the whitespace below the <code>yellowSquare</code> definition (above the <code>main</code> definition). Release the Shift key. Under the Move Definition tool in the pop-up menu, select the single option from the results list.</p></li></ul><h3 id=\"exercises\">Exercises</h3><ol style=\"list-style-type: decimal\"><li>Perform the transformation with each of the two interactions. Use Undo after each to reset the program.</li></ol>\n\n';
var _user$project$ExamplesGenerated$tutorial_step_20 = '\n(def redSquare (\\(w x y)\n  (rect \"salmon\" x y w w)))\n\n(def greenSquare (\\(w x y)\n  (rect \"yellowgreen\" x y w w)))\n\n(def yellowSquare (\\(w x y)\n  (rect \"gold\" x y w w)))\n\n(def main\n  (draw\n    [(redSquare 50 80 50)\n     (yellowSquare 70 70 110)\n     (greenSquare 90 60 190)]))\n; <!-- PROSE --> <p>Here are some friends for our <code>redSquare</code> function. However, a lot of the code from <code>redSquare</code> has been duplicated in the two new functions; in fact, the only thing that has changed is the color.</p><p>Sketch-n-Sketch provides a <em>Create Function by Merging Definitions</em> code tool that we can use in this situation to abstract much of the repeated code into a helper function.</p><ul class=\"_12\"><li class=\"_1\"><h3>Text-Select Mode</h3><p>Text-select the entire <code>(def redSquare ...)</code> expression starting from its opening parenthesis until its closing parenthesis. Then, either right-click the editor or click on the Code Tools menu at the top of the screen. From either of these menus, select <em>Create Function by Merging Definitions</em>. Hover over the keyword <code>def</code> in <code>(def greenSquare ...)</code>, then click. Hover over the keyword <code>def</code> in <code>(def yellowSquare ...)</code>, then click. Click on the single option from the results list.</p></li><li class=\"_2\"><h3>Box-Select Mode</h3><p>Hold down the Shift key and hover over the keyword <code>def</code> in <code>(def   redSquare ...)</code>, then click. Hover over the keyword <code>def</code> in <code>(def   greenSquare ...)</code>, then click. Hover over the keyword <code>def</code> in <code>(def   yellowSquare ...)</code>, then click. Release the Shift key. Under the <em>Merge Expressions into Function</em> tool in the pop-up menu, select the single option from the results list.</p></li></ul><h3 id=\"exercises\">Exercises</h3><ol style=\"list-style-type: decimal\"><li>Perform the transformation with each of the two interactions. Use Undo after each to reset the program.</li></ol>\n\n';
var _user$project$ExamplesGenerated$tutorial_step_19 = '\n(def redSquare (\\(w y)\n  (rect \"salmon\" 100 y w w)))\n\n(def main\n  (draw\n    [(redSquare 80 70)\n     (redSquare 30 160)\n     (redSquare 150 200)]))\n; <!-- PROSE --> <p>On second thought... we realize we\'d like to change the x-position of some of the boxes after all.</p><p>To do so, we can use the <em>Add Argument</em> tool.</p><ul class=\"_12\"><li class=\"_1\"><h3>Text-Select Mode</h3><p>Text-select the number <code>100</code> in the <code>rect</code> function call. Then, either right-click the editor or click on the Code Tools menu at the top of the screen. From either of these menus, select <em>Add Argument</em>. Click on the single option from the results list.</p></li><li class=\"_2\"><h3>Box-Select Mode</h3><p>Hold down the Shift key and click on the number <code>100</code> in the <code>rect</code> function call. Under the <em>Add Argument</em> tool in the pop-up menu, select the single option from the results list.</p></li></ul><h3 id=\"exercises\">Exercises</h3><ol style=\"list-style-type: decimal\"><li>Perform the transformation with each of the two interactions. Use Undo after each to reset the program. Feel free to manually edit the x-position of the squares after you have performed the transformation!</li></ol>\n\n';
var _user$project$ExamplesGenerated$tutorial_step_18 = '\n(def redSquare (\\(w x y)\n  (rect \"salmon\" x y w w)))\n\n(def main\n  (draw\n    [(redSquare 80 100 70)\n     (redSquare 30 100 160)\n     (redSquare 150 100 200)]))\n; <!-- PROSE --> <p>While refactoring the function in the previous step, we notice something else we\'d like to change; every single time our function is called, we always set the x-position to <code>100</code>, so we decide to just remove the x-position argument.</p><p>To do so, we can use the <em>Remove Argument</em> tool.</p><ul class=\"_12\"><li class=\"_1\"><h3>Text-Select Mode</h3><p>Text-select the argument <code>x</code> in the list of arguments after the backslash in the <code>redSquare</code> function definition. Then, either right-click the editor or click on the Code Tools menu at the top of the screen. From either of these menus, select <em>Remove Argument</em>. Click on the single option from the results list.</p></li><li class=\"_2\"><h3>Box-Select Mode</h3><p>Hold down the Shift key and click on the argument <code>x</code> in the list of arguments after the backslash in the <code>redSquare</code> function definition. Release the Shift key. Under the <em>Remove Argument</em> tool in the pop-up menu, select the single option form the results listn.</p></li></ul><h3 id=\"exercises\">Exercises</h3><ol style=\"list-style-type: decimal\"><li>Perform the transformation with each of the two interactions. Use Undo after each to reset the program.</li></ol>\n\n';
var _user$project$ExamplesGenerated$tutorial_step_17 = '\n(def redSquare (\\(x y w)\n  (rect \"salmon\" x y w w)))\n\n(def main\n  (draw\n    [(redSquare 100 70 80)\n     (redSquare 100 160 30)\n     (redSquare 100 200 150)]))\n; <!-- PROSE --> <p>Let\'s say we\'ve now coded up a nice piece of art using our newly-defined function. However, we now want to change how the <code>redSquare</code> function is called; instead of the size of the square being the last argument that we pass in, we\'d prefer if it were the first.</p><p>To do this, we can use the <em>Reorder Arguments</em> tool.</p><ul class=\"_12\"><li class=\"_1\"><h3>Text-Select Mode</h3><p>Text-select the argument <code>w</code> in the list of arguments after the backslash in the <code>redSquare</code> function definition. Then, either right-click the editor or click on the Code Tools menu at the top of the screen. From either of these menus, select <em>Reorder Arguments</em>. Click on the target position that lies before the first argument (<code>x</code>) and after the opening parenthesis of the argument list. Click on the single option from the results list.</p></li><li class=\"_2\"><h3>Box-Select Mode</h3><p>Hold down the Shift key and click on the argument <code>w</code> in the list of arguments after the backslash in the <code>redSquare</code> function definition. Then, click on the target position that lies before the first argument (<code>x</code>) and after the opening parenthesis of the argument list. Release the Shift key. Under the <em>Reorder Arguments</em> tool in the pop-up menu, select the single option from the results list.</p></li></ul><h3 id=\"exercises\">Exercises</h3><ol style=\"list-style-type: decimal\"><li>Perform the transformation with each of the two interactions. Use Undo after each to reset the program.</li></ol>\n\n';
var _user$project$ExamplesGenerated$tutorial_step_16 = '\n(def redSquare\n  (let [x y] [100 70]\n  (let w 80\n    (rect \"salmon\" x y w w))))\n\n(def main\n  (draw [redSquare]))\n; <!-- PROSE --> <p>Next, we will use the <em>Create Function from Definition</em> tool to turn this definition into a function so that it can be called to create more red squares easily.</p><p>We can invoke <em>Create Function from Definition</em> in two main ways:</p><ul class=\"_12\"><li class=\"_1\"><h3>Text-Select Mode</h3><p>Text-select the entire <code>(def redSquare ...)</code> expression starting from its opening parenthesis until its closing parenthesis. Then, either right-click the editor or click on the Code Tools menu at the top of the screen. From either of these menus, select <em>Create Function from Definition</em>.</p></li><li class=\"_2\"><h3>Box-Select Mode</h3><p>Hold down the Shift key, hover over the keyword <code>def</code> in <code>(def redSquare   ...)</code>, then click. Release the Shift key. Select <em>Create Function from Definition</em> from the pop-up menu.</p></li></ul><p>No matter how the <em>Create Function from Definition</em> tool is invoked, there are two options in the results list that we can select from. Because the point of this function is to draw a <em>red</em> square, we\'ll pick the option that does not make color one of the resulting function arguments.</p><p>Notice how the reference to this expression in <code>main</code> has now turned into a function call.</p><h3 id=\"exercises\">Exercises</h3><ol style=\"list-style-type: decimal\"><li>Perform the transformation with each of the two interactions. Use Undo after each to reset the program.</li></ol>\n\n';
var _user$project$ExamplesGenerated$tutorial_step_15 = '\n(def redSquare\n  (let [x y] [100 70]\n    (rect \"salmon\" x y 120 80)))\n\n(def main\n  (draw [redSquare]))\n; <!-- PROSE --> <p>Thinking back on the previous example, we successfully turned the rectangle into a square by copying the width and height values. But now if we want to change the size of the square, we must remember to change <em>both</em> values in sync.</p><p>Instead, we may want a single variable to take the place of multiple expressions (in this case, the width and height). The <em>Make Equal with Single Variable</em> tool does just that.</p><p>We can invoke <em>Make Equal with Single Variable</em> in two main ways:</p><ul class=\"_12\"><li class=\"_1\"><h3>Text-Select Mode</h3><p>Text-select either <code>120</code> or <code>80</code>. Then, either right-click the editor or click on the Code Tools menu at the top of the screen. From either of these menus, select <em>Make Equal with Single Variable</em>. Click on the remaining number (either <code>120</code> or <code>80</code>). Click on one of the results from the list that appears to apply the transformation.</p><p><strong>Reminder:</strong> in Text-Select Mode, a SINGLE, primary argument is selected FIRST, then the desired tool is selected, and then the rest of the arguments are selected AFTERWARD (as required by the configuration panel).</p></li><li class=\"_2\"><h3>Box-Select Mode</h3><p>Hold down Shift, then click on <code>120</code> and <code>80</code>. Release the Shift key and select <em>Make Equal with Single Variable</em> from the pop-up menu. Click on one of the results from the list that appears to apply the transformation.</p><p><strong>Reminder:</strong> in Box-Select Mode, ALL arguments are selected first, BEFORE the desired code transformation is selected.</p></li></ul><h3 id=\"exercises\">Exercises</h3><ol style=\"list-style-type: decimal\"><li>Fix the <code>redSquare</code> definition using each of the two interactions. Use Undo after each interaction to reset the program.</li></ol>\n\n';
var _user$project$ExamplesGenerated$tutorial_step_14 = '\n(def redSquare\n  (let [x y] [100 70]\n    (rect \"salmon\" x y 120 80)))\n\n(def main\n  (draw [redSquare]))\n; <!-- PROSE --> <p>In this code snippet, the rectangle should have sides of equal length, but the width and height (fourth and fifth) arguments of the <code>rect</code> function call are not equal. The <em>Make Equal by Copying</em> tool can be used to copy one expression to replace one or more other expressions.</p><p>As with all Sketch-n-Sketch code tools, there are two main ways that we can use the <em>Make Equal by Copying</em> tool:</p><ul class=\"_12\"><li class=\"_1\"><h3>Text-Select Mode</h3><p>Text-select either <code>120</code> or <code>80</code>. Then, either right-click the editor or click on the Code Tools menu at the top of the screen. From either of these menus, select <em>Make Equal by Copying</em>. Click on the remaining number (either <code>120</code> or <code>80</code>). Click on one of the results from the list that appears to apply the transformation.</p><p><strong>Note:</strong> in Text-Select Mode, a SINGLE, primary argument is selected FIRST, then the desired tool is selected, and then the rest of the arguments are selected AFTERWARD (as required by the configuration panel).</p></li><li class=\"_2\"><h3>Box-Select Mode</h3><p>Hold down Shift, then click on <code>120</code> and <code>80</code>. Release the Shift key and select <em>Make Equal by Copying</em> from the pop-up menu. Click on one of the results from the list that appears to apply the transformation.</p><p><strong>Note:</strong> in Box-Select Mode, ALL arguments are selected first, BEFORE the desired code transformation is selected.</p></li></ul><h3 id=\"exercises\">Exercises</h3><ol style=\"list-style-type: decimal\"><li>Fix the <code>redSquare</code> definition using each of the two interactions. Use Undo after each interaction to reset the program.</li></ol>\n\n';
var _user$project$ExamplesGenerated$tutorial_step_13 = '\n(def redSquare\n  (let [x y] [100 70]\n    (rect \"salmon\" x y 80 80)))\n\n(def main\n  (draw [redSquare]))\n; <!-- PROSE --> <p>As introduced in the previous step, a <em>target position</em> is the whitespace between or above other items in the code. Before moving on to the next tool, let\'s get more practice selecting target positions.</p><h3 id=\"exercises\">Exercises</h3><p>In the interactions below, notice how target positions are sometimes zero characters wide and sometimes span multiple lines.</p><ol style=\"list-style-type: decimal\"><li><p>Hold down the Shift key, and select the target position above <code>redSquare</code> either by selecting the whitespace on line 1 or at the very beginning of line 2. Notice how there are no available tools when only a target position is selected.</p></li><li><p>Hold down the Shift key, and select the target position above <code>main</code>. Notice how selecting a second target position deselects the previous one  at most one target position can be selected at a time.</p></li><li><p>Hold down the Shift key, and hover and select each of the following target positions on line 3:</p></li></ol><ul><li>between the beginning of the line and <code>(let</code>, and</li><li>between <code>let</code> and <code>[x</code>,</li><li>between <code>[</code> and <code>x</code>,</li><li>between <code>x</code> and <code>y</code>,</li><li>between <code>y</code> and <code>]</code>,</li><li>between <code>y]</code> and <code>[100</code>,</li><li>between <code>[</code> and <code>100</code>,</li><li>between <code>100</code> and <code>70</code>,</li><li>between <code>70</code> and <code>]</code>, and</li><li>between <code>70]</code> and the end of the line.</li></ul>\n\n';
var _user$project$ExamplesGenerated$tutorial_step_12 = '\n(def redSquare\n  (rect \"salmon\" 100 70 80 80))\n\n(def main\n  (draw [redSquare]))\n; <!-- PROSE --> <p>Many times, when using a function like <code>rect</code>, passing in multiple constants rather than named variables can lead to confusion as to the purpose of each constant.</p><p>To alleviate this, we can introduce variables using the <em>Introduce Variable</em> tool. This tool uses the notion of a <em>target position</em>, which is the whitespace between or above other items in the code. Target positions typically allow us to select where we want resultant transformations to appear in the code. In the case of the <em>Introduce Variable</em> tool, the target position indicates where we would like the variables to be introduced.</p><p>Let\'s try out the <em>Introduce Variable</em> tool on the x- and y- positions of the red square (the first two arguments of the <code>rect</code> function after the color, &quot;salmon&quot;).</p><p>We can use this code tool (and all others) in two main ways:</p><ul class=\"_12\"><li class=\"_1\"><h3>Text-Select Mode</h3><p>Text-select one of the <code>80</code>s, then either right-click the editor or click on the Code Tools menu at the top of the screen. From either of these menus, select <em>Introduce Variable</em>. The configuration panel asks for one or more expressions for which variables will be introduced, as well as an optional target position. Click the other <code>80</code>, then click the whitespace (on line 3) before the call to <code>rect</code> or the whitespace (on line 1) above the <code>def</code>. Apply the transformation from the results list.</p></li><li class=\"_2\"><h3>Box-Select Mode</h3><p>Hold down Shift, then click on both occurrences of the number <code>80</code>, as well as the whitespace (on line 3) before the call to <code>rect</code> or the whitespace (on line 1) above the <code>def</code>. Release the Shift key and select <em>Introduce Variables</em> from the pop-up menu. Apply the transformation from the results list.</p><p><strong>Note:</strong> Remember to hold down Shift while selecting multiple arguments.</p></li></ul><h3 id=\"exercises\">Exercises</h3><ol style=\"list-style-type: decimal\"><li>Introduce <code>x</code> and <code>y</code> variables with each of the two interactions. Use Undo after each to reset the program.</li></ol>\n\n';
var _user$project$ExamplesGenerated$tutorial_step_11 = '\n(def blueSquare\n  (rect \"salmon\" 100 70 80 80))\n\n(def main\n  (draw [blueSquare]))\n; <!-- PROSE --> <p>Here is the incorrectly-named red square again. Besides selecting <em>Rename Variable</em> directly from the Code Tools menu, there are a few ways additional ways to invoke the <em>Rename</em> tool:</p><ul class=\"_123\"><li class=\"_1\"><h3>Text-Select Mode (right-click menu)</h3><p>Select the text <code>blueSquare</code>, right-click the editor, and select the <em>Rename</em> tool from the pop-up menu. Then, enter a new name (like <code>redSquare</code>) in the results list and press Enter.</p><p><strong>Note:</strong> The Escape key will make the menu or panel go away. <em> Undo</em> will let you go back.</p></li><li class=\"_2\"><h3>Text-Select Mode (Code Tools menu)</h3><p>Select the text <code>blueSquare</code>, and select the <em>Rename</em> Variable tool from the Code Tools menu at the top-left of the screen. Then enter a new name (like <code>redSquare</code>) in the results list and press Enter.</p><p><strong>Note:</strong> The Escape key will make the panel go away. <em> Undo</em> will let you go back.</p></li><li class=\"_3\"><h3>Box-Select Mode</h3><p>Hold down the Shift key, hover over <code>blueSquare</code>, click the box that pops up over <code>blueSquare</code>, and then release the Shift key. Select the <em>Rename</em> tool from the pop-up menu. Enter a new name (like <code>redSquare</code>) in the results list and press Enter.</p><p><strong>Note:</strong> The Escape key will clear any selections and make the menu go away. <em> Undo</em> will let you go back.</p></li></ul><p>Unlike with text edits, you do <em>not</em> need to hit the Run button after invoking a code transformation.</p><h3 id=\"exercises\">Exercises</h3><ol style=\"list-style-type: decimal\"><li><p>Perform the renaming with each of the three interactions. Use Undo after each to reset the program.</p></li><li><p><strong>Tip:</strong> To save time in Text-Select Mode, a right-click can be performed without a text selection for <em>variables</em> and <em>constants</em> (but not for more complicated expressions). In this case, Sketch-n-Sketch will automatically select the variable or constant that contains the click that was performed. Try this out by redoing the instructions for <em>Text-Select Mode (right-click menu)</em>, this time by right-clicking <code>blueSquare</code> without text-selecting it.</p></li><li><p><strong>Tip:</strong> The pop-up panels can be re-positioned if they are covering up relevant parts of the code. Redo any one of the interactions and, when a pop-up panel appears, click and drag the top bar to move it somewhere else.</p></li></ol>\n\n';
var _user$project$ExamplesGenerated$tutorial_step_10 = '\n(def blueSquare\n  (rect \"salmon\" 100 70 80 80))\n\n(def main\n  (draw [blueSquare]))\n; <!-- PROSE --> <p>Here is a red square. Unfortunately, the name of the function that generates this red square is incorrect. To fix this, we can use one of the <em>code tools</em> that are built in to Sketch-n-Sketch.</p><p>The Code Tools menu at the top-left of the screen lists all of the tools. In this case, we want the <em>Rename Variable</em> to rename the variable at its definition on line 2 and its use on line 6.</p><h3 id=\"exercises\">Exercises</h3><ol style=\"list-style-type: decimal\"><li>Choose the <em>Rename Variable</em> tool from the Code Tools menu. The configuration panel that appears asks for a variable to be selected. Hover over and click <code>blueSquare</code> either on line 2 or line 6. Notice that the Code Updates section of the configuration panel now displays a text box in which to enter a new name. Type a new name (like <code>redSquare</code>) in the text box and press Enter. Notice how the variable definition and use are changed. Unlike with text edits, you do <em>not</em> need to hit the Run button after invoking a code transformation.</li></ol>\n\n';
var _user$project$ExamplesGenerated$tutorial_step_09 = '\n(def main\n  (draw []))\n; <!-- PROSE --> <p>So far, we\'ve seen how to write code using the text editor.</p><p>Next, we\'ll see some tools that Sketch-n-Sketch provides for automatically performing code transformations.</p>\n\n';
var _user$project$ExamplesGenerated$tutorial_step_08 = '\n(def redLine\n  (let [w x1 y1 x2 y2] [4 100 100 300 300]\n    (line \"salmon\" w x1 y1 x2 y2)))\n\n(def greenRect\n  (let [x y w h] [100 100 150 80]\n    (rect \"lightgreen\" x y w h)))\n\n(def blueCircle\n  (let [cx cy r] [100 100 20]\n    (circle \"lightblue\" cx cy r)))\n\n(def main\n  (draw [redLine greenRect blueCircle]))\n; <!-- PROSE --> <p>Now we\'ll see how to draw three basic shapes: lines, rectangles, and circles. Notice how elements later in the <code>main</code> list appear on top of earlier ones.</p><h3 id=\"exercises\">Exercises</h3><ol style=\"list-style-type: decimal\"><li><p>Make the rectangle a square.</p></li><li><p>Reorder the elements in <code>main</code> so that the red line is on top of the green rectangle.</p></li><li><p>All three shapes share the xy-point <code>(100, 100)</code>. Define variables for these two values and use them in all three shapes.</p></li></ol>\n\n';
var _user$project$ExamplesGenerated$tutorial_step_07 = '\n(def foo (\\(x y) [(+ x y) (- x y) (* x y) (/ x y)]))\n\n(def multiply3 (\\(x y z) (* x (* y z))))\n\n(def max (\\(x y)\n  (if (< x y) y x)))\n\n(def main\n  (draw [\n    (show (foo 3 4))\n  ]))\n; <!-- PROSE --> <p>The language has several binary operators, as well as if-then-else-expressions.</p><p>Don\'t worry about the syntax too much.</p><h3 id=\"exercises\">Exercises</h3><ol style=\"list-style-type: decimal\"><li><p>Replace the call to <code>foo</code> in the <code>main</code> expression with a call to <code>multiply3</code>.</p></li><li><p>Replace the call to <code>foo</code> in the <code>main</code> expression with a call to <code>max</code>.</p></li></ol>\n\n';
var _user$project$ExamplesGenerated$tutorial_step_06 = '\n(def triplicate (\\x [x x x]))\n\n(def triplicate2 (\\(x y) [x y x y x y]))\n\n(def main\n  (draw [(show (triplicate 3))]))\n; <!-- PROSE --> <p>The syntax for a function expression is <code>(\\x e)</code>, which defines a function that takes an argument <code>x</code> and returns the expression <code>e</code>.</p><p>The syntax for a multi-argument function is <code>(\\(x1 x2 x3 ...) e)</code>. Notice the parentheses surrounding the list of arguments.</p><p>For example, the function <code>triplicate</code> takes a single argument <code>x</code> (and returns a list that repeats <code>x</code> three times), and <code>triplicate2</code> takes two arguments. To call any function, the function name and its argument are separated by a space, and the entire call is surrounded by parentheses.</p><h3 id=\"exercises\">Exercises</h3><ol style=\"list-style-type: decimal\"><li><p>Rename the argument of <code>triplicate</code> to something else and re-run.</p></li><li><p>Add the function call <code>(triplicate2 3 4)</code> in the <code>main</code> expression.</p></li><li><p>Call <code>triplicate2</code> with too many arguments. You\'ll see a run-time error.</p></li><li><p>Call <code>triplicate2</code> with too few arguments. You won\'t get a run-time error, but the result shown will be <code>&lt;fun&gt;</code> (a function that is waiting for the rest of its arguments).</p></li></ol>\n\n';
var _user$project$ExamplesGenerated$tutorial_step_05 = '\n(def nums\n  (let one 1\n    [one \"two\" one \"two\"]))\n\n(def main\n  (draw [(show nums)]))\n; <!-- PROSE --> <p>In addition to top-level definitions, local variables can be created using a different keyword called <code>let</code>. For example, within the <code>nums</code> definition, we can define the local variable <code>one</code> to hold the value <code>1</code>, and then refer to that value with the name <code>one</code> in the rest of the let-expression.</p><p>The syntax for a let definition is <code>(let x e1 e2)</code>, which says &quot;let <code>x</code> refer to <code>e1</code> when evaluating <code>e2</code>&quot;. Notice how parentheses surround the entire let definition.</p><p>The binding of <code>x</code> is only in scope in the expression <code>e2</code>. For example, the <code>one</code> variable in this code is not in scope outside of the <code>nums</code> definition.</p><h3 id=\"exercises\">Exercises</h3><ol style=\"list-style-type: decimal\"><li><p>Try referencing the <code>one</code> variable outside the <code>nums</code> definition.</p></li><li><p>Tuple patterns can be used in let definitions. Define the tuple pattern <code>[one two]</code> to be <code>[1 2]</code> inside <code>nums</code>.</p></li></ol>\n\n';
var _user$project$ExamplesGenerated$tutorial_step_04 = '\n(def [one two] [1 \"two\"])\n\n(def main\n  (draw [(show [one two one two])]))\n; <!-- PROSE --> <p>We use the term &quot;tuple&quot; to describe a list with a fixed number of elements. For example, the list expression <code>[1 &quot;two&quot;]</code> in this code is a 2-tuple, that is, a list with exactly two elements.</p><p>Notice how we access the components of tuple expressions with tuple patterns (instead of just plain variables) on the left-hand side of definitions. The tuple pattern <code>[one two]</code> above matches a list with exactly two elements, binding the name one to the first element and two to the second.</p><p>If the tuple pattern and tuple expression do not have the same number of elements, Sketch-n-Sketch throws a run-time error.</p><h3 id=\"exercises\">Exercises</h3><ol style=\"list-style-type: decimal\"><li><p>Add a third variable to the tuple pattern and a third value to the list expression, and re-run.</p></li><li><p>Remove one of the expressions from the list expression (so that the number of variables and expressions are unequal), and re-run.</p></li></ol>\n\n';
var _user$project$ExamplesGenerated$tutorial_step_03 = '\n(def str \"hello world!\")\n\n(def num 3.14)\n\n(def bool true)\n\n(def list\n  [1 2 3 true [false \"abc\"] str num bool])\n\n(def main\n  (draw [(show list)]))\n; <!-- PROSE --> <p>The language has several kinds of data: strings, numbers, booleans, and lists.</p><p>Lists are written with square brackets and with spaces separating the elements.</p><p>The language does not have static types, so we can mix and match different types of elements within a list.</p>\n\n';
var _user$project$ExamplesGenerated$tutorial_step_02 = '\n(def x 1)   ; var x = 1\n\n(def y 2)   ; var y = 2\n\n(def z 3)   ; var z = 3\n\n(def main\n  (draw []))\n; <!-- PROSE --> <p>The structure of a program is a series of top-level definitions. The last definition is called <code>main</code> and describes the image to draw in the canvas area on the right. The initial <code>main</code> expression has an empty list, so nothing is drawn.</p><p>Note that any text on the same line following a semicolon (<code>; like this</code>) is a <em>comment</em> and has no effect on the output of the program.</p><h3 id=\"exercises\">Exercises</h3><ol style=\"list-style-type: decimal\"><li><p>Add the expression <code>(show &quot;hello world!&quot;)</code> to the list of drawings. Notice how the border of the canvas turns red; this indicates that the code needs to be re-run. Hit the Run button.</p></li><li><p>Now define this expression in a new variable instead, and refer to it in the <code>main</code> expression.</p></li><li><p>Remove a comment from the program. Notice how this change has no effect on the output.</p></li><li><p>Add extra parentheses somewhere and re-run. You will get a syntax error. Many expressions start and end with parentheses; extra parentheses are not allowed.</p></li></ol>\n\n';
var _user$project$ExamplesGenerated$tutorial_step_01 = '\n(def main\n  (draw []))\n; <!-- PROSE --> <p>Sketch-n-Sketch programs are written in a small functional language with features commonly found in other functional languages and with syntax that resembles Lisp or Racket. Significant or recent experience with functional programming is not necessary to complete the tasks.</p><p>To start, we will introduce the basics of how the language works.</p><p><strong>Note:</strong> You will <em>not</em> need to memorize all the precise details of how the language works; a basic and general understanding will be sufficient for this user study.</p>\n\n';
var _user$project$ExamplesGenerated$study_end = '\n(def main\n  (draw [(show \"That\'s the end of the tasks!\")]))\n; <!-- PROSE --> <p>You\'re all done with the programming exercises!</p><p>One last thing: please fill out the <a href=\"/survey\">exit survey</a>.</p><p>Thanks!</p>\n\n';
var _user$project$ExamplesGenerated$study_transition_2 = '\n(def main\n  (draw []))\n; <!-- PROSE --> <p>In the final section, you will see two example programs, each with a list of editing tasks. As before, you will <em>not</em> be able to use text editing. But, this time, you will be able to use <em>either</em>:</p><ul><li>code tools with Text-Select Mode, or</li><li>code tools with Box-Select Mode.</li></ul><p>It\'s up to you. You can mix and match Text-Select and Box-Select Modes, like in the tutorial.</p><p>And this time, you will work with each program just once.</p><p>Click Next Step to proceed.</p>\n\n';
var _user$project$ExamplesGenerated$study_transition_1 = '\n(def main\n  (draw [(show \"That\'s the end of the tutorial! Let the facilitator know.\")]))\n; <!-- PROSE --> <p>Great job, you\'ve completed the tutorial! Now you\'re going to use Sketch-n-Sketch to perform some program editings tasks.</p><p>In the next section, you will see three example programs, each with a list of editing tasks. You will <em>not</em> be allowed to use text editing for any of the tasks. Instead, you will use the code transformation tools. You will work with each program twice:</p><ul><li>using code tools with Text-Select Mode, and</li><li>using code tools with Box-Select Mode.</li></ul><p>The order in which you are asked to perform tasks and use the different modes is random.</p><p>Before each task, you will have the opportunity to read the code to understand it. All editing features are disabled during this reading period.</p><p>Then, you will be given a list of editing tasks to perform. The top of the file will tell you to use either Text-Select Mode or Box-Select Mode. When you are done with each task, click Next Step to move on.</p><p>Let the facilitator know that you are ready to start. When given the okay, click Next Step to begin this sequence of tasks. Once you click Next Step, you will no longer be able to go the Previous Step of the tutorial.</p>\n\n';
var _user$project$ExamplesGenerated$study_start = '\n(def main\n  (draw []))\n; <!-- PROSE --> <p>In this study, we are going to show you some program editing features in Sketch-n-Sketch, a programming system for generating Scalable Vector Graphics images.</p><p><strong>Tutorial:</strong> In the first half, you will work through a tutorial that explains several features in Sketch-n-Sketch.</p><p><strong>Tasks:</strong> In the second half, you will work through several programming editing tasks using the features described in the tutorial.</p><p>See the Next Step button in the top-right corner of the screen? Every time you\'ve finished a section, press Next Step to move on.</p>\n\n';
var _user$project$ExamplesGenerated$mondrian_arch_deuce = ';\n; Mondrian Arch\n;\n; After Henry Lieberman p554 in \"Watch What I Do:\n; Programming by Demonstration\" Appendix B. MIT Press. 1993.\n;\n\n(def arch\n  (\\(archLeft archTop archWidth pillarHeight stoneWidth)\n  (let pillarTop (+ archTop stoneWidth)\n  (let rightPillarLeft (- (+ archLeft archWidth) stoneWidth)\n    [\n      (rect \'red\'   archLeft        archTop   archWidth  stoneWidth)\n      (rect \'green\' archLeft        pillarTop stoneWidth pillarHeight)\n      (rect \'blue\'  rightPillarLeft pillarTop stoneWidth pillarHeight)\n    ]))))\n\n(svg (concat [\n  (arch 73  44  378 280 55)\n  (arch 276 143 106 138 40)\n  (arch 131 159 118 26  54)\n]))\n\n';
var _user$project$ExamplesGenerated$coffee_deuce = '\n(def mug\n\n  (let fill 206\n  (let [x1 y1 w h] [41 181 155 182]\n  (let [handle_x handle_y] [(+ x1 w) (+ y1 63)]\n  (let [rx ry] [52.899480795897965 46.77512980102551]\n\n  (let [x02 y02] [(+ x1 43) (- y1 80)]\n\n  (let body\n    (rect fill x1 y1 w h)\n    \n  (let outer_handle\n    (ellipse fill handle_x handle_y rx ry)\n    \n  (let inner_handle\n    (let num 0.6201800000000001{0.001-1}\n    (ellipse \'white\' handle_x handle_y (* num rx) (* num ry)))\n  \n  (let steam (\\(x02 y02)\n    (let [strokeColor strokeWidth color] [440 5 499]\n    (let [x0 y0] [ x02 y02]\n    (let d [\'M\' x0 y0\n            \'C\' (- x0 21) (+ y0 26) (+ x0 19) (+ y0 34) (- x0 5) (+ y0 67)\n            \'C\' (+ x0 27) (+ y0 19) (- x0 8) (+ y0 17) x0 y0 \'Z\']\n    (rawPath color strokeColor strokeWidth d 0)))))\n\n  (let steam1\n    (steam x02 y02)\n    \n  (let steam2\n    (steam (+ x02 59) (- y02 3))\n    \n  (let steam3\n    (steam (+ x02 30) (- y02 8))\n    \n  [ outer_handle inner_handle body steam1 steam2 steam3 ])))))))))))))\n\n(svg mug)\n\n';
var _user$project$ExamplesGenerated$battery_deuce = '\n(def battery (\\(topLeft bodyWidth bodyHeight capWidth capHeight strokeWidth juicePct)\n  (let topRight (vec2DPlus topLeft [bodyWidth 0!])\n\n  (let body\n    (let pts [ topLeft\n               (vec2DPlus topLeft [0! bodyHeight])\n               (vec2DPlus topLeft [bodyWidth bodyHeight])\n               topRight ]\n    (addAttr\n      (polygon \'none\' \'black\' strokeWidth pts)\n      [\"stroke-linejoin\" \"round\"]))\n    \n  (let cap\n    (let [x1 y1] (vec2DPlus topRight [0! (/ (- bodyHeight capHeight) 2!)])\n    (rect \'black\' x1 y1 capWidth capHeight))\n  \n  (let juice\n    (let w (* juicePct bodyWidth)\n    (let fill (if (< juicePct 0.2) \'red\'\n              (if (< juicePct 0.4) \'orange\'\n              (if (ge juicePct 1)  \'green\'\n                                   \'black\')))\n    (rect fill (fst topLeft) (snd topLeft) w bodyHeight)))\n\n    [ juice body cap ]))))))\n  \n(svg (concat [\n  (battery [160 80] 198 107 30 41 14{0-40} 1{0.001-1})\n  (battery [101 253] 201 110 19 44 12{0-40} 0.8258406060606062{0.001-1})\n]))\n\n';
var _user$project$ExamplesGenerated$target_deuce = '(def target (\\(cx cy ringWidth ringCount)\n  (let ring (\\i\n    (let fill (if (= 0 (mod i 2)) \'firebrick\' \'lightgray\')\n    (circle fill cx cy (* ringWidth i))))\n    \n  (map ring (reverse (range 1 ringCount))))))\n\n(svg (target 200 200 50 4))\n\n';
var _user$project$ExamplesGenerated$sns_deuce = '\n(def logo (\\(x1 y1 w h fill stroke strokeWidth)\n  (let rectangle (rect fill x1 y1 w h)\n  (let line1 (line stroke strokeWidth x1 y1 (+ x1 w) (+ y1 h))\n  (let line2 (line stroke strokeWidth x1 (+ y1 h) (+ x1 (/ w 2)) (+ y1 (/ h 2)))\n  [rectangle line1 line2])))))\n\n(svg (concat [\n  (logo 33 21 135 120 \'purple\' \'orange\' 15)\n  (logo 180 99 72 31 \'darkgreen\' \'pink\' 3)\n  (logo 186 26 60 60 \'black\' \'white\' 5)\n]))\n\n';
var _user$project$ExamplesGenerated$calendarIcon = '; Calendar Icon\n;\n; After Bernstein and Li \"Lillicon\" 2015.\n;\n; Design Decisions:\n;   - rectangles x/y/w/h or let/top/right/bot (below)\n;   - day locations with margin calculated with start sep n or margin inserted per day based on point pairs from start end n (below)\n;   - cell margins constant or based on number of days in a month (below)\n;   - days in a month calculated inline (below) or a separate variable\n;\n\n\n(def daysInAWeek 4!{1-15})\n(def weeksInAMonth 3!{1-12})\n(def edgeMargin 10)\n(def dayMargin (/ (/ 196 daysInAWeek) weeksInAMonth))\n\n(def left 91)\n(def right 468)\n(def backgroundColor 325)\n\n(def topBar\n  (let bounds @ [left top right bot] [left 71 right 125]\n    [ (rectangle backgroundColor 360 0 0 bounds) ]))\n\n; end points included as part of n\n(def nPointsBetween (\\(start end n)\n  (let sep (/ (- end start) (- n 1!))\n  (map (\\i (+ start (* i sep))) (zeroTo n)))))\n\n(def [paperTop paperBot] [143 435])\n\n(def xs (nPointsBetween (+ left edgeMargin) (- right edgeMargin) (+ 1! daysInAWeek)))\n(def ys (nPointsBetween (+ paperTop edgeMargin) (- paperBot edgeMargin) (+ 1! weeksInAMonth)))\n(def consecutiveXs (zip xs (drop xs 1)))\n(def consecutiveYs (zip ys (drop ys 1)))\n; Drop some days from beginning/end of month\n;\n; cartProd argument order is so that we drop from the first row rather than first column\n(def dayBounds\n  (let dropFirstN (round (* daysInAWeek 0.3!))\n  (let dropLastN (round (* daysInAWeek 0.3!))\n  (map reverse (dropEnd (drop (cartProd consecutiveYs consecutiveXs) dropFirstN) dropLastN)))))\n\n(def paper\n  (let bounds @ [left top right bot] [left paperTop right paperBot]\n    [ (rectangle backgroundColor 360 0 0 bounds) ]))\n\n(def days\n  (map\n    (\\[[left right] [top bot]]\n      (rectangle 479 360 0 0 [(+ left dayMargin) (+ top dayMargin) (- right dayMargin) (- bot dayMargin)]))\n    dayBounds))\n\n(blobs [\n  topBar\n  paper\n  days\n])\n';
var _user$project$ExamplesGenerated$pencilTip = '; Pencil Tip\n;\n; Had to hand code:\n;   - renamings\n;   - initial eraser path arcs\n;   - eraser path arc relations\n;   - co-linearity of graphite tip with shaved wood wedge\n;\n; Design decisions:\n;   - Parts horizonal parameters absolute (below) or offset from each other or relative to entire pencil width\n;   - Pencil vertically paramererized as top/bottom (below) or top/width or centerY/width\n;   - Pencil constituent rects left/right/top/bot (below) or x/y/w/h\n;   - Eraser left x, corner bend start x, corner radius dependency: bend start x on radius and left (below), left on radius and bend start x, or radius on left and bend start x.\n;   - Pencil wood left, wood top right corner, and tip x: wood top right corner on wood left, tip x, and ratio (below); tip x and wood corner top on wood left, wood right, and ratio; tip x on wood left and wood top right corner; tip x on tip angle, wood top right corner on ratio\n;\n\n(def eraserRight 134)\n(def [pencilTop pencilBot] [130 266])\n(def pencilCenterY (* 0.5! (+ pencilBot pencilTop)))\n\n(def eraser\n  (let [strokeColor strokeWidth color] [254 0 4]\n  (let cornerRadius 13\n  (let left 107\n  (let bendStartX (+ left cornerRadius)\n  (let d [\'M\' eraserRight pencilTop\n          \'L\' eraserRight pencilBot\n          \'L\' bendStartX pencilBot\n          \'A\' cornerRadius cornerRadius 0 0 1 left (- pencilBot cornerRadius)\n          \'L\' left (+ pencilTop cornerRadius)\n          \'A\' cornerRadius cornerRadius 0 0 1 bendStartX pencilTop\n          \'Z\']\n    [ (rawPath color strokeColor strokeWidth d 0) ]))))))\n\n(def ferrule_right 194)\n\n(def ferrule\n  (let bounds @ [left top right bot] [eraserRight pencilTop ferrule_right pencilBot]\n  (let color 458\n    [ (rectangle color 360 0 0 bounds) ])))\n\n(def body_right 334)\n\n(def body\n  (let bounds @ [left top right bot] [ferrule_right pencilTop body_right pencilBot]\n  (let color 43\n    [ (rectangle color 360 0 0 bounds) ])))\n\n(def tipRatio 0.3)\n(def tipRight 437)\n\n(def [woodRight tipTopY] (onLine [tipRight pencilCenterY] [body_right pencilTop] tipRatio))\n(def tipBotY (- (+ pencilBot pencilTop) tipTopY))\n\n(def wood\n  (let pts [[body_right pencilBot] [body_right pencilTop] [woodRight tipTopY] [woodRight tipBotY]]\n  (let [color strokeColor strokeWidth] [470 360 0]\n    [ (rawPolygon color strokeColor strokeWidth pts 0) ])))\n\n(def tip\n  (let pts [[woodRight tipBotY] [woodRight tipTopY] [tipRight pencilCenterY]]\n  (let [color strokeColor strokeWidth] [402 360 0]\n    [ (rawPolygon color strokeColor strokeWidth pts 0) ])))\n\n(blobs [\n  eraser\n  ferrule\n  body\n  wood\n  tip\n])\n';
var _user$project$ExamplesGenerated$balanceScale = '; Balance Scale\n;\n; After David Kurlander p568 in \"Watch What I Do: Programming by Demonstration\" Appendix B. 1993.\n;\n; Had to hand-code the arc.\n;\n; It\'s a reasonable goal to support the ability to draw out the\n; particular constraints that determine the placement of the weights.\n;\n; The mathematics for balancing the scale should probably\n; not be a goal for direct manipulation (for the time being).\n;\n; Design decisions:\n;   - Use polyline (below) or two lines for balance arms\n;   - Arm pivot y absolute (below) or relative to top of pillar or pillar top relative to pivot\n;   - Arms angle in degrees (below) or radians or specified as a distance to drop\n;   - Tray arc radius absolute (below) or a ratio of width\n;   - Each tray hung by two lines or one polyline (below)\n;\n\n\n(def [pillar_x base_cx] [276.5 308])\n(def [pillar_y base_cy] [145 497])\n\n\n(def base\n  (let [ rx ry] [ 95 29]\n  (let [color rot] [420 0]\n    [ (rawEllipse color 360 0 base_cx base_cy rx ry rot) ])))\n\n(def pillar\n  (let [ w h] [ (* 2! (- base_cx pillar_x)) (- base_cy pillar_y)]\n  (let [fill stroke strokeWidth] [41 245 0]\n  (let rot 0\n    [ (rawRect fill stroke strokeWidth pillar_x pillar_y w h rot) ]))))\n\n(def pivot@[px py] [base_cx 181])\n(def armsInnerAngle 2.7!{0-3.14159})\n(def halfArmsInnerAngle (/ armsInnerAngle 2!))\n(def armLength 200)\n(def trayHangHeight 218.00000000000003)\n(def [leftWeightWidth  leftWeightHeight]  [65 65{0-120}])\n(def [rightWeightWidth rightWeightHeight] [65{0-120} 65])\n(def leftWeightMass  (* leftWeightWidth  leftWeightHeight))\n(def rightWeightMass (* rightWeightWidth rightWeightHeight))\n(def totalMass (+ leftWeightMass rightWeightMass))\n; Where does the center of mass fall on the invisible line between the trays?\n; (0 = all the way left, 1 = all the way right)\n(def centerOfMassLeftRightRatio (/ rightWeightMass totalMass))\n\n(def threePiOverTwo (* 1.5! (pi)))\n(def arctan (\\theta (arctan2 theta 1!)))\n(def tan (\\theta (/ (sin theta) (cos theta))))\n\n; Per my hand calculations\n(def thetaMethod1\n  (arctan (* (- 1! (* 2! centerOfMassLeftRightRatio)) (tan halfArmsInnerAngle))))\n; Per http://stackoverflow.com/a/4451915 arctan[tan(phi)*(m1+m2)/(m1-m2)]\n(def thetaMethod2\n  (let phi (- halfPi halfArmsInnerAngle)\n  (- halfPi (arctan (/ (* (tan phi) totalMass) (- leftWeightMass rightWeightMass))))))\n; They give the same results, though the S.O. answer chooses the opposite arctan for some angles.\n(def theta thetaMethod1)\n\n\n(def [leftHangPt rightHangPt]\n  (let [leftArmAngle rightArmAngle] [(+ theta (- threePiOverTwo halfArmsInnerAngle))\n                                     (+ theta (+ threePiOverTwo halfArmsInnerAngle))]\n  (map (compose (vec2DPlus pivot) (vec2DScalarMult armLength))\n    [[(cos leftArmAngle)  (neg (sin leftArmAngle))]\n     [(cos rightArmAngle) (neg (sin rightArmAngle))]])))\n\n(def arms\n  (let pts [leftHangPt [base_cx 181] rightHangPt]\n  (let [color strokeColor strokeWidth] [\"none\" 430 30]\n    [ (addAttr (polyline color strokeColor strokeWidth pts) [\"stroke-linecap\" \"round\"]) ])))\n\n(def weight (\\(cx bot w h)\n  (let halfWidth (/ w 2!)\n  (let [left top right] [(- cx halfWidth) (- bot h) (+ cx halfWidth)]\n  (let color 275\n    [ (rectangle color 360 0 0 [left top right bot]) ])))))\n\n(def hangingTray (\\(hangPoint@[hangX hangY] weightWidth weightHeight)\n  (let [strokeColor strokeWidth fill] [380 4 52]\n  (let w 100\n  (let y (+ hangY trayHangHeight)\n  (let arcRadius 300\n  (let [left right] [(- hangX w) (+ hangX w)]\n  (let d [\"M\" left y \"L\" right y \"A\" arcRadius arcRadius 0 0 1 left y \"Z\"]\n    (concat [\n      [ (path fill strokeColor strokeWidth d) ]\n      [ (polyline \'none\' strokeColor strokeWidth [[left y] hangPoint [right y]]) ]\n      (weight hangX y weightWidth weightHeight)\n    ])))))))))\n\n(blobs [\n  base\n  pillar\n  arms\n  (hangingTray leftHangPt  leftWeightWidth  leftWeightHeight)\n  (hangingTray rightHangPt rightWeightWidth rightWeightHeight)\n])\n';
var _user$project$ExamplesGenerated$replaceTerminalsWithWorkstations = '; Replace Terminals With Workstations\n;\n; A Demo of Kurlander\'s graphical search and replace.\n; David Kurlander p573,pp275-277 in \"Watch What I Do: Programming by Demonstration\" Appendix B. 1993.\n;\n; Design decisions:\n;   - x y w h or left top right bot (below) for workstation display and pillar\n;   - how to encode the equalization of the centerpoints of the keyboard, pillar, and display (used \"Make Equal\" version 1 below)\n;   - how to parameterize the design into a function: x y (below) or x y size or left top right bot\n;   - whether to parameterize any other details (e.g. screen color)\n;   - how to implement the x y offset: map and add in each location (below) or prelude SVG translate function (not implemented yet)\n;\n\n\n(def terminal (\\(x y)\n  (let origin [x y]\n  (let offset (vec2DPlus origin) ; second point unapplied\n  (let body\n    (let pts [[-9 154] [76 166] [150 136] [146 14] [54 6] [36 15] [38 117]]\n    (let [color strokeColor strokeWidth] [454 360 2]\n      [ (rawPolygon color strokeColor strokeWidth (map offset pts) 0) ]))\n\n  (let keyboard\n    (let pts [[15 147] [46 124] [102 131] [69 154]]\n    (let [color strokeColor strokeWidth] [462 360 2]\n      [ (rawPolygon color strokeColor strokeWidth (map offset pts) 0) ]))\n\n  (let screen\n    (let pts [[55 88] [54 32] [108 38] [109 94]]\n    (let [color strokeColor strokeWidth] [103 360 2]\n      [ (rawPolygon color strokeColor strokeWidth (map offset pts) 0) ]))\n\n  (concat [ body keyboard screen ]))))))))\n\n\n(def workstation (\\(x y)\n  (let origin [x y]\n  (let offset (vec2DPlus origin) ; second point unapplied\n  (let [polygon14_pts_k4862 rect11_bounds_left rect11_bounds_right] [71 104 148]\n  (let k4859 (- (+ rect11_bounds_left rect11_bounds_right) polygon14_pts_k4862)\n  (let rect12_bounds_left 46\n  (let right\' (- (+ rect11_bounds_left rect11_bounds_right) rect12_bounds_left)\n\n  (let displayPillar\n    (let bounds @ [left top right bot] [(+ x rect11_bounds_left) (+ y 115) (+ x rect11_bounds_right) (+ y 151)]\n    (let color 364\n      [ (rectangle color 360 0 0 bounds) ]))\n\n  (let display\n    (let bounds @ [left top right bot] [(+ x rect12_bounds_left) (+ y 14) (+ x right\') (+ y 110)]\n    (let color 110\n      [ (rectangle color 360 15 0 bounds) ]))\n\n  (let keyboard\n    (let pts_k4861 150\n    (let pts_k4855 178\n    (let pts [[polygon14_pts_k4862 pts_k4861] [k4859 pts_k4861] [201 pts_k4855] [53 pts_k4855]]\n    (let [color strokeColor strokeWidth] [460 360 5]\n      [ (rawPolygon color strokeColor strokeWidth (map offset pts) 0) ]))))\n\n  (let mouseCord\n    (let [strokeColor strokeWidth color] [369 1 \'none\']\n    (let [x0 y0] [21 159]\n    (let d [\'M\' (+ x x0) (+ y y0) \'L\' (+ x 36) (+ y 144) \'L\' (+ x 69) (+ y 137) \'L\' (+ x 100) (+ y 134) \'L\' (+ x 133) (+ y 136)]\n      [ (rawPath color strokeColor strokeWidth d 0) ])))\n\n  (let mouseBody\n    (let pts [[-5 176] [12 158] [28 158] [18 177]]\n    (let [color strokeColor strokeWidth] [462 360 2]\n      [ (rawPolygon color strokeColor strokeWidth (map offset pts) 0) ]))\n\n  (let mouseButton\n    (let pts [[10 165] [14 161] [23 161] [18 166]]\n    (let [color strokeColor strokeWidth] [364 360 2]\n      [ (rawPolygon color strokeColor strokeWidth (map offset pts) 0) ]))\n\n  (concat [ displayPillar display keyboard mouseCord mouseBody mouseButton ])))))))))))))))\n\n(def terminalsOrWorkstations 0!{0-1})\n(def terminalOrWorkstation\n  (if (< terminalsOrWorkstations 0.5!) terminal workstation))\n\n(blobs [\n  (terminalOrWorkstation 0 0)\n  (terminalOrWorkstation 300 200)\n  (terminalOrWorkstation 200 300)\n  (terminalOrWorkstation 400 400)\n])\n';
var _user$project$ExamplesGenerated$kochSnowflake = '; Koch Snowflake\n;\n; Can be accomplished by graphical search and replace per\n; David Kurlander p556 in \"Watch What I Do: Programming by Demonstration\" Appendix B. 1993.\n;\n; What would have helped the creation of the implementation below\n; was some local view of a functions computation (onLine, normPt).\n; Might be nice to augment with program synthesis.\n;\n; Design decisions:\n;   - as patterns (below) or reconstructing points\n;   - manual calculation of dx dy (below) or use of prelude vec2DMinus function\n;   - draw as many lines or polyline or polygon (below) or path\n;   - edge math calculates the three subdivistion points (below) or uses vector addition and rotation functions like turtle graphics\n;   - repeated edge calls (below) or concatMap over list of points\n;   - The equation for edge width: 1/3 for each successive iteration (below) or constant\n;\n\n(def iterations 3!{0-4})\n; Each iteration is 1/3 the scale of the prior, so\n; we divide the line width by 3 on each iteration.\n(def [fill stroke width] [150 386 (/ 45 (pow 3! iterations))])\n\n; Point on normal of line, at `ratio` distance from the line\n; relative to line length.\n(def normPt (\\(pt1@[x1 y1] pt2@[x2 y2] ratio)\n  (let vec@[dx dy] [(- x2 x1) (- y2 y1)]\n  (vec2DPlus (vec2DScalarMult ratio [(neg dy) dx]) (halfwayBetween pt1 pt2)))))\n\n; Recursive fractal edge.\n;\n; Returns list of points (except the last point)\n(defrec edge (\\(pt1@[x1 y1] pt2@[x2 y2] iterationsLeft)\n  (if (= 0 iterationsLeft)\n    [ pt1 ]\n    (let [thirdPt twoThirdsPt] [(onLine pt1 pt2 (/ 1 3!)) (onLine pt1 pt2 (/ 2 3!))]\n    (let outPt (normPt pt1 pt2 (* (/ 1 3!) (/ (sqrt 3!) 2!)))\n    (concat [ (edge pt1         thirdPt     (- iterationsLeft 1))\n              (edge thirdPt     outPt       (- iterationsLeft 1))\n              (edge outPt       twoThirdsPt (- iterationsLeft 1))\n              (edge twoThirdsPt pt2         (- iterationsLeft 1))\n            ]))))))\n\n; Points of initial equilateral triangle.\n(def [triPt1 triPt2 triPt3] (nPointsOnCircle 3! 0 300 300 200))\n\n(def snowflakePts\n  (concat [ (edge triPt1 triPt2 iterations)\n            (edge triPt2 triPt3 iterations)\n            (edge triPt3 triPt1 iterations)\n          ]))\n\n(def snowflake\n  [ (polygon fill stroke width snowflakePts) ])\n\n(blobs [\n  snowflake\n])\n';
var _user$project$ExamplesGenerated$gear = '; Gear\n;\n; Need fancier path tools to create the\n; cut out via direct manipulation.\n;\n; Need better DM to manipulate the design (parameter\n; control and better handling of rotation)\n;\n; Design decisions:\n;   - tip diameter absolute or offset from root diameter\n;   - points defined clockwise (below) or counterclockwise\n;   - how to add the lettered path commands between the points (good opportunity for PBE)\n;   - scope of unshared gear parameters, either local (below, mostly) or global\n;\n\n(def [cx cy] [200 200])\n(def [rootRadius tipRadius] [120 170])\n(def teethCount 9!{1-50})\n(def [botLandRatio topLandRatio] [0.45 0.25])\n(def rot 0)\n\n; direction controls whether points are clockwise or counterclockwise\n(def circlePathCmds (\\(cx cy r direction)\n  (let sweepFlag (if (= 1 direction) 1 0)\n  [\'M\' (+ cx (* direction r)) cy\n   \'a\' (* direction r) r 0 0 sweepFlag (* direction (neg r)) r\n   \'a\' (* direction r) r 0 0 sweepFlag (* direction (neg r)) (neg r)\n   \'a\' (* direction r) r 0 0 sweepFlag (* direction r) (neg r)\n   \'a\' (* direction r) r 0 0 sweepFlag (* direction r) r\n   \'z\'])))\n\n(def gearPts (\\(rotAngularRatioOffset r)\n  (let angularPitch (/ twoPi teethCount)\n  (reverse (nPointsOnCircle teethCount (+ rot (* angularPitch rotAngularRatioOffset)) cx cy r)))))\n\n; 0 degrees is centered on a tip\n(def topLeftPts  (gearPts (/ topLandRatio -2!) tipRadius))\n(def topRightPts (gearPts (/ topLandRatio  2!) tipRadius))\n(def botLeftPts  (gearPts (+ 0.5! (/ botLandRatio -2!)) rootRadius))\n(def botRightPts (gearPts (+ 0.5! (/ botLandRatio  2!)) rootRadius))\n\n; Now interleave all the points\n(def pathPts (concat (map4 (\\(pt1 pt2 pt3 pt4) [pt1 pt2 pt3 pt4]) topLeftPts topRightPts botLeftPts botRightPts)))\n\n(def pathCmds\n   (concat (intermingle (cons [\'M\'] (snoc [\'Z\'] (repeat (- (* 4! teethCount) 1!) [\'L\']))) pathPts)))\n\n(def gear\n  (let [strokeColor strokeWidth color] [372 5 352]\n    [ (rawPath color strokeColor strokeWidth (append pathCmds (circlePathCmds cx cy 50 -1!)) 0) ]))\n\n\n(blobs [\n  gear\n])\n';
var _user$project$ExamplesGenerated$ferris3 = '; Ferris Wheel 3\n;\n; Design decisions:\n;   - Which variables to make global vs. local\n;   - Ordering of cars/rim/spokes/hub\n;\n\n(def cx 230)\n(def cy 245)\n(def [r n rot] [137 5{0-20} 0.11{-3.2-3.2}])\n(def ferrisPoints (nPointsOnCircle n rot cx cy r))\n(def spokeWidth 3)\n(def [spokeColor hubColor] [0 382])\n(def [carColor leadCarColor] [50 100])\n\n(def rim\n  [(ring spokeColor spokeWidth cx cy r)])\n\n(def car (\\([x y] color)\n  (let [x y w h] [x y 43 44]\n    [ (rectByCenter color x y w h) ])))\n\n(def spoke (\\[x y]\n    [ (line spokeColor spokeWidth cx cy x y) ]))\n\n(def cars\n  (concat (mapi (\\[i pt] (car pt (if (= 0 i) leadCarColor carColor))) ferrisPoints)))\n\n(def spokes\n  (concatMap spoke ferrisPoints))\n\n(def hub\n  (let r 24\n    [ (rawCircle hubColor 360 0 cx cy r) ]))\n\n(blobs [\n  cars\n  spokes\n  rim\n  hub\n])\n';
var _user$project$ExamplesGenerated$conifer = '; Conifer\n;\n; This design is surprisingly difficult to code.\n;\n; Some notable decisions:\n;   - tree parameters global (below) or passed in to each function\n;   - tree height computed or given (below)\n;   - leaf separation absolute (below) or relative to leaf size\n;   - leaf separation measured as between respective points on consectutive leaves (below) or as space between leaves\n;   - branch start/end height on trunk absolute (below) or offset from base or a ratio\n;   - branch repetition start end sep (below) or start end n or start sep n\n;\n\n\n(defrec spaced (\\(start stop sep)\n  (let direction (sgn sep)\n  (if (< (* direction start) (* direction stop))\n    [start|(spaced (+ start sep) stop sep)]\n    []))))\n\n(def treeX 232)\n(def treeBot 375)\n(def treeHeight 301{1-500})\n(def treeTop (- treeBot treeHeight))\n(def [branchBot branchTop] [(- treeBot 25) (+ (- treeBot treeHeight) 15)])\n\n(def trunk\n  (let [baseY baseW] [treeBot 12]\n  (let halfBaseW (/ baseW 2!)\n  (let pts [[(- treeX halfBaseW) baseY]\n            [(+ treeX halfBaseW) baseY]\n            [treeX treeTop]]\n  (let [color strokeColor strokeWidth] [31 0 0]\n    [ (rawPolygon color strokeColor strokeWidth pts 0) ])))))\n\n\n; Draw this to maniplate how high the branches start/stop\n(def branchingLine\n  (let [color width] [280 5]\n    [ (line color width treeX branchBot treeX branchTop) ]))\n\n(def leaf (\\(cx cy)\n  (let [w h] [14 52]\n  (let [halfW halfH] [(/ w 2!) (/ h 2!)]\n  (let [left top right bot] [(- cx halfW) (- cy halfH) (+ cx halfW) (+ cy halfH)]\n  (let pts [[left cy] [cx bot] [right cy] [cx top]]\n  (let [color strokeColor strokeWidth] [127 0 0]\n    [ (rawPolygon color strokeColor strokeWidth pts 0) ])))))))\n\n(def branch (\\(baseY baseW length)\n  (let halfBaseW (/ baseW 2!)\n  (let pts [[treeX (- baseY halfBaseW)]\n            [treeX (+ baseY halfBaseW)]\n            [(+ treeX length) baseY]]\n  (let [color strokeColor strokeWidth] [31 0 0]\n    [ (rawPolygon color strokeColor strokeWidth pts 0) ])))))\n\n(def leafyBranch (\\(baseY baseW length leafSep)\n  (let halfLeafSep (/ leafSep 2!)\n  (let leaves (concatMap (\\x (leaf x baseY)) (spaced (- (+ treeX length) halfLeafSep) (+ treeX halfLeafSep) (neg leafSep)))\n  (concat [(branch baseY baseW length) leaves])))))\n\n(def side (\\direction\n  (let branchSep 38.5\n  (let leafSep (* direction 18)\n  (let drawLeafyBranch (\\y\n    (let lengthRatio (- 1! (/ (- treeBot y) treeHeight))\n    (leafyBranch y (* lengthRatio 30) (* direction (* lengthRatio 190)) leafSep)))\n  (concatMap drawLeafyBranch (spaced branchBot branchTop (neg branchSep))))))))\n\n(blobs [\n  trunk\n  (side 1!)\n  (side -1!)\n])\n';
var _user$project$ExamplesGenerated$xs = '; Xs\n;\n; After David Maulsby p591 in \"Watch What I Do: Programming by Demonstration\" Appendix B. 1993.\n;\n; Design decisions:\n;   - top left n boxWidth or top left w boxWidth or top left w n or cx cy n boxWidth (below) or cx cy r boxWidth or cx cy r n or BB boxWidth or BB n\n;   - boxes square or rectangular (relevant to several of the above)\n;   - n  {1,2,3,4,...} (below) or n  {1,3,5,7,...}\n;   - colors global (below) or per function call\n;\n\n(def x (\\(cx cy n boxWidth)\n  (let [centerColor descendingColor ascendingColor] [438 32 240]\n  (let square (\\(cx cy color)\n    [ (squareByCenter color cx cy boxWidth) ])\n  (let drawLevel (\\i\n    (if (= i 0)\n      (square cx cy centerColor)\n      (let offset (* i boxWidth)\n        (concat [(square (- cx offset) (- cy offset) descendingColor)\n                 (square (+ cx offset) (+ cy offset) descendingColor)\n                 (square (- cx offset) (+ cy offset) ascendingColor)\n                 (square (+ cx offset) (- cy offset) ascendingColor)]))))\n    (concatMap drawLevel (zeroTo n)))))\n  ))\n\n(blobs [\n  (x 200 250 3{1-6} 50)\n])\n\n';
var _user$project$ExamplesGenerated$target = '; Target\n;\n; Design decisions:\n;   - BB n or BB ringWidth or cx cy r n or cx cy n ringWidth (below) or cx cy r ringWidth\n;   - Inner circle radius absolute or relative to ringWidth (below)\n;\n\n(def target\n  (let circleCount 4{1-10}\n  (let concentricCircle (\\i\n    (let ringWidth 35\n    (let [cx cy r] [182 244 (+ (* 0.7 ringWidth) (* i ringWidth))]\n    (let colors [470 0]\n    (let color (nth colors (mod i 2))\n      [ (rawCircle color 360 0 cx cy r) ])))))\n\n  (concatMap concentricCircle (reverse (zeroTo circleCount))))))\n\n(blobs [\n  target\n])\n';
var _user$project$ExamplesGenerated$rails = '; Rails\n;\n; Make Equal helped set up the rails. The rest is basically hand-rolled.\n;\n; Design decisions:\n;   - Ties/rails encoded relative to rails (below) or to BB or to centerline\n;   - If encoded relative to rails, botRail y absolute (below) or offset from topRail y\n;   - Tie sep measured between left edges or between facing edges (below)\n;   - Tie count absolute (below) or relative to rail length or rail length relative to tie count\n;   - Tie start position absolute or based on sep (below)\n;   - Tie hangout absolue (below) or relative to rail offset or BB\n;\n\n\n(def railLength 331)\n(def railWidth 10)\n(def railStart 36)\n(def railFill 460)\n(def topRail_y 151)\n(def botRail_y 204)\n\n(def topRail\n  (let [stroke strokeWidth] [78 0]\n  (let rot 0\n    [ (rawRect railFill stroke strokeWidth railStart topRail_y railLength railWidth rot) ])))\n\n(def botRail\n  (let [stroke strokeWidth] [78 0]\n  (let rot 0\n    [ (rawRect railFill stroke strokeWidth railStart botRail_y railLength railWidth rot) ])))\n\n(def ties\n  (let tie (\\i\n    (let w 12\n    (let sep 20.98947368421053\n    (let sepw (+ sep w)\n    (let x (+ (+ railStart (/ sep 2!)) (* i sepw))\n    (let hangout 12\n    (let y (- topRail_y hangout)\n    (let h (+ (+ (- botRail_y topRail_y) railWidth) (* 2! hangout))\n    (let [fill stroke strokeWidth] [39 85 0]\n    (let rot 0\n      [ (rawRect fill stroke strokeWidth x y w h rot) ]))))))))))\n  (concatMap tie (zeroTo 10))))\n\n(blobs [\n  ties\n  topRail\n  botRail\n])\n';
var _user$project$ExamplesGenerated$ladder = '; Ladder\n;\n; After Cheema, Gulwani, and LaViola \"QuickDraw: Improving Drawing Experience for Geometric Diagrams\" CHI 2012.\n; mentioned as originally from an math text\n;\n; Repetition and best implementation of vertical constraint done by hand.\n;\n; Design decisions:\n;   - Linear repetition specification (start sep n (below); start end n; start end sep)\n;   - Ladder bottom: absolute (below) or offset from last rung\n;   - If last rung endpoint specified: absolute or relative to ladder height or offset from ladder bottom\n;\n\n\n(def leftPost_y1 121)\n(def leftPost_y2 250)\n(def leftPost_x1 97)\n(def rightPost_x1 207)\n(def color 130)\n(def width 7)\n(def n 4{1-15})\n\n(def leftPost\n    [ (line color width leftPost_x1 leftPost_y1 leftPost_x1 leftPost_y2) ])\n\n(def rightPost\n    [ (line color width rightPost_x1 leftPost_y1 rightPost_x1 leftPost_y2) ])\n\n(def rungs\n    (def rung (\\i\n    (let y (+ leftPost_y1 (* i 27.666666666666668))\n        [(line color width leftPost_x1 y rightPost_x1 y) ])))\n    (concatMap rung (zeroTo n)))\n\n(blobs [\n  leftPost\n  rightPost\n  rungs\n])\n';
var _user$project$ExamplesGenerated$mondrianArch = '; Mondrian Arch\n;\n; After Henry Lieberman p554 in \"Watch What I Do: Programming by Demonstration\" Appendix B. 1993.\n;\n; Can be done with tools as of UIST 2016, but\n; parameterization is not anywhere near optimal.\n;\n; Below is hand-rolled (some digging).\n;\n; Design decisions:\n;   - Pillars relative to BB or relative to lintel (below: relative to lintel)\n;   - x/y/w/h or BB for lintel (below: x/y/w/h)\n;   - Pillar width: same as lintel or relative to BB width (below: same as lintel)\n;\n\n; Get the following with vanilla \"Make Equal\":\n;\n; (def [rect3_y rect2_x rect3_w rect4_x] [161 105 170 222])\n; (def rect2_y (+ (- (+ rect2_x rect3_w) rect4_x) rect3_y))\n; (def rect2_h 148)\n;\n; (def rect2\n;   (let w (- rect2_y rect3_y)\n;   (let [fill stroke strokeWidth] [211 381 0]\n;   (let rot 0\n;     [ (rawRect fill stroke strokeWidth rect2_x rect2_y w rect2_h rot) ]))))\n;\n; (def rect3\n;   (let h (- rect2_y rect3_y)\n;   (let [fill stroke strokeWidth] [344 444 0]\n;   (let rot 0\n;     [ (rawRect fill stroke strokeWidth rect2_x rect3_y rect3_w h rot) ]))))\n;\n; (def rect4\n;   (let w (- (+ rect2_x rect3_w) rect4_x)\n;   (let [fill stroke strokeWidth] [117 391 0]\n;   (let rot 0\n;     [ (rawRect fill stroke strokeWidth rect4_x rect2_y w rect2_h rot) ]))))\n;\n; (blobs [\n;   rect2\n;   rect3\n;   rect4\n; ])\n;\n\n(def [lintel_x lintel_y lintel_w lintel_h] [76 146 145 42])\n(def lintelBot (+ lintel_y lintel_h))\n(def pillarHeight 198)\n\n(def leftPillar\n  (let [x y w h] [lintel_x lintelBot lintel_h pillarHeight]\n  (let [fill stroke strokeWidth] [352 352 0]\n  (let rot 0\n    [ (rawRect fill stroke strokeWidth x y w h rot) ]))))\n\n(def lintel\n  (let [fill stroke strokeWidth] [218 218 0]\n  (let rot 0\n    [ (rawRect fill stroke strokeWidth lintel_x lintel_y lintel_w lintel_h rot) ])))\n\n(def rightPillar\n  (let [x y w h] [(- (+ lintel_x lintel_w) lintel_h) lintelBot lintel_h pillarHeight]\n  (let [fill stroke strokeWidth] [146 146 0]\n  (let rot 0\n    [ (rawRect fill stroke strokeWidth x y w h rot) ]))))\n\n(blobs [\n  leftPillar\n  lintel\n  rightPillar\n])\n\n';
var _user$project$ExamplesGenerated$batteryDynamic = '; Battery (Dynamic)\n;\n; Still need tools for reordering shapes.\n;\n; Design decisions:\n;   - battery body made from four rectangles or one path with a hole or one polyline (below)\n;   - body x/y/w/h or left/top/right/bot (below)\n;   - charge bar x/y/w/h or left/top/right/bot (below)\n;   - calculate inner bounds as a variable (below) or inline\n;   - calculate inner width as a variable (below) or inline\n;   - w/h of tip absolute (below) or relative to body\n;   - if abstracted, BB or x/y/w/h parameterization\n;\n\n\n(def chargePercentage 20{0-100})\n(def bodyTop 117)\n(def bodyBot 204)\n(def bodyRight 273)\n(def centerY (/ (+ bodyTop bodyBot) 2!))\n(def bodyLeft 90)\n(def bodyOutlineWidth 18{0-50})\n(def halfOutlineWidth (/ bodyOutlineWidth 2!))\n(def mainColor 360)\n\n(def bodyOutline\n  (let pts [[bodyLeft bodyTop] [bodyRight bodyTop] [bodyRight bodyBot] [bodyLeft bodyBot]]\n    [ (addAttr (polygon \'none\' mainColor bodyOutlineWidth pts) [\"stroke-linejoin\" \"round\"]) ]))\n\n(def tip\n  (let h 52\n  (let [y w] [ (- centerY (/ h 2!)) 38]\n  (let [stroke strokeWidth] [368 0]\n  (let rot 0\n    [ (rawRect mainColor stroke strokeWidth bodyRight y w h rot) ])))))\n\n(def [innerLeft innerTop innerRight innerBot]\n  [(+ bodyLeft halfOutlineWidth)\n   (+ bodyTop halfOutlineWidth)\n   (- bodyRight halfOutlineWidth)\n   (- bodyBot halfOutlineWidth)])\n(def innerWidth (- innerRight innerLeft))\n\n(def chargeBar\n  (let bounds @ [left top right bot] [innerLeft innerTop (+ innerLeft (/ (* innerWidth chargePercentage) 100!)) innerBot]\n  (let [drainedColor color fullColor] [0 mainColor 113]\n  (let color (if (le chargePercentage 20) drainedColor (if (ge chargePercentage 99) fullColor mainColor))\n    [ (rectangle color 360 0 0 bounds) ]))))\n\n(blobs [\n  bodyOutline\n  tip\n  chargeBar\n])\n';
var _user$project$ExamplesGenerated$battery = '; Battery\n;\n; After Bernstein and Li \"Lillicon\" 2015.\n;\n; Can be done with tools as of UIST 2016 (minus abstaction), but\n; parameterization is backward; want tip x and y to be dependent but\n; the Make Equal defaults to making x and h dependent (as below).\n;\n; Design decisions:\n;   - w/h of tip absolute or relative to body\n;   - if abstracted, BB or x/y/w/h parameterization\n;\n\n(def [body_w body_x] [147 103])\n(def [tip_y body_h body_y] [223 84 201])\n(def fill 362)\n\n(def body\n  (let [ stroke strokeWidth] [ 250 0]\n  (let rot 0\n    [ (rawRect fill stroke strokeWidth body_x body_y body_w body_h rot) ])))\n\n(def tip\n  (let [x w h] [(+ body_x body_w) 19 (* 2! (- (+ body_y (* 0.5! body_h)) tip_y))]\n  (let [ stroke strokeWidth] [ 182 0]\n  (let rot 0\n    [ (rawRect fill stroke strokeWidth x tip_y w h rot) ]))))\n\n(blobs [\n  body\n  tip\n])\n';
var _user$project$ExamplesGenerated$rectangleTrisection = '; Rectangle Trisection\n;\n; After Alan Turranksy p566 in \"Watch What I Do: Programming by Demonstration\" Appendix B. 1993.\n;\n; Straightforward with tools as of UIST 2016, but\n; does require a \"Dig Hole\" to type in \"(/ rect1_w 3)\"\n;\n; To further abstract (as below) requires manual labor (not a bounding box)\n;\n\n(def rectTrisection (\\(x y w h)\n  (def rect1\n    (let [fill stroke strokeWidth] [365 365 0]\n    (let rot 0\n      [ (rawRect fill stroke strokeWidth x y w h rot) ])))\n\n  (def rect2\n    (let [fill stroke strokeWidth] [175 175 0]\n    (let rot 0\n      [ (rawRect fill stroke strokeWidth x y (/ w 3) h rot) ])))\n\n  (concat [rect1 rect2])\n))\n\n\n(blobs [\n  (rectTrisection 91 181 347 177)\n])\n';
var _user$project$ExamplesGenerated$coffee_UIST = '\n(def mug (\\(outer_color strokeWidth3280 color strokeWidth3239 strokeColor strokeWidth3142 x0 y0 [left top right bot])\n  (def bounds [left top right bot])\n  (def rFrac 0.2!)\n  (def [outer_right outer_left] [ (scaleBetween left right 1)(scaleBetween left right 0.3575757575757576)])\n  (def outer_x_radius (/ (- outer_right outer_left) 2!))\n  (def [rect3_top outer_bot outer_top] [ (scaleBetween top bot 0.3620689655172414) (scaleBetween top bot 0.9224137931034483) (scaleBetween top bot 0.4396551724137931)])\n  (def outer_ellipseRY (/ (- outer_bot outer_top) 2!))\n\n  (def outer\n    (let bounds [outer_left outer_top outer_right outer_bot]\n    (let [ strokeColor strokeWidth] [ \'black\' strokeWidth3280]\n      [ (oval outer_color strokeColor strokeWidth bounds) ])))\n\n  (def inner\n    (let [left top right bot] [(+ outer_left (* rFrac outer_x_radius)) (+ outer_top (* rFrac outer_ellipseRY)) (- outer_right (* rFrac outer_x_radius)) (- outer_bot (* rFrac outer_ellipseRY))]\n    (let bounds [left top right bot]\n    (let [color strokeColor strokeWidth] [color \'black\' strokeWidth3239]\n      [ (oval color strokeColor strokeWidth bounds) ]))))\n\n  (def rect3\n    (let [left right bot] [(scaleBetween left right 0) (+ (+ outer_left (* 0.1! (- outer_right outer_left))) (* 0.5! (- (- outer_right (* 0.1! (- outer_right outer_left))) (+ outer_left (* 0.1! (- outer_right outer_left)))))) (* 2! (- (+ (+ outer_top (* 0.1! (- outer_bot outer_top))) (* 0.5! (- (- outer_bot (* 0.1! (- outer_bot outer_top))) (+ outer_top (* 0.1! (- outer_bot outer_top)))))) (* 0.5! rect3_top)))]\n    (let bounds [left rect3_top right bot]\n      [ (rectangle outer_color \'black\' 0 0 bounds) ])))\n\n  (def steam (\\(left top right bot)\n    (let bounds [left top right bot]\n    (let [strokeColor strokeWidth color] [strokeColor strokeWidth3142 \'white\']\n    (let dPcts [\'M\' x0 y0 \'C\' 0 0.4925373134328358? 0.8076923076923077? 0.6119402985074627? 0.4230769230769231? 1 \'C\' 1 0.7313432835820896? 0.4230769230769231? 0.6417910447761194? x0 y0]\n      [ (stretchyPath bounds color strokeColor strokeWidth dPcts) ])))))\n\n  [ (group bounds (concat [ outer inner rect3 (steam(scaleBetween left right 0.012121212121212121) (scaleBetween top bot 0.02586206896551724) (scaleBetween left right 0.1696969696969697) (scaleBetween top bot 0.3146551724137931)) (steam(scaleBetween left right 0.2606060606060606) (scaleBetween top bot 0) (scaleBetween left right 0.41818181818181815) (scaleBetween top bot 0.28879310344827586)) (steam(scaleBetween left right 0.5212121212121212) (scaleBetween top bot 0.02586206896551724) (scaleBetween left right 0.6787878787878788) (scaleBetween top bot 0.3146551724137931)) ])) ]))\n\n(blobs [\n  (withBounds [27 27 192 259] (mug 164 0 481 0 102 5 0.8846153846153846? 0))\n  (withBounds [299 214 406 322] (mug 164 0 481 0 102 5 0.8846153846153846? 0))\n  (withBounds [143 380 193 442] (mug 164 0 481 0 102 5 0.8846153846153846? 0))\n])\n\n';
var _user$project$ExamplesGenerated$botanic_UIST = '\n(def newGroup4 (\\(leftLeaf_strokeWidth leftLeaf_color leftLeaf_strokeColor leftLeaf_dPcts_k3164 leftLeaf_dPcts_k3166 centerLeftPct leftRightPct leftTopPct leftMidPct x03451 y03450 x03401 y03400 y03344 dPcts_k3058 [left top right bot])\n  (def bounds [left top right bot])\n  (def centerRightPct (- 1! centerLeftPct))\n  (def rightLeftPct (- 1! leftRightPct))\n  (def rightTopPct (- 1! leftTopPct))\n  (def rightMidPct (- 1! leftMidPct))\n\n  (def leftLeaf\n    (let k3186 0!\n    (let [left top right bot] [ left (scaleBetween top bot k3186) (scaleBetween left right leftRightPct) bot]\n    (let bounds [left top right bot]\n    (let [x0 y0] [x03451 y03450]\n    (let dPcts [\'M\' x0 y0 \'Q\' leftMidPct leftLeaf_dPcts_k3166 0 leftLeaf_dPcts_k3164 \'Q\' leftTopPct 0 x0 y0]\n      [ (stretchyPath bounds leftLeaf_color leftLeaf_strokeColor leftLeaf_strokeWidth dPcts) ]))))))\n\n  (def rightLeaf\n    (let k3132 1!\n    (let [left top right bot] [ (scaleBetween left right rightLeftPct) top right (scaleBetween top bot k3132)]\n    (let bounds [left top right bot]\n    (let [x0 y0] [x03401 y03400]\n    (let dPcts [\'M\' x0 y0 \'Q\' rightMidPct leftLeaf_dPcts_k3166 1 leftLeaf_dPcts_k3164 \'Q\' rightTopPct 0 x0 y0]\n      [ (stretchyPath bounds leftLeaf_color leftLeaf_strokeColor leftLeaf_strokeWidth dPcts) ]))))))\n\n  (def centerLeaf\n    (let [left top right bot] [ (scaleBetween left right centerLeftPct) (scaleBetween top bot 0.1166930482692767) (scaleBetween left right centerRightPct) (scaleBetween top bot 0.6433647887474833)]\n    (let bounds [left top right bot]\n    (let [x0 y0] [0.5! y03344]\n    (let dPcts [\'M\' x0 y0 \'L\' 0 dPcts_k3058 \'Q\' 0.5! 0 1 dPcts_k3058 \'Z\']\n      [ (stretchyPath bounds leftLeaf_color leftLeaf_strokeColor leftLeaf_strokeWidth dPcts) ])))))\n\n  [ (group bounds (concat [ leftLeaf rightLeaf centerLeaf ])) ]))\n\n(blobs [\n  (withBounds [56 45.523358950223596 512 495] (newGroup4 4 100 431 0.4693710270993644? 0.3959689822652434? 0.35053185358677735 0.47858611976259036 0.44362108479755546 0.5977244375980417 1 1 0 1 1 0.3407539747046014?))\n])\n\n';
var _user$project$ExamplesGenerated$sns_revisited_UIST = '\n; Try deleting the five helper circles from the main expression.\n\n(def [polygon6_top polygon5_left polygon6_right] [69 92 296])\n(def helper_r 27.5)\n(def polygon7_bot (+ (+ (* 0.5! (+ polygon6_top polygon6_top)) (* 0.5! (- (* 0.5! (+ polygon6_right polygon6_right)) (* 0.5! (+ polygon5_left polygon5_left))))) (* 0.5! (- (* 0.5! (+ polygon6_right polygon6_right)) (* 0.5! (+ polygon5_left polygon5_left))))))\n(def k3105 (/ (- (+ (- polygon6_right helper_r) (* 0.5! (+ (+ (- polygon6_right helper_r) (* 2! helper_r)) (- helper_r polygon6_right)))) (+ (+ (- polygon5_left helper_r) (* 0.5! (+ (+ (- polygon5_left helper_r) (* 2! helper_r)) (- helper_r polygon5_left)))) (* 0.5! (+ (+ (- polygon5_left helper_r) (* 2! helper_r)) (- helper_r polygon5_left))))) (- polygon6_right (+ (+ (- polygon5_left helper_r) (* 0.5! (+ (+ (- polygon5_left helper_r) (* 2! helper_r)) (- helper_r polygon5_left)))) (* 0.5! (+ (+ (- polygon5_left helper_r) (* 2! helper_r)) (- helper_r polygon5_left)))))))\n(def polygon7_top (- (* 0.5! (+ (- polygon7_bot helper_r) (- polygon6_top (+ (- 0! (+ helper_r helper_r)) (* 0.5! (+ (+ (- 0! (+ helper_r helper_r)) (* 2! helper_r)) (+ helper_r helper_r))))))) (+ (- 0! (+ helper_r helper_r)) (* 0.5! (+ (+ (- 0! (+ helper_r helper_r)) (* 2! helper_r)) (+ helper_r helper_r))))))\n(def [polygon5_right k3038] [(- (* 0.5! (+ (+ (+ (- polygon5_left helper_r) (* 0.5! (+ (+ (- polygon5_left helper_r) (* 2! helper_r)) (- helper_r polygon5_left)))) helper_r) (- polygon6_right helper_r))) helper_r) (- (+ (- polygon5_left helper_r) (* 0.5! (+ (+ (- polygon5_left helper_r) (* 2! helper_r)) (- helper_r polygon5_left)))) helper_r)])\n(def k3061 (/ (- (+ polygon5_right helper_r) (+ (+ k3038 helper_r) helper_r)) (- (- polygon6_right helper_r) (+ (+ k3038 helper_r) helper_r))))\n(def polygon6_bot (- (+ (- polygon7_bot helper_r) (* 0.5! (+ (+ (- polygon7_bot helper_r) (* 2! helper_r)) (- helper_r polygon7_bot)))) helper_r))\n(def k3063 (/ (- (+ polygon6_bot helper_r) polygon7_top) (- polygon7_bot polygon7_top)))\n(def k3034 (- polygon6_right helper_r))\n(def polygon5_top (- polygon6_top (+ (- 0! (+ helper_r helper_r)) (* 0.5! (+ (+ (- 0! (+ helper_r helper_r)) (* 2! helper_r)) (+ helper_r helper_r))))))\n(def k3103 (/ (- (+ (- polygon5_top (+ helper_r helper_r)) (* 0.5! (+ (+ (- polygon5_top (+ helper_r helper_r)) (* 2! helper_r)) (- (+ helper_r helper_r) polygon5_top)))) polygon6_top) (- polygon6_bot polygon6_top)))\n(def [k3041 polygon5_bot] [(- polygon7_top (+ helper_r helper_r)) (- polygon7_bot helper_r)])\n(def k3134 (/ (- (+ k3041 helper_r) polygon5_top) (- polygon5_bot polygon5_top)))\n(def k3045 (- polygon5_top (+ helper_r helper_r)))\n(def k3046 (- polygon5_left helper_r))\n(def k3141 (/ (- (+ k3038 helper_r) polygon5_left) (- polygon5_right polygon5_left)))\n\n(def helper (\\(left top)\n  (let [left top] [left top]\n  (let bounds [left top (+ left (* 2! helper_r)) (+ top (* 2! helper_r))]\n  (let [color strokeColor strokeWidth] [394 \'black\' 0]\n    [ (oval color strokeColor strokeWidth bounds) ])))))\n\n(def polygon5\n  (let bounds [polygon5_left polygon5_top polygon5_right polygon5_bot]\n  (let [color strokeColor strokeWidth] [261 \'black\' 2]\n  (let pcts [[k3141 1] [0 0] [1 k3134]]\n    [ (stretchyPolygon bounds color strokeColor strokeWidth pcts) ]))))\n\n(def polygon6\n  (let left (+ (+ (- polygon5_left helper_r) (* 0.5! (+ (+ (- polygon5_left helper_r) (* 2! helper_r)) (- helper_r polygon5_left)))) (* 0.5! (+ (+ (- polygon5_left helper_r) (* 2! helper_r)) (- helper_r polygon5_left))))\n  (let bounds [left polygon6_top polygon6_right polygon6_bot]\n  (let [color strokeColor strokeWidth] [132 \'black\' 2]\n  (let pcts [[0 k3103] [k3105 0] [1 1]]\n    [ (stretchyPolygon bounds color strokeColor strokeWidth pcts) ])))))\n\n(def polygon7\n  (let [left right] [(+ (+ k3038 helper_r) helper_r) (- polygon6_right helper_r)]\n  (let bounds [left polygon7_top right polygon7_bot]\n  (let [color strokeColor strokeWidth] [334 \'black\' 2]\n  (let pcts [[0 1] [1 k3063] [k3061 0]]\n    [ (stretchyPolygon bounds color strokeColor strokeWidth pcts) ])))))\n\n(def circle8\n  (let [left top r] [(* 0.5! (+ polygon5_left polygon5_left)) (* 0.5! (+ polygon6_top polygon6_top)) (* 0.5! (- (* 0.5! (+ polygon6_right polygon6_right)) (* 0.5! (+ polygon5_left polygon5_left))))]\n  (let bounds [left top (+ left (* 2! r)) (+ top (* 2! r))]\n  (let [color strokeColor strokeWidth] [405 \'black\' 0]\n    [ (oval color strokeColor strokeWidth bounds) ]))))\n\n(blobs [\n  (helper k3046 k3045)\n  (helper polygon5_right k3041)\n  (helper k3038 polygon5_bot)\n  (helper k3034 polygon6_bot)\n  polygon5\n  polygon6\n  polygon7\n  circle8\n])\n\n';
var _user$project$ExamplesGenerated$sns_UIST = '\n(def newGroup4 (\\(line2_width line2_color color [left top right bot])\n  (def bounds [left top right bot])\n\n  (def rect1\n    (let bounds [left top right bot]\n      [ (rectangle color \'black\' \'0\' 0 bounds) ]))\n\n  (def line2\n      [ (line line2_color line2_width left top right bot) ])\n\n  (def line3\n    (let [ x2 y2] [ (* 0.5! (+ left right)) (* 0.5! (+ top bot))]\n      [ (line line2_color line2_width left bot x2 y2) ]))\n\n  [ (group bounds (concat [ rect1 line2 line3 ])) ]))\n\n(blobs [\n  (withBounds [31 100 216 269] (newGroup4 5 202 60))\n])\n\n';
var _user$project$ExamplesGenerated$snsLogoWheel = '\n(def logo (\\(rectColor\n             lineColor lineWidth\n             width height\n             rot\n             topLeft@[left top])\n\n  (def botRight@[right bot] [(+ left width) (+ top height)])\n\n  (def rect1\n    (rawRect rectColor 360 0 left top width height rot))\n\n  (def line2\n    (line lineColor lineWidth left top right bot))\n\n  (def line3\n    (lineBetween lineColor lineWidth\n      [left bot]\n      (halfwayBetween topLeft botRight)))\n\n  [ rect1 line2 line3 ]))\n\n(def wheel (\\(n\n              spokeLen spokeColor spokeWidth\n              logoSize logoColor1 logoColor2 logoLineWidth\n              hubRadius\n              rot center@[cx cy])\n\n  (def cars\n    (let car_i (\\[x y]\n      (let cx (- x (/ logoSize 2!))\n      (let cy (- y (/ logoSize 2!))\n        (logo logoColor1 logoColor2 logoLineWidth logoSize logoSize 0 [cx cy]))))\n    (radialArray n spokeLen rot car_i center)))\n\n  (def spokes\n    (let spoke_i (\\endpoint\n      [(lineBetween spokeColor spokeWidth center endpoint)])\n    (radialArray n spokeLen rot spoke_i center)))\n\n  (def hub\n    [(ring spokeColor spokeWidth cx cy hubRadius)])\n\n  (concat [ spokes cars hub ])\n))\n\n(blobs [\n  (wheel\n    (let n 16{1-30} n)\n    100 420 2\n    30 100 200 3\n    20\n    0\n    ([150 150] : Point)\n  )\n])\n\n';
var _user$project$ExamplesGenerated$cyclingAssociation0 = '\n; http://www.awwwards.com/gallery/4433/99-creative-logo-designs-for-inspiration/\n\n(def equiTriAt (\\(cx cy color sideLen rot)\n  (let len1 (* sideLen (/ 2! 3!))\n  (let len2 (* sideLen (/ 1! 3!))\n  (let point (circle color cx cy 15!)\n  (let tri (nStar \'none\' color 10! 3! len1 len2 rot cx cy)\n  [tri (ghost point)]\n))))))\n\n\n(def logo (\\(cx0 cy0\n             wheelRadius wheelDistance\n             armPct\n             wheelCapSize\n             [logoColor logoStrokeWidth])\n\n  (def helper\n    (ghosts (equiTriAt cx0 cy0 60 wheelDistance 0!)))\n\n  (def [ snap1 _ snap2 _ snap3 | _ ]\n    (polygonPoints (hd helper)))\n\n  (def onePiece (\\([cx cy] rot)\n\n    (def wheel\n      (rawCircle \'none\' logoColor logoStrokeWidth cx cy wheelRadius))\n\n    (def arm\n      (let armLength (* armPct wheelDistance)\n      (let dx (* armLength (cos (/ (pi) 3!)))\n      (let dy (* armLength (sin (/ (pi) 3!)))\n      (let d [\'M\' cx cy \'L\' (+ cx dx) (- cy dy) \'L\' (+ cx 8) (- cy dy)]\n        (rawPath \'none\' logoColor logoStrokeWidth d 0))))))\n\n    (def cap\n      (rawCircle logoColor 360 0 cx cy wheelCapSize))\n\n    [wheel (rotateAround rot cx cy arm) cap]\n  ))\n\n  ; TODO use a triangle function that doesn\'t draw center\n  (def midTriangle\n    ; slightly less than 0.50 to keep room for width of stroke\n    (equiTriAt cx0 cy0 logoColor (* 0.42! wheelDistance) (pi)))\n\n  (concat [\n    (onePiece snap2 0)\n    (onePiece snap1 120)\n    (onePiece snap3 240)\n    midTriangle\n    helper\n  ])\n))\n\n(blobs [\n  (logo 167 182 49 156.42857142857147 0.7 9 [416 9])\n])\n\n';
var _user$project$ExamplesGenerated$horrorFilms0 = '\n; http://www.awwwards.com/gallery/4453/99-creative-logo-designs-for-inspiration/\n\n(def equiTriAt (\\(cx cy color sideLen rot)\n  (let len1 (* sideLen (/ 2! 3!))\n  (let len2 (* sideLen (/ 1! 3!))\n  (let point (circle color cx cy 15!)\n  (let tri (nStar \'none\' color 10! 3! len1 len2 rot cx cy)\n  [tri point]\n))))))\n\n(def horror (\\(cx0 cy0 bgColor fgColor rBig rSmall sep)\n\n  (def helper\n    (ghosts (equiTriAt cx0 cy0 60 sep (pi))))\n\n  (def [ snap3 _ snap2 _ snap1 | _ ]\n    (polygonPoints (hd helper)))\n\n  (def backgroundCircle\n    [ (rawCircle bgColor 360 0 cx0 cy0 rBig) ])\n\n  (def foregroundCircle (\\[cx cy]\n    [ (rawCircle fgColor 360 0 cx cy rSmall) ]))\n\n  (concat [\n    backgroundCircle\n    (foregroundCircle snap1)\n    (foregroundCircle snap2)\n    (foregroundCircle snap3)\n    helper\n  ])\n))\n\n(blobs [\n  (horror 220 250 390 499 172 47 139)\n])\n\n';
var _user$project$ExamplesGenerated$blank = '(blobs [\n])\n\n';
var _user$project$ExamplesGenerated$spiralSpiralGraph = '; Spiral Spiral-Graph\n; Somewhat like the Spirograph toy, but based on a circle\n; following a spiral rather than a circle in a circle.\n\n(def n 140{1-200})\n(def revs 4{0-20})\n(def innerRevsRatio 2{0-20})\n(def innerR 125{0-500})\n\n(def placeCircle (\\i\n  (let spiralRadius 200\n  (let radius (* spiralRadius (/ i (- n 1)))\n  (let theta (* (* (/ i (- n 1)) (* 2 (pi))) revs)\n  (let innerTheta (* (* (* (/ i (- n 1)) (* 2 (pi))) innerRevsRatio) revs)\n  (let x (+ (+ (+ spiralRadius 150) (* radius (cos theta))) (* innerR (cos innerTheta)))\n  (let y (+ (+ (+ spiralRadius 250) (* radius (sin theta))) (* innerR (sin innerTheta)))\n    (circle i x y 10)\n  ))))))\n))\n\n(def theCircles (map placeCircle (range 1 n)))\n\n(svg theCircles)\n';
var _user$project$ExamplesGenerated$roundedRect = '\n(def roundedRect (\\(fill x y w h rxSeed rySeed)\n  (let off 20!\n  (let [wHalf hHalf] [(/ w 2!) (/ h 2!)]\n  (let [rx rxSlider] (hSlider true x (+ x wHalf) (- y off) 0! wHalf \'\' rxSeed)\n  (let [ry rySlider] (vSlider true y (+ y hHalf) (- x off) 0! hHalf \'\' rySeed)\n  (concat [\n    [ (consAttr (consAttr (rect fill x y w h) [\'rx\' rx]) [\'ry\' ry]) ]\n    rxSlider\n    rySlider\n  ])))))))\n\n(svg (concat [\n  [(rect \'black\' 0 0 0 0)] ; TODO remove dummy\n  (roundedRect 150 100 100 80 200 10 20)\n]))\n\n';
var _user$project$ExamplesGenerated$zones = '(def ngon (\\(n cx cy len1 len2)\n  (let dangle (/ (* 3! (pi)) 2!)\n  (let anglei (\\i (+ dangle (/ (* i (* 2! (pi))) n)))\n  (let xi     (\\i (+ cx (* len1 (cos (anglei i)))))\n  (let yi     (\\i (+ cy (* len2 (sin (anglei i)))))\n  (let pti    (\\i [(xi i) (yi i)])\n  (let pts    (map pti (list0N (- n 1!)))\n    (polygon \'goldenrod\' \'none\' 4 pts)))))))))\n\n(svg [\n  (rect \'goldenrod\' 32 170 109 132)\n  (ellipse \'goldenrod\' 203 237 32 68)\n  (ngon 5 464{200-600} 240{100-300} 60 60)\n  (path_ [\'M\' 261 250 \'Q\' 316.5 306 307 231 \'C\' 317 179 341 256 366 188 \'T\' 380 274])\n])\n\n';
var _user$project$ExamplesGenerated$floralLogo2 = '(def ringParameters [\n  ; petalSize petalRotation ringRadius ringRotation\n  [ 76{0-300} -0.266{-3.2-3.2}  -12{-100-300}   0.128{-3.2-3.2}]\n  [ 52{0-300} -0.317{-3.2-3.2}   60{-100-300}  -0.320{-3.2-3.2}]\n  [ 38{0-300} -0.629{-3.2-3.2}  104{-100-300}  -0.570{-3.2-3.2}]\n])\n\n(def rotatePointAround (\\(relX relY aroundX aroundY theta orientation)\n  (let relY (* orientation relY)\n  (let [rotRelX rotRelY] [(- (* relX (cos theta)) (* relY (sin theta))) (+ (* relX (sin theta)) (* relY (cos theta)))]\n    [(+ rotRelX aroundX) (+ rotRelY aroundY)]\n  ))\n))\n\n;(x + yi)(cos + isin) = xcos + ixsin + iycos - ysin\n;= (xcos - ysin) + (xsin + ycos)i\n\n(def petal (\\(x y scale theta orientation)\n  (let [[x1 y1]     [x2 y2]    ] [(rotatePointAround (* 1 scale) 0              x y theta orientation) (rotatePointAround 0              0             x y theta orientation)]\n  (let [[cx1a cy1a] [cx1b cy1b]] [(rotatePointAround (* 0.58 scale) (* 0.305 scale)  x y theta orientation) (rotatePointAround (* 0.43 scale) (* 0.275 scale)  x y theta orientation)]\n  (let [[cx2a cy2a] [cx2b cy2b]] [(rotatePointAround (* 0.4573836036582167 scale) (* -0.24276959866973943 scale) x y theta orientation) (rotatePointAround (* 0.5760783946789573 scale) (* -0.2389275837043081 scale) x y theta orientation)]\n    (path \'orange\' \'none\' 0 [\n      \'M\' x1 y1\n      \'C\' cx1a cy1a cx1b cy1b x2 y2\n      \'C\' cx2a cy2a cx2b cy2b x1 y1\n      \'Z\'\n    ])\n  )))\n))\n\n(def [x y] [300 200])\n(def [theta0 deltaTheta] [0.314{-3.2-3.2} -0.5{-3.2-3.2}])\n(def flower\n  (concat\n    (map\n      (\\[petalSize petalRotation ringRadius ringRotation]\n        (concatMap\n          (\\theta\n            (let armTheta (+ ringRotation theta)\n            (let rightPetalX (+ x (* ringRadius (cos armTheta)))\n            (let leftPetalX  (- x (* ringRadius (cos armTheta)))\n            (let petalY (+ y (* ringRadius (sin armTheta)))\n              [\n                (petal rightPetalX petalY petalSize (+ armTheta petalRotation) 1!)\n                (petal leftPetalX petalY petalSize (- (pi) (+ armTheta petalRotation)) -1!)\n              ]\n            ))))\n          )\n          [theta0 (+ theta0 deltaTheta) (+ theta0 (* 2! deltaTheta))]\n        )\n      )\n      ringParameters\n    )\n  )\n)\n\n(svg flower)\n';
var _user$project$ExamplesGenerated$floralLogo = '(def spiralArmCount 5)\n(def ringParameters [\n  ; petalSize petalRotation ringRadius ringRotation\n  [ 118{0-300}  0.63{-3.2-3.2} -16{-100-300}      0{-3.2-3.2}]\n  [ 76{0-300} -0.957{-3.2-3.2}  48{-100-300} -0.384{-3.2-3.2}]\n  [ 59{0-300} -1.269{-3.2-3.2}  76{-100-300} -0.89{-3.2-3.2}]\n  [ 36{0-300} -1.136{-3.2-3.2} 88{-100-300} -1.394{-3.2-3.2}]\n])\n\n(def rotatePointAround (\\(relX relY aroundX aroundY theta)\n  (let [rotRelX rotRelY] [(- (* relX (cos theta)) (* relY (sin theta))) (+ (* relX (sin theta)) (* relY (cos theta)))]\n    [(+ rotRelX aroundX) (+ rotRelY aroundY)]\n  )\n))\n\n;(x + yi)(cos + isin) = xcos + ixsin + iycos - ysin\n;= (xcos - ysin) + (xsin + ycos)i\n\n(def petal (\\(x y scale theta)\n  (let [[x1 y1]     [x2 y2]    ] [(rotatePointAround (* 1.0 scale) 0              x y theta) (rotatePointAround 0              0             x y theta)]\n  (let [[cx1a cy1a] [cx1b cy1b]] [(rotatePointAround (* 0.7 scale) (* 0.3 scale)  x y theta) (rotatePointAround (* 0.3 scale) (* 0.3 scale)  x y theta)]\n  (let [[cx2a cy2a] [cx2b cy2b]] [(rotatePointAround (* 0.4573836036582167 scale) (* -0.24276959866973943 scale) x y theta) (rotatePointAround (* 0.4710783946789573 scale) (* 0.40107241629569196 scale) x y theta)]\n    (path \'orange\' \'none\' 0 [\n      \'M\' x1 y1\n      \'C\' cx1a cy1a cx1b cy1b x2 y2\n      \'C\' cx2a cy2a cx2b cy2b x1 y1\n      \'Z\'\n    ])\n  )))\n))\n\n(def [x y] [300 140])\n(def flower\n  (concat\n    (map\n      (\\[petalSize petalRotation ringRadius ringRotation]\n        (map\n          (\\i\n            (let armTheta (+ ringRotation (* i (/ twoPi spiralArmCount)))\n            (let petalX (+ x (* ringRadius (cos armTheta)))\n            (let petalY (+ y (* ringRadius (sin armTheta)))\n              (petal petalX petalY petalSize (+ armTheta petalRotation))\n            )))\n          )\n          (range 0! (- spiralArmCount 1!))\n        )\n      )\n      ringParameters\n    )\n  )\n)\n\n(svg flower)\n\n';
var _user$project$ExamplesGenerated$tessellation2 = '; I believe this is set up for group p6mm\n; https://en.wikipedia.org/wiki/Wallpaper_group#Group_p6mm_.28.2A632.29\n\n; SVG transforms to flip, rotate, and position.\n(def transformGroup (\\(transformCenterX transformCenterY flipVertical rotationAngle translateX translateY shapes)\n  [\n    \'g\'\n    [\n      [\'transform\' [[\'translate\' (+ translateX transformCenterX) (+ translateY transformCenterY)] [\'rotate\' rotationAngle 0 0] [\'scale\' (if flipVertical -1 1) 1] [\'translate\' (- 0 transformCenterX) (- 0 transformCenterY)]]]\n    ]\n    shapes\n  ]\n))\n\n\n(def sin30 0.5!)\n(def cos30 (* 0.5! (sqrt 3!)))\n\n(def [x y radius] [350 200 200])\n(def innerRadius (* radius cos30))\n(def [bottomY cornerX] [(+ y innerRadius) (- x (/ radius 2!))])\n\n(def smallInnerRadius 36.14359353944901)\n(def smallInnerRadius2 62.143593539449)\n(def largeInnerRadius 74.2487113059643)\n\n(def primitive [\n  (path \'lightblue\' \'none\' 0 [\n    \'M\' x y\n    \'L\' x bottomY\n    \'L\' cornerX bottomY\n    \'Z\'\n  ])\n  (path \'blue\' \'none\' 0 [\n    \'M\' x y\n    \'L\' x (+ y (/ (* largeInnerRadius 2!) (sqrt 3!)))\n    \'L\' (- x (* smallInnerRadius sin30)) (+ y (* smallInnerRadius cos30))\n    \'Z\'\n  ])\n  (path \'darkblue\' \'none\' 0 [\n    \'M\' cornerX bottomY\n    \'L\' (+ cornerX smallInnerRadius2) bottomY\n    \'L\' (+ cornerX largeInnerRadius) (- bottomY (/ largeInnerRadius (sqrt 3!)))\n    \'L\' (+ cornerX (* smallInnerRadius2 sin30)) (- bottomY (* smallInnerRadius2 cos30))\n    \'Z\'\n  ])\n  (path \'white\' \'none\' 0 [\n    \'M\' x (+ y (/ (* largeInnerRadius 2!) (sqrt 3!)))\n    \'L\' (+ cornerX largeInnerRadius) (- bottomY (/ largeInnerRadius (sqrt 3!)))\n    \'L\' x (- bottomY (/ largeInnerRadius (sqrt 3!)))\n    \'Z\'\n  ])\n])\n\n(def primitiveHexagon [\n  (transformGroup x y false 0 0 0 primitive)\n  (transformGroup x y true  0 0 0 primitive)\n  (transformGroup x y false 60 0 0 primitive)\n  (transformGroup x y true  60 0 0 primitive)\n  (transformGroup x y false 120 0 0 primitive)\n  (transformGroup x y true  120 0 0 primitive)\n  (transformGroup x y false 180 0 0 primitive)\n  (transformGroup x y true  180 0 0 primitive)\n  (transformGroup x y false 240 0 0 primitive)\n  (transformGroup x y true  240 0 0 primitive)\n  (transformGroup x y false 300 0 0 primitive)\n  (transformGroup x y true  300 0 0 primitive)\n])\n\n(def primitiveHexagonColumn [\n  (transformGroup x y false 0 0 (* -2 innerRadius) primitiveHexagon)\n  (transformGroup x y false 0 0 0 primitiveHexagon)\n  (transformGroup x y false 0 0 (* 2 innerRadius) primitiveHexagon)\n  (transformGroup x y false 0 0 (* 4 innerRadius) primitiveHexagon)\n])\n\n(def primitiveHexagonColumns [\n  (transformGroup x y false 0 (* -1 (* radius (+ 1 sin30))) innerRadius primitiveHexagonColumn)\n  (transformGroup x y false 0 0 0 primitiveHexagonColumn)\n  (transformGroup x y false 0 (* 1 (* radius (+ 1 sin30))) innerRadius primitiveHexagonColumn)\n  (transformGroup x y false 0 (* 3 radius) 0 primitiveHexagonColumn)\n])\n\n(svg primitiveHexagonColumns)\n';
var _user$project$ExamplesGenerated$tessellationTarget = '; I believe this is set up for group p6mm\n; https://en.wikipedia.org/wiki/Wallpaper_group#Group_p6mm_.28.2A632.29\n\n; SVG transforms to flip, rotate, and position.\n(def transformGroup (\\(transformCenterX transformCenterY flipVertical rotationAngle translateX translateY shapes)\n  [\n    \'g\'\n    [\n      [\'transform\' [[\'translate\' (+ translateX transformCenterX) (+ translateY transformCenterY)] [\'rotate\' rotationAngle 0 0] [\'scale\' (if flipVertical -1 1) 1] [\'translate\' (- 0 transformCenterX) (- 0 transformCenterY)]]]\n    ]\n    shapes\n  ]\n))\n\n\n(def sin30 0.5!)\n(def cos30 (* 0.5! (sqrt 3!)))\n\n(def [x y radius] [350 200 200])\n(def innerRadius (* radius cos30))\n(def [bottomY cornerX] [(+ y innerRadius) (- x (/ radius 2!))])\n(def primativeBottomWidth (/ radius 2!))\n\n(def smallInnerRadius 56)\n(def largeInnerRadius 69)\n(def bottomRectWidth (- primativeBottomWidth smallInnerRadius))\n(def bottomRectHeight (/ smallInnerRadius (sqrt 3!)))\n\n(def primitive [\n  (path \'lightblue\' \'none\' 0 [\n    \'M\' x y\n    \'L\' x bottomY\n    \'L\' cornerX bottomY\n    \'Z\'\n  ])\n  (path \'green\' \'none\' 0 [\n    \'M\' x y\n    \'L\' x (+ y (/ (* largeInnerRadius 2!) (sqrt 3!)))\n    \'L\' (- x (* smallInnerRadius sin30)) (+ y (* smallInnerRadius cos30))\n    \'Z\'\n  ])\n  (path \'green\' \'none\' 0 [\n    \'M\' cornerX bottomY\n    \'L\' (+ cornerX smallInnerRadius) bottomY\n    \'L\' (+ cornerX largeInnerRadius) (- bottomY (/ largeInnerRadius (sqrt 3!)))\n    \'L\' (+ cornerX (* smallInnerRadius sin30)) (- bottomY (* smallInnerRadius cos30))\n    \'Z\'\n  ])\n  (path \'red\' \'none\' 0 [\n    \'M\' x (+ y (/ (* largeInnerRadius 2!) (sqrt 3!)))\n    \'L\' (+ cornerX largeInnerRadius) (- bottomY (/ largeInnerRadius (sqrt 3!)))\n    \'L\' x (- bottomY (/ largeInnerRadius (sqrt 3!)))\n    \'Z\'\n  ])\n])\n\n(def primitiveHexagon [\n  (transformGroup x y false 0 0 0 primitive)\n  (transformGroup x y true  0 0 0 primitive)\n  (transformGroup x y false 60 0 0 primitive)\n  (transformGroup x y true  60 0 0 primitive)\n  (transformGroup x y false 120 0 0 primitive)\n  (transformGroup x y true  120 0 0 primitive)\n  (transformGroup x y false 180 0 0 primitive)\n  (transformGroup x y true  180 0 0 primitive)\n  (transformGroup x y false 240 0 0 primitive)\n  (transformGroup x y true  240 0 0 primitive)\n  (transformGroup x y false 300 0 0 primitive)\n  (transformGroup x y true  300 0 0 primitive)\n])\n\n(def primitiveHexagonColumn [\n  (transformGroup x y false 0 0 (* -2 innerRadius) primitiveHexagon)\n  (transformGroup x y false 0 0 0 primitiveHexagon)\n  (transformGroup x y false 0 0 (* 2 innerRadius) primitiveHexagon)\n  (transformGroup x y false 0 0 (* 4 innerRadius) primitiveHexagon)\n])\n\n(def primitiveHexagonColumns [\n  (transformGroup x y false 0 (* -1 (* radius (+ 1 sin30))) innerRadius primitiveHexagonColumn)\n  (transformGroup x y false 0 0 0 primitiveHexagonColumn)\n  (transformGroup x y false 0 (* 1 (* radius (+ 1 sin30))) innerRadius primitiveHexagonColumn)\n  (transformGroup x y false 0 (* 3 radius) 0 primitiveHexagonColumn)\n])\n\n(svg primitiveHexagonColumns)\n';
var _user$project$ExamplesGenerated$tessellation = '; I believe this is set up for group p6mm\n; https://en.wikipedia.org/wiki/Wallpaper_group#Group_p6mm_.28.2A632.29\n\n; SVG transforms to flip, rotate, and position.\n(def transformGroup (\\(transformCenterX transformCenterY flipVertical rotationAngle translateX translateY shapes)\n  [\n    \'g\'\n    [\n      [\'transform\' [[\'translate\' (+ translateX transformCenterX) (+ translateY transformCenterY)] [\'rotate\' rotationAngle 0 0] [\'scale\' (if flipVertical -1 1) 1] [\'translate\' (- 0 transformCenterX) (- 0 transformCenterY)]]]\n    ]\n    shapes\n  ]\n))\n\n\n(def sin30 0.5!)\n(def cos30 (* 0.5! (sqrt 3!)))\n\n(def [x y radius] [350 200 200])\n(def innerRadius (* radius cos30))\n(def [bottomY cornerX] [(+ y innerRadius) (- x (/ radius 2!))])\n(def primativeBottomWidth (/ radius 2!))\n\n(def smallInnerRadius 50)\n(def bottomRectWidth (- primativeBottomWidth smallInnerRadius))\n(def bottomRectHeight (/ smallInnerRadius (sqrt 3!)))\n\n(def primitive [\n  (path \'lightblue\' \'none\' 0 [\n    \'M\' x y\n    \'L\' x bottomY\n    \'L\' cornerX bottomY\n    \'Z\'\n  ])\n  (path \'green\' \'none\' 0 [\n    \'M\' x y\n    \'L\' x (+ y (/ (* smallInnerRadius 2!) (sqrt 3!)))\n    \'L\' (- x (* smallInnerRadius sin30)) (+ y (* smallInnerRadius cos30))\n    \'Z\'\n  ])\n  (path \'green\' \'none\' 0 [\n    \'M\' cornerX bottomY\n    \'L\' (+ cornerX smallInnerRadius) bottomY\n    \'L\' (+ cornerX smallInnerRadius) (- bottomY (/ smallInnerRadius (sqrt 3!)))\n    \'L\' (+ cornerX (* smallInnerRadius sin30)) (- bottomY (* smallInnerRadius cos30))\n    \'Z\'\n  ])\n  (rect \'pink\' (- x bottomRectWidth) (- bottomY bottomRectHeight) bottomRectWidth bottomRectHeight)\n  (path \'pink\' \'none\' 0 [\n    \'M\' x (+ y (/ (* smallInnerRadius 2!) (sqrt 3!)))\n    \'L\' (+ cornerX smallInnerRadius) (- bottomY (/ smallInnerRadius (sqrt 3!)))\n    \'L\' (+ cornerX (* smallInnerRadius sin30)) (- bottomY (* smallInnerRadius cos30))\n    \'L\' (- x (* smallInnerRadius sin30)) (+ y (* smallInnerRadius cos30))\n    \'Z\'\n  ])\n  (path \'red\' \'none\' 0 [\n    \'M\' x (- bottomY bottomRectHeight)\n    \'L\' x (- (- bottomY bottomRectHeight) (* bottomRectWidth cos30))\n    \'L\' (- x (/ bottomRectWidth 2)) (- (- bottomY bottomRectHeight) (* bottomRectWidth cos30))\n    \'Z\'\n  ])\n])\n\n(def primitiveHexagon [\n  (transformGroup x y false 0 0 0 primitive)\n  (transformGroup x y true  0 0 0 primitive)\n  (transformGroup x y false 60 0 0 primitive)\n  (transformGroup x y true  60 0 0 primitive)\n  (transformGroup x y false 120 0 0 primitive)\n  (transformGroup x y true  120 0 0 primitive)\n  (transformGroup x y false 180 0 0 primitive)\n  (transformGroup x y true  180 0 0 primitive)\n  (transformGroup x y false 240 0 0 primitive)\n  (transformGroup x y true  240 0 0 primitive)\n  (transformGroup x y false 300 0 0 primitive)\n  (transformGroup x y true  300 0 0 primitive)\n])\n\n(def primitiveHexagonColumn [\n  (transformGroup x y false 0 0 (* -2 innerRadius) primitiveHexagon)\n  (transformGroup x y false 0 0 0 primitiveHexagon)\n  (transformGroup x y false 0 0 (* 2 innerRadius) primitiveHexagon)\n  (transformGroup x y false 0 0 (* 4 innerRadius) primitiveHexagon)\n])\n\n(def primitiveHexagonColumns [\n  (transformGroup x y false 0 (* -1 (* radius (+ 1 sin30))) innerRadius primitiveHexagonColumn)\n  (transformGroup x y false 0 0 0 primitiveHexagonColumn)\n  (transformGroup x y false 0 (* 1 (* radius (+ 1 sin30))) innerRadius primitiveHexagonColumn)\n  (transformGroup x y false 0 (* 3 radius) 0 primitiveHexagonColumn)\n])\n\n(svg primitiveHexagonColumns)\n';
var _user$project$ExamplesGenerated$keyboard2target = '(def scale 40)\n(def keyBaseHeight scale)\n(def keyBaseWidth keyBaseHeight)\n(def relativeSpacing 0.3333333333333)\n\n(def [boardLeft boardTop] [54 50])\n\n(def key (\\(relativeLeft relativeTop relativeWidth relativeHeight)\n  (rect\n    \'lightgray\'\n    (+ boardLeft (* relativeLeft keyBaseWidth))\n    (+ boardTop (* relativeTop keyBaseWidth))\n    (* relativeWidth keyBaseWidth)\n    (* relativeHeight keyBaseHeight)\n  )\n))\n\n; Generate a row of keys with the given relativeKeyWidths, separated by relativeKeySpacing\n; Returns [keyRects relativeTotalWidth]\n(def row (\\(relativeLeft relativeTop relativeHeight relativeKeySpacing relativeKeyWidths)\n  (let [keys relativeWidthPlusSpacing]\n    (foldl\n      (\\(relativeKeyWidth [keys nextKeyRelativeLeft])\n        (let newKey (key nextKeyRelativeLeft relativeTop relativeKeyWidth relativeHeight)\n          [[newKey|keys] (+ nextKeyRelativeLeft (+ relativeKeySpacing relativeKeyWidth))]\n        )\n      )\n      [[] relativeLeft]\n      relativeKeyWidths\n    )\n  [keys (- (- relativeWidthPlusSpacing relativeKeySpacing) relativeLeft)]\n  )\n))\n\n(def row2EndKeysWidth 1.95)\n(def row3EndKeysWidth 2.625)\n(def row4CommandKeysWidth 1.5)\n\n(def row1RelativeKeyWidths [1.575 1 1 1 1 1 1 1 1 1])\n(def row2RelativeKeyWidths [row2EndKeysWidth 1 1 1 1 1 1 1 row2EndKeysWidth])\n(def row3RelativeKeyWidths [row3EndKeysWidth 1 1 1 1 1 1 row3EndKeysWidth])\n(def row4RelativeKeyWidths [1 row4CommandKeysWidth 7.2667 row4CommandKeysWidth 1])\n\n(def [row1 keysRelativeWidth] (row relativeSpacing relativeSpacing 1 relativeSpacing row1RelativeKeyWidths))\n(def [row2        _] (row relativeSpacing (+ 1 (* 2 relativeSpacing)) 1 relativeSpacing row2RelativeKeyWidths))\n(def [row3        _] (row relativeSpacing (+ 2 (* 3 relativeSpacing)) 1 relativeSpacing row3RelativeKeyWidths))\n(def [row4        _] (row relativeSpacing (+ 3 (* 4 relativeSpacing)) 1 relativeSpacing row4RelativeKeyWidths))\n\n(def boardRelativeWidth  (+ keysRelativeWidth (* 2 relativeSpacing)))\n(def boardRelativeHeight (+ 4 (* 5 relativeSpacing)))\n\n(def backBoard\n  (rect \'green\' boardLeft boardTop (* boardRelativeWidth scale) (* boardRelativeHeight scale))\n)\n\n(svg (concat [\n  [backBoard]\n  row1\n  row2\n  row3\n  row4\n]))\n';
var _user$project$ExamplesGenerated$keyboard2 = '(def scale 40)\n(def keyBaseHeight scale)\n(def keyBaseWidth keyBaseHeight)\n(def relativeSpacing 0.3333333333333)\n\n(def [boardLeft boardTop] [50 50])\n\n(def key (\\(relativeLeft relativeTop relativeWidth relativeHeight)\n  (rect\n    \'lightgray\'\n    (+ boardLeft (* relativeLeft keyBaseWidth))\n    (+ boardTop (* relativeTop keyBaseWidth))\n    (* relativeWidth keyBaseWidth)\n    (* relativeHeight keyBaseHeight)\n  )\n))\n\n; Generate a row of keys with the given relativeKeyWidths, separated by relativeKeySpacing\n; Returns [keyRects relativeTotalWidth]\n(def row (\\(relativeLeft relativeTop relativeHeight relativeKeySpacing relativeKeyWidths)\n  (let [keys relativeWidthPlusSpacing]\n    (foldl\n      (\\(relativeKeyWidth [keys nextKeyRelativeLeft])\n        (let newKey (key nextKeyRelativeLeft relativeTop relativeKeyWidth relativeHeight)\n          [[newKey|keys] (+ nextKeyRelativeLeft (+ relativeKeySpacing relativeKeyWidth))]\n        )\n      )\n      [[] relativeLeft]\n      relativeKeyWidths\n    )\n  [keys (- (- relativeWidthPlusSpacing relativeKeySpacing) relativeLeft)]\n  )\n))\n\n(def row1RelativeKeyWidths [1 1 1 1 1 1 1 1])\n(def row2RelativeKeyWidths [1 1 1 1 1 1 1 1])\n(def row3RelativeKeyWidths [1 1 1 1 1 1 1 1])\n(def row4RelativeKeyWidths [1 7.6667      1])\n\n(def [row1 keysRelativeWidth] (row relativeSpacing relativeSpacing 1 relativeSpacing row1RelativeKeyWidths))\n(def [row2 _] (row relativeSpacing (+ 1 (* 2 relativeSpacing)) 1 relativeSpacing row2RelativeKeyWidths))\n(def [row3 _] (row relativeSpacing (+ 2 (* 3 relativeSpacing)) 1 relativeSpacing row3RelativeKeyWidths))\n(def [row4 _] (row relativeSpacing (+ 3 (* 4 relativeSpacing)) 1 relativeSpacing row4RelativeKeyWidths))\n\n(def boardRelativeWidth  (+ keysRelativeWidth (* 2 relativeSpacing)))\n(def boardRelativeHeight (+ 4 (* 5 relativeSpacing)))\n\n(def backBoard\n  (rect \'green\' boardLeft boardTop (* boardRelativeWidth scale) (* boardRelativeHeight scale))\n)\n\n(svg (concat [\n  [backBoard]\n  row1\n  row2\n  row3\n  row4\n]))\n';
var _user$project$ExamplesGenerated$keyboard = '(def scale 25)\n(def keyBaseHeight scale)\n(def keyBaseWidth keyBaseHeight)\n(def relativeSpacing 0.3333333333333)\n\n(def [boardLeft boardTop] [50 50])\n\n(def key (\\(relativeLeft relativeTop relativeWidth relativeHeight)\n  (rect\n    \'orange\'\n    (+ boardLeft (* relativeLeft keyBaseWidth))\n    (+ boardTop (* relativeTop keyBaseWidth))\n    (* relativeWidth keyBaseWidth)\n    (* relativeHeight keyBaseHeight)\n  )\n))\n\n; Generate a row of keys with the given relativeKeyWidths, separated by relativeKeySpacing\n; Returns [keyRects relativeTotalWidth]\n(def row (\\(relativeLeft relativeTop relativeHeight relativeKeySpacing relativeKeyWidths)\n  (let [keys relativeWidthPlusSpacing]\n    (foldl\n      (\\(relativeKeyWidth [keys nextKeyRelativeLeft])\n        (let newKey (key nextKeyRelativeLeft relativeTop relativeKeyWidth relativeHeight)\n          [[newKey|keys] (+ nextKeyRelativeLeft (+ relativeKeySpacing relativeKeyWidth))]\n        )\n      )\n      [[] relativeLeft]\n      relativeKeyWidths\n    )\n  [keys (- (- relativeWidthPlusSpacing relativeKeySpacing) relativeLeft)]\n  )\n))\n\n(def row1SquareKeyCount 10)\n(def row2SquareKeyCount 8)\n(def row3SquareKeyCount 7)\n\n(def row2SquareKeysRelativeWidth (+ row2SquareKeyCount (* relativeSpacing (- row2SquareKeyCount 1))))\n(def row3SquareKeysRelativeWidth (+ row3SquareKeyCount (* relativeSpacing (- row3SquareKeyCount 1))))\n\n(def [row1 keysRelativeWidth] (row relativeSpacing relativeSpacing 1 relativeSpacing [1.5|(repeat row1SquareKeyCount 1)]))\n\n; Make the first and last keys of the row the appropriate width so the other keys are center.\n(def row2EdgeKeyRelativeWidth (- (* 0.5 (- keysRelativeWidth row2SquareKeysRelativeWidth)) relativeSpacing))\n(def row3EdgeKeyRelativeWidth (- (* 0.5 (- keysRelativeWidth row3SquareKeysRelativeWidth)) relativeSpacing))\n\n(def [row2 _] (row relativeSpacing (+ 1 (* 2 relativeSpacing)) 1 relativeSpacing (concat [[row2EdgeKeyRelativeWidth] (repeat row2SquareKeyCount 1) [row2EdgeKeyRelativeWidth]])))\n(def [row3 _] (row relativeSpacing (+ 2 (* 3 relativeSpacing)) 1 relativeSpacing (concat [[row3EdgeKeyRelativeWidth] (repeat row3SquareKeyCount 1) [row3EdgeKeyRelativeWidth]])))\n\n(def boardRelativeWidth  (+ keysRelativeWidth (* 2 relativeSpacing)))\n(def boardRelativeHeight (+ 4 (* 5 relativeSpacing)))\n\n(def arrowVerticalSpacing 0.1)\n(def arrowHeight (* 0.5 (- 1 arrowVerticalSpacing)))\n(def arrowsRelativeWidth (+ 3 (* 2 relativeSpacing)))\n(def [bottomArrows _] (row (- (- boardRelativeWidth arrowsRelativeWidth) relativeSpacing) (+ arrowVerticalSpacing (+ arrowHeight (+ 3 (* 4 relativeSpacing)))) arrowHeight relativeSpacing (repeat 3 1)))\n\n(def topArrow\n  (key\n    (- (- boardRelativeWidth (+ 2 relativeSpacing)) relativeSpacing)\n    (+ 3 (* 4 relativeSpacing))\n    1\n    arrowHeight\n  )\n)\n\n(def row4SquareKeyCount 2)\n(def row4NextToSpaceBarKeyRelativeWidth 1.25)\n(def row4NotArrowsRelativeWidth (- (- keysRelativeWidth arrowsRelativeWidth) relativeSpacing))\n(def row4SquareKeysRelativeWidth (+ row4SquareKeyCount (* relativeSpacing (- row4SquareKeyCount 1))))\n(def spaceBarRelativeWidth (- row4NotArrowsRelativeWidth (+ row4SquareKeysRelativeWidth (+ (* 2 row4NextToSpaceBarKeyRelativeWidth) (* 3 relativeSpacing)))))\n(def row4KeyRelativeWidths (concat [(repeat row4SquareKeyCount 1) [row4NextToSpaceBarKeyRelativeWidth spaceBarRelativeWidth row4NextToSpaceBarKeyRelativeWidth]]))\n(def [row4 _] (row relativeSpacing (+ 3 (* 4 relativeSpacing)) 1 relativeSpacing row4KeyRelativeWidths))\n\n(def backBoard\n  (rect \'lightblue\' boardLeft boardTop (* boardRelativeWidth scale) (* boardRelativeHeight scale))\n)\n\n(svg (concat [\n  [backBoard]\n  row1\n  row2\n  row3\n  bottomArrows\n  [topArrow]\n  row4\n]))\n';
var _user$project$ExamplesGenerated$lilliconP2 = '\n(def [x0 x1 x2 x3 x4] [20 80 150 240 380])\n(def [y0 y1 y2 y3]    [20 125 296 424])\n\n(def yRightmostPt (+ y0 (/ (- y2 y0) 2!)))\n(def arcR 1!) ; any non-zero, not-too-large number works\n\n(def theP\n  (path \'black\' \'none\' 0\n    [\'M\' x0 y3\n     \'C\' x1 376 x1 216 x1 y1\n     \'C\' 80 60 134 y0 x3 y0\n     \'A\' arcR arcR 0 0 1 x3 y2\n     \'L\' x2 y2\n     \'L\' x2 y3\n     \'L\' x0 y3\n    ]))\n\n(def highlights\n  (let r 10!\n  [ (circle \'goldenrod\' x3 y2 r)\n    (circle \'magenta\'   x2 y2 r) ]))\n\n(svg (cons theP (if true highlights [])))\n\n';
var _user$project$ExamplesGenerated$lilliconP = '\n(def [x0 x1 x2 x3 x4] [20 80 150 240 380])\n(def [y0 y1 y2 y3]    [20 125 296 424])\n\n(def yRightmostPt (+ y0 (/ (- y2 y0) 2!)))\n(def delta 50!) ; TODO\n\n(def theP\n  (path \'black\' \'none\' 0\n    [\'M\' x0 y3\n     \'C\' x1 376 x1 216 x1 y1\n     \'C\' 80 60 134 y0 x3 y0\n     \'C\' (- x4 delta) y0 x4 (+ y0 delta) x4 yRightmostPt\n     \'C\' x4 (- y2 delta) (- x4 delta) y2 x3 y2\n     \'L\' x2 y2\n     \'L\' x2 y3\n     \'L\' x0 y3\n    ]))\n\n(def highlights\n  (let r 10!\n  (cons\n    (circle \'goldenrod\' x3 y2 r)\n    (map (\\[x y] (circle \'magenta\' x y r))\n         [[(- x4 delta) y0]\n          [x4 (+ y0 delta)]\n          [x4 yRightmostPt]\n          [x4 (- y2 delta)]\n          [(- x4 delta) y2]\n          [x2 y2]\n         ]))))\n\n(svg (cons theP (if true highlights [])))\n\n';
var _user$project$ExamplesGenerated$gridTile = '\n(def grid (\\(x0 y0 w h n m)\n  (let [xw yh] [(+ x0 w) (+ y0 h)]\n  (let [rowH colW] [(/ h n) (/ w m)]\n  (let box (rect 460 x0 y0 w h)\n  (let rows\n    (map (\\i (let yi (+ y0 (mult i rowH))\n             (line \'black\' 2 x0 yi xw yi)))\n         (range 0! n))\n  (let cols\n    (map (\\i (let xi (+ x0 (mult i colW))\n             (line \'black\' 2 xi y0 xi yh)))\n         (range 0! n))\n  (concat [[box] rows cols]))))))))\n\n(def [x0 y0 w h n m] [100 100 325 285 10! 10!])\n\n(def blob\n  (ellipse 196 (+ x0 (/ w 2!))\n               (+ y0 (/ h 2!))\n               (- (/ w 2!) (/ w m))\n               (- (/ h 2!) (/ h n))))\n\n(svg (append\n  (grid x0 y0 w h n m)\n  [blob]\n))\n\n';
var _user$project$ExamplesGenerated$equiTri = '\n; Equilateral Triangles\n; (derived in terms of nStar, rather than nGon)\n\n(def tri (\\(c x y sideLen rot)\n  (let len1 (* sideLen (/ 2! 3!))\n  (let len2 (* sideLen (/ 1! 3!))\n  (nStar c \'none\' 0 3! len1 len2 rot x y)))))\n\n(svg [\n  (tri \'darkblue\'\n    150 150\n    100\n    0)\n  (tri \'lightblue\'\n    200 300\n    50\n    10)\n])\n\n';
var _user$project$ExamplesGenerated$surveyResultsTriHist2 = '\n; Interactive charts that show results from user study:\n; http://ravichugh.github.io/sketch-n-sketch/blog/03-user-study-videos.html\n\n; counts: [ A/B C/A C/B CI-Intervals ]\n\n(def ferrisCounts [\n  [ 3 14  2  5  1 ]\n  [ 0  3  1 11 10 ]\n  [ 1  3  4  9  8 ]\n  [ [-0.92 0.01] [0.59 1.47] [0.25 1.23] ]\n])\n\n(def keyboardCounts [\n  [ 0  5  3 10  7 ]\n  [ 0  1  5 14  5 ]\n  [ 0  2  2  9 12 ]\n  [ [0.26 1.18] [0.59 1.21] [0.73 1.57] ]\n])\n\n(def tesselationCounts [\n  [ 0  7  9  6  3 ]\n  [ 1  0  8 11  5 ]\n  [ 1  0  4 13  7 ]\n  [ [-0.20 0.64] [0.34 1.10] [0.53 1.32] ]\n])\n\n(def maxDataPoint 14!)\n\n(def sum (\\ns\n  (foldr\n    (\\([weight n] acc) (+ (* n weight) acc))\n    0 (zip [0 1 2 3 4] ns))))\n\n(def [iRot jRot kRot]                   [0! -120! 120!])\n(def [iRevCounts jRevCounts kRevCounts] [id id reverse])\n(def [iRevAvg jRevAvg kRevAvg]          [id id (\\n (+ (neg (- n 2!)) 2!))])\n(def [iRevBound jRevBound kRevBound]    [(\\n (+ 2! n)) (\\n (+ 2! n)) (\\n (+ 2! (neg n)))])\n\n(def numUsers 25!)\n(def numBins 5!)\n(def slices (- numBins 0!))\n(def shift  (\\idx (+ idx 0.5!)))\n\n(def sideLen 90{20-200})\n(def sidePad 13!{0-50})\n(def tickLen 5!{1-10})\n(def edgeWidth 1!{0-4})\n(def levelWidth 1.0!{0.0-2.1})\n(def dotSize 5!{3-10})\n(def barSize 16!{1-20})\n(def intWidth 8!{1-30})\n(def intTicks 0!{-3-15})\n(def fontSize 20!{10-40})\n(def showAvgs (let showAvgs_ 0.7{0.1-1.0} (< showAvgs_ 0.5!)))\n(def showTicks (let showTicks_ 0.7{0.1-1.0} (< showTicks_ 0.5!)))\n\n(def [aUp   aLeft]  [-5!{-20-50}  25!{0-50}])\n(def [bUp   bRight] [aUp          98!{0-150}])\n(def [cDown cLeft]  [115!{50-200} 10!{0-30}])\n\n(def halfLen (/ sideLen 2!))\n\n(def tri (\\(cx cy [iCounts jCounts kCounts ciIntervals])\n  (let [iSum jSum kSum] (map sum [iCounts jCounts kCounts])\n  (let [iAvg jAvg kAvg] [(/ iSum numUsers) (/ jSum numUsers) (/ kSum numUsers)]\n  (let [iBounds jBounds kBounds] ciIntervals\n  (let x0    (- cx halfLen)\n  (let x1    (+ cx halfLen)\n  (let y     (- cy (* (+ sideLen (* 2! sidePad)) (/ (sqrt 3!) 6!)))\n  (let dx    (/ (- x1 x0) slices)\n  (let xi    (\\i (+ x0 (* (shift i) dx)))\n  (let yn    (\\n (- y (* n tickLen)))\n  (let edge  (line \'gray\' edgeWidth)\n  (let tick  (\\x (circle \'gray\' x y 3!))\n  (let bar   (line \'lightblue\' barSize)\n  (let dot   (\\x (circle \'goldenrod\' x y dotSize))\n  (let level (\\i (let yLevel (- y (* i tickLen))\n                 (line \'white\' levelWidth x0 yLevel x1 yLevel)))\n  (let label (\\(x y s)\n    (addAttr (text x y s) [\'font-size\' (+ (toString fontSize) \'pt\')]))\n  (let edges\n    [ (rotate (edge x0 y x1 y) iRot cx cy)\n      (rotate (edge x0 y x1 y) jRot cx cy)\n      (rotate (edge x0 y x1 y) kRot cx cy)\n    ]\n  (let tickmarks\n    (let foo (\\rot\n      (map (\\i (rotate (tick (+ (+ x0 (/ dx 2!)) (* i dx))) rot cx cy))\n           (zeroTo slices)))\n    (concatMap foo [iRot jRot kRot]))\n  (let levels\n    (let foo (\\rot\n      (map (\\i (rotate (level i) rot cx cy))\n           (range 1! maxDataPoint)))\n    (concatMap foo [iRot jRot kRot]))\n  (let averages\n    [ (rotate (dot (xi (iRevAvg iAvg))) iRot cx cy)\n      (rotate (dot (xi (jRevAvg jAvg))) jRot cx cy)\n      (rotate (dot (xi (kRevAvg kAvg))) kRot cx cy)\n    ]\n  (let intervals\n    (let draw (\\(revBound [ciMin ciMax] rot)\n      [ (rotate (line \'red\' intWidth\n           (xi (revBound ciMin)) (- y (* intTicks tickLen))\n           (xi (revBound ciMax)) (- y (* intTicks tickLen))) rot cx cy) ])\n    (concat [\n      (draw iRevBound iBounds iRot)\n      (draw jRevBound jBounds jRot)\n      (draw kRevBound kBounds kRot)\n    ]))\n  (let labels\n    [ (label (- x0 aLeft) (- y aUp) \'A\')\n      (label (+ x0 bRight) (- y bUp) \'B\')\n      (label (- (+ x0 (/ (- x1 x0) 2!)) cLeft) (+ y cDown) \'C\')\n    ]\n  (concat [\n    (flip mapi (iRevCounts iCounts) (\\[i n]\n      (rotate (bar (xi i) y (xi i) (yn n)) iRot cx cy)))\n    (flip mapi (jRevCounts jCounts) (\\[i n]\n      (rotate (bar (xi i) y (xi i) (yn n)) jRot cx cy)))\n    (flip mapi (kRevCounts kCounts) (\\[i n]\n      (rotate (bar (xi i) y (xi i) (yn n)) kRot cx cy)))\n    levels\n    edges\n    intervals\n    (if showTicks tickmarks [])\n    (if showAvgs averages [])\n    labels\n  ]\n))))))))))))))))))))))))\n\n(def [cx0 cy0] [180!{0-200} 130!{0-200}])\n(def sep 216!{100-300})\n\n(svg (concat\n  (mapi\n    (\\[i countsi] (tri cx0 (+ cy0 (* i sep)) countsi))\n    [ferrisCounts keyboardCounts tesselationCounts])))\n\n';
var _user$project$ExamplesGenerated$bezier = '; Animated Bezier Curves\n; Recreating https://www.jasondavies.com/animated-bezier/\n;\n; Bezier functions\n;\n(def linbez (\\(t p1 p2)\n  (+ p1 (* t (- p2 p1))) ) )\n(def quadbez (\\(t p1 p2 p3)\n  (+ (* (- 1 t) (linbez t p1 p2)) (* t (linbez t p2 p3))) ) )\n(def cubez (\\(t p1 p2 p3 p4)\n  (+ (* (- 1 t) (quadbez t p1 p2 p3)) (* t (quadbez t p2 p3 p4))) ) )\n(def quarbez (\\(t p1 p2 p3 p4 p5)\n  (+ (* (- 1 t) (cubez t p1 p2 p3 p4)) (* t (cubez t p2 p3 p4 p5))) ) )\n;\n; Point definitions\n;\n(def [t tslider] (hSlider false 50! 450! 300! 0! 1! \'t: \' 0.25))\n(def [linx1 liny1 linx2 liny2] [50 200 100 50])\n(def [quadx1 quady1 quadx2 quady2 quadx3 quady3] \n     [(+ linx1 150!) liny1 (+ linx2 150!) liny2 300 200])\n(def [cux1 cuy1 cux2 cuy2 cux3 cuy3 cux4 cuy4] \n     [(+ quadx1 150!) liny1 (+ quadx2 150!) liny2 (+ quadx3 150!) quady3 500 50])\n(def [qux1 quy1 qux2 quy2 qux3 quy3 qux4 quy4 qux5 quy5]\n     [(+ cux1 150!) liny1 (+ cux2 150!) liny2 (+ cux3 150!) quady3 (+ cux4 150!) cuy4 700 200])\n;\n; Style Definitions\n;\n(def [linwd col1 col2 col3 col4] [3 \'gray\' \'lightblue\' \'green\' \'lightgreen\'])\n(def ptcirc (\\(cx cy) (circle \'red\' cx cy 5!)))\n;\n; Curve Definitions\n;\n(def linCurve\n  (let [midx midy] [(linbez t linx1 linx2) (linbez t liny1 liny2)]\n  [ (path \'none\' col1 linwd\n      [ \'M\' linx1 liny1\n        \'L\' linx2 liny2 ] )\n    (path \'none\' \'red\' linwd\n      [ \'M\' linx1 liny1\n        \'L\' midx midy ] )\n    (ptcirc midx midy)  ] ) )\n(def quadCurve\n  (let [midx1 midy1 midx2 midy2] [(linbez t quadx1 quadx2) (linbez t quady1 quady2)\n                                  (linbez t quadx2 quadx3) (linbez t quady2 quady3)]\n  (let [px py] [(quadbez t quadx1 quadx2 quadx3) (quadbez t quady1 quady2 quady3)]\n  [ (path \'none\' col1 linwd\n      [ \'M\' quadx1 quady1\n        \'L\' quadx2 quady2 ] )\n    (path \'none\' col1 linwd\n      [ \'M\' quadx2 quady2\n        \'L\' quadx3 quady3 ] )\n    (path \'none\' col2 linwd\n      [ \'M\' midx1 midy1\n        \'L\' midx2 midy2 ] )\n    (path \'none\' \'red\' linwd\n      [ \'M\' quadx1 quady1\n        \'Q\' quadx2 quady2\n            quadx3 quady3 ] )\n    (ptcirc px py)    ] ) ) )\n(def cuCurve\n  (let [midx1 midy1 midx2 midy2 midx3 midy3]\n       [(linbez t cux1 cux2) (linbez t cuy1 cuy2)\n        (linbez t cux2 cux3) (linbez t cuy2 cuy3)\n        (linbez t cux3 cux4) (linbez t cuy3 cuy4)]\n  (let [dubmidx1 dubmidy1 dubmidx2 dubmidy2]\n       [(linbez t midx1 midx2) (linbez t midy1 midy2)\n        (linbez t midx2 midx3) (linbez t midy2 midy3)]\n  (let [px py] [(cubez t cux1 cux2 cux3 cux4) (cubez t cuy1 cuy2 cuy3 cuy4)]\n  [ (path \'none\' col1 linwd\n      [ \'M\' cux1 cuy1\n        \'L\' cux2 cuy2 ] )\n    (path \'none\' col1 linwd\n      [ \'M\' cux2 cuy2\n        \'L\' cux3 cuy3 ] )\n    (path \'none\' col1 linwd\n      [ \'M\' cux3 cuy3\n        \'L\' cux4 cuy4 ] )\n    (path \'none\' col2 linwd\n      [ \'M\' midx1 midy1\n        \'L\' midx2 midy2 ] )\n    (path \'none\' col2 linwd\n      [ \'M\' midx2 midy2\n        \'L\' midx3 midy3 ] )\n    (path \'none\' col3 linwd\n      [ \'M\' dubmidx1 dubmidy1\n        \'L\' dubmidx2 dubmidy2 ] )\n    (path \'none\' \'red\' linwd\n      [ \'M\' cux1 cuy1\n        \'C\' cux2 cuy2\n            cux3 cuy3\n            cux4 cuy4 ] )\n    (ptcirc px py)            ] ) ) ) )\n\n(def quCurve\n  (let [midx1 midy1 midx2 midy2 midx3 midy3 midx4 midy4]\n       [(linbez t qux1 qux2) (linbez t quy1 quy2)\n        (linbez t qux2 qux3) (linbez t quy2 quy3)\n        (linbez t qux3 qux4) (linbez t quy3 quy4)\n        (linbez t qux4 qux5) (linbez t quy4 quy5)]\n  (let [dubmidx1 dubmidy1 dubmidx2 dubmidy2 dubmidx3 dubmidy3]\n       [(linbez t midx1 midx2) (linbez t midy1 midy2)\n        (linbez t midx2 midx3) (linbez t midy2 midy3)\n        (linbez t midx3 midx4) (linbez t midy3 midy4)]\n  (let [trimidx1 trimidy1 trimidx2 trimidy2]\n       [(linbez t dubmidx1 dubmidx2) (linbez dubmidy1 dubmidy2)\n        (linbez t dubmidx2 dubmidx3) (linbez dubmidy2 dubmidy3)]\n  (let [px py] [(quarbez t qux1 qux2 qux3 qux4 qux5) (quarbez t quy1 quy2 quy3 quy4 quy5)]\n  [ (path \'none\' col1 linwd\n      [ \'M\' qux1 quy1\n        \'L\' qux2 quy2 ] )\n    (path \'none\' col1 linwd\n      [ \'M\' qux2 quy2\n        \'L\' qux3 quy3 ] )\n    (path \'none\' col1 linwd\n      [ \'M\' qux3 quy3\n        \'L\' qux4 quy4 ] )\n    (path \'none\' col1 linwd\n      [ \'M\' qux4 quy4\n        \'L\' qux5 quy5 ] )\n    (path \'none\' col2 linwd\n      [ \'M\' midx1 midy1\n        \'L\' midx2 midy2 ] )\n    (path \'none\' col2 linwd\n      [ \'M\' midx2 midy2\n        \'L\' midx3 midy3 ] )\n    (path \'none\' col2 linwd\n      [ \'M\' midx3 midy3\n        \'L\' midx4 midy4 ] )\n    (path \'none\' col3 linwd\n      [ \'M\' dubmidx1 dubmidy1\n        \'L\' dubmidx2 dubmidy2 ] )\n    (path \'none\' col3 linwd\n      [ \'M\' dubmidx2 dubmidy2\n        \'L\' dubmidx3 dubmidy3 ] )\n    (path \'none\' col4 linwd\n      [ \'M\' trimidx1 trimidy1\n        \'L\' trimidx2 trimidy2 ] )\n    (ptcirc px py)            ] ) ) ) ) )\n;\n; Putting it all together\n;\n(svg (concat [linCurve quadCurve cuCurve tslider]))\n';
var _user$project$ExamplesGenerated$poppl = '; Logo for POP-PL\n; see https://github.com/florence/pop-pl\n\n(def m \'M\')\n(def l \'L\')\n(def c \'C\')\n(def z \'Z\')\n\n(def ltopWidth 29!)\n(def ltopHeight 63!)\n(def xstart 131!)\n(def ystart 63!)\n(def stethx 31!)\n(def stethy 7!)\n(def cr2Control -0.1769993052254364)\n(def cr2x (* cr2Control ltopWidth))\n(def cr2y (* cr2Control ltopHeight))\n(def lpath\n  [m (- xstart stethx) (- ystart stethy)\n   c (+ xstart -12) (+ ystart -19)\n     (+ cr2x xstart) (+ cr2y ystart)\n     xstart ystart\n   l (+ xstart ltopWidth) (+ ystart ltopHeight)\n   ])\n\n(def axstart  (+ xstart ltopWidth))\n(def aystart (+ ystart ltopHeight))\n(def ascale 1.9534135150166867!)\n(def ax (* ascale ltopWidth))\n(def ay (* ascale ltopHeight))\n(def bx 18!)\n(def armpath\n  [m axstart aystart\n   c (+ xstart 71) (+ ystart 94)\n     (+ xstart 90) (+ ystart 142)\n     (+ axstart ax) (+ aystart ay)\n   c (+ xstart 63) (+ ystart 190)\n     (+ xstart 74) (+ ystart 188)\n     (- (+ axstart ax) bx) (+ aystart ay)])\n\n(def lwidth 5)\n\n\n(def nub\n  (circle \'black\' (- (+ axstart ax) bx) (+ aystart ay) (* lwidth 2!)))\n\n(def small (* lwidth 2.1))\n(def scope1\n  (circle \'black\' (- xstart stethx) (- ystart stethy) (+ small lwidth)))\n(def scope2\n  (circle \'white\' (- xstart stethx) (- ystart stethy) small))\n\n[\'svg\'\n [[\'viewBox\' \'0 0 300 300\']]\n [(square \'white\' 0! 0! 300!)\n      (path \'none\' \'black\' lwidth lpath)\n      (path \'none\' \'black\' lwidth armpath)\n      nub\n      (addAttr (path \'white\' \'black\' lwidth armpath)\n               [\'transform\' (+ (+ \'matrix(-1 0 0 1 \' (toString (* 2 axstart)))\n                               \' 0)\')])\n      (addAttr nub\n               [\'transform\' (+ (+ \'matrix(-1 0 0 1 \' (toString (* 2 axstart)))\n                               \' 0)\')])\n      scope1\n      scope2\n]]\n\n';
var _user$project$ExamplesGenerated$cover = '; Logo for Cover\n; see https://github.com/florence/cover\n\n(def size 300!)\n(def line 10!)\n(def h (/ size 2.6548672566371683))\n(def w (- (* 2! h) (* 2! line)))\n\n(def m (/ size 2!))\n\n(def x (- m (/ w 2!)))\n(def y (- m (+ (/ line 2!) (/ w 2!))))\n\n(def x2 (- x (+ w line)))\n(def y2 (- x (+ w (* 2.5! line))))\n\n(def x3 (+ x (+ w line)))\n(def y3 (+ x (+ w (* 1.5! line))))\n\n(def top (\\(x y)\n (rect \'red\' x y w (- h line))))\n\n(def sw (- h (* 1.5! line)))\n\n(def bottom (\\(x y)\n  (rect \'blue\' x (+ y h) sw (- h line))))\n\n(def bottoma (\\(x y) (bottom x y)))\n(def bottomb (\\(x y) (bottom (+ sw (+ x line)) y)))\n\n(def rot 45)\n\n[\'svg\'\n [[\'viewBox\' (+ (+ (+ \'0 0 \' (toString size)) \' \') (toString size))]]\n [\n  (square \'white\' 0! 0! size)\n\n  (rotate (top x y)   rot m m)\n  (rotate (bottoma x y) rot m m)\n  (rotate (bottomb x y) rot m m)\n\n  (rotate (top x2 y)   rot m m)\n  (rotate (bottoma x2 y) rot m m)\n  (rotate (bottomb x2 y) rot m m)\n\n  (rotate (top x y2)   rot m m)\n  (rotate (bottoma x y2) rot m m)\n  (rotate (bottomb x y2) rot m m)\n\n  (rotate (top x3 y)   rot m m)\n  (rotate (bottoma x3 y) rot m m)\n  (rotate (bottomb x3 y) rot m m)\n\n  (rotate (top x y3)   rot m m)\n  (rotate (bottoma x y3) rot m m)\n  (rotate (bottomb x y3) rot m m)\n]]\n\n';
var _user$project$ExamplesGenerated$dictionaries = '(def d (empty))\n(def d1 (insert \'a\' 3 d))\n(def d2 (insert \'b\' 4 d1))\n(def d3 (remove \'a\' d2))\n\n(def getWithDefault (\\(key default dict)\n  (let value (get key dict)\n  (typecase value\n    (Null default)\n    (_ value)))\n))\n\n(blobs [\n    [(text 50 30  (toString d2))]\n    [(text 50 50  (toString d3))]\n    [(text 50 70  (toString (get \'b\' d3)))]\n    [(text 50 90  (toString (get \'a\' d3)))]\n    [(text 50 110 (toString (getWithDefault \'a\' \'default\' d3)))]\n])\n\n';
var _user$project$ExamplesGenerated$thawFreeze = '\n# unannotated-numbers: n!\n\n; Set [unannotated-numbers] to [n?] or [n!] to declare that\n; unannotated literals be thawed or frozen, respectively.\n;\n; By default, this option is set to [n?].\n\n(svg [(rect \'maroon\' 100? 15 200! 50)])\n\n';
var _user$project$ExamplesGenerated$barGraph = '; A Bar Graph\n;\n; Try:\n;   - Manipulating the height of the bars\n;   - Manipulating the spacing between the bars\n;   - Changing the X Offset with the bottom slider\n;   - Adding and removing data points\n;   - Changing the captions\n;\n; When you\'re done editing, change the doneEditing variable to true to\n; get an SVG that\'s ready to be embedded in a web page!\n(def doneEditing false)\n\n; Each data point specifies a single bar as [XValue YValue]\n(def data [[1! 5!] [2! 1!] [3! 3!] [4! 2!] [5! 4!] [7! 3!]])\n\n; Relevant variables\n(def [title xcaption ycaption] [\'Bar Graph\' \'X Axis\' \'Y Axis\'])\n(def [totht totwd barspacing numy] [250! 450! 60 5])\n(def [barwd axiswd] [50 4])\n(def [barcol axiscol] [\'lightblue\' \'gray\'])\n\n(def [xbegin windowslider] (hSlider true 100! 500! 500! 0! 10! \'X Offset: \' 0))\n\n; If you would like to specify the X Offset without the slider, uncomment\n; the below line and set it appropriately.\n;(def xbegin 0)\n\n(def [lowerx upperx] [xbegin (+ xbegin (/ totwd barspacing))])\n(def [x0 y0] [100! 100!])\n\n(def [textht textwd] [18! 4!])\n\n(def bar (\\[val freq] (if (< val upperx) (if (< lowerx val)\n                [(rect barcol (+ x0 (- (* barspacing (- val xbegin)) (* 0.5! barwd)))\n                                    (+ y0 (- totht (* freq (/ totht numy))))\n                                    barwd\n                                    (* freq (/ totht numy)) )] []) []) ) )\n\n(def xaxis (line axiscol axiswd (- x0 (* 0.5! axiswd))\n                                (+ y0 totht)\n                                (+ x0 totwd)\n                                (+ y0 totht) ) )\n\n(def yaxis (line axiscol axiswd x0 (- y0 (* 0.5! (/ totht numy)))\n                                x0 (+ y0 totht) ) )\n\n(def labelx (\\val (text (+ x0 (- (* barspacing (- val xbegin)) textwd))\n                        (+ y0 (+ (* 1.5! textht) totht))\n                        (toString val) ) ) )\n\n(def labely (\\freq (text (- x0 20!)\n                         (+ y0 (+ (* 0.5! textht) (- totht (* freq (/ totht numy)))))\n                         (toString freq) ) ) )\n\n(def titlelabel (text (+ x0 (/ totwd 2!))\n                      (- y0 (/ totht numy))\n                      title) )\n\n(def xlabel (text (+ x0 (/ totwd 2!))\n                  (+ y0 (+ (* 3! textht) totht))\n                  xcaption) )\n(def ylabel (text (- x0 80!) (+ y0 (/ totht 2!)) ycaption) )\n\n(def xs (range lowerx (- upperx 1!)))\n(def ys (range 0! numy))\n\n(def bars (concat (map bar data)))\n(def axes [xaxis yaxis])\n(def xlabels (map labelx xs))\n(def ylabels (map labely ys))\n(def names [titlelabel xlabel ylabel])\n\n(if doneEditing (svgViewBox (+ (* 2! x0) totwd) (+ y0 (+ (* 3! textht) totht)) (concat [bars axes xlabels ylabels names]))\n                (svg (concat [bars axes xlabels ylabels names windowslider])) )\n';
var _user$project$ExamplesGenerated$interfaceButtons = '(def [w h depth shadow r] [120 22.5 4 0.5 2])\n(def shadowcol [180 180 180 1])\n\n(def draw (\\(topcolor botcolor offset)\n\n  (let tbbox  (rect topcolor r offset (- w (* 2! r)) h)\n  (let lrbox  (rect topcolor 0! (+ r offset) w (- h (* 2! r)))\n  (let tlcirc (circle topcolor r (+ r offset) r)\n  (let trcirc (circle topcolor (- w r) (+ r offset) r)\n  (let blcirc (circle topcolor r (+ (- h r) offset) r)\n  (let brcirc (circle topcolor (- w r) (+ (- h r) offset) r)\n\n  (let btbbox  (rect botcolor r (- h r) (- w (* 2! r)) depth)\n  (let blrbox  (rect botcolor 0! (- h r) w (- depth r))\n  (let belcirc (circle botcolor r (- (+ h depth) (* 2! r)) r)\n  (let bercirc (circle botcolor (- w r) (- (+ h depth) (* 2! r)) r)\n\n  (let stbbox  (rect shadowcol r (+ shadow (- h r)) (- w (* 2! r)) depth)\n  (let slrbox  (rect shadowcol 0! (+ shadow (- h r)) w (- depth r))\n  (let selcirc (circle shadowcol r (+ shadow (- (+ h depth) (* 2! r))) r)\n  (let sercirc (circle shadowcol (- w r) (+ shadow (- (+ h depth) (* 2! r))) r)\n\n  (let btop    [tbbox lrbox tlcirc trcirc blcirc brcirc]\n  (let bbot    [btbbox blrbox belcirc bercirc]\n  (let bshadow (if (= offset 0) [stbbox slrbox selcirc sercirc] [])\n\n    ; NOTE: not calling (addAttr ... [\'preserveAspectRatio\' \'none\'])\n    (svgViewBox 120\n      (+ depth (+ shadow (- h r)))\n      (concat [bshadow bbot btop]))\n\n)))))))))))))))))))\n\n(def hilitedBot [198 77 64 1])\n\n(def raisedButton      (draw [231 76 60 1] [192 57 43 1] 0))\n(def highlightedButton (draw [233 94 80 1] hilitedBot 0))\n(def depressedButton   (draw [233 94 80 1] hilitedBot 1.1))\n(def disabledButton    (draw [236 112 99 1] [205 97 85 1] 0))\n\n(def raisedButton2      raisedButton)\n(def highlightedButton2 highlightedButton)\n(def depressedButton2   depressedButton)\n(def disabledButton2    disabledButton)\n\n(def raisedButton3      (draw \'gray\' hilitedBot 0))\n(def highlightedButton3 (draw \'lightgray\' hilitedBot 0))\n(def depressedButton3   (draw \'lightgray\' hilitedBot 1.1))\n(def disabledButton3    (draw 470 360 0))\n\n(def kind 1{1-3})\n(def state 1{1-4})\n\n(if (= kind 1)\n  (if (= state 1) raisedButton\n  (if (= state 2) highlightedButton\n  (if (= state 3) depressedButton\n    disabledButton)))\n(if (= kind 2)\n  (if (= state 1) raisedButton2\n  (if (= state 2) highlightedButton2\n  (if (= state 3) depressedButton2\n    disabledButton2)))\n; else\n  (if (= state 1) raisedButton3\n  (if (= state 2) highlightedButton3\n  (if (= state 3) depressedButton3\n    disabledButton3)))\n))\n\n';
var _user$project$ExamplesGenerated$rotTest = '\n(def [x y w h] [257 54 152 261])\n(def rot 38.166250526006905)\n(def colorNum 100)\n\n(def [x_ y_] [(+ x (/ w 2)) (+ y (/ h 2))])\n\n; thin wrapper v1\n(def transform\n  (spaces\n     [\'translate\' (parens (spaces [(toString x_) (toString y_)]))\n      \'rotate\'    (parens (toString rot))\n      \'translate\' (parens (spaces [(toString (neg x_)) (toString (neg y_))]))\n   ]))\n\n; thin wrapper v2\n(def transform2\n  (+ \'rotate\' (parens (spaces [(toString rot) (toString x_) (toString y_)]))))\n\n; specific transform encoding\n(def transform3 [[\'rotate\' rot x_ y_]])\n\n(def r (rotate (rect colorNum x y w h) rot x_ y_))\n\n(def e (rotate (ellipse 240 x_ y_ 10 20) -10 x_ y_))\n\n(svg [r e])\n\n';
var _user$project$ExamplesGenerated$matrices = '; Definitions for 2D matrices and transform application\n;\n; Similar to the SVG transform operation\n; See https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/transform\n;\n(def [theta tx ty m s] [(/ 3.14159! 4) 75 75 1.25 2])\n(defrec rmult_ (\\(r v) (case [r v]\n  ([ [] x ] 0)\n  ([ x [] ] 0)\n  ([ [a | aa] [b | bb] ] (+ (* a b) (rmult_ aa bb))))))\n(defrec mmult (\\(m v) (case m\n  ([] [])\n  ([r|rest] (if (= (len r) (len v)) (cons (rmult_ r v) (mmult rest v)) [])))))\n(defrec toPts (\\l (case l\n  ([] [])\n  ([ [x y k] | rest ] (cons [x y] (toPts rest))))))\n(defrec toPath_ (\\l (case l\n  ([] [])\n  ([ [x y] | rest ] (append [ \'L\' x y ] (toPath_ rest))))))\n(def toPath (\\l (case l\n  ([] [])\n  ([ [x1 y1] | rest ] (path \'lightblue\' \'gray\' 1 (append [ \'M\' x1 y1 | (toPath_ rest)] [\'Z\']))))))\n(def id [ [1! 0! 0!] [0! 1! 0!] [0! 0! 1!] ])\n(def translatert (map (mmult [ [1! 0! tx] [0! 1! 0!] [0! 0! 1!]])))\n(def translatedn (map (mmult [ [1! 0! 0!] [0! 1! ty] [0! 0! 1!]])))\n(def rotate (map (mmult [ [(cos theta) (* -1! (sin theta)) 0!] [(sin theta) (cos theta) 0!] [0! 0! 1!]])))\n(def shear (map (mmult [ [1! m 0!] [0! 1! 0!] [0! 0! 1!]])))\n(def scale (map (mmult [ [s 0! 0!] [0! s 0!] [0! 0! 1!] ])))\n(def ps [ [-25! -25! 1!] [-25! 25! 1!] [25! 25! 1!] [25! -25! 1!] ])\n(def square1 (toPath (toPts (translatedn (translatert ps)))))\n(def square2 (toPath (toPts (translatedn (translatert (translatert ps))))))\n(def rotsquare (toPath (toPts (translatert (translatert (translatert (translatedn (rotate ps))))))))\n(def shearsquare (toPath (toPts (translatert (translatert (translatert (translatert (translatedn (shear ps)))))))))\n(def scalesquare (toPath (toPts (translatert (translatert (translatert (translatert (translatert (translatert (translatedn (scale ps)))))))))))\n(svg [square1 square2 rotsquare shearsquare scalesquare])\n';
var _user$project$ExamplesGenerated$haskell = '; Haskell.org Logo\n; SVG version of https://www.haskell.org/static/img/logo.png?etag=rJR84DMh\n;\n; Try making a slider for the bend amount to adjust that parameter indirectly.\n;\n(def [wedgeWidth lambdaWidth equalsWidth] [120 120 90])\n(def [wedgePos lambdaPos equalsPos] [0! 170 440])\n(def [totalHeight totalWidth] [512! 752!])\n(def bend (/ 3.14159! 5.3))\n(def equalsSep 40)\n(def [wedgeColor lambdaColor equalsColor] \n        [[69 58 98 100]\n         [97 82 138 100]\n         [143 78 139 100]])\n(def tan (\\theta (/ (sin theta) (cos theta))))\n(def leftWedge (path wedgeColor \'black\' 0\n    [ \'M\' wedgePos 0!\n      \'L\' (+ wedgePos (* (/ totalHeight 2!) (tan bend))) (/ totalHeight 2!)\n      \'L\' wedgePos totalHeight\n      \'L\' (+ wedgePos wedgeWidth) totalHeight\n      \'L\' (+ wedgePos (+ wedgeWidth (* (/ totalHeight 2!) (tan bend))))\n          (/ totalHeight 2!)\n      \'L\' (+ wedgeWidth wedgePos) 0!\n      \'Z\']))\n(def lambda (path lambdaColor \'black\' 0\n    [ \'M\' lambdaPos \n          0!\n      \'L\' (+ lambdaPos (* (/ totalHeight 2!) (tan bend))) \n          (/ totalHeight 2!)\n      \'L\' lambdaPos \n          totalHeight\n      \'L\' (+ lambdaPos lambdaWidth) \n          totalHeight\n      \'L\' (+ (+ lambdaPos (* (/ totalHeight 2!) (tan bend))) (/ lambdaWidth 2!)) \n          (+ (/ totalHeight 2!) (/ lambdaWidth (* 2! (tan bend))))\n      \'L\' (+ lambdaPos (* totalHeight (tan bend)))\n          totalHeight\n      \'L\' (+ lambdaPos (+ lambdaWidth (* totalHeight (tan bend))))\n          totalHeight\n      \'L\' (+ lambdaPos lambdaWidth)\n          0!\n      \'Z\']))\n(def equals \n  [ (path equalsColor \'black\' 0\n      [ \'M\' equalsPos\n            (- (- (/ totalHeight 2!) (* equalsSep 0.25!)) (* equalsWidth (cos bend)))\n        \'L\' totalWidth\n            (- (- (/ totalHeight 2!) (* equalsSep 0.25!)) (* equalsWidth (cos bend)))\n        \'L\' totalWidth\n            (- (/ totalHeight 2!) (* equalsSep 0.25!))\n        \'L\' (+ equalsPos (* equalsWidth (sin bend)))\n            (- (/ totalHeight 2!) (* equalsSep 0.25!))\n        \'Z\'])\n    (path equalsColor \'black\' 0\n      [ \'M\' (+ equalsPos (+ (* equalsWidth (sin bend)) (* equalsSep (tan bend))))\n            (+ (/ totalHeight 2!) (* equalsSep 0.75!))\n        \'L\' totalWidth\n            (+ (/ totalHeight 2!) (* equalsSep 0.75!))\n        \'L\' totalWidth\n            (+ (+ (/ totalHeight 2!) (* equalsSep 0.75!)) (* equalsWidth (cos bend)))\n        \'L\' (+ equalsPos (+ (* 2! (* equalsWidth (sin bend))) (* equalsSep (tan bend))))\n            (+ (+ (/ totalHeight 2!) (* equalsSep 0.75!)) (* equalsWidth (cos bend)))\n        \'Z\'])])\n(svg (append [leftWedge lambda] equals))\n';
var _user$project$ExamplesGenerated$wikimedia = '; Wikimedia Logo\n; Recreation of https://upload.wikimedia.org/wikipedia/commons/8/81/Wikimedia-logo.svg\n \n; The white objects are an example of using masks as opposed to paths to create\n; more complicated forms, such as the green \'wings\' and broken ring of this logo.\n \n(def [greenr innerBluer outerBluer] [110! 134! 180!])\n(def [wedgeTheta barWidth barHeight] [(/ 3.14159! 4!) 32 150])\n(def [dotRed wingGreen ringBlue] [\'#900\' \'#396\' \'#069\'])\n(def [centerx centery] [256! 256!])\n(def greenCirc (circle wingGreen centerx centery greenr))\n(def whiteRing (circle \'white\' centerx centery innerBluer))\n(def blueCirc (circle ringBlue centerx centery outerBluer))\n(def rightPtx (+ centerx (* outerBluer (sin wedgeTheta))))\n(def leftPtx (- centery (* outerBluer (sin wedgeTheta))))\n(def pty (- (- centery 16) (* outerBluer (cos wedgeTheta))))\n(def whiteWedge \n    (path \'white\' \'black\' 0 \n        [ \'M\' centerx (- centery 16)\n          \'L\' rightPtx pty\n          \'A\' outerBluer outerBluer 0 0 0 leftPtx pty\n          \'Z\']))\n(def whiteBar (rect \'white\' (- centerx (/ barWidth 2!)) (- centery 32!) barWidth barHeight))\n(def redDot (circle \'#900\' centerx 128! 64!))\n\n(svg [blueCirc whiteRing greenCirc whiteWedge whiteBar redDot])\n\n';
var _user$project$ExamplesGenerated$eyeIcon = '; An eye icon\n; Recreation of https://commons.wikimedia.org/wiki/Category:SVG_eye_icons#/media/File:Eye_open_font_awesome.svg\n;\n; Try unfreezing:\n;   glintr, and manipulating the glint control points\n;   cornear, and manipulating the cornea radius\n;   glintWidth, and manipulating the glint control points\n;   Any of the outer/inner parameters, and seeing what happens!\n;\n(def [outerStartx outerStarty innerStartx innerStarty] [16! 240! 50 256!])\n(def [outerWidth innerWidth outerHeight innerHeight sharpness] [480 412 -60 0 16])\n(def [corneax corneay cornear glintr glintWidth] [256! 216! 120! 50! 24])\n(def midline 256!)\n(def outerBorder\n  (path\n    \'black\'\n    \'black\'\n    0\n    [\'M\' outerStartx outerStarty\n     \'Q\' midline outerHeight (+ outerStartx outerWidth) outerStarty\n     \'Q\' (+ (+ outerStartx outerWidth) sharpness) 256! (+ outerStartx outerWidth) (+ outerStarty 32!)\n     \'Q\' midline (- 512! outerHeight) outerStartx (+ outerStarty 32!)\n     \'Q\' (- outerStartx sharpness) 256! outerStartx outerStarty\n     \'Z\']))\n(def innerBorder\n  (path\n    \'white\'\n    \'black\'\n    0\n    [\'M\' innerStartx innerStarty\n     \'Q\' midline innerHeight (+ innerStartx innerWidth) innerStarty\n     \'Q\' midline (- 512! innerHeight) innerStartx innerStarty\n     \'Z\']))\n(def cornea (circle \'black\' corneax corneay cornear))\n(def glint\n  (path\n    \'white\'\n    \'black\'\n    0\n    [\'M\' corneax (- corneay (+ glintr glintWidth))\n     \'A\' (/ glintWidth 2!) (/ glintWidth 2!) 0 0 1 corneax (- corneay glintr)\n     \'A\' glintr glintr 0 0 0 (- corneax glintr) corneay\n     \'A\' (/ glintWidth 2!) (/ glintWidth 2!) 0 0 1 (- corneax (+ glintr glintWidth)) corneay\n     \'A\' (+ glintr glintWidth) (+ glintr glintWidth) 0 0 1 corneax (- corneay (+ glintr glintWidth))\n     \'Z\']))\n(svg  [outerBorder innerBorder cornea glint])\n\n';
var _user$project$ExamplesGenerated$sailBoat = '; A sail boat on the ocean\n;\n; Try mainupulating:\n;   - The position of the boat by dragging the sail\n;   - The height of the waves by moving the path control points with zones on\n;   - The frequency of the waves\n;   - The sea level\n\n(def [sealevel amplitude period boatpos] [300 40 200 400])\n(def [oceancolor backgroundcolor] [[28 107 160 50] [135 206 250 100]])\n\n(def wave (\\([sx sy] [ex ey] amplitude)\n            [ (path oceancolor \'black\' 0 \n                [ \'M\' sx sy \n                  \'Q\' (+ sx (/ period 4!)) (- sy amplitude) \n                  (+ sx (/ period 2!)) sy\n                  \'Z\'])\n              (path backgroundcolor \'black\' 0\n                  [ \'M\' (+ sx (/ period 2!)) sy\n                    \'Q\' (+ sx (* period 0.75!)) (+ sy amplitude)\n                    ex ey \n                    \'Z\' ])]))\n\n(def nodes\n  (map2 (\\(a b) [(* a period) b])\n        (range 0! (round (/ 3000 period)))\n        (repeat (round (/ 4000 period)) sealevel)))\n\n(defrec mkwaves \n  (\\l (case l \n    ([] [])\n    ([x] [])\n    ([a b | rest] (append (wave a b amplitude) (mkwaves [ b | rest ]))))))\n\n(def backdrop (rect backgroundcolor -400! -400! 2400! 2400!))\n(def sun (circle \'yellow\' 50 0 70))\n(def deepwater (rect oceancolor -400! sealevel 2400! 4000!))\n(def quadraticbezier (\\(s c e t) (+ (+ \n    (* (* (- 1 t) (- 1 t)) s) \n    (* (* (* 2 (- 1 t)) t) c)) \n    (* (* t t) e))))\n\n(def tphase (/ (mod boatpos (/ period 2)) (/ period 2)))\n(def pickdir (\\(sl amp) (if \n    (< (mod boatpos period) (/ period 2))\n      (- sl amp) \n      (+ sl amp))))\n\n(def boat\n  (let boaty (quadraticbezier sealevel (pickdir sealevel amplitude) sealevel tphase)\n  (let hull (path \'saddlebrown\' \'black\' 0\n    [ \'M\' (- boatpos 30) (- boaty 10)\n      \'C\' (- boatpos 30) (+ boaty 15)\n      (+ boatpos 30) (+ boaty 15)\n      (+ boatpos 30) (- boaty 10)\n      \'Z\'])\n  (let mast (rect \'saddlebrown\' (+ boatpos 10) (- boaty 60) 5 50)\n  (let sail (rect \'beige\' (- boatpos 15!) (- boaty 50!) 50 30)\n  [mast hull sail])))))\n\n(svg \n  (concat [\n    [ backdrop sun deepwater ]\n    (mkwaves nodes)\n    boat]))\n\n';
var _user$project$ExamplesGenerated$paths5 = '; Adapted from:\n; https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths\n;\n(svg [\n  (path \'green\' \'black\' 2\n    [\'M\' 80 80 \'A\' 45 45 0 0 0 125 125 \'L\' 125 80 \'Z\'])\n  (path \'red\' \'black\' 2\n    [\'M\' 230 80 \'A\' 45 45 0 1 0 275 125 \'L\' 275 80 \'Z\'])\n  (path \'purple\' \'black\' 2\n    [\'M\' 80 230 \'A\' 45 45 0 0 1 125 275 \'L\' 125 230 \'Z\'])\n  (path \'blue\' \'black\' 2\n    [\'M\' 230 230 \'A\' 45 45 0 1 1 275 275 \'L\' 275 230 \'Z\'])\n])\n\n';
var _user$project$ExamplesGenerated$paths4 = '; Adapted from:\n; https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths\n;\n(svg [\n  (addAttr\n    (path \'green\' \'black\' 2\n      [\'M\' 10 315\n       \'L\' 110 215\n       \'A\' 30 50 0 0 1 162.55 162.45\n       \'L\' 172.55 152.45\n       \'A\' 30 50 -45 0 1 215.1 109.9\n       \'L\' 315 10])\n    [\'opacity\' 0.5])\n])\n\n';
var _user$project$ExamplesGenerated$paths3 = '(svg [\n  (path_ [\'M\' 10 80 \'C\' 40 10 65 10 95 80 \'S\' 150 150 180 80])\n  (path_ [\'M\' 10 80 \'Q\' 95 10 180 80])\n  (path_ [\'M\' 10 80 \'Q\' 52.5 10 95 80 \'T\' 180 80])\n])\n\n';
var _user$project$ExamplesGenerated$paths2 = '; Adapted from:\n; https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths\n;\n; Turn on the zones to see the Bezier control points.\n; Try replacing \"svg\" with \"svgViewBox 200 200\".\n;\n(svg [\n  (path_ [\'M\' 10 10   \'C\' 20 20 40 20 50 10])\n  (path_ [\'M\' 70 10   \'C\' 70 20 120 20 120 10])\n  (path_ [\'M\' 130 10  \'C\' 120 20 180 20 170 10])\n  (path_ [\'M\' 10 60   \'C\' 20 80 40 80 50 60])\n  (path_ [\'M\' 70 60   \'C\' 70 80 110 80 110 60])\n  (path_ [\'M\' 130 60  \'C\' 120 80 180 80 170 60])\n  (path_ [\'M\' 10 110  \'C\' 20 140 40 140 50 110])\n  (path_ [\'M\' 70 110  \'C\' 70 140 110 140 110 110])\n  (path_ [\'M\' 130 110 \'C\' 120 140 180 140 170 110])\n])\n\n';
var _user$project$ExamplesGenerated$paths1 = '(svg [\n  (path_ [\'M\' 10 10 \'H\' 90 \'V\' 90 \'H\' 10 \'L\' 10 10 \'Z\'])\n  (path_ [\'M\' 20 20 \'L\' 60 20 \'L\' 60 80 \'Z\'])\n  (path_ [\'M\' 150 0 \'L\' 75 200 \'L\' 225 200 \'Z\'])\n])\n\n';
var _user$project$ExamplesGenerated$miscShapes = '(let [x y] [200 150] (svg [\n  (rect \'#999999\'  50 10 80 130)\n  (circle \'lightblue\' 300 100 50)\n  (ellipse \'orange\' 40 280 30 50)\n  (polygon \'lightgreen\' \'black\' 5 [[110 110] [300 110] [x y]])\n  (polygon \'lightgreen\' \'black\' 5 [[110 210] [300 210] [x y]])\n  (line \'blue\' 4 10 20 300 40)\n]))\n\n';
var _user$project$ExamplesGenerated$clique = ';\n; A six node clique\n;\n(let node (\\[x y] (circle \'lightblue\' x y 20))\n(let edge (\\[[x y] [i j]] (line \'lightgreen\' 5 x y i j))\n(letrec genpairs\n   (\\xs\n     (case xs\n       ([x y | xx] [[x y] | (append (genpairs (cons x xx)) (genpairs (cons y xx)))])\n       ([x] [])\n       ([] [])))\n(let pts [[200 50] [400 50] [100 223] [200 389] [400 391] [500 223]]\n(let nodes (map node pts)\n(let pairs (genpairs  pts)\n(let edges (map edge pairs)\n  (svg (append edges nodes)))))))))\n\n';
var _user$project$ExamplesGenerated$stickFigures = ';\n; A diagram of a sketch-n-sketch demo w/ audience\n;\n(let [x0 y0 w h] [60 -22 417! 915!]\n(let wstripe (/ w 6!)\n(let xoff (+ x0 wstripe)\n(let yoff (+ y0 (/ h 4!))\n(let minrad (if (< (/ wstripe 7.5!) (/ h 30!)) (/ wstripe 7.5!) (/ h 15!))\n(let min (if (< w h) (* 0.6! w) (* 0.6! h))\n(let figure\n  (\\(x y)\n    (let [x1 x2 x3] (map (\\n (+ x (* wstripe n))) [1.2! 1.5! 1.8!])\n    (let [y1 yh y2 y3 y4] (map (\\n (+ y (/ (/ h 2!) n))) [4.3! 2.2! 2.8! 1.9! 1.4!])\n    (let figline (\\[[a b] [c d]] (line \'black\' (/ minrad 2!) a b c d))\n      (snoc\n        (circle \'black\' x2 y1 (/ wstripe 3.75!))\n        (map\n          figline\n          [[[x1 yh] [x1 y2]]\n           [[x1 y2] [x3 y2]]\n           [[x3 yh] [x3 y2]]\n           [[x1 y4] [x1 y3]]\n           [[x1 y3] [x3 y3]]\n           [[x3 y3] [x3 y4]]\n           [[x2 y1] [x2 y3]]]))))))\n(let logo\n  (\\(x y)\n    (let [xl yl wl hl delta] [x y 90 90 6.5]\n    (let [xw yh w2 h2] [(+ xl wl) (+ yl hl) (div wl 2) (div hl 2)]\n    (let poly (\\pts (polygon \'black\' \'none\' 0 pts))\n      [(rect \'white\' xl yl wl hl)\n       (poly  [[(+ xl delta) yl] [xw yl] [xw (- yh delta)]])\n       (poly  [[xl (+ yl delta)] [xl (- yh delta)] [(- (+ xl w2) delta) (+ yl h2)]])\n       (poly  [[(+ xl delta) yh] [(- xw delta) yh] [(+ xl w2) (+ (+ yl h2) delta)]])]))))\n  ;\n  (let textBoxes\n    [ (addAttr (text 160 160 \'Laptop on Table\') [\'font-size\' 40])\n      (addAttr (text 30 600 \'Demonstrators\') [\'font-size\' 40])\n      (addAttr (text 550 660 \'Audience\') [\'font-size\' 40])\n    ]\n  ;\n  (svg (append textBoxes\n    (append\n      [(polygon\n        \'#CD7F32\'\n        \'none\'\n        0\n        [[508 511]\n         [497 347]\n         [200 354]\n         [188 512]\n         [171 334]\n         [133 287]\n         [133 435]\n         [110 257]\n         [443 250]\n         [520 324]])\n       (polygon \'none\' \'black\' 4 [[106 256] [445 251] [524 325] [183 334]])\n       (rect \'gray\' 230! 184! 103 102)\n       (polygon \'gray\' \'black\' 2 [[250 295] [357 294] [393 312] [282 312]])]\n      (append\n        (logo 238 190)\n        (concatMap\n          (\\[x y] (figure (+ x0 x) (+ y0 y)))\n          [[-24 245] [-96 140] [325 321] [405 184] [474 298]]))))))))))))))\n\n';
var _user$project$ExamplesGenerated$hilbertCurveAnimation = '; How to draw a Hilbert curve.\n;\n; https://thoughtstreams.io/jtauber/on-drawing-owls-and-teaching-non-beginners/\n; 1. Draw a U.\n; 2. Draw the rest of the curve.\n;\n\n; What fraction of the final curve should we draw?\n; Time 0 to 0.5: none. Draw curve from time 0.5 to 1.\n(def curveFractionToDraw (\\time\n  (if (gt time 0.5)\n    (- (* time 2.0) 1.0)\n    0\n  )\n))\n\n; For when all the Hilbert levels but the most detailed fade out together.\n(def earlierLevelOpacity (\\time\n  (pow (- 1.0 (curveFractionToDraw time)) 2)\n))\n\n; The basic U.\n;\n; We can\'t center this around 0,0 because of some weird clipping with the view box.\n(def hilbertPart_ [\n  (path \'none\' \'green\' 0.4 [ \'M\' 10 10 \'L\' 10 20 \'L\' 20 20 \'L\' 20 10 ])\n  (circle \'red\' 10 10 1)\n])\n\n; We use SVG transforms to position, rotate, and size the U.\n(def hilbertPart (\\(centerX centerY width rotation orientation opacity)\n  [\n    \'g\'\n    [\n      [\'transform\' [[\'translate\' centerX centerY] [\'rotate\' rotation 0 0] [\'scale\' (/ width 20) (/ width 20)] [\'scale\' orientation 1] [\'translate\' -15 -15]]]\n      [\'opacity\' opacity]\n    ]\n    hilbertPart_\n  ]\n))\n\n; Add 90 degrees.\n(def rotateAngleRight (\\a\n  (if (= a 0)\n    90\n    (if (= a 90)\n      180\n      (if (= a 180)\n        -90\n        (if (= a -90)\n          0\n          \'error\'\n        )\n      )\n    )\n  )\n))\n\n; Angle 0 is straight up, so basically -angle.\n(def flipAngleVertical (\\a\n  (if (or (= a 0) (= a 180))\n    a\n    (- 0 a)\n  )\n))\n\n; Rotates by 90 degrees around 0,0\n(def rotatePointRight (\\[x y]\n  (if (and (lt 0 x) (lt 0 y))\n    [(- 0 x) y]\n    (if (and (gt 0 x) (lt 0 y))\n      [x (- 0 y)]\n      (if (and (gt 0 x) (gt 0 y))\n        [(- 0 x) y]\n        (if (and (lt 0 x) (gt 0 y))\n          [x (- 0 y)]\n          \'error\'\n        )\n      )\n    )\n  )\n))\n\n; Want to always rotate the short way around the circle.\n(defrec circularDisplacement (\\(a b)\n  (let diff (- b a)\n    (if (gt diff 180)\n      (circularDisplacement a (- b 360))\n      (if (le diff -180)\n        (circularDisplacement a (+ b 360))\n        diff\n      )\n    )\n  )\n))\n\n; Clamp angle to (-180, 180]\n(def normalizeRotation (\\angle\n  (circularDisplacement 0 angle)\n))\n\n(def rotateChildrenRight (\\[\n    [ x1 y1 rot1 or1 ]\n    [ x2 y2 rot2 or2 ]\n    [ x3 y3 rot3 or3 ]\n    [ x4 y4 rot4 or4 ]\n  ]\n  [\n    (append (rotatePointRight [x1 y1]) [(rotateAngleRight rot1) or1])\n    (append (rotatePointRight [x2 y2]) [(rotateAngleRight rot2) or2])\n    (append (rotatePointRight [x3 y3]) [(rotateAngleRight rot3) or3])\n    (append (rotatePointRight [x4 y4]) [(rotateAngleRight rot4) or4])\n  ]\n))\n\n(def flipChildrenVertical (\\[\n    [ x1 y1 rot1 or1 ]\n    [ x2 y2 rot2 or2 ]\n    [ x3 y3 rot3 or3 ]\n    [ x4 y4 rot4 or4 ]\n  ]\n  [\n    [ (- 0 x1) y1 (flipAngleVertical rot1) (- 0 or1) ]\n    [ (- 0 x2) y2 (flipAngleVertical rot2) (- 0 or2) ]\n    [ (- 0 x3) y3 (flipAngleVertical rot3) (- 0 or3) ]\n    [ (- 0 x4) y4 (flipAngleVertical rot4) (- 0 or4) ]\n  ]\n))\n\n; Returns [ [relX relY rotation orientation] ... ]\n(def hilbertChildParams (\\(rotation orientation)\n  (let initial [\n      [-1 -1  -90 -1]\n      [-1  1    0  1]\n      [1   1    0  1]\n      [1  -1   90 -1]\n    ]\n  (let oriented (if (= orientation 1) initial (flipChildrenVertical initial))\n    (if (= rotation 0)\n      oriented\n      (if (= rotation 90)\n        (rotateChildrenRight oriented)\n        (if (= rotation 180)\n          (rotateChildrenRight (rotateChildrenRight oriented))\n          (rotateChildrenRight (rotateChildrenRight (rotateChildrenRight oriented)))\n        )\n      )\n    )\n  ))\n))\n\n; Recursively draw the U\'s with the proper animation and opacity.\n(defrec hilbertParts (\\(time depth levelPartCount partNumber opacity centerX centerY width rotation orientation)\n  (let thisLevel (hilbertPart centerX centerY width rotation orientation (* (pow 0.5 depth) opacity))\n    (if (le depth 0)\n      (if (gt opacity 0.005)\n        [thisLevel]\n        []\n      )\n      (append\n        (concat (map2\n          (\\(i [relX relY rot or])\n            (let [targetX targetY targetWidth targetRot targetOr]\n              [\n                (+ centerX (* relX (/ width 4)))\n                (+ centerY (* relY (/ width 4)))\n                (/ width 2)\n                (+ rotation (circularDisplacement rotation rot))\n                or\n              ]\n            (let thisLevelPartCount (* levelPartCount 4)\n            (let thisPartNumber (+ (* partNumber 4) i)\n            (let animationFraction\n              (if (le depth 1)\n                (let partAndFraction (* (* time 2) thisLevelPartCount)\n                  (if (le partAndFraction thisPartNumber)\n                    0\n                    (if (ge partAndFraction (+ thisPartNumber 1))\n                      1\n                      (- partAndFraction thisPartNumber)\n                    )\n                  )\n                )\n                1\n              )\n            (let [movementFraction orientationFraction]\n              (if (= orientation targetOr)\n                [animationFraction 1]\n                (if (lt animationFraction 0.5)\n                  [(* animationFraction 2) 0]\n                  [1 (- (* animationFraction 2) 1)]\n                )\n              )\n            (let [aniX aniY aniWidth aniRot aniOr] [\n                (+ (* centerX     (- 1 movementFraction   )) (* targetX     movementFraction))\n                (+ (* centerY     (- 1 movementFraction   )) (* targetY     movementFraction))\n                (+ (* width       (- 1 movementFraction   )) (* targetWidth movementFraction))\n                (+ (* rotation    (- 1 movementFraction   )) (* targetRot   movementFraction))\n                (+ (* orientation (- 1 orientationFraction)) (* targetOr    orientationFraction))\n              ]\n            (let opacity\n              (if (gt (curveFractionToDraw time) 0.0)\n                (if (le depth 1)\n                  (let partAndFraction (* (curveFractionToDraw time) thisLevelPartCount)\n                    (if (le partAndFraction thisPartNumber)\n                      1\n                      (if (ge partAndFraction (+ thisPartNumber 1))\n                        0\n                        (- 1 (- partAndFraction thisPartNumber))\n                      )\n                    )\n                  )\n                  (earlierLevelOpacity time)\n                )\n                1\n              )\n              (if (gt animationFraction 0)\n                (hilbertParts time (- depth 1) thisLevelPartCount thisPartNumber opacity aniX aniY aniWidth aniRot aniOr)\n                []\n              )\n            )))))))\n          )\n          (range 0 3)\n          (hilbertChildParams (normalizeRotation rotation) orientation)\n        ))\n        [thisLevel]\n      )\n    )\n  )\n))\n\n; Four points in a block.\n(def hilbertPoints_ (\\(centerX centerY width rotation orientation)\n  (let quarterWidth (/ width 4)\n    (map\n      (\\[relX relY _ _]\n        [(+ centerX (* relX quarterWidth)) (+ centerY (* relY quarterWidth))]\n      )\n      (hilbertChildParams rotation orientation)\n    )\n  )\n))\n\n; List of points on the curve in order. [ [100 100] [150 100] ... ]\n(defrec hilbertPoints (\\(depth centerX centerY width rotation orientation)\n  (let thisLevel (hilbertPoints_ centerX centerY width rotation orientation)\n    (if (le depth 0)\n      thisLevel\n      (concatMap\n        (\\[relX relY childRot childOr]\n          (let [childX childY childWidth]\n            [\n              (+ centerX (* relX (/ width 4)))\n              (+ centerY (* relY (/ width 4)))\n              (/ width 2)\n            ]\n            (hilbertPoints (- depth 1) childX childY childWidth childRot childOr)\n          )\n        )\n        (hilbertChildParams (normalizeRotation rotation) orientation)\n      )\n    )\n  )\n))\n\n; Returns the first n elements of the list\n(def take (\\(n list)\n  (map2\n    always\n    list\n    (range 1 n)\n  )\n))\n\n; Returns element i (starting from 0) from a list\n(def fetch (\\(i list)\n  (fst (foldl\n    (\\(x [ret thisI])\n      (if (= 0 thisI)\n        [x (- thisI 1)]\n        [ret (- thisI 1)]\n      )\n    )\n    [nil i]\n    list\n  ))\n))\n\n; When drawing the final curve, which points should we draw?\n;\n; All the complexity here is for adding a point part-way between\n; the last point and the next point based on the time.\n(def hilbertPointsAnimated (\\(time depth centerX centerY width rotation orientation)\n  (if (gt (curveFractionToDraw time) 0)\n    (let allPoints (hilbertPoints depth centerX centerY width rotation orientation)\n    (let count (len allPoints)\n    (let countToDraw (floor (* (curveFractionToDraw time) count))\n    (let partialLineFraction (- (* (curveFractionToDraw time) count) countToDraw)\n    (let pointsToDraw (take countToDraw allPoints)\n      (if (and (gt partialLineFraction 0) (gt countToDraw 0))\n        (let [lastPointX lastPointY] (fetch (- countToDraw 1) allPoints)\n        (let [nextPointX nextPointY] (fetch countToDraw allPoints)\n        (let lastPointToDraw\n          [\n            (+ (* lastPointX (- 1 partialLineFraction)) (* nextPointX partialLineFraction))\n            (+ (* lastPointY (- 1 partialLineFraction)) (* nextPointY partialLineFraction))\n          ]\n          (snoc lastPointToDraw pointsToDraw)\n        )))\n        (if (gt countToDraw 1)\n          pointsToDraw\n          [[0 0]]\n        )\n      )\n    )))))\n    [[0 0]]\n  )\n))\n\n; Draw the curve as one long path at the end of the animation.\n(def hilbertCurve (\\(time depth centerX centerY width rotation orientation)\n  (let [[firstX firstY]|otherPoints] (hilbertPointsAnimated time depth centerX centerY width rotation orientation)\n    [(path \'none\' \'blue\' 5\n      [ \'M\' firstX firstY | (concatMap (\\[x y] [\'L\' x y]) otherPoints) ]\n    )]\n  )\n))\n\n(def crossfade (\\(a b t)\n  (+\n    (* a (- 1.0 t))\n    (* b t)\n  )\n))\n\n(def maxLevels 3)\n\n[\n  maxLevels\n  (\\slideNumber\n    (let level slideNumber\n    (let levelPartCount (pow 4 level)\n    (let drawingParts (lt level maxLevels)\n\n      [\n        (if drawingParts (+ 1 levelPartCount) 1)\n        (\\slideMovieNumber\n          (if (and drawingParts (= 1 slideMovieNumber))\n            [\n              \'Dynamic\'\n              0.5\n              (\\(slideNumber movieNumber t)\n                (let relT (* t 2.0)\n                  [\'svg\' [[\'opacity\' (crossfade 1.0 0.5 relT)]] (hilbertParts 0.5 (- level 1) 1 0 1.0 300 300 400 0 1)]\n                )\n              )\n              (not (= slideNumber 1))\n            ]\n            (if drawingParts\n              (let animationDuration (* 3 (pow 0.5 level))\n                [\n                  \'Dynamic\'\n                  animationDuration\n                  (\\(slideNumber movieNumber t)\n                    (let localT (/ (+ (/ (/ t animationDuration) levelPartCount) (* (/ 1.0 levelPartCount) (- movieNumber 2))) 2)\n                      (svg (hilbertParts localT level 1 0 1.0 300 300 400 0 1))\n                    )\n                  )\n                  (and (gt slideMovieNumber 5) (le slideMovieNumber levelPartCount))\n                ]\n              )\n              (let animationDuration 9\n                [\n                  \'Dynamic\'\n                  animationDuration\n                  (\\(slideNumber movieNumber t)\n                    (let localT (+ 0.5 (/ (/ t animationDuration) 2))\n                      (let elements [\n                        (hilbertParts localT (- maxLevels 1) 1 0 (earlierLevelOpacity localT) 300 300 400 0 1)\n                        (hilbertCurve localT (- maxLevels 1) 300 300 400 0 1)\n                      ]\n                      (svg (concat elements))\n                    ))\n                  )\n                  false\n                ]\n              )\n            )\n          )\n        )\n      ]\n    )))\n  )\n]\n';
var _user$project$ExamplesGenerated$fractalTree = '; A fractal tree\n;\n(def nsin (\\n (if (< n (/ 3.14159 2)) (sin n) (cos (mod n (/ 3.14159 2))))))\n(def ncos (\\n (if (< n (/ 3.14159 2)) (cos n) (sin (mod n (/ 3.14159 2))))))\n(def [initwd initlen] [10! 150!])\n(def [steps stepslider] (hSlider true 20! 420! 550! 3! 8! \'Steps \' 4))\n(def [bendn bendnslider] (hSlider false 20! 420! 580! 1! 8! \'Bend \' 1))\n(def initangle (/ 3.14159! 2!))\n(def bend (/ 3.14159! bendn))\n(defrec exp (\\(b p)\n  (if (< p 1) 1 (* b (exp b (- p 1))))))\n(def mkleftx (\\(stepnum theta px) \n  (- px (* (/ initlen stepnum) (ncos (+ theta (* (exp 0.5 stepnum) bend)))))))\n(def mkrightx (\\(stepnum theta px)\n  (+ px (* (/ initlen stepnum) (ncos (- theta (* (exp 0.5 stepnum) bend)))))))\n(def mklefty (\\(stepnum theta py)\n  (- py (* (/ initlen stepnum) (nsin (+ theta (* (exp 0.5 stepnum) bend)))))))\n(def mkrighty (\\(stepnum theta py)\n  (- py (* (/ initlen stepnum) (nsin (- theta (* (exp 0.5 stepnum) bend)))))))\n(defrec genchildren (\\(stepnum maxstep theta px2 py2) \n  (if (< maxstep stepnum) \n    [] \n    (append \n      [ (line \'black\' (/ initwd stepnum) px2 py2 \n          (mkleftx stepnum theta px2)\n          (mklefty stepnum theta py2))\n        (line \'black\' (/ initwd stepnum) px2 py2\n          (mkrightx stepnum theta px2)\n          (mkrighty stepnum theta py2))]\n      (append\n        (genchildren (+ stepnum 1) maxstep (+ theta (* (exp 0.5 stepnum) bend))\n          (mkleftx stepnum theta px2)\n          (mklefty stepnum theta py2))\n        (genchildren (+ stepnum 1) maxstep (- theta (* (exp 0.5 stepnum) bend))\n          (mkrightx stepnum theta px2)\n          (mkrighty stepnum theta py2)))))))\n(def trunk (line \'black\' initwd 210 400 210 250))\n(def branches (genchildren 2 steps initangle 210 250))\n(svg (concat [ [ trunk | branches ] bendnslider stepslider]))\n\n';
var _user$project$ExamplesGenerated$solarSystem = '; Visualization of the solar system \n;\n; The slider on top controls the \"animation.\"\n; Try changing the size of a planet in one frame,\n;   and see what happens in the others.\n \n(def aupx 12)\n(def [ox oy] [200 400])\n\n; Relative radii of the planet orbits, in au\n(def [ merorb venorb earorb marorb juporb satorb uraorb neporb ] \n     [ 0.387! 0.723! 1! 1.524! 5.203! 9.539! 19.18! 30.06! ]\n)\n\n; Relative orbital period to the Earth\n(def [ meryr venyr earyr maryr jupyr satyr urayr nepyr ]\n     [ 0.2409! 0.616! 1! 1.9! 12! 29.5! 84! 165! ]\n)\n\n; Function to place a body\n(def planet (\\(color orb yr radius)\n  (\\t (circle color  (+ ox (* aupx (* orb (cos (* t (/ 6.28318 yr))))))\n                       (+ oy (* aupx (* orb (sin (* t (/ -6.28318 yr))))))\n                       radius))))\n\n; Visual for each body\n; Each takes a time to be displayed at\n(def sun (circle \'yellow\' ox oy 10))\n(def mercury (planet \'lightred\'   merorb meryr 4))\n(def venus   (planet \'orange\'     venorb venyr 5))\n(def earth   (planet \'green\'      earorb earyr 5))\n(def mars    (planet \'red\'        marorb maryr 4))\n(def jupiter (planet \'brown\'      juporb jupyr 6))\n(def saturn  (planet \'sandybrown\' satorb satyr 6))\n(def uranus  (planet \'blue\'       uraorb urayr 6))\n(def neptune (planet \'darkblue\'   neporb nepyr 6))\n\n; Visual for the rings\n(def rings\n  (reverse\n    (map (\\orb (ring \'lightgrey\' 2! ox oy (* aupx orb)))\n         [ merorb venorb earorb marorb juporb satorb uraorb neporb ])))\n\n(def [time timeslider] (hSlider true 20! 600! 20! 1! 1000! \'Day \' 1))\n(def rev (\\(x f) (f x)))\n(def planets\n  (map (rev (/ time 365))\n       [mercury venus earth mars jupiter saturn uranus neptune]))\n\n(svg (concat [ rings [sun | planets] timeslider ]))\n\n';
var _user$project$ExamplesGenerated$pieChart1 = '; A Pie Chart\n;\n; Move the sliders to change the size of a particular slice\n;\n(let [count1_ count2_ count3_ count4_ count5_] [35 31 16 10 8]\n(let [color1 color2 color3 color4 color5] [\'#8DEEEE\' \'#66CCCC\' \'#49E9BD\' \'#5EDA9E\' \'#00FA9A\']\n(let [h1 h2 h3 h4 h5] [20! 50! 80! 110! 140!]\n(let [count1 s1] (hSlider true 20! 420! h1 0! 100! \'\' count1_)\n(let [count2 s2] (hSlider true 20! 420! h2 0! 100! \'\' count2_)\n(let [count3 s3] (hSlider true 20! 420! h3 0! 100! \'\' count3_)\n(let [count4 s4] (hSlider true 20! 420! h4 0! 100! \'\' count4_)\n(let [count5 s5] (hSlider true 20! 420! h5 0! 100! \'\' count5_)\n(let total (+ count1 (+ count2 (+ count3 (+ count4 count5))))\n(let p2 (+ count1 count2)\n(let p3 (+ p2 count3)\n(let p4 (+ p3 count4)\n(let p5 (+ p4 count5)\n;\n(let sliders (concat [s1 s2 s3 s4 s5])\n(let swatches (map (\\[h c] (square c 460! (- h 10!) 20!)) [[h1 color1] [h2 color2] [h3 color3] [h4 color4] [h5 color5]])\n(let [cx cy r t border] [280! 440! 180 4 \'grey\']\n;\n(let pie\n  (let pToDegrees (\\p (* 360! (/ p total)))\n  (let [d1 d2 d3 d4 d5] (map pToDegrees [count1 p2 p3 p4 p5])\n  (let flag (\\d (if (< 180 d) 1 0))\n  (let flagged (map (\\[d fr] [d (flag fr)]) [[d1 d1] [d2 (- d2 d1)] [d3 (- d3 d2)] [d4 (- d4 d3)] [d5 (- d5 d4)]])\n  (let toRadian (\\[d f] [(* (/ (pi) 180!) d) f])\n  (let polarcoords (map toRadian flagged)\n  (let slice (\\[ang flg] [flg (* r (cos ang)) (* r (sin ang))])\n  (let [[f1 x1 y1] [f2 x2 y2] [f3 x3 y3] [f4 x4 y4] [f5 x5 y5]] (map slice polarcoords)\n  (let wedge (\\[color f [sx sy] [ex ey]] (path color border t [\'M\' cx cy \'L\' sx sy \'A\' 180 180 0 f 1 ex ey \'Z\']))\n  (let wedges \n    (map\n      wedge\n        [[color1 f1 [(+ cx 180!) cy] [(+ cx x1) (+ cy y1)]]\n        [color2 f2 [(+ cx x1) (+ cy y1)] [(+ cx x2) (+ cy y2)]]\n        [color3 f3 [(+ cx x2) (+ cy y2)] [(+ cx x3) (+ cy y3)]]\n        [color4 f4 [(+ cx x3) (+ cy y3)] [(+ cx x4) (+ cy y4)]]\n        [color5 f5 [(+ cx x4) (+ cy y4)] [(+ cx x5) (+ cy y5)]]])\n  wedges))))))))))\n;\n(svg (cons (circle \'lightgray\' cx cy (* 1.1 r)) (append (append sliders swatches) pie))))))))))))))))))))\n';
var _user$project$ExamplesGenerated$ferrisWheelSlideshow = '(def [slideN slideSlider] (hSlider true 20! 400! 20! 1! 13! \'Slide \' 1))\n(def [timeInSlide timeInSlideSlider] (hSlider false 20! 400! 40! 0.0! 1.0! \'Time in Slide \' 0.0))\n\n(def rimColor [0 0 0 1])\n(def beamWidth 1)\n(def [centerX centerY] [300 300])\n(def [smallRadius largeRadius] [50 150])\n(def spokeEndSize 3)\n(def hubRadius 12)\n(def [carHighlightColor carColor] [[251 191 141 1] [191 191 191 1]])\n(def [carWidth carHeight] [20 20])\n(def spokeDuplicationOffset 12)\n(def carDuplicationOffset (+ carWidth 12))\n(def carDiagonalDuplicationOffset 14)\n(def rotationAngle (* twoPi 0.03))\n\n(def spoke (\\(centerX centerY rimX rimY)\n  [\n    (line \'black\' 1 centerX centerY rimX rimY)\n    (circle \'black\' rimX rimY spokeEndSize)\n  ]\n))\n\n(def diameterSpoke (\\(x1 y1 x2 y2)\n  [\n    (line \'black\' 1 x1 y1 x2 y2)\n    (circle \'black\' x1 y1 spokeEndSize)\n    (circle \'black\' x2 y2 spokeEndSize)\n  ]\n))\n\n(def car_ (\\(fill x y w h)\n  ; Manual, so we can add stroke.\n  [\n    \'rect\'\n    [ [\'x\' (- x (/ w 2))] [\'y\' (- y (/ h 2))] [\'width\' w] [\'height\' h] [\'fill\' fill] [\'stroke\' \'black\'] ]\n    []\n  ]\n))\n\n(def hub_ (\\(fill x y r)\n  ; Manual, so we can add stroke.\n  [\n    \'circle\'\n    [ [\'cx\' x] [\'cy\' y] [\'r\' r] [\'fill\' fill] [\'stroke\' \'black\'] ]\n    []\n  ]\n))\n\n(def rimAttachmentPoints (\\(spokeCount radius angle centerX centerY)\n  (let angles (map (\\i (- (+ (* (/ i spokeCount) twoPi) angle) halfPi)) (range 0 (- spokeCount 1)))\n    (map (\\angle [(+ centerX (* (cos angle) radius)) (+ centerY (* (sin angle) radius))]) angles)\n  )\n))\n\n(def carsAndHub (\\(spokeCount radius angle carWidth carHeight hubRadius centerX centerY)\n  (let hub [(hub_ carColor centerX centerY hubRadius)]\n  (let [[highlightedCarX highlightedCarY]|otherRimAttachmentPoints] (rimAttachmentPoints spokeCount radius angle centerX centerY)\n  (let highlightedCar [(car_ carHighlightColor highlightedCarX highlightedCarY carWidth carHeight)]\n  (let otherCars (map (\\[x y] (car_ carColor x y carWidth carHeight)) otherRimAttachmentPoints)\n    [hub highlightedCar otherCars]\n  ))))\n))\n\n(def rimAndSpokes (\\(spokeCount radius angle centerX centerY)\n  (let rim [(ring rimColor beamWidth centerX centerY radius)]\n  (let spokes (map (\\[x y] (spoke centerX centerY x y)) (rimAttachmentPoints spokeCount radius angle centerX centerY))\n    [rim (concat spokes)]\n  ))\n))\n\n(def ferrisWheel (\\(spokeCount radius angle carWidth carHeight hubRadius centerX centerY)\n  (concat [\n    (carsAndHub spokeCount radius angle carWidth carHeight hubRadius centerX centerY)\n    (rimAndSpokes spokeCount radius angle centerX centerY)\n  ])\n))\n\n(def hub [(hub_ carColor centerX centerY hubRadius)])\n(def smallRim [(ring rimColor beamWidth centerX centerY smallRadius)])\n(def spoke1 (diameterSpoke centerX (+ centerY smallRadius) centerX (- centerY smallRadius)))\n(def spoke1Duplicate1 (diameterSpoke (+ centerX spokeDuplicationOffset) (+ (+ centerY smallRadius) spokeDuplicationOffset) (+ centerX spokeDuplicationOffset) (+ (- centerY smallRadius) spokeDuplicationOffset)))\n(def spoke1Duplicate2 (diameterSpoke (+ centerX (mult 2 spokeDuplicationOffset)) (+ (+ centerY smallRadius) (mult 2 spokeDuplicationOffset)) (+ centerX (mult 2 spokeDuplicationOffset)) (+ (- centerY smallRadius) (mult 2 spokeDuplicationOffset))))\n(def spoke1Duplicate1HalfMoved (diameterSpoke (+ centerX spokeDuplicationOffset) (+ (+ centerY smallRadius) spokeDuplicationOffset) (- centerX smallRadius) centerY))\n(def spoke2 (diameterSpoke (+ centerX smallRadius) centerY (- centerX smallRadius) centerY))\n\n(def car (\\(x y)\n  [(car_ carColor x y carWidth carHeight)]\n))\n\n(def highlightedCar (\\(x y)\n  [(car_ carHighlightColor x y carWidth carHeight)]\n))\n\n(def car1 (highlightedCar centerX (- centerY smallRadius)))\n(def car1Duplicates (map (\\n (car (+ centerX (* n carDuplicationOffset)) (- centerY smallRadius))) (range 1 3)))\n\n(def ferrisSmall4\n  (ferrisWheel\n    4 ; number of spokes\n    smallRadius\n    0 ; angle\n    carWidth\n    carHeight\n    hubRadius\n    centerX\n    centerY\n  )\n)\n(def car2Duplicates (map (\\n (car (+ smallRadius (+ centerX (* n carDiagonalDuplicationOffset))) (+ centerY (* n carDiagonalDuplicationOffset)))) (range 1 3)))\n(def ferrisSmall4CarsAndHub\n  (carsAndHub\n    4 ; number of spokes\n    smallRadius\n    0 ; angle\n    carWidth\n    carHeight\n    hubRadius\n    centerX\n    centerY\n  )\n)\n(def ferrisSmall8CarsAndHub\n  (carsAndHub\n    8 ; number of spokes\n    smallRadius\n    0 ; angle\n    carWidth\n    carHeight\n    hubRadius\n    centerX\n    centerY\n  )\n)\n(def ferrisSmall8RimAndSpokes\n  (rimAndSpokes\n    8 ; number of spokes\n    smallRadius\n    0 ; angle\n    centerX\n    centerY\n  )\n)\n(def ferrisSmall8\n  (concat [ferrisSmall8CarsAndHub ferrisSmall8RimAndSpokes])\n)\n(def ferrisLarge8RimAndSpokesOffset\n  (rimAndSpokes\n    8 ; number of spokes\n    largeRadius\n    0 ; angle\n    (+ centerX (- largeRadius smallRadius))\n    (- centerY (- largeRadius smallRadius))\n  )\n)\n(def ferrisLarge8RimAndSpokes\n  (rimAndSpokes\n    8 ; number of spokes\n    largeRadius\n    0 ; angle\n    centerX\n    centerY\n  )\n)\n(def ferrisLarge8\n  (ferrisWheel\n    8 ; number of spokes\n    largeRadius\n    0 ; angle\n    carWidth\n    carHeight\n    hubRadius\n    centerX\n    centerY\n  )\n)\n(def ferrisLarge8BadlyRotated\n  [(rotate\n    [\'g\' [] (concat ferrisLarge8)]\n    (/ (* rotationAngle 360) twoPi)\n    centerX\n    centerY\n  )]\n)\n\n(def [car7X car7Y] (hd (reverse (rimAttachmentPoints 8 largeRadius rotationAngle centerX centerY))))\n(def car7 (car car7X car7Y))\n(def car7Duplicates (map (\\n (car (+ car7X (* n carDiagonalDuplicationOffset)) (+ car7Y (* n carDiagonalDuplicationOffset)))) (range 1 7)))\n\n(def ferrisLarge8RimAndSpokesRotated\n  (rimAndSpokes\n    8 ; number of spokes\n    largeRadius\n    rotationAngle\n    centerX\n    centerY\n  )\n)\n(def ferrisLarge8Rotated\n  (ferrisWheel\n    8 ; number of spokes\n    largeRadius\n    (+ rotationAngle (* twoPi timeInSlide))\n    carWidth\n    carHeight\n    hubRadius\n    centerX\n    centerY\n  )\n)\n\n(def appearInOrder (\\shapeGroups\n  (let appearanceTimeAndShapeGroups (map2 (\\(i shapeGroup) [(/ i (len shapeGroups)) shapeGroup]) (range 0 (- (len shapeGroups) 1)) shapeGroups)\n    (foldr\n      (\\([t shapeGroup] visible)\n        (if (ge timeInSlide t)\n          (let opacity (/ (- timeInSlide t) (/ 1 (len shapeGroups)))\n          (let faded [[\'g\' [[\'opacity\' opacity]] shapeGroup]]\n            [faded | visible]\n          ))\n          visible\n        )\n      )\n      []\n      appearanceTimeAndShapeGroups\n    )\n  )\n))\n\n(def elements\n  (if (= slideN 1)\n    (appearInOrder [smallRim spoke1 spoke1Duplicate1])\n    (if (= slideN 2)\n      [smallRim spoke1 spoke1Duplicate1HalfMoved]\n      (if (= slideN 3)\n        (concat [ [hub car1] (appearInOrder car1Duplicates) [smallRim spoke1 spoke2] ])\n        (if (= slideN 4)\n          ferrisSmall4\n          (if (= slideN 5)\n            (concat [ ferrisSmall4 (appearInOrder (concat [[spoke1Duplicate1 spoke1Duplicate2] car2Duplicates])) ])\n            (if (= slideN 6)\n              (concat [ ferrisSmall4CarsAndHub ferrisSmall8RimAndSpokes (appearInOrder car2Duplicates) ])\n              (if (= slideN 7)\n                ferrisSmall8\n                (if (= slideN 8)\n                  (concat [ ferrisSmall8CarsAndHub ferrisLarge8RimAndSpokesOffset ])\n                  (if (= slideN 9)\n                    (concat [ ferrisSmall8CarsAndHub ferrisLarge8RimAndSpokes ])\n                    (if (= slideN 10)\n                      ferrisLarge8\n                      (if (= slideN 11)\n                        [ferrisLarge8BadlyRotated]\n                        (if (= slideN 12)\n                          (concat [ [hub car7] ferrisLarge8RimAndSpokesRotated (appearInOrder car7Duplicates) ])\n                          (if (= slideN 13)\n                            ferrisLarge8Rotated\n                            []\n                          )\n                        )\n                      )\n                    )\n                  )\n                )\n              )\n            )\n          )\n        )\n      )\n    )\n  )\n)\n\n(svg (append (concat elements) (concat [slideSlider timeInSlideSlider])))\n';
var _user$project$ExamplesGenerated$ferris2target = '(def n 8)\n(def len 142)\n(def rot -0.13796015197333036)\n\n(def wheel\n  (let [cx cy] [280 200]\n  (let rim [(ring \'darkgray\' 3 cx cy len)]\n  (let center [(circle \'black\' cx cy 15)]\n  (let frame [(nStar \'goldenrod\' \'darkgray\' 3 n len 0 rot cx cy)]\n  (let spokePts (nPointsOnCircle n rot cx cy len)\n  (let caps (map (\\[x y] (circle \'black\' x y 6)) spokePts)\n  (let cars\n    (let wCar 27\n    (let wHalfCar (/ wCar 2!)\n    (mapi (\\[i [x y]] (squareByCenter (if (= 0 i) \'pink\' \'lightgray\') x y wCar)) spokePts)))\n  (concat [rim cars center frame caps])))))))))\n\n(svg wheel)\n\n';
var _user$project$ExamplesGenerated$ferris2 = '(def n 5)\n(def len 80)\n(def rot 0)\n\n(def wheel\n  (let [cx cy] [280 200]\n  (let rim [(ring \'darkgray\' 8 cx cy len)]\n  (let center [(circle \'black\' cx cy 20)]\n  (let frame [(nStar \'goldenrod\' \'darkgray\' 3 n len 0 rot cx cy)]\n  (let spokePts (nPointsOnCircle n rot cx cy len)\n  (let caps (map (\\[x y] (circle \'black\' x y 7)) spokePts)\n  (let cars\n    (let wCar 30\n    (let wHalfCar (/ wCar 2!)\n    (map (\\[x y] (squareByCenter \'lightgray\' x y wCar)) spokePts)))\n  (concat [rim cars center frame caps])))))))))\n\n(svg wheel)\n\n';
var _user$project$ExamplesGenerated$ferris = '\n; Take this ferris wheel for a spin!\n; Try:\n;  - Stretching the passenger cars\n;  - Stretching the central hub\n;  - Dragging the central hub\n;  - Setting showSliders to false\n\n(def wheel (\\(cx cy rCenter wCar rCap numSpokes spokeLen rotAngle)\n  (let rim      [(ring \'darkgray\' 6 cx cy spokeLen)]\n  (let center   [(circle \'black\' cx cy rCenter)]\n  (let frame    [(nStar \'goldenrod\' \'darkgray\' 3 numSpokes spokeLen 0 rotAngle cx cy)]\n  (let spokePts (nPointsOnCircle numSpokes rotAngle cx cy spokeLen)\n  (let cars     (mapi (\\[i [x y]] (squareByCenter (if (= i 0) \'pink\' \'lightgray\') x y wCar)) spokePts)\n  (let hubcaps  (map (\\[x y] (circle \'black\' x y rCap)) spokePts)\n    (concat [rim cars center frame hubcaps])\n))))))))\n\n(def [cx cy spokeLen rCenter wCar rCap] [220 300 80 20 30 7])\n(def [numSpokes rotAngle] [5!{3-15} 0!{-3.14-3.14}])\n\n(svg (wheel cx cy rCenter wCar rCap numSpokes spokeLen rotAngle))\n\n';
var _user$project$ExamplesGenerated$flw2 = ';\n; A Frank Lloyd Wright design based on:\n; http://www.glass-by-design.com/images3/skylight3.jpg\n;\n; This is a tiled version of that design\n;\n; Possible ways to manipulate:\n; - Grab edges of red polygons, yellow circles, or\n;     blue ellipses and pull in various directions\n; - Grab ends of lines and move in various directions\n;\n(let [x0 y0 w h max] [69 55 200 320 10!]\n(let wbox (/ w 10!)\n(let hbox (/ h 10!)\n(let xoff (\\(n x) (+ x0 (+ (* x w) (* wbox n))))\n(let yoff (\\(n y) (+ y0 (+ (* y h) (* hbox n))))\n(let blkline (\\[[a b] [c d]] (line \'black\' 3 a b c d))\n(let redpoly\n  (\\[a b x y]\n    (polygon\n      \'red\'\n      \'black\'\n      3\n      [[(xoff a x) (yoff a y)]\n       [(xoff a x) (yoff b y)]\n       [(xoff b x) (yoff b y)]\n       [(xoff b x) (yoff a y)]]))\n(let dimension [0! 4 5 6 7 10!]\n(let [p0 p1 p2 p3 p4] [0 1 2 2.9 5]\n(let singletile\n  (\\[x y] \n    (let verticals\n      (zip\n        (map (\\n [(xoff n x) (+ y0 (* y h))]) dimension)\n        (map (\\n [(xoff n x) (+ y0 (* (+ y 1) h))]) dimension))\n    (let horizontals\n      (zip\n        (map (\\n [(+ x0 (* x w)) (yoff n y)]) dimension)\n        (map (\\n [(+ x0 (* (+ 1 x) w)) (yoff n y)]) dimension))\n      (append\n        (append\n          (map blkline (append verticals horizontals))\n          (map (\\[xc yc r] (circle \'yellow\' xc yc r))\n            [[(xoff 6 x) (yoff 1.75 y) (+ wbox hbox)]\n             [(xoff 6 x) (yoff 7 y) (/ (+ wbox hbox) 4)]\n             [(xoff 6 x) (yoff 5 y) (/ (+ wbox hbox) 2)]]))\n        (cons\n          (ellipse \'blue\' (xoff 5 x) (yoff 9 y) (* wbox 4) hbox)\n          (map redpoly [[p0 p1 x y] [p1 p2 x y] [p2 p3 x y] [p3 p4 x y]])\n          )))))\n(let grid (cartProd [0! 1! 2!] [0! 1!])\n;\n  (svg \n    (cons (rect \'white\' (- x0 10!) (- y0 10!) (+ (* 3 w) 20!) (+ (* 2 h) 20!))\n      (concatMap singletile grid))))))))))))))\n\n';
var _user$project$ExamplesGenerated$flw1 = ';\n; A Frank Lloyd Wright design inspired by:\n; http://www.glass-by-design.com/images3/skylight3.jpg\n;\n(let [x0 y0 w h max] [69 55 532 744 10!]\n(let wbox (/ w 10!)\n(let hbox (/ h 10!)\n(let xoff (\\n (+ x0 (* wbox n)))\n(let yoff (\\n (+ y0 (* hbox n)))\n(let blkline (\\[[a b] [c d]] (line \'black\' 3 a b c d))\n(let redpoly\n  (\\[a b]\n    (polygon\n      \'red\'\n      \'black\'\n      3\n      [[(xoff  a) (yoff  a)]\n       [(xoff  a) (yoff  b)]\n       [(xoff  b) (yoff  b)]\n       [(xoff  b) (yoff  a)]]))\n(let dimension\n  [0! 1 2 2.9 2.4 1.5 9.1 7.9 8.2 8.7 10!]\n(let verticals\n  (zip\n    (map (\\n [(xoff  n) y0]) dimension)\n    (map (\\n [(xoff  n) (+ y0 (* hbox max))]) dimension))\n(let horizontals\n  (zip\n    (map (\\n [x0 (yoff  n)]) dimension)\n    (map (\\n [(+ x0 (* wbox max)) (yoff  n)]) dimension))\n  (svg\n    (cons (rect \'white\' (- x0 10!) (- y0 10!) (+ w 20!) (+ h 20!)) \n    (append\n      (map blkline (append verticals horizontals))\n      (append\n        (append\n          (let [p0 p1 p2 p3 p4] [0 1 2 2.9 5]\n            (map redpoly [[p0 p1] [p1 p2] [p2 p3] [p3 p4]]))\n          (map (\\[x y] (ellipse \'blue\' x y (* wbox 4) hbox)) [[(xoff  5) (yoff  9)]]))\n        (map\n          (\\[x y r] (circle \'yellow\' x y r))\n          [[(xoff  6) (yoff  1.75) (+ wbox hbox)]\n           [(xoff  6) (yoff  7) (/ (+ wbox hbox) 4)]\n           [(xoff  6) (yoff  5) (/ (+ wbox hbox) 2)]])))))))))))))))\n\n';
var _user$project$ExamplesGenerated$frenchSudan = ';\n; The Flag of French Sudan, based on:\n;\n; A few ways to manipulate:\n; - Grab any part of the stick figure and move it\n;     in various directions\n;\n(let [x0 y0 w h] [50 30 450 300]\n(let wstripe (/ w 3!)\n(let xoff (+ x0 wstripe)\n(let yoff (+ y0 (/ h 4!))\n(let stripe (\\[color x] (rect color x y0 wstripe h))\n(let minrad\n  (if (< (/ wstripe 7.5!) (/ h 15!))\n    (/ wstripe 7.5!)\n    (/ h 15!))\n(let figline (\\[[a b] [c d]] (line \'black\' (/ minrad 2!) a b c d))\n(let [x1 x2 x3] (map (\\n (+ x0 (* wstripe n))) [1.2! 1.5! 1.8!])\n(let [y1 y2 y3 y4] (map (\\n (+ y0 (/ h n))) [4.3! 2.8! 1.9! 1.4!])\n;\n  (svg\n    (cons (rect \'white\' (- x0 10!) (- y0 10!) (+ w 20!) (+ h 20!)) \n    (append\n      (map stripe [[\'blue\' x0] [\'white\' (+ x0 wstripe)] [\'red\' (+ x0 (* 2! wstripe))]])\n      (snoc\n        (ellipse \'black\' x2 y1 (/ wstripe 7.5!) (/ h 15!))\n        (map\n          figline\n          [[[x1 y1] [x1 y2]]\n           [[x1 y2] [x3 y2]]\n           [[x3 y1] [x3 y2]]\n           [[x1 y4] [x1 y3]]\n           [[x1 y3] [x3 y3]]\n           [[x3 y3] [x3 y4]]\n           [[x2 y1] [x2 y3]]]))))))))))))))\n\n';
var _user$project$ExamplesGenerated$chicago = ' \n; The flag of Chicago\n;\n; Possible ways to manipulate\n; - Pull stripes or stars in various directions\n; - Group box in background\n \n(def [x0 y0 ni nj pts w h] [40 40 0.5! 3.5! 6! 454 300])\n(def [outerLen innerLen] [30 12])\n\n(def background\n  (let [d1 d2] [10! 20!]\n  [ (rect \'white\' (- x0 d1) (- y0 d1) (+ w d2) (+ h d2)) ]))\n\n(def stripes\n  (map (\\i\n    (rect \'lightblue\' x0 (+ y0 (* i h)) w (/ h 6!)))\n  [(/ 1! 6!) (/ 2! 3!)]))\n\n(def stars\n  (map (\\i\n    (let off (* i (/ w 4!))\n    (nStar \'red\' \'none\' 0 pts outerLen innerLen 0\n      (+ x0 off) (+ y0 (/ h 2!)))))\n  (range ni nj)))\n\n(svg (concat [background stripes stars]))\n\n';
var _user$project$ExamplesGenerated$usFlag50 = ';\n; Current Flag of the United States\n; (using circles for now, since 50 stars is slow)\n;\n; A few ways to manipulate:\n; - Grab various parts of the red stripes or\n;     blue block and pull in various directions\n; - Grab the edges of the circles and and\n;     increase or decrease the radius\n;\n(let [x0 y0 ni nj pts w h rad] [20 20 0! 12! 5! 510 272 6]\n(let hstripe (/ h 13!)\n(let block (rect \'#09096d\' x0 y0 (* w (/ 2! 5!)) (* 7! hstripe))\n(let stripes\n  (map\n    (\\i (rect \'red\' x0 (+ y0 (* i hstripe)) w hstripe))\n    [0! 2! 4! 6! 8! 10! 12!])\n(let base (append stripes [block])\n;\n  (svg\n    (cons (rect \'white\' (- x0 10!) (- y0 10!) (+ w 20!) (+ h 20!)) \n    (append base\n      (map (\\[i j]\n        (let xsep (/ w 15!)\n        (let ysep (* hstripe 1.3!)\n          (circle \'white\' (+ x0 (* i xsep)) (+ y0 (* j ysep)) rad))))\n        (append (cartProd (range 0.5! 5.5!) (range 0.75! 4.75!))\n                (cartProd (range 1! 5!) (range 1.2! 4.2!))))))))))))\n\n';
var _user$project$ExamplesGenerated$usFlag13 = ';\n; Original flag of the United States\n;\n; A few ways to mainpulate this example:\n; - Grab bottom right corner to increase overall size\n; - Grab the edge of a red stripe to increase width\n; - Grab the points of one of the stars to change \n;     the size of its points\n;\n(let rotate (\\a (/ (* a (pi)) 6.5!))\n(let [x0 y0 ni nj pts w h] [20 20 0! 12! 5! 500 260]\n(let hstripe (/ h 13!)\n(let [blockw blockh] [(/ w 3!) (* 7! hstripe)]\n(let min\n  (if (< blockw blockh)\n    (* 0.4! blockw)\n    (* 0.4! blockh))\n(let [outerLen innerLen] [10 4]\n(let block (rect \'#09096d\' x0 y0 blockw blockh)\n(let stripes\n  (map\n    (\\i (rect \'red\' x0 (+ y0 (* i hstripe)) w hstripe))\n    [0! 2! 4! 6! 8! 10! 12!])\n(let base (append stripes [block])\n;\n  (svg\n    (cons (rect \'white\' (- x0 10!) (- y0 10!) (+ w 20!) (+ h 20!))\n    (append base\n      (map (\\i\n         (nStar \'white\' \'none\' 0 pts innerLen outerLen\n           (rotate  i)\n           (+ (+ x0 (/ w 6!)) (* min (cos (rotate i))))\n           (+ (+ y0 (* hstripe 3.5!)) (* min (sin (rotate i))))))\n        (range ni nj))))))))))))))\n\n';
var _user$project$ExamplesGenerated$boxGridTokenFilter = '\n; Drag some \"filter tokens\" from the right over the grid.\n; Toggle between positive/negative filtering.\n\n(def [x0 y0 w h boxSize] [30! 100! 300! 300! 50!])\n(def allColors [0 100 200 300 450])\n(def seedRows 1.5)\n(def seedCols 2.5)\n(def seedNumColors 1.5)\n(def seedShapeKind 0.5)\n(def seedFilterKind 0.75)\n\n; derived values\n(def [xw yh] [(+ x0 w) (+ y0 h)])\n(def sep (+ boxSize 10!))\n(def halfBoxSize (/ boxSize 2!))\n\n(def [ [ cols rows ] boxSlider ] \n  (let pad 10!\n  (xySlider\n    (- x0 pad) (+ xw pad)\n    (- y0 pad) (+ yh pad)\n    0! (/ w sep)\n    0! (/ h sep)\n    \'\' \'\'\n    seedCols seedRows)))\n\n(def [numColors numColorsSlider]\n  (hSlider true 20! 100! 30! 1! 5! \'#Colors = \' seedNumColors))\n\n(def [shapeKind shapeKindSlider]\n  (enumSlider 220! 300! 30! [\'Box\' \'Dot\' \'Star\'] \'\' seedShapeKind))\n\n(def [posFilter filterKindSlider]\n  (button 360! 30! \'PosNeg = \' seedFilterKind))\n\n(def tokens \n  (let [x0 y0] [400! 50!]\n  (let shift (\\(dx dy) [(+ x0 dx) (+ y0 dy)])\n  (map (\\[x y] (ghost (circle (if posFilter \'blue\' \'red\') x y 10!)))\n       [(shift 0  30)\n        (shift 0  60)\n        (shift 0  90)\n        (shift 0 120)\n        (shift 0 150)\n        (shift 0 180)\n        (shift 0 210)\n        (shift 0 240)\n        (shift 0 270)\n        (shift 0 300)\n       ]))))\n\n(def isCovered (\\(cx cy)\n  (let checkX (between (- cx halfBoxSize) (+ cx halfBoxSize))\n  (let checkY (between (- cy halfBoxSize) (+ cy halfBoxSize))\n  (let centers (map (\\tok [(lookupAttr tok \'cx\') (lookupAttr tok \'cy\')]) tokens)\n  (some (\\[x y] (and (checkX x) (checkY y))) centers)\n )))))\n\n(def shapes\n  (let indices (cartProd (range 0! (- cols 1!)) (range 0! (- rows 1!)))\n  (let drawShape (\\[i j]\n    (let shape\n      (let c (nth allColors (mod (- i j) numColors))\n      (let x (+ x0 (mult i sep))\n      (let y (+ y0 (mult j sep))\n      (let [cx cy] [(+ x halfBoxSize) (+ y halfBoxSize)]\n      ; TODO boolean patterns?\n      (let covered (isCovered cx cy)\n      (if (or (and posFilter (not covered))\n              (and (not posFilter) covered)) (circle \'none\' 0! 0! 0!)\n      (case shapeKind\n        (\'Box\'  (square c x y boxSize))\n        (\'Dot\'  (circle c cx cy halfBoxSize))\n        (\'Star\' (nStar c \'none\' 0! 4! halfBoxSize 10! 0! cx cy))\n        ( else  (circle \'none\' 0! 0! 0!)))))))))\n    (if (and (= i (- cols 1!)) (< j numColors))\n        shape\n        (addAttr shape [\'ZONES\' \'none\']))))\n  (map drawShape indices))))\n\n(svg (concat [ \n  shapes\n  boxSlider\n  numColorsSlider\n  shapeKindSlider\n  filterKindSlider\n  tokens\n]))\n\n';
var _user$project$ExamplesGenerated$rgba = ';\n; A Color Picker\n; \n; Move the sliders to change the rgba\n; value of the circle!\n;\n(let [r_ g_ b_ a_] [22 74 237 0.5]\n;\n(let [r s1] (hSlider true 20! 420! 20! 0! 255! \'\' r_)\n(let [g s2] (hSlider true 20! 420! 50! 0! 255! \'\' g_)\n(let [b s3] (hSlider true 20! 420! 80! 0! 255! \'\' b_)\n(let [a s4] (hSlider false 20! 420! 110! 0.0! 1.0! \'\' a_)\n;\n(let ball (circle [r g b a] 220! 300! 100!)\n(let sliders (concat [s1 s2 s3 s4])\n;\n  (svg (cons ball sliders)))))))))\n\n';
var _user$project$ExamplesGenerated$offsets = '(def pt@[x y] ([125 150] : Point))\n\n(def pt2x (+ x 150))\n(def pt3y (+ y 100))\n(def pt4x (+ pt2x 50))\n(def pt5y (- y 40))\n\n(blobs [\n])\n';
var _user$project$ExamplesGenerated$xySlider = '; A two dimensional slider in a similar style to the other sliders\n(def xySlider_\n  (\\(dropBall roundInt xStart xEnd yStart yEnd minx maxx miny maxy xcaption ycaption curx cury)\n    (let [rCorner wEdge rBall] [4! 3! 10!]\n    (let [xDiff yDiff xValDiff yValDiff] [(- xEnd xStart) (- yEnd yStart) (- maxx minx) (- maxy miny)]\n    (let ballx (+ xStart (* xDiff (/ (- curx minx) xValDiff)))\n    (let bally (+ yStart (* yDiff (/ (- cury miny) yValDiff)))\n    (let ballx_ (clamp xStart xEnd ballx)\n    (let bally_ (clamp yStart yEnd bally)\n    (let rball_ (if dropBall (if (< maxx curx) 0 rBall) rBall)\n    (let rball__ (if dropBall (if (< maxy cury) 0 rball_) rBall)\n    (let xval\n      (let xval_ (clamp minx maxx curx)\n      (if roundInt (round xval_) xval_))\n    (let yval\n      (let yval_ (clamp miny maxy cury)\n      (if roundInt (round yval_) yval_))\n    (let shapes\n      [ (line \'black\' wEdge xStart yStart xEnd yStart)\n        (line \'black\' wEdge xStart yStart xStart yEnd)\n        (line \'black\' wEdge xStart yEnd xEnd yEnd)\n        (line \'black\' wEdge xEnd yStart xEnd yEnd)\n        (circle \'black\' xStart yStart rCorner)\n        (circle \'black\' xStart yEnd rCorner)\n        (circle \'black\' xEnd yStart rCorner)\n        (circle \'black\' xEnd yEnd rCorner)\n        (circle \'black\' ballx_ bally_ rball__)\n        (text (- (+ xStart (/ xDiff 2)) 40) (+ yEnd 20) (+ xcaption (toString xval)))\n        (text (+ xEnd 10) (+ yStart (/ yDiff 2)) (+ ycaption (toString yval))) ]\n  [ [ xval yval ] shapes ])))))))))))))\n\n(def xySlider (xySlider_ false))\n\n(def [ [ a b ] slider ]\n  (xySlider false 20! 420! 20! 420! 0! 100! 0! 100! \'X Axis: \' \'Y Axis: \' 20 20))\n\n(svg slider)\n\n';
var _user$project$ExamplesGenerated$widgets = '; library widgets\n;\n(let [n  s1] (hSlider false 20! 90!  20! 0! 5! \'n = \' 3.1415)\n(let [i  s2] (hSlider true  20! 90!  50! 0! 5! \'i = \' 3.1415)\n(let [b1 s3] (button        20!      80!       \'b1 = \' 0.25)\n(let [b2 s4] (button        20!     110!       \'b2 = \' 0.75)\n  (svg (concat [s1 s2 s3 s4]))))))\n\n';
var _user$project$ExamplesGenerated$buttons = ';\n(let button_ (\\(dropBall xStart y caption xCur)\n  (let [rPoint wLine rBall wSlider] [4! 3! 10! 70!]\n  (let xEnd (+ xStart wSlider)\n  (let xBall (+ xStart (* xCur wSlider))\n  (let xBall_ (clamp xStart xEnd xBall)\n  (let rBall_ (if dropBall (if (= xBall_ xBall) rBall 0) rBall)\n  (let val (< xCur 0.5)\n  (let shapes\n    [ (circle \'black\' xStart y rPoint)\n      (circle \'black\' xEnd y rPoint)\n      (line \'black\' wLine xStart y xEnd y)\n      (circle (if val \'darkgreen\' \'darkred\') xBall y rBall_)\n      (text (+ xEnd 10) (+ y 5) (+ caption (toString val))) ]\n  [val shapes]))))))))\n;\n(let [b b1] (button_ true 20! 20! \'b = \' 0.25)\n  (svg b1)))\n\n';
var _user$project$ExamplesGenerated$sliders = ';\n; The ni constants get adjusted by the sliders,\n; and then clamped to fit within the [min, max] range.\n; Also try changing the min and max constants below.\n;\n(let [min max] [0! 10!]\n(let [n1 n2 n3 n4] [5 5 5 5]\n(let [m1 m2 m3 m4] (map (clamp min max) [n1 n2 n3 n4])\n;\n; Both the horizontal and vertical slider abstractions\n; below take a dropBall parameter:\n;  - if true, the ball can slide off the rail;\n;  - if false, the ball disappears when off the rail.\n;\n(let horizSlider (\\(dropBall xStart xEnd y minVal maxVal curVal)\n  (let [rPoint wLine rBall] [4! 3! 10!]\n  (let [xDiff valDiff] [(- xEnd xStart) (- maxVal minVal)]\n  (let xBall (+ xStart (* xDiff (/ (- curVal minVal) valDiff)))\n  (let xBall_ (clamp xStart xEnd xBall)\n  (let rBall_ (if dropBall (if (= xBall_ xBall) rBall 0) rBall)\n    [ (circle \'black\' xStart y rPoint)\n      (circle \'black\' xEnd y rPoint)\n      (line \'black\' wLine xStart y xEnd y)\n      (circle \'black\' xBall y rBall_)\n    ]))))))\n;\n(let vertSlider (\\(dropBall yStart yEnd x minVal maxVal curVal)\n  (let [rPoint wLine rBall] [4! 3! 10!]\n  (let [yDiff valDiff] [(- yEnd yStart) (- maxVal minVal)]\n  (let yBall (+ yStart (* yDiff (/ (- curVal minVal) valDiff)))\n  (let yBall_ (clamp yStart yEnd yBall)\n  (let rBall_ (if dropBall (if (= yBall_ yBall) rBall 0) rBall)\n    [ (circle \'black\' x yStart rPoint)\n      (circle \'black\' x yEnd rPoint)\n      (line \'black\' wLine x yStart x yEnd)\n      (circle \'black\' x yBall rBall_)\n    ]))))))\n;\n(let sliders\n  (let s1 (horizSlider false 30! 230! 30! min max n1)\n  (let s2 (horizSlider true 30! 230! 70! min max n2)\n  (let s3 (vertSlider false 110! 300! 110! min max n3)\n  (let s4 (vertSlider true 110! 300! 150! min max n4)\n    (foldl append nil [s1 s2 s3 s4])))))\n;\n(let displays\n  (let t1 (text 300 100 (+ \'m1 = \' (toString m1)))\n  (let t2 (text 300 120 (+ \'m2 = \' (toString m2)))\n  (let t3 (text 300 140 (+ \'m3 = \' (toString m3)))\n  (let t4 (text 300 160 (+ \'m4 = \' (toString m4)))\n    [t1 t2 t3 t4]))))\n;\n  (svg (append sliders displays)))))))))\n\n';
var _user$project$ExamplesGenerated$stars = ' \n(let nStar (\\(fill stroke w n len1 len2 rot cx cy)\n  (let pti (\\[i len]\n    (let anglei (+ (- (/ (* i (pi)) n) rot) halfPi)\n    (let xi (+ cx (* len (cos anglei)))\n    (let yi (+ cy (neg (* len (sin anglei))))\n      [xi yi]))))\n  (let lengths\n    (map (\\b (if b len1 len2))\n         (concat (repeat n [true false])))\n  (let indices (list0N (- (* 2! n) 1!))\n    (polygon fill stroke w (map pti (zip indices lengths)))))))\n \n(let [x0 y0 sep ni nj] [100 100 100 3! 7!]\n(let [outerLen innerLen] [50 20]\n(let iStar (\\i\n   (let off (mult (- i ni) sep)\n   (let [xi yi] [(+ x0 off) (+ y0 off)]\n   (nStar \'goldenrod\' \'black\' 3 i outerLen innerLen 0! xi yi))))\n \n(svg (map iStar (range ni nj)))))))\n\n';
var _user$project$ExamplesGenerated$polygons = '(let ngon (\\(n cx cy len1 len2)\n  (let dangle (/ (* 3! (pi)) 2!)\n  (let anglei (\\i (+ dangle (/ (* i (* 2! (pi))) n)))\n  (let xi     (\\i (+ cx (* len1 (cos (anglei i)))))\n  (let yi     (\\i (+ cy (* len2 (sin (anglei i)))))\n  (let pti    (\\i [(xi i) (yi i)])\n  (let pts    (map pti (list0N (- n 1!)))\n    (polygon \'yellow\' \'maroon\' 4 pts))))))))\n(svg [\n  (ngon 3 100 200 40 40)\n  (ngon 4 200 200 30 30)\n  (ngon 5 300 300 50 50)\n  (ngon 7 300 100 40 40)\n  (ngon 15 100 400 40 40)\n]))\n\n';
var _user$project$ExamplesGenerated$rings = '\n(let [x0 y0 w r dx dy] [30 30 7 20 32 20]\n(let dxHalf (div dx 2)\n \n(let row1\n  (map (\\[i c] (ring c w (+ x0 (mult i dx)) y0 r))\n       (zip [0 1 2] [\'blue\' \'black\' \'red\']))\n \n(let row2\n  (map (\\[i c]\n         (let x (+ (+ x0 dxHalf) (mult i dx))\n         (let y (+ y0 dy)\n           (ring c w x y r))))\n       (zip [0 1] [\'yellow\' \'green\']))\n \n(svg (append row1 row2))))))\n\n';
var _user$project$ExamplesGenerated$botanic = '\n; Logo: Chicago Botanic Garden\n\n; Click \'[Zones]\' to see the control points for\n; the various Bezier curves.\n\n(def [w h] [434! 622])\n(def midline (/ w 2!))\n\n(def [x0  y0  xc1 yc1 x1  y1  xc2 yc2]\n     [185 261 59  232 0   382 28  183])\n\n(def leaf (\\polarity\n  (let [mx0 mxc1 mx1 mxc2]\n       [(+ midline (* polarity x0))\n        (+ midline (* polarity xc1))\n        (+ midline (* polarity x1))\n        (+ midline (* polarity xc2))]\n    (path \'white\' \'none\' 0\n      [\'M\' mx0 y0\n       \'Q\' mxc1 yc1 mx1 y1\n       \'M\' mx1 y1\n       \'Q\' mxc2 yc2 mx0 y0]))))\n\n(def [budTipY budCornerX budCornerY]\n     [322     34         262       ])\n\n(def bud\n  (let [rx1 rx2]\n       [(- midline budCornerX)\n        (+ midline budCornerX)]\n    (path \'white\' \'none\' 0\n      [\'M\' midline budTipY\n       \'L\' rx1 budCornerY\n       \'A\' 31 31 0 0 1 rx2 budCornerY\n       \'L\' rx2 budCornerY \'Z\'])))\n\n(def background (zones \'none\' [(rect \'#83F52C\' 0! 0! w h)]))\n\n(svg (concat [background [(leaf 1!) (leaf -1!) bud]]))\n';
var _user$project$ExamplesGenerated$activeTrans2 = '\n; Logo based on Active Transportation Alliance\n; (http://activetrans.org/)\n \n(def base 0)\n(def grayPts\n  [[  97 546           ] [  33 414           ]\n   [  33 (+ base 153!) ] [  53 (+ base 128!) ]\n   [  82 (+ base 135!) ] [  83 (+ base 160!) ]\n   [ 114 (+ base 149!) ] [ 113 (+ base  98!) ]\n   [ 143 (+ base  82!) ] [ 158 (+ base 101!) ]\n   [ 160 (+ base  46!) ] [ 192 (+ base  27!) ]\n   [ 221 (+ base  56!) ] [ 227 (+ base 222!) ]\n   [ 245 (+ base 224!) ] [ 246 (+ base 181!) ]\n   [ 288 (+ base 156!) ] [ 286 (+ base 113!) ]\n   [ 312 (+ base  88!) ] [ 374 (+ base 106!) ]\n   [ 375 (+ base 155!) ] [ 397 (+ base 136!) ]\n   [ 424 (+ base 145!) ] [ 425 207           ]\n  ])\n\n(def greenPts\n  [[247 663] [461 419] [466 230] [439 230] [178 614]])\n\n(def [grayctrl greenctrl]\n  [[47 489] [451 542]])\n\n(def [cGreen cGray] [\'#66CC66\' \'#505050\'])\n(def [b buttonShapes] (button 20! 20! \'\' 0.25))\n(def groupBox (rect (if b \'transparent\' cGreen) 0! 0! 500! 700!))\n\n(def makePath (\\(color pts [xc yc])\n  (let [[x0 y0] [x1 y1] | rest] pts\n  (let commands\n    (append\n      (append [\'M\' x0 y0] [\'Q\' xc yc x1 y1])\n      (foldr (\\([xi yi] acc) (append [\'L\' xi yi] acc))\n             [\'Z\'] rest))\n  (path color \'black\' 0 commands)))))\n \n(def grayPath (makePath (if b cGray \'white\') grayPts grayctrl))\n(def greenPath (makePath (if b cGreen \'white\') greenPts greenctrl))\n\n(svg (append [groupBox grayPath greenPath] buttonShapes))\n\n';
var _user$project$ExamplesGenerated$elmLogo = '; Elm logo, based on:\n; https://github.com/evancz/elm-svg/blob/1.0.2/examples/Logo.elm\n;\n; Notice how the \'viewBox\' attribute puts the canvas in\n; \"full screen\" mode. Also, although we don\'t currently handle\n; rotations (i.e. \'transform\'s) specially, the resulting zone\n; is still useful; toggle the Zones option to see.\n;\n(let foo (\\(color pts) (polygon color \'black\' 0 pts))\n(svgViewBox 323.141 322.95 [\n  (foo \'#F0AD00\' [[161 152] [231 82] [91 82]])\n  (foo \'#7FD13B\' [[8 0] [79 70] [232 70] [161 0]])\n  (addAttr\n     (rect \'#7FD13B\' 192 107 107 108)\n     [\'transform\' \'matrix(0.7071 0.7071 -0.7071 0.7071 186.4727 -127.2386)\'])\n  (foo \'#60B5CC\' [[323 143] [323 0] [179 0]])\n  (foo \'#5A6378\' [[152 161] [0 8] [0 314]])\n  (foo \'#F0AD00\' [[255 246] [323 314] [323 178]])\n  (foo \'#60B5CC\' [[161 170] [8 323] [314 323]])\n]))\n\n';
var _user$project$ExamplesGenerated$logo2 = '; sketch-n-sketch logo, v2\n; better lines for non-square scaling\n\n(def logo (\\(x0 y0 w h delta1 delta2 fg bg)\n  (let [xw yh w2 h2] [(+ x0 w) (+ y0 h) (div w 2) (div h 2)]\n  (let poly (\\(c pts) (polygon c \'none\' 0 pts))\n  (let basic (\\shape (addAttr shape [\'ZONES\' \'basic\']))\n  (svg [\n\n    ; positive background\n    ; starting with (xw,yh) to place color slider\n    (poly fg [[xw yh] [xw y0] [x0 y0] [x0 yh]])\n\n    ; negative X, part 1\n    (poly bg\n      [[x0 y0] [(+ x0 delta1) y0] [xw (- yh delta2)]\n       [xw yh] [(- xw delta1) yh] [x0 (+ y0 delta2)]])\n\n    ; negative X, part 2\n    (basic (poly bg\n      [[xw y0] [xw (+ y0 delta2)] [(+ x0 delta1) yh]\n       [x0 yh] [x0 (- yh delta2)] [(- xw delta1) y0]]))\n\n    ; positive, hiding top-right quarter of X\n    (basic (poly fg\n      [[(+ x0 delta1) y0] [xw y0] [xw (- yh delta2)]]))\n\n  ]))))))\n\n;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\n(def [x0 y0 w h delta1 delta2] [50! 50! 200 200 10 10])\n(def [fg bg] [360 499])\n\n(logo x0 y0 w h delta1 delta2 fg bg)\n\n';
var _user$project$ExamplesGenerated$logo = '; sketch-n-sketch logo\n;\n(let [x0 y0 w h delta] [50 50 200 200 10]\n(let [xw yh w2 h2] [(+ x0 w) (+ y0 h) (div w 2) (div h 2)]\n(let poly (\\pts (polygon \'black\' \'none\' 0 pts))\n(svg [\n  (rect \'white\' x0 y0 w h)\n  (poly\n    [[(+ x0 delta) y0]\n     [xw y0]\n     [xw (- yh delta)]])\n  (poly\n    [[x0 (+ y0 delta)]\n     [x0 (- yh delta)]\n     [(- (+ x0 w2) delta) (+ y0 h2)]])\n  (poly\n    [[(+ x0 delta) yh]\n     [(- xw delta) yh]\n     [(+ x0 w2) (+ (+ y0 h2) delta)]])\n]))))\n\n';
var _user$project$ExamplesGenerated$basicSlides = '(def slideCount 5)\n(def slideMovieCount 5)\n\n[\n  slideCount\n  (\\slideNumber\n    [\n      slideMovieCount\n      (\\slideMovieNumber\n        [\n          \'Dynamic\'\n          1\n          (\\(slideNumber movieNumber t)\n            (svg [\n              (rect\n                \'lightblue\'\n                (+ 100 (* 50 movieNumber))\n                (+ 100 (* 50 slideNumber))\n                (* t 50)\n                (* t 50)\n              )\n            ])\n          )\n          true\n        ]\n      )\n    ]\n  )\n]\n';
var _user$project$ExamplesGenerated$groupOfBoxes = '\n; Try:\n;  - replacing (basicZonesTail nBoxes) with nBoxes\n\n(def [x0 y0 w h sep] [50 200 60 130 110])\n(def colorNum 100)\n(def rotBox 0)\n(def rotGroup 0)\n\n(def [n slider] (hSlider true 50! 300! 30! 1! 10! \'n = \'\n                 3))\n\n(def xi (\\i (+ x0 (mult i sep))))\n\n(def nBoxes\n  (let boxi (\\i\n    (rotate\n      (rect colorNum (xi i) y0 w h)\n      rotBox (+ (xi i) (/ w 2)) (+ y0 (/ h 2))))\n  (map boxi (list0N (- n 1)))))\n\n(def groupBox\n  (let [dw dh] [50 50]\n  (let xg (- x0 (/ dw 2))\n  (let yg (- y0 (/ dh 2))\n  (let wg (+ (+ (- (xi (- n 1)) x0) w) dw)\n  (let hg (+ h dh)\n    (rotate\n      (rect \'lightyellow\' xg yg wg hg)\n      rotGroup (+ xg (/ wg 2)) (+ yg (/ hg 2)))))))))\n\n(svg (concat\n  [ slider [groupBox] (basicZonesTail nBoxes) ]))\n\n';
var _user$project$ExamplesGenerated$nBoxes = '\n(def nBoxes\n  (let [n x0 y0 w h sep] [3{1-10} 40 28 60 130 110{50-200}]\n  (let boxi (\\i\n    (let xi (+ x0 (mult i sep))\n    (rect \'lightblue\' xi y0 w h)))\n  (svg (map boxi (range 0! (- n 1!)))))))\n \nnBoxes\n\n';
var _user$project$ExamplesGenerated$sineWaveGrid = '; WORKAROUND: Switch to [Heuristics] None before using sliders.\n; (Better yet, toggle Heuristics before selecting this example.)\n; Both heuristics modes use a naive algorithm to compute triggers,\n; which runs very slowly with the number of shapes in this canvas.\n\n  ; fix case bug:\n  ; > import Eval exposing (parseAndRun)\n  ; > parseAndRun \"(case [2 false] ([2 true] \'A\') (_ \'B\'))\"\n  ; \"\'A\'\" : String\n\n  ; (let color (case [i shadow]\n  ;   ([2 false] \'crimson\')   ([2 true] \'gray\')\n  ;   ([_ false] \'lightblue\') ([_ true] \'transparent\'))\n\n(def sineWave (\\(x0 y0 w h sep amp n shadow)\n  (let boxi (\\i\n    (let xi (+ x0 (* i sep))\n    (let yi (- y0 (* amp (sin (* i (/ twoPi n)))))\n    (let colori\n      (if (= i 2) (if shadow \'lightgray\' \'crimson\')\n                  (if shadow \'transparent\' \'lightblue\'))\n    (rect colori xi yi w h)))))\n  (map boxi (zeroTo n)))))\n\n; Would be even cooler if wGrid and hGrid were computed\n; automatically from the sine waves in each grid box.\n; Leaving this step as an exercise for another day...\n\n(def [outerPad innerPad] [100{0-300} 20{0-50}])\n(def [wGrid hGrid]       [740{0-1500} 430{0-1000}])\n\n; Helper function (could be added to Prelude)\n\n(def outlined (\\(stroke strokeWidth shape)\n  (consAttr (consAttr shape\n    [\'stroke\' \'black\'])\n    [\'stroke-width\' strokeWidth])))\n\n; Call sineWave in grid box at row i, column j.\n\n(def place (\\(i j x0 y0 w h sep amp n shadow)\n  (let [iPad jPad] [(+ outerPad (* innerPad i)) (+ outerPad (* innerPad j))]\n  (let gridBox\n    (outlined \'black\' (let border 3{0-10} border)\n      (rect \'none\' (+ jPad (* j wGrid)) (+ iPad (* i hGrid)) wGrid hGrid))\n  (let waveBoxes\n    (let [x y] [(+ x0 (* j wGrid)) (+ y0 (* i hGrid))]\n    (sineWave (+ x jPad) (+ y iPad) w h sep amp n shadow))\n  (cons gridBox waveBoxes))))))\n\n; Parameters from the original sineWaveOfBoxes.little.\n; If want to add sliders, then symbolically compute\n; the possible solutions below. Could even add a slider\n; for the index of the box being dragged... another exercise.\n\n(def [x0 y0 w h sep0 amp0 n] [50 120 20 90 30 60 12])\n\n; Simulate dragging of third box by (dx,dy) pixels.\n; Two possible solutions for each mouse direction.\n\n(def [dx dy] [50!{0-300} 110!{0-300}])\n\n(def x1   (+ x0 dx))\n(def sep1 (+ sep0 (/ dx 2!)))\n\n(def y1   (+ y0 dy))\n(def amp1 (/ (- y0 (+ dy 68!)) 0.867!))\n\n; Now draw original and versions with different solutions.\n\n(def totalPad (+ (* 2 outerPad) (* 2 innerPad)))\n(def totalWidth (+ (* 3 wGrid) totalPad))\n(def totalHeight (+ (* 3 hGrid) totalPad))\n\n(svgViewBox totalWidth totalHeight\n  (concat [\n    (place 0 0 x0 y0 w h sep0 amp0 n false)\n    (place 0 0 x1 y1 w h sep0 amp0 n true)  ; shadow box\n\n    (place 1 1 x1 y1 w h sep0 amp0 n false) ; update  x0/y0\n    (place 1 2 x1 y0 w h sep0 amp1 n false) ; update  x0/amp\n    (place 2 1 x0 y1 w h sep1 amp0 n false) ; update sep/y0\n    (place 2 2 x0 y0 w h sep1 amp1 n false) ; update sep/amp\n\n    ; workaround parser design bug that the comment above\n    ; needs to be followed by an expression\n    []\n]))\n\n';
var _user$project$ExamplesGenerated$sineWaveOfBoxes = '(def [x0 y0 w h sep amp] [50 120 20 90 30 60])\n(def n 12!{3-30})\n(def boxi (\\i\n   (let xi (+ x0 (* i sep))\n   (let yi (- y0 (* amp (sin (* i (/ twoPi n)))))\n     (rect \'lightblue\' xi yi w h)))))\n\n(svg (map boxi (zeroTo n)))\n\n';
var _user$project$ExamplesGenerated$nBoxesH2 = '\n(def [a b c] [0 0 0])\n(def something (+ a (+ a (+ b (+ b (+ c c))))))\n\n(def nBoxes\n  (let [n x0 y0 w h sep] [3 40 28 60 130 110]\n  (let boxi (\\i\n    (let xi (+ (+ x0 something) (mult i sep))\n    (rect \'lightblue\' xi y0 w h)))\n  (svg (map boxi (zeroTo n))))))\n \nnBoxes\n\n';
var _user$project$ExamplesGenerated$threeBoxes = '\n(def threeBoxesInt\n  (let [x0 y0 w h sep] [40 28 60 130 110]\n  (let boxi (\\i\n    (let xi (+ x0 (mult i sep))\n    (rect \'lightblue\' xi y0 w h)))\n  (svg (map boxi [0 1 2])))))\n \nthreeBoxesInt\n\n';
var _user$project$ExamplesGenerated$makeExample = F2(
	function (name, s) {
		var thunk = function (_p0) {
			var _p1 = _p0;
			var e = A2(
				_user$project$Utils$fromOkay,
				A2(_elm_lang$core$Basics_ops['++'], 'Error parsing example ', name),
				_user$project$FastParser$parseE(s));
			var ati = _user$project$Types$dummyAceTypeInfo;
			var _p2 = A2(
				_user$project$Utils$fromOk,
				A2(_elm_lang$core$Basics_ops['++'], 'Error executing example ', name),
				_user$project$Eval$run(e));
			var v = _p2._0;
			var ws = _p2._1;
			return {e: e, v: v, ws: ws, ati: ati};
		};
		return {
			ctor: '_Tuple2',
			_0: name,
			_1: {ctor: '_Tuple2', _0: s, _1: thunk}
		};
	});
var _user$project$ExamplesGenerated$generalCategory = {
	ctor: '_Tuple2',
	_0: 'General',
	_1: {
		ctor: '::',
		_0: A2(_user$project$ExamplesGenerated$makeExample, 'BLANK', _user$project$ExamplesGenerated$blank),
		_1: {
			ctor: '::',
			_0: A2(_user$project$ExamplesGenerated$makeExample, '*Prelude*', _user$project$PreludeGenerated$src),
			_1: {ctor: '[]'}
		}
	}
};
var _user$project$ExamplesGenerated$defaultIconCategory = {
	ctor: '_Tuple2',
	_0: 'Default Icons',
	_1: {
		ctor: '::',
		_0: A2(_user$project$ExamplesGenerated$makeExample, 'Icon: Cursor', _user$project$DefaultIconTheme$cursor),
		_1: {
			ctor: '::',
			_0: A2(_user$project$ExamplesGenerated$makeExample, 'Icon: Point Or Offset', _user$project$DefaultIconTheme$pointOrOffset),
			_1: {
				ctor: '::',
				_0: A2(_user$project$ExamplesGenerated$makeExample, 'Icon: Text', _user$project$DefaultIconTheme$text),
				_1: {
					ctor: '::',
					_0: A2(_user$project$ExamplesGenerated$makeExample, 'Icon: Line', _user$project$DefaultIconTheme$line),
					_1: {
						ctor: '::',
						_0: A2(_user$project$ExamplesGenerated$makeExample, 'Icon: Rect', _user$project$DefaultIconTheme$rect),
						_1: {
							ctor: '::',
							_0: A2(_user$project$ExamplesGenerated$makeExample, 'Icon: Ellipse', _user$project$DefaultIconTheme$ellipse),
							_1: {
								ctor: '::',
								_0: A2(_user$project$ExamplesGenerated$makeExample, 'Icon: Polygon', _user$project$DefaultIconTheme$polygon),
								_1: {
									ctor: '::',
									_0: A2(_user$project$ExamplesGenerated$makeExample, 'Icon: Path', _user$project$DefaultIconTheme$path),
									_1: {ctor: '[]'}
								}
							}
						}
					}
				}
			}
		}
	}
};
var _user$project$ExamplesGenerated$deuceCategory = {
	ctor: '_Tuple2',
	_0: 'Deuce Examples',
	_1: {
		ctor: '::',
		_0: A2(_user$project$ExamplesGenerated$makeExample, 'Sketch-n-Sketch Logo', _user$project$ExamplesGenerated$sns_deuce),
		_1: {
			ctor: '::',
			_0: A2(_user$project$ExamplesGenerated$makeExample, 'Target', _user$project$ExamplesGenerated$target_deuce),
			_1: {
				ctor: '::',
				_0: A2(_user$project$ExamplesGenerated$makeExample, 'Battery', _user$project$ExamplesGenerated$battery_deuce),
				_1: {
					ctor: '::',
					_0: A2(_user$project$ExamplesGenerated$makeExample, 'Coffee Mug', _user$project$ExamplesGenerated$coffee_deuce),
					_1: {
						ctor: '::',
						_0: A2(_user$project$ExamplesGenerated$makeExample, 'Mondrian Arch', _user$project$ExamplesGenerated$mondrian_arch_deuce),
						_1: {ctor: '[]'}
					}
				}
			}
		}
	}
};
var _user$project$ExamplesGenerated$logoCategory = {
	ctor: '_Tuple2',
	_0: 'Logos',
	_1: A2(
		_elm_lang$core$List$sortBy,
		_elm_lang$core$Tuple$first,
		{
			ctor: '::',
			_0: A2(_user$project$ExamplesGenerated$makeExample, 'SnS Logo (UIST)', _user$project$ExamplesGenerated$sns_UIST),
			_1: {
				ctor: '::',
				_0: A2(_user$project$ExamplesGenerated$makeExample, 'SnS Logo Revisited (UIST)', _user$project$ExamplesGenerated$sns_revisited_UIST),
				_1: {
					ctor: '::',
					_0: A2(_user$project$ExamplesGenerated$makeExample, 'Botanic Garden Logo (UIST)', _user$project$ExamplesGenerated$botanic_UIST),
					_1: {
						ctor: '::',
						_0: A2(_user$project$ExamplesGenerated$makeExample, 'Logo', _user$project$ExamplesGenerated$logo),
						_1: {
							ctor: '::',
							_0: A2(_user$project$ExamplesGenerated$makeExample, 'Botanic Garden Logo', _user$project$ExamplesGenerated$botanic),
							_1: {
								ctor: '::',
								_0: A2(_user$project$ExamplesGenerated$makeExample, 'Active Trans Logo', _user$project$ExamplesGenerated$activeTrans2),
								_1: {
									ctor: '::',
									_0: A2(_user$project$ExamplesGenerated$makeExample, 'SnS Logo Wheel', _user$project$ExamplesGenerated$snsLogoWheel),
									_1: {
										ctor: '::',
										_0: A2(_user$project$ExamplesGenerated$makeExample, 'Haskell.org Logo', _user$project$ExamplesGenerated$haskell),
										_1: {
											ctor: '::',
											_0: A2(_user$project$ExamplesGenerated$makeExample, 'Cover Logo', _user$project$ExamplesGenerated$cover),
											_1: {
												ctor: '::',
												_0: A2(_user$project$ExamplesGenerated$makeExample, 'POP-PL Logo', _user$project$ExamplesGenerated$poppl),
												_1: {
													ctor: '::',
													_0: A2(_user$project$ExamplesGenerated$makeExample, 'Floral Logo 1', _user$project$ExamplesGenerated$floralLogo),
													_1: {
														ctor: '::',
														_0: A2(_user$project$ExamplesGenerated$makeExample, 'Floral Logo 2', _user$project$ExamplesGenerated$floralLogo2),
														_1: {
															ctor: '::',
															_0: A2(_user$project$ExamplesGenerated$makeExample, 'Elm Logo', _user$project$ExamplesGenerated$elmLogo),
															_1: {
																ctor: '::',
																_0: A2(_user$project$ExamplesGenerated$makeExample, 'Logo 2', _user$project$ExamplesGenerated$logo2),
																_1: {ctor: '[]'}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		})
};
var _user$project$ExamplesGenerated$flagCategory = {
	ctor: '_Tuple2',
	_0: 'Flags',
	_1: A2(
		_elm_lang$core$List$sortBy,
		_elm_lang$core$Tuple$first,
		{
			ctor: '::',
			_0: A2(_user$project$ExamplesGenerated$makeExample, 'Chicago Flag', _user$project$ExamplesGenerated$chicago),
			_1: {
				ctor: '::',
				_0: A2(_user$project$ExamplesGenerated$makeExample, 'US-13 Flag', _user$project$ExamplesGenerated$usFlag13),
				_1: {
					ctor: '::',
					_0: A2(_user$project$ExamplesGenerated$makeExample, 'US-50 Flag', _user$project$ExamplesGenerated$usFlag50),
					_1: {
						ctor: '::',
						_0: A2(_user$project$ExamplesGenerated$makeExample, 'French Sudan Flag', _user$project$ExamplesGenerated$frenchSudan),
						_1: {ctor: '[]'}
					}
				}
			}
		})
};
var _user$project$ExamplesGenerated$otherCategory = {
	ctor: '_Tuple2',
	_0: 'Other',
	_1: {
		ctor: '::',
		_0: A2(_user$project$ExamplesGenerated$makeExample, 'Coffee Mugs (UIST)', _user$project$ExamplesGenerated$coffee_UIST),
		_1: {
			ctor: '::',
			_0: A2(_user$project$ExamplesGenerated$makeExample, 'Wave Boxes', _user$project$ExamplesGenerated$sineWaveOfBoxes),
			_1: {
				ctor: '::',
				_0: A2(_user$project$ExamplesGenerated$makeExample, 'Wave Boxes Grid', _user$project$ExamplesGenerated$sineWaveGrid),
				_1: {
					ctor: '::',
					_0: A2(_user$project$ExamplesGenerated$makeExample, 'Basic Slides', _user$project$ExamplesGenerated$basicSlides),
					_1: {
						ctor: '::',
						_0: A2(_user$project$ExamplesGenerated$makeExample, 'Sailboat', _user$project$ExamplesGenerated$sailBoat),
						_1: {
							ctor: '::',
							_0: A2(_user$project$ExamplesGenerated$makeExample, 'Sliders', _user$project$ExamplesGenerated$sliders),
							_1: {
								ctor: '::',
								_0: A2(_user$project$ExamplesGenerated$makeExample, 'Buttons', _user$project$ExamplesGenerated$buttons),
								_1: {
									ctor: '::',
									_0: A2(_user$project$ExamplesGenerated$makeExample, 'Widgets', _user$project$ExamplesGenerated$widgets),
									_1: {
										ctor: '::',
										_0: A2(_user$project$ExamplesGenerated$makeExample, 'xySlider', _user$project$ExamplesGenerated$xySlider),
										_1: {
											ctor: '::',
											_0: A2(_user$project$ExamplesGenerated$makeExample, 'Offsets', _user$project$ExamplesGenerated$offsets),
											_1: {
												ctor: '::',
												_0: A2(_user$project$ExamplesGenerated$makeExample, 'Tile Pattern', _user$project$ExamplesGenerated$boxGridTokenFilter),
												_1: {
													ctor: '::',
													_0: A2(_user$project$ExamplesGenerated$makeExample, 'Color Picker', _user$project$ExamplesGenerated$rgba),
													_1: {
														ctor: '::',
														_0: A2(_user$project$ExamplesGenerated$makeExample, 'Ferris Wheel', _user$project$ExamplesGenerated$ferris),
														_1: {
															ctor: '::',
															_0: A2(_user$project$ExamplesGenerated$makeExample, 'Ferris Task Before', _user$project$ExamplesGenerated$ferris2),
															_1: {
																ctor: '::',
																_0: A2(_user$project$ExamplesGenerated$makeExample, 'Ferris Task After', _user$project$ExamplesGenerated$ferris2target),
																_1: {
																	ctor: '::',
																	_0: A2(_user$project$ExamplesGenerated$makeExample, 'Ferris Wheel Slideshow', _user$project$ExamplesGenerated$ferrisWheelSlideshow),
																	_1: {
																		ctor: '::',
																		_0: A2(_user$project$ExamplesGenerated$makeExample, 'Survey Results', _user$project$ExamplesGenerated$surveyResultsTriHist2),
																		_1: {
																			ctor: '::',
																			_0: A2(_user$project$ExamplesGenerated$makeExample, 'Hilbert Curve Animation', _user$project$ExamplesGenerated$hilbertCurveAnimation),
																			_1: {
																				ctor: '::',
																				_0: A2(_user$project$ExamplesGenerated$makeExample, 'Bar Graph', _user$project$ExamplesGenerated$barGraph),
																				_1: {
																					ctor: '::',
																					_0: A2(_user$project$ExamplesGenerated$makeExample, 'Pie Chart', _user$project$ExamplesGenerated$pieChart1),
																					_1: {
																						ctor: '::',
																						_0: A2(_user$project$ExamplesGenerated$makeExample, 'Solar System', _user$project$ExamplesGenerated$solarSystem),
																						_1: {
																							ctor: '::',
																							_0: A2(_user$project$ExamplesGenerated$makeExample, 'Clique', _user$project$ExamplesGenerated$clique),
																							_1: {
																								ctor: '::',
																								_0: A2(_user$project$ExamplesGenerated$makeExample, 'Eye Icon', _user$project$ExamplesGenerated$eyeIcon),
																								_1: {
																									ctor: '::',
																									_0: A2(_user$project$ExamplesGenerated$makeExample, 'Horror Films', _user$project$ExamplesGenerated$horrorFilms0),
																									_1: {
																										ctor: '::',
																										_0: A2(_user$project$ExamplesGenerated$makeExample, 'Cycling Association', _user$project$ExamplesGenerated$cyclingAssociation0),
																										_1: {
																											ctor: '::',
																											_0: A2(_user$project$ExamplesGenerated$makeExample, 'Lillicon P', _user$project$ExamplesGenerated$lilliconP),
																											_1: {
																												ctor: '::',
																												_0: A2(_user$project$ExamplesGenerated$makeExample, 'Lillicon P, v2', _user$project$ExamplesGenerated$lilliconP2),
																												_1: {
																													ctor: '::',
																													_0: A2(_user$project$ExamplesGenerated$makeExample, 'Keyboard', _user$project$ExamplesGenerated$keyboard),
																													_1: {
																														ctor: '::',
																														_0: A2(_user$project$ExamplesGenerated$makeExample, 'Keyboard Task Before', _user$project$ExamplesGenerated$keyboard2),
																														_1: {
																															ctor: '::',
																															_0: A2(_user$project$ExamplesGenerated$makeExample, 'Keyboard Task After', _user$project$ExamplesGenerated$keyboard2target),
																															_1: {
																																ctor: '::',
																																_0: A2(_user$project$ExamplesGenerated$makeExample, 'Tessellation Task Before', _user$project$ExamplesGenerated$tessellation),
																																_1: {
																																	ctor: '::',
																																	_0: A2(_user$project$ExamplesGenerated$makeExample, 'Tessellation Task After', _user$project$ExamplesGenerated$tessellationTarget),
																																	_1: {
																																		ctor: '::',
																																		_0: A2(_user$project$ExamplesGenerated$makeExample, 'Tessellation 2', _user$project$ExamplesGenerated$tessellation2),
																																		_1: {
																																			ctor: '::',
																																			_0: A2(_user$project$ExamplesGenerated$makeExample, 'Spiral Spiral-Graph', _user$project$ExamplesGenerated$spiralSpiralGraph),
																																			_1: {
																																				ctor: '::',
																																				_0: A2(_user$project$ExamplesGenerated$makeExample, 'Rounded Rect', _user$project$ExamplesGenerated$roundedRect),
																																				_1: {
																																					ctor: '::',
																																					_0: A2(_user$project$ExamplesGenerated$makeExample, 'Thaw/Freeze', _user$project$ExamplesGenerated$thawFreeze),
																																					_1: {
																																						ctor: '::',
																																						_0: A2(_user$project$ExamplesGenerated$makeExample, 'Dictionaries', _user$project$ExamplesGenerated$dictionaries),
																																						_1: {
																																							ctor: '::',
																																							_0: A2(_user$project$ExamplesGenerated$makeExample, '3 Boxes', _user$project$ExamplesGenerated$threeBoxes),
																																							_1: {
																																								ctor: '::',
																																								_0: A2(_user$project$ExamplesGenerated$makeExample, 'N Boxes Sli', _user$project$ExamplesGenerated$nBoxes),
																																								_1: {
																																									ctor: '::',
																																									_0: A2(_user$project$ExamplesGenerated$makeExample, 'N Boxes', _user$project$ExamplesGenerated$groupOfBoxes),
																																									_1: {
																																										ctor: '::',
																																										_0: A2(_user$project$ExamplesGenerated$makeExample, 'Rings', _user$project$ExamplesGenerated$rings),
																																										_1: {
																																											ctor: '::',
																																											_0: A2(_user$project$ExamplesGenerated$makeExample, 'Polygons', _user$project$ExamplesGenerated$polygons),
																																											_1: {
																																												ctor: '::',
																																												_0: A2(_user$project$ExamplesGenerated$makeExample, 'Stars', _user$project$ExamplesGenerated$stars),
																																												_1: {
																																													ctor: '::',
																																													_0: A2(_user$project$ExamplesGenerated$makeExample, 'Triangles', _user$project$ExamplesGenerated$equiTri),
																																													_1: {
																																														ctor: '::',
																																														_0: A2(_user$project$ExamplesGenerated$makeExample, 'Frank Lloyd Wright', _user$project$ExamplesGenerated$flw1),
																																														_1: {
																																															ctor: '::',
																																															_0: A2(_user$project$ExamplesGenerated$makeExample, 'Frank Lloyd Wright B', _user$project$ExamplesGenerated$flw2),
																																															_1: {
																																																ctor: '::',
																																																_0: A2(_user$project$ExamplesGenerated$makeExample, 'Bezier Curves', _user$project$ExamplesGenerated$bezier),
																																																_1: {
																																																	ctor: '::',
																																																	_0: A2(_user$project$ExamplesGenerated$makeExample, 'Fractal Tree', _user$project$ExamplesGenerated$fractalTree),
																																																	_1: {
																																																		ctor: '::',
																																																		_0: A2(_user$project$ExamplesGenerated$makeExample, 'Stick Figures', _user$project$ExamplesGenerated$stickFigures),
																																																		_1: {
																																																			ctor: '::',
																																																			_0: A2(_user$project$ExamplesGenerated$makeExample, 'Matrix Transformations', _user$project$ExamplesGenerated$matrices),
																																																			_1: {
																																																				ctor: '::',
																																																				_0: A2(_user$project$ExamplesGenerated$makeExample, 'Misc Shapes', _user$project$ExamplesGenerated$miscShapes),
																																																				_1: {
																																																					ctor: '::',
																																																					_0: A2(_user$project$ExamplesGenerated$makeExample, 'Interface Buttons', _user$project$ExamplesGenerated$interfaceButtons),
																																																					_1: {
																																																						ctor: '::',
																																																						_0: A2(_user$project$ExamplesGenerated$makeExample, 'Paths 1', _user$project$ExamplesGenerated$paths1),
																																																						_1: {
																																																							ctor: '::',
																																																							_0: A2(_user$project$ExamplesGenerated$makeExample, 'Paths 2', _user$project$ExamplesGenerated$paths2),
																																																							_1: {
																																																								ctor: '::',
																																																								_0: A2(_user$project$ExamplesGenerated$makeExample, 'Paths 3', _user$project$ExamplesGenerated$paths3),
																																																								_1: {
																																																									ctor: '::',
																																																									_0: A2(_user$project$ExamplesGenerated$makeExample, 'Paths 4', _user$project$ExamplesGenerated$paths4),
																																																									_1: {
																																																										ctor: '::',
																																																										_0: A2(_user$project$ExamplesGenerated$makeExample, 'Paths 5', _user$project$ExamplesGenerated$paths5),
																																																										_1: {
																																																											ctor: '::',
																																																											_0: A2(_user$project$ExamplesGenerated$makeExample, 'Sample Rotations', _user$project$ExamplesGenerated$rotTest),
																																																											_1: {
																																																												ctor: '::',
																																																												_0: A2(_user$project$ExamplesGenerated$makeExample, 'Grid Tile', _user$project$ExamplesGenerated$gridTile),
																																																												_1: {
																																																													ctor: '::',
																																																													_0: A2(_user$project$ExamplesGenerated$makeExample, 'Zones', _user$project$ExamplesGenerated$zones),
																																																													_1: {
																																																														ctor: '::',
																																																														_0: A2(_user$project$ExamplesGenerated$makeExample, 'Rectangle Trisection', _user$project$ExamplesGenerated$rectangleTrisection),
																																																														_1: {
																																																															ctor: '::',
																																																															_0: A2(_user$project$ExamplesGenerated$makeExample, 'Battery', _user$project$ExamplesGenerated$battery),
																																																															_1: {
																																																																ctor: '::',
																																																																_0: A2(_user$project$ExamplesGenerated$makeExample, 'Battery (Dynamic)', _user$project$ExamplesGenerated$batteryDynamic),
																																																																_1: {
																																																																	ctor: '::',
																																																																	_0: A2(_user$project$ExamplesGenerated$makeExample, 'Mondrian Arch', _user$project$ExamplesGenerated$mondrianArch),
																																																																	_1: {
																																																																		ctor: '::',
																																																																		_0: A2(_user$project$ExamplesGenerated$makeExample, 'Ladder', _user$project$ExamplesGenerated$ladder),
																																																																		_1: {
																																																																			ctor: '::',
																																																																			_0: A2(_user$project$ExamplesGenerated$makeExample, 'Rails', _user$project$ExamplesGenerated$rails),
																																																																			_1: {
																																																																				ctor: '::',
																																																																				_0: A2(_user$project$ExamplesGenerated$makeExample, 'Target', _user$project$ExamplesGenerated$target),
																																																																				_1: {
																																																																					ctor: '::',
																																																																					_0: A2(_user$project$ExamplesGenerated$makeExample, 'Xs', _user$project$ExamplesGenerated$xs),
																																																																					_1: {
																																																																						ctor: '::',
																																																																						_0: A2(_user$project$ExamplesGenerated$makeExample, 'Conifer', _user$project$ExamplesGenerated$conifer),
																																																																						_1: {
																																																																							ctor: '::',
																																																																							_0: A2(_user$project$ExamplesGenerated$makeExample, 'Ferris Wheel 3', _user$project$ExamplesGenerated$ferris3),
																																																																							_1: {
																																																																								ctor: '::',
																																																																								_0: A2(_user$project$ExamplesGenerated$makeExample, 'Gear', _user$project$ExamplesGenerated$gear),
																																																																								_1: {
																																																																									ctor: '::',
																																																																									_0: A2(_user$project$ExamplesGenerated$makeExample, 'Koch Snowflake', _user$project$ExamplesGenerated$kochSnowflake),
																																																																									_1: {
																																																																										ctor: '::',
																																																																										_0: A2(_user$project$ExamplesGenerated$makeExample, 'Replace Terminals With Workstations', _user$project$ExamplesGenerated$replaceTerminalsWithWorkstations),
																																																																										_1: {
																																																																											ctor: '::',
																																																																											_0: A2(_user$project$ExamplesGenerated$makeExample, 'Balance Scale', _user$project$ExamplesGenerated$balanceScale),
																																																																											_1: {
																																																																												ctor: '::',
																																																																												_0: A2(_user$project$ExamplesGenerated$makeExample, 'Pencil Tip', _user$project$ExamplesGenerated$pencilTip),
																																																																												_1: {
																																																																													ctor: '::',
																																																																													_0: A2(_user$project$ExamplesGenerated$makeExample, 'Calendar Icon', _user$project$ExamplesGenerated$calendarIcon),
																																																																													_1: {ctor: '[]'}
																																																																												}
																																																																											}
																																																																										}
																																																																									}
																																																																								}
																																																																							}
																																																																						}
																																																																					}
																																																																				}
																																																																			}
																																																																		}
																																																																	}
																																																																}
																																																															}
																																																														}
																																																													}
																																																												}
																																																											}
																																																										}
																																																									}
																																																								}
																																																							}
																																																						}
																																																					}
																																																				}
																																																			}
																																																		}
																																																	}
																																																}
																																															}
																																														}
																																													}
																																												}
																																											}
																																										}
																																									}
																																								}
																																							}
																																						}
																																					}
																																				}
																																			}
																																		}
																																	}
																																}
																															}
																														}
																													}
																												}
																											}
																										}
																									}
																								}
																							}
																						}
																					}
																				}
																			}
																		}
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
};
var _user$project$ExamplesGenerated$deuceUserStudyCategory = {
	ctor: '_Tuple2',
	_0: 'Deuce User Study',
	_1: {
		ctor: '::',
		_0: A2(_user$project$ExamplesGenerated$makeExample, 'Deuce Study Start', _user$project$ExamplesGenerated$study_start),
		_1: {
			ctor: '::',
			_0: A2(_user$project$ExamplesGenerated$makeExample, 'Step 01', _user$project$ExamplesGenerated$tutorial_step_01),
			_1: {
				ctor: '::',
				_0: A2(_user$project$ExamplesGenerated$makeExample, 'Step 02', _user$project$ExamplesGenerated$tutorial_step_02),
				_1: {
					ctor: '::',
					_0: A2(_user$project$ExamplesGenerated$makeExample, 'Step 03', _user$project$ExamplesGenerated$tutorial_step_03),
					_1: {
						ctor: '::',
						_0: A2(_user$project$ExamplesGenerated$makeExample, 'Step 04', _user$project$ExamplesGenerated$tutorial_step_04),
						_1: {
							ctor: '::',
							_0: A2(_user$project$ExamplesGenerated$makeExample, 'Step 05', _user$project$ExamplesGenerated$tutorial_step_05),
							_1: {
								ctor: '::',
								_0: A2(_user$project$ExamplesGenerated$makeExample, 'Step 06', _user$project$ExamplesGenerated$tutorial_step_06),
								_1: {
									ctor: '::',
									_0: A2(_user$project$ExamplesGenerated$makeExample, 'Step 07', _user$project$ExamplesGenerated$tutorial_step_07),
									_1: {
										ctor: '::',
										_0: A2(_user$project$ExamplesGenerated$makeExample, 'Step 08', _user$project$ExamplesGenerated$tutorial_step_08),
										_1: {
											ctor: '::',
											_0: A2(_user$project$ExamplesGenerated$makeExample, 'Step 09', _user$project$ExamplesGenerated$tutorial_step_09),
											_1: {
												ctor: '::',
												_0: A2(_user$project$ExamplesGenerated$makeExample, 'Step 10', _user$project$ExamplesGenerated$tutorial_step_10),
												_1: {
													ctor: '::',
													_0: A2(_user$project$ExamplesGenerated$makeExample, 'Step 11', _user$project$ExamplesGenerated$tutorial_step_11),
													_1: {
														ctor: '::',
														_0: A2(_user$project$ExamplesGenerated$makeExample, 'Step 12', _user$project$ExamplesGenerated$tutorial_step_12),
														_1: {
															ctor: '::',
															_0: A2(_user$project$ExamplesGenerated$makeExample, 'Step 13', _user$project$ExamplesGenerated$tutorial_step_13),
															_1: {
																ctor: '::',
																_0: A2(_user$project$ExamplesGenerated$makeExample, 'Step 14', _user$project$ExamplesGenerated$tutorial_step_14),
																_1: {
																	ctor: '::',
																	_0: A2(_user$project$ExamplesGenerated$makeExample, 'Step 15', _user$project$ExamplesGenerated$tutorial_step_15),
																	_1: {
																		ctor: '::',
																		_0: A2(_user$project$ExamplesGenerated$makeExample, 'Step 16', _user$project$ExamplesGenerated$tutorial_step_16),
																		_1: {
																			ctor: '::',
																			_0: A2(_user$project$ExamplesGenerated$makeExample, 'Step 17', _user$project$ExamplesGenerated$tutorial_step_17),
																			_1: {
																				ctor: '::',
																				_0: A2(_user$project$ExamplesGenerated$makeExample, 'Step 18', _user$project$ExamplesGenerated$tutorial_step_18),
																				_1: {
																					ctor: '::',
																					_0: A2(_user$project$ExamplesGenerated$makeExample, 'Step 19', _user$project$ExamplesGenerated$tutorial_step_19),
																					_1: {
																						ctor: '::',
																						_0: A2(_user$project$ExamplesGenerated$makeExample, 'Step 20', _user$project$ExamplesGenerated$tutorial_step_20),
																						_1: {
																							ctor: '::',
																							_0: A2(_user$project$ExamplesGenerated$makeExample, 'Step 21', _user$project$ExamplesGenerated$tutorial_step_21),
																							_1: {
																								ctor: '::',
																								_0: A2(_user$project$ExamplesGenerated$makeExample, 'Step 22', _user$project$ExamplesGenerated$tutorial_step_22),
																								_1: {
																									ctor: '::',
																									_0: A2(_user$project$ExamplesGenerated$makeExample, 'Step 23', _user$project$ExamplesGenerated$tutorial_step_23),
																									_1: {
																										ctor: '::',
																										_0: A2(_user$project$ExamplesGenerated$makeExample, 'Deuce Study Transition 1', _user$project$ExamplesGenerated$study_transition_1),
																										_1: {
																											ctor: '::',
																											_0: A2(_user$project$ExamplesGenerated$makeExample, 'One Rectangle', _user$project$ExamplesGenerated$task_one_rectangle),
																											_1: {
																												ctor: '::',
																												_0: A2(_user$project$ExamplesGenerated$makeExample, 'Two Circles', _user$project$ExamplesGenerated$task_two_circles),
																												_1: {
																													ctor: '::',
																													_0: A2(_user$project$ExamplesGenerated$makeExample, 'Three Rectangles', _user$project$ExamplesGenerated$task_three_rectangles),
																													_1: {
																														ctor: '::',
																														_0: A2(_user$project$ExamplesGenerated$makeExample, 'Target Icon', _user$project$ExamplesGenerated$task_target),
																														_1: {
																															ctor: '::',
																															_0: A2(_user$project$ExamplesGenerated$makeExample, 'Deuce Study Transition 2', _user$project$ExamplesGenerated$study_transition_2),
																															_1: {
																																ctor: '::',
																																_0: A2(_user$project$ExamplesGenerated$makeExample, 'Four Squares', _user$project$ExamplesGenerated$task_four_squares),
																																_1: {
																																	ctor: '::',
																																	_0: A2(_user$project$ExamplesGenerated$makeExample, 'Lambda Icon', _user$project$ExamplesGenerated$task_lambda),
																																	_1: {
																																		ctor: '::',
																																		_0: A2(_user$project$ExamplesGenerated$makeExample, 'Deuce Study End', _user$project$ExamplesGenerated$study_end),
																																		_1: {ctor: '[]'}
																																	}
																																}
																															}
																														}
																													}
																												}
																											}
																										}
																									}
																								}
																							}
																						}
																					}
																				}
																			}
																		}
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
};
var _user$project$ExamplesGenerated$templateCategories = {
	ctor: '::',
	_0: _user$project$ExamplesGenerated$generalCategory,
	_1: {
		ctor: '::',
		_0: _user$project$ExamplesGenerated$deuceCategory,
		_1: {
			ctor: '::',
			_0: _user$project$ExamplesGenerated$defaultIconCategory,
			_1: {
				ctor: '::',
				_0: _user$project$ExamplesGenerated$logoCategory,
				_1: {
					ctor: '::',
					_0: _user$project$ExamplesGenerated$flagCategory,
					_1: {
						ctor: '::',
						_0: _user$project$ExamplesGenerated$otherCategory,
						_1: {
							ctor: '::',
							_0: _user$project$ExamplesGenerated$deuceUserStudyCategory,
							_1: {ctor: '[]'}
						}
					}
				}
			}
		}
	}
};
var _user$project$ExamplesGenerated$list = _elm_lang$core$List$concat(
	A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$second, _user$project$ExamplesGenerated$templateCategories));

var _user$project$DependenceGraph$strScopeId = function (_p0) {
	var _p1 = _p0;
	return A2(
		_elm_lang$core$Basics_ops['++'],
		_elm_lang$core$Basics$toString(_p1._0),
		A2(
			_elm_lang$core$Basics_ops['++'],
			'-',
			_elm_lang$core$Basics$toString(_p1._1)));
};
var _user$project$DependenceGraph$clusterNode = function (scopeId) {
	return A2(
		_elm_lang$core$Basics_ops['++'],
		'scope',
		_user$project$DependenceGraph$strScopeId(scopeId));
};
var _user$project$DependenceGraph$scopeEdges = F2(
	function (f, scopeGraph) {
		return A3(
			_elm_lang$core$Basics$flip,
			_elm_lang$core$List$map,
			_elm_lang$core$Dict$toList(scopeGraph.parents),
			function (_p2) {
				var _p3 = _p2;
				return f(
					A2(
						_elm_lang$core$Basics_ops['++'],
						_user$project$DependenceGraph$clusterNode(_p3._0),
						A2(
							_elm_lang$core$Basics_ops['++'],
							' -> ',
							_user$project$DependenceGraph$clusterNode(_p3._1))));
			});
	});
var _user$project$DependenceGraph$defineNode = F3(
	function (color, name, label) {
		return A2(
			_elm_lang$core$Basics_ops['++'],
			name,
			A2(
				_elm_lang$core$Basics_ops['++'],
				' [label=\"',
				A2(
					_elm_lang$core$Basics_ops['++'],
					label,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'\", style=filled, fillcolor=',
						A2(_elm_lang$core$Basics_ops['++'], color, ']')))));
	});
var _user$project$DependenceGraph$defineVarNode = _user$project$DependenceGraph$defineNode('lemonchiffon1');
var _user$project$DependenceGraph$defineClusterNode = function (letOrFun) {
	var _p4 = letOrFun;
	if (_p4 === true) {
		return _user$project$DependenceGraph$defineNode('white');
	} else {
		return _user$project$DependenceGraph$defineNode('lightblue1');
	}
};
var _user$project$DependenceGraph$patternTransitivelyDependsOnScope = F3(
	function (scopeGraph, sourcePat, targetScope) {
		var directDependency = A2(
			_elm_lang$core$Set$member,
			targetScope,
			A2(_user$project$Utils$dictGetSet, sourcePat, scopeGraph.dependenciesPS));
		var transitiveDependency = function (_p5) {
			var _p6 = _p5;
			return A2(
				_elm_lang$core$List$any,
				function (pat) {
					return A3(_user$project$DependenceGraph$patternTransitivelyDependsOnScope, scopeGraph, pat, targetScope);
				},
				_elm_lang$core$Set$toList(
					A2(_user$project$Utils$dictGetSet, sourcePat, scopeGraph.dependencies)));
		};
		return directDependency || transitiveDependency(
			{ctor: '_Tuple0'});
	});
var _user$project$DependenceGraph$rootId = {ctor: '_Tuple2', _0: 0, _1: 1};
var _user$project$DependenceGraph$rootPathedPatId = {
	ctor: '_Tuple2',
	_0: _user$project$DependenceGraph$rootId,
	_1: {ctor: '[]'}
};
var _user$project$DependenceGraph$initEnv = {currentScope: _user$project$DependenceGraph$rootId, currentScopes: _elm_lang$core$Set$empty, varBindings: _elm_lang$core$Dict$empty};
var _user$project$DependenceGraph$lookupIdent = F2(
	function (pathedPatId, scopeGraph) {
		return A2(
			_elm_lang$core$Maybe$withDefault,
			'?',
			A2(_elm_lang$core$Dict$get, pathedPatId, scopeGraph.idents));
	});
var _user$project$DependenceGraph$resolve = F2(
	function (x, varBindings) {
		var _p7 = A2(_elm_lang$core$Dict$get, x, varBindings);
		if ((_p7.ctor === 'Just') && (_p7._0.ctor === '::')) {
			return _elm_lang$core$Maybe$Just(_p7._0._0);
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$DependenceGraph$addVarBindingsAfter = F3(
	function (scopeId, varBindings, acc) {
		return _elm_lang$core$Native_Utils.update(
			acc,
			{
				varBindingsAfter: A3(_elm_lang$core$Dict$insert, scopeId, varBindings, acc.varBindingsAfter)
			});
	});
var _user$project$DependenceGraph$addVarBindingsBefore = F3(
	function (scopeId, varBindings, acc) {
		return _elm_lang$core$Native_Utils.update(
			acc,
			{
				varBindingsBefore: A3(_elm_lang$core$Dict$insert, scopeId, varBindings, acc.varBindingsBefore)
			});
	});
var _user$project$DependenceGraph$addScopeEdge = F3(
	function (newScopeId, currentScopeId, acc) {
		return _elm_lang$core$Native_Utils.update(
			acc,
			{
				parents: A3(_elm_lang$core$Dict$insert, newScopeId, currentScopeId, acc.parents),
				children: A3(_user$project$Utils$dictAddToSet, currentScopeId, newScopeId, acc.children)
			});
	});
var _user$project$DependenceGraph$addScopeNode = F3(
	function (newScopeId, letOrFun, acc) {
		return _elm_lang$core$Native_Utils.update(
			acc,
			{
				scopeNodes: A3(
					_elm_lang$core$Dict$insert,
					newScopeId,
					{ctor: '_Tuple2', _0: letOrFun, _1: _elm_lang$core$Set$empty},
					acc.scopeNodes)
			});
	});
var _user$project$DependenceGraph$addVarNode = F3(
	function (pathedPatId, x, acc) {
		var _p8 = pathedPatId;
		var scopeId = _p8._0;
		var _p9 = A3(_user$project$Utils$justGet_, 'addVarNode', scopeId, acc.scopeNodes);
		var letOrFun = _p9._0;
		var set = _p9._1;
		return _elm_lang$core$Native_Utils.update(
			acc,
			{
				scopeNodes: A3(
					_elm_lang$core$Dict$insert,
					scopeId,
					{
						ctor: '_Tuple2',
						_0: letOrFun,
						_1: A2(_elm_lang$core$Set$insert, pathedPatId, set)
					},
					acc.scopeNodes),
				idents: A3(_elm_lang$core$Dict$insert, pathedPatId, x, acc.idents)
			});
	});
var _user$project$DependenceGraph$addVarToEnv = F3(
	function (pathedPatId, x, env) {
		var xBindings = A2(
			_elm_lang$core$Maybe$withDefault,
			{ctor: '[]'},
			A2(_elm_lang$core$Dict$get, x, env.varBindings));
		return _elm_lang$core$Native_Utils.update(
			env,
			{
				varBindings: A3(
					_elm_lang$core$Dict$insert,
					x,
					{ctor: '::', _0: pathedPatId, _1: xBindings},
					env.varBindings)
			});
	});
var _user$project$DependenceGraph$foldPatternsWithIds = F4(
	function (f, _p10, pats, init) {
		var _p11 = _p10;
		var _p19 = _p11._0;
		var _p18 = _p11._1;
		var doOne = F4(
			function (f, pathedPatId, pat, acc) {
				var _p12 = pat.val.p__;
				switch (_p12.ctor) {
					case 'PConst':
						return acc;
					case 'PBase':
						return acc;
					case 'PVar':
						return A3(f, pathedPatId, _p12._1, acc);
					case 'PAs':
						return A3(
							f,
							pathedPatId,
							_p12._1,
							A4(doOne, f, pathedPatId, _p12._3, acc));
					default:
						if (_p12._3.ctor === 'Nothing') {
							return A4(doMany, f, pathedPatId, _p12._1, acc);
						} else {
							return A4(
								doMany,
								f,
								pathedPatId,
								A2(
									_elm_lang$core$Basics_ops['++'],
									_p12._1,
									{
										ctor: '::',
										_0: _p12._3._0,
										_1: {ctor: '[]'}
									}),
								acc);
						}
				}
			});
		var doMany = F4(
			function (f, _p13, pats, acc) {
				var _p14 = _p13;
				return A3(
					_user$project$Utils$foldli1,
					function (_p15) {
						var _p16 = _p15;
						return A3(
							doOne,
							f,
							{
								ctor: '_Tuple2',
								_0: _p14._0,
								_1: A2(
									_elm_lang$core$Basics_ops['++'],
									_p14._1,
									{
										ctor: '::',
										_0: _p16._0,
										_1: {ctor: '[]'}
									})
							},
							_p16._1);
					},
					acc,
					pats);
			});
		var _p17 = pats;
		if ((_p17.ctor === '::') && (_p17._1.ctor === '[]')) {
			return A4(
				doOne,
				f,
				{ctor: '_Tuple2', _0: _p19, _1: _p18},
				_p17._0,
				init);
		} else {
			return A4(
				doMany,
				f,
				{ctor: '_Tuple2', _0: _p19, _1: _p18},
				pats,
				init);
		}
	});
var _user$project$DependenceGraph$updateEnv = F3(
	function (newScopeId, pats, env) {
		return A4(
			_user$project$DependenceGraph$foldPatternsWithIds,
			_user$project$DependenceGraph$addVarToEnv,
			{
				ctor: '_Tuple2',
				_0: newScopeId,
				_1: {ctor: '[]'}
			},
			pats,
			_elm_lang$core$Native_Utils.update(
				env,
				{
					currentScope: newScopeId,
					currentScopes: A2(_elm_lang$core$Set$insert, newScopeId, env.currentScopes)
				}));
	});
var _user$project$DependenceGraph$traverseAndAddDependencies_ = F5(
	function (pathedPatId, env, pat, exp, acc) {
		traverseAndAddDependencies_:
		while (true) {
			var addDependencies = F2(
				function (somePathedPatId, acc) {
					var used = A2(
						_elm_lang$core$Set$filter,
						function (_p20) {
							var _p21 = _p20;
							return A2(_elm_lang$core$Set$member, _p21._0, env.currentScopes);
						},
						acc.usedVars);
					var update = F2(
						function (dict, foo) {
							return A3(_elm_lang$core$Set$foldl, foo, dict, used);
						});
					return _elm_lang$core$Native_Utils.update(
						acc,
						{
							dependencies: A2(
								update,
								acc.dependencies,
								function (usedPat) {
									return A2(_user$project$Utils$dictAddToSet, somePathedPatId, usedPat);
								}),
							dependenciesPS: A2(
								update,
								acc.dependenciesPS,
								function (usedPat) {
									return A2(
										_user$project$Utils$dictAddToSet,
										somePathedPatId,
										_elm_lang$core$Tuple$first(usedPat));
								}),
							dependenciesSP: A2(
								update,
								acc.dependenciesSP,
								function (usedPat) {
									return A2(
										_user$project$Utils$dictAddToSet,
										_elm_lang$core$Tuple$first(somePathedPatId),
										usedPat);
								}),
							dependenciesSS: A2(
								update,
								acc.dependenciesSS,
								function (usedPat) {
									return A2(
										_user$project$Utils$dictAddToSet,
										_elm_lang$core$Tuple$first(somePathedPatId),
										_elm_lang$core$Tuple$first(usedPat));
								})
						});
				});
			var addConservativeDependencies = function (acc) {
				return A4(
					_user$project$DependenceGraph$foldPatternsWithIds,
					F3(
						function (innerPathedPatId, _p22, acc) {
							return A2(addDependencies, innerPathedPatId, acc);
						}),
					pathedPatId,
					{
						ctor: '::',
						_0: pat,
						_1: {ctor: '[]'}
					},
					acc);
			};
			var clearUsed = function (acc) {
				return _elm_lang$core$Native_Utils.update(
					acc,
					{usedVars: _elm_lang$core$Set$empty});
			};
			var _p23 = {ctor: '_Tuple2', _0: pat.val.p__, _1: exp.val.e__};
			switch (_p23._0.ctor) {
				case 'PConst':
					return A3(_user$project$DependenceGraph$traverse, env, exp, acc);
				case 'PBase':
					return A3(_user$project$DependenceGraph$traverse, env, exp, acc);
				case 'PVar':
					return A2(
						addDependencies,
						pathedPatId,
						A3(
							_user$project$DependenceGraph$traverse,
							env,
							exp,
							clearUsed(acc)));
				case 'PAs':
					var _v12 = pathedPatId,
						_v13 = env,
						_v14 = _p23._0._3,
						_v15 = exp,
						_v16 = A2(
						addDependencies,
						pathedPatId,
						A3(
							_user$project$DependenceGraph$traverse,
							env,
							exp,
							clearUsed(acc)));
					pathedPatId = _v12;
					env = _v13;
					pat = _v14;
					exp = _v15;
					acc = _v16;
					continue traverseAndAddDependencies_;
				default:
					if (_p23._1.ctor === 'EList') {
						var ps = A2(_user$project$Utils$snocMaybe, _p23._0._1, _p23._0._3);
						var es = A2(_user$project$Utils$snocMaybe, _p23._1._1, _p23._1._3);
						if (_elm_lang$core$Native_Utils.eq(
							_elm_lang$core$List$length(ps),
							_elm_lang$core$List$length(es))) {
							var _p24 = pathedPatId;
							var scopeId = _p24._0;
							var basePath = _p24._1;
							return A3(
								_user$project$Utils$foldli1,
								F2(
									function (_p25, acc) {
										var _p26 = _p25;
										var pathedPatId = {
											ctor: '_Tuple2',
											_0: scopeId,
											_1: A2(
												_elm_lang$core$Basics_ops['++'],
												basePath,
												{
													ctor: '::',
													_0: _p26._0,
													_1: {ctor: '[]'}
												})
										};
										return A5(_user$project$DependenceGraph$traverseAndAddDependencies_, pathedPatId, env, _p26._1._0, _p26._1._1, acc);
									}),
								acc,
								A2(_user$project$Utils$zip, ps, es));
						} else {
							return addConservativeDependencies(
								A3(
									_user$project$DependenceGraph$traverse,
									env,
									exp,
									clearUsed(acc)));
						}
					} else {
						return addConservativeDependencies(
							A3(
								_user$project$DependenceGraph$traverse,
								env,
								exp,
								clearUsed(acc)));
					}
			}
		}
	});
var _user$project$DependenceGraph$traverse = F3(
	function (env, exp, acc) {
		traverse:
		while (true) {
			var recurse = function (es) {
				return A3(
					_elm_lang$core$List$foldl,
					_user$project$DependenceGraph$traverse(env),
					acc,
					es);
			};
			var newScopeId = {ctor: '_Tuple2', _0: exp.val.eid, _1: 1};
			var _p27 = exp.val.e__;
			switch (_p27.ctor) {
				case 'ELet':
					var _p28 = _p27._3;
					var env1 = A3(
						_user$project$DependenceGraph$updateEnv,
						newScopeId,
						{
							ctor: '::',
							_0: _p28,
							_1: {ctor: '[]'}
						},
						env);
					var _v19 = env1,
						_v20 = _p27._5,
						_v21 = A3(
						_user$project$DependenceGraph$addVarBindingsAfter,
						newScopeId,
						env1.varBindings,
						A3(
							_user$project$DependenceGraph$addVarBindingsBefore,
							newScopeId,
							env.varBindings,
							A5(
								_user$project$DependenceGraph$traverseAndAddDependencies,
								newScopeId,
								env,
								_p28,
								_p27._4,
								A4(
									_user$project$DependenceGraph$foldPatternsWithIds,
									_user$project$DependenceGraph$addVarNode,
									{
										ctor: '_Tuple2',
										_0: newScopeId,
										_1: {ctor: '[]'}
									},
									{
										ctor: '::',
										_0: _p28,
										_1: {ctor: '[]'}
									},
									A3(
										_user$project$DependenceGraph$addScopeEdge,
										newScopeId,
										env.currentScope,
										A3(_user$project$DependenceGraph$addScopeNode, newScopeId, true, acc))))));
					env = _v19;
					exp = _v20;
					acc = _v21;
					continue traverse;
				case 'EFun':
					var _p29 = _p27._1;
					var env1 = A3(_user$project$DependenceGraph$updateEnv, newScopeId, _p29, env);
					var _v22 = env1,
						_v23 = _p27._2,
						_v24 = A3(
						_user$project$DependenceGraph$addVarBindingsAfter,
						newScopeId,
						env1.varBindings,
						A3(
							_user$project$DependenceGraph$addVarBindingsBefore,
							newScopeId,
							env.varBindings,
							A4(
								_user$project$DependenceGraph$foldPatternsWithIds,
								_user$project$DependenceGraph$addVarNode,
								{
									ctor: '_Tuple2',
									_0: newScopeId,
									_1: {ctor: '[]'}
								},
								_p29,
								A3(
									_user$project$DependenceGraph$addScopeEdge,
									newScopeId,
									env.currentScope,
									A3(_user$project$DependenceGraph$addScopeNode, newScopeId, false, acc)))));
					env = _v22;
					exp = _v23;
					acc = _v24;
					continue traverse;
				case 'EVar':
					var _p30 = A2(_user$project$DependenceGraph$resolve, _p27._1, env.varBindings);
					if (_p30.ctor === 'Nothing') {
						return acc;
					} else {
						return _elm_lang$core$Native_Utils.update(
							acc,
							{
								usedVars: A2(_elm_lang$core$Set$insert, _p30._0, acc.usedVars)
							});
					}
				case 'EConst':
					return acc;
				case 'EBase':
					return acc;
				case 'EApp':
					return recurse(
						{ctor: '::', _0: _p27._1, _1: _p27._2});
				case 'EOp':
					return recurse(_p27._2);
				case 'EIf':
					return recurse(
						{
							ctor: '::',
							_0: _p27._1,
							_1: {
								ctor: '::',
								_0: _p27._2,
								_1: {
									ctor: '::',
									_0: _p27._3,
									_1: {ctor: '[]'}
								}
							}
						});
				case 'EList':
					if (_p27._3.ctor === 'Just') {
						return recurse(
							A2(
								_elm_lang$core$Basics_ops['++'],
								_p27._1,
								{
									ctor: '::',
									_0: _p27._3._0,
									_1: {ctor: '[]'}
								}));
					} else {
						return recurse(_p27._1);
					}
				case 'ECase':
					var _p31 = A2(
						_elm_lang$core$Debug$log,
						'TODO: scope tree ECase',
						{ctor: '_Tuple0'});
					return acc;
				case 'ETypeCase':
					var _p32 = A2(
						_elm_lang$core$Debug$log,
						'TODO: scope tree ETypeCase',
						{ctor: '_Tuple0'});
					return acc;
				case 'EComment':
					return recurse(
						{
							ctor: '::',
							_0: _p27._2,
							_1: {ctor: '[]'}
						});
				case 'EOption':
					return recurse(
						{
							ctor: '::',
							_0: _p27._4,
							_1: {ctor: '[]'}
						});
				case 'ETyp':
					return recurse(
						{
							ctor: '::',
							_0: _p27._3,
							_1: {ctor: '[]'}
						});
				case 'EColonType':
					return recurse(
						{
							ctor: '::',
							_0: _p27._1,
							_1: {ctor: '[]'}
						});
				default:
					return recurse(
						{
							ctor: '::',
							_0: _p27._3,
							_1: {ctor: '[]'}
						});
			}
		}
	});
var _user$project$DependenceGraph$traverseAndAddDependencies = function (newScopeId) {
	return _user$project$DependenceGraph$traverseAndAddDependencies_(
		{
			ctor: '_Tuple2',
			_0: newScopeId,
			_1: {ctor: '[]'}
		});
};
var _user$project$DependenceGraph$compute = function (e) {
	return A3(
		_user$project$DependenceGraph$traverse,
		_user$project$DependenceGraph$initEnv,
		e,
		{
			scopeNodes: A2(
				_elm_lang$core$Dict$singleton,
				_user$project$DependenceGraph$rootId,
				{ctor: '_Tuple2', _0: true, _1: _elm_lang$core$Set$empty}),
			idents: _elm_lang$core$Dict$empty,
			parents: _elm_lang$core$Dict$empty,
			children: _elm_lang$core$Dict$empty,
			dependencies: _elm_lang$core$Dict$empty,
			dependenciesPS: _elm_lang$core$Dict$empty,
			dependenciesSP: _elm_lang$core$Dict$empty,
			dependenciesSS: _elm_lang$core$Dict$empty,
			varBindingsBefore: _elm_lang$core$Dict$empty,
			varBindingsAfter: _elm_lang$core$Dict$empty,
			usedVars: _elm_lang$core$Set$empty
		});
};
var _user$project$DependenceGraph$strPathedPatId = function (_p33) {
	var _p34 = _p33;
	return A2(
		_elm_lang$core$String$join,
		'_',
		{
			ctor: '::',
			_0: _user$project$DependenceGraph$strScopeId(_p34._0),
			_1: A2(_elm_lang$core$List$map, _elm_lang$core$Basics$toString, _p34._1)
		});
};
var _user$project$DependenceGraph$varNode = function (pathedPatId) {
	return A2(
		_elm_lang$core$Basics_ops['++'],
		'var',
		_user$project$DependenceGraph$strPathedPatId(pathedPatId));
};
var _user$project$DependenceGraph$clusters = F2(
	function (f, scopeGraph) {
		return A3(
			_elm_lang$core$Basics$flip,
			_elm_lang$core$List$concatMap,
			_elm_lang$core$Dict$toList(scopeGraph.scopeNodes),
			function (_p35) {
				var _p36 = _p35;
				var _p37 = _p36._0;
				var s = _elm_lang$core$Basics$toString(_p37);
				return _elm_lang$core$List$concat(
					{
						ctor: '::',
						_0: {
							ctor: '::',
							_0: f(
								A2(
									_elm_lang$core$Basics_ops['++'],
									'subgraph cluster',
									A2(_elm_lang$core$Basics_ops['++'], s, ' {'))),
							_1: {ctor: '[]'}
						},
						_1: {
							ctor: '::',
							_0: {
								ctor: '::',
								_0: f(
									A3(
										_user$project$DependenceGraph$defineClusterNode,
										_p36._1._0,
										_user$project$DependenceGraph$clusterNode(_p37),
										s)),
								_1: {ctor: '[]'}
							},
							_1: {
								ctor: '::',
								_0: A3(
									_elm_lang$core$Basics$flip,
									_elm_lang$core$List$map,
									_elm_lang$core$Set$toList(_p36._1._1),
									function (pathedPatId) {
										var x = A2(
											_elm_lang$core$Maybe$withDefault,
											'???',
											A2(_elm_lang$core$Dict$get, pathedPatId, scopeGraph.idents));
										return f(
											A2(
												_user$project$DependenceGraph$defineVarNode,
												_user$project$DependenceGraph$varNode(pathedPatId),
												x));
									}),
								_1: {
									ctor: '::',
									_0: {
										ctor: '::',
										_0: f('}'),
										_1: {ctor: '[]'}
									},
									_1: {ctor: '[]'}
								}
							}
						}
					});
			});
	});
var _user$project$DependenceGraph$dependencyEdges = F2(
	function (f, scopeGraph) {
		return A3(
			_elm_lang$core$Basics$flip,
			_elm_lang$core$List$concatMap,
			_elm_lang$core$Dict$toList(scopeGraph.dependencies),
			function (_p38) {
				var _p39 = _p38;
				return A3(
					_elm_lang$core$Basics$flip,
					_elm_lang$core$List$map,
					_elm_lang$core$Set$toList(_p39._1),
					function (pTarget) {
						return f(
							A2(
								_elm_lang$core$Basics_ops['++'],
								_user$project$DependenceGraph$varNode(_p39._0),
								A2(
									_elm_lang$core$Basics_ops['++'],
									' -> ',
									_user$project$DependenceGraph$varNode(pTarget))));
					});
			});
	});
var _user$project$DependenceGraph$print = F4(
	function (overall, combine, f, scopeGraph) {
		var nodes = A2(_user$project$DependenceGraph$clusters, f, scopeGraph);
		var edges1 = A2(_user$project$DependenceGraph$scopeEdges, f, scopeGraph);
		var edges2 = A2(_user$project$DependenceGraph$dependencyEdges, f, scopeGraph);
		return overall(
			combine(
				_elm_lang$core$List$concat(
					{
						ctor: '::',
						_0: {
							ctor: '::',
							_0: f('digraph scopeGraph {'),
							_1: {ctor: '[]'}
						},
						_1: {
							ctor: '::',
							_0: nodes,
							_1: {
								ctor: '::',
								_0: edges1,
								_1: {
									ctor: '::',
									_0: edges2,
									_1: {
										ctor: '::',
										_0: {
											ctor: '::',
											_0: f('}'),
											_1: {ctor: '[]'}
										},
										_1: {ctor: '[]'}
									}
								}
							}
						}
					})));
	});
var _user$project$DependenceGraph$printHtml = A3(
	_user$project$DependenceGraph$print,
	_elm_lang$html$Html$div(
		{ctor: '[]'}),
	_elm_lang$core$List$intersperse(
		A2(
			_elm_lang$html$Html$br,
			{ctor: '[]'},
			{ctor: '[]'})),
	_elm_lang$html$Html$text);
var _user$project$DependenceGraph$printString = A3(_user$project$DependenceGraph$print, _elm_lang$core$Basics$identity, _user$project$Utils$lines, _elm_lang$core$Basics$identity);
var _user$project$DependenceGraph$childScopesOf = F2(
	function (i, sg) {
		return A2(_user$project$Utils$dictGetSet, i, sg.children);
	});
var _user$project$DependenceGraph$usedOnTheWayDownTo = F4(
	function (scopeGraph, sourcePat, targetScope, includingTarget) {
		var traverseDown = function (currentScope) {
			var usedHere = function (_p40) {
				var _p41 = _p40;
				return A2(
					_elm_lang$core$Set$member,
					sourcePat,
					A2(_user$project$Utils$dictGetSet, currentScope, scopeGraph.dependenciesSP));
			};
			if (_elm_lang$core$Native_Utils.eq(currentScope, targetScope) && (!includingTarget)) {
				return false;
			} else {
				if (_elm_lang$core$Native_Utils.eq(currentScope, targetScope)) {
					return usedHere(
						{ctor: '_Tuple0'});
				} else {
					if (usedHere(
						{ctor: '_Tuple0'})) {
						return true;
					} else {
						var children = _elm_lang$core$Set$toList(
							A2(_user$project$DependenceGraph$childScopesOf, currentScope, scopeGraph));
						return A2(_elm_lang$core$List$any, traverseDown, children);
					}
				}
			}
		};
		var sourceScope = _elm_lang$core$Tuple$first(sourcePat);
		return traverseDown(sourceScope);
	});
var _user$project$DependenceGraph$parentScopeOf = F2(
	function (i, sg) {
		return A3(
			_user$project$Utils$justGet_,
			A2(
				_elm_lang$core$Basics_ops['++'],
				'parentScopeOf ',
				_elm_lang$core$Basics$toString(i)),
			i,
			sg.parents);
	});
var _user$project$DependenceGraph$pathToRoot = F2(
	function (sg, scopeId) {
		return _elm_lang$core$Native_Utils.eq(scopeId, _user$project$DependenceGraph$rootId) ? {
			ctor: '::',
			_0: _user$project$DependenceGraph$rootId,
			_1: {ctor: '[]'}
		} : {
			ctor: '::',
			_0: scopeId,
			_1: A2(
				_user$project$DependenceGraph$pathToRoot,
				sg,
				A2(_user$project$DependenceGraph$parentScopeOf, scopeId, sg))
		};
	});
var _user$project$DependenceGraph$pathFromRoot = F2(
	function (sg, scopeId) {
		return _elm_lang$core$List$reverse(
			A2(_user$project$DependenceGraph$pathToRoot, sg, scopeId));
	});
var _user$project$DependenceGraph$renderDotGraph = _elm_lang$core$Native_Platform.outgoingPort(
	'renderDotGraph',
	function (v) {
		return v;
	});
var _user$project$DependenceGraph$render = function (_p42) {
	return _user$project$DependenceGraph$renderDotGraph(
		_user$project$DependenceGraph$printString(_p42));
};
var _user$project$DependenceGraph$receiveImage = _elm_lang$core$Native_Platform.incomingPort('receiveImage', _elm_lang$core$Json_Decode$string);
var _user$project$DependenceGraph$ScopeGraph = function (a) {
	return function (b) {
		return function (c) {
			return function (d) {
				return function (e) {
					return function (f) {
						return function (g) {
							return function (h) {
								return function (i) {
									return function (j) {
										return function (k) {
											return {scopeNodes: a, idents: b, parents: c, children: d, dependencies: e, dependenciesPS: f, dependenciesSP: g, dependenciesSS: h, varBindingsBefore: i, varBindingsAfter: j, usedVars: k};
										};
									};
								};
							};
						};
					};
				};
			};
		};
	};
};
var _user$project$DependenceGraph$Env = F3(
	function (a, b, c) {
		return {currentScope: a, currentScopes: b, varBindings: c};
	});
var _user$project$DependenceGraph$NearestCommonAncestor = function (a) {
	return {ctor: 'NearestCommonAncestor', _0: a};
};
var _user$project$DependenceGraph$ChildScope = {ctor: 'ChildScope'};
var _user$project$DependenceGraph$ParentScope = {ctor: 'ParentScope'};
var _user$project$DependenceGraph$SameScope = {ctor: 'SameScope'};
var _user$project$DependenceGraph$scopeOrder = F3(
	function (sg, i, j) {
		var walk = F3(
			function (lastCommonAncestor, path1, path2) {
				walk:
				while (true) {
					var _p43 = {ctor: '_Tuple2', _0: path1, _1: path2};
					if (_p43._0.ctor === '::') {
						if (_p43._1.ctor === '::') {
							var _p44 = _p43._0._0;
							if (_elm_lang$core$Native_Utils.eq(_p44, _p43._1._0)) {
								var _v31 = _p44,
									_v32 = _p43._0._1,
									_v33 = _p43._1._1;
								lastCommonAncestor = _v31;
								path1 = _v32;
								path2 = _v33;
								continue walk;
							} else {
								if (_elm_lang$core$Native_Utils.eq(lastCommonAncestor, i)) {
									return _user$project$DependenceGraph$ParentScope;
								} else {
									if (_elm_lang$core$Native_Utils.eq(lastCommonAncestor, j)) {
										return _user$project$DependenceGraph$ChildScope;
									} else {
										return _user$project$DependenceGraph$NearestCommonAncestor(lastCommonAncestor);
									}
								}
							}
						} else {
							return _elm_lang$core$Native_Utils.eq(lastCommonAncestor, j) ? _user$project$DependenceGraph$ChildScope : _user$project$DependenceGraph$NearestCommonAncestor(lastCommonAncestor);
						}
					} else {
						if (_p43._1.ctor === '::') {
							return _elm_lang$core$Native_Utils.eq(lastCommonAncestor, i) ? _user$project$DependenceGraph$ParentScope : _user$project$DependenceGraph$NearestCommonAncestor(lastCommonAncestor);
						} else {
							return A2(_elm_lang$core$Debug$log, 'WARN: SameScope should\'ve been detected already', _user$project$DependenceGraph$SameScope);
						}
					}
				}
			});
		if (_elm_lang$core$Native_Utils.eq(i, j)) {
			return _user$project$DependenceGraph$SameScope;
		} else {
			var jPath = A2(
				_elm_lang$core$List$drop,
				1,
				A2(_user$project$DependenceGraph$pathFromRoot, sg, j));
			var iPath = A2(
				_elm_lang$core$List$drop,
				1,
				A2(_user$project$DependenceGraph$pathFromRoot, sg, i));
			return A3(walk, _user$project$DependenceGraph$rootId, iPath, jPath);
		}
	});
var _user$project$DependenceGraph$checkVisible = F4(
	function (scopeGraph, x, sourcePat, targetId) {
		var nothing = {ctor: '[]'};
		var just = function (x) {
			return {
				ctor: '::',
				_0: x,
				_1: {ctor: '[]'}
			};
		};
		var _p45 = sourcePat;
		var sourceId = _p45._0;
		var xBindingsAfterSource = A2(
			_elm_lang$core$Maybe$withDefault,
			{ctor: '[]'},
			A2(
				_elm_lang$core$Dict$get,
				x,
				A2(
					_elm_lang$core$Maybe$withDefault,
					_elm_lang$core$Dict$empty,
					A2(_elm_lang$core$Dict$get, sourceId, scopeGraph.varBindingsAfter))));
		var xBindingsBeforeTarget = A2(
			_elm_lang$core$Maybe$withDefault,
			{ctor: '[]'},
			A2(
				_elm_lang$core$Dict$get,
				x,
				A2(
					_elm_lang$core$Maybe$withDefault,
					_elm_lang$core$Dict$empty,
					A2(_elm_lang$core$Dict$get, targetId, scopeGraph.varBindingsBefore))));
		var capturedBy1 = function () {
			var _p46 = xBindingsAfterSource;
			if (_p46.ctor === '[]') {
				return _elm_lang$core$Native_Utils.crashCase(
					'DependenceGraph',
					{
						start: {line: 422, column: 5},
						end: {line: 441, column: 24}
					},
					_p46)('blah');
			} else {
				if (!_elm_lang$core$Native_Utils.eq(_p46._0, sourcePat)) {
					return nothing;
				} else {
					var _p48 = _p46._1;
					if (_p48.ctor === '[]') {
						return nothing;
					} else {
						var _p50 = _p48._0;
						var _p49 = A3(
							_user$project$DependenceGraph$scopeOrder,
							scopeGraph,
							targetId,
							_elm_lang$core$Tuple$first(_p50));
						switch (_p49.ctor) {
							case 'ChildScope':
								return nothing;
							case 'ParentScope':
								return just(
									{ctor: '_Tuple2', _0: sourcePat, _1: _p50});
							case 'SameScope':
								return just(
									{ctor: '_Tuple2', _0: sourcePat, _1: _p50});
							default:
								return nothing;
						}
					}
				}
			}
		}();
		var capturedBy2 = function () {
			var _p51 = xBindingsBeforeTarget;
			if (_p51.ctor === '[]') {
				return nothing;
			} else {
				var _p52 = _p51._0;
				return _elm_lang$core$Native_Utils.eq(sourcePat, _p52) ? nothing : just(
					{ctor: '_Tuple2', _0: _p52, _1: sourcePat});
			}
		}();
		var scopeIssues = A2(_elm_lang$core$Basics_ops['++'], capturedBy1, capturedBy2);
		return _elm_lang$core$Native_Utils.eq(
			scopeIssues,
			{ctor: '[]'}) ? '' : '[WARN shadowing] ';
	});

var _user$project$LangTools$tryMatchExpPatToPaths_ = F2(
	function (pat, exp) {
		var thisMatch = {
			ctor: '_Tuple2',
			_0: {ctor: '[]'},
			_1: exp
		};
		var addThisMatch = function (matchResult) {
			return A2(
				_elm_lang$core$Maybe$map,
				F2(
					function (x, y) {
						return {ctor: '::', _0: x, _1: y};
					})(thisMatch),
				matchResult);
		};
		var prependPath = F2(
			function (i, _p0) {
				var _p1 = _p0;
				return {
					ctor: '_Tuple2',
					_0: {ctor: '::', _0: i, _1: _p1._0},
					_1: _p1._1
				};
			});
		var prependPathToAll = F2(
			function (i, pathAndExps) {
				return A2(
					_elm_lang$core$List$map,
					prependPath(i),
					pathAndExps);
			});
		var matchListsAsFarAsPossible = F2(
			function (ps, es) {
				return A2(
					_elm_lang$core$Maybe$map,
					_elm_lang$core$List$concat,
					_user$project$Utils$projJusts(
						A2(
							_user$project$Utils$mapi1,
							function (_p2) {
								var _p3 = _p2;
								return A2(
									_elm_lang$core$Maybe$map,
									prependPathToAll(_p3._0),
									A2(_user$project$LangTools$tryMatchExpPatToPaths_, _p3._1._0, _p3._1._1));
							},
							A2(_user$project$Utils$zip, ps, es))));
			});
		var _p4 = pat.val.p__;
		switch (_p4.ctor) {
			case 'PVar':
				return _elm_lang$core$Maybe$Just(
					{
						ctor: '::',
						_0: thisMatch,
						_1: {ctor: '[]'}
					});
			case 'PAs':
				return addThisMatch(
					A2(
						_elm_lang$core$Maybe$map,
						prependPathToAll(1),
						A2(_user$project$LangTools$tryMatchExpPatToPaths_, _p4._3, exp)));
			case 'PList':
				if (_p4._3.ctor === 'Nothing') {
					var _p8 = _p4._1;
					var _p5 = exp.val.e__;
					if (_p5.ctor === 'EList') {
						if (_p5._3.ctor === 'Nothing') {
							var _p6 = _p5._1;
							return (!_elm_lang$core$Native_Utils.eq(
								_elm_lang$core$List$length(_p8),
								_elm_lang$core$List$length(_p6))) ? _elm_lang$core$Maybe$Nothing : addThisMatch(
								A2(matchListsAsFarAsPossible, _p8, _p6));
						} else {
							var _p7 = _p5._1;
							return (_elm_lang$core$Native_Utils.cmp(
								_elm_lang$core$List$length(_p7),
								_elm_lang$core$List$length(_p8)) > 0) ? _elm_lang$core$Maybe$Nothing : addThisMatch(
								A2(matchListsAsFarAsPossible, _p8, _p7));
						}
					} else {
						return _elm_lang$core$Maybe$Just(
							{
								ctor: '::',
								_0: thisMatch,
								_1: {ctor: '[]'}
							});
					}
				} else {
					var _p12 = _p4._1;
					var _p9 = exp.val.e__;
					if (_p9.ctor === 'EList') {
						if (_p9._3.ctor === 'Nothing') {
							var _p10 = _p9._1;
							return (_elm_lang$core$Native_Utils.cmp(
								_elm_lang$core$List$length(_p10),
								_elm_lang$core$List$length(_p12)) < 0) ? _elm_lang$core$Maybe$Nothing : addThisMatch(
								A2(matchListsAsFarAsPossible, _p12, _p10));
						} else {
							var _p11 = _p9._1;
							return (!_elm_lang$core$Native_Utils.eq(
								_elm_lang$core$List$length(_p11),
								_elm_lang$core$List$length(_p12))) ? addThisMatch(
								A2(matchListsAsFarAsPossible, _p12, _p11)) : addThisMatch(
								A2(
									matchListsAsFarAsPossible,
									A2(
										_elm_lang$core$Basics_ops['++'],
										_p12,
										{
											ctor: '::',
											_0: _p4._3._0,
											_1: {ctor: '[]'}
										}),
									A2(
										_elm_lang$core$Basics_ops['++'],
										_p11,
										{
											ctor: '::',
											_0: _p9._3._0,
											_1: {ctor: '[]'}
										})));
						}
					} else {
						return _elm_lang$core$Maybe$Just(
							{
								ctor: '::',
								_0: thisMatch,
								_1: {ctor: '[]'}
							});
					}
				}
			case 'PConst':
				var _p13 = exp.val.e__;
				if (_p13.ctor === 'EConst') {
					return _elm_lang$core$Native_Utils.eq(_p4._1, _p13._1) ? _elm_lang$core$Maybe$Just(
						{
							ctor: '::',
							_0: thisMatch,
							_1: {ctor: '[]'}
						}) : _elm_lang$core$Maybe$Nothing;
				} else {
					return _elm_lang$core$Maybe$Just(
						{
							ctor: '::',
							_0: thisMatch,
							_1: {ctor: '[]'}
						});
				}
			default:
				var _p14 = exp.val.e__;
				if (_p14.ctor === 'EBase') {
					return A2(_user$project$Lang$eBaseValsEqual, _p4._1, _p14._1) ? _elm_lang$core$Maybe$Just(
						{
							ctor: '::',
							_0: thisMatch,
							_1: {ctor: '[]'}
						}) : _elm_lang$core$Maybe$Nothing;
				} else {
					return _elm_lang$core$Maybe$Just(
						{
							ctor: '::',
							_0: thisMatch,
							_1: {ctor: '[]'}
						});
				}
		}
	});
var _user$project$LangTools$tryMatchExpPatToPaths = F2(
	function (pat, exp) {
		return A2(
			_elm_lang$core$Maybe$withDefault,
			{ctor: '[]'},
			A2(_user$project$LangTools$tryMatchExpPatToPaths_, pat, exp));
	});
var _user$project$LangTools$tryMatchExpsPatsToPathsAtFunctionCall = F2(
	function (pats, exps) {
		return _elm_lang$core$List$concat(
			A2(
				_elm_lang$core$Maybe$withDefault,
				{ctor: '[]'},
				_user$project$Utils$projJusts(
					A2(
						_user$project$Utils$mapi1,
						function (_p15) {
							var _p16 = _p15;
							return A2(
								_elm_lang$core$Maybe$map,
								function (pathAndExps) {
									return A2(
										_elm_lang$core$List$map,
										function (_p17) {
											var _p18 = _p17;
											return {
												ctor: '_Tuple2',
												_0: {ctor: '::', _0: _p16._0, _1: _p18._0},
												_1: _p18._1
											};
										},
										pathAndExps);
								},
								A2(_user$project$LangTools$tryMatchExpPatToPaths_, _p16._1._0, _p16._1._1));
						},
						A2(_user$project$Utils$zip, pats, exps)))));
	});
var _user$project$LangTools$expPathsInExpList = function (exps) {
	return _elm_lang$core$List$concat(
		A2(
			_user$project$Utils$mapi1,
			function (_p19) {
				var _p20 = _p19;
				var _p25 = _p20._0;
				var _p24 = _p20._1;
				var _p21 = _p24.val.e__;
				if (_p21.ctor === 'EList') {
					return A2(
						_elm_lang$core$Basics_ops['++'],
						{
							ctor: '::',
							_0: {
								ctor: '_Tuple2',
								_0: _p24,
								_1: {
									ctor: '::',
									_0: _p25,
									_1: {ctor: '[]'}
								}
							},
							_1: {ctor: '[]'}
						},
						A2(
							_elm_lang$core$List$map,
							function (_p22) {
								var _p23 = _p22;
								return {
									ctor: '_Tuple2',
									_0: _p23._0,
									_1: {ctor: '::', _0: _p25, _1: _p23._1}
								};
							},
							_user$project$LangTools$expPathsInExpList(_p21._1)));
				} else {
					return {
						ctor: '::',
						_0: {
							ctor: '_Tuple2',
							_0: _p24,
							_1: {
								ctor: '::',
								_0: _p25,
								_1: {ctor: '[]'}
							}
						},
						_1: {ctor: '[]'}
					};
				}
			},
			exps));
};
var _user$project$LangTools$eidPathInExpList = F2(
	function (exps, targetEId) {
		return A2(
			_user$project$Utils$mapFirstSuccess,
			function (_p26) {
				var _p27 = _p26;
				return _elm_lang$core$Native_Utils.eq(_p27._0.val.eid, targetEId) ? _elm_lang$core$Maybe$Just(_p27._1) : _elm_lang$core$Maybe$Nothing;
			},
			_user$project$LangTools$expPathsInExpList(exps));
	});
var _user$project$LangTools$followPathInPat = F2(
	function (path, pat) {
		followPathInPat:
		while (true) {
			var _p28 = {ctor: '_Tuple2', _0: pat.val.p__, _1: path};
			_v13_4:
			do {
				if (_p28.ctor === '_Tuple2') {
					if (_p28._1.ctor === '[]') {
						return _elm_lang$core$Maybe$Just(pat);
					} else {
						switch (_p28._0.ctor) {
							case 'PAs':
								if (_p28._1._0 === 1) {
									var _v14 = _p28._1._1,
										_v15 = _p28._0._3;
									path = _v14;
									pat = _v15;
									continue followPathInPat;
								} else {
									break _v13_4;
								}
							case 'PList':
								if (_p28._0._3.ctor === 'Nothing') {
									return A2(
										_elm_lang$core$Maybe$andThen,
										function (p) {
											return A2(_user$project$LangTools$followPathInPat, _p28._1._1, p);
										},
										A2(_user$project$Utils$maybeGeti1, _p28._1._0, _p28._0._1));
								} else {
									return A2(
										_elm_lang$core$Maybe$andThen,
										function (p) {
											return A2(_user$project$LangTools$followPathInPat, _p28._1._1, p);
										},
										A2(
											_user$project$Utils$maybeGeti1,
											_p28._1._0,
											A2(
												_elm_lang$core$Basics_ops['++'],
												_p28._0._1,
												{
													ctor: '::',
													_0: _p28._0._3._0,
													_1: {ctor: '[]'}
												})));
								}
							default:
								break _v13_4;
						}
					}
				} else {
					break _v13_4;
				}
			} while(false);
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$LangTools$findScopeExpAndPatByPathedPatternId = F2(
	function (_p29, exp) {
		var _p30 = _p29;
		var _p33 = _p30._1;
		var maybeScopeExp = A2(_user$project$Lang$findExpByEId, exp, _p30._0._0);
		var maybePat = function () {
			var _p32 = {
				ctor: '_Tuple2',
				_0: A2(
					_elm_lang$core$Maybe$map,
					function (_p31) {
						return function (_) {
							return _.e__;
						}(
							function (_) {
								return _.val;
							}(_p31));
					},
					maybeScopeExp),
				_1: _p33
			};
			_v17_3:
			do {
				if ((_p32.ctor === '_Tuple2') && (_p32._0.ctor === 'Just')) {
					switch (_p32._0._0.ctor) {
						case 'ELet':
							return A2(_user$project$LangTools$followPathInPat, _p33, _p32._0._0._3);
						case 'EFun':
							if (_p32._1.ctor === '::') {
								return A2(
									_elm_lang$core$Maybe$andThen,
									function (pat) {
										return A2(_user$project$LangTools$followPathInPat, _p32._1._1, pat);
									},
									A2(_user$project$Utils$maybeGeti1, _p32._1._0, _p32._0._0._1));
							} else {
								break _v17_3;
							}
						case 'ECase':
							return A2(
								_elm_lang$core$Maybe$andThen,
								function (pat) {
									return A2(_user$project$LangTools$followPathInPat, _p33, pat);
								},
								A2(
									_user$project$Utils$maybeGeti1,
									_p30._0._1,
									_user$project$Lang$branchPats(_p32._0._0._2)));
						default:
							break _v17_3;
					}
				} else {
					break _v17_3;
				}
			} while(false);
			return _elm_lang$core$Maybe$Nothing;
		}();
		return A2(
			_elm_lang$core$Maybe$map,
			function (pat) {
				return {
					ctor: '_Tuple2',
					_0: _user$project$Utils$fromJust(maybeScopeExp),
					_1: pat
				};
			},
			maybePat);
	});
var _user$project$LangTools$findPatByPathedPatternId = F2(
	function (pathedPatId, exp) {
		return A2(
			_elm_lang$core$Maybe$map,
			_elm_lang$core$Tuple$second,
			A2(_user$project$LangTools$findScopeExpAndPatByPathedPatternId, pathedPatId, exp));
	});
var _user$project$LangTools$pathedPatternIdToPId = F2(
	function (pathedPatId, exp) {
		return A2(
			_elm_lang$core$Maybe$map,
			function (_p34) {
				return function (_) {
					return _.pid;
				}(
					function (_) {
						return _.val;
					}(_p34));
			},
			A2(_user$project$LangTools$findPatByPathedPatternId, pathedPatId, exp));
	});
var _user$project$LangTools$findPatInPat = F2(
	function (targetPId, pat) {
		return A2(
			_user$project$Utils$findFirst,
			function (_p35) {
				return A2(
					F2(
						function (x, y) {
							return _elm_lang$core$Native_Utils.eq(x, y);
						}),
					targetPId,
					function (_) {
						return _.pid;
					}(
						function (_) {
							return _.val;
						}(_p35)));
			},
			_user$project$Lang$flattenPatTree(pat));
	});
var _user$project$LangTools$findScopeExpAndPat = F2(
	function (targetPId, exp) {
		return A2(
			_user$project$Lang$mapFirstSuccessNode,
			function (e) {
				var maybeTargetPat = function () {
					var _p36 = e.val.e__;
					switch (_p36.ctor) {
						case 'ELet':
							return A2(_user$project$LangTools$findPatInPat, targetPId, _p36._3);
						case 'EFun':
							return A2(
								_user$project$Utils$mapFirstSuccess,
								_user$project$LangTools$findPatInPat(targetPId),
								_p36._1);
						case 'ECase':
							return A2(
								_user$project$Utils$mapFirstSuccess,
								_user$project$LangTools$findPatInPat(targetPId),
								_user$project$Lang$branchPats(_p36._2));
						default:
							return _elm_lang$core$Maybe$Nothing;
					}
				}();
				return A2(
					_elm_lang$core$Maybe$map,
					function (pat) {
						return {ctor: '_Tuple2', _0: e, _1: pat};
					},
					maybeTargetPat);
			},
			exp);
	});
var _user$project$LangTools$findScopeAreas = F2(
	function (_p37, exp) {
		var _p38 = _p37;
		var maybeScopeExp = A2(_user$project$Lang$findExpByEId, exp, _p38._0);
		var _p40 = A2(
			_elm_lang$core$Maybe$map,
			function (_p39) {
				return function (_) {
					return _.e__;
				}(
					function (_) {
						return _.val;
					}(_p39));
			},
			maybeScopeExp);
		_v20_3:
		do {
			if (_p40.ctor === 'Just') {
				switch (_p40._0.ctor) {
					case 'ELet':
						var _p41 = _p40._0._5;
						return _p40._0._2 ? {
							ctor: '::',
							_0: _p40._0._4,
							_1: {
								ctor: '::',
								_0: _p41,
								_1: {ctor: '[]'}
							}
						} : {
							ctor: '::',
							_0: _p41,
							_1: {ctor: '[]'}
						};
					case 'EFun':
						return {
							ctor: '::',
							_0: _p40._0._2,
							_1: {ctor: '[]'}
						};
					case 'ECase':
						return A2(
							_elm_lang$core$Maybe$withDefault,
							{ctor: '[]'},
							A2(
								_elm_lang$core$Maybe$map,
								function (branch) {
									return {
										ctor: '::',
										_0: branch,
										_1: {ctor: '[]'}
									};
								},
								A2(
									_user$project$Utils$maybeGeti1,
									_p38._1,
									_user$project$Lang$branchExps(_p40._0._2))));
					default:
						break _v20_3;
				}
			} else {
				break _v20_3;
			}
		} while(false);
		return {ctor: '[]'};
	});
var _user$project$LangTools$setPatNameInPat = F3(
	function (path, newName, pat) {
		var _p42 = {ctor: '_Tuple2', _0: pat.val.p__, _1: path};
		_v21_5:
		do {
			if (_p42.ctor === '_Tuple2') {
				if (_p42._1.ctor === '[]') {
					switch (_p42._0.ctor) {
						case 'PVar':
							return A2(
								_user$project$Lang$replaceP__,
								pat,
								A3(_user$project$Lang$PVar, _p42._0._0, newName, _p42._0._2));
						case 'PAs':
							return A2(
								_user$project$Lang$replaceP__,
								pat,
								A4(_user$project$Lang$PAs, _p42._0._0, newName, _p42._0._2, _p42._0._3));
						default:
							break _v21_5;
					}
				} else {
					switch (_p42._0.ctor) {
						case 'PAs':
							if (_p42._1._0 === 1) {
								return A2(
									_user$project$Lang$replaceP__,
									pat,
									A4(
										_user$project$Lang$PAs,
										_p42._0._0,
										_p42._0._1,
										_p42._0._2,
										A3(_user$project$LangTools$setPatNameInPat, _p42._1._1, newName, _p42._0._3)));
							} else {
								break _v21_5;
							}
						case 'PList':
							if (_p42._0._3.ctor === 'Nothing') {
								var newPs = A3(
									_user$project$Utils$getReplacei1,
									_p42._1._0,
									A2(_user$project$LangTools$setPatNameInPat, _p42._1._1, newName),
									_p42._0._1);
								return A2(
									_user$project$Lang$replaceP__,
									pat,
									A5(_user$project$Lang$PList, _p42._0._0, newPs, _p42._0._2, _elm_lang$core$Maybe$Nothing, _p42._0._4));
							} else {
								var _p49 = _p42._0._4;
								var _p48 = _p42._0._2;
								var _p47 = _p42._0._0;
								var _p46 = _p42._0._3._0;
								var _p45 = _p42._0._1;
								var _p44 = _p42._1._1;
								var _p43 = _p42._1._0;
								if (_elm_lang$core$Native_Utils.cmp(
									_p43,
									_elm_lang$core$List$length(_p45)) < 1) {
									var newPs = A3(
										_user$project$Utils$getReplacei1,
										_p43,
										A2(_user$project$LangTools$setPatNameInPat, _p44, newName),
										_p45);
									return A2(
										_user$project$Lang$replaceP__,
										pat,
										A5(
											_user$project$Lang$PList,
											_p47,
											newPs,
											_p48,
											_elm_lang$core$Maybe$Just(_p46),
											_p49));
								} else {
									if (_elm_lang$core$Native_Utils.eq(
										_p43,
										_elm_lang$core$List$length(_p45) + 1)) {
										return A2(
											_user$project$Lang$replaceP__,
											pat,
											A5(
												_user$project$Lang$PList,
												_p47,
												_p45,
												_p48,
												_elm_lang$core$Maybe$Just(
													A3(_user$project$LangTools$setPatNameInPat, _p44, newName, _p46)),
												_p49));
									} else {
										return pat;
									}
								}
							}
						default:
							break _v21_5;
					}
				}
			} else {
				break _v21_5;
			}
		} while(false);
		return pat;
	});
var _user$project$LangTools$setPatName = F3(
	function (_p50, newName, exp) {
		var _p51 = _p50;
		var _p61 = _p51._1;
		var _p60 = _p51._0._1;
		var maybeScopeExp = A2(_user$project$Lang$findExpByEId, exp, _p51._0._0);
		var maybeNewScopeExp = function () {
			var makeNewScope = function (e__) {
				return A2(
					_user$project$Lang$replaceE__,
					_user$project$Utils$fromJust(maybeScopeExp),
					e__);
			};
			var _p53 = {
				ctor: '_Tuple2',
				_0: A2(
					_elm_lang$core$Maybe$map,
					function (_p52) {
						return function (_) {
							return _.e__;
						}(
							function (_) {
								return _.val;
							}(_p52));
					},
					maybeScopeExp),
				_1: _p61
			};
			_v23_3:
			do {
				if ((_p53.ctor === '_Tuple2') && (_p53._0.ctor === 'Just')) {
					switch (_p53._0._0.ctor) {
						case 'ELet':
							var newPat = A3(_user$project$LangTools$setPatNameInPat, _p61, newName, _p53._0._0._3);
							return _elm_lang$core$Maybe$Just(
								makeNewScope(
									A7(_user$project$Lang$ELet, _p53._0._0._0, _p53._0._0._1, _p53._0._0._2, newPat, _p53._0._0._4, _p53._0._0._5, _p53._0._0._6)));
						case 'EFun':
							if (_p53._1.ctor === '::') {
								var _p55 = _p53._0._0._1;
								var _p54 = _p53._1._0;
								return A2(
									_elm_lang$core$Maybe$map,
									function (pat) {
										var newPat = A3(_user$project$LangTools$setPatNameInPat, _p53._1._1, newName, pat);
										return makeNewScope(
											A4(
												_user$project$Lang$EFun,
												_p53._0._0._0,
												A3(_user$project$Utils$replacei, _p54, newPat, _p55),
												_p53._0._0._2,
												_p53._0._0._3));
									},
									A2(_user$project$Utils$maybeGeti1, _p54, _p55));
							} else {
								break _v23_3;
							}
						case 'ECase':
							var _p57 = _p53._0._0._2;
							return A2(
								_elm_lang$core$Maybe$map,
								function (branch) {
									var _p56 = branch.val;
									var ws1 = _p56._0;
									var pat = _p56._1;
									var exp = _p56._2;
									var ws2 = _p56._3;
									var newPat = A3(_user$project$LangTools$setPatNameInPat, _p61, newName, pat);
									var newBranch = _elm_lang$core$Native_Utils.update(
										branch,
										{
											val: A4(_user$project$Lang$Branch_, ws1, newPat, exp, ws2)
										});
									return makeNewScope(
										A4(
											_user$project$Lang$ECase,
											ws1,
											_p53._0._0._1,
											A3(_user$project$Utils$replacei, _p60, newBranch, _p57),
											ws2));
								},
								A2(_user$project$Utils$maybeGeti1, _p60, _p57));
						default:
							break _v23_3;
					}
				} else {
					break _v23_3;
				}
			} while(false);
			return _elm_lang$core$Maybe$Nothing;
		}();
		var _p58 = maybeNewScopeExp;
		if (_p58.ctor === 'Just') {
			var _p59 = _p58._0;
			return A3(_user$project$Lang$replaceExpNode, _p59.val.eid, _p59, exp);
		} else {
			return exp;
		}
	});
var _user$project$LangTools$renameIdentifiersInPat = F2(
	function (subst, pat) {
		var recurse = _user$project$LangTools$renameIdentifiersInPat(subst);
		var recurseList = _elm_lang$core$List$map(recurse);
		var pat__ = function () {
			var _p62 = pat.val.p__;
			switch (_p62.ctor) {
				case 'PVar':
					var _p63 = A2(_elm_lang$core$Dict$get, _p62._1, subst);
					if (_p63.ctor === 'Just') {
						return A3(_user$project$Lang$PVar, _p62._0, _p63._0, _p62._2);
					} else {
						return pat.val.p__;
					}
				case 'PList':
					if (_p62._3.ctor === 'Nothing') {
						return A5(
							_user$project$Lang$PList,
							_p62._0,
							recurseList(_p62._1),
							_p62._2,
							_elm_lang$core$Maybe$Nothing,
							_p62._4);
					} else {
						return A5(
							_user$project$Lang$PList,
							_p62._0,
							recurseList(_p62._1),
							_p62._2,
							_elm_lang$core$Maybe$Just(
								recurse(_p62._3._0)),
							_p62._4);
					}
				case 'PAs':
					var _p68 = _p62._2;
					var _p67 = _p62._0;
					var _p66 = _p62._3;
					var _p65 = _p62._1;
					var _p64 = A2(_elm_lang$core$Dict$get, _p65, subst);
					if (_p64.ctor === 'Just') {
						return A4(
							_user$project$Lang$PAs,
							_p67,
							_p64._0,
							_p68,
							recurse(_p66));
					} else {
						return A4(
							_user$project$Lang$PAs,
							_p67,
							_p65,
							_p68,
							recurse(_p66));
					}
				default:
					return pat.val.p__;
			}
		}();
		return A2(_user$project$Lang$replaceP__, pat, pat__);
	});
var _user$project$LangTools$renameIdentifiersInPats = F2(
	function (subst, pats) {
		return A2(
			_elm_lang$core$List$map,
			_user$project$LangTools$renameIdentifiersInPat(subst),
			pats);
	});
var _user$project$LangTools$renameIdentifiers = F2(
	function (subst, exp) {
		var exp__Renamer = function (e__) {
			var _p69 = e__;
			switch (_p69.ctor) {
				case 'EVar':
					var _p70 = A2(_elm_lang$core$Dict$get, _p69._1, subst);
					if (_p70.ctor === 'Just') {
						return A2(_user$project$Lang$EVar, _p69._0, _p70._0);
					} else {
						return e__;
					}
				case 'EFun':
					return A4(
						_user$project$Lang$EFun,
						_p69._0,
						A2(_user$project$LangTools$renameIdentifiersInPats, subst, _p69._1),
						_p69._2,
						_p69._3);
				case 'ECase':
					var branches_ = A2(
						_elm_lang$core$List$map,
						_user$project$Lang$mapValField(
							function (_p71) {
								var _p72 = _p71;
								return A4(
									_user$project$Lang$Branch_,
									_p72._0,
									A2(_user$project$LangTools$renameIdentifiersInPat, subst, _p72._1),
									_p72._2,
									_p72._3);
							}),
						_p69._2);
					return A4(_user$project$Lang$ECase, _p69._0, _p69._1, branches_, _p69._3);
				case 'ELet':
					return A7(
						_user$project$Lang$ELet,
						_p69._0,
						_p69._1,
						_p69._2,
						A2(_user$project$LangTools$renameIdentifiersInPat, subst, _p69._3),
						_p69._4,
						_p69._5,
						_p69._6);
				default:
					return e__;
			}
		};
		return A2(_user$project$Lang$mapExpViaExp__, exp__Renamer, exp);
	});
var _user$project$LangTools$renameIdentifier = F3(
	function (old, $new, exp) {
		return A2(
			_user$project$LangTools$renameIdentifiers,
			A2(_elm_lang$core$Dict$singleton, old, $new),
			exp);
	});
var _user$project$LangTools$renameIdentifierInPat = F3(
	function (old, $new, pat) {
		return A2(
			_user$project$LangTools$renameIdentifiersInPat,
			A2(_elm_lang$core$Dict$singleton, old, $new),
			pat);
	});
var _user$project$LangTools$renameIdentifierInPats = F3(
	function (old, $new, pats) {
		return A2(
			_elm_lang$core$List$map,
			A2(_user$project$LangTools$renameIdentifierInPat, old, $new),
			pats);
	});
var _user$project$LangTools$nonCollidingNames = F3(
	function (suggestedNames, i, existingNames) {
		nonCollidingNames:
		while (true) {
			var plainSuggestedNames = A2(
				_elm_lang$core$List$map,
				A2(_user$project$Utils$stringReplace, '{n}', ''),
				suggestedNames);
			if (!_user$project$Utils$anyOverlap(
				{
					ctor: '::',
					_0: existingNames,
					_1: {
						ctor: '::',
						_0: _elm_lang$core$Set$fromList(plainSuggestedNames),
						_1: {ctor: '[]'}
					}
				})) {
				return plainSuggestedNames;
			} else {
				var newNames = A2(
					_elm_lang$core$List$map,
					function (name) {
						return A2(_elm_lang$core$String$contains, '{n}', name) ? A3(
							_user$project$Utils$stringReplace,
							'{n}',
							_elm_lang$core$Basics$toString(i),
							name) : A2(
							_elm_lang$core$Basics_ops['++'],
							name,
							_elm_lang$core$Basics$toString(i));
					},
					suggestedNames);
				if (!_user$project$Utils$anyOverlap(
					{
						ctor: '::',
						_0: existingNames,
						_1: {
							ctor: '::',
							_0: _elm_lang$core$Set$fromList(newNames),
							_1: {ctor: '[]'}
						}
					})) {
					return newNames;
				} else {
					var _v31 = suggestedNames,
						_v32 = i + 1,
						_v33 = existingNames;
					suggestedNames = _v31;
					i = _v32;
					existingNames = _v33;
					continue nonCollidingNames;
				}
			}
		}
	});
var _user$project$LangTools$nonCollidingName = F3(
	function (suggestedName, i, existingNames) {
		return A2(
			_user$project$Utils$head,
			'LangTools.nonCollidingNames did not satisfy its invariant',
			A3(
				_user$project$LangTools$nonCollidingNames,
				{
					ctor: '::',
					_0: suggestedName,
					_1: {ctor: '[]'}
				},
				i,
				existingNames));
	});
var _user$project$LangTools$identifiersListInPat = function (pat) {
	var _p73 = pat.val.p__;
	switch (_p73.ctor) {
		case 'PVar':
			return {
				ctor: '::',
				_0: _p73._1,
				_1: {ctor: '[]'}
			};
		case 'PList':
			if (_p73._3.ctor === 'Just') {
				return A2(
					_elm_lang$core$List$concatMap,
					_user$project$LangTools$identifiersListInPat,
					{ctor: '::', _0: _p73._3._0, _1: _p73._1});
			} else {
				return A2(_elm_lang$core$List$concatMap, _user$project$LangTools$identifiersListInPat, _p73._1);
			}
		case 'PAs':
			return {
				ctor: '::',
				_0: _p73._1,
				_1: _user$project$LangTools$identifiersListInPat(_p73._3)
			};
		default:
			return {ctor: '[]'};
	}
};
var _user$project$LangTools$identifiersListInPats = function (pats) {
	return A2(_elm_lang$core$List$concatMap, _user$project$LangTools$identifiersListInPat, pats);
};
var _user$project$LangTools$findScopeAreasByIdent = F2(
	function (ident, exp) {
		return A2(
			_elm_lang$core$List$concatMap,
			function (e) {
				var _p74 = e.val.e__;
				switch (_p74.ctor) {
					case 'ELet':
						var _p75 = _p74._5;
						return A2(
							_elm_lang$core$List$member,
							ident,
							_user$project$LangTools$identifiersListInPat(_p74._3)) ? (_p74._2 ? {
							ctor: '::',
							_0: _p74._4,
							_1: {
								ctor: '::',
								_0: _p75,
								_1: {ctor: '[]'}
							}
						} : {
							ctor: '::',
							_0: _p75,
							_1: {ctor: '[]'}
						}) : {ctor: '[]'};
					case 'EFun':
						return A2(
							_elm_lang$core$List$member,
							ident,
							_user$project$LangTools$identifiersListInPats(_p74._1)) ? {
							ctor: '::',
							_0: _p74._2,
							_1: {ctor: '[]'}
						} : {ctor: '[]'};
					case 'ECase':
						return A2(
							_elm_lang$core$List$concatMap,
							function (_p76) {
								var _p77 = _p76;
								return A2(
									_elm_lang$core$List$member,
									ident,
									_user$project$LangTools$identifiersListInPat(_p77._0)) ? {
									ctor: '::',
									_0: _p77._1,
									_1: {ctor: '[]'}
								} : {ctor: '[]'};
							},
							_user$project$Lang$branchPatExps(_p74._2));
					default:
						return {ctor: '[]'};
				}
			},
			_user$project$Lang$flattenExpTree(exp));
	});
var _user$project$LangTools$assignUniqueNames_ = F3(
	function (exp, usedNames, oldNameToNewName) {
		var recurse = _user$project$LangTools$assignUniqueNames_;
		var recurseExps = function (es) {
			return A3(
				_elm_lang$core$List$foldl,
				F2(
					function (e, _p78) {
						var _p79 = _p78;
						var _p80 = A3(recurse, e, _p79._1, oldNameToNewName);
						var newE = _p80._0;
						var usedNames_ = _p80._1;
						var newNameToOldName_ = _p80._2;
						return {
							ctor: '_Tuple3',
							_0: A2(
								_elm_lang$core$Basics_ops['++'],
								_p79._0,
								{
									ctor: '::',
									_0: newE,
									_1: {ctor: '[]'}
								}),
							_1: usedNames_,
							_2: A2(_elm_lang$core$Dict$union, newNameToOldName_, _p79._2)
						};
					}),
				{
					ctor: '_Tuple3',
					_0: {ctor: '[]'},
					_1: usedNames,
					_2: _elm_lang$core$Dict$empty
				},
				es);
		};
		var recurseExp = function (e) {
			var _p81 = recurseExps(
				{
					ctor: '::',
					_0: e,
					_1: {ctor: '[]'}
				});
			var newEs = _p81._0;
			var usedNames = _p81._1;
			var newNameToOldName = _p81._2;
			return {
				ctor: '_Tuple3',
				_0: A2(_user$project$Utils$head, 'assignUniqueNames_ head1', newEs),
				_1: usedNames,
				_2: newNameToOldName
			};
		};
		var assignUniqueNamesToPat_ = F2(
			function (pat, usedNames) {
				return A3(
					_elm_lang$core$List$foldl,
					F2(
						function (name, _p82) {
							var _p83 = _p82;
							var _p86 = _p83._1;
							var _p85 = _p83._0;
							var _p84 = _p83._2;
							if (A2(_elm_lang$core$Set$member, name, _p86)) {
								var newName = A3(_user$project$LangTools$nonCollidingName, name, 2, _p86);
								return {
									ctor: '_Tuple3',
									_0: A3(_user$project$LangTools$renameIdentifierInPat, name, newName, _p85),
									_1: A2(_elm_lang$core$Set$insert, newName, _p86),
									_2: A3(_elm_lang$core$Dict$insert, name, newName, _p84)
								};
							} else {
								return {
									ctor: '_Tuple3',
									_0: _p85,
									_1: A2(_elm_lang$core$Set$insert, name, _p86),
									_2: _p84
								};
							}
						}),
					{ctor: '_Tuple3', _0: pat, _1: usedNames, _2: _elm_lang$core$Dict$empty},
					_user$project$LangTools$identifiersListInPat(pat));
			});
		var leafUnchanged = {ctor: '_Tuple3', _0: exp, _1: usedNames, _2: _elm_lang$core$Dict$empty};
		var _p87 = exp.val.e__;
		switch (_p87.ctor) {
			case 'EConst':
				return leafUnchanged;
			case 'EBase':
				return leafUnchanged;
			case 'EVar':
				var _p88 = A2(_elm_lang$core$Dict$get, _p87._1, oldNameToNewName);
				if (_p88.ctor === 'Just') {
					return {
						ctor: '_Tuple3',
						_0: A2(
							_user$project$Lang$replaceE__,
							exp,
							A2(_user$project$Lang$EVar, _p87._0, _p88._0)),
						_1: usedNames,
						_2: _elm_lang$core$Dict$empty
					};
				} else {
					return leafUnchanged;
				}
			case 'EFun':
				var _p89 = A3(
					_elm_lang$core$List$foldl,
					F2(
						function (p, _p90) {
							var _p91 = _p90;
							var _p92 = A2(assignUniqueNamesToPat_, p, _p91._1);
							var newPat = _p92._0;
							var usedNames_ = _p92._1;
							var oldNameToNewNameAdditions_ = _p92._2;
							return {
								ctor: '_Tuple3',
								_0: A2(
									_elm_lang$core$Basics_ops['++'],
									_p91._0,
									{
										ctor: '::',
										_0: newPat,
										_1: {ctor: '[]'}
									}),
								_1: usedNames_,
								_2: A2(_elm_lang$core$Dict$union, oldNameToNewNameAdditions_, _p91._2)
							};
						}),
					{
						ctor: '_Tuple3',
						_0: {ctor: '[]'},
						_1: usedNames,
						_2: _elm_lang$core$Dict$empty
					},
					_p87._1);
				var newPs = _p89._0;
				var usedNames_ = _p89._1;
				var oldNameToNewNameAdditions = _p89._2;
				var _p93 = A3(
					recurse,
					_p87._2,
					usedNames_,
					A2(_elm_lang$core$Dict$union, oldNameToNewNameAdditions, oldNameToNewName));
				var newBody = _p93._0;
				var usedNames__ = _p93._1;
				var newNameToOldName = _p93._2;
				var newNameToOldName_ = A2(
					_elm_lang$core$Dict$union,
					_user$project$Utils$flipDict(oldNameToNewNameAdditions),
					newNameToOldName);
				return {
					ctor: '_Tuple3',
					_0: A2(
						_user$project$Lang$replaceE__,
						exp,
						A4(_user$project$Lang$EFun, _p87._0, newPs, newBody, _p87._3)),
					_1: usedNames__,
					_2: newNameToOldName_
				};
			case 'EOp':
				var _p94 = recurseExps(_p87._2);
				var newEs = _p94._0;
				var usedNames_ = _p94._1;
				var newNameToOldName = _p94._2;
				return {
					ctor: '_Tuple3',
					_0: A2(
						_user$project$Lang$replaceE__,
						exp,
						A4(_user$project$Lang$EOp, _p87._0, _p87._1, newEs, _p87._3)),
					_1: usedNames_,
					_2: newNameToOldName
				};
			case 'EList':
				if (_p87._3.ctor === 'Nothing') {
					var _p95 = recurseExps(_p87._1);
					var newEs = _p95._0;
					var usedNames_ = _p95._1;
					var newNameToOldName = _p95._2;
					return {
						ctor: '_Tuple3',
						_0: A2(
							_user$project$Lang$replaceE__,
							exp,
							A5(_user$project$Lang$EList, _p87._0, newEs, _p87._2, _elm_lang$core$Maybe$Nothing, _p87._4)),
						_1: usedNames_,
						_2: newNameToOldName
					};
				} else {
					var _p96 = recurseExps(
						A2(
							_elm_lang$core$Basics_ops['++'],
							_p87._1,
							{
								ctor: '::',
								_0: _p87._3._0,
								_1: {ctor: '[]'}
							}));
					var newEs = _p96._0;
					var usedNames_ = _p96._1;
					var newNameToOldName = _p96._2;
					var _p97 = {
						ctor: '_Tuple2',
						_0: _user$project$Utils$removeLastElement(newEs),
						_1: A2(_user$project$Utils$last, 'assignUniqueNames_', newEs)
					};
					var newHeads = _p97._0;
					var newTail = _p97._1;
					return {
						ctor: '_Tuple3',
						_0: A2(
							_user$project$Lang$replaceE__,
							exp,
							A5(
								_user$project$Lang$EList,
								_p87._0,
								newHeads,
								_p87._2,
								_elm_lang$core$Maybe$Just(newTail),
								_p87._4)),
						_1: usedNames_,
						_2: newNameToOldName
					};
				}
			case 'EIf':
				var _p98 = recurseExps(
					{
						ctor: '::',
						_0: _p87._1,
						_1: {
							ctor: '::',
							_0: _p87._2,
							_1: {
								ctor: '::',
								_0: _p87._3,
								_1: {ctor: '[]'}
							}
						}
					});
				var newEs = _p98._0;
				var usedNames_ = _p98._1;
				var newNameToOldName = _p98._2;
				var _p99 = newEs;
				if ((((_p99.ctor === '::') && (_p99._1.ctor === '::')) && (_p99._1._1.ctor === '::')) && (_p99._1._1._1.ctor === '[]')) {
					return {
						ctor: '_Tuple3',
						_0: A2(
							_user$project$Lang$replaceE__,
							exp,
							A5(_user$project$Lang$EIf, _p87._0, _p99._0, _p99._1._0, _p99._1._1._0, _p87._4)),
						_1: usedNames_,
						_2: newNameToOldName
					};
				} else {
					return _elm_lang$core$Native_Utils.crashCase(
						'LangTools',
						{
							start: {line: 2313, column: 7},
							end: {line: 2321, column: 47}
						},
						_p99)('assignUniqueNames_ EIf');
				}
			case 'ECase':
				var _p101 = A3(recurse, _p87._1, usedNames, oldNameToNewName);
				var newScrutinee = _p101._0;
				var usedNames_ = _p101._1;
				var newNameToOldName = _p101._2;
				var _p102 = A3(
					_elm_lang$core$List$foldl,
					F2(
						function (branch, _p103) {
							var _p104 = _p103;
							var _p105 = branch.val;
							var bws1 = _p105._0;
							var bPat = _p105._1;
							var bExp = _p105._2;
							var bws2 = _p105._3;
							var _p106 = A2(assignUniqueNamesToPat_, bPat, _p104._1);
							var newPat = _p106._0;
							var usedNames_ = _p106._1;
							var oldNameToNewNameAdditions = _p106._2;
							var _p107 = A3(
								recurse,
								bExp,
								usedNames_,
								A2(_elm_lang$core$Dict$union, oldNameToNewNameAdditions, oldNameToNewName));
							var newBody = _p107._0;
							var usedNames__ = _p107._1;
							var newNameToOldName_ = _p107._2;
							var newBranch = _elm_lang$core$Native_Utils.update(
								branch,
								{
									val: A4(_user$project$Lang$Branch_, bws1, newPat, newBody, bws2)
								});
							return {
								ctor: '_Tuple3',
								_0: A2(
									_elm_lang$core$Basics_ops['++'],
									_p104._0,
									{
										ctor: '::',
										_0: newBranch,
										_1: {ctor: '[]'}
									}),
								_1: usedNames__,
								_2: A2(
									_elm_lang$core$Dict$union,
									_user$project$Utils$flipDict(oldNameToNewNameAdditions),
									A2(_elm_lang$core$Dict$union, newNameToOldName_, _p104._2))
							};
						}),
					{
						ctor: '_Tuple3',
						_0: {ctor: '[]'},
						_1: usedNames_,
						_2: newNameToOldName
					},
					_p87._2);
				var newBranches = _p102._0;
				var usedNames__ = _p102._1;
				var newNameToOldName_ = _p102._2;
				return {
					ctor: '_Tuple3',
					_0: A2(
						_user$project$Lang$replaceE__,
						exp,
						A4(_user$project$Lang$ECase, _p87._0, newScrutinee, newBranches, _p87._3)),
					_1: usedNames__,
					_2: newNameToOldName_
				};
			case 'ETypeCase':
				return _elm_lang$core$Native_Utils.crashCase(
					'LangTools',
					{
						start: {line: 2264, column: 3},
						end: {line: 2414, column: 8}
					},
					_p87)('need to change typecase scrutinee to expression; pluck from brainstorm branch');
			case 'EApp':
				var _p109 = recurseExps(
					{ctor: '::', _0: _p87._1, _1: _p87._2});
				var newE1AndEs = _p109._0;
				var usedNames_ = _p109._1;
				var newNameToOldName = _p109._2;
				var _p110 = {
					ctor: '_Tuple2',
					_0: A2(_user$project$Utils$head, 'assignUniqueNames_ head', newE1AndEs),
					_1: A2(_user$project$Utils$tail, 'assignUniqueNames_ tail', newE1AndEs)
				};
				var newE1 = _p110._0;
				var newEs = _p110._1;
				return {
					ctor: '_Tuple3',
					_0: A2(
						_user$project$Lang$replaceE__,
						exp,
						A4(_user$project$Lang$EApp, _p87._0, newE1, newEs, _p87._3)),
					_1: usedNames_,
					_2: newNameToOldName
				};
			case 'ELet':
				var _p114 = _p87._2;
				var _p111 = A2(assignUniqueNamesToPat_, _p87._3, usedNames);
				var newPat = _p111._0;
				var usedNames_ = _p111._1;
				var oldNameToNewNameAdditions = _p111._2;
				var oldNameToNewNameWithAdditions = A2(_elm_lang$core$Dict$union, oldNameToNewNameAdditions, oldNameToNewName);
				var oldNameToNewNameForBoundExp = _p114 ? oldNameToNewNameWithAdditions : oldNameToNewName;
				var _p112 = A3(recurse, _p87._4, usedNames_, oldNameToNewNameForBoundExp);
				var newE1 = _p112._0;
				var usedNames__ = _p112._1;
				var newNameToOldName = _p112._2;
				var _p113 = A3(recurse, _p87._5, usedNames__, oldNameToNewNameWithAdditions);
				var newE2 = _p113._0;
				var usedNames___ = _p113._1;
				var newNameToOldName_ = _p113._2;
				var newNameToOldName__ = A2(
					_elm_lang$core$Dict$union,
					_user$project$Utils$flipDict(oldNameToNewNameAdditions),
					A2(_elm_lang$core$Dict$union, newNameToOldName_, newNameToOldName));
				return {
					ctor: '_Tuple3',
					_0: A2(
						_user$project$Lang$replaceE__,
						exp,
						A7(_user$project$Lang$ELet, _p87._0, _p87._1, _p114, newPat, newE1, newE2, _p87._6)),
					_1: usedNames___,
					_2: newNameToOldName__
				};
			case 'EComment':
				var _p115 = recurseExp(_p87._2);
				var newE1 = _p115._0;
				var usedNames_ = _p115._1;
				var newNameToOldName = _p115._2;
				return {
					ctor: '_Tuple3',
					_0: A2(
						_user$project$Lang$replaceE__,
						exp,
						A3(_user$project$Lang$EComment, _p87._0, _p87._1, newE1)),
					_1: usedNames_,
					_2: newNameToOldName
				};
			case 'EOption':
				var _p116 = recurseExp(_p87._4);
				var newE1 = _p116._0;
				var usedNames_ = _p116._1;
				var newNameToOldName = _p116._2;
				return {
					ctor: '_Tuple3',
					_0: A2(
						_user$project$Lang$replaceE__,
						exp,
						A5(_user$project$Lang$EOption, _p87._0, _p87._1, _p87._2, _p87._3, newE1)),
					_1: usedNames_,
					_2: newNameToOldName
				};
			case 'ETyp':
				var _p117 = recurseExp(_p87._3);
				var newE1 = _p117._0;
				var usedNames_ = _p117._1;
				var newNameToOldName = _p117._2;
				return {
					ctor: '_Tuple3',
					_0: A2(
						_user$project$Lang$replaceE__,
						exp,
						A5(_user$project$Lang$ETyp, _p87._0, _p87._1, _p87._2, newE1, _p87._4)),
					_1: usedNames_,
					_2: newNameToOldName
				};
			case 'EColonType':
				var _p118 = recurseExp(_p87._1);
				var newE1 = _p118._0;
				var usedNames_ = _p118._1;
				var newNameToOldName = _p118._2;
				return {
					ctor: '_Tuple3',
					_0: A2(
						_user$project$Lang$replaceE__,
						exp,
						A5(_user$project$Lang$EColonType, _p87._0, newE1, _p87._2, _p87._3, _p87._4)),
					_1: usedNames_,
					_2: newNameToOldName
				};
			default:
				var _p119 = recurseExp(_p87._3);
				var newE1 = _p119._0;
				var usedNames_ = _p119._1;
				var newNameToOldName = _p119._2;
				return {
					ctor: '_Tuple3',
					_0: A2(
						_user$project$Lang$replaceE__,
						exp,
						A5(_user$project$Lang$ETypeAlias, _p87._0, _p87._1, _p87._2, newE1, _p87._4)),
					_1: usedNames_,
					_2: newNameToOldName
				};
		}
	});
var _user$project$LangTools$identifiersListPatsOnly = function (exp) {
	var folder = F2(
		function (e__, acc) {
			var _p120 = e__;
			switch (_p120.ctor) {
				case 'EFun':
					return A2(
						_elm_lang$core$Basics_ops['++'],
						A2(_elm_lang$core$List$concatMap, _user$project$LangTools$identifiersListInPat, _p120._1),
						acc);
				case 'ECase':
					var pats = _user$project$Lang$branchPats(_p120._2);
					return A2(
						_elm_lang$core$Basics_ops['++'],
						A2(_elm_lang$core$List$concatMap, _user$project$LangTools$identifiersListInPat, pats),
						acc);
				case 'ELet':
					return A2(
						_elm_lang$core$Basics_ops['++'],
						_user$project$LangTools$identifiersListInPat(_p120._3),
						acc);
				default:
					return acc;
			}
		});
	return A3(
		_user$project$Lang$foldExpViaE__,
		folder,
		{ctor: '[]'},
		exp);
};
var _user$project$LangTools$identifiersSetPatsOnly = function (exp) {
	return _elm_lang$core$Set$fromList(
		_user$project$LangTools$identifiersListPatsOnly(exp));
};
var _user$project$LangTools$allPats = function (root) {
	return A2(
		_elm_lang$core$List$concatMap,
		function (exp) {
			var _p121 = exp.val.e__;
			switch (_p121.ctor) {
				case 'EFun':
					return _p121._1;
				case 'ECase':
					return _user$project$Lang$branchPats(_p121._2);
				case 'ELet':
					return {
						ctor: '::',
						_0: _p121._3,
						_1: {ctor: '[]'}
					};
				case 'ETypeCase':
					return {
						ctor: '::',
						_0: _p121._1,
						_1: {ctor: '[]'}
					};
				case 'ETyp':
					return {
						ctor: '::',
						_0: _p121._1,
						_1: {ctor: '[]'}
					};
				case 'ETypeAlias':
					return {
						ctor: '::',
						_0: _p121._1,
						_1: {ctor: '[]'}
					};
				default:
					return {ctor: '[]'};
			}
		},
		_user$project$Lang$flattenExpTree(root));
};
var _user$project$LangTools$identifiersList = function (exp) {
	var folder = F2(
		function (e__, acc) {
			var _p122 = e__;
			switch (_p122.ctor) {
				case 'EVar':
					return {ctor: '::', _0: _p122._1, _1: acc};
				case 'EFun':
					return A2(
						_elm_lang$core$Basics_ops['++'],
						A2(_elm_lang$core$List$concatMap, _user$project$LangTools$identifiersListInPat, _p122._1),
						acc);
				case 'ECase':
					var pats = _user$project$Lang$branchPats(_p122._2);
					return A2(
						_elm_lang$core$Basics_ops['++'],
						A2(_elm_lang$core$List$concatMap, _user$project$LangTools$identifiersListInPat, pats),
						acc);
				case 'ETypeCase':
					return A2(
						_elm_lang$core$Basics_ops['++'],
						_user$project$LangTools$identifiersListInPat(_p122._1),
						acc);
				case 'ELet':
					return A2(
						_elm_lang$core$Basics_ops['++'],
						_user$project$LangTools$identifiersListInPat(_p122._3),
						acc);
				default:
					return acc;
			}
		});
	return A3(
		_user$project$Lang$foldExpViaE__,
		folder,
		{ctor: '[]'},
		exp);
};
var _user$project$LangTools$identifierCounts = function (exp) {
	return A3(
		_elm_lang$core$List$foldl,
		F2(
			function (ident, counts) {
				return A3(
					_elm_lang$core$Dict$update,
					ident,
					function (old) {
						var _p123 = old;
						if (_p123.ctor === 'Just') {
							return _elm_lang$core$Maybe$Just(_p123._0 + 1);
						} else {
							return _elm_lang$core$Maybe$Just(1);
						}
					},
					counts);
			}),
		_elm_lang$core$Dict$empty,
		_user$project$LangTools$identifiersList(exp));
};
var _user$project$LangTools$identifiersSetInPat = function (pat) {
	return _elm_lang$core$Set$fromList(
		_user$project$LangTools$identifiersListInPat(pat));
};
var _user$project$LangTools$identifiersSetInPats = function (pats) {
	return _user$project$Utils$unionAll(
		A2(_elm_lang$core$List$map, _user$project$LangTools$identifiersSetInPat, pats));
};
var _user$project$LangTools$visibleIdentifiersAtPredicate_ = F3(
	function (idents, exp, pred) {
		var ret = function (deeperIdents) {
			return (_elm_lang$core$Native_Utils.eq(
				0,
				_elm_lang$core$Set$size(deeperIdents)) && pred(exp)) ? idents : deeperIdents;
		};
		var recurse = function (e) {
			return A3(_user$project$LangTools$visibleIdentifiersAtPredicate_, idents, e, pred);
		};
		var recurseAllChildren = function (_p124) {
			var _p125 = _p124;
			return _user$project$Utils$unionAll(
				A2(
					_elm_lang$core$List$map,
					recurse,
					_user$project$Lang$childExps(exp)));
		};
		var recurseWithNewIdents = F2(
			function (pats, e) {
				return A3(
					_user$project$LangTools$visibleIdentifiersAtPredicate_,
					A2(
						_elm_lang$core$Set$union,
						_user$project$LangTools$identifiersSetInPats(pats),
						idents),
					e,
					pred);
			});
		var _p126 = exp.val.e__;
		switch (_p126.ctor) {
			case 'EConst':
				return ret(_elm_lang$core$Set$empty);
			case 'EBase':
				return ret(_elm_lang$core$Set$empty);
			case 'EVar':
				return ret(_elm_lang$core$Set$empty);
			case 'EFun':
				return ret(
					A2(recurseWithNewIdents, _p126._1, _p126._2));
			case 'EOp':
				return ret(
					recurseAllChildren(
						{ctor: '_Tuple0'}));
			case 'EList':
				return ret(
					recurseAllChildren(
						{ctor: '_Tuple0'}));
			case 'EIf':
				return ret(
					recurseAllChildren(
						{ctor: '_Tuple0'}));
			case 'ECase':
				var scrutineeResult = recurse(_p126._1);
				var branchResults = A2(
					_elm_lang$core$List$map,
					function (_p127) {
						var _p128 = _p127;
						return A2(
							recurseWithNewIdents,
							{
								ctor: '::',
								_0: _p128._1,
								_1: {ctor: '[]'}
							},
							_p128._2);
					},
					A2(
						_elm_lang$core$List$map,
						function (_) {
							return _.val;
						},
						_p126._2));
				return ret(
					_user$project$Utils$unionAll(
						{ctor: '::', _0: scrutineeResult, _1: branchResults}));
			case 'ETypeCase':
				return ret(
					recurseAllChildren(
						{ctor: '_Tuple0'}));
			case 'EApp':
				return ret(
					recurseAllChildren(
						{ctor: '_Tuple0'}));
			case 'ELet':
				if (_p126._2 === false) {
					var assignResult = recurse(_p126._4);
					var bodyResult = A2(
						recurseWithNewIdents,
						{
							ctor: '::',
							_0: _p126._3,
							_1: {ctor: '[]'}
						},
						_p126._5);
					return ret(
						A2(_elm_lang$core$Set$union, assignResult, bodyResult));
				} else {
					var _p129 = _p126._3;
					var assignResult = A2(
						recurseWithNewIdents,
						{
							ctor: '::',
							_0: _p129,
							_1: {ctor: '[]'}
						},
						_p126._4);
					var bodyResult = A2(
						recurseWithNewIdents,
						{
							ctor: '::',
							_0: _p129,
							_1: {ctor: '[]'}
						},
						_p126._5);
					return ret(
						A2(_elm_lang$core$Set$union, assignResult, bodyResult));
				}
			case 'EComment':
				return ret(
					recurse(_p126._2));
			case 'EOption':
				return ret(
					recurse(_p126._4));
			case 'ETyp':
				return ret(
					recurse(_p126._3));
			case 'EColonType':
				return ret(
					recurse(_p126._1));
			default:
				return ret(
					recurse(_p126._3));
		}
	});
var _user$project$LangTools$visibleIdentifiersAtPredicateNoPrelude = F2(
	function (exp, pred) {
		return A3(_user$project$LangTools$visibleIdentifiersAtPredicate_, _elm_lang$core$Set$empty, exp, pred);
	});
var _user$project$LangTools$freeVars_ = F2(
	function (boundIdentsSet, exp) {
		freeVars_:
		while (true) {
			var recurse = function (_p130) {
				var _p131 = _p130;
				return A2(
					_elm_lang$core$List$concatMap,
					_user$project$LangTools$freeVars_(boundIdentsSet),
					_user$project$Lang$childExps(exp));
			};
			var _p132 = exp.val.e__;
			switch (_p132.ctor) {
				case 'EConst':
					return {ctor: '[]'};
				case 'EBase':
					return {ctor: '[]'};
				case 'EVar':
					return A2(_elm_lang$core$Set$member, _p132._1, boundIdentsSet) ? {ctor: '[]'} : {
						ctor: '::',
						_0: exp,
						_1: {ctor: '[]'}
					};
				case 'EFun':
					var _v53 = A2(
						_elm_lang$core$Set$union,
						_user$project$LangTools$identifiersSetInPats(_p132._1),
						boundIdentsSet),
						_v54 = _p132._2;
					boundIdentsSet = _v53;
					exp = _v54;
					continue freeVars_;
				case 'EOp':
					return recurse(
						{ctor: '_Tuple0'});
				case 'EList':
					return recurse(
						{ctor: '_Tuple0'});
				case 'EIf':
					return recurse(
						{ctor: '_Tuple0'});
				case 'ECase':
					var freeInScrutinee = A2(_user$project$LangTools$freeVars_, boundIdentsSet, _p132._1);
					var freeInEachBranch = A2(
						_elm_lang$core$List$concatMap,
						function (_p133) {
							var _p134 = _p133;
							return A2(
								_user$project$LangTools$freeVars_,
								A2(
									_elm_lang$core$Set$union,
									_user$project$LangTools$identifiersSetInPat(_p134._1),
									boundIdentsSet),
								_p134._2);
						},
						A2(
							_elm_lang$core$List$map,
							function (_) {
								return _.val;
							},
							_p132._2));
					return A2(_elm_lang$core$Basics_ops['++'], freeInScrutinee, freeInEachBranch);
				case 'ETypeCase':
					return recurse(
						{ctor: '_Tuple0'});
				case 'EApp':
					return recurse(
						{ctor: '_Tuple0'});
				case 'ELet':
					if (_p132._2 === false) {
						var freeInAssigns = A2(_user$project$LangTools$freeVars_, boundIdentsSet, _p132._4);
						var freeInBody = A2(
							_user$project$LangTools$freeVars_,
							A2(
								_elm_lang$core$Set$union,
								_user$project$LangTools$identifiersSetInPat(_p132._3),
								boundIdentsSet),
							_p132._5);
						return A2(_elm_lang$core$Basics_ops['++'], freeInAssigns, freeInBody);
					} else {
						var _p135 = _p132._3;
						var freeInAssigns = A2(
							_user$project$LangTools$freeVars_,
							A2(
								_elm_lang$core$Set$union,
								_user$project$LangTools$identifiersSetInPat(_p135),
								boundIdentsSet),
							_p132._4);
						var freeInBody = A2(
							_user$project$LangTools$freeVars_,
							A2(
								_elm_lang$core$Set$union,
								_user$project$LangTools$identifiersSetInPat(_p135),
								boundIdentsSet),
							_p132._5);
						return A2(_elm_lang$core$Basics_ops['++'], freeInAssigns, freeInBody);
					}
				case 'EComment':
					return recurse(
						{ctor: '_Tuple0'});
				case 'EOption':
					return recurse(
						{ctor: '_Tuple0'});
				case 'ETyp':
					return recurse(
						{ctor: '_Tuple0'});
				case 'EColonType':
					return recurse(
						{ctor: '_Tuple0'});
				default:
					return recurse(
						{ctor: '_Tuple0'});
			}
		}
	});
var _user$project$LangTools$freeVars = function (exp) {
	return A2(_user$project$LangTools$freeVars_, _elm_lang$core$Set$empty, exp);
};
var _user$project$LangTools$transformVarsUntilBound = F2(
	function (subst, exp) {
		var recurse = function (e) {
			return A2(_user$project$LangTools$transformVarsUntilBound, subst, e);
		};
		var recurseWithout = F2(
			function (introducedIdents, e) {
				var newSubst = A3(
					_elm_lang$core$List$foldl,
					_elm_lang$core$Dict$remove,
					subst,
					_elm_lang$core$Set$toList(introducedIdents));
				return _elm_lang$core$Native_Utils.eq(
					_elm_lang$core$Dict$size(newSubst),
					0) ? e : A2(_user$project$LangTools$transformVarsUntilBound, newSubst, e);
			});
		var _p136 = exp.val.e__;
		switch (_p136.ctor) {
			case 'EConst':
				return exp;
			case 'EBase':
				return exp;
			case 'EVar':
				var _p137 = A2(_elm_lang$core$Dict$get, _p136._1, subst);
				if (_p137.ctor === 'Just') {
					return _p137._0(exp);
				} else {
					return exp;
				}
			case 'EFun':
				var _p138 = _p136._1;
				return A2(
					_user$project$Lang$replaceE__,
					exp,
					A4(
						_user$project$Lang$EFun,
						_p136._0,
						_p138,
						A2(
							recurseWithout,
							_user$project$LangTools$identifiersSetInPats(_p138),
							_p136._2),
						_p136._3));
			case 'EOp':
				return A2(
					_user$project$Lang$replaceE__,
					exp,
					A4(
						_user$project$Lang$EOp,
						_p136._0,
						_p136._1,
						A2(_elm_lang$core$List$map, recurse, _p136._2),
						_p136._3));
			case 'EList':
				return A2(
					_user$project$Lang$replaceE__,
					exp,
					A5(
						_user$project$Lang$EList,
						_p136._0,
						A2(_elm_lang$core$List$map, recurse, _p136._1),
						_p136._2,
						A2(_elm_lang$core$Maybe$map, recurse, _p136._3),
						_p136._4));
			case 'EIf':
				return A2(
					_user$project$Lang$replaceE__,
					exp,
					A5(
						_user$project$Lang$EIf,
						_p136._0,
						recurse(_p136._1),
						recurse(_p136._2),
						recurse(_p136._3),
						_p136._4));
			case 'ECase':
				var newScrutinee = recurse(_p136._1);
				var newBranches = A2(
					_elm_lang$core$List$map,
					_user$project$Lang$mapValField(
						function (_p139) {
							var _p140 = _p139;
							var _p141 = _p140._1;
							return A4(
								_user$project$Lang$Branch_,
								_p140._0,
								_p141,
								A2(
									recurseWithout,
									_user$project$LangTools$identifiersSetInPat(_p141),
									_p140._2),
								_p140._3);
						}),
					_p136._2);
				return A2(
					_user$project$Lang$replaceE__,
					exp,
					A4(_user$project$Lang$ECase, _p136._0, newScrutinee, newBranches, _p136._3));
			case 'ETypeCase':
				return _elm_lang$core$Native_Utils.crashCase(
					'LangTools',
					{
						start: {line: 2067, column: 3},
						end: {line: 2118, column: 96}
					},
					_p136)('need to change typecase scrutinee to expression; pluck from brainstorm branch');
			case 'EApp':
				return A2(
					_user$project$Lang$replaceE__,
					exp,
					A4(
						_user$project$Lang$EApp,
						_p136._0,
						recurse(_p136._1),
						A2(_elm_lang$core$List$map, recurse, _p136._2),
						_p136._3));
			case 'ELet':
				if (_p136._2 === false) {
					var _p143 = _p136._3;
					return A2(
						_user$project$Lang$replaceE__,
						exp,
						A7(
							_user$project$Lang$ELet,
							_p136._0,
							_p136._1,
							false,
							_p143,
							recurse(_p136._4),
							A2(
								recurseWithout,
								_user$project$LangTools$identifiersSetInPat(_p143),
								_p136._5),
							_p136._6));
				} else {
					var _p144 = _p136._3;
					return A2(
						_user$project$Lang$replaceE__,
						exp,
						A7(
							_user$project$Lang$ELet,
							_p136._0,
							_p136._1,
							true,
							_p144,
							A2(
								recurseWithout,
								_user$project$LangTools$identifiersSetInPat(_p144),
								_p136._4),
							A2(
								recurseWithout,
								_user$project$LangTools$identifiersSetInPat(_p144),
								_p136._5),
							_p136._6));
				}
			case 'EComment':
				return A2(
					_user$project$Lang$replaceE__,
					exp,
					A3(
						_user$project$Lang$EComment,
						_p136._0,
						_p136._1,
						recurse(_p136._2)));
			case 'EOption':
				return A2(
					_user$project$Lang$replaceE__,
					exp,
					A5(
						_user$project$Lang$EOption,
						_p136._0,
						_p136._1,
						_p136._2,
						_p136._3,
						recurse(_p136._4)));
			case 'ETyp':
				return A2(
					_user$project$Lang$replaceE__,
					exp,
					A5(
						_user$project$Lang$ETyp,
						_p136._0,
						_p136._1,
						_p136._2,
						recurse(_p136._3),
						_p136._4));
			case 'EColonType':
				return A2(
					_user$project$Lang$replaceE__,
					exp,
					A5(
						_user$project$Lang$EColonType,
						_p136._0,
						recurse(_p136._1),
						_p136._2,
						_p136._3,
						_p136._4));
			default:
				return A2(
					_user$project$Lang$replaceE__,
					exp,
					A5(
						_user$project$Lang$ETypeAlias,
						_p136._0,
						_p136._1,
						_p136._2,
						recurse(_p136._3),
						_p136._4));
		}
	});
var _user$project$LangTools$renameVarsUntilBound = F2(
	function (renamings, exp) {
		var renamer = F2(
			function (newName, e) {
				var _p145 = e.val.e__;
				if (_p145.ctor === 'EVar') {
					return A2(
						_user$project$Lang$replaceE__,
						e,
						A2(_user$project$Lang$EVar, _p145._0, newName));
				} else {
					return _elm_lang$core$Native_Utils.crashCase(
						'LangTools',
						{
							start: {line: 2039, column: 5},
							end: {line: 2041, column: 139}
						},
						_p145)(
						A2(
							_elm_lang$core$Basics_ops['++'],
							'LangTools.renameVarsUntilBound: renamer should only be passed an EVar, but given: ',
							_elm_lang$core$Basics$toString(e)));
				}
			});
		var fnSubst = A2(
			_elm_lang$core$Dict$map,
			F2(
				function (_p147, newName) {
					return renamer(newName);
				}),
			renamings);
		return A2(_user$project$LangTools$transformVarsUntilBound, fnSubst, exp);
	});
var _user$project$LangTools$renameVarUntilBound = F3(
	function (oldName, newName, exp) {
		return A2(
			_user$project$LangTools$renameVarsUntilBound,
			A2(_elm_lang$core$Dict$singleton, oldName, newName),
			exp);
	});
var _user$project$LangTools$identifiersSet = function (exp) {
	return _elm_lang$core$Set$fromList(
		_user$project$LangTools$identifiersList(exp));
};
var _user$project$LangTools$preludeIdentifiers = _elm_lang$core$Set$fromList(
	A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$first, _user$project$Eval$initEnv));
var _user$project$LangTools$identifiersSetPlusPrelude = function (exp) {
	return A2(
		_elm_lang$core$Set$union,
		_user$project$LangTools$identifiersSet(exp),
		_user$project$LangTools$preludeIdentifiers);
};
var _user$project$LangTools$assignUniqueNames = function (program) {
	var initialUsedNames = _user$project$LangTools$identifiersSetPlusPrelude(program);
	var _p148 = A3(_user$project$LangTools$assignUniqueNames_, program, initialUsedNames, _elm_lang$core$Dict$empty);
	var newProgram = _p148._0;
	var usedNames = _p148._1;
	var newNameToOldName = _p148._2;
	return {ctor: '_Tuple2', _0: newProgram, _1: newNameToOldName};
};
var _user$project$LangTools$visibleIdentifiersAtEIds = F2(
	function (program, eids) {
		var programIdents = A2(
			_user$project$LangTools$visibleIdentifiersAtPredicateNoPrelude,
			program,
			function (exp) {
				return A2(_elm_lang$core$Set$member, exp.val.eid, eids);
			});
		return A2(_elm_lang$core$Set$union, programIdents, _user$project$LangTools$preludeIdentifiers);
	});
var _user$project$LangTools$expToFuncPats = function (exp) {
	var _p149 = exp.val.e__;
	if (_p149.ctor === 'EFun') {
		return _p149._1;
	} else {
		return _elm_lang$core$Native_Utils.crashCase(
			'LangTools',
			{
				start: {line: 1176, column: 3},
				end: {line: 1178, column: 107}
			},
			_p149)(
			A2(
				_elm_lang$core$Basics_ops['++'],
				'LangTools.expToFuncPats exp is not an EFun: ',
				_user$project$LangUnparser$unparseWithIds(exp)));
	}
};
var _user$project$LangTools$expToMaybeLetBody = function (exp) {
	var _p151 = exp.val.e__;
	if (_p151.ctor === 'ELet') {
		return _elm_lang$core$Maybe$Just(_p151._5);
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$LangTools$expToLetBody = function (exp) {
	var _p152 = exp.val.e__;
	if (_p152.ctor === 'ELet') {
		return _p152._5;
	} else {
		return _elm_lang$core$Native_Utils.crashCase(
			'LangTools',
			{
				start: {line: 1162, column: 3},
				end: {line: 1164, column: 112}
			},
			_p152)(
			A2(
				_elm_lang$core$Basics_ops['++'],
				'LangTools.expToLetBody exp is not an ELet: ',
				_user$project$LangUnparser$unparseWithIds(exp)));
	}
};
var _user$project$LangTools$expToMaybeLetPatAndBoundExp = function (exp) {
	var _p154 = exp.val.e__;
	if (_p154.ctor === 'ELet') {
		return _elm_lang$core$Maybe$Just(
			{ctor: '_Tuple2', _0: _p154._3, _1: _p154._4});
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$LangTools$findBoundExpByPathedPatternId = F2(
	function (_p155, exp) {
		var _p156 = _p155;
		var _p157 = A2(
			_elm_lang$core$Maybe$andThen,
			_user$project$LangTools$expToMaybeLetPatAndBoundExp,
			A2(_user$project$Lang$findExpByEId, exp, _p156._0._0));
		if (_p157.ctor === 'Just') {
			return A2(
				_user$project$Utils$mapFirstSuccess,
				function (_p158) {
					var _p159 = _p158;
					return _elm_lang$core$Native_Utils.eq(_p159._0, _p156._1) ? _elm_lang$core$Maybe$Just(_p159._1) : _elm_lang$core$Maybe$Nothing;
				},
				A2(_user$project$LangTools$tryMatchExpPatToPaths, _p157._0._0, _p157._0._1));
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$LangTools$expToLetPatAndBoundExp = function (exp) {
	var _p160 = exp.val.e__;
	if (_p160.ctor === 'ELet') {
		return {ctor: '_Tuple2', _0: _p160._3, _1: _p160._4};
	} else {
		return _elm_lang$core$Native_Utils.crashCase(
			'LangTools',
			{
				start: {line: 1148, column: 3},
				end: {line: 1150, column: 128}
			},
			_p160)(
			A2(
				_elm_lang$core$Basics_ops['++'],
				'LangTools.expToLetPatAndBoundExp exp is not an ELet: ',
				_user$project$LangUnparser$unparseWithIds(exp)));
	}
};
var _user$project$LangTools$expToMaybeLetBoundExp = function (exp) {
	var _p162 = exp.val.e__;
	if (_p162.ctor === 'ELet') {
		return _elm_lang$core$Maybe$Just(_p162._4);
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$LangTools$expToLetBoundExp = function (exp) {
	var _p163 = exp.val.e__;
	if (_p163.ctor === 'ELet') {
		return _p163._4;
	} else {
		return _elm_lang$core$Native_Utils.crashCase(
			'LangTools',
			{
				start: {line: 1134, column: 3},
				end: {line: 1136, column: 115}
			},
			_p163)(
			A2(
				_elm_lang$core$Basics_ops['++'],
				'LangTools.expToLetPat exp is not an ELet: ',
				_user$project$LangUnparser$unparseWithIds(exp)));
	}
};
var _user$project$LangTools$expToMaybeLetPat = function (exp) {
	var _p165 = exp.val.e__;
	if (_p165.ctor === 'ELet') {
		return _elm_lang$core$Maybe$Just(_p165._3);
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$LangTools$expToLetPat = function (exp) {
	var _p166 = exp.val.e__;
	if (_p166.ctor === 'ELet') {
		return _p166._3;
	} else {
		return _elm_lang$core$Native_Utils.crashCase(
			'LangTools',
			{
				start: {line: 1120, column: 3},
				end: {line: 1122, column: 110}
			},
			_p166)(
			A2(
				_elm_lang$core$Basics_ops['++'],
				'LangTools.expToLetPat exp is not an ELet: ',
				_user$project$LangUnparser$unparseWithIds(exp)));
	}
};
var _user$project$LangTools$expToLetKind = function (exp) {
	var _p168 = exp.val.e__;
	if (_p168.ctor === 'ELet') {
		return _p168._1;
	} else {
		return _elm_lang$core$Native_Utils.crashCase(
			'LangTools',
			{
				start: {line: 1113, column: 3},
				end: {line: 1115, column: 110}
			},
			_p168)(
			A2(
				_elm_lang$core$Basics_ops['++'],
				'LangTools.expToLetKind exp is not an ELet: ',
				_user$project$LangUnparser$unparseWithIds(exp)));
	}
};
var _user$project$LangTools$expToMaybeLetParts = function (exp) {
	var _p170 = exp.val.e__;
	if (_p170.ctor === 'ELet') {
		return _elm_lang$core$Maybe$Just(
			{ctor: '_Tuple7', _0: _p170._0, _1: _p170._1, _2: _p170._2, _3: _p170._3, _4: _p170._4, _5: _p170._5, _6: _p170._6});
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$LangTools$expToLetParts = function (exp) {
	var _p171 = exp.val.e__;
	if (_p171.ctor === 'ELet') {
		return {ctor: '_Tuple7', _0: _p171._0, _1: _p171._1, _2: _p171._2, _3: _p171._3, _4: _p171._4, _5: _p171._5, _6: _p171._6};
	} else {
		return _elm_lang$core$Native_Utils.crashCase(
			'LangTools',
			{
				start: {line: 1099, column: 3},
				end: {line: 1101, column: 125}
			},
			_p171)(
			A2(
				_elm_lang$core$Basics_ops['++'],
				'LangTools.expToLetParts exp is not an ELet: ',
				_user$project$LangUnparser$unparseWithIds(exp)));
	}
};
var _user$project$LangTools$patToMaybePVarIdent = function (pat) {
	var _p173 = pat.val.p__;
	if (_p173.ctor === 'PVar') {
		return _elm_lang$core$Maybe$Just(_p173._1);
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$LangTools$patToMaybeIdent = function (pat) {
	var _p174 = pat.val.p__;
	switch (_p174.ctor) {
		case 'PVar':
			return _elm_lang$core$Maybe$Just(_p174._1);
		case 'PAs':
			return _elm_lang$core$Maybe$Just(_p174._1);
		default:
			return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$LangTools$indentPathsInPat = function (pat) {
	var childIdentPaths = A2(
		_user$project$Utils$concatMapi1,
		function (_p175) {
			var _p176 = _p175;
			return A2(
				_elm_lang$core$List$map,
				function (_p177) {
					var _p178 = _p177;
					return {
						ctor: '_Tuple2',
						_0: _p178._0,
						_1: {ctor: '::', _0: _p176._0, _1: _p178._1}
					};
				},
				_user$project$LangTools$indentPathsInPat(_p176._1));
		},
		_user$project$Lang$childPats(pat));
	var _p179 = _user$project$LangTools$patToMaybeIdent(pat);
	if (_p179.ctor === 'Just') {
		return {
			ctor: '::',
			_0: {
				ctor: '_Tuple2',
				_0: _p179._0,
				_1: {ctor: '[]'}
			},
			_1: childIdentPaths
		};
	} else {
		return childIdentPaths;
	}
};
var _user$project$LangTools$pathForIdentInPat = F2(
	function (targetIdent, pat) {
		return A2(
			_user$project$Utils$mapFirstSuccess,
			function (_p180) {
				var _p181 = _p180;
				return _elm_lang$core$Native_Utils.eq(_p181._0, targetIdent) ? _elm_lang$core$Maybe$Just(_p181._1) : _elm_lang$core$Maybe$Nothing;
			},
			_user$project$LangTools$indentPathsInPat(pat));
	});
var _user$project$LangTools$bindingPathedPatternIdFor_ = F4(
	function (currentBindingPathedPatternId, targetName, predicateMap, exp) {
		var recurse = F2(
			function (pathedPatternId, e) {
				return A4(_user$project$LangTools$bindingPathedPatternIdFor_, pathedPatternId, targetName, predicateMap, e);
			});
		var maybeNewBindingForRecursion = F3(
			function (pat, branchI, pathPrefix) {
				return A2(
					_elm_lang$core$Maybe$map,
					function (path) {
						return _elm_lang$core$Maybe$Just(
							{
								ctor: '_Tuple2',
								_0: {ctor: '_Tuple2', _0: exp.val.eid, _1: branchI},
								_1: A2(_elm_lang$core$Basics_ops['++'], pathPrefix, path)
							});
					},
					A2(_user$project$LangTools$pathForIdentInPat, targetName, pat));
			});
		var _p182 = A2(predicateMap, exp, currentBindingPathedPatternId);
		if (_p182.ctor === 'Just') {
			return _elm_lang$core$Maybe$Just(_p182._0);
		} else {
			var _p183 = exp.val.e__;
			switch (_p183.ctor) {
				case 'EFun':
					var newBindingPathedPatternId = A2(
						_elm_lang$core$Maybe$withDefault,
						currentBindingPathedPatternId,
						A2(
							_user$project$Utils$mapFirstSuccess,
							function (_p184) {
								var _p185 = _p184;
								return A3(
									maybeNewBindingForRecursion,
									_p185._1,
									1,
									{
										ctor: '::',
										_0: _p185._0,
										_1: {ctor: '[]'}
									});
							},
							_user$project$Utils$zipi1(_p183._1)));
					return A2(recurse, newBindingPathedPatternId, _p183._2);
				case 'ELet':
					var newBindingPathedPatternId = A2(
						_elm_lang$core$Maybe$withDefault,
						currentBindingPathedPatternId,
						A3(
							maybeNewBindingForRecursion,
							_p183._3,
							1,
							{ctor: '[]'}));
					var pathedPatternIdForBoundExp = _p183._2 ? newBindingPathedPatternId : currentBindingPathedPatternId;
					return A2(
						_user$project$Utils$firstOrLazySecond,
						A2(recurse, pathedPatternIdForBoundExp, _p183._4),
						function (_p186) {
							var _p187 = _p186;
							return A2(recurse, newBindingPathedPatternId, _p183._5);
						});
				case 'ECase':
					return A2(
						_user$project$Utils$mapFirstSuccess,
						function (_p188) {
							var _p189 = _p188;
							var newBindingPathedPatternId = A2(
								_elm_lang$core$Maybe$withDefault,
								currentBindingPathedPatternId,
								A3(
									maybeNewBindingForRecursion,
									_p189._1._0,
									_p189._0,
									{ctor: '[]'}));
							return A2(recurse, newBindingPathedPatternId, _p189._1._1);
						},
						_user$project$Utils$zipi1(
							_user$project$Lang$branchPatExps(_p183._2)));
				default:
					return A2(
						_user$project$Utils$mapFirstSuccess,
						recurse(currentBindingPathedPatternId),
						_user$project$Lang$childExps(exp));
			}
		}
	});
var _user$project$LangTools$bindingPathedPatternIdForIdentAtEId = F3(
	function (targetName, targetEId, program) {
		var predMap = F2(
			function (exp, maybeCurrentBindingPathedPatternId) {
				var _p190 = exp.val.e__;
				if (_p190.ctor === 'EVar') {
					return _elm_lang$core$Native_Utils.eq(exp.val.eid, targetEId) ? _elm_lang$core$Maybe$Just(maybeCurrentBindingPathedPatternId) : _elm_lang$core$Maybe$Nothing;
				} else {
					return _elm_lang$core$Maybe$Nothing;
				}
			});
		return A2(
			_elm_lang$core$Maybe$withDefault,
			_elm_lang$core$Maybe$Nothing,
			A4(_user$project$LangTools$bindingPathedPatternIdFor_, _elm_lang$core$Maybe$Nothing, targetName, predMap, program));
	});
var _user$project$LangTools$bindingScopeIdForIdentAtEId = F3(
	function (targetName, targetEId, program) {
		return A2(
			_elm_lang$core$Maybe$map,
			function (_p191) {
				var _p192 = _p191;
				return _p192._0;
			},
			A3(_user$project$LangTools$bindingPathedPatternIdForIdentAtEId, targetName, targetEId, program));
	});
var _user$project$LangTools$bindingPathedPatternIdForUniqueName = F2(
	function (targetName, program) {
		var predMap = F2(
			function (e, maybeCurrentBindingPathedPatternId) {
				return maybeCurrentBindingPathedPatternId;
			});
		return A4(_user$project$LangTools$bindingPathedPatternIdFor_, _elm_lang$core$Maybe$Nothing, targetName, predMap, program);
	});
var _user$project$LangTools$indentPIdsInPat = function (pat) {
	return A2(
		_elm_lang$core$List$filterMap,
		function (p) {
			var _p193 = _user$project$LangTools$patToMaybeIdent(p);
			if (_p193.ctor === 'Just') {
				return _elm_lang$core$Maybe$Just(
					{ctor: '_Tuple2', _0: _p193._0, _1: p.val.pid});
			} else {
				return _elm_lang$core$Maybe$Nothing;
			}
		},
		_user$project$Lang$flattenPatTree(pat));
};
var _user$project$LangTools$expToIdent = function (exp) {
	var _p194 = exp.val.e__;
	if (_p194.ctor === 'EVar') {
		return _p194._1;
	} else {
		return _elm_lang$core$Native_Utils.crashCase(
			'LangTools',
			{
				start: {line: 1077, column: 3},
				end: {line: 1079, column: 101}
			},
			_p194)(
			A2(
				_elm_lang$core$Basics_ops['++'],
				'LangTools.expToIdent exp is not an EVar: ',
				_user$project$LangUnparser$unparseWithIds(exp)));
	}
};
var _user$project$LangTools$identifierUses = F2(
	function (ident, exp) {
		return A2(
			_elm_lang$core$List$filter,
			function (_p196) {
				return A2(
					F2(
						function (x, y) {
							return _elm_lang$core$Native_Utils.eq(x, y);
						}),
					ident,
					_user$project$LangTools$expToIdent(_p196));
			},
			_user$project$LangTools$freeVars(exp));
	});
var _user$project$LangTools$identifierUsageEIds = F2(
	function (ident, exp) {
		return A2(
			_elm_lang$core$List$map,
			function (_p197) {
				return function (_) {
					return _.eid;
				}(
					function (_) {
						return _.val;
					}(_p197));
			},
			A2(_user$project$LangTools$identifierUses, ident, exp));
	});
var _user$project$LangTools$identifierUsesAfterDefiningPat = F2(
	function (ident, exp) {
		return A2(
			_elm_lang$core$List$concatMap,
			function (scopeAreaExp) {
				return A2(_user$project$LangTools$identifierUses, ident, scopeAreaExp);
			},
			A2(_user$project$LangTools$findScopeAreasByIdent, ident, exp));
	});
var _user$project$LangTools$identifierSetUses = F2(
	function (identSet, exp) {
		return A2(
			_elm_lang$core$List$filter,
			function (varExp) {
				return A2(
					_elm_lang$core$Set$member,
					_user$project$LangTools$expToIdent(varExp),
					identSet);
			},
			_user$project$LangTools$freeVars(exp));
	});
var _user$project$LangTools$bindingPathedPatternIdFor = F2(
	function (varExp, program) {
		var targetName = _user$project$LangTools$expToIdent(varExp);
		var targetEId = varExp.val.eid;
		return A3(_user$project$LangTools$bindingPathedPatternIdForIdentAtEId, targetName, targetEId, program);
	});
var _user$project$LangTools$bindingScopeIdFor = F2(
	function (varExp, program) {
		return A2(
			_elm_lang$core$Maybe$map,
			function (_p198) {
				var _p199 = _p198;
				return _p199._0;
			},
			A2(_user$project$LangTools$bindingPathedPatternIdFor, varExp, program));
	});
var _user$project$LangTools$expToMaybeIdent = function (exp) {
	var _p200 = exp.val.e__;
	if (_p200.ctor === 'EVar') {
		return _elm_lang$core$Maybe$Just(_p200._1);
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$LangTools$varsWithName = F2(
	function (ident, exp) {
		return A2(
			_elm_lang$core$List$filter,
			function (_p201) {
				return A2(
					F2(
						function (x, y) {
							return _elm_lang$core$Native_Utils.eq(x, y);
						}),
					_elm_lang$core$Maybe$Just(ident),
					_user$project$LangTools$expToMaybeIdent(_p201));
			},
			_user$project$Lang$flattenExpTree(exp));
	});
var _user$project$LangTools$freeIdentifiers = function (exp) {
	return _elm_lang$core$Set$fromList(
		A2(
			_user$project$Utils$fromJust_,
			'LangTools.freeIdentifiers',
			_user$project$Utils$projJusts(
				A2(
					_elm_lang$core$List$map,
					_user$project$LangTools$expToMaybeIdent,
					_user$project$LangTools$freeVars(exp)))));
};
var _user$project$LangTools$isLiteral = function (exp) {
	return _elm_lang$core$Native_Utils.eq(
		_elm_lang$core$Set$size(
			_user$project$LangTools$freeIdentifiers(exp)),
		0);
};
var _user$project$LangTools$allVarEIdsToBindingPIdList = function (program) {
	var handleELet = F2(
		function (letExp, identToPId) {
			return A2(
				_elm_lang$core$Dict$union,
				_elm_lang$core$Dict$fromList(
					_user$project$LangTools$indentPIdsInPat(
						_user$project$LangTools$expToLetPat(letExp))),
				identToPId);
		});
	var handleEFun = F2(
		function (funcExp, identToPId) {
			return A2(
				_elm_lang$core$Dict$union,
				_elm_lang$core$Dict$fromList(
					A2(
						_elm_lang$core$List$concatMap,
						_user$project$LangTools$indentPIdsInPat,
						_user$project$LangTools$expToFuncPats(funcExp))),
				identToPId);
		});
	var handleCaseBranch = F4(
		function (caseExp, branch, branchI, identToPId) {
			return A2(
				_elm_lang$core$Dict$union,
				_elm_lang$core$Dict$fromList(
					_user$project$LangTools$indentPIdsInPat(
						_user$project$Lang$branchPat(branch))),
				identToPId);
		});
	return A7(
		_user$project$Lang$foldExpTopDownWithScope,
		F3(
			function (exp, eidAndMaybePId, identToPId) {
				var _p202 = _user$project$LangTools$expToMaybeIdent(exp);
				if (_p202.ctor === 'Just') {
					return {
						ctor: '::',
						_0: {
							ctor: '_Tuple2',
							_0: exp.val.eid,
							_1: A2(_elm_lang$core$Dict$get, _p202._0, identToPId)
						},
						_1: eidAndMaybePId
					};
				} else {
					return eidAndMaybePId;
				}
			}),
		handleELet,
		handleEFun,
		handleCaseBranch,
		{ctor: '[]'},
		_elm_lang$core$Dict$empty,
		program);
};
var _user$project$LangTools$allVarEIdsToBindingPId = function (program) {
	return _elm_lang$core$Dict$fromList(
		_user$project$LangTools$allVarEIdsToBindingPIdList(program));
};
var _user$project$LangTools$allVarEIdsToBindingPIdBasedOnUniqueName = function (program) {
	var allIdentToPId = _elm_lang$core$Dict$fromList(
		A2(
			_elm_lang$core$List$concatMap,
			function (exp) {
				var _p203 = exp.val.e__;
				switch (_p203.ctor) {
					case 'EFun':
						return A2(_elm_lang$core$List$concatMap, _user$project$LangTools$indentPIdsInPat, _p203._1);
					case 'ELet':
						return _user$project$LangTools$indentPIdsInPat(_p203._3);
					case 'ECase':
						return A2(
							_elm_lang$core$List$concatMap,
							_user$project$LangTools$indentPIdsInPat,
							_user$project$Lang$branchPats(_p203._2));
					default:
						return {ctor: '[]'};
				}
			},
			_user$project$Lang$flattenExpTree(program)));
	return _elm_lang$core$Dict$fromList(
		A2(
			_elm_lang$core$List$filterMap,
			function (exp) {
				var _p204 = _user$project$LangTools$expToMaybeIdent(exp);
				if (_p204.ctor === 'Nothing') {
					return _elm_lang$core$Maybe$Nothing;
				} else {
					var _p205 = A2(_elm_lang$core$Dict$get, _p204._0, allIdentToPId);
					if (_p205.ctor === 'Nothing') {
						return _elm_lang$core$Maybe$Just(
							{ctor: '_Tuple2', _0: exp.val.eid, _1: _elm_lang$core$Maybe$Nothing});
					} else {
						return _elm_lang$core$Maybe$Just(
							{
								ctor: '_Tuple2',
								_0: exp.val.eid,
								_1: _elm_lang$core$Maybe$Just(_p205._0)
							});
					}
				}
			},
			_user$project$Lang$flattenExpTree(program)));
};
var _user$project$LangTools$expToMaybeVar = function (exp) {
	var _p206 = exp.val.e__;
	if (_p206.ctor === 'EVar') {
		return _elm_lang$core$Maybe$Just(exp);
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$LangTools$allVars = function (root) {
	return A2(
		_elm_lang$core$List$filterMap,
		_user$project$LangTools$expToMaybeVar,
		_user$project$Lang$flattenExpTree(root));
};
var _user$project$LangTools$expToMaybeNum = function (exp) {
	var _p207 = exp.val.e__;
	if (_p207.ctor === 'EConst') {
		return _elm_lang$core$Maybe$Just(_p207._1);
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$LangTools$addFirstDef = F3(
	function (program, pat, boundExp) {
		var firstNonCommentEId = function (e) {
			firstNonCommentEId:
			while (true) {
				var _p208 = e.val.e__;
				if (_p208.ctor === 'EComment') {
					var _v99 = _p208._2;
					e = _v99;
					continue firstNonCommentEId;
				} else {
					return e.val.eid;
				}
			}
		};
		return A3(
			_user$project$Lang$mapExpNode,
			firstNonCommentEId(program),
			function (nonComment) {
				return _user$project$Lang$withDummyExpInfo(
					A7(_user$project$Lang$ELet, _user$project$Lang$newline1, _user$project$Lang$Def, false, pat, boundExp, nonComment, _user$project$Lang$space0));
			},
			program);
	});
var _user$project$LangTools$wrapWithLets = F3(
	function (listOfListsOfNamesAndAssigns, isTopLevel, bodyExp) {
		var nonEmptyListOfListsOfNamesAndAssigns = A2(
			_elm_lang$core$List$filter,
			function (_p209) {
				return !_elm_lang$core$List$isEmpty(_p209);
			},
			listOfListsOfNamesAndAssigns);
		var _p210 = nonEmptyListOfListsOfNamesAndAssigns;
		if (_p210.ctor === '[]') {
			return bodyExp;
		} else {
			var oldPrecedingWhitespace = _user$project$Lang$precedingWhitespace(bodyExp);
			var extraWhitespace = A2(_elm_lang$core$String$contains, '\n', oldPrecedingWhitespace) ? '' : '\n';
			var limitedOldPrecedingWhitespace = function () {
				var _p211 = _elm_lang$core$List$reverse(
					A2(_elm_lang$core$String$split, '\n', oldPrecedingWhitespace));
				if (_p211.ctor === '::') {
					return A2(_elm_lang$core$Basics_ops['++'], '\n', _p211._0);
				} else {
					return oldPrecedingWhitespace;
				}
			}();
			var precedingWs = A2(_elm_lang$core$Basics_ops['++'], extraWhitespace, limitedOldPrecedingWhitespace);
			var letOrDef = isTopLevel ? _user$project$Lang$Def : _user$project$Lang$Let;
			var wrappedWithLets = A3(
				_elm_lang$core$List$foldr,
				F2(
					function (letNamesAndAssigns, innerExp) {
						return A2(
							_user$project$Lang$replacePrecedingWhitespace,
							precedingWs,
							A3(_user$project$Lang$eLetOrDef, letOrDef, letNamesAndAssigns, innerExp));
					}),
				A2(_user$project$Lang$addPrecedingWhitespace, extraWhitespace, bodyExp),
				nonEmptyListOfListsOfNamesAndAssigns);
			return wrappedWithLets;
		}
	});
var _user$project$LangTools$deepestCommonAncestorWithNewline = F2(
	function (program, pred) {
		return A2(
			_elm_lang$core$Maybe$withDefault,
			program,
			A2(
				_user$project$Utils$findFirst,
				function (_p212) {
					return A2(
						_elm_lang$core$String$contains,
						'\n',
						_user$project$Lang$precedingWhitespace(_p212));
				},
				_elm_lang$core$List$reverse(
					A2(_user$project$Lang$commonAncestors, pred, program))));
	});
var _user$project$LangTools$deepestCommonScopeAndJustInside_ = F2(
	function (program, pred) {
		var allWithAncestorsScopesTagged = A2(
			_elm_lang$core$List$map,
			_user$project$Utils$dropLast(1),
			A2(_user$project$Lang$findAllWithAncestorsScopesTagged, pred, program));
		var commonAncestorsScopesTagged = _user$project$Utils$commonPrefix(allWithAncestorsScopesTagged);
		var commonAncestors = _user$project$Utils$commonPrefix(
			A2(
				_elm_lang$core$List$map,
				_elm_lang$core$List$map(_elm_lang$core$Tuple$first),
				allWithAncestorsScopesTagged));
		var maybeDeepestCommonScope = A2(
			_elm_lang$core$Maybe$map,
			_elm_lang$core$Tuple$first,
			_user$project$Utils$maybeLast(
				A2(
					_elm_lang$core$List$filter,
					function (_p213) {
						var _p214 = _p213;
						return _p214._1;
					},
					commonAncestorsScopesTagged)));
		var maybeAncestorJustInsideCommonScope = function () {
			var _p217 = _user$project$Utils$maybeLast(
				A2(
					_user$project$Utils$takeWhile,
					function (_p215) {
						var _p216 = _p215;
						return !_p216._1;
					},
					_elm_lang$core$List$reverse(commonAncestorsScopesTagged)));
			if (_p217.ctor === 'Nothing') {
				return _elm_lang$core$List$head(
					A2(
						_elm_lang$core$List$drop,
						_elm_lang$core$List$length(commonAncestorsScopesTagged),
						commonAncestors));
			} else {
				return _elm_lang$core$Maybe$Just(_p217._0._0);
			}
		}();
		return {ctor: '_Tuple2', _0: maybeDeepestCommonScope, _1: maybeAncestorJustInsideCommonScope};
	});
var _user$project$LangTools$deepestCommonScope = F2(
	function (exp, pred) {
		var _p218 = A2(_user$project$LangTools$deepestCommonScopeAndJustInside_, exp, pred);
		var maybeDeepestCommonScope = _p218._0;
		var candidates = _user$project$Utils$filterJusts(
			{
				ctor: '::',
				_0: _elm_lang$core$Maybe$Just(exp),
				_1: {
					ctor: '::',
					_0: maybeDeepestCommonScope,
					_1: {ctor: '[]'}
				}
			});
		return _user$project$Utils$last_(candidates);
	});
var _user$project$LangTools$justInsideDeepestCommonScope = F2(
	function (exp, pred) {
		var _p219 = A2(_user$project$LangTools$deepestCommonScopeAndJustInside_, exp, pred);
		var maybeDeepestCommonScope = _p219._0;
		var maybeAncestorJustInsideCommonScope = _p219._1;
		var candidates = _user$project$Utils$filterJusts(
			{
				ctor: '::',
				_0: _elm_lang$core$Maybe$Just(exp),
				_1: {
					ctor: '::',
					_0: maybeDeepestCommonScope,
					_1: {
						ctor: '::',
						_0: maybeAncestorJustInsideCommonScope,
						_1: {ctor: '[]'}
					}
				}
			});
		return _user$project$Utils$last_(candidates);
	});
var _user$project$LangTools$scopeNamesLocLiftedThrough_ = F3(
	function (targetLocId, scopeNames, exp) {
		var _p220 = exp.val.e__;
		_v105_2:
		do {
			switch (_p220.ctor) {
				case 'ELet':
					var scopeNames_ = function () {
						var _p221 = _p220._3.val.p__;
						switch (_p221.ctor) {
							case 'PVar':
								return A2(
									_elm_lang$core$Basics_ops['++'],
									scopeNames,
									{
										ctor: '::',
										_0: _p221._1,
										_1: {ctor: '[]'}
									});
							case 'PAs':
								return A2(
									_elm_lang$core$Basics_ops['++'],
									scopeNames,
									{
										ctor: '::',
										_0: _p221._1,
										_1: {ctor: '[]'}
									});
							default:
								return scopeNames;
						}
					}();
					return A2(
						_elm_lang$core$Basics_ops['++'],
						A3(_user$project$LangTools$scopeNamesLocLiftedThrough_, targetLocId, scopeNames_, _p220._4),
						A3(_user$project$LangTools$scopeNamesLocLiftedThrough_, targetLocId, scopeNames, _p220._5));
				case 'EConst':
					if (_p220._2.ctor === '_Tuple3') {
						return _elm_lang$core$Native_Utils.eq(_p220._2._0, targetLocId) ? {
							ctor: '::',
							_0: scopeNames,
							_1: {ctor: '[]'}
						} : {ctor: '[]'};
					} else {
						break _v105_2;
					}
				default:
					break _v105_2;
			}
		} while(false);
		var recurse = function (exp) {
			return A3(_user$project$LangTools$scopeNamesLocLiftedThrough_, targetLocId, scopeNames, exp);
		};
		return A2(
			_elm_lang$core$List$concatMap,
			recurse,
			_user$project$Lang$childExps(exp));
	});
var _user$project$LangTools$scopeNamesLocLiftedThrough = F2(
	function (newLetBody, targetLoc) {
		var _p222 = targetLoc;
		var targetLocId = _p222._0;
		var ident = _p222._2;
		var _p223 = A3(
			_user$project$LangTools$scopeNamesLocLiftedThrough_,
			targetLocId,
			{ctor: '[]'},
			newLetBody);
		if (_p223.ctor === '[]') {
			return {ctor: '[]'};
		} else {
			if (_p223._1.ctor === '[]') {
				var _p225 = _p223._0;
				var _p224 = _elm_lang$core$List$head(
					_elm_lang$core$List$reverse(_p225));
				if (_p224.ctor === 'Nothing') {
					return {ctor: '[]'};
				} else {
					return _elm_lang$core$Native_Utils.eq(_p224._0, ident) ? _user$project$Utils$removeLastElement(_p225) : _p225;
				}
			} else {
				return _elm_lang$core$Native_Utils.crashCase(
					'LangTools',
					{
						start: {line: 762, column: 3},
						end: {line: 778, column: 130}
					},
					_p223)(
					A2(
						_elm_lang$core$Basics_ops['++'],
						'Found locId ',
						A2(
							_elm_lang$core$Basics_ops['++'],
							_elm_lang$core$Basics$toString(targetLocId),
							A2(
								_elm_lang$core$Basics_ops['++'],
								' more than once in the expression: ',
								_user$project$LangUnparser$unparseWithIds(newLetBody)))));
			}
		}
	});
var _user$project$LangTools$leadingCapitals = _elm_lang$core$Regex$regex('^[A-Z]+');
var _user$project$LangTools$downcaseLeadingCapitals = function (string) {
	return A4(
		_elm_lang$core$Regex$replace,
		_elm_lang$core$Regex$AtMost(1),
		_user$project$LangTools$leadingCapitals,
		function (_p227) {
			var _p228 = _p227;
			return _elm_lang$core$String$toLower(_p228.match);
		},
		string);
};
var _user$project$LangTools$leadingDigits = _elm_lang$core$Regex$regex('^[0-9]+');
var _user$project$LangTools$removeLeadingDigits = function (string) {
	return A4(
		_elm_lang$core$Regex$replace,
		_elm_lang$core$Regex$AtMost(1),
		_user$project$LangTools$leadingDigits,
		function (_p229) {
			return '';
		},
		string);
};
var _user$project$LangTools$simpleExpNameWithDefault = F2(
	function ($default, exp) {
		var _p230 = exp.val.e__;
		switch (_p230.ctor) {
			case 'EConst':
				return 'num';
			case 'EVar':
				return _p230._1;
			case 'EApp':
				return A2(
					_elm_lang$core$Maybe$withDefault,
					$default,
					_user$project$LangTools$expToMaybeIdent(_p230._1));
			case 'EList':
				return 'list';
			case 'EOp':
				return A2(
					_elm_lang$core$Maybe$withDefault,
					$default,
					A2(
						_user$project$Utils$findFirst,
						F2(
							function (x, y) {
								return !_elm_lang$core$Native_Utils.eq(x, y);
							})($default),
						A2(
							_elm_lang$core$List$map,
							_user$project$LangTools$simpleExpNameWithDefault($default),
							_p230._2)));
			case 'EBase':
				switch (_p230._1.ctor) {
					case 'ENull':
						return 'null';
					case 'EString':
						return 'string';
					default:
						return 'bool';
				}
			case 'EFun':
				return 'func';
			default:
				return $default;
		}
	});
var _user$project$LangTools$defaultExpName = 'thing';
var _user$project$LangTools$simpleExpName = function (exp) {
	return A2(_user$project$LangTools$simpleExpNameWithDefault, _user$project$LangTools$defaultExpName, exp);
};
var _user$project$LangTools$locDescriptionParts = F2(
	function (program, loc) {
		var _p231 = loc;
		var locId = _p231._0;
		var ident = _p231._2;
		var baseIdent = _elm_lang$core$Native_Utils.eq(ident, '') ? A2(
			_elm_lang$core$Basics_ops['++'],
			'k',
			_elm_lang$core$Basics$toString(locId)) : ident;
		var scopeNamesLiftedThrough = A2(_user$project$LangTools$scopeNamesLocLiftedThrough, program, loc);
		return A2(
			_elm_lang$core$Basics_ops['++'],
			scopeNamesLiftedThrough,
			{
				ctor: '::',
				_0: baseIdent,
				_1: {ctor: '[]'}
			});
	});
var _user$project$LangTools$locDescription = F2(
	function (program, loc) {
		return A2(
			_elm_lang$core$String$join,
			' ',
			A2(_user$project$LangTools$locDescriptionParts, program, loc));
	});
var _user$project$LangTools$longLineLength = 50;
var _user$project$LangTools$copyListWhitespace = F2(
	function (templateList, list) {
		var _p232 = {ctor: '_Tuple2', _0: templateList.val.e__, _1: list.val.e__};
		if (((_p232.ctor === '_Tuple2') && (_p232._0.ctor === 'EList')) && (_p232._1.ctor === 'EList')) {
			return A2(
				_user$project$Lang$replaceE__,
				list,
				A5(_user$project$Lang$EList, _p232._0._0, _p232._1._1, _p232._0._2, _p232._1._3, _p232._0._4));
		} else {
			return _elm_lang$core$Native_Utils.crashCase(
				'LangTools',
				{
					start: {line: 370, column: 3},
					end: {line: 375, column: 131}
				},
				_p232)(
				A2(
					_elm_lang$core$Basics_ops['++'],
					'Lang.copyListWs expected lists, but given ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_user$project$LangUnparser$unparseWithIds(templateList),
						A2(
							_elm_lang$core$Basics_ops['++'],
							' and ',
							_user$project$LangUnparser$unparseWithIds(list)))));
		}
	});
var _user$project$LangTools$lastExp = function (exp) {
	lastExp:
	while (true) {
		var _p234 = _elm_lang$core$List$reverse(
			_user$project$Lang$childExps(exp));
		if (_p234.ctor === '[]') {
			return exp;
		} else {
			var _v113 = _p234._0;
			exp = _v113;
			continue lastExp;
		}
	}
};
var _user$project$LangTools$identifiersVisibleAtProgramEnd = function (program) {
	var lastEId = _user$project$LangTools$lastExp(program).val.eid;
	return A2(
		_user$project$LangTools$visibleIdentifiersAtEIds,
		program,
		_elm_lang$core$Set$singleton(lastEId));
};
var _user$project$LangTools$maybeTopLevelChild = function (exp) {
	var _p235 = exp.val.e__;
	_v114_6:
	do {
		switch (_p235.ctor) {
			case 'ETyp':
				return _elm_lang$core$Maybe$Just(_p235._3);
			case 'EColonType':
				return _elm_lang$core$Maybe$Just(_p235._1);
			case 'ETypeAlias':
				return _elm_lang$core$Maybe$Just(_p235._3);
			case 'ELet':
				if (_p235._1.ctor === 'Def') {
					return _elm_lang$core$Maybe$Just(_p235._5);
				} else {
					break _v114_6;
				}
			case 'EComment':
				return _elm_lang$core$Maybe$Just(_p235._2);
			case 'EOption':
				return _elm_lang$core$Maybe$Just(_p235._4);
			default:
				break _v114_6;
		}
	} while(false);
	return _elm_lang$core$Maybe$Nothing;
};
var _user$project$LangTools$topLevelExps = function (program) {
	var _p236 = _user$project$LangTools$maybeTopLevelChild(program);
	if (_p236.ctor === 'Just') {
		return {
			ctor: '::',
			_0: program,
			_1: _user$project$LangTools$topLevelExps(_p236._0)
		};
	} else {
		return {
			ctor: '::',
			_0: program,
			_1: {ctor: '[]'}
		};
	}
};
var _user$project$LangTools$isTopLevelEId = F2(
	function (eid, program) {
		isTopLevelEId:
		while (true) {
			if (_elm_lang$core$Native_Utils.eq(eid, program.val.eid)) {
				return true;
			} else {
				var _p237 = _user$project$LangTools$maybeTopLevelChild(program);
				if (_p237.ctor === 'Just') {
					var _v117 = eid,
						_v118 = _p237._0;
					eid = _v117;
					program = _v118;
					continue isTopLevelEId;
				} else {
					return false;
				}
			}
		}
	});
var _user$project$LangTools$reflowLetWhitespace = F2(
	function (program, letExp) {
		var _p238 = letExp.val.e__;
		if (_p238.ctor === 'ELet') {
			var _p250 = _p238._3;
			var _p249 = _p238._0;
			var _p248 = _p238._1;
			var _p247 = _p238._2;
			var _p246 = _p238._4;
			var _p245 = _p238._5;
			var oldIndentation = _user$project$Lang$indentationOf(letExp);
			var oneOrTwoNewlinesBeforeLet = function () {
				var newlineCount = _elm_lang$core$List$length(
					A2(_elm_lang$core$String$split, '\n', _p249.val)) - 1;
				return (_elm_lang$core$Native_Utils.cmp(newlineCount, 1) < 1) ? '\n' : '\n\n';
			}();
			var _p239 = _p246.val.e__;
			if (_p239.ctor === 'EFun') {
				var _p244 = _p239._1;
				var _p243 = _p239._2;
				var multipleLinesForFunction = A2(
					_elm_lang$core$String$contains,
					'\n',
					_user$project$LangUnparser$unparse(_p243)) || (_elm_lang$core$Native_Utils.cmp(
					_user$project$LangTools$longLineLength,
					_elm_lang$core$String$length(
						A2(
							_elm_lang$core$Basics_ops['++'],
							A2(_user$project$LangUnparser$unparsePatWithUniformWhitespace, true, _p250),
							A3(_user$project$LangUnparser$unparseWithUniformWhitespace, true, true, _p246)))) < 0);
				var newLineForFunctionArgs = _elm_lang$core$Native_Utils.cmp(
					_user$project$LangTools$longLineLength,
					_elm_lang$core$String$length(
						A2(
							_elm_lang$core$Basics_ops['++'],
							A2(_user$project$LangUnparser$unparsePatWithUniformWhitespace, true, _p250),
							A2(
								_elm_lang$core$String$join,
								' ',
								A2(
									_elm_lang$core$List$map,
									_user$project$LangUnparser$unparsePatWithUniformWhitespace(true),
									_p244))))) < 0;
				var _p240 = function () {
					if (A2(_user$project$LangTools$isTopLevelEId, letExp.val.eid, program)) {
						var oldBodyWs = _user$project$Lang$precedingWhitespace(_p245);
						return newLineForFunctionArgs ? {
							ctor: '_Tuple5',
							_0: '\n\n',
							_1: '\n  ',
							_2: '\n    ',
							_3: A2(_user$project$Lang$replaceIndentation, '    ', _p243),
							_4: 2
						} : (multipleLinesForFunction ? {
							ctor: '_Tuple5',
							_0: '\n\n',
							_1: ' ',
							_2: '\n  ',
							_3: A2(_user$project$Lang$replaceIndentation, '  ', _p243),
							_4: 2
						} : {ctor: '_Tuple5', _0: oneOrTwoNewlinesBeforeLet, _1: ' ', _2: ' ', _3: _p243, _4: 1});
					} else {
						var letWs = A2(_elm_lang$core$Basics_ops['++'], oneOrTwoNewlinesBeforeLet, oldIndentation);
						var _p241 = newLineForFunctionArgs ? {
							ctor: '_Tuple3',
							_0: A2(
								_elm_lang$core$Basics_ops['++'],
								'\n',
								A2(_elm_lang$core$Basics_ops['++'], oldIndentation, '  ')),
							_1: A2(
								_elm_lang$core$Basics_ops['++'],
								'\n',
								A2(_elm_lang$core$Basics_ops['++'], oldIndentation, '    ')),
							_2: A2(
								_user$project$Lang$replaceIndentation,
								A2(_elm_lang$core$Basics_ops['++'], oldIndentation, '    '),
								_p243)
						} : (multipleLinesForFunction ? {
							ctor: '_Tuple3',
							_0: ' ',
							_1: A2(
								_elm_lang$core$Basics_ops['++'],
								'\n',
								A2(_elm_lang$core$Basics_ops['++'], oldIndentation, '  ')),
							_2: A2(
								_user$project$Lang$replaceIndentation,
								A2(_elm_lang$core$Basics_ops['++'], oldIndentation, '  '),
								_p243)
						} : {ctor: '_Tuple3', _0: ' ', _1: ' ', _2: _p243});
						var funcWs = _p241._0;
						var fbodyWs = _p241._1;
						var newFBody = _p241._2;
						var bodyMinimalNewlineCount = multipleLinesForFunction ? 2 : 1;
						return {ctor: '_Tuple5', _0: letWs, _1: funcWs, _2: fbodyWs, _3: newFBody, _4: bodyMinimalNewlineCount};
					}
				}();
				var letWs_ = _p240._0;
				var funcWs_ = _p240._1;
				var fbodyWs_ = _p240._2;
				var newFBody = _p240._3;
				var bodyMinimalNewlineCount = _p240._4;
				var _p242 = {
					ctor: '_Tuple3',
					_0: _user$project$Lang$ws(letWs_),
					_1: _user$project$Lang$ws(funcWs_),
					_2: _user$project$Lang$ws(fbodyWs_)
				};
				var letWs = _p242._0;
				var funcWs = _p242._1;
				var fbodyWs = _p242._2;
				var newFunc = A2(
					_user$project$Lang$replaceE__,
					_p246,
					A4(
						_user$project$Lang$EFun,
						funcWs,
						A3(_user$project$Lang$setPatListWhitespace, '', ' ', _p244),
						A2(_user$project$Lang$replacePrecedingWhitespace, fbodyWs_, newFBody),
						_user$project$Lang$space0));
				return A2(
					_user$project$Lang$replaceE__,
					letExp,
					A7(
						_user$project$Lang$ELet,
						letWs,
						_p248,
						_p247,
						A2(_user$project$Lang$replacePrecedingWhitespacePat, ' ', _p250),
						newFunc,
						A3(
							_user$project$Lang$ensureNNewlinesExp,
							bodyMinimalNewlineCount,
							_user$project$Lang$extractIndentation(letWs_),
							_p245),
						_user$project$Lang$space0));
			} else {
				var minimalSurroundingNewlineCount = A2(
					_elm_lang$core$String$contains,
					'\n',
					_user$project$LangUnparser$unparse(_p246)) ? 2 : 1;
				return A2(
					_user$project$Lang$replaceE__,
					letExp,
					A7(
						_user$project$Lang$ELet,
						_user$project$Lang$ws(
							A3(_user$project$Lang$ensureNNewlines, minimalSurroundingNewlineCount, _p249.val, _p249.val)),
						_p248,
						_p247,
						A2(_user$project$Lang$replacePrecedingWhitespacePat, ' ', _p250),
						_p246,
						A3(
							_user$project$Lang$ensureNNewlinesExp,
							minimalSurroundingNewlineCount,
							_user$project$Lang$extractIndentation(_p249.val),
							_p245),
						_user$project$Lang$space0));
			}
		} else {
			return _elm_lang$core$Native_Utils.crashCase(
				'LangTools',
				{
					start: {line: 383, column: 3},
					end: {line: 489, column: 92}
				},
				_p238)(
				A2(
					_elm_lang$core$Basics_ops['++'],
					'reflowLetWhitespace expected an ELet, got: ',
					_user$project$LangUnparser$unparseWithIds(letExp)));
		}
	});
var _user$project$LangTools$newLetFancyWhitespace = F5(
	function (insertedLetEId, pat, boundExp, expToWrap, program) {
		var isTopLevel = A2(_user$project$LangTools$isTopLevelEId, expToWrap.val.eid, program);
		var letOrDef = isTopLevel ? _user$project$Lang$Def : _user$project$Lang$Let;
		var newLetIndentation = function () {
			var _p252 = A2(_user$project$Lang$parentByEId, program, expToWrap.val.eid);
			if ((_p252.ctor === 'Just') && (_p252._0.ctor === 'Just')) {
				var _p254 = _p252._0._0;
				return _elm_lang$core$Native_Utils.eq(
					A2(
						_elm_lang$core$Maybe$map,
						function (_p253) {
							return function (_) {
								return _.eid;
							}(
								function (_) {
									return _.val;
								}(_p253));
						},
						_user$project$LangTools$expToMaybeLetBody(_p254)),
					_elm_lang$core$Maybe$Just(expToWrap.val.eid)) ? A2(_user$project$Lang$indentationAt, _p254.val.eid, program) : A2(_user$project$Lang$indentationAt, expToWrap.val.eid, program);
			} else {
				return A2(_user$project$Lang$indentationAt, expToWrap.val.eid, program);
			}
		}();
		var newlineCountAfterLet = function () {
			var newlinesBeforeWrapped = _elm_lang$core$List$length(
				A2(
					_elm_lang$core$String$split,
					'\n',
					_user$project$Lang$precedingWhitespace(expToWrap))) - 1;
			return (isTopLevel || (_elm_lang$core$Native_Utils.cmp(newlinesBeforeWrapped, 2) > -1)) ? 2 : 1;
		}();
		var newlineCountBeforeLet = _elm_lang$core$Native_Utils.eq(expToWrap.val.eid, program.val.eid) ? 1 : newlineCountAfterLet;
		return A2(
			_user$project$Lang$indent,
			newLetIndentation,
			A2(
				_user$project$Lang$replacePrecedingWhitespace,
				A2(_elm_lang$core$String$repeat, newlineCountBeforeLet, '\n'),
				A2(
					_user$project$Lang$withDummyExpInfoEId,
					insertedLetEId,
					A7(
						_user$project$Lang$ELet,
						_user$project$Lang$space0,
						letOrDef,
						false,
						_user$project$Lang$ensureWhitespacePat(pat),
						_user$project$Lang$ensureWhitespaceExp(
							A2(_user$project$Lang$replaceIndentation, '  ', boundExp)),
						A3(
							_user$project$Lang$ensureWhitespaceSmartExp,
							newlineCountAfterLet,
							(_user$project$Lang$isLet(expToWrap) || isTopLevel) ? '' : '  ',
							expToWrap),
						_user$project$Lang$space0))));
	});
var _user$project$LangTools$isTopLevel = F2(
	function (exp, program) {
		isTopLevel:
		while (true) {
			if (_elm_lang$core$Native_Utils.eq(exp, program)) {
				return true;
			} else {
				var _p255 = _user$project$LangTools$maybeTopLevelChild(program);
				if (_p255.ctor === 'Just') {
					var _v123 = exp,
						_v124 = _p255._0;
					exp = _v123;
					program = _v124;
					continue isTopLevel;
				} else {
					return false;
				}
			}
		}
	});
var _user$project$LangTools$expToLocation = function (exp) {
	return {ctor: '_Tuple2', _0: exp.start.line, _1: exp.start.col};
};
var _user$project$LangTools$justFindExpWithAncestorsByEId = F2(
	function (root, eid) {
		return A2(
			_user$project$Utils$fromJust__,
			function (_p256) {
				var _p257 = _p256;
				return A2(
					_elm_lang$core$Basics_ops['++'],
					'justFindExpWithAncestorsByEId: Couldn\'t find eid ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_elm_lang$core$Basics$toString(eid),
						A2(
							_elm_lang$core$Basics_ops['++'],
							' in ',
							_user$project$LangUnparser$unparseWithIds(root))));
			},
			A2(_user$project$Lang$findWithAncestorsByEId, root, eid));
	});
var _user$project$LangTools$deepestAncestorWithNewline = F2(
	function (program, eid) {
		var ancestors = A2(
			_user$project$Utils$dropLast,
			1,
			A2(_user$project$LangTools$justFindExpWithAncestorsByEId, program, eid));
		var ancestorsWithNewlines = A2(
			_elm_lang$core$List$filter,
			function (_p258) {
				return A2(
					_elm_lang$core$String$contains,
					'\n',
					_user$project$Lang$precedingWhitespace(_p258));
			},
			ancestors);
		return _user$project$Utils$last_(
			{ctor: '::', _0: program, _1: ancestorsWithNewlines});
	});
var _user$project$LangTools$justFindExpByEId = F2(
	function (exp, eid) {
		return A2(
			_user$project$Utils$fromJust__,
			function (_p259) {
				var _p260 = _p259;
				return A2(
					_elm_lang$core$Basics_ops['++'],
					'Couldn\'t find eid ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_elm_lang$core$Basics$toString(eid),
						A2(
							_elm_lang$core$Basics_ops['++'],
							' in ',
							_user$project$LangUnparser$unparseWithIds(exp))));
			},
			A2(_user$project$Lang$findExpByEId, exp, eid));
	});
var _user$project$LangTools$locationInProgram = F2(
	function (program, eid) {
		return _user$project$LangTools$expToLocation(
			A2(_user$project$LangTools$justFindExpByEId, program, eid));
	});
var _user$project$LangTools$allLocsAndNumbers = function (exp) {
	return A3(
		_user$project$Lang$foldExpViaE__,
		F2(
			function (e__, acc) {
				var _p261 = e__;
				if (_p261.ctor === 'EConst') {
					return {
						ctor: '::',
						_0: {ctor: '_Tuple2', _0: _p261._2, _1: _p261._1},
						_1: acc
					};
				} else {
					return acc;
				}
			}),
		{ctor: '[]'},
		exp);
};
var _user$project$LangTools$allLocIds = function (exp) {
	return A2(
		_elm_lang$core$List$map,
		function (_p262) {
			var _p263 = _p262;
			return _p263._0._0;
		},
		_user$project$LangTools$allLocsAndNumbers(exp));
};
var _user$project$LangTools$frozenLocIdsAndNumbers = function (exp) {
	return A2(
		_elm_lang$core$List$map,
		function (_p264) {
			var _p265 = _p264;
			return {ctor: '_Tuple2', _0: _p265._0._0, _1: _p265._1};
		},
		A2(
			_elm_lang$core$List$filter,
			function (_p266) {
				var _p267 = _p266;
				return _elm_lang$core$Native_Utils.eq(_p267._0._1, '!') || _user$project$FastParser$isPreludeLocId(_p267._0._0);
			},
			_user$project$LangTools$allLocsAndNumbers(exp)));
};
var _user$project$LangTools$unfrozenLocIdsAndNumbers = function (exp) {
	return A2(
		_elm_lang$core$List$map,
		function (_p268) {
			var _p269 = _p268;
			return {ctor: '_Tuple2', _0: _p269._0._0, _1: _p269._1};
		},
		A2(
			_elm_lang$core$List$filter,
			function (_p270) {
				var _p271 = _p270;
				return (!_elm_lang$core$Native_Utils.eq(_p271._0._1, '!')) && (!_user$project$FastParser$isPreludeLocId(_p271._0._0));
			},
			_user$project$LangTools$allLocsAndNumbers(exp)));
};
var _user$project$LangTools$replaceConstsWithVars = F2(
	function (locIdToNewName, exp) {
		var replacer = function (exp__) {
			var _p272 = exp__;
			if ((_p272.ctor === 'EConst') && (_p272._2.ctor === '_Tuple3')) {
				var _p273 = A2(_elm_lang$core$Dict$get, _p272._2._0, locIdToNewName);
				if (_p273.ctor === 'Just') {
					return A2(_user$project$Lang$EVar, _p272._0, _p273._0);
				} else {
					return exp__;
				}
			} else {
				return exp__;
			}
		};
		return A2(_user$project$Lang$mapExpViaExp__, replacer, exp);
	});
var _user$project$LangTools$patternListsEqual = F2(
	function (patsA, patsB) {
		return A2(
			_elm_lang$core$Maybe$withDefault,
			false,
			A2(
				_elm_lang$core$Maybe$map,
				_elm_lang$core$List$all(
					function (_p274) {
						var _p275 = _p274;
						return A2(_user$project$LangTools$patternsEqual, _p275._0, _p275._1);
					}),
				A2(_user$project$Utils$maybeZip, patsA, patsB)));
	});
var _user$project$LangTools$patternsEqual = F2(
	function (patA, patB) {
		var _p276 = {ctor: '_Tuple2', _0: patA.val.p__, _1: patB.val.p__};
		_v136_6:
		do {
			if (_p276.ctor === '_Tuple2') {
				switch (_p276._0.ctor) {
					case 'PVar':
						if (_p276._1.ctor === 'PVar') {
							return _elm_lang$core$Native_Utils.eq(_p276._0._1, _p276._1._1);
						} else {
							break _v136_6;
						}
					case 'PConst':
						if (_p276._1.ctor === 'PConst') {
							return _elm_lang$core$Native_Utils.eq(_p276._0._1, _p276._1._1);
						} else {
							break _v136_6;
						}
					case 'PBase':
						if (_p276._1.ctor === 'PBase') {
							return A2(_user$project$Lang$eBaseValsEqual, _p276._0._1, _p276._1._1);
						} else {
							break _v136_6;
						}
					case 'PList':
						if (_p276._0._3.ctor === 'Nothing') {
							if ((_p276._1.ctor === 'PList') && (_p276._1._3.ctor === 'Nothing')) {
								return A2(_user$project$LangTools$patternListsEqual, _p276._0._1, _p276._1._1);
							} else {
								break _v136_6;
							}
						} else {
							if ((_p276._1.ctor === 'PList') && (_p276._1._3.ctor === 'Just')) {
								return A2(
									_user$project$LangTools$patternListsEqual,
									{ctor: '::', _0: _p276._0._3._0, _1: _p276._0._1},
									{ctor: '::', _0: _p276._1._3._0, _1: _p276._1._1});
							} else {
								break _v136_6;
							}
						}
					default:
						if (_p276._1.ctor === 'PAs') {
							return _elm_lang$core$Native_Utils.eq(_p276._0._1, _p276._1._1) && A2(_user$project$LangTools$patternsEqual, _p276._0._3, _p276._1._3);
						} else {
							break _v136_6;
						}
				}
			} else {
				break _v136_6;
			}
		} while(false);
		return false;
	});
var _user$project$LangTools$extraExpsDiff = F2(
	function (baseExp, otherExp) {
		extraExpsDiff:
		while (true) {
			var childDiffs = function (_p277) {
				var _p278 = _p277;
				var _p279 = A2(
					_user$project$Utils$maybeZip,
					_user$project$Lang$childExps(baseExp),
					_user$project$Lang$childExps(otherExp));
				if (_p279.ctor === 'Just') {
					return A2(
						_elm_lang$core$List$concatMap,
						function (_p280) {
							var _p281 = _p280;
							return A2(_user$project$LangTools$extraExpsDiff, _p281._0, _p281._1);
						},
						_p279._0);
				} else {
					return {
						ctor: '::',
						_0: otherExp,
						_1: {ctor: '[]'}
					};
				}
			};
			var _p282 = {ctor: '_Tuple2', _0: baseExp.val.e__, _1: otherExp.val.e__};
			_v140_18:
			do {
				_v140_13:
				do {
					if (_p282.ctor === '_Tuple2') {
						switch (_p282._0.ctor) {
							case 'EConst':
								switch (_p282._1.ctor) {
									case 'EConst':
										return _elm_lang$core$Native_Utils.eq(_p282._0._1, _p282._1._1) ? {ctor: '[]'} : {
											ctor: '::',
											_0: otherExp,
											_1: {ctor: '[]'}
										};
									case 'EComment':
										break _v140_13;
									default:
										break _v140_18;
								}
							case 'EBase':
								switch (_p282._1.ctor) {
									case 'EBase':
										return A2(_user$project$Lang$eBaseValsEqual, _p282._0._1, _p282._1._1) ? {ctor: '[]'} : {
											ctor: '::',
											_0: otherExp,
											_1: {ctor: '[]'}
										};
									case 'EComment':
										break _v140_13;
									default:
										break _v140_18;
								}
							case 'EVar':
								switch (_p282._1.ctor) {
									case 'EVar':
										return _elm_lang$core$Native_Utils.eq(_p282._0._1, _p282._1._1) ? {ctor: '[]'} : {
											ctor: '::',
											_0: otherExp,
											_1: {ctor: '[]'}
										};
									case 'EComment':
										break _v140_13;
									default:
										break _v140_18;
								}
							case 'EFun':
								switch (_p282._1.ctor) {
									case 'EFun':
										if (A2(_user$project$LangTools$patternListsEqual, _p282._0._1, _p282._1._1)) {
											var _v141 = _p282._0._2,
												_v142 = _p282._1._2;
											baseExp = _v141;
											otherExp = _v142;
											continue extraExpsDiff;
										} else {
											return {
												ctor: '::',
												_0: otherExp,
												_1: {ctor: '[]'}
											};
										}
									case 'EComment':
										break _v140_13;
									default:
										break _v140_18;
								}
							case 'EOp':
								switch (_p282._1.ctor) {
									case 'EOp':
										return _elm_lang$core$Native_Utils.eq(_p282._0._1.val, _p282._1._1.val) ? childDiffs(
											{ctor: '_Tuple0'}) : {
											ctor: '::',
											_0: otherExp,
											_1: {ctor: '[]'}
										};
									case 'EComment':
										break _v140_13;
									default:
										break _v140_18;
								}
							case 'EList':
								switch (_p282._1.ctor) {
									case 'EList':
										if (_p282._0._3.ctor === 'Nothing') {
											if (_p282._1._3.ctor === 'Nothing') {
												return childDiffs(
													{ctor: '_Tuple0'});
											} else {
												break _v140_18;
											}
										} else {
											if (_p282._1._3.ctor === 'Just') {
												return childDiffs(
													{ctor: '_Tuple0'});
											} else {
												break _v140_18;
											}
										}
									case 'EComment':
										break _v140_13;
									default:
										break _v140_18;
								}
							case 'EApp':
								switch (_p282._1.ctor) {
									case 'EApp':
										return childDiffs(
											{ctor: '_Tuple0'});
									case 'EComment':
										break _v140_13;
									default:
										break _v140_18;
								}
							case 'ELet':
								switch (_p282._1.ctor) {
									case 'ELet':
										return (_elm_lang$core$Native_Utils.eq(_p282._0._2, _p282._1._2) && A2(_user$project$LangTools$patternsEqual, _p282._0._3, _p282._1._3)) ? A2(
											_elm_lang$core$Basics_ops['++'],
											A2(_user$project$LangTools$extraExpsDiff, _p282._0._4, _p282._1._4),
											A2(_user$project$LangTools$extraExpsDiff, _p282._0._5, _p282._1._5)) : {
											ctor: '::',
											_0: otherExp,
											_1: {ctor: '[]'}
										};
									case 'EComment':
										break _v140_13;
									default:
										break _v140_18;
								}
							case 'EIf':
								switch (_p282._1.ctor) {
									case 'EIf':
										return A2(
											_elm_lang$core$Basics_ops['++'],
											A2(_user$project$LangTools$extraExpsDiff, _p282._0._1, _p282._1._1),
											A2(
												_elm_lang$core$Basics_ops['++'],
												A2(_user$project$LangTools$extraExpsDiff, _p282._0._2, _p282._1._2),
												A2(_user$project$LangTools$extraExpsDiff, _p282._0._3, _p282._1._3)));
									case 'EComment':
										break _v140_13;
									default:
										break _v140_18;
								}
							case 'ECase':
								switch (_p282._1.ctor) {
									case 'ECase':
										return A2(
											_elm_lang$core$Maybe$withDefault,
											{
												ctor: '::',
												_0: otherExp,
												_1: {ctor: '[]'}
											},
											A2(
												_elm_lang$core$Maybe$andThen,
												function (branchPairs) {
													var bValPairs = A2(
														_elm_lang$core$List$map,
														function (_p283) {
															var _p284 = _p283;
															return {ctor: '_Tuple2', _0: _p284._0.val, _1: _p284._1.val};
														},
														branchPairs);
													return A2(
														_elm_lang$core$List$all,
														function (_p285) {
															var _p286 = _p285;
															return A2(_user$project$LangTools$patternsEqual, _p286._0._1, _p286._1._1);
														},
														bValPairs) ? _elm_lang$core$Maybe$Just(
														childDiffs(
															{ctor: '_Tuple0'})) : _elm_lang$core$Maybe$Nothing;
												},
												A2(_user$project$Utils$maybeZip, _p282._0._2, _p282._1._2)));
									case 'EComment':
										break _v140_13;
									default:
										break _v140_18;
								}
							case 'ETypeCase':
								switch (_p282._1.ctor) {
									case 'ETypeCase':
										return A2(_user$project$LangTools$patternsEqual, _p282._0._1, _p282._1._1) ? A2(
											_elm_lang$core$Maybe$withDefault,
											{
												ctor: '::',
												_0: otherExp,
												_1: {ctor: '[]'}
											},
											A2(
												_elm_lang$core$Maybe$andThen,
												function (tbranchPairs) {
													var tbValPairs = A2(
														_elm_lang$core$List$map,
														function (_p287) {
															var _p288 = _p287;
															return {ctor: '_Tuple2', _0: _p288._0.val, _1: _p288._1.val};
														},
														tbranchPairs);
													return A2(
														_elm_lang$core$List$all,
														function (_p289) {
															var _p290 = _p289;
															return A2(_user$project$Types$equal, _p290._0._1, _p290._1._1);
														},
														tbValPairs) ? _elm_lang$core$Maybe$Just(
														childDiffs(
															{ctor: '_Tuple0'})) : _elm_lang$core$Maybe$Nothing;
												},
												A2(_user$project$Utils$maybeZip, _p282._0._2, _p282._1._2))) : {
											ctor: '::',
											_0: otherExp,
											_1: {ctor: '[]'}
										};
									case 'EComment':
										break _v140_13;
									default:
										break _v140_18;
								}
							case 'EComment':
								var _v147 = _p282._0._2,
									_v148 = otherExp;
								baseExp = _v147;
								otherExp = _v148;
								continue extraExpsDiff;
							case 'EOption':
								switch (_p282._1.ctor) {
									case 'EComment':
										break _v140_13;
									case 'EOption':
										return {
											ctor: '::',
											_0: otherExp,
											_1: {ctor: '[]'}
										};
									default:
										break _v140_18;
								}
							case 'ETyp':
								switch (_p282._1.ctor) {
									case 'EComment':
										break _v140_13;
									case 'ETyp':
										if (A2(_user$project$LangTools$patternsEqual, _p282._0._1, _p282._1._1) && A2(_user$project$Types$equal, _p282._0._2, _p282._1._2)) {
											var _v149 = _p282._0._3,
												_v150 = _p282._1._3;
											baseExp = _v149;
											otherExp = _v150;
											continue extraExpsDiff;
										} else {
											return {
												ctor: '::',
												_0: otherExp,
												_1: {ctor: '[]'}
											};
										}
									default:
										break _v140_18;
								}
							case 'EColonType':
								switch (_p282._1.ctor) {
									case 'EComment':
										break _v140_13;
									case 'EColonType':
										if (A2(_user$project$Types$equal, _p282._0._3, _p282._1._3)) {
											var _v151 = _p282._0._1,
												_v152 = _p282._1._1;
											baseExp = _v151;
											otherExp = _v152;
											continue extraExpsDiff;
										} else {
											return {
												ctor: '::',
												_0: otherExp,
												_1: {ctor: '[]'}
											};
										}
									default:
										break _v140_18;
								}
							default:
								switch (_p282._1.ctor) {
									case 'EComment':
										break _v140_13;
									case 'ETypeAlias':
										if (A2(_user$project$LangTools$patternsEqual, _p282._0._1, _p282._1._1) && A2(_user$project$Types$equal, _p282._0._2, _p282._1._2)) {
											var _v153 = _p282._0._3,
												_v154 = _p282._1._3;
											baseExp = _v153;
											otherExp = _v154;
											continue extraExpsDiff;
										} else {
											return {
												ctor: '::',
												_0: otherExp,
												_1: {ctor: '[]'}
											};
										}
									default:
										break _v140_18;
								}
						}
					} else {
						break _v140_18;
					}
				} while(false);
				var _v155 = baseExp,
					_v156 = _p282._1._2;
				baseExp = _v155;
				otherExp = _v156;
				continue extraExpsDiff;
			} while(false);
			return {
				ctor: '::',
				_0: otherExp,
				_1: {ctor: '[]'}
			};
		}
	});
var _user$project$LangTools$countNodes = F2(
	function (pred, exp) {
		return A2(
			_user$project$Utils$count,
			pred,
			_user$project$Lang$flattenExpTree(exp));
	});
var _user$project$LangTools$typeNodeCount = function (tipe) {
	var _p291 = tipe.val;
	switch (_p291.ctor) {
		case 'TNum':
			return 1;
		case 'TBool':
			return 1;
		case 'TString':
			return 1;
		case 'TNull':
			return 1;
		case 'TList':
			return 1 + _user$project$LangTools$typeNodeCount(_p291._1);
		case 'TDict':
			return (1 + _user$project$LangTools$typeNodeCount(_p291._1)) + _user$project$LangTools$typeNodeCount(_p291._2);
		case 'TTuple':
			if (_p291._3.ctor === 'Nothing') {
				return 1 + _user$project$LangTools$typesNodeCount(_p291._1);
			} else {
				return (1 + _user$project$LangTools$typesNodeCount(_p291._1)) + _user$project$LangTools$typeNodeCount(_p291._3._0);
			}
		case 'TArrow':
			return 1 + _user$project$LangTools$typesNodeCount(_p291._1);
		case 'TUnion':
			return 1 + _user$project$LangTools$typesNodeCount(_p291._1);
		case 'TNamed':
			return 1;
		case 'TVar':
			return 1;
		case 'TForall':
			if (_p291._1.ctor === 'One') {
				return 1 + _user$project$LangTools$typeNodeCount(_p291._2);
			} else {
				return (1 + _elm_lang$core$List$length(_p291._1._1)) + _user$project$LangTools$typeNodeCount(_p291._2);
			}
		default:
			return 1;
	}
};
var _user$project$LangTools$typesNodeCount = function (types) {
	return _elm_lang$core$List$sum(
		A2(_elm_lang$core$List$map, _user$project$LangTools$typeNodeCount, types));
};
var _user$project$LangTools$patNodeCount = function (pat) {
	var _p292 = pat.val.p__;
	switch (_p292.ctor) {
		case 'PVar':
			return 1;
		case 'PConst':
			return 1;
		case 'PBase':
			return 1;
		case 'PList':
			if (_p292._3.ctor === 'Just') {
				return (1 + _user$project$LangTools$patsNodeCount(_p292._1)) + _user$project$LangTools$patNodeCount(_p292._3._0);
			} else {
				return 1 + _user$project$LangTools$patsNodeCount(_p292._1);
			}
		default:
			return 1 + _user$project$LangTools$patNodeCount(_p292._3);
	}
};
var _user$project$LangTools$patsNodeCount = function (pats) {
	return _elm_lang$core$List$sum(
		A2(_elm_lang$core$List$map, _user$project$LangTools$patNodeCount, pats));
};
var _user$project$LangTools$subExpsOfSizeAtLeast_ = F2(
	function (min, exp) {
		var _p293 = function (_p294) {
			var _p295 = _p294;
			return {
				ctor: '_Tuple2',
				_0: _elm_lang$core$List$sum(_p295._0),
				_1: _elm_lang$core$List$concat(_p295._1)
			};
		}(
			_elm_lang$core$List$unzip(
				A2(
					_elm_lang$core$List$map,
					_user$project$LangTools$subExpsOfSizeAtLeast_(min),
					_user$project$Lang$childExps(exp))));
		var childrenTotal = _p293._0;
		var largeSubExps = _p293._1;
		if (_elm_lang$core$Native_Utils.cmp(childrenTotal, min) > -1) {
			return (!_user$project$Lang$isComment(exp)) ? {
				ctor: '_Tuple2',
				_0: childrenTotal,
				_1: {ctor: '::', _0: exp, _1: largeSubExps}
			} : {ctor: '_Tuple2', _0: childrenTotal, _1: largeSubExps};
		} else {
			var thisSizeWithoutChildren = function () {
				var _p296 = exp.val.e__;
				switch (_p296.ctor) {
					case 'EConst':
						return 1;
					case 'EBase':
						return 1;
					case 'EVar':
						return 1;
					case 'EFun':
						return 1 + _user$project$LangTools$patsNodeCount(_p296._1);
					case 'EOp':
						return 1;
					case 'EList':
						if (_p296._3.ctor === 'Just') {
							return 1;
						} else {
							return 1;
						}
					case 'EIf':
						return 1;
					case 'ECase':
						var _p297 = _p296._2;
						return (1 + _elm_lang$core$List$length(_p297)) + _user$project$LangTools$patsNodeCount(
							_user$project$Lang$branchPats(_p297));
					case 'ETypeCase':
						var _p298 = _p296._2;
						return ((1 + _elm_lang$core$List$length(_p298)) + _user$project$LangTools$patNodeCount(_p296._1)) + _user$project$LangTools$typesNodeCount(
							_user$project$Lang$tbranchTypes(_p298));
					case 'EApp':
						return 1;
					case 'ELet':
						return 1 + _user$project$LangTools$patNodeCount(_p296._3);
					case 'EComment':
						return 0;
					case 'EOption':
						return 1;
					case 'ETyp':
						return (1 + _user$project$LangTools$patNodeCount(_p296._1)) + _user$project$LangTools$typeNodeCount(_p296._2);
					case 'EColonType':
						return 1 + _user$project$LangTools$typeNodeCount(_p296._3);
					default:
						return (1 + _user$project$LangTools$patNodeCount(_p296._1)) + _user$project$LangTools$typeNodeCount(_p296._2);
				}
			}();
			if (!_elm_lang$core$Native_Utils.eq(
				largeSubExps,
				{ctor: '[]'})) {
				return _elm_lang$core$Native_Utils.crash(
					'LangTools',
					{
						start: {line: 97, column: 7},
						end: {line: 97, column: 18}
					})('LangTools.thisSizeWithoutChildren bug');
			} else {
				var thisSize = thisSizeWithoutChildren + childrenTotal;
				return {
					ctor: '_Tuple2',
					_0: thisSize,
					_1: (_elm_lang$core$Native_Utils.cmp(thisSize, min) > -1) ? {
						ctor: '::',
						_0: exp,
						_1: {ctor: '[]'}
					} : {ctor: '[]'}
				};
			}
		}
	});
var _user$project$LangTools$subExpsOfSizeAtLeast = F2(
	function (min, exp) {
		var _p299 = A2(_user$project$LangTools$subExpsOfSizeAtLeast_, min, exp);
		var exps = _p299._1;
		return exps;
	});
var _user$project$LangTools$nodeCount = function (exp) {
	var expsNodeCount = function (exps) {
		return _elm_lang$core$List$sum(
			A2(_elm_lang$core$List$map, _user$project$LangTools$nodeCount, exps));
	};
	var _p300 = exp.val.e__;
	switch (_p300.ctor) {
		case 'EConst':
			return 1;
		case 'EBase':
			return 1;
		case 'EVar':
			return 1;
		case 'EFun':
			return (1 + _user$project$LangTools$patsNodeCount(_p300._1)) + _user$project$LangTools$nodeCount(_p300._2);
		case 'EOp':
			return 1 + expsNodeCount(_p300._2);
		case 'EList':
			if (_p300._3.ctor === 'Just') {
				return (1 + expsNodeCount(_p300._1)) + _user$project$LangTools$nodeCount(_p300._3._0);
			} else {
				return 1 + expsNodeCount(_p300._1);
			}
		case 'EIf':
			return 1 + expsNodeCount(
				{
					ctor: '::',
					_0: _p300._1,
					_1: {
						ctor: '::',
						_0: _p300._2,
						_1: {
							ctor: '::',
							_0: _p300._3,
							_1: {ctor: '[]'}
						}
					}
				});
		case 'ECase':
			var _p301 = _p300._2;
			return (((1 + _elm_lang$core$List$length(_p301)) + _user$project$LangTools$nodeCount(_p300._1)) + _user$project$LangTools$patsNodeCount(
				_user$project$Lang$branchPats(_p301))) + expsNodeCount(
				_user$project$Lang$branchExps(_p301));
		case 'ETypeCase':
			var _p302 = _p300._2;
			return (((1 + _elm_lang$core$List$length(_p302)) + _user$project$LangTools$patNodeCount(_p300._1)) + _user$project$LangTools$typesNodeCount(
				_user$project$Lang$tbranchTypes(_p302))) + expsNodeCount(
				_user$project$Lang$tbranchExps(_p302));
		case 'EApp':
			return (1 + _user$project$LangTools$nodeCount(_p300._1)) + expsNodeCount(_p300._2);
		case 'ELet':
			return ((1 + _user$project$LangTools$patNodeCount(_p300._3)) + _user$project$LangTools$nodeCount(_p300._4)) + _user$project$LangTools$nodeCount(_p300._5);
		case 'EComment':
			return 0 + _user$project$LangTools$nodeCount(_p300._2);
		case 'EOption':
			return 1 + _user$project$LangTools$nodeCount(_p300._4);
		case 'ETyp':
			return ((1 + _user$project$LangTools$patNodeCount(_p300._1)) + _user$project$LangTools$typeNodeCount(_p300._2)) + _user$project$LangTools$nodeCount(_p300._3);
		case 'EColonType':
			return (1 + _user$project$LangTools$typeNodeCount(_p300._3)) + _user$project$LangTools$nodeCount(_p300._1);
		default:
			return ((1 + _user$project$LangTools$patNodeCount(_p300._1)) + _user$project$LangTools$typeNodeCount(_p300._2)) + _user$project$LangTools$nodeCount(_p300._3);
	}
};
var _user$project$LangTools$CannotCompare = {ctor: 'CannotCompare'};
var _user$project$LangTools$NoMatch = {ctor: 'NoMatch'};
var _user$project$LangTools$Match = function (a) {
	return {ctor: 'Match', _0: a};
};
var _user$project$LangTools$tryMatchExp = F2(
	function (pat, exp) {
		tryMatchExp:
		while (true) {
			var matchMap = F2(
				function (f, matchResult) {
					var _p303 = matchResult;
					if (_p303.ctor === 'Match') {
						return _user$project$LangTools$Match(
							f(_p303._0));
					} else {
						return matchResult;
					}
				});
			var projMatches = function (resultList) {
				return A3(
					_elm_lang$core$List$foldl,
					F2(
						function (matchResult, acc) {
							var _p304 = {ctor: '_Tuple2', _0: matchResult, _1: acc};
							_v163_1:
							do {
								if (_p304._0.ctor === 'Match') {
									switch (_p304._1.ctor) {
										case 'Match':
											return _user$project$LangTools$Match(
												A2(_elm_lang$core$Basics_ops['++'], _p304._0._0, _p304._1._0));
										case 'CannotCompare':
											break _v163_1;
										default:
											break _v163_1;
									}
								} else {
									if (_p304._1.ctor === 'CannotCompare') {
										return _user$project$LangTools$CannotCompare;
									} else {
										return _p304._0;
									}
								}
							} while(false);
							return _p304._1;
						}),
					_user$project$LangTools$Match(
						{ctor: '[]'}),
					resultList);
			};
			var _p305 = exp.val.e__;
			if (_p305.ctor === 'EColonType') {
				var _v165 = pat,
					_v166 = _p305._1;
				pat = _v165;
				exp = _v166;
				continue tryMatchExp;
			} else {
				var _p306 = pat.val.p__;
				switch (_p306.ctor) {
					case 'PVar':
						return _user$project$LangTools$Match(
							{
								ctor: '::',
								_0: {ctor: '_Tuple2', _0: _p306._1, _1: exp},
								_1: {ctor: '[]'}
							});
					case 'PAs':
						return A2(
							matchMap,
							function (env) {
								return {
									ctor: '::',
									_0: {ctor: '_Tuple2', _0: _p306._1, _1: exp},
									_1: env
								};
							},
							A2(_user$project$LangTools$tryMatchExp, _p306._3, exp));
					case 'PList':
						if (_p306._3.ctor === 'Nothing') {
							var _p307 = exp.val.e__;
							if ((_p307.ctor === 'EList') && (_p307._3.ctor === 'Nothing')) {
								var _p308 = A2(_user$project$Utils$maybeZip, _p306._1, _p307._1);
								if (_p308.ctor === 'Nothing') {
									return _user$project$LangTools$NoMatch;
								} else {
									return projMatches(
										A2(
											_elm_lang$core$List$map,
											function (_p309) {
												var _p310 = _p309;
												return A2(_user$project$LangTools$tryMatchExp, _p310._0, _p310._1);
											},
											_p308._0));
								}
							} else {
								return _user$project$LangTools$CannotCompare;
							}
						} else {
							var _p320 = _p306._3._0;
							var _p319 = _p306._1;
							var _p311 = exp.val.e__;
							if (_p311.ctor === 'EList') {
								if (_p311._3.ctor === 'Nothing') {
									var _p315 = _p311._1;
									if (_elm_lang$core$Native_Utils.cmp(
										_elm_lang$core$List$length(_p315),
										_elm_lang$core$List$length(_p319)) < 0) {
										return _user$project$LangTools$NoMatch;
									} else {
										var _p312 = A2(
											_user$project$Utils$split,
											_elm_lang$core$List$length(_p319),
											_p315);
										var headExps = _p312._0;
										var tailExps = _p312._1;
										var tryHeadMatch = projMatches(
											A2(
												_elm_lang$core$List$map,
												function (_p313) {
													var _p314 = _p313;
													return A2(_user$project$LangTools$tryMatchExp, _p314._0, _p314._1);
												},
												A2(_user$project$Utils$zip, _p319, headExps)));
										var tryTailMatch = A2(
											_user$project$LangTools$tryMatchExp,
											_p320,
											A2(_user$project$Lang$eList, tailExps, _elm_lang$core$Maybe$Nothing));
										return projMatches(
											{
												ctor: '::',
												_0: tryHeadMatch,
												_1: {
													ctor: '::',
													_0: tryTailMatch,
													_1: {ctor: '[]'}
												}
											});
									}
								} else {
									var _p318 = _p311._1;
									if (_elm_lang$core$Native_Utils.cmp(
										_elm_lang$core$List$length(_p318),
										_elm_lang$core$List$length(_p319)) < 0) {
										return _user$project$LangTools$NoMatch;
									} else {
										if (!_elm_lang$core$Native_Utils.eq(
											_elm_lang$core$List$length(_p318),
											_elm_lang$core$List$length(_p319))) {
											return _user$project$LangTools$CannotCompare;
										} else {
											var tryHeadMatch = projMatches(
												A2(
													_elm_lang$core$List$map,
													function (_p316) {
														var _p317 = _p316;
														return A2(_user$project$LangTools$tryMatchExp, _p317._0, _p317._1);
													},
													A2(_user$project$Utils$zip, _p319, _p318)));
											var tryTailMatch = A2(_user$project$LangTools$tryMatchExp, _p320, _p311._3._0);
											return projMatches(
												{
													ctor: '::',
													_0: tryHeadMatch,
													_1: {
														ctor: '::',
														_0: tryTailMatch,
														_1: {ctor: '[]'}
													}
												});
										}
									}
								}
							} else {
								return _user$project$LangTools$CannotCompare;
							}
						}
					case 'PConst':
						var _p321 = exp.val.e__;
						if (_p321.ctor === 'EConst') {
							return _elm_lang$core$Native_Utils.eq(_p306._1, _p321._1) ? _user$project$LangTools$Match(
								{ctor: '[]'}) : _user$project$LangTools$NoMatch;
						} else {
							return _user$project$LangTools$CannotCompare;
						}
					default:
						var _p322 = exp.val.e__;
						if (_p322.ctor === 'EBase') {
							return A2(_user$project$Lang$eBaseValsEqual, _p306._1, _p322._1) ? _user$project$LangTools$Match(
								{ctor: '[]'}) : _user$project$LangTools$NoMatch;
						} else {
							return _user$project$LangTools$CannotCompare;
						}
				}
			}
		}
	});
var _user$project$LangTools$tryMatchExpReturningList = F2(
	function (pat, exp) {
		var _p323 = A2(_user$project$LangTools$tryMatchExp, pat, exp);
		if (_p323.ctor === 'Match') {
			return _p323._0;
		} else {
			return {ctor: '[]'};
		}
	});
var _user$project$LangTools$findPatAndBoundExpByPId = F2(
	function (targetPId, exp) {
		var _p324 = A2(_user$project$LangTools$findScopeExpAndPat, targetPId, exp);
		if (_p324.ctor === 'Just') {
			var _p326 = _p324._0._1;
			var _p325 = {
				ctor: '_Tuple2',
				_0: _user$project$LangTools$expToMaybeLetPatAndBoundExp(_p324._0._0),
				_1: _user$project$LangTools$patToMaybeIdent(_p326)
			};
			if ((((_p325.ctor === '_Tuple2') && (_p325._0.ctor === 'Just')) && (_p325._0._0.ctor === '_Tuple2')) && (_p325._1.ctor === 'Just')) {
				return A2(
					_elm_lang$core$Maybe$map,
					function (boundExp) {
						return {ctor: '_Tuple2', _0: _p326, _1: boundExp};
					},
					A2(
						_user$project$Utils$maybeFind,
						_p325._1._0,
						A2(_user$project$LangTools$tryMatchExpReturningList, _p325._0._0._0, _p325._0._0._1)));
			} else {
				return _elm_lang$core$Maybe$Nothing;
			}
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$LangTools$findBoundExpByPId = F2(
	function (targetPId, exp) {
		return A2(
			_elm_lang$core$Maybe$map,
			function (_p327) {
				var _p328 = _p327;
				return _p328._1;
			},
			A2(_user$project$LangTools$findPatAndBoundExpByPId, targetPId, exp));
	});
var _user$project$LangTools$findLetAndIdentBindingExp = F2(
	function (targetEId, program) {
		return A2(
			_user$project$Lang$mapFirstSuccessNode,
			function (exp) {
				var _p329 = exp.val.e__;
				if (_p329.ctor === 'ELet') {
					return A2(
						_user$project$Utils$mapFirstSuccess,
						function (_p330) {
							var _p331 = _p330;
							return _elm_lang$core$Native_Utils.eq(_p331._1.val.eid, targetEId) ? _elm_lang$core$Maybe$Just(
								{ctor: '_Tuple2', _0: exp, _1: _p331._0}) : _elm_lang$core$Maybe$Nothing;
						},
						A2(_user$project$LangTools$tryMatchExpReturningList, _p329._3, _p329._4));
				} else {
					return _elm_lang$core$Maybe$Nothing;
				}
			},
			program);
	});
var _user$project$LangTools$allSimplyResolvableLetBindings = function (program) {
	return A2(
		_elm_lang$core$List$concatMap,
		function (exp) {
			var _p332 = exp.val.e__;
			if (_p332.ctor === 'ELet') {
				return A2(_user$project$LangTools$tryMatchExpReturningList, _p332._3, _p332._4);
			} else {
				return {ctor: '[]'};
			}
		},
		_user$project$Lang$flattenExpTree(program));
};
var _user$project$LangTools$numericLetBoundIdentifiers = function (program) {
	var isSurelyNumeric = F2(
		function (numericIdents, exp) {
			var recurse = function (e) {
				return A2(isSurelyNumeric, numericIdents, e);
			};
			var _p333 = exp.val.e__;
			switch (_p333.ctor) {
				case 'EConst':
					return true;
				case 'EBase':
					return false;
				case 'EVar':
					return A2(_elm_lang$core$Set$member, _p333._1, numericIdents);
				case 'EFun':
					return false;
				case 'EApp':
					return false;
				case 'EOp':
					var _p335 = _p333._2;
					var _p334 = _p333._1.val;
					switch (_p334.ctor) {
						case 'Pi':
							return true;
						case 'DictEmpty':
							return false;
						case 'Cos':
							return true;
						case 'Sin':
							return true;
						case 'ArcCos':
							return true;
						case 'ArcSin':
							return true;
						case 'Floor':
							return true;
						case 'Ceil':
							return true;
						case 'Round':
							return true;
						case 'ToStr':
							return false;
						case 'Sqrt':
							return true;
						case 'Explode':
							return false;
						case 'DebugLog':
							return A2(_elm_lang$core$List$any, recurse, _p335);
						case 'Plus':
							return A2(_elm_lang$core$List$any, recurse, _p335);
						case 'Minus':
							return true;
						case 'Mult':
							return true;
						case 'Div':
							return true;
						case 'Lt':
							return false;
						case 'Eq':
							return false;
						case 'Mod':
							return true;
						case 'Pow':
							return true;
						case 'ArcTan2':
							return true;
						case 'DictGet':
							return false;
						case 'DictRemove':
							return false;
						default:
							return false;
					}
				case 'EList':
					return false;
				case 'EIf':
					return recurse(_p333._2) && recurse(_p333._3);
				case 'ECase':
					return A2(
						_elm_lang$core$List$all,
						recurse,
						_user$project$Lang$branchExps(_p333._2));
				case 'ETypeCase':
					return A2(
						_elm_lang$core$List$all,
						recurse,
						_user$project$Lang$tbranchExps(_p333._2));
				case 'EComment':
					return recurse(_p333._2);
				case 'EOption':
					return recurse(_p333._4);
				case 'ELet':
					return recurse(_p333._5);
				case 'ETyp':
					return recurse(_p333._3);
				case 'EColonType':
					return recurse(_p333._1);
				default:
					return recurse(_p333._3);
			}
		});
	var expBindings = _user$project$LangTools$allSimplyResolvableLetBindings(program);
	var findAllNumericIdents = function (numericIdents) {
		findAllNumericIdents:
		while (true) {
			var moreNumericIdents = A2(
				_elm_lang$core$List$map,
				_elm_lang$core$Tuple$first,
				A2(
					_elm_lang$core$List$filter,
					function (_p336) {
						var _p337 = _p336;
						return A2(isSurelyNumeric, numericIdents, _p337._1);
					},
					expBindings));
			if (_elm_lang$core$Native_Utils.eq(
				_elm_lang$core$List$length(moreNumericIdents),
				_elm_lang$core$Set$size(numericIdents))) {
				return numericIdents;
			} else {
				var _v186 = _elm_lang$core$Set$fromList(moreNumericIdents);
				numericIdents = _v186;
				continue findAllNumericIdents;
			}
		}
	};
	return findAllNumericIdents(_elm_lang$core$Set$empty);
};
var _user$project$LangTools$BoundUnknown = {ctor: 'BoundUnknown'};
var _user$project$LangTools$Bound = function (a) {
	return {ctor: 'Bound', _0: a};
};
var _user$project$LangTools$expEnvAt_ = F2(
	function (exp, targetEId) {
		var recurse = function (e) {
			return A2(_user$project$LangTools$expEnvAt_, e, targetEId);
		};
		var recurseAllChildren = function (_p338) {
			var _p339 = _p338;
			return A2(
				_user$project$Utils$mapFirstSuccess,
				recurse,
				_user$project$Lang$childExps(exp));
		};
		var addShallowerIdentifiers = F2(
			function (newIdents, deeperBindings) {
				return A3(
					_elm_lang$core$List$foldl,
					F2(
						function (ident, bindings) {
							return A2(_elm_lang$core$Dict$member, ident, bindings) ? bindings : A3(_elm_lang$core$Dict$insert, ident, _user$project$LangTools$BoundUnknown, bindings);
						}),
					deeperBindings,
					newIdents);
			});
		var addShallowerBoundExps = F2(
			function (expEnv, deeperBindings) {
				return A3(
					_elm_lang$core$List$foldl,
					F2(
						function (_p340, bindings) {
							var _p341 = _p340;
							var _p342 = _p341._0;
							return A2(_elm_lang$core$Dict$member, _p342, bindings) ? bindings : A3(
								_elm_lang$core$Dict$insert,
								_p342,
								_user$project$LangTools$Bound(_p341._1),
								bindings);
						}),
					deeperBindings,
					expEnv);
			});
		var addBindingsFrom = F3(
			function (pat, e, deeperBindings) {
				var _p343 = A2(_user$project$LangTools$tryMatchExp, pat, e);
				if (_p343.ctor === 'Match') {
					return A2(addShallowerBoundExps, _p343._0, deeperBindings);
				} else {
					return A2(
						addShallowerIdentifiers,
						_user$project$LangTools$identifiersListInPat(pat),
						deeperBindings);
				}
			});
		if (_elm_lang$core$Native_Utils.eq(exp.val.eid, targetEId)) {
			return _elm_lang$core$Maybe$Just(_elm_lang$core$Dict$empty);
		} else {
			var _p344 = exp.val.e__;
			switch (_p344.ctor) {
				case 'EConst':
					return _elm_lang$core$Maybe$Nothing;
				case 'EBase':
					return _elm_lang$core$Maybe$Nothing;
				case 'EVar':
					return _elm_lang$core$Maybe$Nothing;
				case 'EFun':
					return A2(
						_elm_lang$core$Maybe$map,
						addShallowerIdentifiers(
							_user$project$LangTools$identifiersListInPats(_p344._1)),
						recurse(_p344._2));
				case 'EOp':
					return recurseAllChildren(
						{ctor: '_Tuple0'});
				case 'EList':
					return recurseAllChildren(
						{ctor: '_Tuple0'});
				case 'EIf':
					return recurseAllChildren(
						{ctor: '_Tuple0'});
				case 'ECase':
					var _p345 = recurse(_p344._1);
					if (_p345.ctor === 'Just') {
						return _elm_lang$core$Maybe$Just(_p345._0);
					} else {
						return A2(
							_user$project$Utils$mapFirstSuccess,
							function (_p346) {
								var _p347 = _p346;
								var _p348 = _p347._2;
								return A2(
									_elm_lang$core$Maybe$map,
									A2(addBindingsFrom, _p347._1, _p348),
									recurse(_p348));
							},
							A2(
								_elm_lang$core$List$map,
								function (_) {
									return _.val;
								},
								_p344._2));
					}
				case 'ETypeCase':
					return recurseAllChildren(
						{ctor: '_Tuple0'});
				case 'EApp':
					return recurseAllChildren(
						{ctor: '_Tuple0'});
				case 'ELet':
					if (_p344._2 === false) {
						var _p350 = _p344._4;
						var _p349 = recurse(_p350);
						if (_p349.ctor === 'Just') {
							return _elm_lang$core$Maybe$Just(_p349._0);
						} else {
							return A2(
								_elm_lang$core$Maybe$map,
								A2(addBindingsFrom, _p344._3, _p350),
								recurse(_p344._5));
						}
					} else {
						return A2(
							_elm_lang$core$Maybe$map,
							A2(addBindingsFrom, _p344._3, _p344._4),
							recurseAllChildren(
								{ctor: '_Tuple0'}));
					}
				case 'EComment':
					return recurse(_p344._2);
				case 'EOption':
					return recurse(_p344._4);
				case 'ETyp':
					return recurse(_p344._3);
				case 'EColonType':
					return recurse(_p344._1);
				default:
					return recurse(_p344._3);
			}
		}
	});
var _user$project$LangTools$preludeExpEnv = A2(
	_user$project$Utils$fromJust_,
	'LangTools.preludeExpEnv',
	A2(
		_user$project$LangTools$expEnvAt_,
		_user$project$FastParser$prelude,
		_user$project$LangTools$lastExp(_user$project$FastParser$prelude).val.eid));
var _user$project$LangTools$expEnvAt = F2(
	function (exp, targetEId) {
		return A2(
			_elm_lang$core$Maybe$map,
			function (bindings) {
				return A2(_elm_lang$core$Dict$union, bindings, _user$project$LangTools$preludeExpEnv);
			},
			A2(_user$project$LangTools$expEnvAt_, exp, targetEId));
	});
var _user$project$LangTools$resolveIdentifierToExp = F3(
	function (ident, viewerEId, program) {
		return A2(
			_elm_lang$core$Maybe$andThen,
			_elm_lang$core$Dict$get(ident),
			A2(_user$project$LangTools$expEnvAt, program, viewerEId));
	});
var _user$project$LangTools$expDescriptionParts_ = F3(
	function (program, exp, targetEId) {
		var recurse = function (e) {
			return A3(_user$project$LangTools$expDescriptionParts_, program, e, targetEId);
		};
		var varIdentOrDefault = F2(
			function (e, $default) {
				return A2(
					_elm_lang$core$Maybe$withDefault,
					$default,
					_user$project$LangTools$expToMaybeIdent(e));
			});
		var searchChildren = function (_p351) {
			var _p352 = _p351;
			return A2(
				_elm_lang$core$Maybe$withDefault,
				{ctor: '[]'},
				A2(
					_user$project$Utils$mapFirstSuccess,
					function (child) {
						var _p353 = recurse(child);
						if (_p353.ctor === '[]') {
							return _elm_lang$core$Maybe$Nothing;
						} else {
							return _elm_lang$core$Maybe$Just(_p353);
						}
					},
					_user$project$Lang$childExps(exp)));
		};
		if (_elm_lang$core$Native_Utils.eq(exp.val.eid, targetEId)) {
			return {
				ctor: '::',
				_0: _user$project$LangTools$simpleExpName(exp),
				_1: {ctor: '[]'}
			};
		} else {
			var _p354 = exp.val.e__;
			switch (_p354.ctor) {
				case 'ELet':
					var _p368 = _p354._3;
					var _p367 = _p354._4;
					var namedAssigns = A2(_user$project$LangTools$tryMatchExpReturningList, _p368, _p367);
					var _p357 = A2(
						_elm_lang$core$List$filter,
						function (_p355) {
							var _p356 = _p355;
							return !_elm_lang$core$Native_Utils.eq(
								A2(_user$project$Lang$findExpByEId, _p356._1, targetEId),
								_elm_lang$core$Maybe$Nothing);
						},
						namedAssigns);
					if (_p357.ctor === '[]') {
						if (_elm_lang$core$Native_Utils.eq(_p367.val.eid, targetEId)) {
							var _p358 = _user$project$LangTools$identifiersListInPat(_p368);
							if (_p358.ctor === '[]') {
								return {
									ctor: '::',
									_0: _user$project$LangTools$simpleExpName(_p367),
									_1: {ctor: '[]'}
								};
							} else {
								return {
									ctor: '::',
									_0: A2(
										varIdentOrDefault,
										_p367,
										A2(_elm_lang$core$String$join, '', _p358)),
									_1: {ctor: '[]'}
								};
							}
						} else {
							var scopeNames = function () {
								var _p359 = _p368.val.p__;
								switch (_p359.ctor) {
									case 'PVar':
										return {
											ctor: '::',
											_0: _p359._1,
											_1: {ctor: '[]'}
										};
									case 'PAs':
										return {
											ctor: '::',
											_0: _p359._1,
											_1: {ctor: '[]'}
										};
									default:
										var _p360 = _user$project$LangTools$identifiersListInPat(_p368);
										if (_p360.ctor === '[]') {
											return {ctor: '[]'};
										} else {
											return {
												ctor: '::',
												_0: A2(_elm_lang$core$String$join, '', _p360),
												_1: {ctor: '[]'}
											};
										}
								}
							}();
							var _p361 = recurse(_p367);
							if (_p361.ctor === '[]') {
								return recurse(_p354._5);
							} else {
								return A2(_elm_lang$core$Basics_ops['++'], scopeNames, _p361);
							}
						}
					} else {
						var _p366 = _p357;
						var _p362 = A2(_user$project$Utils$last, 'LangTools.expDescriptionParts', _p366);
						var ident = _p362._0;
						var matchingExp = _p362._1;
						var _p363 = _elm_lang$core$List$unzip(_p366);
						var idents = _p363._0;
						if (_elm_lang$core$Native_Utils.eq(matchingExp.val.eid, targetEId)) {
							return A2(
								_elm_lang$core$Basics_ops['++'],
								A2(_user$project$Utils$dropLast, 1, idents),
								{
									ctor: '::',
									_0: A2(varIdentOrDefault, matchingExp, ident),
									_1: {ctor: '[]'}
								});
						} else {
							var _p364 = recurse(matchingExp);
							if (_p364.ctor === '[]') {
								return _elm_lang$core$Native_Utils.crashCase(
									'LangTools',
									{
										start: {line: 713, column: 15},
										end: {line: 715, column: 53}
									},
									_p364)(
									A2(
										_elm_lang$core$Basics_ops['++'],
										'LangTools.expDescriptionParts expected to find targetEId in\n',
										A2(
											_elm_lang$core$Basics_ops['++'],
											_user$project$LangUnparser$unparseWithIds(matchingExp),
											A2(
												_elm_lang$core$Basics_ops['++'],
												'\nin\n',
												_user$project$LangUnparser$unparseWithIds(_p367)))));
							} else {
								return A2(_elm_lang$core$Basics_ops['++'], idents, _p364);
							}
						}
					}
				case 'EApp':
					var _p369 = searchChildren(
						{ctor: '_Tuple0'});
					if (_p369.ctor === '[]') {
						return {ctor: '[]'};
					} else {
						return A2(
							_elm_lang$core$Maybe$withDefault,
							_p369,
							A2(
								_elm_lang$core$Maybe$andThen,
								function (funcName) {
									var _p370 = A3(_user$project$LangTools$resolveIdentifierToExp, funcName, targetEId, program);
									if ((_p370.ctor === 'Just') && (_p370._0.ctor === 'Bound')) {
										var _p371 = _p370._0._0.val.e__;
										if (_p371.ctor === 'EFun') {
											return A2(
												_user$project$Utils$mapFirstSuccess,
												function (_p372) {
													var _p373 = _p372;
													var _p374 = A2(_user$project$LangTools$tryMatchExp, _p373._0, _p373._1);
													if (_p374.ctor === 'Match') {
														return A2(
															_elm_lang$core$Maybe$map,
															function (_p375) {
																var _p376 = _p375;
																return {
																	ctor: '::',
																	_0: A2(varIdentOrDefault, _p376._1, _p376._0),
																	_1: {ctor: '[]'}
																};
															},
															A2(
																_user$project$Utils$findFirst,
																function (_p377) {
																	var _p378 = _p377;
																	return _elm_lang$core$Native_Utils.eq(_p378._1.val.eid, targetEId);
																},
																_p374._0));
													} else {
														return _elm_lang$core$Maybe$Nothing;
													}
												},
												A2(_user$project$Utils$zip, _p371._1, _p354._2));
										} else {
											return _elm_lang$core$Maybe$Nothing;
										}
									} else {
										return _elm_lang$core$Maybe$Nothing;
									}
								},
								_user$project$LangTools$expToMaybeIdent(_p354._1)));
					}
				default:
					return searchChildren(
						{ctor: '_Tuple0'});
			}
		}
	});
var _user$project$LangTools$expDescriptionParts = F2(
	function (program, targetEId) {
		return A3(_user$project$LangTools$expDescriptionParts_, program, program, targetEId);
	});
var _user$project$LangTools$expNameForEIdWithDefault = F3(
	function ($default, program, targetEId) {
		var _p379 = A2(
			_user$project$Utils$takeLast,
			1,
			A2(_user$project$LangTools$expDescriptionParts, program, targetEId));
		if ((_p379.ctor === '::') && (_p379._1.ctor === '[]')) {
			return _p379._0;
		} else {
			return A2(
				_elm_lang$core$Maybe$withDefault,
				$default,
				A2(
					_elm_lang$core$Maybe$map,
					_user$project$LangTools$simpleExpNameWithDefault($default),
					A2(_user$project$Lang$findExpByEId, program, targetEId)));
		}
	});
var _user$project$LangTools$expNameForEId = F2(
	function (program, targetEId) {
		return A3(_user$project$LangTools$expNameForEIdWithDefault, _user$project$LangTools$defaultExpName, program, targetEId);
	});
var _user$project$LangTools$commonNameForEIdsWithDefault = F3(
	function (defaultName, program, eids) {
		var expNames = A2(
			_elm_lang$core$List$map,
			_user$project$LangTools$expNameForEId(program),
			eids);
		var prefixCandidate = _user$project$LangTools$removeLeadingDigits(
			_user$project$Utils$commonPrefixString(expNames));
		var suffixCandidate = _user$project$LangTools$removeLeadingDigits(
			_user$project$Utils$commonSuffixString(expNames));
		var candidate = function () {
			var candidate = _elm_lang$core$Native_Utils.eq(prefixCandidate, '') ? suffixCandidate : (_elm_lang$core$Native_Utils.eq(suffixCandidate, '') ? prefixCandidate : (_elm_lang$core$Native_Utils.eq(prefixCandidate, _user$project$LangTools$defaultExpName) ? suffixCandidate : (_elm_lang$core$Native_Utils.eq(suffixCandidate, _user$project$LangTools$defaultExpName) ? prefixCandidate : (_elm_lang$core$Native_Utils.eq(prefixCandidate, 'num') ? suffixCandidate : (_elm_lang$core$Native_Utils.eq(suffixCandidate, 'num') ? prefixCandidate : ((_elm_lang$core$Native_Utils.cmp(
				_elm_lang$core$String$length(prefixCandidate),
				_elm_lang$core$String$length(suffixCandidate)) < 0) ? suffixCandidate : prefixCandidate))))));
			return _user$project$LangTools$downcaseLeadingCapitals(candidate);
		}();
		return (_elm_lang$core$Native_Utils.eq(candidate, '') || (_elm_lang$core$Native_Utils.eq(candidate, 'num') || _elm_lang$core$Native_Utils.eq(candidate, _user$project$LangTools$defaultExpName))) ? A2(
			_elm_lang$core$Maybe$withDefault,
			_elm_lang$core$Native_Utils.eq(candidate, '') ? defaultName : candidate,
			A2(
				_elm_lang$core$Maybe$map,
				function (nums) {
					return (_elm_lang$core$Native_Utils.eq(
						A2(
							_elm_lang$core$List$map,
							function (_p380) {
								return _elm_lang$core$Basics$toFloat(
									_elm_lang$core$Basics$round(_p380));
							},
							nums),
						nums) && (_elm_lang$core$Native_Utils.eq(
						_user$project$Utils$dedup(nums),
						nums) && ((A2(_elm_lang$core$List$member, 0, nums) || A2(_elm_lang$core$List$member, 1, nums)) && A2(
						_elm_lang$core$List$all,
						function (n) {
							return (_elm_lang$core$Native_Utils.cmp(0, n) < 1) && (_elm_lang$core$Native_Utils.cmp(n, 10) < 0);
						},
						nums)))) ? 'i' : 'num';
				},
				_user$project$Utils$projJusts(
					A2(
						_elm_lang$core$List$map,
						function (eid) {
							return A2(
								_elm_lang$core$Maybe$andThen,
								_user$project$LangTools$expToMaybeNum,
								A2(_user$project$Lang$findExpByEId, program, eid));
						},
						eids)))) : candidate;
	});
var _user$project$LangTools$commonNameForEIds = F2(
	function (program, eids) {
		return A3(_user$project$LangTools$commonNameForEIdsWithDefault, _user$project$LangTools$defaultExpName, program, eids);
	});
var _user$project$LangTools$expNameForExpWithDefault = F3(
	function ($default, program, exp) {
		var _p381 = A2(
			_user$project$Utils$takeLast,
			1,
			A2(_user$project$LangTools$expDescriptionParts, program, exp.val.eid));
		if ((_p381.ctor === '::') && (_p381._1.ctor === '[]')) {
			return _p381._0;
		} else {
			return A2(_user$project$LangTools$simpleExpNameWithDefault, $default, exp);
		}
	});
var _user$project$LangTools$expNameForExp = F2(
	function (program, exp) {
		return A3(_user$project$LangTools$expNameForExpWithDefault, _user$project$LangTools$defaultExpName, program, exp);
	});
var _user$project$LangTools$maybeResolveIdentifierToExp = F3(
	function (ident, viewerEId, program) {
		var _p382 = A3(_user$project$LangTools$resolveIdentifierToExp, ident, viewerEId, program);
		if ((_p382.ctor === 'Just') && (_p382._0.ctor === 'Bound')) {
			return _elm_lang$core$Maybe$Just(_p382._0._0);
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$LangTools$eidToMaybeCorrespondingArgumentPathedPatId = F2(
	function (program, targetEId) {
		return A2(
			_user$project$Utils$mapFirstSuccess,
			function (exp) {
				var _p383 = exp.val.e__;
				if (_p383.ctor === 'EApp') {
					var _p390 = _p383._1;
					var _p384 = _p390.val.e__;
					if (_p384.ctor === 'EVar') {
						var _p385 = A3(_user$project$LangTools$resolveIdentifierToExp, _p384._1, _p390.val.eid, program);
						if ((_p385.ctor === 'Just') && (_p385._0.ctor === 'Bound')) {
							var _p389 = _p385._0._0;
							var _p386 = {
								ctor: '_Tuple2',
								_0: _p389.val.e__,
								_1: _user$project$FastParser$isPreludeEId(_p389.val.eid)
							};
							if (((_p386.ctor === '_Tuple2') && (_p386._0.ctor === 'EFun')) && (_p386._1 === false)) {
								return A2(
									_user$project$Utils$mapFirstSuccess,
									function (_p387) {
										var _p388 = _p387;
										return _elm_lang$core$Native_Utils.eq(_p388._1.val.eid, targetEId) ? _elm_lang$core$Maybe$Just(
											{
												ctor: '_Tuple2',
												_0: {ctor: '_Tuple2', _0: _p389.val.eid, _1: 1},
												_1: _p388._0
											}) : _elm_lang$core$Maybe$Nothing;
									},
									A2(_user$project$LangTools$tryMatchExpsPatsToPathsAtFunctionCall, _p386._0._1, _p383._2));
							} else {
								return _elm_lang$core$Maybe$Nothing;
							}
						} else {
							return _elm_lang$core$Maybe$Nothing;
						}
					} else {
						return _elm_lang$core$Maybe$Nothing;
					}
				} else {
					return _elm_lang$core$Maybe$Nothing;
				}
			},
			A2(
				_elm_lang$core$Maybe$withDefault,
				{ctor: '[]'},
				A2(_user$project$Lang$findWithAncestorsByEId, program, targetEId)));
	});

var _user$project$Keys$keyPlusEqual = 187;
var _user$project$Keys$keyZ = 90;
var _user$project$Keys$keyG = 71;
var _user$project$Keys$keyD = 68;
var _user$project$Keys$keyC = 67;
var _user$project$Keys$keyB = 66;
var _user$project$Keys$keyA = 65;
var _user$project$Keys$keyDelete = 46;
var _user$project$Keys$keyBackspace = 8;
var _user$project$Keys$keyDown = 40;
var _user$project$Keys$keyRight = 39;
var _user$project$Keys$keyUp = 38;
var _user$project$Keys$keyLeft = 37;
var _user$project$Keys$keyShift = 16;
var _user$project$Keys$keyCtrl = 17;
var _user$project$Keys$keyEsc = 27;
var _user$project$Keys$keyEnter = 13;
var _user$project$Keys$isCommandKey = function (code) {
	return A2(
		_elm_lang$core$List$member,
		code,
		{
			ctor: '::',
			_0: 17,
			_1: {
				ctor: '::',
				_0: 91,
				_1: {
					ctor: '::',
					_0: 93,
					_1: {
						ctor: '::',
						_0: 224,
						_1: {ctor: '[]'}
					}
				}
			}
		});
};
var _user$project$Keys$delete = _elm_lang$core$List$sort(
	{
		ctor: '::',
		_0: _user$project$Keys$keyDelete,
		_1: {ctor: '[]'}
	});
var _user$project$Keys$backspace = _elm_lang$core$List$sort(
	{
		ctor: '::',
		_0: _user$project$Keys$keyBackspace,
		_1: {ctor: '[]'}
	});
var _user$project$Keys$shiftDown = _elm_lang$core$List$sort(
	{
		ctor: '::',
		_0: _user$project$Keys$keyShift,
		_1: {
			ctor: '::',
			_0: _user$project$Keys$keyDown,
			_1: {ctor: '[]'}
		}
	});
var _user$project$Keys$shiftUp = _elm_lang$core$List$sort(
	{
		ctor: '::',
		_0: _user$project$Keys$keyShift,
		_1: {
			ctor: '::',
			_0: _user$project$Keys$keyUp,
			_1: {ctor: '[]'}
		}
	});
var _user$project$Keys$shiftRight = _elm_lang$core$List$sort(
	{
		ctor: '::',
		_0: _user$project$Keys$keyShift,
		_1: {
			ctor: '::',
			_0: _user$project$Keys$keyRight,
			_1: {ctor: '[]'}
		}
	});
var _user$project$Keys$shiftLeft = _elm_lang$core$List$sort(
	{
		ctor: '::',
		_0: _user$project$Keys$keyShift,
		_1: {
			ctor: '::',
			_0: _user$project$Keys$keyLeft,
			_1: {ctor: '[]'}
		}
	});
var _user$project$Keys$down = _elm_lang$core$List$sort(
	{
		ctor: '::',
		_0: _user$project$Keys$keyDown,
		_1: {ctor: '[]'}
	});
var _user$project$Keys$up = _elm_lang$core$List$sort(
	{
		ctor: '::',
		_0: _user$project$Keys$keyUp,
		_1: {ctor: '[]'}
	});
var _user$project$Keys$right = _elm_lang$core$List$sort(
	{
		ctor: '::',
		_0: _user$project$Keys$keyRight,
		_1: {ctor: '[]'}
	});
var _user$project$Keys$left = _elm_lang$core$List$sort(
	{
		ctor: '::',
		_0: _user$project$Keys$keyLeft,
		_1: {ctor: '[]'}
	});
var _user$project$Keys$s = _elm_lang$core$List$sort(
	{
		ctor: '::',
		_0: _elm_lang$core$Char$toCode(
			_elm_lang$core$Native_Utils.chr('S')),
		_1: {ctor: '[]'}
	});
var _user$project$Keys$t = _elm_lang$core$List$sort(
	{
		ctor: '::',
		_0: _elm_lang$core$Char$toCode(
			_elm_lang$core$Native_Utils.chr('T')),
		_1: {ctor: '[]'}
	});
var _user$project$Keys$q = _elm_lang$core$List$sort(
	{
		ctor: '::',
		_0: _elm_lang$core$Char$toCode(
			_elm_lang$core$Native_Utils.chr('Q')),
		_1: {ctor: '[]'}
	});
var _user$project$Keys$p = _elm_lang$core$List$sort(
	{
		ctor: '::',
		_0: _elm_lang$core$Char$toCode(
			_elm_lang$core$Native_Utils.chr('P')),
		_1: {ctor: '[]'}
	});
var _user$project$Keys$o = _elm_lang$core$List$sort(
	{
		ctor: '::',
		_0: _elm_lang$core$Char$toCode(
			_elm_lang$core$Native_Utils.chr('O')),
		_1: {ctor: '[]'}
	});
var _user$project$Keys$h = _elm_lang$core$List$sort(
	{
		ctor: '::',
		_0: _elm_lang$core$Char$toCode(
			_elm_lang$core$Native_Utils.chr('H')),
		_1: {ctor: '[]'}
	});
var _user$project$Keys$g = _elm_lang$core$List$sort(
	{
		ctor: '::',
		_0: _elm_lang$core$Char$toCode(
			_elm_lang$core$Native_Utils.chr('G')),
		_1: {ctor: '[]'}
	});
var _user$project$Keys$y = _elm_lang$core$List$sort(
	{
		ctor: '::',
		_0: _elm_lang$core$Char$toCode(
			_elm_lang$core$Native_Utils.chr('Y')),
		_1: {ctor: '[]'}
	});
var _user$project$Keys$x = _elm_lang$core$List$sort(
	{
		ctor: '::',
		_0: _elm_lang$core$Char$toCode(
			_elm_lang$core$Native_Utils.chr('X')),
		_1: {ctor: '[]'}
	});
var _user$project$Keys$z = _elm_lang$core$List$sort(
	{
		ctor: '::',
		_0: _elm_lang$core$Char$toCode(
			_elm_lang$core$Native_Utils.chr('Z')),
		_1: {ctor: '[]'}
	});
var _user$project$Keys$e = _elm_lang$core$List$sort(
	{
		ctor: '::',
		_0: _elm_lang$core$Char$toCode(
			_elm_lang$core$Native_Utils.chr('E')),
		_1: {ctor: '[]'}
	});
var _user$project$Keys$d = _elm_lang$core$List$sort(
	{
		ctor: '::',
		_0: _elm_lang$core$Char$toCode(
			_elm_lang$core$Native_Utils.chr('D')),
		_1: {ctor: '[]'}
	});
var _user$project$Keys$c = _elm_lang$core$List$sort(
	{
		ctor: '::',
		_0: _elm_lang$core$Char$toCode(
			_elm_lang$core$Native_Utils.chr('C')),
		_1: {ctor: '[]'}
	});
var _user$project$Keys$a = _elm_lang$core$List$sort(
	{
		ctor: '::',
		_0: _user$project$Keys$keyA,
		_1: {ctor: '[]'}
	});
var _user$project$Keys$enter = _elm_lang$core$List$sort(
	{
		ctor: '::',
		_0: _user$project$Keys$keyEnter,
		_1: {ctor: '[]'}
	});
var _user$project$Keys$escape = _elm_lang$core$List$sort(
	{
		ctor: '::',
		_0: _user$project$Keys$keyEsc,
		_1: {ctor: '[]'}
	});
var _user$project$Keys$escShift = _elm_lang$core$List$sort(
	{
		ctor: '::',
		_0: _user$project$Keys$keyEsc,
		_1: {
			ctor: '::',
			_0: _user$project$Keys$keyShift,
			_1: {ctor: '[]'}
		}
	});

var _user$project$DeuceWidgets$setHoveredMenuPath = F2(
	function (path, m) {
		var deuceState = m.deuceState;
		return _elm_lang$core$Native_Utils.update(
			m,
			{
				deuceState: _elm_lang$core$Native_Utils.update(
					deuceState,
					{hoveredMenuPath: path})
			});
	});
var _user$project$DeuceWidgets$clearHoveredMenuPath = _user$project$DeuceWidgets$setHoveredMenuPath(
	{ctor: '[]'});
var _user$project$DeuceWidgets$emptyDeuceState = {
	selectedWidgets: {ctor: '[]'},
	hoveredWidgets: {ctor: '[]'},
	hoveredMenuPath: {ctor: '[]'},
	renameVarTextBox: ''
};
var _user$project$DeuceWidgets$isSubWidget = F3(
	function (program, widget, superWidget) {
		var isSubEId = F2(
			function (subEId, superEId) {
				return A2(
					_elm_lang$core$Maybe$withDefault,
					false,
					A2(
						_elm_lang$core$Maybe$map,
						function (superExp) {
							return A2(
								_elm_lang$core$List$member,
								subEId,
								_user$project$Lang$allEIds(superExp));
						},
						A2(_user$project$Lang$findExpByEId, program, superEId)));
			});
		var boundExpContains = F2(
			function (subEId, superLetEId) {
				return A2(
					_elm_lang$core$Maybe$withDefault,
					false,
					A2(
						_elm_lang$core$Maybe$map,
						function (superBoundExp) {
							return A2(
								_elm_lang$core$List$member,
								subEId,
								_user$project$Lang$allEIds(superBoundExp));
						},
						A2(
							_elm_lang$core$Maybe$andThen,
							_user$project$LangTools$expToMaybeLetBoundExp,
							A2(_user$project$Lang$findExpByEId, program, superLetEId))));
			});
		var isSubPPId = F2(
			function (_p1, _p0) {
				var _p2 = _p1;
				var _p3 = _p0;
				return _elm_lang$core$Native_Utils.eq(_p2._0, _p3._0) && A2(_user$project$Utils$isPrefix, _p3._1, _p2._1);
			});
		var _p4 = {ctor: '_Tuple2', _0: widget, _1: superWidget};
		switch (_p4._1.ctor) {
			case 'DeuceExpTarget':
				if (_p4._0.ctor === 'DeuceExpTarget') {
					return _elm_lang$core$Native_Utils.eq(_p4._0._0, _p4._1._0);
				} else {
					return false;
				}
			case 'DeucePatTarget':
				if (_p4._0.ctor === 'DeucePatTarget') {
					return _elm_lang$core$Native_Utils.eq(_p4._0._0, _p4._1._0);
				} else {
					return false;
				}
			case 'DeuceExp':
				switch (_p4._0.ctor) {
					case 'DeuceExp':
						return A2(isSubEId, _p4._0._0, _p4._1._0);
					case 'DeucePat':
						return A2(
							isSubEId,
							_user$project$Lang$pathedPatIdToScopeEId(_p4._0._0),
							_p4._1._0);
					case 'DeuceLetBindingEquation':
						return A2(isSubEId, _p4._0._0, _p4._1._0);
					case 'DeuceExpTarget':
						var _p10 = _p4._1._0;
						var _p9 = _p4._0._0._1;
						return (!_elm_lang$core$Native_Utils.eq(_p9, _p10)) && A2(isSubEId, _p9, _p10);
					default:
						return A2(
							isSubEId,
							_user$project$Lang$pathedPatIdToScopeEId(_p4._0._0._1),
							_p4._1._0);
				}
			case 'DeucePat':
				switch (_p4._0.ctor) {
					case 'DeuceExp':
						return false;
					case 'DeucePat':
						return A2(isSubPPId, _p4._0._0, _p4._1._0);
					case 'DeuceLetBindingEquation':
						return false;
					case 'DeuceExpTarget':
						return false;
					default:
						var _p12 = _p4._1._0;
						var _p11 = _p4._0._0._1;
						return (!_elm_lang$core$Native_Utils.eq(_p11, _p12)) && A2(isSubPPId, _p11, _p12);
				}
			default:
				switch (_p4._0.ctor) {
					case 'DeuceExp':
						return A2(boundExpContains, _p4._0._0, _p4._1._0);
					case 'DeucePat':
						var _p6 = _p4._1._0;
						var _p5 = _p4._0._0;
						return _elm_lang$core$Native_Utils.eq(
							_user$project$Lang$pathedPatIdToScopeEId(_p5),
							_p6) || A2(
							boundExpContains,
							_user$project$Lang$pathedPatIdToScopeEId(_p5),
							_p6);
					case 'DeuceLetBindingEquation':
						var _p8 = _p4._1._0;
						var _p7 = _p4._0._0;
						return _elm_lang$core$Native_Utils.eq(_p7, _p8) || A2(boundExpContains, _p7, _p8);
					case 'DeuceExpTarget':
						return A2(boundExpContains, _p4._0._0._1, _p4._1._0);
					default:
						var _p14 = _p4._1._0;
						var _p13 = _p4._0._0._1;
						return _elm_lang$core$Native_Utils.eq(
							_user$project$Lang$pathedPatIdToScopeEId(_p13),
							_p14) || A2(
							boundExpContains,
							_user$project$Lang$pathedPatIdToScopeEId(_p13),
							_p14);
				}
		}
	});
var _user$project$DeuceWidgets$isTargetPosition = function (widget) {
	var _p15 = widget;
	switch (_p15.ctor) {
		case 'DeuceExp':
			return false;
		case 'DeucePat':
			return false;
		case 'DeuceLetBindingEquation':
			return false;
		case 'DeuceExpTarget':
			return true;
		default:
			return true;
	}
};
var _user$project$DeuceWidgets$DeuceState = F4(
	function (a, b, c, d) {
		return {selectedWidgets: a, hoveredWidgets: b, hoveredMenuPath: c, renameVarTextBox: d};
	});
var _user$project$DeuceWidgets$DeucePatTarget = function (a) {
	return {ctor: 'DeucePatTarget', _0: a};
};
var _user$project$DeuceWidgets$DeuceExpTarget = function (a) {
	return {ctor: 'DeuceExpTarget', _0: a};
};
var _user$project$DeuceWidgets$DeuceLetBindingEquation = function (a) {
	return {ctor: 'DeuceLetBindingEquation', _0: a};
};
var _user$project$DeuceWidgets$DeucePat = function (a) {
	return {ctor: 'DeucePat', _0: a};
};
var _user$project$DeuceWidgets$DeuceExp = function (a) {
	return {ctor: 'DeuceExp', _0: a};
};
var _user$project$DeuceWidgets$toDeuceWidget = F2(
	function (patMap, codeObject) {
		var _p16 = codeObject;
		switch (_p16.ctor) {
			case 'E':
				return _elm_lang$core$Maybe$Just(
					_user$project$DeuceWidgets$DeuceExp(_p16._0.val.eid));
			case 'P':
				return A2(
					_elm_lang$core$Maybe$map,
					_user$project$DeuceWidgets$DeucePat,
					A2(_elm_lang$core$Dict$get, _p16._1.val.pid, patMap));
			case 'T':
				return _elm_lang$core$Maybe$Nothing;
			case 'LBE':
				return _elm_lang$core$Maybe$Just(
					_user$project$DeuceWidgets$DeuceLetBindingEquation(_p16._0.val));
			case 'ET':
				return _elm_lang$core$Maybe$Just(
					_user$project$DeuceWidgets$DeuceExpTarget(
						{ctor: '_Tuple2', _0: _p16._0, _1: _p16._2.val.eid}));
			case 'PT':
				return A2(
					_elm_lang$core$Maybe$map,
					function (ppid) {
						return _user$project$DeuceWidgets$DeucePatTarget(
							{ctor: '_Tuple2', _0: _p16._0, _1: ppid});
					},
					A2(_elm_lang$core$Dict$get, _p16._3.val.pid, patMap));
			default:
				return _elm_lang$core$Maybe$Nothing;
		}
	});

var _user$project$History$next = function (_p0) {
	var _p1 = _p0;
	return _elm_lang$core$List$head(_p1._0._1);
};
var _user$project$History$mostRecent = function (_p2) {
	var _p3 = _p2;
	return _elm_lang$core$List$head(_p3._0._0);
};
var _user$project$History$hasFuture = function (_p4) {
	var _p5 = _p4;
	return !_elm_lang$core$List$isEmpty(_p5._0._1);
};
var _user$project$History$hasExtendedPast = function (_p6) {
	var _p7 = _p6;
	return _elm_lang$core$Native_Utils.cmp(
		_elm_lang$core$List$length(_p7._0._0),
		1) > 0;
};
var _user$project$History$hasPast = function (_p8) {
	var _p9 = _p8;
	return !_elm_lang$core$List$isEmpty(_p9._0._0);
};
var _user$project$History$H = function (a) {
	return {ctor: 'H', _0: a};
};
var _user$project$History$blank = _user$project$History$H(
	{
		ctor: '_Tuple2',
		_0: {ctor: '[]'},
		_1: {ctor: '[]'}
	});
var _user$project$History$commit = F3(
	function (updateCondition, snapshot, history) {
		var _p10 = history;
		var past = _p10._0._0;
		var updatedHistory = _user$project$History$H(
			{
				ctor: '_Tuple2',
				_0: {ctor: '::', _0: snapshot, _1: past},
				_1: {ctor: '[]'}
			});
		var _p11 = _user$project$History$mostRecent(history);
		if (_p11.ctor === 'Just') {
			return A2(updateCondition, _p11._0, snapshot) ? updatedHistory : history;
		} else {
			return updatedHistory;
		}
	});
var _user$project$History$alwaysCommit = _user$project$History$commit(
	F2(
		function (_p13, _p12) {
			return true;
		}));
var _user$project$History$begin = function (snapshot) {
	return A2(_user$project$History$alwaysCommit, snapshot, _user$project$History$blank);
};
var _user$project$History$backward = function (_p14) {
	var _p15 = _p14;
	var _p16 = _p15._0._0;
	if (_p16.ctor === '[]') {
		return _elm_lang$core$Maybe$Nothing;
	} else {
		return _elm_lang$core$Maybe$Just(
			_user$project$History$H(
				{
					ctor: '_Tuple2',
					_0: _p16._1,
					_1: {ctor: '::', _0: _p16._0, _1: _p15._0._1}
				}));
	}
};
var _user$project$History$modify = F2(
	function (snapshot, history) {
		return A2(
			_elm_lang$core$Maybe$map,
			_user$project$History$alwaysCommit(snapshot),
			_user$project$History$backward(history));
	});
var _user$project$History$previousN = F2(
	function (n, history) {
		return (_elm_lang$core$Native_Utils.cmp(n, 1) < 0) ? _elm_lang$core$Maybe$Nothing : (_elm_lang$core$Native_Utils.eq(n, 1) ? _user$project$History$mostRecent(history) : A2(
			_elm_lang$core$Maybe$andThen,
			_user$project$History$previousN(n - 1),
			_user$project$History$backward(history)));
	});
var _user$project$History$prior = _user$project$History$previousN(2);
var _user$project$History$forward = function (_p17) {
	var _p18 = _p17;
	var _p19 = _p18._0._1;
	if (_p19.ctor === '[]') {
		return _elm_lang$core$Maybe$Nothing;
	} else {
		return _elm_lang$core$Maybe$Just(
			_user$project$History$H(
				{
					ctor: '_Tuple2',
					_0: {ctor: '::', _0: _p19._0, _1: _p18._0._0},
					_1: _p19._1
				}));
	}
};

var _user$project$InterfaceModel$splash_i_2017_demo = true;
var _user$project$InterfaceModel$initTemplate = 'BLANK';
var _user$project$InterfaceModel$modelModify = F2(
	function (code, dws) {
		return _user$project$History$modify(
			{code: code, selectedDeuceWidgets: dws});
	});
var _user$project$InterfaceModel$historyUpdateCondition = F2(
	function (previousValues, currentValues) {
		return _user$project$Utils$or(
			{
				ctor: '::',
				_0: !_elm_lang$core$Native_Utils.eq(
					_elm_lang$core$String$trimRight(previousValues.code),
					_elm_lang$core$String$trimRight(currentValues.code)),
				_1: {
					ctor: '::',
					_0: !_elm_lang$core$Native_Utils.eq(previousValues.selectedDeuceWidgets, currentValues.selectedDeuceWidgets),
					_1: {ctor: '[]'}
				}
			});
	});
var _user$project$InterfaceModel$modelCommit = F2(
	function (code, dws) {
		return A2(
			_user$project$History$commit,
			_user$project$InterfaceModel$historyUpdateCondition,
			{code: code, selectedDeuceWidgets: dws});
	});
var _user$project$InterfaceModel$noWidgetsSelected = function (model) {
	return _elm_lang$core$List$isEmpty(model.deuceState.selectedWidgets);
};
var _user$project$InterfaceModel$rangeFromInfo = function (info) {
	return {
		start: {row: info.start.line - 1, column: info.start.col - 1},
		end: {row: info.end.line - 1, column: info.end.col - 1}
	};
};
var _user$project$InterfaceModel$isSubsetRange = F2(
	function (innerRange, outerRange) {
		var endGood = (_elm_lang$core$Native_Utils.cmp(innerRange.end.row, outerRange.end.row) < 0) || (_elm_lang$core$Native_Utils.eq(innerRange.end.row, outerRange.end.row) && (_elm_lang$core$Native_Utils.cmp(innerRange.end.column, outerRange.end.column) < 1));
		var startGood = (_elm_lang$core$Native_Utils.cmp(outerRange.start.row, innerRange.start.row) < 0) || (_elm_lang$core$Native_Utils.eq(outerRange.start.row, innerRange.start.row) && (_elm_lang$core$Native_Utils.cmp(outerRange.start.column, innerRange.start.column) < 1));
		return startGood && endGood;
	});
var _user$project$InterfaceModel$isRangeEqual = F2(
	function (x, y) {
		return _elm_lang$core$Native_Utils.eq(x, y);
	});
var _user$project$InterfaceModel$snippet = function (range) {
	return function (_p0) {
		return _elm_lang$core$String$concat(
			A2(
				_user$project$Utils$mapHead,
				_elm_lang$core$String$dropLeft(range.start.column),
				A2(
					_user$project$Utils$mapLast,
					_elm_lang$core$String$left(range.end.column),
					A3(
						_user$project$Utils$slice,
						range.start.row,
						range.end.row + 1,
						_elm_lang$core$String$lines(_p0)))));
	};
};
var _user$project$InterfaceModel$matchingRange = F3(
	function (textSelectMode, code, selectedRange) {
		var _p1 = function () {
			var _p2 = textSelectMode;
			switch (_p2.ctor) {
				case 'Strict':
					return {ctor: '_Tuple2', _0: _elm_lang$core$List$foldl, _1: _user$project$InterfaceModel$isRangeEqual};
				case 'Superset':
					return {ctor: '_Tuple2', _0: _elm_lang$core$List$foldl, _1: _user$project$InterfaceModel$isSubsetRange};
				case 'Subset':
					return {
						ctor: '_Tuple2',
						_0: _elm_lang$core$List$foldr,
						_1: _elm_lang$core$Basics$flip(_user$project$InterfaceModel$isSubsetRange)
					};
				case 'SubsetExtra':
					return {
						ctor: '_Tuple2',
						_0: _elm_lang$core$List$foldr,
						_1: F2(
							function (sr, r) {
								if (A2(_user$project$InterfaceModel$isSubsetRange, r, sr)) {
									var validAdditionalSelectedCharacter = function (c) {
										return _elm_lang$core$Native_Utils.eq(
											c,
											_elm_lang$core$Native_Utils.chr(' ')) || _elm_lang$core$Native_Utils.eq(
											c,
											_elm_lang$core$Native_Utils.chr('\n'));
									};
									var snippetValid = _elm_lang$core$String$all(validAdditionalSelectedCharacter);
									var beginValid = function (_p3) {
										return snippetValid(
											A3(_elm_lang$core$Basics$flip, _user$project$InterfaceModel$snippet, code, _p3));
									}(
										{start: sr.start, end: r.start});
									var endValid = function (_p4) {
										return snippetValid(
											A3(_elm_lang$core$Basics$flip, _user$project$InterfaceModel$snippet, code, _p4));
									}(
										{start: r.end, end: sr.end});
									return beginValid && endValid;
								} else {
									return false;
								}
							})
					};
				default:
					return {ctor: '_Tuple2', _0: _elm_lang$core$List$foldl, _1: _user$project$InterfaceModel$isSubsetRange};
			}
		}();
		var fold = _p1._0;
		var matcher = _p1._1;
		return A2(
			fold,
			F2(
				function (_p5, previousVal) {
					var _p6 = _p5;
					return A2(matcher, selectedRange, _p6._0) ? _elm_lang$core$Maybe$Just(_p6._1) : previousVal;
				}),
			_elm_lang$core$Maybe$Nothing);
	});
var _user$project$InterfaceModel$needsRun = function (m) {
	return !_elm_lang$core$Native_Utils.eq(m.code, m.lastRunCode);
};
var _user$project$InterfaceModel$iconNames = _elm_lang$core$Dict$keys(_user$project$DefaultIconTheme$icons);
var _user$project$InterfaceModel$getFile = function (model) {
	return {filename: model.filename, code: model.code};
};
var _user$project$InterfaceModel$blankTemplate = 'BLANK';
var _user$project$InterfaceModel$bufferName = '';
var _user$project$InterfaceModel$prettyFilename = function (model) {
	if (_elm_lang$core$Native_Utils.eq(model.filename, _user$project$InterfaceModel$bufferName)) {
		var prettyTemplate = function () {
			var _p7 = model.lastSelectedTemplate;
			if (_p7.ctor === 'Just') {
				var _p8 = _p7._0;
				return (!_elm_lang$core$Native_Utils.eq(_p8, _user$project$InterfaceModel$blankTemplate)) ? A2(
					_elm_lang$core$Basics_ops['++'],
					' (',
					A2(_elm_lang$core$Basics_ops['++'], _p8, ')')) : '';
			} else {
				return '';
			}
		}();
		return A2(_elm_lang$core$Basics_ops['++'], 'Untitled', prettyTemplate);
	} else {
		return model.filename;
	}
};
var _user$project$InterfaceModel$prependDescription = F2(
	function (newPrefix, synthesisResult) {
		return _elm_lang$core$Native_Utils.update(
			synthesisResult,
			{
				description: A2(_elm_lang$core$Basics_ops['++'], newPrefix, synthesisResult.description)
			});
	});
var _user$project$InterfaceModel$strLambdaTool = function (lambdaTool) {
	var strExp = function (_p9) {
		return _elm_lang$core$String$trim(
			_user$project$LangUnparser$unparse(_p9));
	};
	var _p10 = lambdaTool;
	if (_p10.ctor === 'LambdaBounds') {
		return _user$project$Utils$parens(
			A2(
				_elm_lang$core$Basics_ops['++'],
				'\\bounds. ',
				A2(
					_elm_lang$core$Basics_ops['++'],
					strExp(_p10._0),
					' bounds')));
	} else {
		return _user$project$Utils$parens(
			A2(
				_elm_lang$core$Basics_ops['++'],
				'\\anchor. ',
				A2(
					_elm_lang$core$Basics_ops['++'],
					strExp(_p10._0),
					' anchor')));
	}
};
var _user$project$InterfaceModel$lambdaToolIcon = function (tool) {
	return {
		iconName: _user$project$Utils$naturalToCamelCase(
			_user$project$InterfaceModel$strLambdaTool(tool)),
		code: function () {
			var _p11 = tool;
			if (_p11.ctor === 'LambdaBounds') {
				return A2(
					_elm_lang$core$Basics_ops['++'],
					'(svgViewBox 100 100 (',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_user$project$LangUnparser$unparse(_p11._0),
						' [10 10 90 90]))'));
			} else {
				if (_p11._1.ctor === 'Nothing') {
					return A2(
						_elm_lang$core$Basics_ops['++'],
						'(svgViewBox 100 100 (',
						A2(
							_elm_lang$core$Basics_ops['++'],
							_user$project$LangUnparser$unparse(_p11._0),
							' [10 10]))'));
				} else {
					var _p12 = _p11._1._0;
					return _user$project$Utils$parens(
						_user$project$Utils$spaces(
							{
								ctor: '::',
								_0: 'svgViewBox',
								_1: {
									ctor: '::',
									_0: _elm_lang$core$Basics$toString(_p12.width),
									_1: {
										ctor: '::',
										_0: _elm_lang$core$Basics$toString(_p12.height),
										_1: {
											ctor: '::',
											_0: _user$project$Utils$parens(
												_user$project$Utils$spaces(
													{
														ctor: '::',
														_0: _user$project$LangUnparser$unparse(_p11._0),
														_1: {
															ctor: '::',
															_0: _user$project$Utils$bracks(
																_user$project$Utils$spaces(
																	{
																		ctor: '::',
																		_0: _elm_lang$core$Basics$toString(_p12.xAnchor),
																		_1: {
																			ctor: '::',
																			_0: _elm_lang$core$Basics$toString(_p12.yAnchor),
																			_1: {ctor: '[]'}
																		}
																	})),
															_1: {ctor: '[]'}
														}
													})),
											_1: {ctor: '[]'}
										}
									}
								}
							}));
				}
			}
		}()
	};
};
var _user$project$InterfaceModel$codeToShow = function (model) {
	var _p13 = model.preview;
	if (_p13.ctor === 'Just') {
		return _p13._0._0;
	} else {
		return model.code;
	}
};
var _user$project$InterfaceModel$liveInfoToHighlights = F2(
	function (zoneKey, model) {
		var _p14 = model.outputMode;
		if (_p14.ctor === 'Live') {
			return A2(_user$project$Sync$yellowAndGrayHighlights, zoneKey, model.liveSyncInfo);
		} else {
			return {ctor: '[]'};
		}
	});
var _user$project$InterfaceModel$mkLive = F6(
	function (opts, slideNumber, movieNumber, movieTime, e, _p15) {
		var _p16 = _p15;
		return A2(
			_elm_lang$core$Result$andThen,
			function (slate) {
				return A2(
					_elm_lang$core$Result$andThen,
					function (liveInfo) {
						return _elm_lang$core$Result$Ok(liveInfo);
					},
					A3(
						_user$project$Sync$prepareLiveUpdates,
						opts,
						e,
						{ctor: '_Tuple2', _0: slate, _1: _p16._1}));
			},
			A4(_user$project$LangSvg$resolveToIndexedTree, slideNumber, movieNumber, movieTime, _p16._0));
	});
var _user$project$InterfaceModel$slateAndCode = F2(
	function (old, _p17) {
		var _p18 = _p17;
		return A2(
			_elm_lang$core$Result$map,
			function (slate) {
				return {
					ctor: '_Tuple2',
					_0: slate,
					_1: _user$project$LangUnparser$unparse(_p18._0)
				};
			},
			A4(_user$project$LangSvg$resolveToIndexedTree, old.slideNumber, old.movieNumber, old.movieTime, _p18._1));
	});
var _user$project$InterfaceModel$runAndResolve = F2(
	function (model, exp) {
		var thunk = function (_p19) {
			var _p20 = _p19;
			return A2(
				_elm_lang$core$Result$andThen,
				function (_p21) {
					var _p22 = _p21;
					var _p25 = _p22._0;
					return A2(
						_elm_lang$core$Result$map,
						function (_p23) {
							var _p24 = _p23;
							return {ctor: '_Tuple4', _0: _p25, _1: _p22._1, _2: _p24._0, _3: _p24._1};
						},
						A2(
							_user$project$InterfaceModel$slateAndCode,
							model,
							{ctor: '_Tuple2', _0: exp, _1: _p25}));
				},
				_user$project$Eval$run(exp));
		};
		return _user$project$Utils$unwrapNestedResult(
			_user$project$ImpureGoodies$crashToError(thunk));
	});
var _user$project$InterfaceModel$predicateImpossible = function (pred) {
	var _p26 = pred.value;
	switch (_p26.ctor) {
		case 'FullySatisfied':
			return false;
		case 'Satisfied':
			return false;
		case 'Possible':
			return false;
		default:
			return true;
	}
};
var _user$project$InterfaceModel$predicatePossible = function (pred) {
	var _p27 = pred.value;
	switch (_p27.ctor) {
		case 'FullySatisfied':
			return true;
		case 'Satisfied':
			return true;
		case 'Possible':
			return true;
		default:
			return false;
	}
};
var _user$project$InterfaceModel$predicateSatisfied = function (pred) {
	var _p28 = pred.value;
	switch (_p28.ctor) {
		case 'FullySatisfied':
			return true;
		case 'Satisfied':
			return true;
		case 'Possible':
			return false;
		default:
			return false;
	}
};
var _user$project$InterfaceModel$predicateFullySatisfied = function (pred) {
	var _p29 = pred.value;
	switch (_p29.ctor) {
		case 'FullySatisfied':
			return true;
		case 'Satisfied':
			return false;
		case 'Possible':
			return false;
		default:
			return false;
	}
};
var _user$project$InterfaceModel$importCodeFileInputId = 'import-code-file-input';
var _user$project$InterfaceModel$configurationPanelShown = function (model) {
	return !_elm_lang$core$Native_Utils.eq(model.selectedDeuceTool, _elm_lang$core$Maybe$Nothing);
};
var _user$project$InterfaceModel$deuceRightClickMenuShown = function (model) {
	return !_elm_lang$core$Native_Utils.eq(model.deuceRightClickMenuMode, _elm_lang$core$Maybe$Nothing);
};
var _user$project$InterfaceModel$deuceActive = function (model) {
	var shiftDown = A2(_elm_lang$core$List$member, _user$project$Keys$keyShift, model.keysDown);
	return model.codeClean && _user$project$Utils$or(
		{
			ctor: '::',
			_0: _user$project$Utils$and(
				{
					ctor: '::',
					_0: model.enableDeuceBoxSelection,
					_1: {
						ctor: '::',
						_0: !_user$project$InterfaceModel$deuceRightClickMenuShown(model),
						_1: {
							ctor: '::',
							_0: shiftDown,
							_1: {ctor: '[]'}
						}
					}
				}),
			_1: {
				ctor: '::',
				_0: _user$project$InterfaceModel$configurationPanelShown(model),
				_1: {ctor: '[]'}
			}
		});
};
var _user$project$InterfaceModel$deucePopupPanelShown = function (model) {
	return _user$project$Utils$and(
		{
			ctor: '::',
			_0: model.enableDeuceBoxSelection,
			_1: {
				ctor: '::',
				_0: !_user$project$InterfaceModel$noWidgetsSelected(model),
				_1: {
					ctor: '::',
					_0: !_user$project$InterfaceModel$deuceRightClickMenuShown(model),
					_1: {
						ctor: '::',
						_0: !_user$project$InterfaceModel$configurationPanelShown(model),
						_1: {ctor: '[]'}
					}
				}
			}
		});
};
var _user$project$InterfaceModel$hideDeuceRightClickMenu = function (model) {
	return _elm_lang$core$Native_Utils.update(
		model,
		{deuceRightClickMenuMode: _elm_lang$core$Maybe$Nothing});
};
var _user$project$InterfaceModel$showDeuceRightClickMenu = F4(
	function (offsetX, offsetY, menuMode, model) {
		var oldPopupPanelPositions = model.popupPanelPositions;
		var mousePos = _elm_lang$core$Tuple$second(model.mouseState);
		return _elm_lang$core$Native_Utils.update(
			model,
			{
				deuceRightClickMenuMode: _elm_lang$core$Maybe$Just(menuMode),
				popupPanelPositions: _elm_lang$core$Native_Utils.update(
					oldPopupPanelPositions,
					{
						deuceRightClickMenu: {ctor: '_Tuple2', _0: mousePos.x + offsetX, _1: mousePos.y + offsetY}
					})
			});
	});
var _user$project$InterfaceModel$anyDialogShown = function (_p30) {
	return !_elm_lang$core$Set$isEmpty(
		function (_) {
			return _.dialogBoxes;
		}(_p30));
};
var _user$project$InterfaceModel$setAllUpdated = function (model) {
	var old = model;
	return _elm_lang$core$Native_Utils.update(
		model,
		{
			enableTextEdits: _user$project$Updatable$setUpdated(old.enableTextEdits),
			prose: _user$project$Updatable$setUpdated(old.prose)
		});
};
var _user$project$InterfaceModel$initialLayoutOffsets = function () {
	var init = {dx: 0, dy: 0};
	return {
		codeBox: init,
		canvas: init,
		fileToolBox: init,
		codeToolBox: init,
		drawToolBox: init,
		attributeToolBox: init,
		blobToolBox: init,
		moreBlobToolBox: init,
		outputToolBox: init,
		animationToolBox: init,
		textToolBox: init,
		deuceToolBox: {pinned: false, offsets: init},
		synthesisResultsSelectBox: init
	};
}();
var _user$project$InterfaceModel$resultExp = function (_p31) {
	var _p32 = _p31;
	return _p32._0.exp;
};
var _user$project$InterfaceModel$resultDescription = function (_p33) {
	var _p34 = _p33;
	return _p34._0.description;
};
var _user$project$InterfaceModel$isResultSafe = function (_p35) {
	var _p36 = _p35;
	return _p36._0.isSafe;
};
var _user$project$InterfaceModel$synthesisResultsNotEmpty = function (_p37) {
	return !_elm_lang$core$List$isEmpty(
		function (_) {
			return _.synthesisResults;
		}(_p37));
};
var _user$project$InterfaceModel$TrackedValues = F2(
	function (a, b) {
		return {code: a, selectedDeuceWidgets: b};
	});
var _user$project$InterfaceModel$File = F2(
	function (a, b) {
		return {filename: a, code: b};
	});
var _user$project$InterfaceModel$Position = F2(
	function (a, b) {
		return {col: a, line: b};
	});
var _user$project$InterfaceModel$Icon = F2(
	function (a, b) {
		return {iconName: a, code: b};
	});
var _user$project$InterfaceModel$ViewState = function (a) {
	return {menuActive: a};
};
var _user$project$InterfaceModel$PopupPanelPositions = F3(
	function (a, b, c) {
		return {deuce: a, editCode: b, deuceRightClickMenu: c};
	});
var _user$project$InterfaceModel$Model = function (a) {
	return function (b) {
		return function (c) {
			return function (d) {
				return function (e) {
					return function (f) {
						return function (g) {
							return function (h) {
								return function (i) {
									return function (j) {
										return function (k) {
											return function (l) {
												return function (m) {
													return function (n) {
														return function (o) {
															return function (p) {
																return function (q) {
																	return function (r) {
																		return function (s) {
																			return function (t) {
																				return function (u) {
																					return function (v) {
																						return function (w) {
																							return function (x) {
																								return function (y) {
																									return function (z) {
																										return function (_1) {
																											return function (_2) {
																												return function (_3) {
																													return function (_4) {
																														return function (_5) {
																															return function (_6) {
																																return function (_7) {
																																	return function (_8) {
																																		return function (_9) {
																																			return function (_10) {
																																				return function (_11) {
																																					return function (_12) {
																																						return function (_13) {
																																							return function (_14) {
																																								return function (_15) {
																																									return function (_16) {
																																										return function (_17) {
																																											return function (_18) {
																																												return function (_19) {
																																													return function (_20) {
																																														return function (_21) {
																																															return function (_22) {
																																																return function (_23) {
																																																	return function (_24) {
																																																		return function (_25) {
																																																			return function (_26) {
																																																				return function (_27) {
																																																					return function (_28) {
																																																						return function (_29) {
																																																							return function (_30) {
																																																								return function (_31) {
																																																									return function (_32) {
																																																										return function (_33) {
																																																											return function (_34) {
																																																												return function (_35) {
																																																													return function (_36) {
																																																														return function (_37) {
																																																															return function (_38) {
																																																																return function (_39) {
																																																																	return function (_40) {
																																																																		return function (_41) {
																																																																			return function (_42) {
																																																																				return function (_43) {
																																																																					return function (_44) {
																																																																						return function (_45) {
																																																																							return function (_46) {
																																																																								return function (_47) {
																																																																									return function (_48) {
																																																																										return function (_49) {
																																																																											return function (_50) {
																																																																												return function (_51) {
																																																																													return function (_52) {
																																																																														return function (_53) {
																																																																															return function (_54) {
																																																																																return function (_55) {
																																																																																	return function (_56) {
																																																																																		return function (_57) {
																																																																																			return function (_58) {
																																																																																				return function (_59) {
																																																																																					return function (_60) {
																																																																																						return function (_61) {
																																																																																							return {code: a, lastRunCode: b, preview: c, history: d, inputExp: e, inputVal: f, slideNumber: g, slideCount: h, movieNumber: i, movieCount: j, movieTime: k, movieDuration: l, movieContinue: m, runAnimation: n, slate: o, widgets: p, liveSyncInfo: q, liveSyncDelay: r, outputMode: s, mouseMode: t, dimensions: u, mouseState: v, syncOptions: w, caption: x, showGhosts: y, localSaves: z, startup: _1, codeBoxInfo: _2, basicCodeBox: _3, errorBox: _4, genSymCount: _5, tool: _6, hoveredShapes: _7, hoveredCrosshairs: _8, selectedShapes: _9, selectedFeatures: _10, selectedBlobs: _11, keysDown: _12, autoSynthesis: _13, synthesisResults: _14, hoveredSynthesisResultPathByIndices: _15, randomColor: _16, lambdaTools: _17, layoutOffsets: _18, needsSave: _19, lastSaveState: _20, autosave: _21, filename: _22, fileIndex: _23, dialogBoxes: _24, filenameInput: _25, fileToDelete: _26, pendingFileOperation: _27, fileOperationConfirmed: _28, icons: _29, showAllDeuceWidgets: _30, hoveringCodeBox: _31, scopeGraph: _32, deuceState: _33, deuceToolsAndResults: _34, deuceToolResultPreviews: _35, selectedDeuceTool: _36, showOnlyBasicTools: _37, viewState: _38, toolMode: _39, popupPanelPositions: _40, deuceRightClickMenuMode: _41, userStudyStateIndex: _42, userStudyTaskStartTime: _43, userStudyTaskCurrentTime: _44, enableDeuceBoxSelection: _45, enableDeuceTextSelection: _46, codeToolsMenuMode: _47, textSelectMode: _48, enableTextEdits: _49, allowMultipleTargetPositions: _50, enableDomainSpecificCodeTools: _51, codeClean: _52, mainResizerX: _53, proseResizerY: _54, savedSelections: _55, prose: _56, deucePopupPanelAbove: _57, colorScheme: _58, pendingGiveUpMsg: _59, giveUpConfirmed: _60, lastSelectedTemplate: _61};
																																																																																						};
																																																																																					};
																																																																																				};
																																																																																			};
																																																																																		};
																																																																																	};
																																																																																};
																																																																															};
																																																																														};
																																																																													};
																																																																												};
																																																																											};
																																																																										};
																																																																									};
																																																																								};
																																																																							};
																																																																						};
																																																																					};
																																																																				};
																																																																			};
																																																																		};
																																																																	};
																																																																};
																																																															};
																																																														};
																																																													};
																																																												};
																																																											};
																																																										};
																																																									};
																																																								};
																																																							};
																																																						};
																																																					};
																																																				};
																																																			};
																																																		};
																																																	};
																																																};
																																															};
																																														};
																																													};
																																												};
																																											};
																																										};
																																									};
																																								};
																																							};
																																						};
																																					};
																																				};
																																			};
																																		};
																																	};
																																};
																															};
																														};
																													};
																												};
																											};
																										};
																									};
																								};
																							};
																						};
																					};
																				};
																			};
																		};
																	};
																};
															};
														};
													};
												};
											};
										};
									};
								};
							};
						};
					};
				};
			};
		};
	};
};
var _user$project$InterfaceModel$CodeBoxInfo = function (a) {
	return function (b) {
		return function (c) {
			return function (d) {
				return function (e) {
					return function (f) {
						return function (g) {
							return function (h) {
								return function (i) {
									return function (j) {
										return function (k) {
											return function (l) {
												return function (m) {
													return function (n) {
														return function (o) {
															return function (p) {
																return function (q) {
																	return function (r) {
																		return function (s) {
																			return function (t) {
																				return function (u) {
																					return function (v) {
																						return {cursorPos: a, selections: b, highlights: c, annotations: d, tooltips: e, fontSize: f, lineHeight: g, characterWidth: h, offsetLeft: i, offsetHeight: j, gutterWidth: k, firstVisibleRow: l, lastVisibleRow: m, marginTopOffset: n, marginLeftOffset: o, scrollerTop: p, scrollerLeft: q, scrollerWidth: r, scrollerHeight: s, contentLeft: t, scrollTop: u, scrollLeft: v};
																					};
																				};
																			};
																		};
																	};
																};
															};
														};
													};
												};
											};
										};
									};
								};
							};
						};
					};
				};
			};
		};
	};
};
var _user$project$InterfaceModel$AceCodeBoxInfo = F2(
	function (a, b) {
		return {code: a, codeBoxInfo: b};
	});
var _user$project$InterfaceModel$Offsets = F2(
	function (a, b) {
		return {dx: a, dy: b};
	});
var _user$project$InterfaceModel$LayoutOffsets = function (a) {
	return function (b) {
		return function (c) {
			return function (d) {
				return function (e) {
					return function (f) {
						return function (g) {
							return function (h) {
								return function (i) {
									return function (j) {
										return function (k) {
											return function (l) {
												return function (m) {
													return {codeBox: a, canvas: b, fileToolBox: c, codeToolBox: d, drawToolBox: e, attributeToolBox: f, blobToolBox: g, moreBlobToolBox: h, outputToolBox: i, animationToolBox: j, textToolBox: k, deuceToolBox: l, synthesisResultsSelectBox: m};
												};
											};
										};
									};
								};
							};
						};
					};
				};
			};
		};
	};
};
var _user$project$InterfaceModel$Predicate = F2(
	function (a, b) {
		return {description: a, value: b};
	});
var _user$project$InterfaceModel$DeuceTool = F4(
	function (a, b, c, d) {
		return {name: a, func: b, reqs: c, id: d};
	});
var _user$project$InterfaceModel$Word = {ctor: 'Word'};
var _user$project$InterfaceModel$codeObjectFromSelection = F2(
	function (allowSingleSelection, model) {
		var _p38 = model.codeBoxInfo.selections;
		if ((_p38.ctor === '::') && (_p38._1.ctor === '[]')) {
			var _p42 = _p38._0;
			var textSelectMode = (allowSingleSelection && _elm_lang$core$Native_Utils.eq(_p42.start, _p42.end)) ? _user$project$InterfaceModel$Word : model.textSelectMode;
			var theFilter = function (codeObject) {
				var word = _user$project$Lang$isWord(codeObject);
				var textSelectable = _user$project$Lang$isTextSelectable(codeObject);
				var notDef = function () {
					var _p39 = codeObject;
					if (_p39.ctor === 'E') {
						var _p40 = _p39._0.val.e__;
						if ((_p40.ctor === 'ELet') && (_p40._1.ctor === 'Def')) {
							return false;
						} else {
							return true;
						}
					} else {
						return true;
					}
				}();
				var activeFilters = A2(
					_elm_lang$core$Basics_ops['++'],
					{
						ctor: '::',
						_0: notDef,
						_1: {
							ctor: '::',
							_0: textSelectable,
							_1: {ctor: '[]'}
						}
					},
					_elm_lang$core$Native_Utils.eq(textSelectMode, _user$project$InterfaceModel$Word) ? {
						ctor: '::',
						_0: word,
						_1: {ctor: '[]'}
					} : {ctor: '[]'});
				return _user$project$Utils$and(activeFilters);
			};
			return A4(
				_user$project$InterfaceModel$matchingRange,
				textSelectMode,
				model.code,
				_p42,
				A2(
					_elm_lang$core$List$map,
					function (codeObject) {
						return {
							ctor: '_Tuple2',
							_0: function (_p41) {
								return _user$project$InterfaceModel$rangeFromInfo(
									_user$project$Lang$extractInfoFromCodeObject(_p41));
							}(codeObject),
							_1: codeObject
						};
					},
					A2(
						_elm_lang$core$List$filter,
						theFilter,
						_user$project$Lang$flattenToCodeObjects(
							_user$project$Lang$E(model.inputExp)))));
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$InterfaceModel$SubsetExtra = {ctor: 'SubsetExtra'};
var _user$project$InterfaceModel$Subset = {ctor: 'Subset'};
var _user$project$InterfaceModel$Superset = {ctor: 'Superset'};
var _user$project$InterfaceModel$Strict = {ctor: 'Strict'};
var _user$project$InterfaceModel$ShowPossible = {ctor: 'ShowPossible'};
var _user$project$InterfaceModel$Dark = {ctor: 'Dark'};
var _user$project$InterfaceModel$Light = {ctor: 'Light'};
var _user$project$InterfaceModel$initColorScheme = _user$project$InterfaceModel$Light;
var _user$project$InterfaceModel$CTDisabled = {ctor: 'CTDisabled'};
var _user$project$InterfaceModel$CTActive = {ctor: 'CTActive'};
var _user$project$InterfaceModel$CTAll = {ctor: 'CTAll'};
var _user$project$InterfaceModel$PrintScopeGraph = function (a) {
	return {ctor: 'PrintScopeGraph', _0: a};
};
var _user$project$InterfaceModel$Print = function (a) {
	return {ctor: 'Print', _0: a};
};
var _user$project$InterfaceModel$Live = {ctor: 'Live'};
var _user$project$InterfaceModel$MouseDownInCodebox = function (a) {
	return {ctor: 'MouseDownInCodebox', _0: a};
};
var _user$project$InterfaceModel$MouseDrawNew = function (a) {
	return {ctor: 'MouseDrawNew', _0: a};
};
var _user$project$InterfaceModel$MouseDragZone = F2(
	function (a, b) {
		return {ctor: 'MouseDragZone', _0: a, _1: b};
	});
var _user$project$InterfaceModel$MouseDragLayoutWidget = function (a) {
	return {ctor: 'MouseDragLayoutWidget', _0: a};
};
var _user$project$InterfaceModel$MouseDrag = function (a) {
	return {ctor: 'MouseDrag', _0: a};
};
var _user$project$InterfaceModel$MouseNothing = {ctor: 'MouseNothing'};
var _user$project$InterfaceModel$OffsetFromExisting = F2(
	function (a, b) {
		return {ctor: 'OffsetFromExisting', _0: a, _1: b};
	});
var _user$project$InterfaceModel$PathPoints = function (a) {
	return {ctor: 'PathPoints', _0: a};
};
var _user$project$InterfaceModel$PolyPoints = function (a) {
	return {ctor: 'PolyPoints', _0: a};
};
var _user$project$InterfaceModel$TwoPoints = F2(
	function (a, b) {
		return {ctor: 'TwoPoints', _0: a, _1: b};
	});
var _user$project$InterfaceModel$NoPointsYet = {ctor: 'NoPointsYet'};
var _user$project$InterfaceModel$Lambda = function (a) {
	return {ctor: 'Lambda', _0: a};
};
var _user$project$InterfaceModel$HelperLine = {ctor: 'HelperLine'};
var _user$project$InterfaceModel$Path = function (a) {
	return {ctor: 'Path', _0: a};
};
var _user$project$InterfaceModel$Poly = function (a) {
	return {ctor: 'Poly', _0: a};
};
var _user$project$InterfaceModel$Oval = function (a) {
	return {ctor: 'Oval', _0: a};
};
var _user$project$InterfaceModel$Rect = function (a) {
	return {ctor: 'Rect', _0: a};
};
var _user$project$InterfaceModel$Line = function (a) {
	return {ctor: 'Line', _0: a};
};
var _user$project$InterfaceModel$Text = {ctor: 'Text'};
var _user$project$InterfaceModel$PointOrOffset = {ctor: 'PointOrOffset'};
var _user$project$InterfaceModel$Cursor = {ctor: 'Cursor'};
var _user$project$InterfaceModel$Sticky = {ctor: 'Sticky'};
var _user$project$InterfaceModel$Stretchy = {ctor: 'Stretchy'};
var _user$project$InterfaceModel$Raw = {ctor: 'Raw'};
var _user$project$InterfaceModel$LambdaAnchor = F2(
	function (a, b) {
		return {ctor: 'LambdaAnchor', _0: a, _1: b};
	});
var _user$project$InterfaceModel$LambdaBounds = function (a) {
	return {ctor: 'LambdaBounds', _0: a};
};
var _user$project$InterfaceModel$starLambdaTool = _user$project$InterfaceModel$LambdaBounds(
	_user$project$Lang$eVar('star'));
var _user$project$InterfaceModel$starLambdaToolIcon = _user$project$InterfaceModel$lambdaToolIcon(_user$project$InterfaceModel$starLambdaTool);
var _user$project$InterfaceModel$initModel = function () {
	var _p43 = A2(_user$project$Utils$find_, _user$project$ExamplesGenerated$list, _user$project$InterfaceModel$initTemplate);
	var f = _p43._1;
	var _p44 = f(
		{ctor: '_Tuple0'});
	var e = _p44.e;
	var v = _p44.v;
	var ws = _p44.ws;
	var unwrap = _user$project$Utils$fromOk('generating initModel');
	var _p45 = unwrap(
		A4(_user$project$LangSvg$fetchEverything, 1, 1, 0.0, v));
	var slideCount = _p45._0;
	var movieCount = _p45._1;
	var movieDuration = _p45._2;
	var movieContinue = _p45._3;
	var slate = _p45._4;
	var liveSyncInfo = unwrap(
		A6(
			_user$project$InterfaceModel$mkLive,
			_user$project$Sync$defaultOptions,
			1,
			1,
			0.0,
			e,
			{ctor: '_Tuple2', _0: v, _1: ws}));
	var code = _user$project$LangUnparser$unparse(e);
	return {
		code: code,
		lastRunCode: code,
		preview: _elm_lang$core$Maybe$Nothing,
		history: _user$project$History$begin(
			{
				code: code,
				selectedDeuceWidgets: {ctor: '[]'}
			}),
		inputExp: e,
		inputVal: v,
		slideNumber: 1,
		slideCount: slideCount,
		movieNumber: 1,
		movieCount: movieCount,
		movieTime: 0.0,
		movieDuration: movieDuration,
		movieContinue: movieContinue,
		runAnimation: true,
		slate: slate,
		widgets: ws,
		liveSyncInfo: liveSyncInfo,
		liveSyncDelay: false,
		outputMode: _user$project$InterfaceModel$Live,
		mouseMode: _user$project$InterfaceModel$MouseNothing,
		dimensions: {width: 1000, height: 800},
		mouseState: {
			ctor: '_Tuple2',
			_0: _elm_lang$core$Maybe$Nothing,
			_1: {x: 0, y: 0}
		},
		syncOptions: _user$project$Sync$defaultOptions,
		caption: _elm_lang$core$Maybe$Nothing,
		showGhosts: true,
		localSaves: {ctor: '[]'},
		startup: true,
		codeBoxInfo: {
			cursorPos: {
				row: _elm_lang$core$Basics$round(0),
				column: _elm_lang$core$Basics$round(0)
			},
			selections: {ctor: '[]'},
			highlights: {ctor: '[]'},
			annotations: {ctor: '[]'},
			tooltips: {ctor: '[]'},
			fontSize: 16,
			characterWidth: 10.0,
			lineHeight: 20.0,
			offsetLeft: 10.0,
			offsetHeight: 10.0,
			gutterWidth: 50.0,
			firstVisibleRow: 0,
			lastVisibleRow: 10,
			marginTopOffset: 0.0,
			marginLeftOffset: 0.0,
			scrollerTop: 0.0,
			scrollerLeft: 0.0,
			scrollerWidth: 0.0,
			scrollerHeight: 0.0,
			contentLeft: 0.0,
			scrollLeft: 0.0,
			scrollTop: 0.0
		},
		basicCodeBox: false,
		errorBox: _elm_lang$core$Maybe$Nothing,
		genSymCount: 1,
		tool: _user$project$InterfaceModel$Cursor,
		hoveredShapes: _elm_lang$core$Set$empty,
		hoveredCrosshairs: _elm_lang$core$Set$empty,
		selectedShapes: _elm_lang$core$Set$empty,
		selectedFeatures: _elm_lang$core$Set$empty,
		selectedBlobs: _elm_lang$core$Dict$empty,
		keysDown: {ctor: '[]'},
		autoSynthesis: false,
		synthesisResults: {ctor: '[]'},
		hoveredSynthesisResultPathByIndices: {ctor: '[]'},
		randomColor: 100,
		lambdaTools: {
			ctor: '::',
			_0: _user$project$InterfaceModel$starLambdaTool,
			_1: {ctor: '[]'}
		},
		layoutOffsets: _user$project$InterfaceModel$initialLayoutOffsets,
		needsSave: false,
		lastSaveState: _elm_lang$core$Maybe$Nothing,
		autosave: false,
		filename: '',
		fileIndex: {ctor: '[]'},
		dialogBoxes: _elm_lang$core$Set$empty,
		filenameInput: '',
		fileToDelete: '',
		pendingFileOperation: _elm_lang$core$Maybe$Nothing,
		fileOperationConfirmed: false,
		icons: _elm_lang$core$Dict$empty,
		scopeGraph: _user$project$DependenceGraph$compute(e),
		showAllDeuceWidgets: false,
		hoveringCodeBox: false,
		deuceState: _user$project$DeuceWidgets$emptyDeuceState,
		deuceToolsAndResults: {ctor: '[]'},
		deuceToolResultPreviews: _elm_lang$core$Dict$empty,
		selectedDeuceTool: _elm_lang$core$Maybe$Nothing,
		showOnlyBasicTools: true,
		viewState: {menuActive: false},
		toolMode: _user$project$InterfaceModel$Raw,
		popupPanelPositions: {
			deuce: {ctor: '_Tuple2', _0: 200, _1: 200},
			editCode: {ctor: '_Tuple2', _0: 400, _1: 400},
			deuceRightClickMenu: {ctor: '_Tuple2', _0: 400, _1: 400}
		},
		deuceRightClickMenuMode: _elm_lang$core$Maybe$Nothing,
		userStudyStateIndex: 1,
		userStudyTaskStartTime: 0.0,
		userStudyTaskCurrentTime: 0.0,
		enableDeuceBoxSelection: true,
		enableDeuceTextSelection: true,
		codeToolsMenuMode: _user$project$InterfaceModel$CTAll,
		textSelectMode: _user$project$InterfaceModel$SubsetExtra,
		enableTextEdits: function (_p46) {
			return _user$project$Updatable$setUpdated(
				_user$project$Updatable$create(_p46));
		}(true),
		allowMultipleTargetPositions: false,
		enableDomainSpecificCodeTools: false,
		codeClean: true,
		mainResizerX: _elm_lang$core$Maybe$Nothing,
		proseResizerY: _elm_lang$core$Maybe$Nothing,
		savedSelections: _elm_lang$core$Maybe$Nothing,
		prose: function (_p47) {
			return _user$project$Updatable$setUpdated(
				_user$project$Updatable$create(_p47));
		}(_elm_lang$core$Maybe$Nothing),
		deucePopupPanelAbove: true,
		colorScheme: _user$project$InterfaceModel$initColorScheme,
		pendingGiveUpMsg: _elm_lang$core$Maybe$Nothing,
		giveUpConfirmed: false,
		lastSelectedTemplate: _elm_lang$core$Maybe$Nothing
	};
}();
var _user$project$InterfaceModel$LangError = function (a) {
	return {ctor: 'LangError', _0: a};
};
var _user$project$InterfaceModel$Hovering = function (a) {
	return {ctor: 'Hovering', _0: a};
};
var _user$project$InterfaceModel$RadialRepeat = {ctor: 'RadialRepeat'};
var _user$project$InterfaceModel$LinearRepeat = {ctor: 'LinearRepeat'};
var _user$project$InterfaceModel$HorizontalRepeat = {ctor: 'HorizontalRepeat'};
var _user$project$InterfaceModel$SynthesisResult = function (a) {
	return {ctor: 'SynthesisResult', _0: a};
};
var _user$project$InterfaceModel$synthesisResult = F2(
	function (description, exp) {
		return _user$project$InterfaceModel$SynthesisResult(
			{
				description: description,
				exp: exp,
				isSafe: true,
				sortKey: {ctor: '[]'},
				children: _elm_lang$core$Maybe$Nothing
			});
	});
var _user$project$InterfaceModel$oneSafeResult = function (newExp) {
	return _elm_lang$core$List$singleton(
		A2(_user$project$InterfaceModel$synthesisResult, 'NO DESCRIPTION B/C SELECTED AUTOMATICALLY', newExp));
};
var _user$project$InterfaceModel$mapResultSafe = F2(
	function (f, _p48) {
		var _p49 = _p48;
		var _p50 = _p49._0;
		return _user$project$InterfaceModel$SynthesisResult(
			_elm_lang$core$Native_Utils.update(
				_p50,
				{
					isSafe: f(_p50.isSafe)
				}));
	});
var _user$project$InterfaceModel$setResultSafe = F2(
	function (isSafe, synthesisResult) {
		return A2(
			_user$project$InterfaceModel$mapResultSafe,
			function (_p51) {
				return isSafe;
			},
			synthesisResult);
	});
var _user$project$InterfaceModel$setResultDescription = F2(
	function (description, _p52) {
		var _p53 = _p52;
		return _user$project$InterfaceModel$SynthesisResult(
			_elm_lang$core$Native_Utils.update(
				_p53._0,
				{description: description}));
	});
var _user$project$InterfaceModel$Msg = F2(
	function (a, b) {
		return {ctor: 'Msg', _0: a, _1: b};
	});
var _user$project$InterfaceModel$AlertGiveUp = {ctor: 'AlertGiveUp'};
var _user$project$InterfaceModel$Help = function (a) {
	return {ctor: 'Help', _0: a};
};
var _user$project$InterfaceModel$ImportCode = {ctor: 'ImportCode'};
var _user$project$InterfaceModel$AlertSave = {ctor: 'AlertSave'};
var _user$project$InterfaceModel$Open = {ctor: 'Open'};
var _user$project$InterfaceModel$SaveAs = {ctor: 'SaveAs'};
var _user$project$InterfaceModel$New = {ctor: 'New'};
var _user$project$InterfaceModel$HelpBoxSelectMode = {ctor: 'HelpBoxSelectMode'};
var _user$project$InterfaceModel$HelpTextSelectMode = {ctor: 'HelpTextSelectMode'};
var _user$project$InterfaceModel$HelpSyntax = {ctor: 'HelpSyntax'};
var _user$project$InterfaceModel$dialogBoxes = A2(
	_user$project$Utils$mapi0,
	_elm_lang$core$Basics$identity,
	{
		ctor: '::',
		_0: _user$project$InterfaceModel$New,
		_1: {
			ctor: '::',
			_0: _user$project$InterfaceModel$SaveAs,
			_1: {
				ctor: '::',
				_0: _user$project$InterfaceModel$Open,
				_1: {
					ctor: '::',
					_0: _user$project$InterfaceModel$AlertSave,
					_1: {
						ctor: '::',
						_0: _user$project$InterfaceModel$ImportCode,
						_1: {
							ctor: '::',
							_0: _user$project$InterfaceModel$Help(_user$project$InterfaceModel$HelpSyntax),
							_1: {
								ctor: '::',
								_0: _user$project$InterfaceModel$Help(_user$project$InterfaceModel$HelpTextSelectMode),
								_1: {
									ctor: '::',
									_0: _user$project$InterfaceModel$Help(_user$project$InterfaceModel$HelpBoxSelectMode),
									_1: {
										ctor: '::',
										_0: _user$project$InterfaceModel$AlertGiveUp,
										_1: {ctor: '[]'}
									}
								}
							}
						}
					}
				}
			}
		}
	});
var _user$project$InterfaceModel$dbToInt = function (db) {
	var _p55 = A2(
		_user$project$Utils$findFirst,
		function (_p54) {
			return A2(
				F2(
					function (x, y) {
						return _elm_lang$core$Native_Utils.eq(x, y);
					}),
				db,
				_elm_lang$core$Tuple$second(_p54));
		},
		_user$project$InterfaceModel$dialogBoxes);
	if (_p55.ctor === 'Just') {
		return _p55._0._0;
	} else {
		return _elm_lang$core$Native_Utils.crashCase(
			'InterfaceModel',
			{
				start: {line: 431, column: 3},
				end: {line: 433, column: 79}
			},
			_p55)(
			A2(
				_elm_lang$core$Basics_ops['++'],
				'Undefined Dialog Box Type: ',
				_elm_lang$core$Basics$toString(db)));
	}
};
var _user$project$InterfaceModel$openDialogBox = F2(
	function (db, model) {
		return _elm_lang$core$Native_Utils.update(
			model,
			{
				dialogBoxes: A2(
					_elm_lang$core$Set$insert,
					_user$project$InterfaceModel$dbToInt(db),
					model.dialogBoxes)
			});
	});
var _user$project$InterfaceModel$closeDialogBox = F2(
	function (db, model) {
		return _elm_lang$core$Native_Utils.update(
			model,
			{
				dialogBoxes: A2(
					_elm_lang$core$Set$remove,
					_user$project$InterfaceModel$dbToInt(db),
					model.dialogBoxes)
			});
	});
var _user$project$InterfaceModel$cancelFileOperation = function (model) {
	return A2(
		_user$project$InterfaceModel$closeDialogBox,
		_user$project$InterfaceModel$AlertSave,
		_elm_lang$core$Native_Utils.update(
			model,
			{pendingFileOperation: _elm_lang$core$Maybe$Nothing, fileOperationConfirmed: false}));
};
var _user$project$InterfaceModel$closeAllDialogBoxes = function (model) {
	var noFileOpsModel = _user$project$InterfaceModel$cancelFileOperation(model);
	return _elm_lang$core$Native_Utils.update(
		noFileOpsModel,
		{dialogBoxes: _elm_lang$core$Set$empty});
};
var _user$project$InterfaceModel$cancelGiveUp = function (model) {
	return A2(
		_user$project$InterfaceModel$closeDialogBox,
		_user$project$InterfaceModel$AlertGiveUp,
		_elm_lang$core$Native_Utils.update(
			model,
			{pendingGiveUpMsg: _elm_lang$core$Maybe$Nothing, giveUpConfirmed: false}));
};
var _user$project$InterfaceModel$isDialogBoxShowing = F2(
	function (db, model) {
		return A2(
			_elm_lang$core$Set$member,
			_user$project$InterfaceModel$dbToInt(db),
			model.dialogBoxes);
	});
var _user$project$InterfaceModel$intToDb = function (n) {
	var _p57 = A2(_user$project$Utils$maybeFind, n, _user$project$InterfaceModel$dialogBoxes);
	if (_p57.ctor === 'Just') {
		return _p57._0;
	} else {
		return _elm_lang$core$Native_Utils.crashCase(
			'InterfaceModel',
			{
				start: {line: 437, column: 3},
				end: {line: 439, column: 72}
			},
			_p57)(
			A2(
				_elm_lang$core$Basics_ops['++'],
				'Undefined Dialog Box Id: ',
				_elm_lang$core$Basics$toString(n)));
	}
};
var _user$project$InterfaceModel$Impossible = {ctor: 'Impossible'};
var _user$project$InterfaceModel$Possible = {ctor: 'Possible'};
var _user$project$InterfaceModel$Satisfied = {ctor: 'Satisfied'};
var _user$project$InterfaceModel$FullySatisfied = {ctor: 'FullySatisfied'};

var _user$project$AceCodeBox$aceCodeBoxCmd = _elm_lang$core$Native_Platform.outgoingPort(
	'aceCodeBoxCmd',
	function (v) {
		return {
			message: v.message,
			info: {
				code: v.info.code,
				codeBoxInfo: {
					cursorPos: {row: v.info.codeBoxInfo.cursorPos.row, column: v.info.codeBoxInfo.cursorPos.column},
					selections: _elm_lang$core$Native_List.toArray(v.info.codeBoxInfo.selections).map(
						function (v) {
							return {
								start: {row: v.start.row, column: v.start.column},
								end: {row: v.end.row, column: v.end.column}
							};
						}),
					highlights: _elm_lang$core$Native_List.toArray(v.info.codeBoxInfo.highlights).map(
						function (v) {
							return {
								range: {
									start: {row: v.range.start.row, column: v.range.start.column},
									end: {row: v.range.end.row, column: v.range.end.column}
								},
								color: v.color
							};
						}),
					annotations: _elm_lang$core$Native_List.toArray(v.info.codeBoxInfo.annotations).map(
						function (v) {
							return {row: v.row, type_: v.type_, text: v.text};
						}),
					tooltips: _elm_lang$core$Native_List.toArray(v.info.codeBoxInfo.tooltips).map(
						function (v) {
							return {row: v.row, col: v.col, text: v.text};
						}),
					fontSize: v.info.codeBoxInfo.fontSize,
					lineHeight: v.info.codeBoxInfo.lineHeight,
					characterWidth: v.info.codeBoxInfo.characterWidth,
					offsetLeft: v.info.codeBoxInfo.offsetLeft,
					offsetHeight: v.info.codeBoxInfo.offsetHeight,
					gutterWidth: v.info.codeBoxInfo.gutterWidth,
					firstVisibleRow: v.info.codeBoxInfo.firstVisibleRow,
					lastVisibleRow: v.info.codeBoxInfo.lastVisibleRow,
					marginTopOffset: v.info.codeBoxInfo.marginTopOffset,
					marginLeftOffset: v.info.codeBoxInfo.marginLeftOffset,
					scrollerTop: v.info.codeBoxInfo.scrollerTop,
					scrollerLeft: v.info.codeBoxInfo.scrollerLeft,
					scrollerWidth: v.info.codeBoxInfo.scrollerWidth,
					scrollerHeight: v.info.codeBoxInfo.scrollerHeight,
					contentLeft: v.info.codeBoxInfo.contentLeft,
					scrollTop: v.info.codeBoxInfo.scrollTop,
					scrollLeft: v.info.codeBoxInfo.scrollLeft
				}
			}
		};
	});
var _user$project$AceCodeBox$sendCmd = F2(
	function (message, model) {
		return _user$project$AceCodeBox$aceCodeBoxCmd(
			{
				message: message,
				info: {
					code: _user$project$InterfaceModel$codeToShow(model),
					codeBoxInfo: model.codeBoxInfo
				}
			});
	});
var _user$project$AceCodeBox$initializeAndDisplay = _user$project$AceCodeBox$sendCmd('initializeAndDisplay');
var _user$project$AceCodeBox$display = _user$project$AceCodeBox$sendCmd('display');
var _user$project$AceCodeBox$resize = _user$project$AceCodeBox$sendCmd('resize');
var _user$project$AceCodeBox$updateFontSize = _user$project$AceCodeBox$sendCmd('updateFontSize');
var _user$project$AceCodeBox$resetScroll = _user$project$AceCodeBox$sendCmd('resetScroll');
var _user$project$AceCodeBox$setReadOnly = _elm_lang$core$Native_Platform.outgoingPort(
	'setReadOnly',
	function (v) {
		return v;
	});
var _user$project$AceCodeBox$setSelections = _elm_lang$core$Native_Platform.outgoingPort(
	'setSelections',
	function (v) {
		return _elm_lang$core$Native_List.toArray(v).map(
			function (v) {
				return {
					start: {row: v.start.row, column: v.start.column},
					end: {row: v.end.row, column: v.end.column}
				};
			});
	});
var _user$project$AceCodeBox$receiveEditorState = _elm_lang$core$Native_Platform.incomingPort(
	'receiveEditorState',
	A2(
		_elm_lang$core$Json_Decode$andThen,
		function (code) {
			return A2(
				_elm_lang$core$Json_Decode$andThen,
				function (codeBoxInfo) {
					return _elm_lang$core$Json_Decode$succeed(
						{code: code, codeBoxInfo: codeBoxInfo});
				},
				A2(
					_elm_lang$core$Json_Decode$field,
					'codeBoxInfo',
					A2(
						_elm_lang$core$Json_Decode$andThen,
						function (cursorPos) {
							return A2(
								_elm_lang$core$Json_Decode$andThen,
								function (selections) {
									return A2(
										_elm_lang$core$Json_Decode$andThen,
										function (highlights) {
											return A2(
												_elm_lang$core$Json_Decode$andThen,
												function (annotations) {
													return A2(
														_elm_lang$core$Json_Decode$andThen,
														function (tooltips) {
															return A2(
																_elm_lang$core$Json_Decode$andThen,
																function (fontSize) {
																	return A2(
																		_elm_lang$core$Json_Decode$andThen,
																		function (lineHeight) {
																			return A2(
																				_elm_lang$core$Json_Decode$andThen,
																				function (characterWidth) {
																					return A2(
																						_elm_lang$core$Json_Decode$andThen,
																						function (offsetLeft) {
																							return A2(
																								_elm_lang$core$Json_Decode$andThen,
																								function (offsetHeight) {
																									return A2(
																										_elm_lang$core$Json_Decode$andThen,
																										function (gutterWidth) {
																											return A2(
																												_elm_lang$core$Json_Decode$andThen,
																												function (firstVisibleRow) {
																													return A2(
																														_elm_lang$core$Json_Decode$andThen,
																														function (lastVisibleRow) {
																															return A2(
																																_elm_lang$core$Json_Decode$andThen,
																																function (marginTopOffset) {
																																	return A2(
																																		_elm_lang$core$Json_Decode$andThen,
																																		function (marginLeftOffset) {
																																			return A2(
																																				_elm_lang$core$Json_Decode$andThen,
																																				function (scrollerTop) {
																																					return A2(
																																						_elm_lang$core$Json_Decode$andThen,
																																						function (scrollerLeft) {
																																							return A2(
																																								_elm_lang$core$Json_Decode$andThen,
																																								function (scrollerWidth) {
																																									return A2(
																																										_elm_lang$core$Json_Decode$andThen,
																																										function (scrollerHeight) {
																																											return A2(
																																												_elm_lang$core$Json_Decode$andThen,
																																												function (contentLeft) {
																																													return A2(
																																														_elm_lang$core$Json_Decode$andThen,
																																														function (scrollTop) {
																																															return A2(
																																																_elm_lang$core$Json_Decode$andThen,
																																																function (scrollLeft) {
																																																	return _elm_lang$core$Json_Decode$succeed(
																																																		{cursorPos: cursorPos, selections: selections, highlights: highlights, annotations: annotations, tooltips: tooltips, fontSize: fontSize, lineHeight: lineHeight, characterWidth: characterWidth, offsetLeft: offsetLeft, offsetHeight: offsetHeight, gutterWidth: gutterWidth, firstVisibleRow: firstVisibleRow, lastVisibleRow: lastVisibleRow, marginTopOffset: marginTopOffset, marginLeftOffset: marginLeftOffset, scrollerTop: scrollerTop, scrollerLeft: scrollerLeft, scrollerWidth: scrollerWidth, scrollerHeight: scrollerHeight, contentLeft: contentLeft, scrollTop: scrollTop, scrollLeft: scrollLeft});
																																																},
																																																A2(_elm_lang$core$Json_Decode$field, 'scrollLeft', _elm_lang$core$Json_Decode$float));
																																														},
																																														A2(_elm_lang$core$Json_Decode$field, 'scrollTop', _elm_lang$core$Json_Decode$float));
																																												},
																																												A2(_elm_lang$core$Json_Decode$field, 'contentLeft', _elm_lang$core$Json_Decode$float));
																																										},
																																										A2(_elm_lang$core$Json_Decode$field, 'scrollerHeight', _elm_lang$core$Json_Decode$float));
																																								},
																																								A2(_elm_lang$core$Json_Decode$field, 'scrollerWidth', _elm_lang$core$Json_Decode$float));
																																						},
																																						A2(_elm_lang$core$Json_Decode$field, 'scrollerLeft', _elm_lang$core$Json_Decode$float));
																																				},
																																				A2(_elm_lang$core$Json_Decode$field, 'scrollerTop', _elm_lang$core$Json_Decode$float));
																																		},
																																		A2(_elm_lang$core$Json_Decode$field, 'marginLeftOffset', _elm_lang$core$Json_Decode$float));
																																},
																																A2(_elm_lang$core$Json_Decode$field, 'marginTopOffset', _elm_lang$core$Json_Decode$float));
																														},
																														A2(_elm_lang$core$Json_Decode$field, 'lastVisibleRow', _elm_lang$core$Json_Decode$int));
																												},
																												A2(_elm_lang$core$Json_Decode$field, 'firstVisibleRow', _elm_lang$core$Json_Decode$int));
																										},
																										A2(_elm_lang$core$Json_Decode$field, 'gutterWidth', _elm_lang$core$Json_Decode$float));
																								},
																								A2(_elm_lang$core$Json_Decode$field, 'offsetHeight', _elm_lang$core$Json_Decode$float));
																						},
																						A2(_elm_lang$core$Json_Decode$field, 'offsetLeft', _elm_lang$core$Json_Decode$float));
																				},
																				A2(_elm_lang$core$Json_Decode$field, 'characterWidth', _elm_lang$core$Json_Decode$float));
																		},
																		A2(_elm_lang$core$Json_Decode$field, 'lineHeight', _elm_lang$core$Json_Decode$float));
																},
																A2(_elm_lang$core$Json_Decode$field, 'fontSize', _elm_lang$core$Json_Decode$int));
														},
														A2(
															_elm_lang$core$Json_Decode$field,
															'tooltips',
															_elm_lang$core$Json_Decode$list(
																A2(
																	_elm_lang$core$Json_Decode$andThen,
																	function (row) {
																		return A2(
																			_elm_lang$core$Json_Decode$andThen,
																			function (col) {
																				return A2(
																					_elm_lang$core$Json_Decode$andThen,
																					function (text) {
																						return _elm_lang$core$Json_Decode$succeed(
																							{row: row, col: col, text: text});
																					},
																					A2(_elm_lang$core$Json_Decode$field, 'text', _elm_lang$core$Json_Decode$string));
																			},
																			A2(_elm_lang$core$Json_Decode$field, 'col', _elm_lang$core$Json_Decode$int));
																	},
																	A2(_elm_lang$core$Json_Decode$field, 'row', _elm_lang$core$Json_Decode$int)))));
												},
												A2(
													_elm_lang$core$Json_Decode$field,
													'annotations',
													_elm_lang$core$Json_Decode$list(
														A2(
															_elm_lang$core$Json_Decode$andThen,
															function (row) {
																return A2(
																	_elm_lang$core$Json_Decode$andThen,
																	function (type_) {
																		return A2(
																			_elm_lang$core$Json_Decode$andThen,
																			function (text) {
																				return _elm_lang$core$Json_Decode$succeed(
																					{row: row, type_: type_, text: text});
																			},
																			A2(_elm_lang$core$Json_Decode$field, 'text', _elm_lang$core$Json_Decode$string));
																	},
																	A2(_elm_lang$core$Json_Decode$field, 'type_', _elm_lang$core$Json_Decode$string));
															},
															A2(_elm_lang$core$Json_Decode$field, 'row', _elm_lang$core$Json_Decode$int)))));
										},
										A2(
											_elm_lang$core$Json_Decode$field,
											'highlights',
											_elm_lang$core$Json_Decode$list(
												A2(
													_elm_lang$core$Json_Decode$andThen,
													function (range) {
														return A2(
															_elm_lang$core$Json_Decode$andThen,
															function (color) {
																return _elm_lang$core$Json_Decode$succeed(
																	{range: range, color: color});
															},
															A2(_elm_lang$core$Json_Decode$field, 'color', _elm_lang$core$Json_Decode$string));
													},
													A2(
														_elm_lang$core$Json_Decode$field,
														'range',
														A2(
															_elm_lang$core$Json_Decode$andThen,
															function (start) {
																return A2(
																	_elm_lang$core$Json_Decode$andThen,
																	function (end) {
																		return _elm_lang$core$Json_Decode$succeed(
																			{start: start, end: end});
																	},
																	A2(
																		_elm_lang$core$Json_Decode$field,
																		'end',
																		A2(
																			_elm_lang$core$Json_Decode$andThen,
																			function (row) {
																				return A2(
																					_elm_lang$core$Json_Decode$andThen,
																					function (column) {
																						return _elm_lang$core$Json_Decode$succeed(
																							{row: row, column: column});
																					},
																					A2(_elm_lang$core$Json_Decode$field, 'column', _elm_lang$core$Json_Decode$int));
																			},
																			A2(_elm_lang$core$Json_Decode$field, 'row', _elm_lang$core$Json_Decode$int))));
															},
															A2(
																_elm_lang$core$Json_Decode$field,
																'start',
																A2(
																	_elm_lang$core$Json_Decode$andThen,
																	function (row) {
																		return A2(
																			_elm_lang$core$Json_Decode$andThen,
																			function (column) {
																				return _elm_lang$core$Json_Decode$succeed(
																					{row: row, column: column});
																			},
																			A2(_elm_lang$core$Json_Decode$field, 'column', _elm_lang$core$Json_Decode$int));
																	},
																	A2(_elm_lang$core$Json_Decode$field, 'row', _elm_lang$core$Json_Decode$int)))))))));
								},
								A2(
									_elm_lang$core$Json_Decode$field,
									'selections',
									_elm_lang$core$Json_Decode$list(
										A2(
											_elm_lang$core$Json_Decode$andThen,
											function (start) {
												return A2(
													_elm_lang$core$Json_Decode$andThen,
													function (end) {
														return _elm_lang$core$Json_Decode$succeed(
															{start: start, end: end});
													},
													A2(
														_elm_lang$core$Json_Decode$field,
														'end',
														A2(
															_elm_lang$core$Json_Decode$andThen,
															function (row) {
																return A2(
																	_elm_lang$core$Json_Decode$andThen,
																	function (column) {
																		return _elm_lang$core$Json_Decode$succeed(
																			{row: row, column: column});
																	},
																	A2(_elm_lang$core$Json_Decode$field, 'column', _elm_lang$core$Json_Decode$int));
															},
															A2(_elm_lang$core$Json_Decode$field, 'row', _elm_lang$core$Json_Decode$int))));
											},
											A2(
												_elm_lang$core$Json_Decode$field,
												'start',
												A2(
													_elm_lang$core$Json_Decode$andThen,
													function (row) {
														return A2(
															_elm_lang$core$Json_Decode$andThen,
															function (column) {
																return _elm_lang$core$Json_Decode$succeed(
																	{row: row, column: column});
															},
															A2(_elm_lang$core$Json_Decode$field, 'column', _elm_lang$core$Json_Decode$int));
													},
													A2(_elm_lang$core$Json_Decode$field, 'row', _elm_lang$core$Json_Decode$int)))))));
						},
						A2(
							_elm_lang$core$Json_Decode$field,
							'cursorPos',
							A2(
								_elm_lang$core$Json_Decode$andThen,
								function (row) {
									return A2(
										_elm_lang$core$Json_Decode$andThen,
										function (column) {
											return _elm_lang$core$Json_Decode$succeed(
												{row: row, column: column});
										},
										A2(_elm_lang$core$Json_Decode$field, 'column', _elm_lang$core$Json_Decode$int));
								},
								A2(_elm_lang$core$Json_Decode$field, 'row', _elm_lang$core$Json_Decode$int))))));
		},
		A2(_elm_lang$core$Json_Decode$field, 'code', _elm_lang$core$Json_Decode$string)));
var _user$project$AceCodeBox$userHasTyped = _elm_lang$core$Native_Platform.incomingPort(
	'userHasTyped',
	_elm_lang$core$Json_Decode$null(
		{ctor: '_Tuple0'}));
var _user$project$AceCodeBox$AceCodeBoxCmd = F2(
	function (a, b) {
		return {message: a, info: b};
	});

var _user$project$AnimationLoop$requestFrame = _elm_lang$core$Native_Platform.outgoingPort(
	'requestFrame',
	function (v) {
		return null;
	});
var _user$project$AnimationLoop$receiveFrame = _elm_lang$core$Native_Platform.incomingPort('receiveFrame', _elm_lang$core$Json_Decode$float);

var _user$project$Blobs$fromBlobExp = function (be) {
	var _p0 = be;
	if (_p0.ctor === 'OtherBlob') {
		return _p0._0;
	} else {
		return _p0._0;
	}
};
var _user$project$Blobs$fromMainExp = function (me) {
	var _p1 = me;
	switch (_p1.ctor) {
		case 'SvgConcat':
			return _p1._1(_p1._0);
		case 'Blobs':
			return _p1._1(_p1._0);
		default:
			return _p1._0;
	}
};
var _user$project$Blobs$fuseExp = function (_p2) {
	var _p3 = _p2;
	var recurse = function (defs) {
		var _p4 = defs;
		if (_p4.ctor === '[]') {
			return _user$project$Blobs$fromMainExp(_p3._1);
		} else {
			return _user$project$Lang$withDummyExpInfo(
				A7(
					_user$project$Lang$ELet,
					_p4._0._0,
					_user$project$Lang$Def,
					false,
					_p4._0._1,
					_p4._0._2,
					recurse(_p4._1),
					_p4._0._3));
		}
	};
	return recurse(_p3._0);
};
var _user$project$Blobs$OtherExp = function (a) {
	return {ctor: 'OtherExp', _0: a};
};
var _user$project$Blobs$Blobs = F2(
	function (a, b) {
		return {ctor: 'Blobs', _0: a, _1: b};
	});
var _user$project$Blobs$SvgConcat = F2(
	function (a, b) {
		return {ctor: 'SvgConcat', _0: a, _1: b};
	});
var _user$project$Blobs$maybeSvgConcat = function (main) {
	var _p5 = main.val.e__;
	if (((_p5.ctor === 'EApp') && (_p5._2.ctor === '::')) && (_p5._2._1.ctor === '[]')) {
		var _p12 = _p5._0;
		var _p11 = _p5._2._0;
		var _p10 = _p5._1;
		var _p6 = {ctor: '_Tuple2', _0: _p10.val.e__, _1: _p11.val.e__};
		if ((((((_p6.ctor === '_Tuple2') && (_p6._0.ctor === 'EVar')) && (_p6._0._1 === 'svg')) && (_p6._1.ctor === 'EApp')) && (_p6._1._2.ctor === '::')) && (_p6._1._2._1.ctor === '[]')) {
			var _p9 = _p6._1._1;
			var _p8 = _p6._1._2._0;
			var _p7 = {ctor: '_Tuple2', _0: _p9.val.e__, _1: _p8.val.e__};
			if (((((_p7.ctor === '_Tuple2') && (_p7._0.ctor === 'EVar')) && (_p7._0._1 === 'concat')) && (_p7._1.ctor === 'EList')) && (_p7._1._3.ctor === 'Nothing')) {
				var updateExpressionList = function (newList) {
					var e2New = A2(
						_user$project$Lang$replaceE__,
						_p8,
						A5(_user$project$Lang$EList, _p7._1._0, newList, _p7._1._2, _elm_lang$core$Maybe$Nothing, _p7._1._4));
					var eAppConcatNew = A2(
						_user$project$Lang$replaceE__,
						_p11,
						A4(
							_user$project$Lang$EApp,
							_p6._1._0,
							_p9,
							{
								ctor: '::',
								_0: e2New,
								_1: {ctor: '[]'}
							},
							_p6._1._3));
					var mainNew = A2(
						_user$project$Lang$replaceE__,
						main,
						A4(
							_user$project$Lang$EApp,
							_p12,
							_p10,
							{
								ctor: '::',
								_0: eAppConcatNew,
								_1: {ctor: '[]'}
							},
							_p5._3));
					return _elm_lang$core$Native_Utils.eq(_p12.val, '') ? A2(_user$project$Lang$addPrecedingWhitespace, '\n\n', mainNew) : (_elm_lang$core$Native_Utils.eq(_p12.val, '\n') ? A2(_user$project$Lang$addPrecedingWhitespace, '\n', mainNew) : mainNew);
				};
				return _elm_lang$core$Maybe$Just(
					A2(_user$project$Blobs$SvgConcat, _p7._1._1, updateExpressionList));
			} else {
				return _elm_lang$core$Maybe$Nothing;
			}
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$Blobs$NiceBlob = F2(
	function (a, b) {
		return {ctor: 'NiceBlob', _0: a, _1: b};
	});
var _user$project$Blobs$OtherBlob = function (a) {
	return {ctor: 'OtherBlob', _0: a};
};
var _user$project$Blobs$WithAnchorBlob = function (a) {
	return {ctor: 'WithAnchorBlob', _0: a};
};
var _user$project$Blobs$withAnchorBlob = F2(
	function (e, tuple) {
		return A2(
			_user$project$Blobs$NiceBlob,
			e,
			_user$project$Blobs$WithAnchorBlob(tuple));
	});
var _user$project$Blobs$WithBoundsBlob = function (a) {
	return {ctor: 'WithBoundsBlob', _0: a};
};
var _user$project$Blobs$withBoundsBlob = F2(
	function (e, tuple) {
		return A2(
			_user$project$Blobs$NiceBlob,
			e,
			_user$project$Blobs$WithBoundsBlob(tuple));
	});
var _user$project$Blobs$CallBlob = function (a) {
	return {ctor: 'CallBlob', _0: a};
};
var _user$project$Blobs$callBlob = F2(
	function (e, tuple) {
		return A2(
			_user$project$Blobs$NiceBlob,
			e,
			_user$project$Blobs$CallBlob(tuple));
	});
var _user$project$Blobs$VarBlob = function (a) {
	return {ctor: 'VarBlob', _0: a};
};
var _user$project$Blobs$varBlob = F2(
	function (e, x) {
		return A2(
			_user$project$Blobs$NiceBlob,
			e,
			_user$project$Blobs$VarBlob(x));
	});
var _user$project$Blobs$toBlobExp = function (e) {
	var _p13 = e.val.e__;
	switch (_p13.ctor) {
		case 'EVar':
			return A2(_user$project$Blobs$varBlob, e, _p13._1);
		case 'EApp':
			if (((_p13._2.ctor === '::') && (_p13._2._1.ctor === '::')) && (_p13._2._1._1.ctor === '[]')) {
				var _p23 = _p13._2._0;
				var _p14 = _p13._1.val.e__;
				if (_p14.ctor === 'EVar') {
					var _p22 = _p14._1;
					var _p15 = _p13._2._1._0.val.e__;
					switch (_p15.ctor) {
						case 'EVar':
							var _p17 = _p15._1;
							var _p16 = _p22;
							switch (_p16) {
								case 'withBounds':
									return A2(
										_user$project$Blobs$NiceBlob,
										e,
										_user$project$Blobs$WithBoundsBlob(
											{
												ctor: '_Tuple3',
												_0: _p23,
												_1: _p17,
												_2: {ctor: '[]'}
											}));
								case 'withAnchor':
									return A2(
										_user$project$Blobs$NiceBlob,
										e,
										_user$project$Blobs$WithAnchorBlob(
											{
												ctor: '_Tuple3',
												_0: _p23,
												_1: _p17,
												_2: {ctor: '[]'}
											}));
								default:
									return _user$project$Blobs$OtherBlob(e);
							}
						case 'EApp':
							var _p21 = _p15._2;
							var _p18 = _p15._1.val.e__;
							if (_p18.ctor === 'EVar') {
								var _p20 = _p18._1;
								var _p19 = _p22;
								switch (_p19) {
									case 'withBounds':
										return A2(
											_user$project$Blobs$NiceBlob,
											e,
											_user$project$Blobs$WithBoundsBlob(
												{ctor: '_Tuple3', _0: _p23, _1: _p20, _2: _p21}));
									case 'withAnchor':
										return A2(
											_user$project$Blobs$NiceBlob,
											e,
											_user$project$Blobs$WithAnchorBlob(
												{ctor: '_Tuple3', _0: _p23, _1: _p20, _2: _p21}));
									default:
										return _user$project$Blobs$OtherBlob(e);
								}
							} else {
								return _user$project$Blobs$OtherBlob(e);
							}
						default:
							return _user$project$Blobs$OtherBlob(e);
					}
				} else {
					return _user$project$Blobs$OtherBlob(e);
				}
			} else {
				var _p24 = _p13._1.val.e__;
				if (_p24.ctor === 'EVar') {
					return A2(
						_user$project$Blobs$NiceBlob,
						e,
						_user$project$Blobs$CallBlob(
							{ctor: '_Tuple2', _0: _p24._1, _1: _p13._2}));
				} else {
					return _user$project$Blobs$OtherBlob(e);
				}
			}
		default:
			return _user$project$Blobs$OtherBlob(e);
	}
};
var _user$project$Blobs$maybeBlobs = function (main) {
	var _p25 = main.val.e__;
	if (((_p25.ctor === 'EApp') && (_p25._2.ctor === '::')) && (_p25._2._1.ctor === '[]')) {
		var _p29 = _p25._0;
		var _p28 = _p25._1;
		var _p27 = _p25._2._0;
		var _p26 = {ctor: '_Tuple2', _0: _p28.val.e__, _1: _p27.val.e__};
		if (((((_p26.ctor === '_Tuple2') && (_p26._0.ctor === 'EVar')) && (_p26._0._1 === 'blobs')) && (_p26._1.ctor === 'EList')) && (_p26._1._3.ctor === 'Nothing')) {
			var rebuildExp = function (newBlobExpList) {
				var newExpList = A2(_elm_lang$core$List$map, _user$project$Blobs$fromBlobExp, newBlobExpList);
				var eArgsNew = A2(
					_user$project$Lang$replaceE__,
					_p27,
					A5(_user$project$Lang$EList, _p26._1._0, newExpList, _p26._1._2, _elm_lang$core$Maybe$Nothing, _p26._1._4));
				var mainNew = A2(
					_user$project$Lang$replaceE__,
					main,
					A4(
						_user$project$Lang$EApp,
						_p29,
						_p28,
						{
							ctor: '::',
							_0: eArgsNew,
							_1: {ctor: '[]'}
						},
						_p25._3));
				return _elm_lang$core$Native_Utils.eq(_p29.val, '') ? A2(_user$project$Lang$addPrecedingWhitespace, '\n\n', mainNew) : (_elm_lang$core$Native_Utils.eq(_p29.val, '\n') ? A2(_user$project$Lang$addPrecedingWhitespace, '\n', mainNew) : mainNew);
			};
			var blobs = A2(_elm_lang$core$List$map, _user$project$Blobs$toBlobExp, _p26._1._1);
			return _elm_lang$core$Maybe$Just(
				A2(_user$project$Blobs$Blobs, blobs, rebuildExp));
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$Blobs$toMainExp = function (e) {
	return A2(
		_user$project$Utils$elseMaybe,
		A2(
			_user$project$Utils$plusMaybe,
			_user$project$Blobs$maybeSvgConcat(e),
			_user$project$Blobs$maybeBlobs(e)),
		_user$project$Blobs$OtherExp(e));
};
var _user$project$Blobs$splitExp = function (e) {
	var _p30 = e.val.e__;
	if (((_p30.ctor === 'ELet') && (_p30._1.ctor === 'Def')) && (_p30._2 === false)) {
		var _p31 = _user$project$Blobs$splitExp(_p30._5);
		var defs = _p31._0;
		var main = _p31._1;
		return {
			ctor: '_Tuple2',
			_0: {
				ctor: '::',
				_0: {ctor: '_Tuple4', _0: _p30._0, _1: _p30._3, _2: _p30._4, _3: _p30._6},
				_1: defs
			},
			_1: main
		};
	} else {
		return {
			ctor: '_Tuple2',
			_0: {ctor: '[]'},
			_1: _user$project$Blobs$toMainExp(e)
		};
	}
};
var _user$project$Blobs$isSimpleProgram = function (e) {
	var _p32 = _user$project$Blobs$splitExp(e);
	var defs = _p32._0;
	var mainExp = _p32._1;
	var _p33 = mainExp;
	switch (_p33.ctor) {
		case 'SvgConcat':
			return _elm_lang$core$Maybe$Nothing;
		case 'OtherExp':
			return _elm_lang$core$Maybe$Nothing;
		default:
			return _elm_lang$core$Maybe$Just(
				{ctor: '_Tuple3', _0: defs, _1: _p33._0, _2: _p33._1});
	}
};

var _user$project$HtmlUtils$styleListToString = function () {
	var stylePairToString = function (_p0) {
		var _p1 = _p0;
		return A2(
			_elm_lang$core$Basics_ops['++'],
			_p1._0,
			A2(
				_elm_lang$core$Basics_ops['++'],
				': ',
				A2(_elm_lang$core$Basics_ops['++'], _p1._1, '; ')));
	};
	return function (_p2) {
		return _elm_lang$core$String$concat(
			A2(_elm_lang$core$List$map, stylePairToString, _p2));
	};
}();
var _user$project$HtmlUtils$handleEventAndStop = F2(
	function (eventName, eventHandler) {
		return A3(
			_elm_lang$html$Html_Events$onWithOptions,
			eventName,
			_elm_lang$core$Native_Utils.update(
				_elm_lang$html$Html_Events$defaultOptions,
				{stopPropagation: true}),
			A2(
				_elm_lang$core$Json_Decode$map,
				_elm_lang$core$Basics$always(eventHandler),
				_elm_lang$core$Json_Decode$value));
	});

window.userStudyEventNumber = 0

var _user$project$Native_UserStudyLog = {

    log : function(eventName) { return function(info) {
      var now = new Date()
      var eventNumber = (window.userStudyEventNumber += 1);

      var logLine = eventNumber + "\t" + now.toJSON() + "\t" + (now - 0) + "\t" + eventName + "\t" + info;

      console.log(logLine);

      function logRemotely() {
        var request = new XMLHttpRequest();

        // Retry request on failure after 5 second wait.
        // (We're trying not to drop events.)
        request.onreadystatechange = function () {
          if (request.readyState == 4 && request.status != 200) {
            setTimeout(logRemotely, 5 * 1000);
          }
        };

        request.open("POST", "/log_event", true);
        request.send(logLine);
      }
      logRemotely();

    }; },

};

var _user$project$UserStudyLog$modelSummaryJsonInner = function (model) {
	return A2(
		_elm_lang$core$Basics_ops['++'],
		'\"deuceSelectionsCount\" : ',
		A2(
			_elm_lang$core$Basics_ops['++'],
			_elm_lang$core$Basics$toString(
				_elm_lang$core$List$length(model.deuceState.selectedWidgets)),
			A2(
				_elm_lang$core$Basics_ops['++'],
				', \"codeAnnotationsCount\" : ',
				_elm_lang$core$Basics$toString(
					_elm_lang$core$List$length(model.codeBoxInfo.annotations)))));
};
var _user$project$UserStudyLog$msgInfo = F2(
	function (_p0, model) {
		var _p1 = _p0;
		var _p3 = _p1._0;
		var _p2 = _p3;
		switch (_p2) {
			case 'Ace Update':
				return _elm_lang$core$Maybe$Nothing;
			case 'Time Tick':
				return _elm_lang$core$Maybe$Nothing;
			case 'New: User Study Next':
				return _elm_lang$core$Maybe$Nothing;
			default:
				return A2(_elm_lang$core$String$startsWith, 'MousePosition', _p3) ? _elm_lang$core$Maybe$Nothing : _elm_lang$core$Maybe$Just(
					_user$project$UserStudyLog$modelSummaryJsonInner(model));
		}
	});
var _user$project$UserStudyLog$log = F2(
	function (eventName, info) {
		return {ctor: '_Tuple0'};
	});
var _user$project$UserStudyLog$logModelUpdate = F3(
	function (updateFunc, msg, model) {
		var _p4 = msg;
		var msgName = _p4._0;
		var _p5 = function () {
			var _p6 = A2(_user$project$UserStudyLog$msgInfo, msg, model);
			if (_p6.ctor === 'Just') {
				return A2(
					_user$project$UserStudyLog$log,
					msgName,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'{ ',
						A2(_elm_lang$core$Basics_ops['++'], _p6._0, ' }')));
			} else {
				return {ctor: '_Tuple0'};
			}
		}();
		var _p7 = A2(updateFunc, msg, model);
		var newModel = _p7._0;
		var cmd = _p7._1;
		var _p8 = function () {
			var nonEmptySelections = function (model) {
				return A2(
					_elm_lang$core$List$filter,
					function (range) {
						return !_elm_lang$core$Native_Utils.eq(range.start, range.end);
					},
					model.codeBoxInfo.selections);
			};
			var rangeToJson = function (_p9) {
				var _p10 = _p9;
				var posToJson = function (_p11) {
					var _p12 = _p11;
					return A2(
						_elm_lang$core$Basics_ops['++'],
						'{ ',
						A2(
							_elm_lang$core$Basics_ops['++'],
							'\"row\" : ',
							A2(
								_elm_lang$core$Basics_ops['++'],
								_elm_lang$core$Basics$toString(_p12.row),
								A2(
									_elm_lang$core$Basics_ops['++'],
									', \"column\" : ',
									A2(
										_elm_lang$core$Basics_ops['++'],
										_elm_lang$core$Basics$toString(_p12.column),
										' }')))));
				};
				return A2(
					_elm_lang$core$Basics_ops['++'],
					'{ ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						'\"start\" : ',
						A2(
							_elm_lang$core$Basics_ops['++'],
							posToJson(_p10.start),
							A2(
								_elm_lang$core$Basics_ops['++'],
								', \"end\" : ',
								A2(
									_elm_lang$core$Basics_ops['++'],
									posToJson(_p10.end),
									' }')))));
			};
			var rangeListToJson = function (ranges) {
				return A2(
					_elm_lang$core$Basics_ops['++'],
					'[ ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						A2(
							_elm_lang$core$String$join,
							', ',
							A2(_elm_lang$core$List$map, rangeToJson, ranges)),
						' ]'));
			};
			var somethingSelected = function (model) {
				return !_elm_lang$core$Native_Utils.eq(
					nonEmptySelections(model),
					{ctor: '[]'});
			};
			return ((!_elm_lang$core$Native_Utils.eq(model.codeBoxInfo.selections, newModel.codeBoxInfo.selections)) && (somethingSelected(model) || somethingSelected(newModel))) ? A2(
				_user$project$UserStudyLog$log,
				'Text Selection Changed',
				rangeListToJson(
					nonEmptySelections(newModel))) : (((!_elm_lang$core$Native_Utils.eq(model.codeBoxInfo.cursorPos, newModel.codeBoxInfo.cursorPos)) && _elm_lang$core$Native_Utils.eq(model.code, newModel.code)) ? A2(_user$project$UserStudyLog$log, 'Text Cursor Moved', '') : {ctor: '_Tuple0'});
		}();
		var _p13 = (!_elm_lang$core$Native_Utils.eq(model.code, newModel.code)) ? A2(
			_user$project$UserStudyLog$log,
			'New Code',
			_elm_lang$core$Basics$toString(newModel.code)) : {ctor: '_Tuple0'};
		var _p14 = function () {
			var deuceToolJsons = function (model) {
				return A2(
					_elm_lang$core$List$map,
					function (_p15) {
						var _p16 = _p15;
						var _p18 = _p16._0;
						var impossible = A2(_elm_lang$core$List$any, _user$project$InterfaceModel$predicateImpossible, _p18.reqs);
						return A2(
							_elm_lang$core$Basics_ops['++'],
							'{ ',
							A2(
								_elm_lang$core$Basics_ops['++'],
								'\"name\" : ',
								A2(
									_elm_lang$core$Basics_ops['++'],
									_elm_lang$core$Basics$toString(_p18.name),
									A2(
										_elm_lang$core$Basics_ops['++'],
										', \"results\" : [ ',
										A2(
											_elm_lang$core$Basics_ops['++'],
											A2(
												_elm_lang$core$String$join,
												', ',
												A2(
													_elm_lang$core$List$map,
													function (_p17) {
														return _elm_lang$core$Basics$toString(
															_user$project$InterfaceModel$resultDescription(_p17));
													},
													_p16._1)),
											A2(
												_elm_lang$core$Basics_ops['++'],
												' ] ',
												A2(
													_elm_lang$core$Basics_ops['++'],
													', \"disabled\" : ',
													A2(
														_elm_lang$core$Basics_ops['++'],
														_elm_lang$core$String$toLower(
															_elm_lang$core$Basics$toString(_p16._2)),
														A2(
															_elm_lang$core$Basics_ops['++'],
															', \"impossible\" : ',
															A2(
																_elm_lang$core$Basics_ops['++'],
																_elm_lang$core$String$toLower(
																	_elm_lang$core$Basics$toString(impossible)),
																' }'))))))))));
					},
					_elm_lang$core$List$concat(model.deuceToolsAndResults));
			};
			return (!_elm_lang$core$Native_Utils.eq(
				deuceToolJsons(model),
				deuceToolJsons(newModel))) ? A2(
				_user$project$UserStudyLog$log,
				'New Deuce Tools and Results List',
				A2(
					_elm_lang$core$Basics_ops['++'],
					'[ ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						A2(
							_elm_lang$core$String$join,
							', ',
							deuceToolJsons(newModel)),
						' ]'))) : {ctor: '_Tuple0'};
		}();
		var _p19 = function () {
			var _p20 = {ctor: '_Tuple2', _0: msgName, _1: newModel.errorBox};
			if ((_p20.ctor === '_Tuple2') && (_p20._0 === 'Run')) {
				if (_p20._1.ctor === 'Nothing') {
					return A2(_user$project$UserStudyLog$log, 'Run Success', '');
				} else {
					return A2(
						_user$project$UserStudyLog$log,
						'Run Error',
						_elm_lang$core$Basics$toString(_p20._1._0));
				}
			} else {
				return {ctor: '_Tuple0'};
			}
		}();
		return {ctor: '_Tuple2', _0: newModel, _1: cmd};
	});

var _user$project$UserStudy$isTaskPhase = function (phase) {
	var _p0 = phase;
	switch (_p0.ctor) {
		case 'Start':
			return false;
		case 'Tutorial':
			return false;
		case 'Transition1':
			return false;
		case 'Task':
			return true;
		case 'Transition2':
			return true;
		default:
			return false;
	}
};
var _user$project$UserStudy$isTutorialPhase = function (phase) {
	var _p1 = phase;
	switch (_p1.ctor) {
		case 'Start':
			return false;
		case 'Tutorial':
			return true;
		case 'Transition1':
			return true;
		case 'Task':
			return false;
		case 'Transition2':
			return false;
		default:
			return false;
	}
};
var _user$project$UserStudy$stepTimeoutDuration = function (_p2) {
	var _p3 = _p2;
	var _p4 = _p3._0;
	if (_p4.ctor === 'Task') {
		if (_p4._0.ctor === 'HeadToHead') {
			return 6 * _elm_lang$core$Time$minute;
		} else {
			return 12 * _elm_lang$core$Time$minute;
		}
	} else {
		return _user$project$Utils$infinity;
	}
};
var _user$project$UserStudy$fullTaskTemplates = {
	ctor: '::',
	_0: 'Four Squares',
	_1: {
		ctor: '::',
		_0: 'Lambda Icon',
		_1: {ctor: '[]'}
	}
};
var _user$project$UserStudy$headToHeadTaskTemplates = {
	ctor: '::',
	_0: 'One Rectangle',
	_1: {
		ctor: '::',
		_0: 'Two Circles',
		_1: {
			ctor: '::',
			_0: 'Three Rectangles',
			_1: {
				ctor: '::',
				_0: 'Target Icon',
				_1: {ctor: '[]'}
			}
		}
	}
};
var _user$project$UserStudy$structuredEditingStartStep = 10;
var _user$project$UserStudy$numTutorialSteps = 23;
var _user$project$UserStudy$boxSelectHelp = {
	ctor: '::',
	_0: 'Hold down Shift, and hover and click ALL relevant expressions and target positions.',
	_1: {
		ctor: '::',
		_0: 'Select a tool from pop-up menu.',
		_1: {
			ctor: '::',
			_0: 'Follow any instructions and finish.',
			_1: {ctor: '[]'}
		}
	}
};
var _user$project$UserStudy$textSelectHelp = {
	ctor: '::',
	_0: 'Text select a SINGLE expression in the code.',
	_1: {
		ctor: '::',
		_0: 'Select a tool from either the Code Tools menu or the right-click pop-up menu.',
		_1: {
			ctor: '::',
			_0: 'Follow any instructions and finish.',
			_1: {ctor: '[]'}
		}
	}
};
var _user$project$UserStudy$syntaxHelp = '\nTODO\n';
var _user$project$UserStudy$re_12 = _elm_lang$core$Regex$regex('(.*<ul class=\"_12\">)(.*)(<li class=\"_1\">.*</li>)(.*)(<li class=\"_2\">.*</li>)(.*)(</ul>.*)');
var _user$project$UserStudy$re_123 = _elm_lang$core$Regex$regex('(.*<ul class=\"_123\">)(.*)(<li class=\"_1\">.*</li>)(.*)(<li class=\"_2\">.*</li>)(.*)(<li class=\"_3\">.*</li>)(.*)(</ul>.*)');
var _user$project$UserStudy$allFeaturesProse = '<p>\nUse NORMAL TEXT EDITS and/or TEXT-SELECT MODE\nand/or BOX-SELECT MODE to perform the edits below.\nWhen you are done, press Next Step.\n</p>';
var _user$project$UserStudy$codeToolsOnlyProse = '<p>\nUse TEXT-SELECT MODE and/or BOX-SELECT MODE to\nperform the edits below. You can mix both modes,\nlike in the tutorial. Text edits are disabled.\nWhen you are done, press Next Step.\n</p>';
var _user$project$UserStudy$boxSelectOnlyProse = '<p>\nUse only BOX-SELECT MODE to perform the edits below.\nWhen you are done, press Next Step.\n</p>';
var _user$project$UserStudy$textSelectOnlyProse = '<p>\nUse only TEXT-SELECT MODE to perform the edits below.\nWhen you are done, press Next Step.\n</p>';
var _user$project$UserStudy$readOnlyProse = '<p></p><p>\nRead and understand the code.\nAll editing features are disabled for now.\nWhen you are ready, press Next Step.\n</p>';
var _user$project$UserStudy$replacePlaceholderInstructionsWith = F2(
	function (prose, s) {
		return A2(
			_elm_lang$core$Maybe$map,
			A3(
				_elm_lang$core$Regex$replace,
				_elm_lang$core$Regex$All,
				_elm_lang$core$Regex$regex('PLACEHOLDER INSTRUCTIONS'),
				_elm_lang$core$Basics$always(s)),
			prose);
	});
var _user$project$UserStudy$chopInstructions = function (templateCode) {
	return A2(
		_elm_lang$core$String$join,
		'\n',
		A2(
			_elm_lang$core$List$filter,
			function (_p5) {
				return !A2(_elm_lang$core$String$startsWith, ';', _p5);
			},
			_elm_lang$core$String$lines(templateCode)));
};
var _user$project$UserStudy$postProcessCode = F2(
	function (state, templateCode) {
		var _p6 = state;
		if ((((_p6.ctor === '_Tuple2') && (_p6._0.ctor === 'Task')) && (_p6._1.ctor === '_Tuple2')) && (_p6._1._1.ctor === 'ReadOnly')) {
			return _user$project$UserStudy$chopInstructions(templateCode);
		} else {
			return templateCode;
		}
	});
var _user$project$UserStudy$getEditorMode = function (state) {
	var _p7 = state;
	return _p7._1._1;
};
var _user$project$UserStudy$enableFeaturesForEditorMode = F2(
	function (newState, m) {
		var _p8 = _user$project$UserStudy$getEditorMode(newState);
		switch (_p8.ctor) {
			case 'ReadOnly':
				return _elm_lang$core$Native_Utils.update(
					m,
					{
						enableTextEdits: _user$project$Updatable$create(false),
						enableDeuceBoxSelection: false,
						enableDeuceTextSelection: false,
						codeToolsMenuMode: _user$project$InterfaceModel$CTDisabled
					});
			case 'TextEditOnly':
				return _elm_lang$core$Native_Utils.update(
					m,
					{
						enableTextEdits: _user$project$Updatable$create(true),
						enableDeuceBoxSelection: false,
						enableDeuceTextSelection: false,
						codeToolsMenuMode: _user$project$InterfaceModel$CTDisabled
					});
			case 'BoxSelectOnly':
				return _elm_lang$core$Native_Utils.update(
					m,
					{
						enableTextEdits: _user$project$Updatable$create(false),
						enableDeuceBoxSelection: true,
						enableDeuceTextSelection: false,
						codeToolsMenuMode: _user$project$InterfaceModel$CTDisabled
					});
			case 'TextSelectOnly':
				return _elm_lang$core$Native_Utils.update(
					m,
					{
						enableTextEdits: _user$project$Updatable$create(false),
						enableDeuceBoxSelection: false,
						enableDeuceTextSelection: true,
						codeToolsMenuMode: _user$project$InterfaceModel$CTAll
					});
			case 'CodeToolsOnly':
				return _elm_lang$core$Native_Utils.update(
					m,
					{
						enableTextEdits: _user$project$Updatable$create(false),
						enableDeuceBoxSelection: true,
						enableDeuceTextSelection: true,
						codeToolsMenuMode: _user$project$InterfaceModel$CTAll
					});
			default:
				return _elm_lang$core$Native_Utils.update(
					m,
					{
						enableTextEdits: _user$project$Updatable$create(true),
						enableDeuceBoxSelection: true,
						enableDeuceTextSelection: true,
						codeToolsMenuMode: _user$project$InterfaceModel$CTAll
					});
		}
	});
var _user$project$UserStudy$getTemplate = function (state) {
	var _p9 = state;
	return _p9._1._0;
};
var _user$project$UserStudy$getPhase = function (state) {
	var _p10 = state;
	return _p10._0;
};
var _user$project$UserStudy$getRandom = function (g) {
	return _elm_lang$core$Tuple$first(
		A2(
			_elm_lang$core$Random$step,
			g,
			_elm_lang$core$Random$initialSeed(
				A2(
					_user$project$ImpureGoodies$randomInt,
					0,
					Math.pow(2, 32)))));
};
var _user$project$UserStudy$shuffle_123 = F2(
	function (step, maybeStr) {
		var _p11 = maybeStr;
		if (_p11.ctor === 'Nothing') {
			return _elm_lang$core$Maybe$Nothing;
		} else {
			var _p12 = A3(
				_elm_lang$core$Regex$find,
				_elm_lang$core$Regex$AtMost(1),
				_user$project$UserStudy$re_123,
				_p11._0);
			if ((_p12.ctor === '::') && (_p12._1.ctor === '[]')) {
				var _p16 = _p12._0;
				var li3 = A2(_user$project$Utils$geti, 7, _p16.submatches);
				var li2 = A2(_user$project$Utils$geti, 5, _p16.submatches);
				var li1 = A2(_user$project$Utils$geti, 3, _p16.submatches);
				var _p13 = function () {
					var i = _user$project$UserStudy$getRandom(
						A2(_elm_lang$core$Random$int, 1, 4));
					var _p14 = A2(
						_user$project$UserStudyLog$log,
						'Shuffle Tutorial _123 List',
						_elm_lang$core$Basics$toString(
							{ctor: '_Tuple2', _0: step, _1: i}));
					var _p15 = i;
					switch (_p15) {
						case 1:
							return {ctor: '_Tuple3', _0: li1, _1: li2, _2: li3};
						case 2:
							return {ctor: '_Tuple3', _0: li2, _1: li1, _2: li3};
						case 3:
							return {ctor: '_Tuple3', _0: li3, _1: li1, _2: li2};
						default:
							return {ctor: '_Tuple3', _0: li3, _1: li2, _2: li1};
					}
				}();
				var first = _p13._0;
				var second = _p13._1;
				var third = _p13._2;
				return _elm_lang$core$Maybe$Just(
					_elm_lang$core$String$concat(
						_user$project$Utils$filterJusts(
							A3(
								_user$project$Utils$replacei,
								7,
								third,
								A3(
									_user$project$Utils$replacei,
									5,
									second,
									A3(_user$project$Utils$replacei, 3, first, _p16.submatches))))));
			} else {
				var _p17 = A2(
					_user$project$UserStudyLog$log,
					'Shuffle Tutorial _123 List',
					_elm_lang$core$Basics$toString(
						{ctor: '_Tuple2', _0: step, _1: 'Couldn\'t shuffle...'}));
				return maybeStr;
			}
		}
	});
var _user$project$UserStudy$shuffle_12 = F2(
	function (step, maybeStr) {
		var _p18 = maybeStr;
		if (_p18.ctor === 'Nothing') {
			return _elm_lang$core$Maybe$Nothing;
		} else {
			var _p19 = A3(
				_elm_lang$core$Regex$find,
				_elm_lang$core$Regex$AtMost(1),
				_user$project$UserStudy$re_12,
				_p18._0);
			if ((_p19.ctor === '::') && (_p19._1.ctor === '[]')) {
				var _p23 = _p19._0;
				var li2 = A2(_user$project$Utils$geti, 5, _p23.submatches);
				var li1 = A2(_user$project$Utils$geti, 3, _p23.submatches);
				var _p20 = function () {
					var i = _user$project$UserStudy$getRandom(
						A2(_elm_lang$core$Random$int, 1, 2));
					var _p21 = A2(
						_user$project$UserStudyLog$log,
						'Shuffle Tutorial _12 List',
						_elm_lang$core$Basics$toString(
							{ctor: '_Tuple2', _0: step, _1: i}));
					var _p22 = i;
					if (_p22 === 1) {
						return {ctor: '_Tuple2', _0: li1, _1: li2};
					} else {
						return {ctor: '_Tuple2', _0: li2, _1: li1};
					}
				}();
				var first = _p20._0;
				var second = _p20._1;
				return _elm_lang$core$Maybe$Just(
					_elm_lang$core$String$concat(
						_user$project$Utils$filterJusts(
							A3(
								_user$project$Utils$replacei,
								5,
								second,
								A3(_user$project$Utils$replacei, 3, first, _p23.submatches)))));
			} else {
				var _p24 = A2(
					_user$project$UserStudyLog$log,
					'Shuffle Tutorial _12 List',
					_elm_lang$core$Basics$toString(
						{ctor: '_Tuple2', _0: step, _1: 'Couldn\'t shuffle...'}));
				return maybeStr;
			}
		}
	});
var _user$project$UserStudy$postProcessProse = F2(
	function (newState, m) {
		var updateModel = function (maybeString) {
			return _elm_lang$core$Native_Utils.update(
				m,
				{
					prose: _user$project$Updatable$create(maybeString)
				});
		};
		var prose = _user$project$Updatable$extract(m.prose);
		var _p25 = newState;
		_v15_5:
		do {
			if ((_p25.ctor === '_Tuple2') && (_p25._1.ctor === '_Tuple2')) {
				switch (_p25._0.ctor) {
					case 'Tutorial':
						var _p27 = _p25._1._0;
						var _p26 = _p27;
						switch (_p26) {
							case 'Step 11':
								return updateModel(
									A2(_user$project$UserStudy$shuffle_123, _p27, prose));
							case 'Step 12':
								return updateModel(
									A2(_user$project$UserStudy$shuffle_12, _p27, prose));
							case 'Step 13':
								return m;
							case 'Step 14':
								return updateModel(
									A2(_user$project$UserStudy$shuffle_12, _p27, prose));
							case 'Step 15':
								return updateModel(
									A2(_user$project$UserStudy$shuffle_12, _p27, prose));
							case 'Step 16':
								return updateModel(
									A2(_user$project$UserStudy$shuffle_12, _p27, prose));
							case 'Step 17':
								return updateModel(
									A2(_user$project$UserStudy$shuffle_12, _p27, prose));
							case 'Step 18':
								return updateModel(
									A2(_user$project$UserStudy$shuffle_12, _p27, prose));
							case 'Step 19':
								return updateModel(
									A2(_user$project$UserStudy$shuffle_12, _p27, prose));
							case 'Step 20':
								return updateModel(
									A2(_user$project$UserStudy$shuffle_12, _p27, prose));
							case 'Step 21':
								return updateModel(
									A2(_user$project$UserStudy$shuffle_12, _p27, prose));
							case 'Step 22':
								return updateModel(
									A2(_user$project$UserStudy$shuffle_12, _p27, prose));
							case 'Step 23':
								return updateModel(
									A2(_user$project$UserStudy$shuffle_12, _p27, prose));
							default:
								return m;
						}
					case 'Task':
						switch (_p25._1._1.ctor) {
							case 'ReadOnly':
								return updateModel(
									_elm_lang$core$Maybe$Just(_user$project$UserStudy$readOnlyProse));
							case 'BoxSelectOnly':
								return updateModel(
									A2(_user$project$UserStudy$replacePlaceholderInstructionsWith, prose, _user$project$UserStudy$boxSelectOnlyProse));
							case 'TextSelectOnly':
								return updateModel(
									A2(_user$project$UserStudy$replacePlaceholderInstructionsWith, prose, _user$project$UserStudy$textSelectOnlyProse));
							case 'CodeToolsOnly':
								return updateModel(
									A2(_user$project$UserStudy$replacePlaceholderInstructionsWith, prose, _user$project$UserStudy$codeToolsOnlyProse));
							default:
								break _v15_5;
						}
					default:
						break _v15_5;
				}
			} else {
				break _v15_5;
			}
		} while(false);
		return m;
	});
var _user$project$UserStudy$shuffleList = function (list) {
	var foo = F2(
		function (remaining, reordered) {
			foo:
			while (true) {
				var _p28 = remaining;
				if (_p28.ctor === '[]') {
					return reordered;
				} else {
					var n = _elm_lang$core$List$length(remaining);
					var i = _user$project$UserStudy$getRandom(
						A2(_elm_lang$core$Random$int, 1, n));
					var _p29 = {
						ctor: '_Tuple2',
						_0: A2(_user$project$Utils$geti, i, remaining),
						_1: A2(_user$project$Utils$removei, i, remaining)
					};
					var x = _p29._0;
					var nextRemaining = _p29._1;
					var _v18 = nextRemaining,
						_v19 = A2(
						_elm_lang$core$Basics_ops['++'],
						reordered,
						{
							ctor: '::',
							_0: x,
							_1: {ctor: '[]'}
						});
					remaining = _v18;
					reordered = _v19;
					continue foo;
				}
			}
		});
	return A2(
		foo,
		list,
		{ctor: '[]'});
};
var _user$project$UserStudy$enabled = false;
var _user$project$UserStudy$hideIfEnabled = function (content) {
	return _user$project$UserStudy$enabled ? {ctor: '[]'} : content;
};
var _user$project$UserStudy$showIfEnabled = function (content) {
	return _user$project$UserStudy$enabled ? content : {ctor: '[]'};
};
var _user$project$UserStudy$End = {ctor: 'End'};
var _user$project$UserStudy$Transition2 = {ctor: 'Transition2'};
var _user$project$UserStudy$Task = function (a) {
	return {ctor: 'Task', _0: a};
};
var _user$project$UserStudy$Transition1 = {ctor: 'Transition1'};
var _user$project$UserStudy$Tutorial = {ctor: 'Tutorial'};
var _user$project$UserStudy$Start = {ctor: 'Start'};
var _user$project$UserStudy$OpenEnded = {ctor: 'OpenEnded'};
var _user$project$UserStudy$HeadToHead = {ctor: 'HeadToHead'};
var _user$project$UserStudy$AllFeatures = {ctor: 'AllFeatures'};
var _user$project$UserStudy$CodeToolsOnly = {ctor: 'CodeToolsOnly'};
var _user$project$UserStudy$BoxSelectOnly = {ctor: 'BoxSelectOnly'};
var _user$project$UserStudy$TextSelectOnly = {ctor: 'TextSelectOnly'};
var _user$project$UserStudy$TextEditOnly = {ctor: 'TextEditOnly'};
var _user$project$UserStudy$tutorialTasks = function () {
	var template = function (i) {
		return A2(
			_elm_lang$core$Basics_ops['++'],
			'Step ',
			A3(
				_elm_lang$core$String$padLeft,
				2,
				_elm_lang$core$Native_Utils.chr('0'),
				_elm_lang$core$Basics$toString(i)));
	};
	return A2(
		_elm_lang$core$List$map,
		function (i) {
			var editorMode = (_elm_lang$core$Native_Utils.cmp(i, _user$project$UserStudy$structuredEditingStartStep) < 0) ? _user$project$UserStudy$TextEditOnly : _user$project$UserStudy$AllFeatures;
			return {
				ctor: '_Tuple2',
				_0: _user$project$UserStudy$Tutorial,
				_1: {
					ctor: '_Tuple2',
					_0: template(i),
					_1: editorMode
				}
			};
		},
		A2(_elm_lang$core$List$range, 1, _user$project$UserStudy$numTutorialSteps));
}();
var _user$project$UserStudy$ReadOnly = {ctor: 'ReadOnly'};
var _user$project$UserStudy$insertReadingPeriods = _elm_lang$core$List$concatMap(
	function (_p30) {
		var _p31 = _p30;
		var _p33 = _p31._1._0;
		var _p32 = _p31._0;
		return {
			ctor: '::',
			_0: {
				ctor: '_Tuple2',
				_0: _p32,
				_1: {ctor: '_Tuple2', _0: _p33, _1: _user$project$UserStudy$ReadOnly}
			},
			_1: {
				ctor: '::',
				_0: {
					ctor: '_Tuple2',
					_0: _p32,
					_1: {ctor: '_Tuple2', _0: _p33, _1: _p31._1._1}
				},
				_1: {ctor: '[]'}
			}
		};
	});
var _user$project$UserStudy$headToHeadTasks = function () {
	var indexLastInFirstPass = _elm_lang$core$List$length(_user$project$UserStudy$headToHeadTaskTemplates);
	var _p34 = function () {
		var makeTaskMode = F2(
			function (template, bool) {
				return {
					ctor: '_Tuple2',
					_0: _user$project$UserStudy$Task(_user$project$UserStudy$HeadToHead),
					_1: {
						ctor: '_Tuple2',
						_0: template,
						_1: bool ? _user$project$UserStudy$TextSelectOnly : _user$project$UserStudy$BoxSelectOnly
					}
				};
			});
		var randomBools = _user$project$UserStudy$getRandom(
			A2(
				_elm_lang$core$Random$list,
				_elm_lang$core$List$length(_user$project$UserStudy$headToHeadTaskTemplates),
				_elm_lang$core$Random$bool));
		var shuffledTemplates = _user$project$UserStudy$shuffleList(_user$project$UserStudy$headToHeadTaskTemplates);
		return {
			ctor: '_Tuple2',
			_0: A3(_user$project$Utils$zipWith, makeTaskMode, shuffledTemplates, randomBools),
			_1: _user$project$UserStudy$shuffleList(
				A3(
					_user$project$Utils$zipWith,
					makeTaskMode,
					shuffledTemplates,
					A2(_elm_lang$core$List$map, _elm_lang$core$Basics$not, randomBools)))
		};
	}();
	var firstTimeThroughAll = _p34._0;
	var secondTimeThroughAll = _p34._1;
	var maybeReshuffle = function (list) {
		return _elm_lang$core$Native_Utils.eq(
			_user$project$UserStudy$getTemplate(
				A2(_user$project$Utils$geti, indexLastInFirstPass, firstTimeThroughAll)),
			_user$project$UserStudy$getTemplate(
				A2(_user$project$Utils$geti, 1, list))) ? _user$project$UserStudy$shuffleList(list) : list;
	};
	var secondTimeThroughAllNotFirstTaskSameAsPrevious = maybeReshuffle(
		maybeReshuffle(
			maybeReshuffle(
				maybeReshuffle(
					maybeReshuffle(
						maybeReshuffle(
							maybeReshuffle(secondTimeThroughAll)))))));
	return _user$project$UserStudy$insertReadingPeriods(
		A2(_elm_lang$core$Basics_ops['++'], firstTimeThroughAll, secondTimeThroughAllNotFirstTaskSameAsPrevious));
}();
var _user$project$UserStudy$fullTasks = _user$project$UserStudy$insertReadingPeriods(
	A2(
		_elm_lang$core$List$map,
		function (template) {
			return {
				ctor: '_Tuple2',
				_0: _user$project$UserStudy$Task(_user$project$UserStudy$OpenEnded),
				_1: {ctor: '_Tuple2', _0: template, _1: _user$project$UserStudy$CodeToolsOnly}
			};
		},
		_user$project$UserStudy$fullTaskTemplates));
var _user$project$UserStudy$sequence = _elm_lang$core$List$concat(
	{
		ctor: '::',
		_0: {
			ctor: '::',
			_0: {
				ctor: '_Tuple2',
				_0: _user$project$UserStudy$Start,
				_1: {ctor: '_Tuple2', _0: 'Deuce Study Start', _1: _user$project$UserStudy$TextEditOnly}
			},
			_1: {ctor: '[]'}
		},
		_1: {
			ctor: '::',
			_0: _user$project$UserStudy$tutorialTasks,
			_1: {
				ctor: '::',
				_0: {
					ctor: '::',
					_0: {
						ctor: '_Tuple2',
						_0: _user$project$UserStudy$Transition1,
						_1: {ctor: '_Tuple2', _0: 'Deuce Study Transition 1', _1: _user$project$UserStudy$TextEditOnly}
					},
					_1: {ctor: '[]'}
				},
				_1: {
					ctor: '::',
					_0: _user$project$UserStudy$headToHeadTasks,
					_1: {
						ctor: '::',
						_0: {
							ctor: '::',
							_0: {
								ctor: '_Tuple2',
								_0: _user$project$UserStudy$Transition2,
								_1: {ctor: '_Tuple2', _0: 'Deuce Study Transition 2', _1: _user$project$UserStudy$AllFeatures}
							},
							_1: {ctor: '[]'}
						},
						_1: {
							ctor: '::',
							_0: _user$project$UserStudy$fullTasks,
							_1: {
								ctor: '::',
								_0: {
									ctor: '::',
									_0: {
										ctor: '_Tuple2',
										_0: _user$project$UserStudy$End,
										_1: {ctor: '_Tuple2', _0: 'Deuce Study End', _1: _user$project$UserStudy$AllFeatures}
									},
									_1: {ctor: '[]'}
								},
								_1: {ctor: '[]'}
							}
						}
					}
				}
			}
		}
	});
var _user$project$UserStudy$getState = function (i) {
	return A2(_user$project$Utils$geti, i, _user$project$UserStudy$sequence);
};
var _user$project$UserStudy$disableNextStep = function (i) {
	var _p35 = _user$project$UserStudy$getPhase(
		_user$project$UserStudy$getState(i));
	if (_p35.ctor === 'End') {
		return true;
	} else {
		return false;
	}
};
var _user$project$UserStudy$disablePreviousStep = function (i) {
	var _p36 = _user$project$UserStudy$getPhase(
		_user$project$UserStudy$getState(i));
	switch (_p36.ctor) {
		case 'Start':
			return true;
		case 'Tutorial':
			return false;
		case 'Transition1':
			return false;
		default:
			return true;
	}
};
var _user$project$UserStudy$stepPhases = A2(
	_elm_lang$core$List$map,
	function (_p37) {
		var _p38 = _p37;
		return _p38._0;
	},
	_user$project$UserStudy$sequence);
var _user$project$UserStudy$tutorialStepsCount = A2(_user$project$Utils$count, _user$project$UserStudy$isTutorialPhase, _user$project$UserStudy$stepPhases);
var _user$project$UserStudy$tutorialStepNumber = function (currentI) {
	return A2(
		_user$project$Utils$count,
		function (_p39) {
			var _p40 = _p39;
			return (_elm_lang$core$Native_Utils.cmp(_p40._0, currentI) < 1) && _user$project$UserStudy$isTutorialPhase(_p40._1);
		},
		_user$project$Utils$zipi1(_user$project$UserStudy$stepPhases));
};
var _user$project$UserStudy$taskStepsCount = A2(_user$project$Utils$count, _user$project$UserStudy$isTaskPhase, _user$project$UserStudy$stepPhases);
var _user$project$UserStudy$taskStepNumber = function (currentI) {
	return A2(
		_user$project$Utils$count,
		function (_p41) {
			var _p42 = _p41;
			return (_elm_lang$core$Native_Utils.cmp(_p42._0, currentI) < 1) && _user$project$UserStudy$isTaskPhase(_p42._1);
		},
		_user$project$Utils$zipi1(_user$project$UserStudy$stepPhases));
};
var _user$project$UserStudy$stepDescription = function (stepI) {
	var unknownStepText = 'User Study';
	return A2(
		_elm_lang$core$Maybe$withDefault,
		unknownStepText,
		A2(
			_elm_lang$core$Maybe$map,
			function (phase) {
				if (_elm_lang$core$Native_Utils.eq(phase, _user$project$UserStudy$Start)) {
					return 'Welcome to the User Study!';
				} else {
					if (_user$project$UserStudy$isTutorialPhase(phase)) {
						return A2(
							_elm_lang$core$Basics_ops['++'],
							'Tutorial Step ',
							A2(
								_elm_lang$core$Basics_ops['++'],
								_elm_lang$core$Basics$toString(
									_user$project$UserStudy$tutorialStepNumber(stepI)),
								A2(
									_elm_lang$core$Basics_ops['++'],
									'/',
									_elm_lang$core$Basics$toString(_user$project$UserStudy$tutorialStepsCount))));
					} else {
						if (_user$project$UserStudy$isTaskPhase(phase)) {
							return A2(
								_elm_lang$core$Basics_ops['++'],
								'Task Step ',
								A2(
									_elm_lang$core$Basics_ops['++'],
									_elm_lang$core$Basics$toString(
										_user$project$UserStudy$taskStepNumber(stepI)),
									A2(
										_elm_lang$core$Basics_ops['++'],
										'/',
										_elm_lang$core$Basics$toString(_user$project$UserStudy$taskStepsCount))));
						} else {
							if (_elm_lang$core$Native_Utils.eq(phase, _user$project$UserStudy$End)) {
								return 'Tasks Complete';
							} else {
								var _p43 = A2(
									_user$project$UserStudyLog$log,
									'Unkown Phase',
									_elm_lang$core$Basics$toString(phase));
								return unknownStepText;
							}
						}
					}
				}
			},
			A2(_user$project$Utils$maybeGeti1, stepI, _user$project$UserStudy$stepPhases)));
};
var _user$project$UserStudy$_p44 = A2(
	_user$project$UserStudyLog$log,
	'UserStudy.sequence',
	_elm_lang$core$Basics$toString(_user$project$UserStudy$sequence));

var _user$project$SleekLayout$proseResizerBoundMargin = 100;
var _user$project$SleekLayout$proseResizerHeight = 20;
var _user$project$SleekLayout$mainResizerBoundMargin = 100;
var _user$project$SleekLayout$mainResizerWidth = 20;
var _user$project$SleekLayout$prosePanelFullHeight = 300;
var _user$project$SleekLayout$deuceRightClickMenuMouseOffset = {x: 16, y: 16};
var _user$project$SleekLayout$deucePopupPanelMouseOffset = {x: -16, y: -16};
var _user$project$SleekLayout$menuBar = {height: 30, borderWidth: 1};
var _user$project$SleekLayout$menuBarTotalHeight = _user$project$SleekLayout$menuBar.height + _user$project$SleekLayout$menuBar.borderWidth;
var _user$project$SleekLayout$deuceOverlayBleed = 10;
var _user$project$SleekLayout$spacing = {width: 10, height: 10};
var _user$project$SleekLayout$toolPanel = _user$project$UserStudy$enabled ? {width: 0, right: _user$project$SleekLayout$spacing.width, marginLeft: 0} : {width: 50, right: _user$project$SleekLayout$spacing.width, marginLeft: _user$project$SleekLayout$spacing.width};
var _user$project$SleekLayout$synthesisPanel = function (model) {
	return {
		bottom: _user$project$SleekLayout$spacing.height,
		height: (_user$project$InterfaceModel$synthesisResultsNotEmpty(model) && (!model.viewState.menuActive)) ? 300 : 0
	};
};
var _user$project$SleekLayout$staticContentWidth = ((2 * _user$project$SleekLayout$spacing.width) + _user$project$SleekLayout$toolPanel.width) + _user$project$SleekLayout$toolPanel.marginLeft;
var _user$project$SleekLayout$dynamicContentWidth = function (model) {
	return model.dimensions.width - _user$project$SleekLayout$staticContentWidth;
};
var _user$project$SleekLayout$staticContentHeight = function (model) {
	return (_user$project$SleekLayout$menuBarTotalHeight + (2 * _user$project$SleekLayout$spacing.height)) + _user$project$SleekLayout$synthesisPanel(model).height;
};
var _user$project$SleekLayout$dynamicContentHeight = function (model) {
	return model.dimensions.height - _user$project$SleekLayout$staticContentHeight(model);
};
var _user$project$SleekLayout$mainPanelY = _user$project$SleekLayout$menuBarTotalHeight + _user$project$SleekLayout$spacing.height;
var _user$project$SleekLayout$defaultProseResizerY = function (model) {
	var top = _user$project$SleekLayout$mainPanelY;
	var spaceToDivide = _elm_lang$core$Basics$toFloat(
		_user$project$SleekLayout$dynamicContentHeight(model) - _user$project$SleekLayout$proseResizerHeight);
	var ratio = 0.6;
	return top + _elm_lang$core$Basics$round(ratio * spaceToDivide);
};
var _user$project$SleekLayout$proseResizerBottomBound = function (model) {
	return (_user$project$SleekLayout$mainPanelY + _user$project$SleekLayout$dynamicContentHeight(model)) - _user$project$SleekLayout$proseResizerBoundMargin;
};
var _user$project$SleekLayout$defaultMainResizerX = function (model) {
	var left = _user$project$SleekLayout$spacing.width;
	var spaceToDivide = _elm_lang$core$Basics$toFloat(
		_user$project$SleekLayout$dynamicContentWidth(model) - _user$project$SleekLayout$mainResizerWidth);
	var ratio = 0.6;
	return left + _elm_lang$core$Basics$round(ratio * spaceToDivide);
};
var _user$project$SleekLayout$half = function (x) {
	return (x / 2) | 0;
};
var _user$project$SleekLayout$px = function (n) {
	return A2(
		_elm_lang$core$Basics_ops['++'],
		_elm_lang$core$Basics$toString(n),
		'px');
};
var _user$project$SleekLayout$panelBorderWidth = 1;
var _user$project$SleekLayout$iconButton = {width: _user$project$SleekLayout$toolPanel.width - (2 * _user$project$SleekLayout$panelBorderWidth), height: _user$project$SleekLayout$toolPanel.width - (2 * _user$project$SleekLayout$panelBorderWidth)};
var _user$project$SleekLayout$box = F4(
	function (x, y, width, height) {
		return {x: x, y: y, width: width, height: height};
	});
var _user$project$SleekLayout$mainResizer = function (model) {
	var y = _user$project$SleekLayout$mainPanelY;
	var x = A2(
		_elm_lang$core$Maybe$withDefault,
		_user$project$SleekLayout$defaultMainResizerX(model),
		model.mainResizerX);
	var height = _user$project$SleekLayout$dynamicContentHeight(model);
	var width = _user$project$SleekLayout$mainResizerWidth;
	return A4(_user$project$SleekLayout$box, x, y, width, height);
};
var _user$project$SleekLayout$codePanel = function (model) {
	var height = _user$project$SleekLayout$dynamicContentHeight(model);
	var y = _user$project$SleekLayout$mainPanelY;
	var x = _user$project$SleekLayout$spacing.width;
	var mainResizerBB = _user$project$SleekLayout$mainResizer(model);
	var width = mainResizerBB.x - x;
	return A4(_user$project$SleekLayout$box, x, y, width, height);
};
var _user$project$SleekLayout$mainResizerLeftBound = function (model) {
	var codePanelBB = _user$project$SleekLayout$codePanel(model);
	return codePanelBB.x + _user$project$SleekLayout$mainResizerBoundMargin;
};
var _user$project$SleekLayout$proseResizer = function (model) {
	var height = _user$project$SleekLayout$proseResizerHeight;
	var y = A2(
		_elm_lang$core$Maybe$withDefault,
		_user$project$SleekLayout$defaultProseResizerY(model),
		model.proseResizerY);
	var mainResizerBB = _user$project$SleekLayout$mainResizer(model);
	var x = mainResizerBB.x + mainResizerBB.width;
	var width = (((model.dimensions.width - _user$project$SleekLayout$toolPanel.right) - _user$project$SleekLayout$toolPanel.width) - _user$project$SleekLayout$toolPanel.marginLeft) - x;
	return A4(_user$project$SleekLayout$box, x, y, width, height);
};
var _user$project$SleekLayout$outputPanel = function (model) {
	var y = _user$project$SleekLayout$mainPanelY;
	var proseResizerBB = _user$project$SleekLayout$proseResizer(model);
	var height = _user$project$UserStudy$enabled ? (proseResizerBB.y - _user$project$SleekLayout$mainPanelY) : _user$project$SleekLayout$dynamicContentHeight(model);
	var mainResizerBB = _user$project$SleekLayout$mainResizer(model);
	var x = mainResizerBB.x + mainResizerBB.width;
	var width = (((model.dimensions.width - _user$project$SleekLayout$toolPanel.right) - _user$project$SleekLayout$toolPanel.width) - _user$project$SleekLayout$toolPanel.marginLeft) - x;
	return A4(_user$project$SleekLayout$box, x, y, width, height);
};
var _user$project$SleekLayout$prosePanel = function (model) {
	var outputPanelBB = _user$project$SleekLayout$outputPanel(model);
	var proseResizerBB = _user$project$SleekLayout$proseResizer(model);
	var y = proseResizerBB.y + proseResizerBB.height;
	var height = (_user$project$SleekLayout$dynamicContentHeight(model) - outputPanelBB.height) - proseResizerBB.height;
	var mainResizerBB = _user$project$SleekLayout$mainResizer(model);
	var x = mainResizerBB.x + mainResizerBB.width;
	var width = (((model.dimensions.width - _user$project$SleekLayout$toolPanel.right) - _user$project$SleekLayout$toolPanel.width) - _user$project$SleekLayout$toolPanel.marginLeft) - x;
	return A4(_user$project$SleekLayout$box, x, y, width, height);
};
var _user$project$SleekLayout$mainResizerRightBound = function (model) {
	var outputPanelBB = _user$project$SleekLayout$outputPanel(model);
	return (outputPanelBB.x + outputPanelBB.width) - _user$project$SleekLayout$mainResizerBoundMargin;
};
var _user$project$SleekLayout$proseResizerTopBound = function (model) {
	var outputPanelBB = _user$project$SleekLayout$outputPanel(model);
	return outputPanelBB.y + _user$project$SleekLayout$proseResizerBoundMargin;
};
var _user$project$SleekLayout$outputCanvas = function (model) {
	var op = _user$project$SleekLayout$outputPanel(model);
	return {x: op.x + _user$project$SleekLayout$panelBorderWidth, y: op.y + _user$project$SleekLayout$panelBorderWidth, width: op.width - (2 * _user$project$SleekLayout$panelBorderWidth), height: op.height - (2 * _user$project$SleekLayout$panelBorderWidth)};
};
var _user$project$SleekLayout$clickToCanvasPoint = F2(
	function (model, _p0) {
		var _p1 = _p0;
		var box = _user$project$SleekLayout$outputCanvas(model);
		var canvasX = _p1.x - box.x;
		var canvasY = _p1.y - box.y;
		var isOnCanvas = (_elm_lang$core$Native_Utils.cmp(0, canvasX) < 1) && ((_elm_lang$core$Native_Utils.cmp(canvasX, box.width) < 1) && ((_elm_lang$core$Native_Utils.cmp(0, canvasY) < 1) && (_elm_lang$core$Native_Utils.cmp(canvasY, box.height) < 1)));
		return {
			ctor: '_Tuple2',
			_0: isOnCanvas,
			_1: {ctor: '_Tuple2', _0: canvasX, _1: canvasY}
		};
	});
var _user$project$SleekLayout$BoundingBox = F4(
	function (a, b, c, d) {
		return {x: a, y: b, width: c, height: d};
	});

var _user$project$Draw$maybeGhost = F3(
	function (b, f, args) {
		return b ? {
			ctor: '_Tuple2',
			_0: _user$project$Lang$eVar0('ghost'),
			_1: {
				ctor: '::',
				_0: _user$project$Lang$withDummyExpInfo(
					A4(_user$project$Lang$EApp, _user$project$Lang$space1, f, args, _user$project$Lang$space0)),
				_1: {ctor: '[]'}
			}
		} : {ctor: '_Tuple2', _0: f, _1: args};
	});
var _user$project$Draw$ghost = _user$project$Draw$maybeGhost(true);
var _user$project$Draw$addToMainExp = F2(
	function (newBlob, mainExp) {
		var _p0 = mainExp;
		switch (_p0.ctor) {
			case 'SvgConcat':
				return A2(
					_user$project$Blobs$SvgConcat,
					A2(
						_elm_lang$core$Basics_ops['++'],
						_p0._0,
						{
							ctor: '::',
							_0: _user$project$Blobs$fromBlobExp(newBlob),
							_1: {ctor: '[]'}
						}),
					_p0._1);
			case 'Blobs':
				return A2(
					_user$project$Blobs$Blobs,
					A2(
						_elm_lang$core$Basics_ops['++'],
						_p0._0,
						{
							ctor: '::',
							_0: newBlob,
							_1: {ctor: '[]'}
						}),
					_p0._1);
			default:
				var wsN = _user$project$Lang$ws('\n');
				return _user$project$Blobs$OtherExp(
					_user$project$Lang$withDummyExpInfo(
						A4(
							_user$project$Lang$EApp,
							wsN,
							_user$project$Lang$eVar0('addBlob'),
							{
								ctor: '::',
								_0: _user$project$Blobs$fromBlobExp(newBlob),
								_1: {
									ctor: '::',
									_0: _p0._0,
									_1: {ctor: '[]'}
								}
							},
							_user$project$Lang$space0)));
		}
	});
var _user$project$Draw$makeInts = function (nums) {
	var _p1 = nums;
	if (_p1.ctor === '[]') {
		return _elm_lang$core$Native_Utils.crashCase(
			'Draw',
			{
				start: {line: 823, column: 3},
				end: {line: 828, column: 19}
			},
			_p1)('makeInts');
	} else {
		if (_p1._1.ctor === '[]') {
			return {
				ctor: '::',
				_0: A2(
					_user$project$Lang$eConst0,
					_elm_lang$core$Basics$toFloat(_p1._0),
					_user$project$Lang$dummyLoc),
				_1: {ctor: '[]'}
			};
		} else {
			var e = A2(
				_user$project$Lang$eConst0,
				_elm_lang$core$Basics$toFloat(_p1._0),
				_user$project$Lang$dummyLoc);
			var es = A2(
				_elm_lang$core$List$map,
				function (n_) {
					return A2(
						_user$project$Lang$eConst,
						_elm_lang$core$Basics$toFloat(n_),
						_user$project$Lang$dummyLoc);
				},
				_p1._1);
			return {ctor: '::', _0: e, _1: es};
		}
	}
};
var _user$project$Draw$makeLet = F2(
	function (vars, exps) {
		var _p3 = {ctor: '_Tuple2', _0: vars, _1: exps};
		if (((_p3.ctor === '_Tuple2') && (_p3._0.ctor === '::')) && (_p3._1.ctor === '::')) {
			if ((_p3._0._1.ctor === '[]') && (_p3._1._1.ctor === '[]')) {
				return {
					ctor: '_Tuple2',
					_0: _user$project$Lang$pVar(_p3._0._0),
					_1: _p3._1._0
				};
			} else {
				var ps = A2(_elm_lang$core$List$map, _user$project$Lang$pVar, _p3._0._1);
				var p = _user$project$Lang$pVar0(_p3._0._0);
				return {
					ctor: '_Tuple2',
					_0: _user$project$Lang$pList(
						{ctor: '::', _0: p, _1: ps}),
					_1: A2(
						_user$project$Lang$eList,
						{ctor: '::', _0: _p3._1._0, _1: _p3._1._1},
						_elm_lang$core$Maybe$Nothing)
				};
			}
		} else {
			return _elm_lang$core$Native_Utils.crashCase(
				'Draw',
				{
					start: {line: 809, column: 3},
					end: {line: 814, column: 43}
				},
				_p3)('makeLet');
		}
	});
var _user$project$Draw$makeLetAs = F3(
	function (x, vars, exps) {
		var _p5 = A2(_user$project$Draw$makeLet, vars, exps);
		var p = _p5._0;
		var e = _p5._1;
		return {
			ctor: '_Tuple2',
			_0: A2(_user$project$Lang$pAs, x, p),
			_1: e
		};
	});
var _user$project$Draw$makeCallWithLocals = F4(
	function (multi, locals, func, args) {
		var recurse = function (locals) {
			var _p6 = locals;
			if (_p6.ctor === '[]') {
				if (multi) {
					return _user$project$Lang$withDummyExpInfo(
						A4(
							_user$project$Lang$EApp,
							_user$project$Lang$ws('\n    '),
							func,
							args,
							_user$project$Lang$space0));
				} else {
					var app = _user$project$Lang$withDummyExpInfo(
						A4(_user$project$Lang$EApp, _user$project$Lang$space1, func, args, _user$project$Lang$space0));
					return _user$project$Lang$withDummyExpInfo(
						A5(
							_user$project$Lang$EList,
							_user$project$Lang$ws('\n    '),
							{
								ctor: '::',
								_0: app,
								_1: {ctor: '[]'}
							},
							_user$project$Lang$space0,
							_elm_lang$core$Maybe$Nothing,
							_user$project$Lang$space1));
				}
			} else {
				return _user$project$Lang$withDummyExpInfo(
					A7(
						_user$project$Lang$ELet,
						_user$project$Lang$ws('\n  '),
						_user$project$Lang$Let,
						false,
						_p6._0._0,
						_p6._0._1,
						recurse(_p6._1),
						_user$project$Lang$space0));
			}
		};
		return recurse(locals);
	});
var _user$project$Draw$add = F5(
	function (newShapeKind, old, newShapeLocals, newShapeFunc, newShapeArgs) {
		var shapeVarName = A3(
			_user$project$LangTools$nonCollidingName,
			newShapeKind,
			1,
			_user$project$LangTools$identifiersVisibleAtProgramEnd(old.inputExp));
		var newDef = function () {
			var multi = function () {
				var _p7 = old.tool;
				switch (_p7.ctor) {
					case 'Lambda':
						return true;
					case 'Text':
						return true;
					default:
						return false;
				}
			}();
			var newShapeName = _user$project$Lang$withDummyPatInfo(
				A3(_user$project$Lang$PVar, _user$project$Lang$space1, shapeVarName, _user$project$Lang$noWidgetDecl));
			var newShapeExp = A4(_user$project$Draw$makeCallWithLocals, multi, newShapeLocals, newShapeFunc, newShapeArgs);
			return {
				ctor: '_Tuple4',
				_0: _user$project$Lang$ws('\n\n'),
				_1: newShapeName,
				_2: newShapeExp,
				_3: _user$project$Lang$space0
			};
		}();
		var _p8 = _user$project$Blobs$splitExp(old.inputExp);
		var defs = _p8._0;
		var mainExp = _p8._1;
		var defs_ = A2(
			_elm_lang$core$Basics_ops['++'],
			defs,
			{
				ctor: '::',
				_0: newDef,
				_1: {ctor: '[]'}
			});
		var eNew = _user$project$Lang$withDummyExpInfo(
			A2(
				_user$project$Lang$EVar,
				_user$project$Lang$ws('\n  '),
				shapeVarName));
		var mainExp_ = A2(
			_user$project$Draw$addToMainExp,
			A2(_user$project$Blobs$varBlob, eNew, shapeVarName),
			mainExp);
		var code = _user$project$LangUnparser$unparse(
			_user$project$Blobs$fuseExp(
				{ctor: '_Tuple2', _0: defs_, _1: mainExp_}));
		return _elm_lang$core$Native_Utils.update(
			old,
			{code: code});
	});
var _user$project$Draw$addShape = F3(
	function (old, newShapeKind, newShapeExp) {
		var shapeVarName = A3(
			_user$project$LangTools$nonCollidingName,
			newShapeKind,
			1,
			_user$project$LangTools$identifiersVisibleAtProgramEnd(old.inputExp));
		var newShapeName = _user$project$Lang$withDummyPatInfo(
			A3(_user$project$Lang$PVar, _user$project$Lang$space1, shapeVarName, _user$project$Lang$noWidgetDecl));
		var newDef = {ctor: '_Tuple4', _0: _user$project$Lang$newline2, _1: newShapeName, _2: newShapeExp, _3: _user$project$Lang$space0};
		var _p9 = _user$project$Blobs$splitExp(old.inputExp);
		var defs = _p9._0;
		var mainExp = _p9._1;
		var defs_ = A2(
			_elm_lang$core$Basics_ops['++'],
			defs,
			{
				ctor: '::',
				_0: newDef,
				_1: {ctor: '[]'}
			});
		var eNew = _user$project$Lang$withDummyExpInfo(
			A2(
				_user$project$Lang$EVar,
				_user$project$Lang$ws('\n  '),
				shapeVarName));
		var mainExp_ = A2(
			_user$project$Draw$addToMainExp,
			A2(_user$project$Blobs$varBlob, eNew, shapeVarName),
			mainExp);
		var code = _user$project$LangUnparser$unparse(
			_user$project$Blobs$fuseExp(
				{ctor: '_Tuple2', _0: defs_, _1: mainExp_}));
		return _elm_lang$core$Native_Utils.update(
			old,
			{code: code});
	});
var _user$project$Draw$eAsPoint = function (e) {
	var e_ = A2(_user$project$Lang$replacePrecedingWhitespace, '', e);
	return _user$project$Lang$withDummyExpInfo(
		A5(
			_user$project$Lang$EColonType,
			_user$project$Lang$space1,
			e_,
			_user$project$Lang$space1,
			_user$project$Lang$withDummyRange(
				A2(_user$project$Lang$TNamed, _user$project$Lang$space1, 'Point')),
			_user$project$Lang$space1));
};
var _user$project$Draw$addStickyPath = F2(
	function (old, keysAndPoints) {
		return _elm_lang$core$Native_Utils.crash(
			'Draw',
			{
				start: {line: 671, column: 3},
				end: {line: 671, column: 14}
			})('TODO: addStickyPath');
	});
var _user$project$Draw$strPoint = F3(
	function (strX, strY, _p10) {
		var _p11 = _p10;
		return _user$project$Utils$spaces(
			{
				ctor: '::',
				_0: strX(_p11._0),
				_1: {
					ctor: '::',
					_0: strY(_p11._1),
					_1: {ctor: '[]'}
				}
			});
	});
var _user$project$Draw$pathCommands = F3(
	function (strX, strY, keysAndPoints) {
		var strPt = A2(_user$project$Draw$strPoint, strX, strY);
		var keysAndPoints_ = _elm_lang$core$List$reverse(keysAndPoints);
		var _p12 = _user$project$Utils$head_(keysAndPoints_);
		var firstClick = _p12._1;
		var _p13 = _user$project$Utils$last_(keysAndPoints_);
		var lastClick = _p13._1;
		var _p14 = function () {
			if (!_elm_lang$core$Native_Utils.eq(firstClick, lastClick)) {
				return {
					ctor: '_Tuple3',
					_0: {ctor: '[]'},
					_1: A2(
						_elm_lang$core$Basics_ops['++'],
						'\'M\' ',
						strPt(firstClick)),
					_2: strPt(firstClick)
				};
			} else {
				var extraLets = {
					ctor: '::',
					_0: A2(
						_user$project$Draw$makeLet,
						{
							ctor: '::',
							_0: 'x0',
							_1: {
								ctor: '::',
								_0: 'y0',
								_1: {ctor: '[]'}
							}
						},
						{
							ctor: '::',
							_0: _user$project$Lang$eVar0(
								strX(
									_elm_lang$core$Tuple$first(firstClick))),
							_1: {
								ctor: '::',
								_0: _user$project$Lang$eVar(
									strY(
										_elm_lang$core$Tuple$second(firstClick))),
								_1: {ctor: '[]'}
							}
						}),
					_1: {ctor: '[]'}
				};
				return {ctor: '_Tuple3', _0: extraLets, _1: '\'M\' x0 y0', _2: 'x0 y0'};
			}
		}();
		var extraLets = _p14._0;
		var firstCmd = _p14._1;
		var lastPoint = _p14._2;
		var remainingCmds = function () {
			var foo = function (list0) {
				var _p15 = list0;
				if (_p15.ctor === '[]') {
					return {ctor: '[]'};
				} else {
					var _p33 = _p15._0._0;
					var _p32 = _p15._1;
					var _p31 = _p15._0._1;
					if (_elm_lang$core$Native_Utils.eq(_p33, _user$project$Keys$q)) {
						var _p16 = _p32;
						if ((_p16.ctor === '::') && (_p16._0.ctor === '_Tuple2')) {
							var _p20 = _p16._1;
							var _p19 = _p16._0._1;
							var _p17 = {
								ctor: '_Tuple2',
								_0: _elm_lang$core$Native_Utils.eq(_p19, firstClick),
								_1: _p20
							};
							if (_p17._0 === false) {
								return {
									ctor: '::',
									_0: _user$project$Utils$spaces(
										{
											ctor: '::',
											_0: '\'Q\'',
											_1: {
												ctor: '::',
												_0: strPt(_p31),
												_1: {
													ctor: '::',
													_0: strPt(_p19),
													_1: {ctor: '[]'}
												}
											}
										}),
									_1: foo(_p20)
								};
							} else {
								if (_p17._1.ctor === '[]') {
									return {
										ctor: '::',
										_0: _user$project$Utils$spaces(
											{
												ctor: '::',
												_0: '\'Q\'',
												_1: {
													ctor: '::',
													_0: strPt(_p31),
													_1: {
														ctor: '::',
														_0: lastPoint,
														_1: {
															ctor: '::',
															_0: '\'Z\'',
															_1: {ctor: '[]'}
														}
													}
												}
											}),
										_1: {ctor: '[]'}
									};
								} else {
									return _elm_lang$core$Native_Utils.crashCase(
										'Draw',
										{
											start: {line: 617, column: 15},
											end: {line: 620, column: 55}
										},
										_p17)('addPath Q1');
								}
							}
						} else {
							return _elm_lang$core$Native_Utils.crashCase(
								'Draw',
								{
									start: {line: 615, column: 11},
									end: {line: 621, column: 42}
								},
								_p16)('addPath Q2');
						}
					} else {
						if (_elm_lang$core$Native_Utils.eq(_p33, _user$project$Keys$c)) {
							var _p22 = _p32;
							if ((((_p22.ctor === '::') && (_p22._0.ctor === '_Tuple2')) && (_p22._1.ctor === '::')) && (_p22._1._0.ctor === '_Tuple2')) {
								var _p27 = _p22._1._1;
								var _p26 = _p22._1._0._1;
								var _p25 = _p22._0._1;
								var _p23 = {
									ctor: '_Tuple2',
									_0: _elm_lang$core$Native_Utils.eq(_p26, firstClick),
									_1: _p27
								};
								if (_p23._0 === false) {
									return {
										ctor: '::',
										_0: _user$project$Utils$spaces(
											{
												ctor: '::',
												_0: '\'C\'',
												_1: {
													ctor: '::',
													_0: strPt(_p31),
													_1: {
														ctor: '::',
														_0: strPt(_p25),
														_1: {
															ctor: '::',
															_0: strPt(_p26),
															_1: {ctor: '[]'}
														}
													}
												}
											}),
										_1: foo(_p27)
									};
								} else {
									if (_p23._1.ctor === '[]') {
										return {
											ctor: '::',
											_0: _user$project$Utils$spaces(
												{
													ctor: '::',
													_0: '\'C\'',
													_1: {
														ctor: '::',
														_0: strPt(_p31),
														_1: {
															ctor: '::',
															_0: strPt(_p25),
															_1: {
																ctor: '::',
																_0: lastPoint,
																_1: {
																	ctor: '::',
																	_0: '\'Z\'',
																	_1: {ctor: '[]'}
																}
															}
														}
													}
												}),
											_1: {ctor: '[]'}
										};
									} else {
										return _elm_lang$core$Native_Utils.crashCase(
											'Draw',
											{
												start: {line: 626, column: 15},
												end: {line: 629, column: 55}
											},
											_p23)('addPath C1');
									}
								}
							} else {
								return _elm_lang$core$Native_Utils.crashCase(
									'Draw',
									{
										start: {line: 624, column: 11},
										end: {line: 630, column: 42}
									},
									_p22)('addPath C2');
							}
						} else {
							var _p29 = {
								ctor: '_Tuple2',
								_0: _elm_lang$core$Native_Utils.eq(_p31, firstClick),
								_1: _p32
							};
							if (_p29._0 === false) {
								return {
									ctor: '::',
									_0: _user$project$Utils$spaces(
										{
											ctor: '::',
											_0: '\'L\'',
											_1: {
												ctor: '::',
												_0: strPt(_p31),
												_1: {ctor: '[]'}
											}
										}),
									_1: foo(_p32)
								};
							} else {
								if (_p29._1.ctor === '[]') {
									return {
										ctor: '::',
										_0: '\'Z\'',
										_1: {ctor: '[]'}
									};
								} else {
									return _elm_lang$core$Native_Utils.crashCase(
										'Draw',
										{
											start: {line: 633, column: 11},
											end: {line: 636, column: 51}
										},
										_p29)('addPath ZL');
								}
							}
						}
					}
				}
			};
			return foo(
				_user$project$Utils$tail_(keysAndPoints_));
		}();
		var sD = _user$project$Utils$bracks(
			_user$project$Utils$spaces(
				{ctor: '::', _0: firstCmd, _1: remainingCmds}));
		return {ctor: '_Tuple2', _0: extraLets, _1: sD};
	});
var _user$project$Draw$maybeThaw0 = function (s) {
	return _elm_lang$core$Native_Utils.eq(s, '0') ? s : A2(_elm_lang$core$Basics_ops['++'], s, '?');
};
var _user$project$Draw$maybeThaw = function (n) {
	return (_elm_lang$core$Native_Utils.eq(n, 0) || _elm_lang$core$Native_Utils.eq(n, 1)) ? _elm_lang$core$Basics$toString(n) : A2(
		_elm_lang$core$Basics_ops['++'],
		_elm_lang$core$Basics$toString(n),
		'?');
};
var _user$project$Draw$horizontalVerticalSnap = F2(
	function (_p35, _p34) {
		var _p36 = _p35;
		var _p41 = _p36._1;
		var _p40 = _p36._0;
		var _p37 = _p34;
		var _p39 = _p37._1;
		var _p38 = _p37._0;
		return (_elm_lang$core$Native_Utils.cmp(
			_elm_lang$core$Basics$abs(_p38 - _p40),
			_elm_lang$core$Basics$abs(_p39 - _p41)) > -1) ? ((_elm_lang$core$Native_Utils.cmp(_p38 - _p40, 0) > 0) ? {ctor: '_Tuple3', _0: _user$project$Lang$X, _1: _user$project$Lang$Positive, _2: _p38 - _p40} : {ctor: '_Tuple3', _0: _user$project$Lang$X, _1: _user$project$Lang$Negative, _2: _p40 - _p38}) : ((_elm_lang$core$Native_Utils.cmp(_p39 - _p41, 0) > 0) ? {ctor: '_Tuple3', _0: _user$project$Lang$Y, _1: _user$project$Lang$Positive, _2: _p39 - _p41} : {ctor: '_Tuple3', _0: _user$project$Lang$Y, _1: _user$project$Lang$Negative, _2: _p41 - _p39});
	});
var _user$project$Draw$addOffsetAndMaybePoint = F3(
	function (old, _p43, _p42) {
		var _p44 = _p43;
		var _p65 = _p44._1._1;
		var _p64 = _p44._1._0;
		var _p63 = _p44._0._1;
		var _p62 = _p44._0._0;
		var _p45 = _p42;
		var originalProgram = old.inputExp;
		var _p46 = A2(
			_user$project$Draw$horizontalVerticalSnap,
			{
				ctor: '_Tuple2',
				_0: _elm_lang$core$Basics$round(_p62),
				_1: _elm_lang$core$Basics$round(_p64)
			},
			{ctor: '_Tuple2', _0: _p45._0, _1: _p45._1});
		var axis = _p46._0;
		var sign = _p46._1;
		var offsetAmount = _p46._2;
		var plusOrMinus = _elm_lang$core$Native_Utils.eq(sign, _user$project$Lang$Positive) ? _user$project$Lang$Plus : _user$project$Lang$Minus;
		var offsetFromExistingTrace = function (trace) {
			var _p47 = trace;
			if ((_p47.ctor === 'TrLoc') && (_p47._0.ctor === '_Tuple3')) {
				var _p56 = _p47._0._2;
				var maybeNewProgram = A2(
					_user$project$Lang$mapFirstSuccessNode,
					function (e) {
						var _p48 = e.val.e__;
						if (_p48.ctor === 'ELet') {
							var _p54 = _p48._0;
							var _p53 = _p48._3;
							var _p52 = _p48._4;
							var _p51 = _p48._5;
							var bindings = A2(
								_elm_lang$core$Debug$log,
								'bindings',
								A2(_user$project$LangTools$tryMatchExpReturningList, _p53, _p52));
							if (A2(
								_elm_lang$core$List$any,
								function (_p49) {
									var _p50 = _p49;
									return _elm_lang$core$Native_Utils.eq(_p50._0, _p56);
								},
								bindings)) {
								var offsetName = A3(
									_user$project$LangTools$nonCollidingName,
									A2(_elm_lang$core$Basics_ops['++'], _p56, 'Offset'),
									2,
									A2(
										_user$project$LangTools$visibleIdentifiersAtEIds,
										originalProgram,
										_elm_lang$core$Set$singleton(
											_user$project$LangTools$lastExp(_p51).val.eid)));
								var offsetExp = A2(
									_user$project$Lang$eOp,
									plusOrMinus,
									{
										ctor: '::',
										_0: _user$project$Lang$eVar(_p56),
										_1: {
											ctor: '::',
											_0: _user$project$Lang$eConstDummyLoc(
												_elm_lang$core$Basics$toFloat(offsetAmount)),
											_1: {ctor: '[]'}
										}
									});
								var wrappedBody = function () {
									var letKind = A2(_user$project$LangTools$isTopLevel, _p51, originalProgram) ? _user$project$Lang$Def : _user$project$Lang$Let;
									return _user$project$Lang$withDummyExpInfo(
										A7(
											_user$project$Lang$ELet,
											_p54,
											letKind,
											false,
											_user$project$Lang$pVar(offsetName),
											offsetExp,
											_p51,
											_user$project$Lang$space0));
								}();
								return _elm_lang$core$Maybe$Just(
									A2(
										_user$project$Lang$replaceE__,
										e,
										A7(_user$project$Lang$ELet, _p54, _p48._1, _p48._2, _p53, _p52, wrappedBody, _p48._6)));
							} else {
								return _elm_lang$core$Maybe$Nothing;
							}
						} else {
							return _elm_lang$core$Maybe$Nothing;
						}
					},
					originalProgram);
				var _p55 = maybeNewProgram;
				if (_p55.ctor === 'Just') {
					return _elm_lang$core$Native_Utils.update(
						old,
						{
							code: _user$project$LangUnparser$unparse(_p55._0)
						});
				} else {
					return old;
				}
			} else {
				return old;
			}
		};
		if (_elm_lang$core$Native_Utils.eq(axis, _user$project$Lang$X) && (!_elm_lang$core$Native_Utils.eq(_p63, _user$project$Lang$dummyTrace))) {
			return offsetFromExistingTrace(_p63);
		} else {
			if (_elm_lang$core$Native_Utils.eq(axis, _user$project$Lang$Y) && (!_elm_lang$core$Native_Utils.eq(_p65, _user$project$Lang$dummyTrace))) {
				return offsetFromExistingTrace(_p65);
			} else {
				var _p57 = A3(
					_user$project$LangTools$nonCollidingNames,
					{
						ctor: '::',
						_0: 'point',
						_1: {
							ctor: '::',
							_0: 'x',
							_1: {
								ctor: '::',
								_0: 'y',
								_1: {
									ctor: '::',
									_0: 'x{n}Offset',
									_1: {
										ctor: '::',
										_0: 'y{n}Offset',
										_1: {ctor: '[]'}
									}
								}
							}
						}
					},
					1,
					_user$project$LangTools$identifiersVisibleAtProgramEnd(originalProgram));
				if ((((((_p57.ctor === '::') && (_p57._1.ctor === '::')) && (_p57._1._1.ctor === '::')) && (_p57._1._1._1.ctor === '::')) && (_p57._1._1._1._1.ctor === '::')) && (_p57._1._1._1._1._1.ctor === '[]')) {
					var _p60 = _p57._1._1._0;
					var _p59 = _p57._1._0;
					var _p58 = _elm_lang$core$Native_Utils.eq(axis, _user$project$Lang$X) ? {ctor: '_Tuple2', _0: _p57._1._1._1._0, _1: _p59} : {ctor: '_Tuple2', _0: _p57._1._1._1._1._0, _1: _p60};
					var offsetName = _p58._0;
					var offsetFromName = _p58._1;
					var programWithOffset = _user$project$FastParser$freshen(
						A3(
							_user$project$LangTools$addFirstDef,
							originalProgram,
							_user$project$Lang$pVar(offsetName),
							A2(
								_user$project$Lang$eOp,
								plusOrMinus,
								{
									ctor: '::',
									_0: _user$project$Lang$eVar(offsetFromName),
									_1: {
										ctor: '::',
										_0: _user$project$Lang$eConstDummyLoc(
											_elm_lang$core$Basics$toFloat(offsetAmount)),
										_1: {ctor: '[]'}
									}
								})));
					var programWithOffsetAndPoint = A3(
						_user$project$LangTools$addFirstDef,
						programWithOffset,
						A2(
							_user$project$Lang$pAs,
							_p57._0,
							_user$project$Lang$pList(
								{
									ctor: '::',
									_0: _user$project$Lang$pVar0(_p59),
									_1: {
										ctor: '::',
										_0: _user$project$Lang$pVar(_p60),
										_1: {ctor: '[]'}
									}
								})),
						A2(
							_user$project$Lang$eColonType,
							_user$project$Lang$eTuple0(
								{
									ctor: '::',
									_0: _user$project$Lang$eConstDummyLoc0(_p62),
									_1: {
										ctor: '::',
										_0: _user$project$Lang$eConstDummyLoc(_p64),
										_1: {ctor: '[]'}
									}
								}),
							A2(_user$project$Lang$TNamed, _user$project$Lang$space1, 'Point')));
					return _elm_lang$core$Native_Utils.update(
						old,
						{
							code: _user$project$LangUnparser$unparse(programWithOffsetAndPoint)
						});
				} else {
					return _elm_lang$core$Native_Utils.crashCase(
						'Draw',
						{
							start: {line: 480, column: 5},
							end: {line: 491, column: 128}
						},
						_p57)('unsatisfied list length invariant in LangTools.nonCollidingNames or bug in Draw.addOffsetAndMaybePoint');
				}
			}
		}
	});
var _user$project$Draw$addPoint = F2(
	function (old, _p66) {
		var _p67 = _p66;
		var originalProgram = old.inputExp;
		var _p68 = A3(
			_user$project$LangTools$nonCollidingNames,
			{
				ctor: '::',
				_0: 'point',
				_1: {
					ctor: '::',
					_0: 'x',
					_1: {
						ctor: '::',
						_0: 'y',
						_1: {ctor: '[]'}
					}
				}
			},
			2,
			_user$project$LangTools$identifiersVisibleAtProgramEnd(originalProgram));
		if ((((_p68.ctor === '::') && (_p68._1.ctor === '::')) && (_p68._1._1.ctor === '::')) && (_p68._1._1._1.ctor === '[]')) {
			var programWithPoint = A3(
				_user$project$LangTools$addFirstDef,
				originalProgram,
				A2(
					_user$project$Lang$pAs,
					_p68._0,
					_user$project$Lang$pList(
						{
							ctor: '::',
							_0: _user$project$Lang$pVar0(_p68._1._0),
							_1: {
								ctor: '::',
								_0: _user$project$Lang$pVar(_p68._1._1._0),
								_1: {ctor: '[]'}
							}
						})),
				A2(
					_user$project$Lang$eColonType,
					_user$project$Lang$eTuple0(
						{
							ctor: '::',
							_0: _user$project$Lang$eConstDummyLoc0(
								_elm_lang$core$Basics$toFloat(_p67._0)),
							_1: {
								ctor: '::',
								_0: _user$project$Lang$eConstDummyLoc(
									_elm_lang$core$Basics$toFloat(_p67._1)),
								_1: {ctor: '[]'}
							}
						}),
					A2(_user$project$Lang$TNamed, _user$project$Lang$space1, 'Point')));
			return _elm_lang$core$Native_Utils.update(
				old,
				{
					code: _user$project$LangUnparser$unparse(programWithPoint)
				});
		} else {
			return _elm_lang$core$Native_Utils.crashCase(
				'Draw',
				{
					start: {line: 415, column: 3},
					end: {line: 423, column: 112}
				},
				_p68)('unsatisfied list length invariant in LangTools.nonCollidingNames or bug in Draw.addPoint');
		}
	});
var _user$project$Draw$stencilStretchyRect = F8(
	function (left, top, right, bot, fill, stroke, strokeWidth, rot) {
		return A4(
			_user$project$Draw$makeCallWithLocals,
			false,
			{
				ctor: '::',
				_0: A3(
					_user$project$Draw$makeLetAs,
					'bounds',
					{
						ctor: '::',
						_0: 'left',
						_1: {
							ctor: '::',
							_0: 'top',
							_1: {
								ctor: '::',
								_0: 'right',
								_1: {
									ctor: '::',
									_0: 'bot',
									_1: {ctor: '[]'}
								}
							}
						}
					},
					_user$project$Draw$makeInts(
						{
							ctor: '::',
							_0: left,
							_1: {
								ctor: '::',
								_0: top,
								_1: {
									ctor: '::',
									_0: right,
									_1: {
										ctor: '::',
										_0: bot,
										_1: {ctor: '[]'}
									}
								}
							}
						})),
				_1: {
					ctor: '::',
					_0: A2(
						_user$project$Draw$makeLet,
						{
							ctor: '::',
							_0: 'color',
							_1: {ctor: '[]'}
						},
						{
							ctor: '::',
							_0: A2(
								_user$project$Lang$eConst,
								_elm_lang$core$Basics$toFloat(fill),
								_user$project$Lang$dummyLoc),
							_1: {ctor: '[]'}
						}),
					_1: {ctor: '[]'}
				}
			},
			_user$project$Lang$eVar0('rectangle'),
			{
				ctor: '::',
				_0: _user$project$Lang$eVar('color'),
				_1: {
					ctor: '::',
					_0: A2(
						_user$project$Lang$eConst,
						_elm_lang$core$Basics$toFloat(stroke),
						_user$project$Lang$dummyLoc),
					_1: {
						ctor: '::',
						_0: A2(
							_user$project$Lang$eConst,
							_elm_lang$core$Basics$toFloat(strokeWidth),
							_user$project$Lang$dummyLoc),
						_1: {
							ctor: '::',
							_0: A2(
								_user$project$Lang$eConst,
								_elm_lang$core$Basics$toFloat(rot),
								_user$project$Lang$dummyLoc),
							_1: {
								ctor: '::',
								_0: _user$project$Lang$eVar('bounds'),
								_1: {ctor: '[]'}
							}
						}
					}
				}
			});
	});
var _user$project$Draw$stencilRawRect = F8(
	function (x, y, w, h, fill, stroke, strokeWidth, rot) {
		return A4(
			_user$project$Draw$makeCallWithLocals,
			false,
			{
				ctor: '::',
				_0: A2(
					_user$project$Draw$makeLet,
					{
						ctor: '::',
						_0: 'x',
						_1: {
							ctor: '::',
							_0: 'y',
							_1: {
								ctor: '::',
								_0: 'w',
								_1: {
									ctor: '::',
									_0: 'h',
									_1: {ctor: '[]'}
								}
							}
						}
					},
					_user$project$Draw$makeInts(
						{
							ctor: '::',
							_0: x,
							_1: {
								ctor: '::',
								_0: y,
								_1: {
									ctor: '::',
									_0: w,
									_1: {
										ctor: '::',
										_0: h,
										_1: {ctor: '[]'}
									}
								}
							}
						})),
				_1: {
					ctor: '::',
					_0: A2(
						_user$project$Draw$makeLet,
						{
							ctor: '::',
							_0: 'fill',
							_1: {
								ctor: '::',
								_0: 'stroke',
								_1: {
									ctor: '::',
									_0: 'strokeWidth',
									_1: {ctor: '[]'}
								}
							}
						},
						_user$project$Draw$makeInts(
							{
								ctor: '::',
								_0: fill,
								_1: {
									ctor: '::',
									_0: stroke,
									_1: {
										ctor: '::',
										_0: strokeWidth,
										_1: {ctor: '[]'}
									}
								}
							})),
					_1: {
						ctor: '::',
						_0: A2(
							_user$project$Draw$makeLet,
							{
								ctor: '::',
								_0: 'rot',
								_1: {ctor: '[]'}
							},
							{
								ctor: '::',
								_0: A2(
									_user$project$Lang$eConst,
									_elm_lang$core$Basics$toFloat(rot),
									_user$project$Lang$dummyLoc),
								_1: {ctor: '[]'}
							}),
						_1: {ctor: '[]'}
					}
				}
			},
			_user$project$Lang$eVar0('rawRect'),
			{
				ctor: '::',
				_0: _user$project$Lang$eVar('fill'),
				_1: {
					ctor: '::',
					_0: _user$project$Lang$eVar('stroke'),
					_1: {
						ctor: '::',
						_0: _user$project$Lang$eVar('strokeWidth'),
						_1: {
							ctor: '::',
							_0: _user$project$Lang$eVar('x'),
							_1: {
								ctor: '::',
								_0: _user$project$Lang$eVar('y'),
								_1: {
									ctor: '::',
									_0: _user$project$Lang$eVar('w'),
									_1: {
										ctor: '::',
										_0: _user$project$Lang$eVar('h'),
										_1: {
											ctor: '::',
											_0: _user$project$Lang$eVar('rot'),
											_1: {ctor: '[]'}
										}
									}
								}
							}
						}
					}
				}
			});
	});
var _user$project$Draw$randomColor1 = function (model) {
	return A2(
		_user$project$Lang$eConst,
		_elm_lang$core$Basics$toFloat(model.randomColor),
		_user$project$Lang$dummyLoc);
};
var _user$project$Draw$randomColor = function (model) {
	return A2(
		_user$project$Lang$eConst0,
		_elm_lang$core$Basics$toFloat(model.randomColor),
		_user$project$Lang$dummyLoc);
};
var _user$project$Draw$addRawPolygon = F2(
	function (old, points) {
		var sPts = _user$project$Utils$bracks(
			_user$project$Utils$spaces(
				A3(
					_elm_lang$core$Basics$flip,
					_elm_lang$core$List$map,
					_elm_lang$core$List$reverse(points),
					function (_p70) {
						var _p71 = _p70;
						var xStr = _elm_lang$core$Basics$toString(_p71._0);
						var yStr = _elm_lang$core$Basics$toString(_p71._1);
						return _user$project$Utils$bracks(
							_user$project$Utils$spaces(
								{
									ctor: '::',
									_0: xStr,
									_1: {
										ctor: '::',
										_0: yStr,
										_1: {ctor: '[]'}
									}
								}));
					})));
		return A5(
			_user$project$Draw$add,
			'polygon',
			old,
			{
				ctor: '::',
				_0: A2(
					_user$project$Draw$makeLet,
					{
						ctor: '::',
						_0: 'pts',
						_1: {ctor: '[]'}
					},
					{
						ctor: '::',
						_0: _user$project$Lang$eRaw(sPts),
						_1: {ctor: '[]'}
					}),
				_1: {
					ctor: '::',
					_0: A2(
						_user$project$Draw$makeLet,
						{
							ctor: '::',
							_0: 'color',
							_1: {
								ctor: '::',
								_0: 'strokeColor',
								_1: {
									ctor: '::',
									_0: 'strokeWidth',
									_1: {ctor: '[]'}
								}
							}
						},
						{
							ctor: '::',
							_0: _user$project$Draw$randomColor(old),
							_1: {
								ctor: '::',
								_0: A2(_user$project$Lang$eConst, 360, _user$project$Lang$dummyLoc),
								_1: {
									ctor: '::',
									_0: A2(_user$project$Lang$eConst, 2, _user$project$Lang$dummyLoc),
									_1: {ctor: '[]'}
								}
							}
						}),
					_1: {ctor: '[]'}
				}
			},
			_user$project$Lang$eVar0('rawPolygon'),
			{
				ctor: '::',
				_0: _user$project$Lang$eVar('color'),
				_1: {
					ctor: '::',
					_0: _user$project$Lang$eVar('strokeColor'),
					_1: {
						ctor: '::',
						_0: _user$project$Lang$eVar('strokeWidth'),
						_1: {
							ctor: '::',
							_0: _user$project$Lang$eVar('pts'),
							_1: {
								ctor: '::',
								_0: A2(_user$project$Lang$eConst, 0, _user$project$Lang$dummyLoc),
								_1: {ctor: '[]'}
							}
						}
					}
				}
			});
	});
var _user$project$Draw$addAbsolutePath = F2(
	function (old, keysAndPoints) {
		var _p72 = A3(_user$project$Draw$pathCommands, _elm_lang$core$Basics$toString, _elm_lang$core$Basics$toString, keysAndPoints);
		var extraLets = _p72._0;
		var sD = _p72._1;
		return A5(
			_user$project$Draw$add,
			'path',
			old,
			A2(
				_elm_lang$core$Basics_ops['++'],
				{
					ctor: '::',
					_0: A2(
						_user$project$Draw$makeLet,
						{
							ctor: '::',
							_0: 'strokeColor',
							_1: {
								ctor: '::',
								_0: 'strokeWidth',
								_1: {
									ctor: '::',
									_0: 'color',
									_1: {ctor: '[]'}
								}
							}
						},
						{
							ctor: '::',
							_0: _user$project$Draw$randomColor(old),
							_1: {
								ctor: '::',
								_0: A2(_user$project$Lang$eConst, 5, _user$project$Lang$dummyLoc),
								_1: {
									ctor: '::',
									_0: _user$project$Draw$randomColor1(old),
									_1: {ctor: '[]'}
								}
							}
						}),
					_1: {ctor: '[]'}
				},
				A2(
					_elm_lang$core$Basics_ops['++'],
					extraLets,
					{
						ctor: '::',
						_0: A2(
							_user$project$Draw$makeLet,
							{
								ctor: '::',
								_0: 'd',
								_1: {ctor: '[]'}
							},
							{
								ctor: '::',
								_0: _user$project$Lang$eVar(sD),
								_1: {ctor: '[]'}
							}),
						_1: {ctor: '[]'}
					})),
			_user$project$Lang$eVar0('rawPath'),
			{
				ctor: '::',
				_0: _user$project$Lang$eVar('color'),
				_1: {
					ctor: '::',
					_0: _user$project$Lang$eVar('strokeColor'),
					_1: {
						ctor: '::',
						_0: _user$project$Lang$eVar('strokeWidth'),
						_1: {
							ctor: '::',
							_0: _user$project$Lang$eVar('d'),
							_1: {
								ctor: '::',
								_0: A2(_user$project$Lang$eConst, 0, _user$project$Lang$dummyLoc),
								_1: {ctor: '[]'}
							}
						}
					}
				}
			});
	});
var _user$project$Draw$strPt = function (_p73) {
	var _p74 = _p73;
	return _user$project$Utils$spaces(
		{
			ctor: '::',
			_0: _elm_lang$core$Basics$toString(_p74._0),
			_1: {
				ctor: '::',
				_0: _elm_lang$core$Basics$toString(_p74._1),
				_1: {ctor: '[]'}
			}
		});
};
var _user$project$Draw$slicesPerQuadrant = 2;
var _user$project$Draw$radiansPerSlice = _elm_lang$core$Basics$pi / (2 * _user$project$Draw$slicesPerQuadrant);
var _user$project$Draw$snapLine = F3(
	function (keysDown, _p76, _p75) {
		var _p77 = _p76;
		var _p83 = _p77._1._1;
		var _p82 = _p77._1._0;
		var _p78 = _p75;
		var _p81 = _p78._1._1;
		var _p80 = _p78._1._0;
		if (_elm_lang$core$Native_Utils.eq(
			keysDown,
			{
				ctor: '::',
				_0: _user$project$Keys$keyShift,
				_1: {ctor: '[]'}
			})) {
			var _p79 = {ctor: '_Tuple2', _0: _p82 - _p80, _1: _p83 - _p81};
			var dx = _p79._0;
			var dy = _p79._1;
			var angle = A2(
				_elm_lang$core$Basics$atan2,
				_elm_lang$core$Basics$toFloat(0 - dy),
				_elm_lang$core$Basics$toFloat(dx));
			var slice = _elm_lang$core$Basics$round(angle / _user$project$Draw$radiansPerSlice);
			var r = A2(
				_user$project$Utils$distanceInt,
				{ctor: '_Tuple2', _0: _p82, _1: _p83},
				{ctor: '_Tuple2', _0: _p80, _1: _p81});
			var xb = _elm_lang$core$Basics$toFloat(_p80) + (r * _elm_lang$core$Basics$cos(
				_elm_lang$core$Basics$toFloat(slice) * _user$project$Draw$radiansPerSlice));
			var yb = _elm_lang$core$Basics$toFloat(_p81) - (r * _elm_lang$core$Basics$sin(
				_elm_lang$core$Basics$toFloat(slice) * _user$project$Draw$radiansPerSlice));
			return {
				ctor: '_Tuple2',
				_0: _elm_lang$core$Basics$round(xb),
				_1: _elm_lang$core$Basics$round(yb)
			};
		} else {
			return {ctor: '_Tuple2', _0: _p82, _1: _p83};
		}
	});
var _user$project$Draw$addLine = F3(
	function (old, click2, click1) {
		var _p84 = {ctor: '_Tuple2', _0: click2, _1: click1};
		var x2 = _p84._0._1._0;
		var y2 = _p84._0._1._1;
		var x1 = _p84._1._1._0;
		var y1 = _p84._1._1._1;
		var _p85 = A3(_user$project$Draw$snapLine, old.keysDown, click2, click1);
		var xb = _p85._0;
		var yb = _p85._1;
		var color = _elm_lang$core$Native_Utils.eq(old.tool, _user$project$InterfaceModel$HelperLine) ? _user$project$Lang$eStr('aqua') : _user$project$Draw$randomColor(old);
		var _p86 = A3(
			_user$project$Draw$maybeGhost,
			_elm_lang$core$Native_Utils.eq(old.tool, _user$project$InterfaceModel$HelperLine),
			_user$project$Lang$eVar0('line'),
			A2(
				_elm_lang$core$List$map,
				_user$project$Lang$eVar,
				{
					ctor: '::',
					_0: 'color',
					_1: {
						ctor: '::',
						_0: 'width',
						_1: {
							ctor: '::',
							_0: 'x1',
							_1: {
								ctor: '::',
								_0: 'y1',
								_1: {
									ctor: '::',
									_0: 'x2',
									_1: {
										ctor: '::',
										_0: 'y2',
										_1: {ctor: '[]'}
									}
								}
							}
						}
					}
				}));
		var f = _p86._0;
		var args = _p86._1;
		return A5(
			_user$project$Draw$add,
			'line',
			old,
			{
				ctor: '::',
				_0: A2(
					_user$project$Draw$makeLet,
					{
						ctor: '::',
						_0: 'x1',
						_1: {
							ctor: '::',
							_0: 'y1',
							_1: {
								ctor: '::',
								_0: 'x2',
								_1: {
									ctor: '::',
									_0: 'y2',
									_1: {ctor: '[]'}
								}
							}
						}
					},
					_user$project$Draw$makeInts(
						{
							ctor: '::',
							_0: x1,
							_1: {
								ctor: '::',
								_0: y1,
								_1: {
									ctor: '::',
									_0: xb,
									_1: {
										ctor: '::',
										_0: yb,
										_1: {ctor: '[]'}
									}
								}
							}
						})),
				_1: {
					ctor: '::',
					_0: A2(
						_user$project$Draw$makeLet,
						{
							ctor: '::',
							_0: 'color',
							_1: {
								ctor: '::',
								_0: 'width',
								_1: {ctor: '[]'}
							}
						},
						{
							ctor: '::',
							_0: color,
							_1: {
								ctor: '::',
								_0: A2(_user$project$Lang$eConst, 5, _user$project$Lang$dummyLoc),
								_1: {ctor: '[]'}
							}
						}),
					_1: {ctor: '[]'}
				}
			},
			f,
			args);
	});
var _user$project$Draw$squareBoundingBox = F2(
	function (_p88, _p87) {
		var _p89 = _p88;
		var _p96 = _p89._1;
		var _p95 = _p89._0;
		var _p90 = _p87;
		var _p94 = _p90._1;
		var _p93 = _p90._0;
		var _p91 = {
			ctor: '_Tuple2',
			_0: _elm_lang$core$Basics$abs(_p95 - _p93),
			_1: _elm_lang$core$Basics$abs(_p96 - _p94)
		};
		var xDiff = _p91._0;
		var yDiff = _p91._1;
		var _p92 = {
			ctor: '_Tuple3',
			_0: _elm_lang$core$Native_Utils.cmp(yDiff, xDiff) > 0,
			_1: _elm_lang$core$Native_Utils.cmp(_p93, _p95) < 0,
			_2: _elm_lang$core$Native_Utils.cmp(_p94, _p96) < 0
		};
		if (_p92._0 === true) {
			if (_p92._1 === true) {
				return {
					ctor: '_Tuple4',
					_0: _p93,
					_1: _p93 + yDiff,
					_2: A2(_elm_lang$core$Basics$min, _p94, _p96),
					_3: A2(_elm_lang$core$Basics$max, _p94, _p96)
				};
			} else {
				return {
					ctor: '_Tuple4',
					_0: _p93 - yDiff,
					_1: _p93,
					_2: A2(_elm_lang$core$Basics$min, _p94, _p96),
					_3: A2(_elm_lang$core$Basics$max, _p94, _p96)
				};
			}
		} else {
			if (_p92._2 === true) {
				return {
					ctor: '_Tuple4',
					_0: A2(_elm_lang$core$Basics$min, _p93, _p95),
					_1: A2(_elm_lang$core$Basics$max, _p93, _p95),
					_2: _p94,
					_3: _p94 + xDiff
				};
			} else {
				return {
					ctor: '_Tuple4',
					_0: A2(_elm_lang$core$Basics$min, _p93, _p95),
					_1: A2(_elm_lang$core$Basics$max, _p93, _p95),
					_2: _p94 - xDiff,
					_3: _p94
				};
			}
		}
	});
var _user$project$Draw$addRawSquare = F3(
	function (old, _p98, _p97) {
		var _p99 = _p98;
		var _p100 = _p97;
		var _p101 = A2(_user$project$Draw$squareBoundingBox, _p99._1, _p100._1);
		var xa = _p101._0;
		var xb = _p101._1;
		var ya = _p101._2;
		var yb = _p101._3;
		var _p102 = {ctor: '_Tuple3', _0: xa, _1: ya, _2: xb - xa};
		var x = _p102._0;
		var y = _p102._1;
		var side = _p102._2;
		return A5(
			_user$project$Draw$add,
			'square',
			old,
			{
				ctor: '::',
				_0: A2(
					_user$project$Draw$makeLet,
					{
						ctor: '::',
						_0: 'x',
						_1: {
							ctor: '::',
							_0: 'y',
							_1: {
								ctor: '::',
								_0: 'side',
								_1: {ctor: '[]'}
							}
						}
					},
					_user$project$Draw$makeInts(
						{
							ctor: '::',
							_0: x,
							_1: {
								ctor: '::',
								_0: y,
								_1: {
									ctor: '::',
									_0: side,
									_1: {ctor: '[]'}
								}
							}
						})),
				_1: {
					ctor: '::',
					_0: A2(
						_user$project$Draw$makeLet,
						{
							ctor: '::',
							_0: 'color',
							_1: {
								ctor: '::',
								_0: 'rot',
								_1: {ctor: '[]'}
							}
						},
						{
							ctor: '::',
							_0: _user$project$Draw$randomColor(old),
							_1: {
								ctor: '::',
								_0: A2(_user$project$Lang$eConst, 0, _user$project$Lang$dummyLoc),
								_1: {ctor: '[]'}
							}
						}),
					_1: {ctor: '[]'}
				}
			},
			_user$project$Lang$eVar0('rawRect'),
			{
				ctor: '::',
				_0: _user$project$Lang$eVar('color'),
				_1: {
					ctor: '::',
					_0: A2(_user$project$Lang$eConst, 360, _user$project$Lang$dummyLoc),
					_1: {
						ctor: '::',
						_0: A2(_user$project$Lang$eConst, 0, _user$project$Lang$dummyLoc),
						_1: {
							ctor: '::',
							_0: _user$project$Lang$eVar('x'),
							_1: {
								ctor: '::',
								_0: _user$project$Lang$eVar('y'),
								_1: {
									ctor: '::',
									_0: _user$project$Lang$eVar('side'),
									_1: {
										ctor: '::',
										_0: _user$project$Lang$eVar('side'),
										_1: {
											ctor: '::',
											_0: _user$project$Lang$eVar('rot'),
											_1: {ctor: '[]'}
										}
									}
								}
							}
						}
					}
				}
			});
	});
var _user$project$Draw$addStretchySquare = F3(
	function (old, _p104, _p103) {
		var _p105 = _p104;
		var _p106 = _p103;
		var _p107 = A2(_user$project$Draw$squareBoundingBox, _p105._1, _p106._1);
		var xMin = _p107._0;
		var xMax = _p107._1;
		var yMin = _p107._2;
		var side = xMax - xMin;
		return A5(
			_user$project$Draw$add,
			'square',
			old,
			{
				ctor: '::',
				_0: A2(
					_user$project$Draw$makeLet,
					{
						ctor: '::',
						_0: 'left',
						_1: {
							ctor: '::',
							_0: 'top',
							_1: {
								ctor: '::',
								_0: 'side',
								_1: {ctor: '[]'}
							}
						}
					},
					_user$project$Draw$makeInts(
						{
							ctor: '::',
							_0: xMin,
							_1: {
								ctor: '::',
								_0: yMin,
								_1: {
									ctor: '::',
									_0: side,
									_1: {ctor: '[]'}
								}
							}
						})),
				_1: {
					ctor: '::',
					_0: A2(
						_user$project$Draw$makeLet,
						{
							ctor: '::',
							_0: 'bounds',
							_1: {ctor: '[]'}
						},
						{
							ctor: '::',
							_0: A2(
								_user$project$Lang$eList,
								_user$project$Lang$listOfRaw(
									{
										ctor: '::',
										_0: 'left',
										_1: {
											ctor: '::',
											_0: 'top',
											_1: {
												ctor: '::',
												_0: '(+ left side)',
												_1: {
													ctor: '::',
													_0: '(+ top side)',
													_1: {ctor: '[]'}
												}
											}
										}
									}),
								_elm_lang$core$Maybe$Nothing),
							_1: {ctor: '[]'}
						}),
					_1: {
						ctor: '::',
						_0: A2(
							_user$project$Draw$makeLet,
							{
								ctor: '::',
								_0: 'rot',
								_1: {ctor: '[]'}
							},
							{
								ctor: '::',
								_0: A2(_user$project$Lang$eConst, 0, _user$project$Lang$dummyLoc),
								_1: {ctor: '[]'}
							}),
						_1: {
							ctor: '::',
							_0: A2(
								_user$project$Draw$makeLet,
								{
									ctor: '::',
									_0: 'color',
									_1: {
										ctor: '::',
										_0: 'strokeColor',
										_1: {
											ctor: '::',
											_0: 'strokeWidth',
											_1: {ctor: '[]'}
										}
									}
								},
								{
									ctor: '::',
									_0: _user$project$Draw$randomColor(old),
									_1: {
										ctor: '::',
										_0: A2(_user$project$Lang$eConst, 360, _user$project$Lang$dummyLoc),
										_1: {
											ctor: '::',
											_0: A2(_user$project$Lang$eConst, 0, _user$project$Lang$dummyLoc),
											_1: {ctor: '[]'}
										}
									}
								}),
							_1: {ctor: '[]'}
						}
					}
				}
			},
			_user$project$Lang$eVar0('rectangle'),
			A2(
				_elm_lang$core$List$map,
				_user$project$Lang$eVar,
				{
					ctor: '::',
					_0: 'color',
					_1: {
						ctor: '::',
						_0: 'strokeColor',
						_1: {
							ctor: '::',
							_0: 'strokeWidth',
							_1: {
								ctor: '::',
								_0: 'rot',
								_1: {
									ctor: '::',
									_0: 'bounds',
									_1: {ctor: '[]'}
								}
							}
						}
					}
				}));
	});
var _user$project$Draw$addRawCircle = F3(
	function (old, _p109, _p108) {
		var _p110 = _p109;
		var _p111 = _p108;
		var _p112 = A2(_user$project$Draw$squareBoundingBox, _p110._1, _p111._1);
		var xa = _p112._0;
		var xb = _p112._1;
		var ya = _p112._2;
		var yb = _p112._3;
		var r = ((xb - xa) / 2) | 0;
		var _p113 = {ctor: '_Tuple2', _0: xa + r, _1: ya + r};
		var cx = _p113._0;
		var cy = _p113._1;
		return A5(
			_user$project$Draw$add,
			'circle',
			old,
			{
				ctor: '::',
				_0: A2(
					_user$project$Draw$makeLet,
					{
						ctor: '::',
						_0: 'cx',
						_1: {
							ctor: '::',
							_0: 'cy',
							_1: {
								ctor: '::',
								_0: 'r',
								_1: {ctor: '[]'}
							}
						}
					},
					_user$project$Draw$makeInts(
						{
							ctor: '::',
							_0: cx,
							_1: {
								ctor: '::',
								_0: cy,
								_1: {
									ctor: '::',
									_0: r,
									_1: {ctor: '[]'}
								}
							}
						})),
				_1: {
					ctor: '::',
					_0: A2(
						_user$project$Draw$makeLet,
						{
							ctor: '::',
							_0: 'color',
							_1: {ctor: '[]'}
						},
						{
							ctor: '::',
							_0: _user$project$Draw$randomColor1(old),
							_1: {ctor: '[]'}
						}),
					_1: {ctor: '[]'}
				}
			},
			_user$project$Lang$eVar0('rawCircle'),
			{
				ctor: '::',
				_0: _user$project$Lang$eVar('color'),
				_1: {
					ctor: '::',
					_0: A2(_user$project$Lang$eConst, 360, _user$project$Lang$dummyLoc),
					_1: {
						ctor: '::',
						_0: A2(_user$project$Lang$eConst, 0, _user$project$Lang$dummyLoc),
						_1: {
							ctor: '::',
							_0: _user$project$Lang$eVar('cx'),
							_1: {
								ctor: '::',
								_0: _user$project$Lang$eVar('cy'),
								_1: {
									ctor: '::',
									_0: _user$project$Lang$eVar('r'),
									_1: {ctor: '[]'}
								}
							}
						}
					}
				}
			});
	});
var _user$project$Draw$addStretchyCircle = F3(
	function (old, _p115, _p114) {
		var _p116 = _p115;
		var _p117 = _p114;
		var _p118 = A2(_user$project$Draw$squareBoundingBox, _p116._1, _p117._1);
		var left = _p118._0;
		var right = _p118._1;
		var top = _p118._2;
		return A5(
			_user$project$Draw$add,
			'circle',
			old,
			{
				ctor: '::',
				_0: A2(
					_user$project$Draw$makeLet,
					{
						ctor: '::',
						_0: 'left',
						_1: {
							ctor: '::',
							_0: 'top',
							_1: {
								ctor: '::',
								_0: 'r',
								_1: {ctor: '[]'}
							}
						}
					},
					_user$project$Draw$makeInts(
						{
							ctor: '::',
							_0: left,
							_1: {
								ctor: '::',
								_0: top,
								_1: {
									ctor: '::',
									_0: ((right - left) / 2) | 0,
									_1: {ctor: '[]'}
								}
							}
						})),
				_1: {
					ctor: '::',
					_0: A2(
						_user$project$Draw$makeLet,
						{
							ctor: '::',
							_0: 'bounds',
							_1: {ctor: '[]'}
						},
						{
							ctor: '::',
							_0: A2(
								_user$project$Lang$eList,
								{
									ctor: '::',
									_0: _user$project$Lang$eVar0('left'),
									_1: {
										ctor: '::',
										_0: _user$project$Lang$eVar('top'),
										_1: {
											ctor: '::',
											_0: _user$project$Lang$eRaw('(+ left (* 2! r))'),
											_1: {
												ctor: '::',
												_0: _user$project$Lang$eRaw('(+ top (* 2! r))'),
												_1: {ctor: '[]'}
											}
										}
									}
								},
								_elm_lang$core$Maybe$Nothing),
							_1: {ctor: '[]'}
						}),
					_1: {
						ctor: '::',
						_0: A2(
							_user$project$Draw$makeLet,
							{
								ctor: '::',
								_0: 'color',
								_1: {
									ctor: '::',
									_0: 'strokeColor',
									_1: {
										ctor: '::',
										_0: 'strokeWidth',
										_1: {ctor: '[]'}
									}
								}
							},
							{
								ctor: '::',
								_0: _user$project$Draw$randomColor(old),
								_1: {
									ctor: '::',
									_0: A2(_user$project$Lang$eConst, 360, _user$project$Lang$dummyLoc),
									_1: {
										ctor: '::',
										_0: A2(_user$project$Lang$eConst, 0, _user$project$Lang$dummyLoc),
										_1: {ctor: '[]'}
									}
								}
							}),
						_1: {ctor: '[]'}
					}
				}
			},
			_user$project$Lang$eVar0('oval'),
			A2(
				_elm_lang$core$List$map,
				_user$project$Lang$eVar,
				{
					ctor: '::',
					_0: 'color',
					_1: {
						ctor: '::',
						_0: 'strokeColor',
						_1: {
							ctor: '::',
							_0: 'strokeWidth',
							_1: {
								ctor: '::',
								_0: 'bounds',
								_1: {ctor: '[]'}
							}
						}
					}
				}));
	});
var _user$project$Draw$boundingBox = F2(
	function (_p120, _p119) {
		var _p121 = _p120;
		var _p126 = _p121._1;
		var _p125 = _p121._0;
		var _p122 = _p119;
		var _p124 = _p122._1;
		var _p123 = _p122._0;
		return {
			ctor: '_Tuple4',
			_0: A2(_elm_lang$core$Basics$min, _p123, _p125),
			_1: A2(_elm_lang$core$Basics$max, _p123, _p125),
			_2: A2(_elm_lang$core$Basics$min, _p124, _p126),
			_3: A2(_elm_lang$core$Basics$max, _p124, _p126)
		};
	});
var _user$project$Draw$addRawRect = F3(
	function (old, _p128, _p127) {
		var _p129 = _p128;
		var _p130 = _p127;
		var _p131 = A2(_user$project$Draw$boundingBox, _p129._1, _p130._1);
		var xa = _p131._0;
		var xb = _p131._1;
		var ya = _p131._2;
		var yb = _p131._3;
		var _p132 = {ctor: '_Tuple4', _0: xa, _1: ya, _2: xb - xa, _3: yb - ya};
		var x = _p132._0;
		var y = _p132._1;
		var w = _p132._2;
		var h = _p132._3;
		var _p133 = {ctor: '_Tuple3', _0: old.randomColor, _1: old.randomColor, _2: 0};
		var fill = _p133._0;
		var stroke = _p133._1;
		var strokeWidth = _p133._2;
		var rot = 0;
		return A3(
			_user$project$Draw$addShape,
			old,
			'rect',
			A8(_user$project$Draw$stencilRawRect, x, y, w, h, fill, stroke, strokeWidth, rot));
	});
var _user$project$Draw$addStretchyRect = F3(
	function (old, _p135, _p134) {
		var _p136 = _p135;
		var _p137 = _p134;
		var _p138 = A2(_user$project$Draw$boundingBox, _p136._1, _p137._1);
		var xMin = _p138._0;
		var xMax = _p138._1;
		var yMin = _p138._2;
		var yMax = _p138._3;
		var fill = old.randomColor;
		var _p139 = {ctor: '_Tuple3', _0: 360, _1: 0, _2: 0};
		var stroke = _p139._0;
		var strokeWidth = _p139._1;
		var rot = _p139._2;
		return A3(
			_user$project$Draw$addShape,
			old,
			'rect',
			A8(_user$project$Draw$stencilStretchyRect, xMin, yMin, xMax, yMax, fill, stroke, strokeWidth, rot));
	});
var _user$project$Draw$addRawOval = F3(
	function (old, _p141, _p140) {
		var _p142 = _p141;
		var _p143 = _p140;
		var _p144 = A2(_user$project$Draw$boundingBox, _p142._1, _p143._1);
		var xa = _p144._0;
		var xb = _p144._1;
		var ya = _p144._2;
		var yb = _p144._3;
		var _p145 = {ctor: '_Tuple2', _0: ((xb - xa) / 2) | 0, _1: ((yb - ya) / 2) | 0};
		var rx = _p145._0;
		var ry = _p145._1;
		var _p146 = {ctor: '_Tuple2', _0: xa + rx, _1: ya + ry};
		var cx = _p146._0;
		var cy = _p146._1;
		return A5(
			_user$project$Draw$add,
			'ellipse',
			old,
			{
				ctor: '::',
				_0: A2(
					_user$project$Draw$makeLet,
					{
						ctor: '::',
						_0: 'cx',
						_1: {
							ctor: '::',
							_0: 'cy',
							_1: {
								ctor: '::',
								_0: 'rx',
								_1: {
									ctor: '::',
									_0: 'ry',
									_1: {ctor: '[]'}
								}
							}
						}
					},
					_user$project$Draw$makeInts(
						{
							ctor: '::',
							_0: cx,
							_1: {
								ctor: '::',
								_0: cy,
								_1: {
									ctor: '::',
									_0: rx,
									_1: {
										ctor: '::',
										_0: ry,
										_1: {ctor: '[]'}
									}
								}
							}
						})),
				_1: {
					ctor: '::',
					_0: A2(
						_user$project$Draw$makeLet,
						{
							ctor: '::',
							_0: 'color',
							_1: {
								ctor: '::',
								_0: 'rot',
								_1: {ctor: '[]'}
							}
						},
						{
							ctor: '::',
							_0: _user$project$Draw$randomColor(old),
							_1: {
								ctor: '::',
								_0: A2(_user$project$Lang$eConst, 0, _user$project$Lang$dummyLoc),
								_1: {ctor: '[]'}
							}
						}),
					_1: {ctor: '[]'}
				}
			},
			_user$project$Lang$eVar0('rawEllipse'),
			{
				ctor: '::',
				_0: _user$project$Lang$eVar('color'),
				_1: {
					ctor: '::',
					_0: A2(_user$project$Lang$eConst, 360, _user$project$Lang$dummyLoc),
					_1: {
						ctor: '::',
						_0: A2(_user$project$Lang$eConst, 0, _user$project$Lang$dummyLoc),
						_1: {
							ctor: '::',
							_0: _user$project$Lang$eVar('cx'),
							_1: {
								ctor: '::',
								_0: _user$project$Lang$eVar('cy'),
								_1: {
									ctor: '::',
									_0: _user$project$Lang$eVar('rx'),
									_1: {
										ctor: '::',
										_0: _user$project$Lang$eVar('ry'),
										_1: {
											ctor: '::',
											_0: _user$project$Lang$eVar('rot'),
											_1: {ctor: '[]'}
										}
									}
								}
							}
						}
					}
				}
			});
	});
var _user$project$Draw$addStretchyOval = F3(
	function (old, _p148, _p147) {
		var _p149 = _p148;
		var _p150 = _p147;
		var _p151 = A2(_user$project$Draw$boundingBox, _p149._1, _p150._1);
		var xa = _p151._0;
		var xb = _p151._1;
		var ya = _p151._2;
		var yb = _p151._3;
		return A5(
			_user$project$Draw$add,
			'ellipse',
			old,
			{
				ctor: '::',
				_0: A3(
					_user$project$Draw$makeLetAs,
					'bounds',
					{
						ctor: '::',
						_0: 'left',
						_1: {
							ctor: '::',
							_0: 'top',
							_1: {
								ctor: '::',
								_0: 'right',
								_1: {
									ctor: '::',
									_0: 'bot',
									_1: {ctor: '[]'}
								}
							}
						}
					},
					_user$project$Draw$makeInts(
						{
							ctor: '::',
							_0: xa,
							_1: {
								ctor: '::',
								_0: ya,
								_1: {
									ctor: '::',
									_0: xb,
									_1: {
										ctor: '::',
										_0: yb,
										_1: {ctor: '[]'}
									}
								}
							}
						})),
				_1: {
					ctor: '::',
					_0: A2(
						_user$project$Draw$makeLet,
						{
							ctor: '::',
							_0: 'color',
							_1: {
								ctor: '::',
								_0: 'strokeColor',
								_1: {
									ctor: '::',
									_0: 'strokeWidth',
									_1: {ctor: '[]'}
								}
							}
						},
						{
							ctor: '::',
							_0: _user$project$Draw$randomColor(old),
							_1: {
								ctor: '::',
								_0: A2(_user$project$Lang$eConst, 360, _user$project$Lang$dummyLoc),
								_1: {
									ctor: '::',
									_0: A2(_user$project$Lang$eConst, 0, _user$project$Lang$dummyLoc),
									_1: {ctor: '[]'}
								}
							}
						}),
					_1: {ctor: '[]'}
				}
			},
			_user$project$Lang$eVar0('oval'),
			A2(
				_elm_lang$core$List$map,
				_user$project$Lang$eVar,
				{
					ctor: '::',
					_0: 'color',
					_1: {
						ctor: '::',
						_0: 'strokeColor',
						_1: {
							ctor: '::',
							_0: 'strokeWidth',
							_1: {
								ctor: '::',
								_0: 'bounds',
								_1: {ctor: '[]'}
							}
						}
					}
				}));
	});
var _user$project$Draw$addLambdaBounds = F4(
	function (old, _p153, _p152, func) {
		var _p154 = _p153;
		var _p159 = _p154._1;
		var _p155 = _p152;
		var _p158 = _p155._1;
		var _p156 = _elm_lang$core$Native_Utils.eq(
			old.keysDown,
			{
				ctor: '::',
				_0: _user$project$Keys$keyShift,
				_1: {ctor: '[]'}
			}) ? A2(_user$project$Draw$squareBoundingBox, _p159, _p158) : A2(_user$project$Draw$boundingBox, _p159, _p158);
		var xa = _p156._0;
		var xb = _p156._1;
		var ya = _p156._2;
		var yb = _p156._3;
		var bounds = A2(
			_user$project$Lang$eList,
			_user$project$Draw$makeInts(
				{
					ctor: '::',
					_0: xa,
					_1: {
						ctor: '::',
						_0: ya,
						_1: {
							ctor: '::',
							_0: xb,
							_1: {
								ctor: '::',
								_0: yb,
								_1: {ctor: '[]'}
							}
						}
					}
				}),
			_elm_lang$core$Maybe$Nothing);
		var args = {ctor: '[]'};
		var eNew = _user$project$Lang$withDummyExpInfo(
			A4(
				_user$project$Lang$EApp,
				_user$project$Lang$ws('\n  '),
				_user$project$Lang$eVar0('withBounds'),
				{
					ctor: '::',
					_0: bounds,
					_1: {
						ctor: '::',
						_0: func,
						_1: {ctor: '[]'}
					}
				},
				_user$project$Lang$space0));
		var newBlob = A2(
			_user$project$Blobs$withBoundsBlob,
			eNew,
			{ctor: '_Tuple3', _0: bounds, _1: 'XXXXX', _2: args});
		var _p157 = _user$project$Blobs$splitExp(old.inputExp);
		var defs = _p157._0;
		var mainExp = _p157._1;
		var mainExp_ = A2(_user$project$Draw$addToMainExp, newBlob, mainExp);
		var code = _user$project$LangUnparser$unparse(
			_user$project$Blobs$fuseExp(
				{ctor: '_Tuple2', _0: defs, _1: mainExp_}));
		return _elm_lang$core$Native_Utils.update(
			old,
			{code: code});
	});
var _user$project$Draw$addLambdaAnchor = F4(
	function (old, click2, click1, func) {
		var _p160 = A2(
			_user$project$Draw$boundingBox,
			_elm_lang$core$Tuple$second(click2),
			_elm_lang$core$Tuple$second(click1));
		var xa = _p160._0;
		var xb = _p160._1;
		var ya = _p160._2;
		var yb = _p160._3;
		var _p161 = {ctor: '_Tuple2', _0: ((xa + xb) / 2) | 0, _1: ((ya + yb) / 2) | 0};
		var x = _p161._0;
		var y = _p161._1;
		var anchor = _user$project$Draw$eAsPoint(
			A2(
				_user$project$Lang$eList,
				_user$project$Draw$makeInts(
					{
						ctor: '::',
						_0: x,
						_1: {
							ctor: '::',
							_0: y,
							_1: {ctor: '[]'}
						}
					}),
				_elm_lang$core$Maybe$Nothing));
		var args = {ctor: '[]'};
		var eNew = _user$project$Lang$withDummyExpInfo(
			A4(
				_user$project$Lang$EApp,
				_user$project$Lang$ws('\n  '),
				_user$project$Lang$eVar0('withAnchor'),
				{
					ctor: '::',
					_0: anchor,
					_1: {
						ctor: '::',
						_0: func,
						_1: {ctor: '[]'}
					}
				},
				_user$project$Lang$space0));
		var newBlob = A2(
			_user$project$Blobs$withAnchorBlob,
			eNew,
			{ctor: '_Tuple3', _0: anchor, _1: 'XXXXX', _2: args});
		var _p162 = _user$project$Blobs$splitExp(old.inputExp);
		var defs = _p162._0;
		var mainExp = _p162._1;
		var mainExp_ = A2(_user$project$Draw$addToMainExp, newBlob, mainExp);
		var code = _user$project$LangUnparser$unparse(
			_user$project$Blobs$fuseExp(
				{ctor: '_Tuple2', _0: defs, _1: mainExp_}));
		return _elm_lang$core$Native_Utils.update(
			old,
			{code: code});
	});
var _user$project$Draw$addLambda = F4(
	function (selectedIdx, old, pt2, pt1) {
		var exps = old.lambdaTools;
		var _p163 = A2(_user$project$Utils$geti, selectedIdx, exps);
		if (_p163.ctor === 'LambdaBounds') {
			return A4(_user$project$Draw$addLambdaBounds, old, pt2, pt1, _p163._0);
		} else {
			return A4(_user$project$Draw$addLambdaAnchor, old, pt2, pt1, _p163._0);
		}
	});
var _user$project$Draw$addTextBox = F3(
	function (old, click2, click1) {
		var _p164 = A2(
			_user$project$Draw$boundingBox,
			_elm_lang$core$Tuple$second(click2),
			_elm_lang$core$Tuple$second(click1));
		var xa = _p164._0;
		var xb = _p164._1;
		var ya = _p164._2;
		var yb = _p164._3;
		var fontSize = A2(
			_user$project$Lang$eConst0,
			_elm_lang$core$Basics$toFloat(yb - ya),
			_user$project$Lang$dummyLoc);
		return A5(
			_user$project$Draw$add,
			'text',
			old,
			{
				ctor: '::',
				_0: A2(
					_user$project$Draw$makeLet,
					{
						ctor: '::',
						_0: 'fontSize',
						_1: {
							ctor: '::',
							_0: 'textVal',
							_1: {ctor: '[]'}
						}
					},
					{
						ctor: '::',
						_0: fontSize,
						_1: {
							ctor: '::',
							_0: _user$project$Lang$eStr('Text'),
							_1: {ctor: '[]'}
						}
					}),
				_1: {ctor: '[]'}
			},
			_user$project$Lang$eVar0('simpleText'),
			{
				ctor: '::',
				_0: _user$project$Lang$eStr('Tahoma, sans-serif'),
				_1: {
					ctor: '::',
					_0: _user$project$Lang$eStr('black'),
					_1: {
						ctor: '::',
						_0: _user$project$Lang$eVar('fontSize'),
						_1: {
							ctor: '::',
							_0: A2(
								_user$project$Lang$eConst,
								_elm_lang$core$Basics$toFloat(xa),
								_user$project$Lang$dummyLoc),
							_1: {
								ctor: '::',
								_0: A2(
									_user$project$Lang$eConst,
									_elm_lang$core$Basics$toFloat(xb),
									_user$project$Lang$dummyLoc),
								_1: {
									ctor: '::',
									_0: A2(
										_user$project$Lang$eConst,
										_elm_lang$core$Basics$toFloat(yb),
										_user$project$Lang$dummyLoc),
									_1: {
										ctor: '::',
										_0: A2(_user$project$Lang$eConst, 1.5, _user$project$Lang$dummyLoc),
										_1: {
											ctor: '::',
											_0: _user$project$Lang$eVar('textVal'),
											_1: {ctor: '[]'}
										}
									}
								}
							}
						}
					}
				}
			});
	});
var _user$project$Draw$guideStroke = A2(_user$project$LangSvg$attr, 'stroke', 'aqua');
var _user$project$Draw$dotStrokeWidth = A2(_user$project$LangSvg$attr, 'stroke-width', '2');
var _user$project$Draw$dotStroke = A2(_user$project$LangSvg$attr, 'stroke', 'black');
var _user$project$Draw$drawDotSize = 10;
var _user$project$Draw$dotSize = A2(
	_user$project$LangSvg$attr,
	'r',
	_elm_lang$core$Basics$toString(_user$project$Draw$drawDotSize));
var _user$project$Draw$dotFillCursor = A2(_user$project$LangSvg$attr, 'fill', 'none');
var _user$project$Draw$dotFillControlPt = A2(_user$project$LangSvg$attr, 'fill', 'green');
var _user$project$Draw$dotFill2 = A2(_user$project$LangSvg$attr, 'fill', 'orange');
var _user$project$Draw$dotFill = A2(_user$project$LangSvg$attr, 'fill', 'red');
var _user$project$Draw$defaultFill = A2(_user$project$LangSvg$attr, 'fill', 'gray');
var _user$project$Draw$defaultStrokeWidth = A2(_user$project$LangSvg$attr, 'stroke-width', '5');
var _user$project$Draw$defaultStroke = A2(_user$project$LangSvg$attr, 'stroke', 'gray');
var _user$project$Draw$defaultOpacity = _elm_lang$html$Html_Attributes$style(
	{
		ctor: '::',
		_0: {ctor: '_Tuple2', _0: 'opacity', _1: '0.5'},
		_1: {ctor: '[]'}
	});
var _user$project$Draw$boundingBoxOfPoints_ = function (pts) {
	var _p165 = _elm_lang$core$List$unzip(pts);
	var xs = _p165._0;
	var ys = _p165._1;
	var xMax = _user$project$Utils$fromJust(
		_elm_lang$core$List$maximum(xs));
	var xMin = _user$project$Utils$fromJust(
		_elm_lang$core$List$minimum(xs));
	var yMax = _user$project$Utils$fromJust(
		_elm_lang$core$List$maximum(ys));
	var yMin = _user$project$Utils$fromJust(
		_elm_lang$core$List$minimum(ys));
	return {ctor: '_Tuple4', _0: xMin, _1: xMax, _2: yMin, _3: yMax};
};
var _user$project$Draw$boundingBoxOfPoints = function (pts) {
	var pts_ = A2(
		_elm_lang$core$List$map,
		function (_p166) {
			var _p167 = _p166;
			return {
				ctor: '_Tuple2',
				_0: _elm_lang$core$Basics$toFloat(_p167._0),
				_1: _elm_lang$core$Basics$toFloat(_p167._1)
			};
		},
		pts);
	var _p168 = _user$project$Draw$boundingBoxOfPoints_(pts_);
	var a = _p168._0;
	var b = _p168._1;
	var c = _p168._2;
	var d = _p168._3;
	return {
		ctor: '_Tuple4',
		_0: _elm_lang$core$Basics$round(a),
		_1: _elm_lang$core$Basics$round(b),
		_2: _elm_lang$core$Basics$round(c),
		_3: _elm_lang$core$Basics$round(d)
	};
};
var _user$project$Draw$addStretchablePolygon = F2(
	function (old, points) {
		var _p169 = _user$project$Draw$boundingBoxOfPoints(points);
		var xMin = _p169._0;
		var xMax = _p169._1;
		var yMin = _p169._2;
		var yMax = _p169._3;
		var _p170 = {ctor: '_Tuple2', _0: xMax - xMin, _1: yMax - yMin};
		var width = _p170._0;
		var height = _p170._1;
		var sPcts = _user$project$Utils$bracks(
			_user$project$Utils$spaces(
				A3(
					_elm_lang$core$Basics$flip,
					_elm_lang$core$List$map,
					_elm_lang$core$List$reverse(points),
					function (_p171) {
						var _p172 = _p171;
						var xPct = (_elm_lang$core$Basics$toFloat(_p172._0) - _elm_lang$core$Basics$toFloat(xMin)) / _elm_lang$core$Basics$toFloat(width);
						var yPct = (_elm_lang$core$Basics$toFloat(_p172._1) - _elm_lang$core$Basics$toFloat(yMin)) / _elm_lang$core$Basics$toFloat(height);
						var xStr = _user$project$Draw$maybeThaw(xPct);
						var yStr = _user$project$Draw$maybeThaw(yPct);
						return _user$project$Utils$bracks(
							_user$project$Utils$spaces(
								{
									ctor: '::',
									_0: xStr,
									_1: {
										ctor: '::',
										_0: yStr,
										_1: {ctor: '[]'}
									}
								}));
					})));
		return A5(
			_user$project$Draw$add,
			'polygon',
			old,
			{
				ctor: '::',
				_0: A3(
					_user$project$Draw$makeLetAs,
					'bounds',
					{
						ctor: '::',
						_0: 'left',
						_1: {
							ctor: '::',
							_0: 'top',
							_1: {
								ctor: '::',
								_0: 'right',
								_1: {
									ctor: '::',
									_0: 'bot',
									_1: {ctor: '[]'}
								}
							}
						}
					},
					_user$project$Draw$makeInts(
						{
							ctor: '::',
							_0: xMin,
							_1: {
								ctor: '::',
								_0: yMin,
								_1: {
									ctor: '::',
									_0: xMax,
									_1: {
										ctor: '::',
										_0: yMax,
										_1: {ctor: '[]'}
									}
								}
							}
						})),
				_1: {
					ctor: '::',
					_0: A2(
						_user$project$Draw$makeLet,
						{
							ctor: '::',
							_0: 'color',
							_1: {
								ctor: '::',
								_0: 'strokeColor',
								_1: {
									ctor: '::',
									_0: 'strokeWidth',
									_1: {ctor: '[]'}
								}
							}
						},
						{
							ctor: '::',
							_0: _user$project$Draw$randomColor(old),
							_1: {
								ctor: '::',
								_0: A2(_user$project$Lang$eConst, 360, _user$project$Lang$dummyLoc),
								_1: {
									ctor: '::',
									_0: A2(_user$project$Lang$eConst, 2, _user$project$Lang$dummyLoc),
									_1: {ctor: '[]'}
								}
							}
						}),
					_1: {
						ctor: '::',
						_0: A2(
							_user$project$Draw$makeLet,
							{
								ctor: '::',
								_0: 'pcts',
								_1: {ctor: '[]'}
							},
							{
								ctor: '::',
								_0: _user$project$Lang$eRaw(sPcts),
								_1: {ctor: '[]'}
							}),
						_1: {ctor: '[]'}
					}
				}
			},
			_user$project$Lang$eVar0('stretchyPolygon'),
			A2(
				_elm_lang$core$List$map,
				_user$project$Lang$eVar,
				{
					ctor: '::',
					_0: 'bounds',
					_1: {
						ctor: '::',
						_0: 'color',
						_1: {
							ctor: '::',
							_0: 'strokeColor',
							_1: {
								ctor: '::',
								_0: 'strokeWidth',
								_1: {
									ctor: '::',
									_0: 'pcts',
									_1: {ctor: '[]'}
								}
							}
						}
					}
				}));
	});
var _user$project$Draw$addStickyPolygon = F2(
	function (old, points) {
		var _p173 = _user$project$Draw$boundingBoxOfPoints(points);
		var xMin = _p173._0;
		var xMax = _p173._1;
		var yMin = _p173._2;
		var yMax = _p173._3;
		var _p174 = {ctor: '_Tuple2', _0: xMax - xMin, _1: yMax - yMin};
		var width = _p174._0;
		var height = _p174._1;
		var sOffsets = _user$project$Utils$bracks(
			_user$project$Utils$spaces(
				A3(
					_elm_lang$core$Basics$flip,
					_elm_lang$core$List$map,
					_elm_lang$core$List$reverse(points),
					function (_p175) {
						var _p176 = _p175;
						var _p180 = _p176._1;
						var _p179 = _p176._0;
						var _p177 = {ctor: '_Tuple2', _0: _p180 - yMin, _1: _p180 - yMax};
						var dyTop = _p177._0;
						var dyBot = _p177._1;
						var yOff = (_elm_lang$core$Native_Utils.cmp(
							dyTop,
							_elm_lang$core$Basics$abs(dyBot)) < 1) ? _user$project$Utils$bracks(
							_user$project$Utils$spaces(
								{
									ctor: '::',
									_0: 'top',
									_1: {
										ctor: '::',
										_0: _user$project$Draw$maybeThaw0(
											_elm_lang$core$Basics$toString(dyTop)),
										_1: {ctor: '[]'}
									}
								})) : _user$project$Utils$bracks(
							_user$project$Utils$spaces(
								{
									ctor: '::',
									_0: 'bot',
									_1: {
										ctor: '::',
										_0: _user$project$Draw$maybeThaw0(
											_elm_lang$core$Basics$toString(dyBot)),
										_1: {ctor: '[]'}
									}
								}));
						var _p178 = {ctor: '_Tuple2', _0: _p179 - xMin, _1: _p179 - xMax};
						var dxLeft = _p178._0;
						var dxRight = _p178._1;
						var xOff = (_elm_lang$core$Native_Utils.cmp(
							dxLeft,
							_elm_lang$core$Basics$abs(dxRight)) < 1) ? _user$project$Utils$bracks(
							_user$project$Utils$spaces(
								{
									ctor: '::',
									_0: 'left',
									_1: {
										ctor: '::',
										_0: _user$project$Draw$maybeThaw0(
											_elm_lang$core$Basics$toString(dxLeft)),
										_1: {ctor: '[]'}
									}
								})) : _user$project$Utils$bracks(
							_user$project$Utils$spaces(
								{
									ctor: '::',
									_0: 'right',
									_1: {
										ctor: '::',
										_0: _user$project$Draw$maybeThaw0(
											_elm_lang$core$Basics$toString(dxRight)),
										_1: {ctor: '[]'}
									}
								}));
						return _user$project$Utils$bracks(
							_user$project$Utils$spaces(
								{
									ctor: '::',
									_0: xOff,
									_1: {
										ctor: '::',
										_0: yOff,
										_1: {ctor: '[]'}
									}
								}));
					})));
		return A5(
			_user$project$Draw$add,
			'polygon',
			old,
			{
				ctor: '::',
				_0: A3(
					_user$project$Draw$makeLetAs,
					'bounds',
					{
						ctor: '::',
						_0: 'left',
						_1: {
							ctor: '::',
							_0: 'top',
							_1: {
								ctor: '::',
								_0: 'right',
								_1: {
									ctor: '::',
									_0: 'bot',
									_1: {ctor: '[]'}
								}
							}
						}
					},
					_user$project$Draw$makeInts(
						{
							ctor: '::',
							_0: xMin,
							_1: {
								ctor: '::',
								_0: yMin,
								_1: {
									ctor: '::',
									_0: xMax,
									_1: {
										ctor: '::',
										_0: yMax,
										_1: {ctor: '[]'}
									}
								}
							}
						})),
				_1: {
					ctor: '::',
					_0: A2(
						_user$project$Draw$makeLet,
						{
							ctor: '::',
							_0: 'color',
							_1: {
								ctor: '::',
								_0: 'strokeColor',
								_1: {
									ctor: '::',
									_0: 'strokeWidth',
									_1: {ctor: '[]'}
								}
							}
						},
						{
							ctor: '::',
							_0: _user$project$Draw$randomColor(old),
							_1: {
								ctor: '::',
								_0: A2(_user$project$Lang$eConst, 360, _user$project$Lang$dummyLoc),
								_1: {
									ctor: '::',
									_0: A2(_user$project$Lang$eConst, 2, _user$project$Lang$dummyLoc),
									_1: {ctor: '[]'}
								}
							}
						}),
					_1: {
						ctor: '::',
						_0: A2(
							_user$project$Draw$makeLet,
							{
								ctor: '::',
								_0: 'offsets',
								_1: {ctor: '[]'}
							},
							{
								ctor: '::',
								_0: _user$project$Lang$eRaw(sOffsets),
								_1: {ctor: '[]'}
							}),
						_1: {ctor: '[]'}
					}
				}
			},
			_user$project$Lang$eVar0('stickyPolygon'),
			A2(
				_elm_lang$core$List$map,
				_user$project$Lang$eVar,
				{
					ctor: '::',
					_0: 'bounds',
					_1: {
						ctor: '::',
						_0: 'color',
						_1: {
							ctor: '::',
							_0: 'strokeColor',
							_1: {
								ctor: '::',
								_0: 'strokeWidth',
								_1: {
									ctor: '::',
									_0: 'offsets',
									_1: {ctor: '[]'}
								}
							}
						}
					}
				}));
	});
var _user$project$Draw$addPolygon = F3(
	function (stk, old, points) {
		var _p181 = stk;
		switch (_p181.ctor) {
			case 'Raw':
				return A2(_user$project$Draw$addRawPolygon, old, points);
			case 'Stretchy':
				return A2(_user$project$Draw$addStretchablePolygon, old, points);
			default:
				return A2(_user$project$Draw$addStickyPolygon, old, points);
		}
	});
var _user$project$Draw$addStretchyPath = F2(
	function (old, keysAndPoints) {
		var points = A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$second, keysAndPoints);
		var _p182 = _user$project$Draw$boundingBoxOfPoints(points);
		var xMin = _p182._0;
		var xMax = _p182._1;
		var yMin = _p182._2;
		var yMax = _p182._3;
		var _p183 = {
			ctor: '_Tuple2',
			_0: _elm_lang$core$Basics$toFloat(xMax - xMin),
			_1: _elm_lang$core$Basics$toFloat(yMax - yMin)
		};
		var width = _p183._0;
		var height = _p183._1;
		var strX = function (x) {
			return _user$project$Draw$maybeThaw(
				_elm_lang$core$Basics$toFloat(x - xMin) / width);
		};
		var strY = function (y) {
			return _user$project$Draw$maybeThaw(
				_elm_lang$core$Basics$toFloat(y - yMin) / height);
		};
		var _p184 = A3(_user$project$Draw$pathCommands, strX, strY, keysAndPoints);
		var extraLets = _p184._0;
		var sD = _p184._1;
		return A5(
			_user$project$Draw$add,
			'path',
			old,
			A2(
				_elm_lang$core$Basics_ops['++'],
				{
					ctor: '::',
					_0: A3(
						_user$project$Draw$makeLetAs,
						'bounds',
						{
							ctor: '::',
							_0: 'left',
							_1: {
								ctor: '::',
								_0: 'top',
								_1: {
									ctor: '::',
									_0: 'right',
									_1: {
										ctor: '::',
										_0: 'bot',
										_1: {ctor: '[]'}
									}
								}
							}
						},
						_user$project$Draw$makeInts(
							{
								ctor: '::',
								_0: xMin,
								_1: {
									ctor: '::',
									_0: yMin,
									_1: {
										ctor: '::',
										_0: xMax,
										_1: {
											ctor: '::',
											_0: yMax,
											_1: {ctor: '[]'}
										}
									}
								}
							})),
					_1: {
						ctor: '::',
						_0: A2(
							_user$project$Draw$makeLet,
							{
								ctor: '::',
								_0: 'strokeColor',
								_1: {
									ctor: '::',
									_0: 'strokeWidth',
									_1: {
										ctor: '::',
										_0: 'color',
										_1: {ctor: '[]'}
									}
								}
							},
							{
								ctor: '::',
								_0: _user$project$Draw$randomColor(old),
								_1: {
									ctor: '::',
									_0: A2(_user$project$Lang$eConst, 5, _user$project$Lang$dummyLoc),
									_1: {
										ctor: '::',
										_0: _user$project$Draw$randomColor1(old),
										_1: {ctor: '[]'}
									}
								}
							}),
						_1: {ctor: '[]'}
					}
				},
				A2(
					_elm_lang$core$Basics_ops['++'],
					extraLets,
					{
						ctor: '::',
						_0: A2(
							_user$project$Draw$makeLet,
							{
								ctor: '::',
								_0: 'dPcts',
								_1: {ctor: '[]'}
							},
							{
								ctor: '::',
								_0: _user$project$Lang$eVar(sD),
								_1: {ctor: '[]'}
							}),
						_1: {ctor: '[]'}
					})),
			_user$project$Lang$eVar0('stretchyPath'),
			A2(
				_elm_lang$core$List$map,
				_user$project$Lang$eVar,
				{
					ctor: '::',
					_0: 'bounds',
					_1: {
						ctor: '::',
						_0: 'color',
						_1: {
							ctor: '::',
							_0: 'strokeColor',
							_1: {
								ctor: '::',
								_0: 'strokeWidth',
								_1: {
									ctor: '::',
									_0: 'dPcts',
									_1: {ctor: '[]'}
								}
							}
						}
					}
				}));
	});
var _user$project$Draw$addPath = F3(
	function (stk, old, keysAndPoints) {
		var _p185 = stk;
		switch (_p185.ctor) {
			case 'Raw':
				return A2(_user$project$Draw$addAbsolutePath, old, keysAndPoints);
			case 'Stretchy':
				return A2(_user$project$Draw$addStretchyPath, old, keysAndPoints);
			default:
				return A2(_user$project$Draw$addStretchyPath, old, keysAndPoints);
		}
	});
var _user$project$Draw$svgPath = A2(
	_elm_lang$core$Basics$flip,
	_elm_lang$svg$Svg$path,
	{ctor: '[]'});
var _user$project$Draw$svgPolygon = A2(
	_elm_lang$core$Basics$flip,
	_elm_lang$svg$Svg$polygon,
	{ctor: '[]'});
var _user$project$Draw$svgEllipse = A2(
	_elm_lang$core$Basics$flip,
	_elm_lang$svg$Svg$ellipse,
	{ctor: '[]'});
var _user$project$Draw$svgCircle = A2(
	_elm_lang$core$Basics$flip,
	_elm_lang$svg$Svg$circle,
	{ctor: '[]'});
var _user$project$Draw$drawDot = F2(
	function (fill, _p186) {
		var _p187 = _p186;
		return _user$project$Draw$svgCircle(
			{
				ctor: '::',
				_0: _user$project$Draw$dotSize,
				_1: {
					ctor: '::',
					_0: fill,
					_1: {
						ctor: '::',
						_0: _user$project$Draw$defaultOpacity,
						_1: {
							ctor: '::',
							_0: _user$project$Draw$dotStroke,
							_1: {
								ctor: '::',
								_0: _user$project$Draw$dotStrokeWidth,
								_1: {
									ctor: '::',
									_0: A2(
										_user$project$LangSvg$attr,
										'cx',
										_elm_lang$core$Basics$toString(_p187._0)),
									_1: {
										ctor: '::',
										_0: A2(
											_user$project$LangSvg$attr,
											'cy',
											_elm_lang$core$Basics$toString(_p187._1)),
										_1: {ctor: '[]'}
									}
								}
							}
						}
					}
				}
			});
	});
var _user$project$Draw$drawNewEllipse = F3(
	function (keysDown, _p189, _p188) {
		var _p190 = _p189;
		var _p195 = _p190._1;
		var _p191 = _p188;
		var _p194 = _p191._1;
		var _p192 = _elm_lang$core$Native_Utils.eq(
			keysDown,
			{
				ctor: '::',
				_0: _user$project$Keys$keyShift,
				_1: {ctor: '[]'}
			}) ? A2(_user$project$Draw$squareBoundingBox, _p195, _p194) : A2(_user$project$Draw$boundingBox, _p195, _p194);
		var xa = _p192._0;
		var xb = _p192._1;
		var ya = _p192._2;
		var yb = _p192._3;
		var _p193 = {ctor: '_Tuple2', _0: ((xb - xa) / 2) | 0, _1: ((yb - ya) / 2) | 0};
		var rx = _p193._0;
		var ry = _p193._1;
		var ellipse = _user$project$Draw$svgEllipse(
			{
				ctor: '::',
				_0: _user$project$Draw$defaultFill,
				_1: {
					ctor: '::',
					_0: _user$project$Draw$defaultOpacity,
					_1: {
						ctor: '::',
						_0: A2(
							_user$project$LangSvg$attr,
							'cx',
							_elm_lang$core$Basics$toString(xa + rx)),
						_1: {
							ctor: '::',
							_0: A2(
								_user$project$LangSvg$attr,
								'cy',
								_elm_lang$core$Basics$toString(ya + ry)),
							_1: {
								ctor: '::',
								_0: A2(
									_user$project$LangSvg$attr,
									'rx',
									_elm_lang$core$Basics$toString(rx)),
								_1: {
									ctor: '::',
									_0: A2(
										_user$project$LangSvg$attr,
										'ry',
										_elm_lang$core$Basics$toString(ry)),
									_1: {ctor: '[]'}
								}
							}
						}
					}
				}
			});
		var clearDots = A2(
			_elm_lang$core$List$map,
			_user$project$Draw$drawDot(_user$project$Draw$dotFillCursor),
			{
				ctor: '::',
				_0: {ctor: '_Tuple2', _0: xb, _1: yb},
				_1: {
					ctor: '::',
					_0: {ctor: '_Tuple2', _0: xa, _1: ya},
					_1: {
						ctor: '::',
						_0: _p195,
						_1: {
							ctor: '::',
							_0: _p194,
							_1: {ctor: '[]'}
						}
					}
				}
			});
		return A2(
			_elm_lang$core$Basics_ops['++'],
			clearDots,
			{
				ctor: '::',
				_0: ellipse,
				_1: {ctor: '[]'}
			});
	});
var _user$project$Draw$drawNewPolygon = F2(
	function (ptLast, points) {
		var _p196 = _user$project$Utils$last_(
			{ctor: '::', _0: ptLast, _1: points});
		var xInit = _p196._0;
		var yInit = _p196._1;
		var redDot = A2(
			_user$project$Draw$drawDot,
			_user$project$Draw$dotFill,
			{ctor: '_Tuple2', _0: xInit, _1: yInit});
		var clearDots = A2(
			_elm_lang$core$List$map,
			_user$project$Draw$drawDot(_user$project$Draw$dotFillCursor),
			{ctor: '::', _0: ptLast, _1: points});
		var maybeShape = function () {
			var _p197 = {ctor: '::', _0: ptLast, _1: points};
			if ((_p197.ctor === '::') && (_p197._1.ctor === '[]')) {
				return {ctor: '[]'};
			} else {
				var polyPoints = _elm_lang$core$List$reverse(
					{ctor: '::', _0: ptLast, _1: points});
				var sPoints = _user$project$Utils$spaces(
					A2(
						_elm_lang$core$List$map,
						function (_p198) {
							var _p199 = _p198;
							return A2(
								_elm_lang$core$String$join,
								',',
								A2(
									_elm_lang$core$List$map,
									_elm_lang$core$Basics$toString,
									{
										ctor: '::',
										_0: _p199._0,
										_1: {
											ctor: '::',
											_0: _p199._1,
											_1: {ctor: '[]'}
										}
									}));
						},
						polyPoints));
				return {
					ctor: '::',
					_0: _user$project$Draw$svgPolygon(
						{
							ctor: '::',
							_0: _user$project$Draw$defaultStroke,
							_1: {
								ctor: '::',
								_0: _user$project$Draw$defaultStrokeWidth,
								_1: {
									ctor: '::',
									_0: _user$project$Draw$defaultFill,
									_1: {
										ctor: '::',
										_0: _user$project$Draw$defaultOpacity,
										_1: {
											ctor: '::',
											_0: A2(_user$project$LangSvg$attr, 'points', sPoints),
											_1: {ctor: '[]'}
										}
									}
								}
							}
						}),
					_1: {ctor: '[]'}
				};
			}
		}();
		return {
			ctor: '::',
			_0: redDot,
			_1: A2(_elm_lang$core$Basics_ops['++'], clearDots, maybeShape)
		};
	});
var _user$project$Draw$drawNewPath = F2(
	function (_p200, keysAndPoints) {
		var _p201 = _p200;
		var _p216 = _p201._1;
		var points = A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$second, keysAndPoints);
		var redDot = {
			ctor: '::',
			_0: A2(
				_user$project$Draw$drawDot,
				_user$project$Draw$dotFill,
				_user$project$Utils$last_(
					{ctor: '::', _0: _p216, _1: points})),
			_1: {ctor: '[]'}
		};
		var yellowDot = function () {
			var _p202 = points;
			if (_p202.ctor === '[]') {
				return {ctor: '[]'};
			} else {
				return {
					ctor: '::',
					_0: A2(_user$project$Draw$drawDot, _user$project$Draw$dotFill2, _p216),
					_1: {ctor: '[]'}
				};
			}
		}();
		var pathAndPoints = function () {
			var plus = F2(
				function (_p204, _p203) {
					var _p205 = _p204;
					var _p206 = _p203;
					return {
						ctor: '_Tuple2',
						_0: A2(_elm_lang$core$Basics_ops['++'], _p205._0, _p206._0),
						_1: A2(_elm_lang$core$Basics_ops['++'], _p205._1, _p206._1)
					};
				});
			var foo = function (list0) {
				var _p207 = list0;
				if (_p207.ctor === '[]') {
					return {
						ctor: '_Tuple2',
						_0: '',
						_1: {ctor: '[]'}
					};
				} else {
					var _p213 = _p207._0._0;
					var _p212 = _p207._1;
					var _p211 = _p207._0._1;
					if (_elm_lang$core$Native_Utils.eq(_p213, _user$project$Keys$q)) {
						var _p208 = _p212;
						if (_p208.ctor === '[]') {
							return {
								ctor: '_Tuple2',
								_0: '',
								_1: {
									ctor: '::',
									_0: _p211,
									_1: {ctor: '[]'}
								}
							};
						} else {
							var cmd = _user$project$Utils$spaces(
								{
									ctor: '::',
									_0: ' Q',
									_1: {
										ctor: '::',
										_0: _user$project$Draw$strPt(_p211),
										_1: {
											ctor: '::',
											_0: _user$project$Draw$strPt(_p208._0._1),
											_1: {ctor: '[]'}
										}
									}
								});
							return A2(
								plus,
								{
									ctor: '_Tuple2',
									_0: cmd,
									_1: {
										ctor: '::',
										_0: _p211,
										_1: {ctor: '[]'}
									}
								},
								foo(_p208._1));
						}
					} else {
						if (_elm_lang$core$Native_Utils.eq(_p213, _user$project$Keys$c)) {
							var _p209 = _p212;
							if (_p209.ctor === '[]') {
								return {
									ctor: '_Tuple2',
									_0: '',
									_1: {
										ctor: '::',
										_0: _p211,
										_1: {ctor: '[]'}
									}
								};
							} else {
								if (_p209._1.ctor === '[]') {
									return {
										ctor: '_Tuple2',
										_0: '',
										_1: {
											ctor: '::',
											_0: _p211,
											_1: {
												ctor: '::',
												_0: _p209._0._1,
												_1: {ctor: '[]'}
											}
										}
									};
								} else {
									var _p210 = _p209._0._1;
									var cmd = _user$project$Utils$spaces(
										{
											ctor: '::',
											_0: ' C',
											_1: {
												ctor: '::',
												_0: _user$project$Draw$strPt(_p211),
												_1: {
													ctor: '::',
													_0: _user$project$Draw$strPt(_p210),
													_1: {
														ctor: '::',
														_0: _user$project$Draw$strPt(_p209._1._0._1),
														_1: {ctor: '[]'}
													}
												}
											}
										});
									return A2(
										plus,
										{
											ctor: '_Tuple2',
											_0: cmd,
											_1: {
												ctor: '::',
												_0: _p211,
												_1: {
													ctor: '::',
													_0: _p210,
													_1: {ctor: '[]'}
												}
											}
										},
										foo(_p209._1._1));
								}
							}
						} else {
							return A2(
								plus,
								{
									ctor: '_Tuple2',
									_0: _user$project$Utils$spaces(
										{
											ctor: '::',
											_0: ' L',
											_1: {
												ctor: '::',
												_0: _user$project$Draw$strPt(_p211),
												_1: {ctor: '[]'}
											}
										}),
									_1: {ctor: '[]'}
								},
								foo(_p212));
						}
					}
				}
			};
			var _p214 = _elm_lang$core$List$reverse(
				{
					ctor: '::',
					_0: {ctor: '_Tuple2', _0: _p201._0, _1: _p216},
					_1: keysAndPoints
				});
			if (_p214.ctor === '[]') {
				return {ctor: '[]'};
			} else {
				if (_p214._1.ctor === '[]') {
					return {ctor: '[]'};
				} else {
					var _p215 = A2(
						plus,
						{
							ctor: '_Tuple2',
							_0: _user$project$Utils$spaces(
								{
									ctor: '::',
									_0: 'M',
									_1: {
										ctor: '::',
										_0: _user$project$Draw$strPt(_p214._0._1),
										_1: {ctor: '[]'}
									}
								}),
							_1: {ctor: '[]'}
						},
						foo(_p214._1));
					var sPath = _p215._0;
					var controlPoints = _p215._1;
					var path = _user$project$Draw$svgPath(
						{
							ctor: '::',
							_0: _user$project$Draw$defaultStroke,
							_1: {
								ctor: '::',
								_0: _user$project$Draw$defaultStrokeWidth,
								_1: {
									ctor: '::',
									_0: _user$project$Draw$defaultFill,
									_1: {
										ctor: '::',
										_0: _user$project$Draw$defaultOpacity,
										_1: {
											ctor: '::',
											_0: A2(_user$project$LangSvg$attr, 'd', sPath),
											_1: {ctor: '[]'}
										}
									}
								}
							}
						});
					var points = A2(
						_elm_lang$core$List$map,
						_user$project$Draw$drawDot(_user$project$Draw$dotFillControlPt),
						controlPoints);
					return {ctor: '::', _0: path, _1: points};
				}
			}
		}();
		var clearDots = A2(
			_elm_lang$core$List$map,
			_user$project$Draw$drawDot(_user$project$Draw$dotFillCursor),
			{ctor: '::', _0: _p216, _1: points});
		return A2(
			_elm_lang$core$Basics_ops['++'],
			redDot,
			A2(
				_elm_lang$core$Basics_ops['++'],
				yellowDot,
				A2(_elm_lang$core$Basics_ops['++'], clearDots, pathAndPoints)));
	});
var _user$project$Draw$svgRect = A2(
	_elm_lang$core$Basics$flip,
	_elm_lang$svg$Svg$rect,
	{ctor: '[]'});
var _user$project$Draw$drawNewRect = F3(
	function (keysDown, _p218, _p217) {
		var _p219 = _p218;
		var _p223 = _p219._1;
		var _p220 = _p217;
		var _p222 = _p220._1;
		var _p221 = _elm_lang$core$Native_Utils.eq(
			keysDown,
			{
				ctor: '::',
				_0: _user$project$Keys$keyShift,
				_1: {ctor: '[]'}
			}) ? A2(_user$project$Draw$squareBoundingBox, _p223, _p222) : A2(_user$project$Draw$boundingBox, _p223, _p222);
		var xa = _p221._0;
		var xb = _p221._1;
		var ya = _p221._2;
		var yb = _p221._3;
		var rect = _user$project$Draw$svgRect(
			{
				ctor: '::',
				_0: _user$project$Draw$defaultFill,
				_1: {
					ctor: '::',
					_0: _user$project$Draw$defaultOpacity,
					_1: {
						ctor: '::',
						_0: A2(
							_user$project$LangSvg$attr,
							'x',
							_elm_lang$core$Basics$toString(xa)),
						_1: {
							ctor: '::',
							_0: A2(
								_user$project$LangSvg$attr,
								'width',
								_elm_lang$core$Basics$toString(xb - xa)),
							_1: {
								ctor: '::',
								_0: A2(
									_user$project$LangSvg$attr,
									'y',
									_elm_lang$core$Basics$toString(ya)),
								_1: {
									ctor: '::',
									_0: A2(
										_user$project$LangSvg$attr,
										'height',
										_elm_lang$core$Basics$toString(yb - ya)),
									_1: {ctor: '[]'}
								}
							}
						}
					}
				}
			});
		var clearDots = A2(
			_elm_lang$core$List$map,
			_user$project$Draw$drawDot(_user$project$Draw$dotFillCursor),
			{
				ctor: '::',
				_0: {ctor: '_Tuple2', _0: xb, _1: yb},
				_1: {
					ctor: '::',
					_0: {ctor: '_Tuple2', _0: xa, _1: ya},
					_1: {
						ctor: '::',
						_0: _p223,
						_1: {
							ctor: '::',
							_0: _p222,
							_1: {ctor: '[]'}
						}
					}
				}
			});
		return A2(
			_elm_lang$core$Basics_ops['++'],
			clearDots,
			{
				ctor: '::',
				_0: rect,
				_1: {ctor: '[]'}
			});
	});
var _user$project$Draw$svgLine = A2(
	_elm_lang$core$Basics$flip,
	_elm_lang$svg$Svg$line,
	{ctor: '[]'});
var _user$project$Draw$drawNewLine = F3(
	function (model, click2, click1) {
		var _p224 = {ctor: '_Tuple2', _0: click2, _1: click1};
		var x2 = _p224._0._1._0;
		var y2 = _p224._0._1._1;
		var x1 = _p224._1._1._0;
		var y1 = _p224._1._1._1;
		var stroke = _elm_lang$core$Native_Utils.eq(model.tool, _user$project$InterfaceModel$HelperLine) ? _user$project$Draw$guideStroke : _user$project$Draw$defaultStroke;
		var _p225 = A3(_user$project$Draw$snapLine, model.keysDown, click2, click1);
		var xb = _p225._0;
		var yb = _p225._1;
		var line = _user$project$Draw$svgLine(
			{
				ctor: '::',
				_0: stroke,
				_1: {
					ctor: '::',
					_0: _user$project$Draw$defaultStrokeWidth,
					_1: {
						ctor: '::',
						_0: _user$project$Draw$defaultOpacity,
						_1: {
							ctor: '::',
							_0: A2(
								_user$project$LangSvg$attr,
								'x1',
								_elm_lang$core$Basics$toString(x1)),
							_1: {
								ctor: '::',
								_0: A2(
									_user$project$LangSvg$attr,
									'y1',
									_elm_lang$core$Basics$toString(y1)),
								_1: {
									ctor: '::',
									_0: A2(
										_user$project$LangSvg$attr,
										'x2',
										_elm_lang$core$Basics$toString(xb)),
									_1: {
										ctor: '::',
										_0: A2(
											_user$project$LangSvg$attr,
											'y2',
											_elm_lang$core$Basics$toString(yb)),
										_1: {ctor: '[]'}
									}
								}
							}
						}
					}
				}
			});
		var clearDots = A2(
			_elm_lang$core$List$map,
			_user$project$Draw$drawDot(_user$project$Draw$dotFillCursor),
			{
				ctor: '::',
				_0: {ctor: '_Tuple2', _0: xb, _1: yb},
				_1: {
					ctor: '::',
					_0: {ctor: '_Tuple2', _0: x2, _1: y2},
					_1: {
						ctor: '::',
						_0: {ctor: '_Tuple2', _0: x1, _1: y1},
						_1: {ctor: '[]'}
					}
				}
			});
		return A2(
			_elm_lang$core$Basics_ops['++'],
			clearDots,
			{
				ctor: '::',
				_0: line,
				_1: {ctor: '[]'}
			});
	});
var _user$project$Draw$debugLog = _user$project$Config$debugLog(_user$project$Config$debugController);
var _user$project$Draw$lambdaToolOptionsOf = F2(
	function (_p226, finalEnv) {
		var _p227 = _p226;
		var _p228 = _p227._1;
		if (_p228.ctor === 'Blobs') {
			var lambdaPreFuncs = A2(
				_elm_lang$core$List$concatMap,
				function (_p229) {
					var _p230 = _p229;
					var _p231 = {ctor: '_Tuple2', _0: _p230._1.val.p__, _1: _p230._2.val.e__};
					if (((_p231.ctor === '_Tuple2') && (_p231._0.ctor === 'PVar')) && (_p231._1.ctor === 'EFun')) {
						var _p234 = _p231._0._1;
						var _p232 = _elm_lang$core$List$reverse(_p231._1._1);
						if (_p232.ctor === '::') {
							var _p233 = _user$project$Lang$varsOfPat(_p232._0);
							_v76_6:
							do {
								if (_p233.ctor === '::') {
									if (_p233._1.ctor === '[]') {
										switch (_p233._0) {
											case 'bounds':
												return {
													ctor: '::',
													_0: _user$project$Either$Left(_p234),
													_1: {ctor: '[]'}
												};
											case 'anchor':
												return {
													ctor: '::',
													_0: _user$project$Either$Right(_p234),
													_1: {ctor: '[]'}
												};
											default:
												break _v76_6;
										}
									} else {
										if (_p233._1._1.ctor === '[]') {
											if ((_p233._0 === 'xAnchor') && (_p233._1._0 === 'yAnchor')) {
												return {
													ctor: '::',
													_0: _user$project$Either$Right(_p234),
													_1: {ctor: '[]'}
												};
											} else {
												break _v76_6;
											}
										} else {
											if (_p233._1._1._1.ctor === '::') {
												if (_p233._1._1._1._1.ctor === '[]') {
													if ((((_p233._0 === 'left') && (_p233._1._0 === 'top')) && (_p233._1._1._0 === 'right')) && (_p233._1._1._1._0 === 'bot')) {
														return {
															ctor: '::',
															_0: _user$project$Either$Left(_p234),
															_1: {ctor: '[]'}
														};
													} else {
														break _v76_6;
													}
												} else {
													if ((((((_p233._0 === 'bounds') && (_p233._1._0 === 'left')) && (_p233._1._1._0 === 'top')) && (_p233._1._1._1._0 === 'right')) && (_p233._1._1._1._1._0 === 'bot')) && (_p233._1._1._1._1._1.ctor === '[]')) {
														return {
															ctor: '::',
															_0: _user$project$Either$Left(_p234),
															_1: {ctor: '[]'}
														};
													} else {
														break _v76_6;
													}
												}
											} else {
												if (((_p233._0 === 'anchor') && (_p233._1._0 === 'xAnchor')) && (_p233._1._1._0 === 'yAnchor')) {
													return {
														ctor: '::',
														_0: _user$project$Either$Right(_p234),
														_1: {ctor: '[]'}
													};
												} else {
													break _v76_6;
												}
											}
										}
									}
								} else {
									break _v76_6;
								}
							} while(false);
							return {ctor: '[]'};
						} else {
							return {ctor: '[]'};
						}
					} else {
						return {ctor: '[]'};
					}
				},
				_p227._0);
			var withBlobs = _elm_lang$core$List$reverse(
				A2(
					_elm_lang$core$List$concatMap,
					function (blob) {
						var _p235 = blob;
						_v77_2:
						do {
							if (_p235.ctor === 'NiceBlob') {
								switch (_p235._1.ctor) {
									case 'WithBoundsBlob':
										if (_p235._1._0.ctor === '_Tuple3') {
											return {
												ctor: '::',
												_0: _user$project$Either$Left(
													{ctor: '_Tuple2', _0: _p235._1._0._1, _1: _p235._1._0._2}),
												_1: {ctor: '[]'}
											};
										} else {
											break _v77_2;
										}
									case 'WithAnchorBlob':
										if (_p235._1._0.ctor === '_Tuple3') {
											return {
												ctor: '::',
												_0: _user$project$Either$Right(
													{ctor: '_Tuple2', _0: _p235._1._0._1, _1: _p235._1._0._2}),
												_1: {ctor: '[]'}
											};
										} else {
											break _v77_2;
										}
									default:
										break _v77_2;
								}
							} else {
								break _v77_2;
							}
						} while(false);
						return {ctor: '[]'};
					},
					_p228._0));
			var lambdaCalls = A2(
				_elm_lang$core$List$concatMap,
				function (preFunc) {
					var pred = function (withBlob) {
						var _p236 = {ctor: '_Tuple2', _0: preFunc, _1: withBlob};
						_v78_2:
						do {
							if (_p236.ctor === '_Tuple2') {
								if (_p236._0.ctor === 'Left') {
									if ((_p236._1.ctor === 'Left') && (_p236._1._0.ctor === '_Tuple2')) {
										return _elm_lang$core$Native_Utils.eq(_p236._0._0, _p236._1._0._0);
									} else {
										break _v78_2;
									}
								} else {
									if ((_p236._1.ctor === 'Right') && (_p236._1._0.ctor === '_Tuple2')) {
										return _elm_lang$core$Native_Utils.eq(_p236._0._0, _p236._1._0._0);
									} else {
										break _v78_2;
									}
								}
							} else {
								break _v78_2;
							}
						} while(false);
						return false;
					};
					var _p237 = A2(_user$project$Utils$findFirst, pred, withBlobs);
					if (_p237.ctor === 'Nothing') {
						return {ctor: '[]'};
					} else {
						if (_p237._0.ctor === 'Left') {
							return {
								ctor: '::',
								_0: _user$project$InterfaceModel$LambdaBounds(
									_user$project$Lang$withDummyExpInfo(
										A4(
											_user$project$Lang$EApp,
											_user$project$Lang$space1,
											_user$project$Lang$eVar0(_p237._0._0._0),
											_p237._0._0._1,
											_user$project$Lang$space0))),
								_1: {ctor: '[]'}
							};
						} else {
							var _p245 = _p237._0._0._0;
							var _p244 = _p237._0._0._1;
							var maybeViewBoxAndAnchor = function () {
								var _p238 = {ctor: '_Tuple2', _0: 100, _1: 100};
								var xAnchor = _p238._0;
								var yAnchor = _p238._1;
								var argsAndAnchor = A2(
									_elm_lang$core$Basics_ops['++'],
									_p244,
									{
										ctor: '::',
										_0: _user$project$Lang$eTuple(
											{
												ctor: '::',
												_0: _user$project$Lang$eConstDummyLoc(xAnchor),
												_1: {
													ctor: '::',
													_0: _user$project$Lang$eConstDummyLoc(yAnchor),
													_1: {ctor: '[]'}
												}
											}),
										_1: {ctor: '[]'}
									});
								var exp = _user$project$Lang$withDummyExpInfo(
									A4(
										_user$project$Lang$EApp,
										_user$project$Lang$space1,
										_user$project$Lang$eVar0(_p245),
										argsAndAnchor,
										_user$project$Lang$space0));
								var val = _elm_lang$core$Tuple$first(
									_elm_lang$core$Tuple$first(
										A2(
											_user$project$Utils$fromOkay,
											'lambdaToolOptionsOf LambdaAnchor',
											A2(_user$project$Eval$doEval, finalEnv, exp))));
								var _p239 = val.v_;
								if (((_p239.ctor === 'VList') && (_p239._0.ctor === '::')) && (_p239._0._1.ctor === '[]')) {
									var _p240 = _user$project$LangSvg$valToIndexedTree(_p239._0._0);
									if ((_p240.ctor === 'Ok') && (_p240._0.ctor === '_Tuple2')) {
										var _p241 = A2(_user$project$Utils$justGet, _p240._0._0, _p240._0._1);
										if ((_p241.ctor === 'SvgNode') && (_p241._0 === 'g')) {
											var _p242 = _user$project$LangSvg$maybeFindBounds(_p241._1);
											if (_p242.ctor === 'Just') {
												var _p243 = _p242._0;
												var left = _p243._0._0;
												var top = _p243._1._0;
												var right = _p243._2._0;
												var bot = _p243._3._0;
												return A2(
													_user$project$Draw$debugLog,
													'LambdaAnchor bounds found',
													_elm_lang$core$Maybe$Just(
														{
															width: _elm_lang$core$Basics$round(right - left),
															height: _elm_lang$core$Basics$round(bot - top),
															xAnchor: _elm_lang$core$Basics$round(xAnchor - left),
															yAnchor: _elm_lang$core$Basics$round(yAnchor - top)
														}));
											} else {
												return A2(_user$project$Draw$debugLog, 'LambdaAnchor bounds not found (4)', _elm_lang$core$Maybe$Nothing);
											}
										} else {
											return A2(_user$project$Draw$debugLog, 'LambdaAnchor bounds not found (3)', _elm_lang$core$Maybe$Nothing);
										}
									} else {
										return A2(_user$project$Draw$debugLog, 'LambdaAnchor bounds not found (2)', _elm_lang$core$Maybe$Nothing);
									}
								} else {
									return A2(_user$project$Draw$debugLog, 'LambdaAnchor bounds not found (1)', _elm_lang$core$Maybe$Nothing);
								}
							}();
							return {
								ctor: '::',
								_0: A2(
									_user$project$InterfaceModel$LambdaAnchor,
									_user$project$Lang$withDummyExpInfo(
										A4(
											_user$project$Lang$EApp,
											_user$project$Lang$space1,
											_user$project$Lang$eVar0(_p245),
											_p244,
											_user$project$Lang$space0)),
									maybeViewBoxAndAnchor),
								_1: {ctor: '[]'}
							};
						}
					}
				},
				lambdaPreFuncs);
			return lambdaCalls;
		} else {
			return {ctor: '[]'};
		}
	});

var _user$project$Canvas$turnOffCaptionAndHighlights = A2(
	_user$project$InterfaceModel$Msg,
	'Turn Off Caption',
	function (m) {
		var codeBoxInfo = m.codeBoxInfo;
		return _elm_lang$core$Native_Utils.update(
			m,
			{
				caption: _elm_lang$core$Maybe$Nothing,
				codeBoxInfo: _elm_lang$core$Native_Utils.update(
					codeBoxInfo,
					{
						highlights: {ctor: '[]'}
					})
			});
	});
var _user$project$Canvas$turnOnCaptionAndHighlights = function (zoneKey) {
	return A2(
		_user$project$InterfaceModel$Msg,
		A2(
			_elm_lang$core$Basics_ops['++'],
			'Turn On Caption ',
			_elm_lang$core$Basics$toString(zoneKey)),
		function (m) {
			var codeBoxInfo = m.codeBoxInfo;
			var hi = A2(_user$project$InterfaceModel$liveInfoToHighlights, zoneKey, m);
			return _elm_lang$core$Native_Utils.update(
				m,
				{
					caption: _elm_lang$core$Maybe$Just(
						_user$project$InterfaceModel$Hovering(zoneKey)),
					codeBoxInfo: _elm_lang$core$Native_Utils.update(
						codeBoxInfo,
						{highlights: hi})
				});
		});
};
var _user$project$Canvas$firstEqLast = function (xs) {
	return _elm_lang$core$Native_Utils.eq(
		_user$project$Utils$head_(xs),
		_user$project$Utils$head_(
			_elm_lang$core$List$reverse(xs)));
};
var _user$project$Canvas$toggleSelectedLambda = F2(
	function (nodeIdAndFeatures, model) {
		var deselect = A2(
			_elm_lang$core$List$all,
			A2(_elm_lang$core$Basics$flip, _elm_lang$core$Set$member, model.selectedFeatures),
			nodeIdAndFeatures);
		var updateSet = F2(
			function (nodeIdAndFeature, acc) {
				return deselect ? A2(_elm_lang$core$Set$remove, nodeIdAndFeature, acc) : A2(_elm_lang$core$Set$insert, nodeIdAndFeature, acc);
			});
		return _elm_lang$core$Native_Utils.update(
			model,
			{
				selectedFeatures: A3(_elm_lang$core$List$foldl, updateSet, model.selectedFeatures, nodeIdAndFeatures)
			});
	});
var _user$project$Canvas$toggleSelected = function (nodeIdAndFeatures) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Toggle Selected...',
		_user$project$Canvas$toggleSelectedLambda(nodeIdAndFeatures));
};
var _user$project$Canvas$hairStrokeWidth = '9';
var _user$project$Canvas$colorLineNotSelected = '#FAB4D3';
var _user$project$Canvas$colorLineSelected = '#B4FADB';
var _user$project$Canvas$colorPointNotSelected = '#F5B038';
var _user$project$Canvas$colorPointSelected = '#38F552';
var _user$project$Canvas$zoneDelete_ = F5(
	function (id, shape, x, y, transform) {
		var _p0 = {ctor: '_Tuple4', _0: 20, _1: 20, _2: 'silver', _3: '2'};
		var w = _p0._0;
		var h = _p0._1;
		var stroke = _p0._2;
		var strokeWidth = _p0._3;
		var evt = function () {
			var foo = function (old) {
				return _elm_lang$core$Native_Utils.update(
					old,
					{
						slate: A2(
							_elm_lang$core$Tuple$mapSecond,
							A2(_elm_lang$core$Dict$insert, id, _user$project$LangSvg$dummySvgNode),
							old.slate)
					});
			};
			return _elm_lang$svg$Svg_Events$onMouseDown(
				A2(_user$project$InterfaceModel$Msg, 'Delete...', foo));
		}();
		var lines = function () {
			var f = F4(
				function (x1, y1, x2, y2) {
					return A3(
						_elm_lang$core$Basics$flip,
						_elm_lang$svg$Svg$line,
						{ctor: '[]'},
						A2(
							_elm_lang$core$Basics_ops['++'],
							{
								ctor: '::',
								_0: A2(_user$project$LangSvg$attr, 'stroke', 'darkred'),
								_1: {
									ctor: '::',
									_0: A2(_user$project$LangSvg$attr, 'stroke-width', strokeWidth),
									_1: {
										ctor: '::',
										_0: A2(
											_user$project$LangSvg$attr,
											'x1',
											_elm_lang$core$Basics$toString(x1)),
										_1: {
											ctor: '::',
											_0: A2(
												_user$project$LangSvg$attr,
												'y1',
												_elm_lang$core$Basics$toString(y1)),
											_1: {
												ctor: '::',
												_0: A2(
													_user$project$LangSvg$attr,
													'x2',
													_elm_lang$core$Basics$toString(x2)),
												_1: {
													ctor: '::',
													_0: A2(
														_user$project$LangSvg$attr,
														'y2',
														_elm_lang$core$Basics$toString(y2)),
													_1: {
														ctor: '::',
														_0: evt,
														_1: {ctor: '[]'}
													}
												}
											}
										}
									}
								}
							},
							transform));
				});
			return {
				ctor: '::',
				_0: A4(f, x, y, x + w, y + h),
				_1: {
					ctor: '::',
					_0: A4(f, x, y + h, x + w, y),
					_1: {ctor: '[]'}
				}
			};
		}();
		var box = A3(
			_elm_lang$core$Basics$flip,
			_elm_lang$svg$Svg$rect,
			{ctor: '[]'},
			A2(
				_elm_lang$core$Basics_ops['++'],
				{
					ctor: '::',
					_0: A2(_user$project$LangSvg$attr, 'fill', 'white'),
					_1: {
						ctor: '::',
						_0: A2(_user$project$LangSvg$attr, 'stroke', stroke),
						_1: {
							ctor: '::',
							_0: A2(_user$project$LangSvg$attr, 'stroke-width', strokeWidth),
							_1: {
								ctor: '::',
								_0: A2(
									_user$project$LangSvg$attr,
									'x',
									_elm_lang$core$Basics$toString(x)),
								_1: {
									ctor: '::',
									_0: A2(
										_user$project$LangSvg$attr,
										'y',
										_elm_lang$core$Basics$toString(y)),
									_1: {
										ctor: '::',
										_0: A2(
											_user$project$LangSvg$attr,
											'width',
											_elm_lang$core$Basics$toString(w)),
										_1: {
											ctor: '::',
											_0: A2(
												_user$project$LangSvg$attr,
												'height',
												_elm_lang$core$Basics$toString(h)),
											_1: {
												ctor: '::',
												_0: evt,
												_1: {ctor: '[]'}
											}
										}
									}
								}
							}
						}
					}
				},
				transform));
		return A2(
			_elm_lang$core$Basics_ops['++'],
			{
				ctor: '::',
				_0: box,
				_1: {ctor: '[]'}
			},
			lines);
	});
var _user$project$Canvas$zoneDelete = F5(
	function (id, shape, x, y, transform) {
		var b = false;
		return b ? A5(_user$project$Canvas$zoneDelete_, id, shape, x, y, transform) : {ctor: '[]'};
	});
var _user$project$Canvas$maybeStrokeWidthNumAttr = function (l) {
	var _p1 = A2(_user$project$Utils$maybeFind, 'stroke-width', l);
	if (_p1.ctor === 'Just') {
		var _p2 = _p1._0.av_;
		if (_p2.ctor === 'ANum') {
			return _elm_lang$core$Maybe$Just(_p2._0);
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$Canvas$wStrokeWidthBox = _user$project$ShapeWidgets$wStrokeWidthSlider;
var _user$project$Canvas$wOpacityBox = _user$project$ShapeWidgets$wOpacitySlider;
var _user$project$Canvas$maybeColorNumAttr = F2(
	function (k, l) {
		var _p3 = A2(_user$project$Utils$maybeFind, k, l);
		if (_p3.ctor === 'Just') {
			var _p4 = _p3._0.av_;
			if ((_p4.ctor === 'AColorNum') && (_p4._0.ctor === '_Tuple2')) {
				return {
					ctor: '_Tuple2',
					_0: _elm_lang$core$Maybe$Just(_p4._0._0),
					_1: _p4._0._1
				};
			} else {
				return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _elm_lang$core$Maybe$Nothing};
			}
		} else {
			return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _elm_lang$core$Maybe$Nothing};
		}
	});
var _user$project$Canvas$hZoneColor = 20;
var _user$project$Canvas$wGradient = _user$project$ShapeWidgets$wColorSlider;
var _user$project$Canvas$projPt = function (_p5) {
	var _p6 = _p5;
	return {
		ctor: '_Tuple2',
		_0: _elm_lang$core$Tuple$first(_p6._0),
		_1: _elm_lang$core$Tuple$first(_p6._1)
	};
};
var _user$project$Canvas$distance = F2(
	function (_p8, _p7) {
		var _p9 = _p8;
		var _p10 = _p7;
		return _elm_lang$core$Basics$sqrt(
			Math.pow(_p10._0 - _p9._0, 2) + Math.pow(_p10._1 - _p9._1, 2));
	});
var _user$project$Canvas$distance_ = F2(
	function (pt1, pt2) {
		return A2(
			_user$project$Canvas$distance,
			_user$project$Canvas$projPt(pt1),
			_user$project$Canvas$projPt(pt2));
	});
var _user$project$Canvas$halfwayBetween = F2(
	function (_p12, _p11) {
		var _p13 = _p12;
		var _p14 = _p11;
		return {ctor: '_Tuple2', _0: (_p13._0 + _p14._0) / 2, _1: (_p13._1 + _p14._1) / 2};
	});
var _user$project$Canvas$halfwayBetween_ = F2(
	function (pt1, pt2) {
		return A2(
			_user$project$Canvas$halfwayBetween,
			_user$project$Canvas$projPt(pt1),
			_user$project$Canvas$projPt(pt2));
	});
var _user$project$Canvas$transformAttr = function (cmds) {
	return {
		ctor: '::',
		_0: A2(
			_user$project$LangSvg$compileAttr,
			'transform',
			_user$project$LangSvg$aTransform(cmds)),
		_1: {ctor: '[]'}
	};
};
var _user$project$Canvas$maybeTransformCmds = function (l) {
	var _p15 = A2(_user$project$Utils$maybeFind, 'transform', l);
	if (_p15.ctor === 'Just') {
		var _p16 = _p15._0.av_;
		if (_p16.ctor === 'ATransform') {
			return _elm_lang$core$Maybe$Just(_p16._0);
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$Canvas$maybeTransformAttr = function (l) {
	var _p17 = _user$project$Canvas$maybeTransformCmds(l);
	if (_p17.ctor === 'Just') {
		return _user$project$Canvas$transformAttr(_p17._0);
	} else {
		return {ctor: '[]'};
	}
};
var _user$project$Canvas$rotZoneDelta = 20;
var _user$project$Canvas$pointZoneStyles = {
	radius: '6',
	stroke: 'black',
	strokeWidth: '2',
	fill: {shown: 'white', selectedShape: 'yellow', selectedBlob: 'aqua', hidden: 'rgba(0,0,0,0.0)'}
};
var _user$project$Canvas$pointZoneStylesFillSelected = F2(
	function (model, nodeId) {
		var d = A2(
			_elm_lang$core$Dict$filter,
			F2(
				function (_p18, nodeId_) {
					return _elm_lang$core$Native_Utils.eq(nodeId, nodeId_);
				}),
			model.selectedBlobs);
		return _elm_lang$core$Dict$isEmpty(d) ? _user$project$Canvas$pointZoneStyles.fill.selectedShape : _user$project$Canvas$pointZoneStyles.fill.selectedBlob;
	});
var _user$project$Canvas$minLengthForMiddleZones = 30;
var _user$project$Canvas$objectZoneIsCurrentlyBeingManipulated = F3(
	function (model, nodeId, zonePred) {
		var _p19 = model.mouseMode;
		if ((_p19.ctor === 'MouseDragZone') && (_p19._0.ctor === '_Tuple3')) {
			return _elm_lang$core$Native_Utils.eq(nodeId, _p19._0._0) && zonePred(
				_user$project$ShapeWidgets$parseZone(_p19._0._2));
		} else {
			return false;
		}
	});
var _user$project$Canvas$objectIsCurrentlyBeingManipulated = F2(
	function (model, nodeId) {
		return A3(
			_user$project$Canvas$objectZoneIsCurrentlyBeingManipulated,
			model,
			nodeId,
			_elm_lang$core$Basics$always(true));
	});
var _user$project$Canvas$isRotateZone = function (realZone) {
	var _p20 = realZone;
	if ((_p20.ctor === 'ZOther') && (_p20._0.ctor === 'Rotation')) {
		return true;
	} else {
		return false;
	}
};
var _user$project$Canvas$isFillStrokeZone = function (realZone) {
	var _p21 = realZone;
	_v14_5:
	do {
		if (_p21.ctor === 'ZOther') {
			switch (_p21._0.ctor) {
				case 'FillColor':
					return true;
				case 'StrokeColor':
					return true;
				case 'FillOpacity':
					return true;
				case 'StrokeOpacity':
					return true;
				case 'StrokeWidth':
					return true;
				default:
					break _v14_5;
			}
		} else {
			break _v14_5;
		}
	} while(false);
	return false;
};
var _user$project$Canvas$isPrimaryZone = function (realZone) {
	var _p22 = realZone;
	switch (_p22.ctor) {
		case 'ZOther':
			switch (_p22._0.ctor) {
				case 'FillColor':
					return false;
				case 'StrokeColor':
					return false;
				case 'FillOpacity':
					return false;
				case 'StrokeOpacity':
					return false;
				case 'StrokeWidth':
					return false;
				default:
					return false;
			}
		case 'ZSlider':
			return false;
		default:
			return true;
	}
};
var _user$project$Canvas$cursorStyle = function (s) {
	return A2(_user$project$LangSvg$attr, 'cursor', s);
};
var _user$project$Canvas$cursorOfZone = F2(
	function (realZone, $default) {
		var _p23 = realZone;
		_v16_14:
		do {
			switch (_p23.ctor) {
				case 'ZInterior':
					return _user$project$Canvas$cursorStyle('move');
				case 'ZPoint':
					switch (_p23._0.ctor) {
						case 'LonePoint':
							return _user$project$Canvas$cursorStyle('move');
						case 'LeftEdge':
							return _user$project$Canvas$cursorStyle('ew-resize');
						case 'RightEdge':
							return _user$project$Canvas$cursorStyle('ew-resize');
						case 'TopLeft':
							return _user$project$Canvas$cursorStyle('nwse-resize');
						case 'BotRight':
							return _user$project$Canvas$cursorStyle('nwse-resize');
						case 'TopEdge':
							return _user$project$Canvas$cursorStyle('ns-resize');
						case 'BotEdge':
							return _user$project$Canvas$cursorStyle('ns-resize');
						case 'BotLeft':
							return _user$project$Canvas$cursorStyle('nesw-resize');
						case 'TopRight':
							return _user$project$Canvas$cursorStyle('nesw-resize');
						default:
							break _v16_14;
					}
				case 'ZLineEdge':
					return _user$project$Canvas$cursorStyle('pointer');
				case 'ZPolyEdge':
					return _user$project$Canvas$cursorStyle('pointer');
				case 'ZOther':
					return _user$project$Canvas$cursorStyle('pointer');
				case 'ZSlider':
					return _user$project$Canvas$cursorStyle('pointer');
				default:
					break _v16_14;
			}
		} while(false);
		return _user$project$Canvas$cursorStyle($default);
	});
var _user$project$Canvas$removeHoveredCrosshair = function (tuple) {
	return A2(
		_user$project$InterfaceModel$Msg,
		A2(
			_elm_lang$core$Basics_ops['++'],
			'Remove Hovered Crosshair ',
			_elm_lang$core$Basics$toString(tuple)),
		function (m) {
			return _elm_lang$core$Native_Utils.update(
				m,
				{
					hoveredCrosshairs: A2(_elm_lang$core$Set$remove, tuple, m.hoveredCrosshairs)
				});
		});
};
var _user$project$Canvas$addHoveredCrosshair = function (tuple) {
	return A2(
		_user$project$InterfaceModel$Msg,
		A2(
			_elm_lang$core$Basics_ops['++'],
			'Add Hovered Crosshair ',
			_elm_lang$core$Basics$toString(tuple)),
		function (m) {
			return _elm_lang$core$Native_Utils.update(
				m,
				{
					hoveredCrosshairs: A2(_elm_lang$core$Set$insert, tuple, m.hoveredCrosshairs)
				});
		});
};
var _user$project$Canvas$addHoveredShape = function (id) {
	return A2(
		_user$project$InterfaceModel$Msg,
		A2(
			_elm_lang$core$Basics_ops['++'],
			'Add Hovered Shape ',
			_elm_lang$core$Basics$toString(id)),
		function (m) {
			return _elm_lang$core$Native_Utils.update(
				m,
				{
					hoveredShapes: _elm_lang$core$Set$singleton(id)
				});
		});
};
var _user$project$Canvas$removeHoveredShape = function (id) {
	return A2(
		_user$project$InterfaceModel$Msg,
		A2(
			_elm_lang$core$Basics_ops['++'],
			'Remove Hovered Shape ',
			_elm_lang$core$Basics$toString(id)),
		function (m) {
			return _elm_lang$core$Native_Utils.update(
				m,
				{
					hoveredShapes: A2(_elm_lang$core$Set$remove, id, m.hoveredShapes)
				});
		});
};
var _user$project$Canvas$onMouseDownAndStop = _user$project$HtmlUtils$handleEventAndStop('mousedown');
var _user$project$Canvas$attrNumTr = F2(
	function (k, nt) {
		return A2(
			_user$project$LangSvg$compileAttr,
			k,
			_user$project$LangSvg$aNum(nt));
	});
var _user$project$Canvas$attrNum = F2(
	function (k, n) {
		return A2(
			_user$project$LangSvg$compileAttr,
			k,
			_user$project$LangSvg$aNum(
				{ctor: '_Tuple2', _0: n, _1: _user$project$Lang$dummyTrace}));
	});
var _user$project$Canvas$svgOffsetWidget1DArrowPartsAndEndPoint = F7(
	function (_p24, axis, sign, amount, maybeCaptionText, isSelected, extraStyles) {
		var _p25 = _p24;
		var _p35 = _p25._1;
		var _p34 = _p25._0;
		var effectiveAmount = function () {
			var _p26 = sign;
			if (_p26.ctor === 'Positive') {
				return amount;
			} else {
				return 0 - amount;
			}
		}();
		var _p27 = function () {
			var _p28 = axis;
			if (_p28.ctor === 'X') {
				return {ctor: '_Tuple2', _0: _p34 + effectiveAmount, _1: _p35};
			} else {
				return {ctor: '_Tuple2', _0: _p34, _1: _p35 + effectiveAmount};
			}
		}();
		var endX = _p27._0;
		var endY = _p27._1;
		var lineStyle = isSelected ? {
			ctor: '::',
			_0: A2(_user$project$LangSvg$attr, 'stroke', _user$project$Canvas$colorPointSelected),
			_1: {
				ctor: '::',
				_0: A2(_user$project$LangSvg$attr, 'stroke-width', '5px'),
				_1: {ctor: '[]'}
			}
		} : {
			ctor: '::',
			_0: A2(_user$project$LangSvg$attr, 'stroke', 'black'),
			_1: {
				ctor: '::',
				_0: A2(_user$project$LangSvg$attr, 'stroke-width', '1px'),
				_1: {
					ctor: '::',
					_0: A2(_user$project$LangSvg$attr, 'stroke-dasharray', '1,1'),
					_1: {ctor: '[]'}
				}
			}
		};
		var line = A3(
			_elm_lang$core$Basics$flip,
			_elm_lang$svg$Svg$line,
			{ctor: '[]'},
			A2(
				_elm_lang$core$Basics_ops['++'],
				{
					ctor: '::',
					_0: A2(_user$project$Canvas$attrNum, 'x1', _p34),
					_1: {
						ctor: '::',
						_0: A2(_user$project$Canvas$attrNum, 'y1', _p35),
						_1: {
							ctor: '::',
							_0: A2(_user$project$Canvas$attrNum, 'x2', endX),
							_1: {
								ctor: '::',
								_0: A2(_user$project$Canvas$attrNum, 'y2', endY),
								_1: {ctor: '[]'}
							}
						}
					}
				},
				A2(_elm_lang$core$Basics_ops['++'], lineStyle, extraStyles)));
		var endArrow = function () {
			var arrowOffset = 12;
			var _p29 = function () {
				var _p30 = {
					ctor: '_Tuple2',
					_0: axis,
					_1: _user$project$Utils$sgn(effectiveAmount)
				};
				_v20_3:
				do {
					if (_p30.ctor === '_Tuple2') {
						if (_p30._0.ctor === 'X') {
							switch (_p30._1) {
								case 1:
									return {
										ctor: '_Tuple4',
										_0: F2(
											function (x, y) {
												return x - y;
											}),
										_1: F2(
											function (x, y) {
												return x - y;
											}),
										_2: F2(
											function (x, y) {
												return x - y;
											}),
										_3: F2(
											function (x, y) {
												return x + y;
											})
									};
								case -1:
									return {
										ctor: '_Tuple4',
										_0: F2(
											function (x, y) {
												return x + y;
											}),
										_1: F2(
											function (x, y) {
												return x - y;
											}),
										_2: F2(
											function (x, y) {
												return x + y;
											}),
										_3: F2(
											function (x, y) {
												return x + y;
											})
									};
								default:
									break _v20_3;
							}
						} else {
							if (_p30._1 === 1) {
								return {
									ctor: '_Tuple4',
									_0: F2(
										function (x, y) {
											return x - y;
										}),
									_1: F2(
										function (x, y) {
											return x - y;
										}),
									_2: F2(
										function (x, y) {
											return x + y;
										}),
									_3: F2(
										function (x, y) {
											return x - y;
										})
								};
							} else {
								break _v20_3;
							}
						}
					} else {
						break _v20_3;
					}
				} while(false);
				return {
					ctor: '_Tuple4',
					_0: F2(
						function (x, y) {
							return x - y;
						}),
					_1: F2(
						function (x, y) {
							return x + y;
						}),
					_2: F2(
						function (x, y) {
							return x + y;
						}),
					_3: F2(
						function (x, y) {
							return x + y;
						})
				};
			}();
			var opX1 = _p29._0;
			var opY1 = _p29._1;
			var opX2 = _p29._2;
			var opY2 = _p29._3;
			return A3(
				_elm_lang$core$Basics$flip,
				_elm_lang$svg$Svg$polyline,
				{ctor: '[]'},
				A2(
					_elm_lang$core$Basics_ops['++'],
					{
						ctor: '::',
						_0: A2(_user$project$LangSvg$attr, 'fill', 'rgba(0,0,0,0.0)'),
						_1: {
							ctor: '::',
							_0: A2(_user$project$LangSvg$attr, 'cursor', 'pointer'),
							_1: {
								ctor: '::',
								_0: A2(
									_user$project$LangSvg$attr,
									'points',
									A2(
										_elm_lang$core$Basics_ops['++'],
										_elm_lang$core$Basics$toString(
											A2(opX1, endX, arrowOffset)),
										A2(
											_elm_lang$core$Basics_ops['++'],
											',',
											A2(
												_elm_lang$core$Basics_ops['++'],
												_elm_lang$core$Basics$toString(
													A2(opY1, endY, arrowOffset)),
												A2(
													_elm_lang$core$Basics_ops['++'],
													' ',
													A2(
														_elm_lang$core$Basics_ops['++'],
														_elm_lang$core$Basics$toString(endX),
														A2(
															_elm_lang$core$Basics_ops['++'],
															',',
															A2(
																_elm_lang$core$Basics_ops['++'],
																_elm_lang$core$Basics$toString(endY),
																A2(
																	_elm_lang$core$Basics_ops['++'],
																	' ',
																	A2(
																		_elm_lang$core$Basics_ops['++'],
																		_elm_lang$core$Basics$toString(
																			A2(opX2, endX, arrowOffset)),
																		A2(
																			_elm_lang$core$Basics_ops['++'],
																			',',
																			A2(
																				_elm_lang$core$Basics_ops['++'],
																				_elm_lang$core$Basics$toString(
																					A2(opY2, endY, arrowOffset)),
																				' ')))))))))))),
								_1: {ctor: '[]'}
							}
						}
					},
					A2(_elm_lang$core$Basics_ops['++'], lineStyle, extraStyles)));
		}();
		var caption = function () {
			var string = function () {
				var _p31 = maybeCaptionText;
				if (_p31.ctor === 'Just') {
					return _p31._0;
				} else {
					return _elm_lang$core$Basics$toString(amount);
				}
			}();
			var _p32 = function () {
				var _p33 = axis;
				if (_p33.ctor === 'X') {
					return {ctor: '_Tuple3', _0: (_p34 + endX) / 2, _1: _p35 - 10, _2: 'middle'};
				} else {
					return {ctor: '_Tuple3', _0: _p34 + 10, _1: (_p35 + endY) / 2, _2: 'start'};
				}
			}();
			var x = _p32._0;
			var y = _p32._1;
			var textAnchor = _p32._2;
			return A3(
				_elm_lang$core$Basics$flip,
				_elm_lang$svg$Svg$text_,
				{
					ctor: '::',
					_0: _elm_lang$virtual_dom$VirtualDom$text(string),
					_1: {ctor: '[]'}
				},
				A2(
					_elm_lang$core$Basics_ops['++'],
					{
						ctor: '::',
						_0: A2(_user$project$LangSvg$attr, 'font-family', _user$project$Config$params.mainSection.uiWidgets.font),
						_1: {
							ctor: '::',
							_0: A2(_user$project$LangSvg$attr, 'font-size', _user$project$Config$params.mainSection.uiWidgets.fontSize),
							_1: {
								ctor: '::',
								_0: A2(_user$project$LangSvg$attr, 'text-anchor', textAnchor),
								_1: {
									ctor: '::',
									_0: A2(
										_user$project$LangSvg$attr,
										'x',
										_elm_lang$core$Basics$toString(x)),
									_1: {
										ctor: '::',
										_0: A2(
											_user$project$LangSvg$attr,
											'y',
											_elm_lang$core$Basics$toString(y)),
										_1: {ctor: '[]'}
									}
								}
							}
						}
					},
					extraStyles));
		}();
		return {
			ctor: '_Tuple2',
			_0: {
				ctor: '::',
				_0: line,
				_1: {
					ctor: '::',
					_0: caption,
					_1: {
						ctor: '::',
						_0: endArrow,
						_1: {ctor: '[]'}
					}
				}
			},
			_1: {ctor: '_Tuple2', _0: endX, _1: endY}
		};
	});
var _user$project$Canvas$msgMouseClickCanvas = A2(
	_user$project$InterfaceModel$Msg,
	'MouseClickCanvas',
	function (old) {
		var _p36 = {ctor: '_Tuple2', _0: old.tool, _1: old.mouseMode};
		_v23_3:
		do {
			_v23_1:
			do {
				if (_p36.ctor === '_Tuple2') {
					if (_p36._0.ctor === 'Cursor') {
						switch (_p36._1.ctor) {
							case 'MouseDragZone':
								return old;
							case 'MouseNothing':
								break _v23_1;
							default:
								break _v23_1;
						}
					} else {
						if (_p36._1.ctor === 'MouseNothing') {
							return _elm_lang$core$Native_Utils.update(
								old,
								{
									mouseMode: _user$project$InterfaceModel$MouseDrawNew(_user$project$InterfaceModel$NoPointsYet),
									selectedShapes: _elm_lang$core$Set$empty,
									selectedBlobs: _elm_lang$core$Dict$empty
								});
						} else {
							break _v23_3;
						}
					}
				} else {
					break _v23_3;
				}
			} while(false);
			return _elm_lang$core$Native_Utils.update(
				old,
				{selectedShapes: _elm_lang$core$Set$empty, selectedBlobs: _elm_lang$core$Dict$empty});
		} while(false);
		return old;
	});
var _user$project$Canvas$msgClickZone = function (zoneKey) {
	return A2(
		_user$project$InterfaceModel$Msg,
		A2(
			_elm_lang$core$Basics_ops['++'],
			'Click Zone',
			_elm_lang$core$Basics$toString(zoneKey)),
		function (old) {
			var _p37 = old.outputMode;
			if (_p37.ctor === 'Live') {
				var info = old.liveSyncInfo;
				var _p38 = A2(
					_user$project$SleekLayout$clickToCanvasPoint,
					old,
					_elm_lang$core$Tuple$second(old.mouseState));
				var mx = _p38._1._0;
				var my = _p38._1._1;
				var trigger = A3(_user$project$Sync$prepareLiveTrigger, info, old.inputExp, zoneKey);
				var dragInfo = {
					ctor: '_Tuple3',
					_0: trigger,
					_1: {ctor: '_Tuple2', _0: mx, _1: my},
					_2: false
				};
				return _elm_lang$core$Native_Utils.update(
					old,
					{
						mouseMode: A2(
							_user$project$InterfaceModel$MouseDragZone,
							zoneKey,
							_elm_lang$core$Maybe$Just(dragInfo))
					});
			} else {
				return old;
			}
		});
};
var _user$project$Canvas$dragZoneEvents = F3(
	function (id, shapeKind, realZone) {
		var zoneKey = {
			ctor: '_Tuple3',
			_0: id,
			_1: shapeKind,
			_2: _user$project$ShapeWidgets$unparseZone(realZone)
		};
		return {
			ctor: '::',
			_0: _elm_lang$svg$Svg_Events$onMouseDown(
				_user$project$Canvas$msgClickZone(zoneKey)),
			_1: {
				ctor: '::',
				_0: _elm_lang$svg$Svg_Events$onMouseOver(
					_user$project$Canvas$turnOnCaptionAndHighlights(zoneKey)),
				_1: {
					ctor: '::',
					_0: _elm_lang$svg$Svg_Events$onMouseOut(_user$project$Canvas$turnOffCaptionAndHighlights),
					_1: {ctor: '[]'}
				}
			}
		};
	});
var _user$project$Canvas$draggableZone = F7(
	function (svgFunc, addStroke, model, id, shape, realZone, attrs) {
		var showStroke = false;
		return A3(
			_elm_lang$core$Basics$flip,
			svgFunc,
			{ctor: '[]'},
			A2(
				_elm_lang$core$Basics_ops['++'],
				attrs,
				A2(
					_elm_lang$core$Basics_ops['++'],
					A3(_user$project$Canvas$dragZoneEvents, id, shape, realZone),
					{
						ctor: '::',
						_0: A2(_user$project$Canvas$cursorOfZone, realZone, 'default'),
						_1: {
							ctor: '::',
							_0: A2(_user$project$LangSvg$attr, 'fill', 'rgba(0,0,0,0.0)'),
							_1: {
								ctor: '::',
								_0: A2(
									_user$project$LangSvg$attr,
									'stroke-width',
									addStroke ? '10' : '0'),
								_1: {
									ctor: '::',
									_0: A2(
										_user$project$LangSvg$attr,
										'stroke',
										showStroke ? 'rgba(255,0,0,0.5)' : 'rgba(0,0,0,0.0)'),
									_1: {ctor: '[]'}
								}
							}
						}
					})));
	});
var _user$project$Canvas$zoneLine = F7(
	function (model, id, shape, realZone, _p40, _p39, attrs) {
		var _p41 = _p40;
		var _p42 = _p39;
		return A7(
			_user$project$Canvas$draggableZone,
			_elm_lang$svg$Svg$line,
			true,
			model,
			id,
			shape,
			realZone,
			A2(
				_elm_lang$core$Basics_ops['++'],
				{
					ctor: '::',
					_0: A2(_user$project$Canvas$attrNumTr, 'x1', _p41._0),
					_1: {
						ctor: '::',
						_0: A2(_user$project$Canvas$attrNumTr, 'y1', _p41._1),
						_1: {
							ctor: '::',
							_0: A2(_user$project$Canvas$attrNumTr, 'x2', _p42._0),
							_1: {
								ctor: '::',
								_0: A2(_user$project$Canvas$attrNumTr, 'y2', _p42._1),
								_1: {
									ctor: '::',
									_0: _user$project$Canvas$cursorStyle('pointer'),
									_1: {ctor: '[]'}
								}
							}
						}
					}
				},
				attrs));
	});
var _user$project$Canvas$zoneLine2 = F7(
	function (model, id, shape, realZone, _p44, _p43, attrs) {
		var _p45 = _p44;
		var _p46 = _p43;
		return A7(
			_user$project$Canvas$draggableZone,
			_elm_lang$svg$Svg$line,
			true,
			model,
			id,
			shape,
			realZone,
			A2(
				_elm_lang$core$Basics_ops['++'],
				{
					ctor: '::',
					_0: A2(_user$project$Canvas$attrNum, 'x1', _p45._0),
					_1: {
						ctor: '::',
						_0: A2(_user$project$Canvas$attrNum, 'y1', _p45._1),
						_1: {
							ctor: '::',
							_0: A2(_user$project$Canvas$attrNum, 'x2', _p46._0),
							_1: {
								ctor: '::',
								_0: A2(_user$project$Canvas$attrNum, 'y2', _p46._1),
								_1: {
									ctor: '::',
									_0: _user$project$Canvas$cursorStyle('pointer'),
									_1: {ctor: '[]'}
								}
							}
						}
					}
				},
				attrs));
	});
var _user$project$Canvas$zoneRotate_ = F7(
	function (model, id, shape, cx, cy, r, cmds) {
		var _p47 = {ctor: '_Tuple4', _0: 20, _1: 'rgba(192,192,192,0.5)', _2: '5', _3: '7'};
		var a = _p47._0;
		var stroke = _p47._1;
		var strokeWidth = _p47._2;
		var rBall = _p47._3;
		var _p48 = {ctor: '_Tuple2', _0: 'silver', _1: '2'};
		var fillBall = _p48._0;
		var swBall = _p48._1;
		var transform = _user$project$Canvas$transformAttr(cmds);
		var circle = A3(
			_elm_lang$core$Basics$flip,
			_elm_lang$svg$Svg$circle,
			{ctor: '[]'},
			{
				ctor: '::',
				_0: A2(_user$project$LangSvg$attr, 'fill', 'none'),
				_1: {
					ctor: '::',
					_0: A2(_user$project$LangSvg$attr, 'stroke', stroke),
					_1: {
						ctor: '::',
						_0: A2(_user$project$LangSvg$attr, 'stroke-width', strokeWidth),
						_1: {
							ctor: '::',
							_0: A2(
								_user$project$LangSvg$attr,
								'cx',
								_elm_lang$core$Basics$toString(cx)),
							_1: {
								ctor: '::',
								_0: A2(
									_user$project$LangSvg$attr,
									'cy',
									_elm_lang$core$Basics$toString(cy)),
								_1: {
									ctor: '::',
									_0: A2(
										_user$project$LangSvg$attr,
										'r',
										_elm_lang$core$Basics$toString(r)),
									_1: {ctor: '[]'}
								}
							}
						}
					}
				}
			});
		var ball = A3(
			_elm_lang$core$Basics$flip,
			_elm_lang$svg$Svg$circle,
			{ctor: '[]'},
			A2(
				_elm_lang$core$Basics_ops['++'],
				{
					ctor: '::',
					_0: A2(_user$project$LangSvg$attr, 'stroke', 'black'),
					_1: {
						ctor: '::',
						_0: A2(_user$project$LangSvg$attr, 'stroke-width', swBall),
						_1: {
							ctor: '::',
							_0: A2(_user$project$LangSvg$attr, 'fill', fillBall),
							_1: {
								ctor: '::',
								_0: A2(
									_user$project$LangSvg$attr,
									'cx',
									_elm_lang$core$Basics$toString(cx)),
								_1: {
									ctor: '::',
									_0: A2(
										_user$project$LangSvg$attr,
										'cy',
										_elm_lang$core$Basics$toString(cy - r)),
									_1: {
										ctor: '::',
										_0: A2(_user$project$LangSvg$attr, 'r', rBall),
										_1: {
											ctor: '::',
											_0: A2(
												_user$project$Canvas$cursorOfZone,
												_user$project$ShapeWidgets$ZOther(_user$project$ShapeWidgets$Rotation),
												'default'),
											_1: {ctor: '[]'}
										}
									}
								}
							}
						}
					}
				},
				A2(
					_elm_lang$core$Basics_ops['++'],
					transform,
					A3(
						_user$project$Canvas$dragZoneEvents,
						id,
						shape,
						_user$project$ShapeWidgets$ZOther(_user$project$ShapeWidgets$Rotation)))));
		var line = function () {
			var _p49 = function () {
				var _p50 = {ctor: '_Tuple2', _0: cmds, _1: model.tool};
				if ((((((_p50.ctor === '_Tuple2') && (_p50._0.ctor === '::')) && (_p50._0._0.ctor === 'Rot')) && (_p50._0._0._0.ctor === '_Tuple2')) && (_p50._0._1.ctor === '[]')) && (_p50._1.ctor === 'Cursor')) {
					var nodeIdAndFeatureName = {ctor: '_Tuple2', _0: id, _1: _user$project$ShapeWidgets$shapeRotation};
					var handler = {
						ctor: '::',
						_0: _elm_lang$svg$Svg_Events$onMouseDown(
							_user$project$Canvas$toggleSelected(
								{
									ctor: '::',
									_0: nodeIdAndFeatureName,
									_1: {ctor: '[]'}
								})),
						_1: {ctor: '[]'}
					};
					return A2(_elm_lang$core$Set$member, nodeIdAndFeatureName, model.selectedFeatures) ? {ctor: '_Tuple2', _0: _user$project$Canvas$colorPointSelected, _1: handler} : {ctor: '_Tuple2', _0: _user$project$Canvas$colorPointNotSelected, _1: handler};
				} else {
					return {
						ctor: '_Tuple2',
						_0: stroke,
						_1: {ctor: '[]'}
					};
				}
			}();
			var strokeColor = _p49._0;
			var maybeEventHandler = _p49._1;
			return A3(
				_elm_lang$core$Basics$flip,
				_elm_lang$svg$Svg$line,
				{ctor: '[]'},
				A2(
					_elm_lang$core$Basics_ops['++'],
					{
						ctor: '::',
						_0: A2(_user$project$LangSvg$attr, 'stroke', strokeColor),
						_1: {
							ctor: '::',
							_0: A2(_user$project$LangSvg$attr, 'stroke-width', strokeWidth),
							_1: {
								ctor: '::',
								_0: A2(
									_user$project$LangSvg$attr,
									'x1',
									_elm_lang$core$Basics$toString(cx)),
								_1: {
									ctor: '::',
									_0: A2(
										_user$project$LangSvg$attr,
										'y1',
										_elm_lang$core$Basics$toString(cy)),
									_1: {
										ctor: '::',
										_0: A2(
											_user$project$LangSvg$attr,
											'x2',
											_elm_lang$core$Basics$toString(cx)),
										_1: {
											ctor: '::',
											_0: A2(
												_user$project$LangSvg$attr,
												'y2',
												_elm_lang$core$Basics$toString(cy - r)),
											_1: {ctor: '[]'}
										}
									}
								}
							}
						}
					},
					A2(_elm_lang$core$Basics_ops['++'], transform, maybeEventHandler)));
		}();
		return {
			ctor: '::',
			_0: circle,
			_1: {
				ctor: '::',
				_0: line,
				_1: {
					ctor: '::',
					_0: ball,
					_1: {ctor: '[]'}
				}
			}
		};
	});
var _user$project$Canvas$zoneRotate = F6(
	function (model, id, shape, _p51, r, maybeCmds) {
		var _p52 = _p51;
		var pred = function (z) {
			return _user$project$Canvas$isPrimaryZone(z) || _user$project$Canvas$isFillStrokeZone(z);
		};
		var _p53 = {
			ctor: '_Tuple3',
			_0: A2(_elm_lang$core$Set$member, id, model.selectedShapes),
			_1: A3(_user$project$Canvas$objectZoneIsCurrentlyBeingManipulated, model, id, pred),
			_2: maybeCmds
		};
		if ((((_p53.ctor === '_Tuple3') && (_p53._0 === true)) && (_p53._1 === false)) && (_p53._2.ctor === 'Just')) {
			return A7(_user$project$Canvas$zoneRotate_, model, id, shape, _p52._0, _p52._1, r, _p53._2._0);
		} else {
			return {ctor: '[]'};
		}
	});
var _user$project$Canvas$zoneRotatePolyOrPath = F5(
	function (model, id, kind, pts, nodeAttrs) {
		var _p54 = _user$project$Draw$boundingBoxOfPoints_(
			A2(
				_elm_lang$core$List$map,
				function (_p55) {
					var _p56 = _p55;
					return {
						ctor: '_Tuple2',
						_0: _elm_lang$core$Tuple$first(_p56._0),
						_1: _elm_lang$core$Tuple$first(_p56._1)
					};
				},
				pts));
		var xMin = _p54._0;
		var xMax = _p54._1;
		var yMin = _p54._2;
		var yMax = _p54._3;
		var _p57 = {ctor: '_Tuple2', _0: xMax - xMin, _1: yMax - yMin};
		var w = _p57._0;
		var h = _p57._1;
		var _p58 = {ctor: '_Tuple2', _0: xMin + (0.5 * w), _1: yMin + (0.5 * h)};
		var xMiddle = _p58._0;
		var yMiddle = _p58._1;
		var r = (A2(_elm_lang$core$Basics$max, w, h) / 2) + _user$project$Canvas$rotZoneDelta;
		return A6(
			_user$project$Canvas$zoneRotate,
			model,
			id,
			kind,
			{ctor: '_Tuple2', _0: xMiddle, _1: yMiddle},
			r,
			_user$project$Canvas$maybeTransformCmds(nodeAttrs));
	});
var _user$project$Canvas$zoneColor_ = F8(
	function (realZone, shapeFeature, model, id, shape, x, y, _p59) {
		var _p60 = _p59;
		var _p61 = {ctor: '_Tuple6', _0: _user$project$Canvas$wGradient, _1: _user$project$Canvas$hZoneColor, _2: 20, _3: 'silver', _4: '2', _5: '7'};
		var w = _p61._0;
		var h = _p61._1;
		var a = _p61._2;
		var stroke = _p61._3;
		var strokeWidth = _p61._4;
		var rBall = _p61._5;
		var yOff = a + _user$project$Canvas$rotZoneDelta;
		var nodeIdAndFeatureName = {ctor: '_Tuple2', _0: id, _1: shapeFeature};
		var ball = function () {
			var cx = x + ((_p60._0 / _user$project$LangSvg$maxColorNum) * _user$project$Canvas$wGradient);
			var cy = (y - yOff) + (h / 2);
			return A3(
				_elm_lang$core$Basics$flip,
				_elm_lang$svg$Svg$circle,
				{ctor: '[]'},
				A2(
					_elm_lang$core$Basics_ops['++'],
					{
						ctor: '::',
						_0: A2(_user$project$LangSvg$attr, 'stroke', 'black'),
						_1: {
							ctor: '::',
							_0: A2(_user$project$LangSvg$attr, 'stroke-width', strokeWidth),
							_1: {
								ctor: '::',
								_0: A2(_user$project$LangSvg$attr, 'fill', stroke),
								_1: {
									ctor: '::',
									_0: A2(
										_user$project$LangSvg$attr,
										'cx',
										_elm_lang$core$Basics$toString(cx)),
									_1: {
										ctor: '::',
										_0: A2(
											_user$project$LangSvg$attr,
											'cy',
											_elm_lang$core$Basics$toString(cy)),
										_1: {
											ctor: '::',
											_0: A2(_user$project$LangSvg$attr, 'r', rBall),
											_1: {
												ctor: '::',
												_0: A2(_user$project$Canvas$cursorOfZone, realZone, 'default'),
												_1: {ctor: '[]'}
											}
										}
									}
								}
							}
						}
					},
					A3(_user$project$Canvas$dragZoneEvents, id, shape, realZone)));
		}();
		var box = A3(
			_elm_lang$core$Basics$flip,
			_elm_lang$svg$Svg$rect,
			{ctor: '[]'},
			{
				ctor: '::',
				_0: A2(
					_user$project$LangSvg$attr,
					'fill',
					A2(_elm_lang$core$Set$member, nodeIdAndFeatureName, model.selectedFeatures) ? _user$project$Canvas$colorPointSelected : 'none'),
				_1: {
					ctor: '::',
					_0: A2(_user$project$LangSvg$attr, 'stroke', stroke),
					_1: {
						ctor: '::',
						_0: A2(_user$project$LangSvg$attr, 'stroke-width', strokeWidth),
						_1: {
							ctor: '::',
							_0: A2(
								_user$project$LangSvg$attr,
								'x',
								_elm_lang$core$Basics$toString(x)),
							_1: {
								ctor: '::',
								_0: A2(
									_user$project$LangSvg$attr,
									'y',
									_elm_lang$core$Basics$toString(y - yOff)),
								_1: {
									ctor: '::',
									_0: A2(
										_user$project$LangSvg$attr,
										'width',
										_elm_lang$core$Basics$toString(w)),
									_1: {
										ctor: '::',
										_0: A2(
											_user$project$LangSvg$attr,
											'height',
											_elm_lang$core$Basics$toString(h)),
										_1: {ctor: '[]'}
									}
								}
							}
						}
					}
				}
			});
		var gradient = function (_p62) {
			var _p63 = _p62;
			return A2(
				_elm_lang$core$List$map,
				function (i) {
					var _p64 = A2(_user$project$Utils$numToColor, _user$project$ShapeWidgets$wColorSlider, i);
					var r = _p64._0;
					var g = _p64._1;
					var b = _p64._2;
					var fill = A2(
						_elm_lang$core$Basics_ops['++'],
						'rgb',
						_user$project$Utils$parens(
							A2(
								_elm_lang$core$String$join,
								',',
								A2(
									_elm_lang$core$List$map,
									_elm_lang$core$Basics$toString,
									{
										ctor: '::',
										_0: r,
										_1: {
											ctor: '::',
											_0: g,
											_1: {
												ctor: '::',
												_0: b,
												_1: {ctor: '[]'}
											}
										}
									}))));
					return A3(
						_elm_lang$core$Basics$flip,
						_elm_lang$svg$Svg$rect,
						{ctor: '[]'},
						{
							ctor: '::',
							_0: A2(_user$project$LangSvg$attr, 'fill', fill),
							_1: {
								ctor: '::',
								_0: A2(
									_user$project$LangSvg$attr,
									'x',
									_elm_lang$core$Basics$toString(x + i)),
								_1: {
									ctor: '::',
									_0: A2(
										_user$project$LangSvg$attr,
										'y',
										_elm_lang$core$Basics$toString(y - yOff)),
									_1: {
										ctor: '::',
										_0: A2(_user$project$LangSvg$attr, 'width', '1'),
										_1: {
											ctor: '::',
											_0: A2(
												_user$project$LangSvg$attr,
												'height',
												_elm_lang$core$Basics$toString(h)),
											_1: {ctor: '[]'}
										}
									}
								}
							}
						});
				},
				A2(
					_elm_lang$core$List$map,
					_elm_lang$core$Basics$toFloat,
					A2(_elm_lang$core$List$range, 0, w)));
		};
		return {
			ctor: '::',
			_0: A2(
				_elm_lang$svg$Svg$g,
				{
					ctor: '::',
					_0: _user$project$Canvas$onMouseDownAndStop(
						_user$project$Canvas$toggleSelected(
							{
								ctor: '::',
								_0: nodeIdAndFeatureName,
								_1: {ctor: '[]'}
							})),
					_1: {ctor: '[]'}
				},
				A2(
					_elm_lang$core$Basics_ops['++'],
					gradient(
						{ctor: '_Tuple0'}),
					{
						ctor: '::',
						_0: box,
						_1: {ctor: '[]'}
					})),
			_1: {
				ctor: '::',
				_0: ball,
				_1: {ctor: '[]'}
			}
		};
	});
var _user$project$Canvas$zoneColor = F8(
	function (realZone, shapeFeature, model, id, shape, x, y, maybeColor) {
		var pred = function (z) {
			return _user$project$Canvas$isPrimaryZone(z) || _user$project$Canvas$isRotateZone(z);
		};
		var shapeSelected = A2(_elm_lang$core$Set$member, id, model.selectedShapes);
		var featureSelected = A2(
			_elm_lang$core$Set$member,
			{ctor: '_Tuple2', _0: id, _1: shapeFeature},
			model.selectedFeatures);
		var _p65 = {
			ctor: '_Tuple3',
			_0: shapeSelected || featureSelected,
			_1: A3(_user$project$Canvas$objectZoneIsCurrentlyBeingManipulated, model, id, pred),
			_2: maybeColor
		};
		if ((((_p65.ctor === '_Tuple3') && (_p65._0 === true)) && (_p65._1 === false)) && (_p65._2.ctor === 'Just')) {
			return A8(_user$project$Canvas$zoneColor_, realZone, shapeFeature, model, id, shape, x, y, _p65._2._0);
		} else {
			return {ctor: '[]'};
		}
	});
var _user$project$Canvas$zoneFillColor = A2(
	_user$project$Canvas$zoneColor,
	_user$project$ShapeWidgets$ZOther(_user$project$ShapeWidgets$FillColor),
	_user$project$ShapeWidgets$shapeFill);
var _user$project$Canvas$zoneStrokeColor = A2(
	_user$project$Canvas$zoneColor,
	_user$project$ShapeWidgets$ZOther(_user$project$ShapeWidgets$StrokeColor),
	_user$project$ShapeWidgets$shapeStroke);
var _user$project$Canvas$zoneOpacity_ = F8(
	function (realZone, shapeFeature, model, id, shape, x, y, _p66) {
		var _p67 = _p66;
		var _p68 = {ctor: '_Tuple6', _0: _user$project$Canvas$wOpacityBox, _1: 20, _2: 20, _3: 'silver', _4: '2', _5: '7'};
		var w = _p68._0;
		var h = _p68._1;
		var a = _p68._2;
		var stroke = _p68._3;
		var strokeWidth = _p68._4;
		var rBall = _p68._5;
		var yOff = a + _user$project$Canvas$rotZoneDelta;
		var nodeIdAndFeatureName = {ctor: '_Tuple2', _0: id, _1: shapeFeature};
		var ball = function () {
			var cx = x + (_p67._0 * _user$project$Canvas$wOpacityBox);
			var cy = (y - yOff) + (h / 2);
			return A3(
				_elm_lang$core$Basics$flip,
				_elm_lang$svg$Svg$circle,
				{ctor: '[]'},
				A2(
					_elm_lang$core$Basics_ops['++'],
					{
						ctor: '::',
						_0: A2(_user$project$LangSvg$attr, 'stroke', 'black'),
						_1: {
							ctor: '::',
							_0: A2(_user$project$LangSvg$attr, 'stroke-width', strokeWidth),
							_1: {
								ctor: '::',
								_0: A2(_user$project$LangSvg$attr, 'fill', stroke),
								_1: {
									ctor: '::',
									_0: A2(
										_user$project$LangSvg$attr,
										'cx',
										_elm_lang$core$Basics$toString(cx)),
									_1: {
										ctor: '::',
										_0: A2(
											_user$project$LangSvg$attr,
											'cy',
											_elm_lang$core$Basics$toString(cy)),
										_1: {
											ctor: '::',
											_0: A2(_user$project$LangSvg$attr, 'r', rBall),
											_1: {
												ctor: '::',
												_0: A2(_user$project$Canvas$cursorOfZone, realZone, 'default'),
												_1: {ctor: '[]'}
											}
										}
									}
								}
							}
						}
					},
					A3(_user$project$Canvas$dragZoneEvents, id, shape, realZone)));
		}();
		var box = A3(
			_elm_lang$core$Basics$flip,
			_elm_lang$svg$Svg$rect,
			{ctor: '[]'},
			{
				ctor: '::',
				_0: A2(
					_user$project$LangSvg$attr,
					'fill',
					A2(_elm_lang$core$Set$member, nodeIdAndFeatureName, model.selectedFeatures) ? _user$project$Canvas$colorPointSelected : 'white'),
				_1: {
					ctor: '::',
					_0: A2(_user$project$LangSvg$attr, 'stroke', stroke),
					_1: {
						ctor: '::',
						_0: A2(_user$project$LangSvg$attr, 'stroke-width', strokeWidth),
						_1: {
							ctor: '::',
							_0: A2(
								_user$project$LangSvg$attr,
								'x',
								_elm_lang$core$Basics$toString(x)),
							_1: {
								ctor: '::',
								_0: A2(
									_user$project$LangSvg$attr,
									'y',
									_elm_lang$core$Basics$toString(y - yOff)),
								_1: {
									ctor: '::',
									_0: A2(
										_user$project$LangSvg$attr,
										'width',
										_elm_lang$core$Basics$toString(w)),
									_1: {
										ctor: '::',
										_0: A2(
											_user$project$LangSvg$attr,
											'height',
											_elm_lang$core$Basics$toString(h)),
										_1: {ctor: '[]'}
									}
								}
							}
						}
					}
				}
			});
		return {
			ctor: '::',
			_0: A2(
				_elm_lang$svg$Svg$g,
				{
					ctor: '::',
					_0: _user$project$Canvas$onMouseDownAndStop(
						_user$project$Canvas$toggleSelected(
							{
								ctor: '::',
								_0: nodeIdAndFeatureName,
								_1: {ctor: '[]'}
							})),
					_1: {ctor: '[]'}
				},
				{
					ctor: '::',
					_0: box,
					_1: {ctor: '[]'}
				}),
			_1: {
				ctor: '::',
				_0: ball,
				_1: {ctor: '[]'}
			}
		};
	});
var _user$project$Canvas$zoneOpacity = F8(
	function (realZone, shapeFeature, model, id, shape, x, y, maybeOpacity) {
		var pred = function (z) {
			return _user$project$Canvas$isPrimaryZone(z) || _user$project$Canvas$isRotateZone(z);
		};
		var shapeSelected = A2(_elm_lang$core$Set$member, id, model.selectedShapes);
		var featureSelected = A2(
			_elm_lang$core$Set$member,
			{ctor: '_Tuple2', _0: id, _1: shapeFeature},
			model.selectedFeatures);
		var _p69 = {
			ctor: '_Tuple3',
			_0: shapeSelected || featureSelected,
			_1: A3(_user$project$Canvas$objectZoneIsCurrentlyBeingManipulated, model, id, pred),
			_2: maybeOpacity
		};
		if ((((_p69.ctor === '_Tuple3') && (_p69._0 === true)) && (_p69._1 === false)) && (_p69._2.ctor === 'Just')) {
			return A8(_user$project$Canvas$zoneOpacity_, realZone, shapeFeature, model, id, shape, x, y, _p69._2._0);
		} else {
			return {ctor: '[]'};
		}
	});
var _user$project$Canvas$zoneFillOpacity = A2(
	_user$project$Canvas$zoneOpacity,
	_user$project$ShapeWidgets$ZOther(_user$project$ShapeWidgets$FillOpacity),
	_user$project$ShapeWidgets$shapeFillOpacity);
var _user$project$Canvas$zonesFill = F6(
	function (model, id, shape, x, y, l) {
		var _p70 = A2(_user$project$Canvas$maybeColorNumAttr, 'fill', l);
		var maybeColor = _p70._0;
		var maybeOpacity = _p70._1;
		return A2(
			_elm_lang$core$Basics_ops['++'],
			A6(_user$project$Canvas$zoneFillOpacity, model, id, shape, (x - _user$project$Canvas$wOpacityBox) - 5, y, maybeOpacity),
			A6(_user$project$Canvas$zoneFillColor, model, id, shape, x, y, maybeColor));
	});
var _user$project$Canvas$zoneStrokeOpacity = A2(
	_user$project$Canvas$zoneOpacity,
	_user$project$ShapeWidgets$ZOther(_user$project$ShapeWidgets$StrokeOpacity),
	_user$project$ShapeWidgets$shapeStrokeOpacity);
var _user$project$Canvas$svgPath = A2(
	_elm_lang$core$Basics$flip,
	_elm_lang$svg$Svg$path,
	{ctor: '[]'});
var _user$project$Canvas$zoneStrokeWidth_ = F6(
	function (model, id, shape, x, y, _p71) {
		var _p72 = _p71;
		var _p73 = {ctor: '_Tuple6', _0: _user$project$Canvas$wStrokeWidthBox, _1: _user$project$LangSvg$maxStrokeWidthNum, _2: 20, _3: 'silver', _4: '2', _5: '7'};
		var w = _p73._0;
		var h = _p73._1;
		var a = _p73._2;
		var stroke = _p73._3;
		var strokeWidth = _p73._4;
		var rBall = _p73._5;
		var yOff = a + _user$project$Canvas$rotZoneDelta;
		var nodeIdAndFeatureName = {ctor: '_Tuple2', _0: id, _1: _user$project$ShapeWidgets$shapeStrokeWidth};
		var box = A3(
			_elm_lang$core$Basics$flip,
			_elm_lang$svg$Svg$rect,
			{ctor: '[]'},
			{
				ctor: '::',
				_0: A2(
					_user$project$LangSvg$attr,
					'fill',
					A2(_elm_lang$core$Set$member, nodeIdAndFeatureName, model.selectedFeatures) ? _user$project$Canvas$colorPointSelected : 'white'),
				_1: {
					ctor: '::',
					_0: A2(_user$project$LangSvg$attr, 'stroke', stroke),
					_1: {
						ctor: '::',
						_0: A2(_user$project$LangSvg$attr, 'stroke-width', strokeWidth),
						_1: {
							ctor: '::',
							_0: A2(
								_user$project$LangSvg$attr,
								'x',
								_elm_lang$core$Basics$toString(x)),
							_1: {
								ctor: '::',
								_0: A2(
									_user$project$LangSvg$attr,
									'y',
									_elm_lang$core$Basics$toString(y - yOff)),
								_1: {
									ctor: '::',
									_0: A2(
										_user$project$LangSvg$attr,
										'width',
										_elm_lang$core$Basics$toString(w)),
									_1: {
										ctor: '::',
										_0: A2(
											_user$project$LangSvg$attr,
											'height',
											_elm_lang$core$Basics$toString(h)),
										_1: {ctor: '[]'}
									}
								}
							}
						}
					}
				}
			});
		var ball = function () {
			var cx = x + ((_p72._0 / _user$project$LangSvg$maxStrokeWidthNum) * _user$project$Canvas$wStrokeWidthBox);
			var cy = (y - yOff) + (h / 2);
			return A3(
				_elm_lang$core$Basics$flip,
				_elm_lang$svg$Svg$circle,
				{ctor: '[]'},
				A2(
					_elm_lang$core$Basics_ops['++'],
					{
						ctor: '::',
						_0: A2(_user$project$LangSvg$attr, 'stroke', 'black'),
						_1: {
							ctor: '::',
							_0: A2(_user$project$LangSvg$attr, 'stroke-width', strokeWidth),
							_1: {
								ctor: '::',
								_0: A2(_user$project$LangSvg$attr, 'fill', stroke),
								_1: {
									ctor: '::',
									_0: A2(
										_user$project$LangSvg$attr,
										'cx',
										_elm_lang$core$Basics$toString(cx)),
									_1: {
										ctor: '::',
										_0: A2(
											_user$project$LangSvg$attr,
											'cy',
											_elm_lang$core$Basics$toString(cy)),
										_1: {
											ctor: '::',
											_0: A2(_user$project$LangSvg$attr, 'r', rBall),
											_1: {
												ctor: '::',
												_0: A2(
													_user$project$Canvas$cursorOfZone,
													_user$project$ShapeWidgets$ZOther(_user$project$ShapeWidgets$StrokeWidth),
													'default'),
												_1: {ctor: '[]'}
											}
										}
									}
								}
							}
						}
					},
					A3(
						_user$project$Canvas$dragZoneEvents,
						id,
						shape,
						_user$project$ShapeWidgets$ZOther(_user$project$ShapeWidgets$StrokeWidth))));
		}();
		var triangle = function () {
			var _p74 = {ctor: '_Tuple2', _0: x, _1: (y - yOff) + (h / 2)};
			var x0 = _p74._0;
			var y0 = _p74._1;
			var _p75 = {ctor: '_Tuple2', _0: x + _user$project$Canvas$wStrokeWidthBox, _1: y - yOff};
			var x1 = _p75._0;
			var y1 = _p75._1;
			var _p76 = {ctor: '_Tuple2', _0: x + _user$project$Canvas$wStrokeWidthBox, _1: (y - yOff) + h};
			var x2 = _p76._0;
			var y2 = _p76._1;
			return _user$project$Canvas$svgPath(
				{
					ctor: '::',
					_0: A2(_user$project$LangSvg$attr, 'fill', 'darkgray'),
					_1: {
						ctor: '::',
						_0: A2(
							_user$project$LangSvg$attr,
							'd',
							A2(
								_elm_lang$core$Basics_ops['++'],
								'M ',
								A2(
									_elm_lang$core$Basics_ops['++'],
									_elm_lang$core$Basics$toString(x0),
									A2(
										_elm_lang$core$Basics_ops['++'],
										' ',
										A2(
											_elm_lang$core$Basics_ops['++'],
											_elm_lang$core$Basics$toString(y0),
											A2(
												_elm_lang$core$Basics_ops['++'],
												' L ',
												A2(
													_elm_lang$core$Basics_ops['++'],
													_elm_lang$core$Basics$toString(x1),
													A2(
														_elm_lang$core$Basics_ops['++'],
														' ',
														A2(
															_elm_lang$core$Basics_ops['++'],
															_elm_lang$core$Basics$toString(y1),
															A2(
																_elm_lang$core$Basics_ops['++'],
																' L ',
																A2(
																	_elm_lang$core$Basics_ops['++'],
																	_elm_lang$core$Basics$toString(x2),
																	A2(
																		_elm_lang$core$Basics_ops['++'],
																		' ',
																		A2(
																			_elm_lang$core$Basics_ops['++'],
																			_elm_lang$core$Basics$toString(y2),
																			' Z'))))))))))))),
						_1: {ctor: '[]'}
					}
				});
		}();
		return {
			ctor: '::',
			_0: A2(
				_elm_lang$svg$Svg$g,
				{
					ctor: '::',
					_0: _user$project$Canvas$onMouseDownAndStop(
						_user$project$Canvas$toggleSelected(
							{
								ctor: '::',
								_0: nodeIdAndFeatureName,
								_1: {ctor: '[]'}
							})),
					_1: {ctor: '[]'}
				},
				{
					ctor: '::',
					_0: box,
					_1: {
						ctor: '::',
						_0: triangle,
						_1: {ctor: '[]'}
					}
				}),
			_1: {
				ctor: '::',
				_0: ball,
				_1: {ctor: '[]'}
			}
		};
	});
var _user$project$Canvas$zoneStrokeWidth = F6(
	function (model, id, shape, x, y, maybeStrokeWidth) {
		var pred = function (z) {
			return _user$project$Canvas$isPrimaryZone(z) || _user$project$Canvas$isRotateZone(z);
		};
		var shapeSelected = A2(_elm_lang$core$Set$member, id, model.selectedShapes);
		var featureSelected = A2(
			_elm_lang$core$Set$member,
			{ctor: '_Tuple2', _0: id, _1: _user$project$ShapeWidgets$shapeStrokeWidth},
			model.selectedFeatures);
		var _p77 = {
			ctor: '_Tuple3',
			_0: shapeSelected || featureSelected,
			_1: A3(_user$project$Canvas$objectZoneIsCurrentlyBeingManipulated, model, id, pred),
			_2: maybeStrokeWidth
		};
		if ((((_p77.ctor === '_Tuple3') && (_p77._0 === true)) && (_p77._1 === false)) && (_p77._2.ctor === 'Just')) {
			return A6(_user$project$Canvas$zoneStrokeWidth_, model, id, shape, x, y, _p77._2._0);
		} else {
			return {ctor: '[]'};
		}
	});
var _user$project$Canvas$zonesStroke = F6(
	function (model, id, shape, x, y, l) {
		var _p78 = A2(_user$project$Canvas$maybeColorNumAttr, 'stroke', l);
		var maybeColor = _p78._0;
		var maybeOpacity = _p78._1;
		var maybeStrokeWidth = _user$project$Canvas$maybeStrokeWidthNumAttr(l);
		return A2(
			_elm_lang$core$Basics_ops['++'],
			A6(_user$project$Canvas$zoneStrokeOpacity, model, id, shape, (x - _user$project$Canvas$wOpacityBox) - 5, y, maybeOpacity),
			A2(
				_elm_lang$core$Basics_ops['++'],
				A6(_user$project$Canvas$zoneStrokeColor, model, id, shape, x, y, maybeColor),
				A6(_user$project$Canvas$zoneStrokeWidth, model, id, shape, (x + _user$project$Canvas$wGradient) + 5, y, maybeStrokeWidth)));
	});
var _user$project$Canvas$zonesFillAndStroke = F6(
	function (model, id, shape, x, y, l) {
		return A2(
			_elm_lang$core$Basics_ops['++'],
			A6(_user$project$Canvas$zonesFill, model, id, shape, x, y, l),
			A6(_user$project$Canvas$zonesStroke, model, id, shape, x, (y - _user$project$Canvas$hZoneColor) - 5, l));
	});
var _user$project$Canvas$svgPolygon = A2(
	_elm_lang$core$Basics$flip,
	_elm_lang$svg$Svg$polygon,
	{ctor: '[]'});
var _user$project$Canvas$svgEllipse = A2(
	_elm_lang$core$Basics$flip,
	_elm_lang$svg$Svg$ellipse,
	{ctor: '[]'});
var _user$project$Canvas$svgCircle = A2(
	_elm_lang$core$Basics$flip,
	_elm_lang$svg$Svg$circle,
	{ctor: '[]'});
var _user$project$Canvas$zonePoint = F7(
	function (model, alwaysShow, id, shapeKind, realZone, transform, attrs) {
		var maybeStyles = function () {
			var maybeStyles_ = function (_p79) {
				var _p80 = _p79;
				return A3(
					_user$project$Canvas$objectZoneIsCurrentlyBeingManipulated,
					model,
					id,
					F2(
						function (x, y) {
							return _elm_lang$core$Native_Utils.eq(x, y);
						})(realZone)) ? _elm_lang$core$Maybe$Just(
					A2(_user$project$Canvas$pointZoneStylesFillSelected, model, id)) : (A2(_user$project$Canvas$objectIsCurrentlyBeingManipulated, model, id) ? _elm_lang$core$Maybe$Nothing : (A2(_elm_lang$core$Set$member, id, model.selectedShapes) ? _elm_lang$core$Maybe$Just(
					A2(_user$project$Canvas$pointZoneStylesFillSelected, model, id)) : ((A2(_elm_lang$core$Set$member, id, model.hoveredShapes) || alwaysShow) ? _elm_lang$core$Maybe$Just(_user$project$Canvas$pointZoneStyles.fill.shown) : _elm_lang$core$Maybe$Nothing)));
			};
			var _p81 = A2(_user$project$ShapeWidgets$zoneToCrosshair, shapeKind, realZone);
			if (_p81.ctor === 'Nothing') {
				return maybeStyles_(
					{ctor: '_Tuple0'});
			} else {
				return A2(
					_elm_lang$core$Set$member,
					{ctor: '_Tuple3', _0: id, _1: _p81._0._0, _2: _p81._0._1},
					model.hoveredCrosshairs) ? _elm_lang$core$Maybe$Nothing : maybeStyles_(
					{ctor: '_Tuple0'});
			}
		}();
		var _p82 = maybeStyles;
		if (_p82.ctor === 'Nothing') {
			return {ctor: '[]'};
		} else {
			return _elm_lang$core$List$singleton(
				_user$project$Canvas$svgCircle(
					A2(
						_elm_lang$core$Basics_ops['++'],
						{
							ctor: '::',
							_0: A2(_user$project$LangSvg$attr, 'r', _user$project$Canvas$pointZoneStyles.radius),
							_1: {
								ctor: '::',
								_0: A2(_user$project$LangSvg$attr, 'fill', _p82._0),
								_1: {
									ctor: '::',
									_0: A2(_user$project$LangSvg$attr, 'stroke', _user$project$Canvas$pointZoneStyles.stroke),
									_1: {
										ctor: '::',
										_0: A2(_user$project$LangSvg$attr, 'stroke-width', _user$project$Canvas$pointZoneStyles.strokeWidth),
										_1: {
											ctor: '::',
											_0: A2(_user$project$Canvas$cursorOfZone, realZone, 'pointer'),
											_1: {ctor: '[]'}
										}
									}
								}
							}
						},
						A2(
							_elm_lang$core$Basics_ops['++'],
							A3(_user$project$Canvas$dragZoneEvents, id, shapeKind, realZone),
							A2(_elm_lang$core$Basics_ops['++'], transform, attrs)))));
		}
	});
var _user$project$Canvas$eightCardinalZones = F5(
	function (model, id, shape, transform, _p83) {
		var _p84 = _p83;
		var _p89 = _p84._1;
		var _p88 = _p84._2;
		var _p87 = _p84._0;
		var _p86 = _p84._3;
		var _p85 = {ctor: '_Tuple2', _0: _p88 - _p87, _1: _p86 - _p89};
		var width = _p85._0;
		var height = _p85._1;
		var ifEnoughSpace = F2(
			function (len, xs) {
				return (_elm_lang$core$Native_Utils.cmp(len, _user$project$Canvas$minLengthForMiddleZones) < 0) ? {ctor: '[]'} : xs;
			});
		var mkPoint = F3(
			function (realZone, cx, cy) {
				return A7(
					_user$project$Canvas$zonePoint,
					model,
					false,
					id,
					shape,
					realZone,
					transform,
					{
						ctor: '::',
						_0: A2(_user$project$Canvas$attrNum, 'cx', cx),
						_1: {
							ctor: '::',
							_0: A2(_user$project$Canvas$attrNum, 'cy', cy),
							_1: {ctor: '[]'}
						}
					});
			});
		return A2(
			_elm_lang$core$Basics_ops['++'],
			A3(
				mkPoint,
				_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$TopLeft),
				_p87,
				_p89),
			A2(
				_elm_lang$core$Basics_ops['++'],
				A3(
					mkPoint,
					_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$TopRight),
					_p88,
					_p89),
				A2(
					_elm_lang$core$Basics_ops['++'],
					A3(
						mkPoint,
						_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$BotLeft),
						_p87,
						_p86),
					A2(
						_elm_lang$core$Basics_ops['++'],
						A3(
							mkPoint,
							_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$BotRight),
							_p88,
							_p86),
						A2(
							_elm_lang$core$Basics_ops['++'],
							A2(
								ifEnoughSpace,
								height,
								A3(
									mkPoint,
									_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$LeftEdge),
									_p87,
									_p89 + (height / 2))),
							A2(
								_elm_lang$core$Basics_ops['++'],
								A2(
									ifEnoughSpace,
									height,
									A3(
										mkPoint,
										_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$RightEdge),
										_p88,
										_p89 + (height / 2))),
								A2(
									_elm_lang$core$Basics_ops['++'],
									A2(
										ifEnoughSpace,
										width,
										A3(
											mkPoint,
											_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$TopEdge),
											_p87 + (width / 2),
											_p89)),
									A2(
										ifEnoughSpace,
										width,
										A3(
											mkPoint,
											_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$BotEdge),
											_p87 + (width / 2),
											_p86)))))))));
	});
var _user$project$Canvas$zonePoints = F5(
	function (model, id, shape, transform, pts) {
		return _elm_lang$core$List$concat(
			A3(
				_elm_lang$core$Basics$flip,
				_user$project$Utils$mapi1,
				pts,
				function (_p90) {
					var _p91 = _p90;
					return A7(
						_user$project$Canvas$zonePoint,
						model,
						false,
						id,
						shape,
						_user$project$ShapeWidgets$ZPoint(
							_user$project$ShapeWidgets$Point(_p91._0)),
						transform,
						{
							ctor: '::',
							_0: A2(_user$project$Canvas$attrNumTr, 'cx', _p91._1._0),
							_1: {
								ctor: '::',
								_0: A2(_user$project$Canvas$attrNumTr, 'cy', _p91._1._1),
								_1: {ctor: '[]'}
							}
						});
				}));
	});
var _user$project$Canvas$zonePoints2 = F5(
	function (model, id, shape, transform, pts) {
		return _elm_lang$core$List$concat(
			A3(
				_elm_lang$core$Basics$flip,
				_user$project$Utils$mapi1,
				pts,
				function (_p92) {
					var _p93 = _p92;
					return A7(
						_user$project$Canvas$zonePoint,
						model,
						false,
						id,
						shape,
						_user$project$ShapeWidgets$ZPoint(
							_user$project$ShapeWidgets$Point(_p93._0)),
						transform,
						{
							ctor: '::',
							_0: A2(_user$project$Canvas$attrNum, 'cx', _p93._1._0),
							_1: {
								ctor: '::',
								_0: A2(_user$project$Canvas$attrNum, 'cy', _p93._1._1),
								_1: {ctor: '[]'}
							}
						});
				}));
	});
var _user$project$Canvas$svgXYDot = F4(
	function (_p94, fill, isVisible, extraAttrs) {
		var _p95 = _p94;
		return _user$project$Canvas$svgCircle(
			A2(
				_elm_lang$core$Basics_ops['++'],
				{
					ctor: '::',
					_0: A2(
						_user$project$LangSvg$attr,
						'cx',
						_elm_lang$core$Basics$toString(_p95._0)),
					_1: {
						ctor: '::',
						_0: A2(
							_user$project$LangSvg$attr,
							'cy',
							_elm_lang$core$Basics$toString(_p95._1)),
						_1: {
							ctor: '::',
							_0: A2(_user$project$LangSvg$attr, 'fill', fill),
							_1: {
								ctor: '::',
								_0: A2(_user$project$LangSvg$attr, 'stroke', _user$project$Canvas$pointZoneStyles.stroke),
								_1: {
									ctor: '::',
									_0: A2(_user$project$LangSvg$attr, 'stroke-width', _user$project$Canvas$pointZoneStyles.strokeWidth),
									_1: {
										ctor: '::',
										_0: A2(
											_user$project$LangSvg$attr,
											'r',
											isVisible ? _user$project$Canvas$pointZoneStyles.radius : '0'),
										_1: {ctor: '[]'}
									}
								}
							}
						}
					}
				},
				extraAttrs));
	});
var _user$project$Canvas$drawNewPointOrOffset = F2(
	function (_p97, _p96) {
		var _p98 = _p97;
		var _p99 = _p96;
		var _p103 = _p99._1;
		var _p102 = _p99._0;
		var _p100 = A2(
			_user$project$Draw$horizontalVerticalSnap,
			{ctor: '_Tuple2', _0: _p102, _1: _p103},
			{ctor: '_Tuple2', _0: _p98._0, _1: _p98._1});
		var axis = _p100._0;
		var sign = _p100._1;
		var amount = _p100._2;
		var xyDot = A4(
			_user$project$Canvas$svgXYDot,
			{ctor: '_Tuple2', _0: _p102, _1: _p103},
			_user$project$Canvas$pointZoneStyles.fill.shown,
			true,
			{ctor: '[]'});
		var _p101 = A7(
			_user$project$Canvas$svgOffsetWidget1DArrowPartsAndEndPoint,
			{
				ctor: '_Tuple2',
				_0: _elm_lang$core$Basics$toFloat(_p102),
				_1: _elm_lang$core$Basics$toFloat(_p103)
			},
			axis,
			sign,
			amount,
			_elm_lang$core$Maybe$Nothing,
			false,
			{ctor: '[]'});
		var arrowParts = _p101._0;
		return A2(
			_elm_lang$core$Basics_ops['++'],
			{
				ctor: '::',
				_0: xyDot,
				_1: {ctor: '[]'}
			},
			arrowParts);
	});
var _user$project$Canvas$drawNewShape = function (model) {
	var _p104 = {ctor: '_Tuple2', _0: model.tool, _1: model.mouseMode};
	_v49_10:
	do {
		if ((_p104.ctor === '_Tuple2') && (_p104._1.ctor === 'MouseDrawNew')) {
			switch (_p104._1._0.ctor) {
				case 'PolyPoints':
					if ((_p104._0.ctor === 'Poly') && (_p104._1._0._0.ctor === '::')) {
						return A2(_user$project$Draw$drawNewPolygon, _p104._1._0._0._0, _p104._1._0._0._1);
					} else {
						break _v49_10;
					}
				case 'PathPoints':
					if ((_p104._0.ctor === 'Path') && (_p104._1._0._0.ctor === '::')) {
						return A2(_user$project$Draw$drawNewPath, _p104._1._0._0._0, _p104._1._0._0._1);
					} else {
						break _v49_10;
					}
				case 'OffsetFromExisting':
					if ((((_p104._0.ctor === 'PointOrOffset') && (_p104._1._0._1.ctor === '_Tuple2')) && (_p104._1._0._1._0.ctor === '_Tuple2')) && (_p104._1._0._1._1.ctor === '_Tuple2')) {
						return A2(
							_user$project$Canvas$drawNewPointOrOffset,
							_p104._1._0._0,
							{
								ctor: '_Tuple2',
								_0: _elm_lang$core$Basics$round(_p104._1._0._1._0._0),
								_1: _elm_lang$core$Basics$round(_p104._1._0._1._1._0)
							});
					} else {
						break _v49_10;
					}
				case 'TwoPoints':
					switch (_p104._0.ctor) {
						case 'Line':
							return A3(_user$project$Draw$drawNewLine, model, _p104._1._0._0, _p104._1._0._1);
						case 'Rect':
							return A3(_user$project$Draw$drawNewRect, model.keysDown, _p104._1._0._0, _p104._1._0._1);
						case 'Oval':
							return A3(_user$project$Draw$drawNewEllipse, model.keysDown, _p104._1._0._0, _p104._1._0._1);
						case 'PointOrOffset':
							if ((_p104._1._0._0.ctor === '_Tuple2') && (_p104._1._0._1.ctor === '_Tuple2')) {
								return A2(_user$project$Canvas$drawNewPointOrOffset, _p104._1._0._0._1, _p104._1._0._1._1);
							} else {
								break _v49_10;
							}
						case 'HelperLine':
							return A3(_user$project$Draw$drawNewLine, model, _p104._1._0._0, _p104._1._0._1);
						case 'Lambda':
							return A3(_user$project$Draw$drawNewRect, model.keysDown, _p104._1._0._0, _p104._1._0._1);
						case 'Text':
							return A3(_user$project$Draw$drawNewRect, model.keysDown, _p104._1._0._0, _p104._1._0._1);
						default:
							break _v49_10;
					}
				default:
					break _v49_10;
			}
		} else {
			break _v49_10;
		}
	} while(false);
	return {ctor: '[]'};
};
var _user$project$Canvas$svgRect = A2(
	_elm_lang$core$Basics$flip,
	_elm_lang$svg$Svg$rect,
	{ctor: '[]'});
var _user$project$Canvas$boundingBoxZones = F4(
	function (model, id, _p105, shapeWidgets) {
		var _p106 = _p105;
		var _p108 = _p106._1;
		var _p107 = _p106._0;
		var pad = 10;
		var maybeBackgroundBox = A2(_user$project$Canvas$objectIsCurrentlyBeingManipulated, model, id) ? {ctor: '[]'} : ((!A2(_elm_lang$core$Set$member, id, model.hoveredShapes)) ? {ctor: '[]'} : _elm_lang$core$List$singleton(
			_user$project$Canvas$svgRect(
				{
					ctor: '::',
					_0: A2(
						_user$project$LangSvg$attr,
						'x',
						_elm_lang$core$Basics$toString(_p107 - pad)),
					_1: {
						ctor: '::',
						_0: A2(
							_user$project$LangSvg$attr,
							'y',
							_elm_lang$core$Basics$toString(_p108 - pad)),
						_1: {
							ctor: '::',
							_0: A2(
								_user$project$LangSvg$attr,
								'width',
								_elm_lang$core$Basics$toString((_p106._2 - _p107) + (2 * pad))),
							_1: {
								ctor: '::',
								_0: A2(
									_user$project$LangSvg$attr,
									'height',
									_elm_lang$core$Basics$toString((_p106._3 - _p108) + (2 * pad))),
								_1: {
									ctor: '::',
									_0: A2(_user$project$LangSvg$attr, 'fill', 'rgba(100,100,100,0.0)'),
									_1: {
										ctor: '::',
										_0: A2(_user$project$LangSvg$attr, 'stroke', 'lightgray'),
										_1: {
											ctor: '::',
											_0: A2(_user$project$LangSvg$attr, 'stroke-width', '1'),
											_1: {ctor: '[]'}
										}
									}
								}
							}
						}
					}
				})));
		return A2(
			_elm_lang$svg$Svg$g,
			{
				ctor: '::',
				_0: _elm_lang$html$Html_Events$onMouseLeave(
					_user$project$Canvas$removeHoveredShape(id)),
				_1: {ctor: '[]'}
			},
			A2(_elm_lang$core$Basics_ops['++'], maybeBackgroundBox, shapeWidgets));
	});
var _user$project$Canvas$svgLine = A2(
	_elm_lang$core$Basics$flip,
	_elm_lang$svg$Svg$line,
	{ctor: '[]'});
var _user$project$Canvas$zoneSelectCrossDot = F5(
	function (model, alwaysShowDot, _p109, xNumTr, yNumTr) {
		var _p110 = _p109;
		var _p117 = _p110._2;
		var _p116 = _p110._1;
		var _p115 = _p110._0;
		var _p111 = {ctor: '_Tuple2', _0: xNumTr, _1: yNumTr};
		var xFloat = _p111._0._0;
		var yFloat = _p111._1._0;
		var _p112 = {
			ctor: '_Tuple2',
			_0: _elm_lang$core$Basics$round(xFloat),
			_1: _elm_lang$core$Basics$round(yFloat)
		};
		var x = _p112._0;
		var y = _p112._1;
		var xFeatureName = A2(
			_user$project$ShapeWidgets$unparseFeatureNum,
			_elm_lang$core$Maybe$Just(_p116),
			_user$project$ShapeWidgets$XFeat(_p117));
		var yFeatureName = A2(
			_user$project$ShapeWidgets$unparseFeatureNum,
			_elm_lang$core$Maybe$Just(_p116),
			_user$project$ShapeWidgets$YFeat(_p117));
		var thisCrosshair = {ctor: '_Tuple3', _0: _p115, _1: xFeatureName, _2: yFeatureName};
		var len = 20;
		var color = function (nodeIdAndFeatureNames) {
			return A2(
				_elm_lang$core$List$all,
				A2(_elm_lang$core$Basics$flip, _elm_lang$core$Set$member, model.selectedFeatures),
				nodeIdAndFeatureNames) ? _user$project$Canvas$colorPointSelected : _user$project$Canvas$colorPointNotSelected;
		};
		var yFeature = {ctor: '_Tuple2', _0: _p115, _1: yFeatureName};
		var xFeature = {ctor: '_Tuple2', _0: _p115, _1: xFeatureName};
		var _p113 = {
			ctor: '_Tuple2',
			_0: color(
				{
					ctor: '::',
					_0: xFeature,
					_1: {ctor: '[]'}
				}),
			_1: color(
				{
					ctor: '::',
					_0: yFeature,
					_1: {ctor: '[]'}
				})
		};
		var xColor = _p113._0;
		var yColor = _p113._1;
		var _p114 = function () {
			var r = (A2(_elm_lang$core$Set$member, thisCrosshair, model.hoveredCrosshairs) && _elm_lang$core$Native_Utils.eq(model.tool, _user$project$InterfaceModel$Cursor)) ? _elm_lang$core$Basics$toString(len) : '0';
			var backDisc = _user$project$Canvas$svgCircle(
				{
					ctor: '::',
					_0: A2(_user$project$LangSvg$attr, 'r', r),
					_1: {
						ctor: '::',
						_0: A2(
							_user$project$LangSvg$attr,
							'cx',
							_elm_lang$core$Basics$toString(x)),
						_1: {
							ctor: '::',
							_0: A2(
								_user$project$LangSvg$attr,
								'cy',
								_elm_lang$core$Basics$toString(y)),
							_1: {
								ctor: '::',
								_0: A2(_user$project$LangSvg$attr, 'fill', 'rgba(255,255,255,1.0)'),
								_1: {ctor: '[]'}
							}
						}
					}
				});
			var frontDisc = _user$project$Canvas$svgCircle(
				{
					ctor: '::',
					_0: A2(_user$project$LangSvg$attr, 'r', r),
					_1: {
						ctor: '::',
						_0: A2(
							_user$project$LangSvg$attr,
							'cx',
							_elm_lang$core$Basics$toString(x)),
						_1: {
							ctor: '::',
							_0: A2(
								_user$project$LangSvg$attr,
								'cy',
								_elm_lang$core$Basics$toString(y)),
							_1: {
								ctor: '::',
								_0: A2(_user$project$LangSvg$attr, 'fill', 'none'),
								_1: {
									ctor: '::',
									_0: A2(_user$project$LangSvg$attr, 'stroke', 'black'),
									_1: {
										ctor: '::',
										_0: A2(_user$project$LangSvg$attr, 'stroke-width', _user$project$Canvas$pointZoneStyles.strokeWidth),
										_1: {ctor: '[]'}
									}
								}
							}
						}
					}
				});
			return {ctor: '_Tuple2', _0: backDisc, _1: frontDisc};
		}();
		var backDisc = _p114._0;
		var frontDisc = _p114._1;
		var xyDot = function () {
			var dotFill = A2(_elm_lang$core$Set$member, _p115, model.selectedShapes) ? A2(_user$project$Canvas$pointZoneStylesFillSelected, model, _p115) : _user$project$Canvas$pointZoneStyles.fill.shown;
			var isVisible = (!A2(_user$project$Canvas$objectIsCurrentlyBeingManipulated, model, _p115)) && (alwaysShowDot || (A2(_elm_lang$core$Set$member, _p115, model.selectedShapes) || (A2(_elm_lang$core$Set$member, _p115, model.hoveredShapes) || A2(_elm_lang$core$Set$member, thisCrosshair, model.hoveredCrosshairs))));
			var extraAttrs = _elm_lang$core$Native_Utils.eq(model.tool, _user$project$InterfaceModel$Cursor) ? {
				ctor: '::',
				_0: _elm_lang$svg$Svg_Events$onMouseDown(
					A2(
						_user$project$InterfaceModel$Msg,
						'Select Cross Dot...',
						function (model) {
							return A2(_elm_lang$core$Set$member, thisCrosshair, model.hoveredCrosshairs) ? A2(
								_user$project$Canvas$toggleSelectedLambda,
								{
									ctor: '::',
									_0: xFeature,
									_1: {
										ctor: '::',
										_0: yFeature,
										_1: {ctor: '[]'}
									}
								},
								model) : _elm_lang$core$Native_Utils.update(
								model,
								{
									hoveredCrosshairs: A2(_elm_lang$core$Set$insert, thisCrosshair, model.hoveredCrosshairs)
								});
						})),
				_1: {ctor: '[]'}
			} : (_elm_lang$core$Native_Utils.eq(model.tool, _user$project$InterfaceModel$PointOrOffset) ? {
				ctor: '::',
				_0: _elm_lang$svg$Svg_Events$onMouseDown(
					A2(
						_user$project$InterfaceModel$Msg,
						'Begin Offset From Point...',
						function (model) {
							return _elm_lang$core$Native_Utils.update(
								model,
								{
									mouseMode: _user$project$InterfaceModel$MouseDrawNew(
										A2(
											_user$project$InterfaceModel$OffsetFromExisting,
											{ctor: '_Tuple2', _0: x, _1: y},
											{ctor: '_Tuple2', _0: xNumTr, _1: yNumTr}))
								});
						})),
				_1: {ctor: '[]'}
			} : {ctor: '[]'});
			return A4(
				_user$project$Canvas$svgXYDot,
				{ctor: '_Tuple2', _0: x, _1: y},
				dotFill,
				isVisible,
				extraAttrs);
		}();
		var yLine = _user$project$Canvas$svgLine(
			A2(
				_elm_lang$core$Basics_ops['++'],
				{
					ctor: '::',
					_0: A2(_user$project$LangSvg$attr, 'stroke', yColor),
					_1: {
						ctor: '::',
						_0: A2(
							_user$project$LangSvg$attr,
							'stroke-width',
							((A2(_elm_lang$core$Set$member, thisCrosshair, model.hoveredCrosshairs) && _elm_lang$core$Native_Utils.eq(model.tool, _user$project$InterfaceModel$Cursor)) || A2(_elm_lang$core$Set$member, yFeature, model.selectedFeatures)) ? _user$project$Canvas$hairStrokeWidth : '0'),
						_1: {
							ctor: '::',
							_0: A2(
								_user$project$LangSvg$attr,
								'x1',
								_elm_lang$core$Basics$toString(x - len)),
							_1: {
								ctor: '::',
								_0: A2(
									_user$project$LangSvg$attr,
									'y1',
									_elm_lang$core$Basics$toString(y)),
								_1: {
									ctor: '::',
									_0: A2(
										_user$project$LangSvg$attr,
										'x2',
										_elm_lang$core$Basics$toString(x + len)),
									_1: {
										ctor: '::',
										_0: A2(
											_user$project$LangSvg$attr,
											'y2',
											_elm_lang$core$Basics$toString(y)),
										_1: {ctor: '[]'}
									}
								}
							}
						}
					}
				},
				(!_elm_lang$core$Native_Utils.eq(model.tool, _user$project$InterfaceModel$Cursor)) ? {ctor: '[]'} : {
					ctor: '::',
					_0: _elm_lang$svg$Svg_Events$onMouseDown(
						_user$project$Canvas$toggleSelected(
							{
								ctor: '::',
								_0: yFeature,
								_1: {ctor: '[]'}
							})),
					_1: {ctor: '[]'}
				}));
		var xLine = _user$project$Canvas$svgLine(
			A2(
				_elm_lang$core$Basics_ops['++'],
				{
					ctor: '::',
					_0: A2(_user$project$LangSvg$attr, 'stroke', xColor),
					_1: {
						ctor: '::',
						_0: A2(
							_user$project$LangSvg$attr,
							'stroke-width',
							((A2(_elm_lang$core$Set$member, thisCrosshair, model.hoveredCrosshairs) && _elm_lang$core$Native_Utils.eq(model.tool, _user$project$InterfaceModel$Cursor)) || A2(_elm_lang$core$Set$member, xFeature, model.selectedFeatures)) ? _user$project$Canvas$hairStrokeWidth : '0'),
						_1: {
							ctor: '::',
							_0: A2(
								_user$project$LangSvg$attr,
								'y1',
								_elm_lang$core$Basics$toString(y - len)),
							_1: {
								ctor: '::',
								_0: A2(
									_user$project$LangSvg$attr,
									'x1',
									_elm_lang$core$Basics$toString(x)),
								_1: {
									ctor: '::',
									_0: A2(
										_user$project$LangSvg$attr,
										'y2',
										_elm_lang$core$Basics$toString(y + len)),
									_1: {
										ctor: '::',
										_0: A2(
											_user$project$LangSvg$attr,
											'x2',
											_elm_lang$core$Basics$toString(x)),
										_1: {ctor: '[]'}
									}
								}
							}
						}
					}
				},
				(!_elm_lang$core$Native_Utils.eq(model.tool, _user$project$InterfaceModel$Cursor)) ? {ctor: '[]'} : {
					ctor: '::',
					_0: _elm_lang$svg$Svg_Events$onMouseDown(
						_user$project$Canvas$toggleSelected(
							{
								ctor: '::',
								_0: xFeature,
								_1: {ctor: '[]'}
							})),
					_1: {ctor: '[]'}
				}));
		return _elm_lang$core$List$singleton(
			A2(
				_elm_lang$svg$Svg$g,
				{
					ctor: '::',
					_0: _elm_lang$html$Html_Events$onMouseLeave(
						_user$project$Canvas$removeHoveredCrosshair(thisCrosshair)),
					_1: {ctor: '[]'}
				},
				{
					ctor: '::',
					_0: backDisc,
					_1: {
						ctor: '::',
						_0: xLine,
						_1: {
							ctor: '::',
							_0: yLine,
							_1: {
								ctor: '::',
								_0: frontDisc,
								_1: {
									ctor: '::',
									_0: xyDot,
									_1: {ctor: '[]'}
								}
							}
						}
					}
				}));
	});
var _user$project$Canvas$maybeZoneSelectCrossDot = F5(
	function (sideLength, model, thisCrosshair, xNumTr, yNumTr) {
		return (_elm_lang$core$Native_Utils.cmp(sideLength, _user$project$Canvas$minLengthForMiddleZones) < 0) ? {ctor: '[]'} : A5(_user$project$Canvas$zoneSelectCrossDot, model, false, thisCrosshair, xNumTr, yNumTr);
	});
var _user$project$Canvas$makeZonesLine = F3(
	function (model, id, l) {
		var transform = _user$project$Canvas$maybeTransformAttr(l);
		var _p118 = _user$project$ShapeWidgets$evaluateLineFeatures(l);
		var x1 = _p118._0;
		var y1 = _p118._1;
		var x2 = _p118._2;
		var y2 = _p118._3;
		var cx = _p118._4;
		var cy = _p118._5;
		var _p119 = {
			ctor: '_Tuple2',
			_0: {ctor: '_Tuple2', _0: x1, _1: y1},
			_1: {ctor: '_Tuple2', _0: x2, _1: y2}
		};
		var pt1 = _p119._0;
		var pt2 = _p119._1;
		var bounds = function () {
			var _p120 = A2(_user$project$Lang$minMax, x1, x2);
			var xMin = _p120._0;
			var xMax = _p120._1;
			var _p121 = A2(_user$project$Lang$minMax, y1, y2);
			var yMin = _p121._0;
			var yMax = _p121._1;
			return {ctor: '_Tuple4', _0: xMin, _1: yMin, _2: xMax, _3: yMax};
		}();
		var zLine = function () {
			var enter = {
				ctor: '::',
				_0: _elm_lang$html$Html_Events$onMouseEnter(
					_user$project$Canvas$addHoveredShape(id)),
				_1: {ctor: '[]'}
			};
			return A7(
				_user$project$Canvas$zoneLine2,
				model,
				id,
				'line',
				_user$project$ShapeWidgets$ZLineEdge,
				pt1,
				pt2,
				A2(_elm_lang$core$Basics_ops['++'], transform, enter));
		}();
		var zonesSelect = _elm_lang$core$List$concat(
			{
				ctor: '::',
				_0: A5(
					_user$project$Canvas$maybeZoneSelectCrossDot,
					A2(_user$project$Canvas$distance, pt1, pt2),
					model,
					{ctor: '_Tuple3', _0: id, _1: 'line', _2: _user$project$ShapeWidgets$Center},
					{ctor: '_Tuple2', _0: cx, _1: _user$project$Lang$dummyTrace},
					{ctor: '_Tuple2', _0: cy, _1: _user$project$Lang$dummyTrace}),
				_1: {
					ctor: '::',
					_0: A5(
						_user$project$Canvas$zoneSelectCrossDot,
						model,
						false,
						{
							ctor: '_Tuple3',
							_0: id,
							_1: 'line',
							_2: _user$project$ShapeWidgets$Point(1)
						},
						{ctor: '_Tuple2', _0: x1, _1: _user$project$Lang$dummyTrace},
						{ctor: '_Tuple2', _0: y1, _1: _user$project$Lang$dummyTrace}),
					_1: {
						ctor: '::',
						_0: A5(
							_user$project$Canvas$zoneSelectCrossDot,
							model,
							false,
							{
								ctor: '_Tuple3',
								_0: id,
								_1: 'line',
								_2: _user$project$ShapeWidgets$Point(2)
							},
							{ctor: '_Tuple2', _0: x2, _1: _user$project$Lang$dummyTrace},
							{ctor: '_Tuple2', _0: y2, _1: _user$project$Lang$dummyTrace}),
						_1: {ctor: '[]'}
					}
				}
			});
		var primaryWidgets = A4(
			_user$project$Canvas$boundingBoxZones,
			model,
			id,
			bounds,
			A2(
				_elm_lang$core$Basics_ops['++'],
				{
					ctor: '::',
					_0: zLine,
					_1: {ctor: '[]'}
				},
				A2(
					_elm_lang$core$Basics_ops['++'],
					zonesSelect,
					A5(
						_user$project$Canvas$zonePoints2,
						model,
						id,
						'line',
						transform,
						{
							ctor: '::',
							_0: pt1,
							_1: {
								ctor: '::',
								_0: pt2,
								_1: {ctor: '[]'}
							}
						}))));
		var extraWidgets = function () {
			var c = A2(_user$project$Canvas$halfwayBetween, pt1, pt2);
			var r = (A2(_user$project$Canvas$distance, pt1, pt2) / 2) - _user$project$Canvas$rotZoneDelta;
			return A2(
				_elm_lang$core$Basics_ops['++'],
				A6(
					_user$project$Canvas$zoneRotate,
					model,
					id,
					'line',
					{ctor: '_Tuple2', _0: cx, _1: cy},
					r,
					_user$project$Canvas$maybeTransformCmds(l)),
				A6(_user$project$Canvas$zonesStroke, model, id, 'line', x2, y2, l));
		}();
		return {ctor: '::', _0: primaryWidgets, _1: extraWidgets};
	});
var _user$project$Canvas$makeZonesPoly = F4(
	function (model, shape, id, l) {
		var _p122 = A2(
			_user$project$Utils$assert,
			'makeZonesPoly',
			_elm_lang$core$Native_Utils.eq(shape, 'polygon') || _elm_lang$core$Native_Utils.eq(shape, 'polyline'));
		var transform = _user$project$Canvas$maybeTransformAttr(l);
		var pts = _user$project$LangSvg$getPolyPoints(l);
		var zPts = A5(_user$project$Canvas$zonePoints, model, id, shape, transform, pts);
		var zLines = function () {
			var pairs = A2(
				_user$project$Utils$adjacentPairs,
				_elm_lang$core$Native_Utils.eq(shape, 'polygon'),
				pts);
			var f = function (_p123) {
				var _p124 = _p123;
				return A7(
					_user$project$Canvas$zoneLine,
					model,
					id,
					shape,
					_user$project$ShapeWidgets$ZPolyEdge(_p124._0),
					_p124._1._0,
					_p124._1._1,
					transform);
			};
			return A2(_user$project$Utils$mapi1, f, pairs);
		}();
		var zInterior = A7(
			_user$project$Canvas$draggableZone,
			_elm_lang$svg$Svg$polygon,
			false,
			model,
			id,
			shape,
			_user$project$ShapeWidgets$ZInterior,
			A2(
				_elm_lang$core$Basics_ops['++'],
				{
					ctor: '::',
					_0: A2(
						_user$project$LangSvg$compileAttr,
						'points',
						_user$project$LangSvg$aPoints(pts)),
					_1: {
						ctor: '::',
						_0: _elm_lang$html$Html_Events$onMouseEnter(
							_user$project$Canvas$addHoveredShape(id)),
						_1: {ctor: '[]'}
					}
				},
				transform));
		var zRot = A5(_user$project$Canvas$zoneRotatePolyOrPath, model, id, 'polygon', pts, l);
		var zFillAndStroke = function () {
			var _p125 = pts;
			if ((((_p125.ctor === '::') && (_p125._0.ctor === '_Tuple2')) && (_p125._0._0.ctor === '_Tuple2')) && (_p125._0._1.ctor === '_Tuple2')) {
				return A6(_user$project$Canvas$zonesFillAndStroke, model, id, shape, _p125._0._0._0, _p125._0._1._0, l);
			} else {
				return _elm_lang$core$Native_Utils.crashCase(
					'Canvas',
					{
						start: {line: 1474, column: 5},
						end: {line: 1478, column: 36}
					},
					_p125)('makeZonesPoly');
			}
		}();
		var zSelect = function () {
			var midptCrossDot = function (_p127) {
				var _p128 = _p127;
				var _p129 = {
					ctor: '_Tuple2',
					_0: (_p128._0._1._0._0 + _p128._1._1._0._0) / 2,
					_1: A2(
						_user$project$Lang$TrOp,
						_user$project$Lang$Plus,
						{
							ctor: '::',
							_0: _p128._0._1._0._1,
							_1: {
								ctor: '::',
								_0: _p128._1._1._0._1,
								_1: {ctor: '[]'}
							}
						})
				};
				var midX = _p129._0;
				var midXTr = _p129._1;
				var _p130 = {
					ctor: '_Tuple2',
					_0: (_p128._0._1._1._0 + _p128._1._1._1._0) / 2,
					_1: A2(
						_user$project$Lang$TrOp,
						_user$project$Lang$Plus,
						{
							ctor: '::',
							_0: _p128._0._1._1._1,
							_1: {
								ctor: '::',
								_0: _p128._1._1._1._1,
								_1: {ctor: '[]'}
							}
						})
				};
				var midY = _p130._0;
				var midYTr = _p130._1;
				return A5(
					_user$project$Canvas$zoneSelectCrossDot,
					model,
					false,
					{
						ctor: '_Tuple3',
						_0: id,
						_1: shape,
						_2: _user$project$ShapeWidgets$Midpoint(_p128._0._0)
					},
					{ctor: '_Tuple2', _0: midX, _1: midXTr},
					{ctor: '_Tuple2', _0: midY, _1: midYTr});
			};
			var ptCrossDot = function (_p131) {
				var _p132 = _p131;
				return A5(
					_user$project$Canvas$zoneSelectCrossDot,
					model,
					false,
					{
						ctor: '_Tuple3',
						_0: id,
						_1: shape,
						_2: _user$project$ShapeWidgets$Point(_p132._0)
					},
					_p132._1._0,
					_p132._1._1);
			};
			var midptCrossDots = function () {
				var ptsI = A2(_user$project$Utils$mapi1, _elm_lang$core$Basics$identity, pts);
				var ptsIPairs = _user$project$Utils$selfZipCircConsecPairs(ptsI);
				return A2(_elm_lang$core$List$concatMap, midptCrossDot, ptsIPairs);
			}();
			var crossDots = _elm_lang$core$List$concat(
				A2(_user$project$Utils$mapi1, ptCrossDot, pts));
			return A2(_elm_lang$core$Basics_ops['++'], midptCrossDots, crossDots);
		}();
		var primaryWidgets = function () {
			var _p133 = _user$project$Draw$boundingBoxOfPoints_(
				A2(
					_elm_lang$core$List$map,
					function (_p134) {
						var _p135 = _p134;
						return {
							ctor: '_Tuple2',
							_0: _elm_lang$core$Tuple$first(_p135._0),
							_1: _elm_lang$core$Tuple$first(_p135._1)
						};
					},
					pts));
			var x1 = _p133._0;
			var x2 = _p133._1;
			var y1 = _p133._2;
			var y2 = _p133._3;
			return A4(
				_user$project$Canvas$boundingBoxZones,
				model,
				id,
				{ctor: '_Tuple4', _0: x1, _1: y1, _2: x2, _3: y2},
				A2(
					_elm_lang$core$Basics_ops['++'],
					{
						ctor: '::',
						_0: zInterior,
						_1: {ctor: '[]'}
					},
					A2(
						_elm_lang$core$Basics_ops['++'],
						zLines,
						A2(_elm_lang$core$Basics_ops['++'], zSelect, zPts))));
		}();
		return {
			ctor: '::',
			_0: primaryWidgets,
			_1: A2(_elm_lang$core$Basics_ops['++'], zRot, zFillAndStroke)
		};
	});
var _user$project$Canvas$makeZonesPath = F4(
	function (model, shape, id, nodeAttrs) {
		var _p136 = A2(
			_user$project$Utils$assert,
			'makeZonesPoly',
			_elm_lang$core$Native_Utils.eq(shape, 'path'));
		var transform = _user$project$Canvas$maybeTransformAttr(nodeAttrs);
		var cmds = _elm_lang$core$Tuple$first(
			_user$project$LangSvg$toPath(
				A2(_user$project$Utils$find_, nodeAttrs, 'd')));
		var add = F2(
			function (_p137, acc) {
				var _p138 = _p137;
				var _p140 = _p138._0;
				var _p139 = _p140;
				if (_p139.ctor === 'Nothing') {
					return acc;
				} else {
					return {
						ctor: '::',
						_0: {ctor: '_Tuple2', _0: _p140, _1: _p138._1},
						_1: acc
					};
				}
			});
		var listOfMaybeIndexWithPt = A3(
			_elm_lang$core$List$foldr,
			F2(
				function (c, acc) {
					var _p141 = c;
					switch (_p141.ctor) {
						case 'CmdZ':
							return acc;
						case 'CmdMLT':
							return A2(add, _p141._1, acc);
						case 'CmdHV':
							return acc;
						case 'CmdC':
							return A2(
								add,
								_p141._1,
								A2(
									add,
									_p141._2,
									A2(add, _p141._3, acc)));
						case 'CmdSQ':
							return A2(
								add,
								_p141._1,
								A2(add, _p141._2, acc));
						default:
							return A2(add, _p141._6, acc);
					}
				}),
			{ctor: '[]'},
			cmds);
		var pts = A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$second, listOfMaybeIndexWithPt);
		var dots = A5(_user$project$Canvas$zonePoints, model, id, shape, transform, pts);
		var zRot = A5(_user$project$Canvas$zoneRotatePolyOrPath, model, id, 'path', pts, nodeAttrs);
		var zFillAndStroke = function () {
			var _p142 = pts;
			if ((((_p142.ctor === '::') && (_p142._0.ctor === '_Tuple2')) && (_p142._0._0.ctor === '_Tuple2')) && (_p142._0._1.ctor === '_Tuple2')) {
				return A6(_user$project$Canvas$zonesFillAndStroke, model, id, shape, _p142._0._0._0, _p142._0._1._0, nodeAttrs);
			} else {
				return _elm_lang$core$Native_Utils.crashCase(
					'Canvas',
					{
						start: {line: 1525, column: 5},
						end: {line: 1529, column: 36}
					},
					_p142)('makeZonesPath');
			}
		}();
		var zSelect = function () {
			var ptCrossDot = function (_p144) {
				var _p145 = _p144;
				var i = _user$project$Utils$fromJust(_p145._0);
				return A5(
					_user$project$Canvas$zoneSelectCrossDot,
					model,
					false,
					{
						ctor: '_Tuple3',
						_0: id,
						_1: shape,
						_2: _user$project$ShapeWidgets$Point(i)
					},
					_p145._1._0,
					_p145._1._1);
			};
			var crossDots = A2(_elm_lang$core$List$concatMap, ptCrossDot, listOfMaybeIndexWithPt);
			return crossDots;
		}();
		var zInterior = A7(
			_user$project$Canvas$draggableZone,
			_elm_lang$svg$Svg$path,
			false,
			model,
			id,
			shape,
			_user$project$ShapeWidgets$ZInterior,
			A2(
				_elm_lang$core$Basics_ops['++'],
				{
					ctor: '::',
					_0: A2(
						_user$project$LangSvg$compileAttr,
						'd',
						A2(_user$project$Utils$find_, nodeAttrs, 'd')),
					_1: {
						ctor: '::',
						_0: _elm_lang$html$Html_Events$onMouseEnter(
							_user$project$Canvas$addHoveredShape(id)),
						_1: {ctor: '[]'}
					}
				},
				transform));
		var primaryWidgets = function () {
			var _p146 = _user$project$Draw$boundingBoxOfPoints_(
				A2(
					_elm_lang$core$List$map,
					function (_p147) {
						var _p148 = _p147;
						return {
							ctor: '_Tuple2',
							_0: _elm_lang$core$Tuple$first(_p148._0),
							_1: _elm_lang$core$Tuple$first(_p148._1)
						};
					},
					pts));
			var x1 = _p146._0;
			var x2 = _p146._1;
			var y1 = _p146._2;
			var y2 = _p146._3;
			return A4(
				_user$project$Canvas$boundingBoxZones,
				model,
				id,
				{ctor: '_Tuple4', _0: x1, _1: y1, _2: x2, _3: y2},
				A2(
					_elm_lang$core$Basics_ops['++'],
					{
						ctor: '::',
						_0: zInterior,
						_1: {ctor: '[]'}
					},
					A2(_elm_lang$core$Basics_ops['++'], zSelect, dots)));
		}();
		return {
			ctor: '::',
			_0: primaryWidgets,
			_1: A2(_elm_lang$core$Basics_ops['++'], zRot, zFillAndStroke)
		};
	});
var _user$project$Canvas$zoneSelectLine_ = F4(
	function (model, nodeIdAndFeatureName, _p150, _p149) {
		var _p151 = _p150;
		var _p152 = _p149;
		var color = A2(_elm_lang$core$Set$member, nodeIdAndFeatureName, model.selectedFeatures) ? _user$project$Canvas$colorLineSelected : _user$project$Canvas$colorLineNotSelected;
		var line = _user$project$Canvas$svgLine(
			{
				ctor: '::',
				_0: A2(_user$project$LangSvg$attr, 'stroke', color),
				_1: {
					ctor: '::',
					_0: A2(_user$project$LangSvg$attr, 'stroke-width', _user$project$Canvas$hairStrokeWidth),
					_1: {
						ctor: '::',
						_0: A2(
							_user$project$LangSvg$attr,
							'x1',
							_elm_lang$core$Basics$toString(_p151._0)),
						_1: {
							ctor: '::',
							_0: A2(
								_user$project$LangSvg$attr,
								'y1',
								_elm_lang$core$Basics$toString(_p151._1)),
							_1: {
								ctor: '::',
								_0: A2(
									_user$project$LangSvg$attr,
									'x2',
									_elm_lang$core$Basics$toString(_p152._0)),
								_1: {
									ctor: '::',
									_0: A2(
										_user$project$LangSvg$attr,
										'y2',
										_elm_lang$core$Basics$toString(_p152._1)),
									_1: {
										ctor: '::',
										_0: _elm_lang$svg$Svg_Events$onMouseDown(
											_user$project$Canvas$toggleSelected(
												{
													ctor: '::',
													_0: nodeIdAndFeatureName,
													_1: {ctor: '[]'}
												})),
										_1: {ctor: '[]'}
									}
								}
							}
						}
					}
				}
			});
		return {
			ctor: '::',
			_0: line,
			_1: {ctor: '[]'}
		};
	});
var _user$project$Canvas$zoneSelectLine = F6(
	function (model, nodeId, kind, featureNum, pt1, pt2) {
		var nodeIdAndFeatureName = {
			ctor: '_Tuple2',
			_0: nodeId,
			_1: A2(
				_user$project$ShapeWidgets$unparseFeatureNum,
				_elm_lang$core$Maybe$Just(kind),
				featureNum)
		};
		var _p153 = model.mouseMode;
		if (_p153.ctor === 'MouseDragZone') {
			return {ctor: '[]'};
		} else {
			return (A2(_elm_lang$core$Set$member, nodeId, model.hoveredShapes) || A2(_elm_lang$core$Set$member, nodeIdAndFeatureName, model.selectedFeatures)) ? A4(_user$project$Canvas$zoneSelectLine_, model, nodeIdAndFeatureName, pt1, pt2) : {ctor: '[]'};
		}
	});
var _user$project$Canvas$maybeZoneSelectLine = F7(
	function (sideLength, model, nodeId, kind, featureNum, pt1, pt2) {
		return (_elm_lang$core$Native_Utils.cmp(sideLength, _user$project$Canvas$minLengthForMiddleZones) < 0) ? {ctor: '[]'} : A6(_user$project$Canvas$zoneSelectLine, model, nodeId, kind, featureNum, pt1, pt2);
	});
var _user$project$Canvas$boxySelectZones = F4(
	function (model, id, kind, boxyNums) {
		var drawPoint = F4(
			function (maybeThreshold, feature, x, y) {
				var _p154 = maybeThreshold;
				if (_p154.ctor === 'Just') {
					return A5(
						_user$project$Canvas$maybeZoneSelectCrossDot,
						_p154._0,
						model,
						{ctor: '_Tuple3', _0: id, _1: kind, _2: feature},
						{ctor: '_Tuple2', _0: x, _1: _user$project$Lang$dummyTrace},
						{ctor: '_Tuple2', _0: y, _1: _user$project$Lang$dummyTrace});
				} else {
					return A5(
						_user$project$Canvas$zoneSelectCrossDot,
						model,
						false,
						{ctor: '_Tuple3', _0: id, _1: kind, _2: feature},
						{ctor: '_Tuple2', _0: x, _1: _user$project$Lang$dummyTrace},
						{ctor: '_Tuple2', _0: y, _1: _user$project$Lang$dummyTrace});
				}
			});
		var drawLine = F4(
			function (threshold, feature, pt1, pt2) {
				return A7(_user$project$Canvas$maybeZoneSelectLine, threshold, model, id, kind, feature, pt1, pt2);
			});
		var _p155 = boxyNums;
		var left = _p155.left;
		var top = _p155.top;
		var right = _p155.right;
		var bot = _p155.bot;
		var cx = _p155.cx;
		var cy = _p155.cy;
		var width = _p155.width;
		var height = _p155.height;
		var distanceZone = function (f) {
			var _p156 = f;
			_v67_5:
			do {
				if (_p156.ctor === 'DistanceFeature') {
					switch (_p156._0.ctor) {
						case 'Width':
							return A4(
								drawLine,
								height,
								_user$project$ShapeWidgets$DFeat(_user$project$ShapeWidgets$Width),
								{ctor: '_Tuple2', _0: left, _1: cy},
								{ctor: '_Tuple2', _0: right, _1: cy});
						case 'Height':
							return A4(
								drawLine,
								width,
								_user$project$ShapeWidgets$DFeat(_user$project$ShapeWidgets$Height),
								{ctor: '_Tuple2', _0: cx, _1: top},
								{ctor: '_Tuple2', _0: cx, _1: bot});
						case 'Radius':
							return A4(
								drawLine,
								width,
								_user$project$ShapeWidgets$DFeat(_user$project$ShapeWidgets$Radius),
								{ctor: '_Tuple2', _0: cx, _1: cy},
								{ctor: '_Tuple2', _0: right, _1: cy});
						case 'RadiusX':
							return A4(
								drawLine,
								height,
								_user$project$ShapeWidgets$DFeat(_user$project$ShapeWidgets$RadiusX),
								{ctor: '_Tuple2', _0: cx, _1: cy},
								{ctor: '_Tuple2', _0: right, _1: cy});
						case 'RadiusY':
							return A4(
								drawLine,
								width,
								_user$project$ShapeWidgets$DFeat(_user$project$ShapeWidgets$RadiusY),
								{ctor: '_Tuple2', _0: cx, _1: top},
								{ctor: '_Tuple2', _0: cx, _1: cy});
						default:
							break _v67_5;
					}
				} else {
					break _v67_5;
				}
			} while(false);
			return {ctor: '[]'};
		};
		var pointZone = function (f) {
			var _p157 = f;
			_v68_9:
			do {
				if (_p157.ctor === 'PointFeature') {
					switch (_p157._0.ctor) {
						case 'TopLeft':
							return A4(drawPoint, _elm_lang$core$Maybe$Nothing, _user$project$ShapeWidgets$TopLeft, left, top);
						case 'TopRight':
							return A4(drawPoint, _elm_lang$core$Maybe$Nothing, _user$project$ShapeWidgets$TopRight, right, top);
						case 'BotLeft':
							return A4(drawPoint, _elm_lang$core$Maybe$Nothing, _user$project$ShapeWidgets$BotLeft, left, bot);
						case 'BotRight':
							return A4(drawPoint, _elm_lang$core$Maybe$Nothing, _user$project$ShapeWidgets$BotRight, right, bot);
						case 'TopEdge':
							return A4(
								drawPoint,
								_elm_lang$core$Maybe$Just(width),
								_user$project$ShapeWidgets$TopEdge,
								cx,
								top);
						case 'BotEdge':
							return A4(
								drawPoint,
								_elm_lang$core$Maybe$Just(width),
								_user$project$ShapeWidgets$BotEdge,
								cx,
								bot);
						case 'LeftEdge':
							return A4(
								drawPoint,
								_elm_lang$core$Maybe$Just(height),
								_user$project$ShapeWidgets$LeftEdge,
								left,
								cy);
						case 'RightEdge':
							return A4(
								drawPoint,
								_elm_lang$core$Maybe$Just(height),
								_user$project$ShapeWidgets$RightEdge,
								right,
								cy);
						case 'Center':
							return A4(
								drawPoint,
								_elm_lang$core$Maybe$Just(
									A2(_elm_lang$core$Basics$min, width, height)),
								_user$project$ShapeWidgets$Center,
								cx,
								cy);
						default:
							break _v68_9;
					}
				} else {
					break _v68_9;
				}
			} while(false);
			return {ctor: '[]'};
		};
		var features = A3(_user$project$Utils$find, 'boxySelectZones', _user$project$ShapeWidgets$simpleKindFeatures, kind);
		return A2(
			_elm_lang$core$Basics_ops['++'],
			A2(_elm_lang$core$List$concatMap, distanceZone, features),
			A2(_elm_lang$core$List$concatMap, pointZone, features));
	});
var _user$project$Canvas$makeZonesRectOrBox = F4(
	function (model, id, shape, l) {
		var boxyNums = A2(_user$project$ShapeWidgets$evaluateBoxyNums, shape, l);
		var _p158 = boxyNums;
		var left = _p158.left;
		var top = _p158.top;
		var right = _p158.right;
		var bot = _p158.bot;
		var cx = _p158.cx;
		var cy = _p158.cy;
		var width = _p158.width;
		var height = _p158.height;
		var bounds = {ctor: '_Tuple4', _0: left, _1: top, _2: right, _3: bot};
		var transform = _user$project$Canvas$maybeTransformAttr(l);
		var zoneInterior = A7(
			_user$project$Canvas$draggableZone,
			_elm_lang$svg$Svg$rect,
			false,
			model,
			id,
			shape,
			_user$project$ShapeWidgets$ZInterior,
			A2(
				_elm_lang$core$Basics_ops['++'],
				{
					ctor: '::',
					_0: A2(_user$project$Canvas$attrNum, 'x', left),
					_1: {
						ctor: '::',
						_0: A2(_user$project$Canvas$attrNum, 'y', top),
						_1: {
							ctor: '::',
							_0: A2(_user$project$Canvas$attrNum, 'width', width),
							_1: {
								ctor: '::',
								_0: A2(_user$project$Canvas$attrNum, 'height', height),
								_1: {
									ctor: '::',
									_0: _elm_lang$html$Html_Events$onMouseEnter(
										_user$project$Canvas$addHoveredShape(id)),
									_1: {ctor: '[]'}
								}
							}
						}
					}
				},
				transform));
		var zonesSelect = A4(_user$project$Canvas$boxySelectZones, model, id, shape, boxyNums);
		var primaryWidgets = A4(
			_user$project$Canvas$boundingBoxZones,
			model,
			id,
			bounds,
			A2(
				_elm_lang$core$Basics_ops['++'],
				{
					ctor: '::',
					_0: zoneInterior,
					_1: {ctor: '[]'}
				},
				A2(
					_elm_lang$core$Basics_ops['++'],
					zonesSelect,
					A5(_user$project$Canvas$eightCardinalZones, model, id, shape, transform, bounds))));
		var extraWidgets = function () {
			var r = _user$project$Canvas$rotZoneDelta + (height / 2);
			return A2(
				_elm_lang$core$Basics_ops['++'],
				A6(
					_user$project$Canvas$zoneRotate,
					model,
					id,
					shape,
					{ctor: '_Tuple2', _0: cx, _1: cy},
					r,
					_user$project$Canvas$maybeTransformCmds(l)),
				A6(_user$project$Canvas$zonesFillAndStroke, model, id, shape, left, top, l));
		}();
		return {ctor: '::', _0: primaryWidgets, _1: extraWidgets};
	});
var _user$project$Canvas$makeZonesCircle = F3(
	function (model, id, l) {
		var boxyNums = A2(_user$project$ShapeWidgets$evaluateBoxyNums, 'circle', l);
		var _p159 = boxyNums;
		var left = _p159.left;
		var top = _p159.top;
		var right = _p159.right;
		var bot = _p159.bot;
		var cx = _p159.cx;
		var cy = _p159.cy;
		var r = _p159.r;
		var bounds = {ctor: '_Tuple4', _0: left, _1: top, _2: right, _3: bot};
		var transform = _user$project$Canvas$maybeTransformAttr(l);
		var zoneInterior = A7(
			_user$project$Canvas$draggableZone,
			_elm_lang$svg$Svg$circle,
			false,
			model,
			id,
			'circle',
			_user$project$ShapeWidgets$ZInterior,
			A2(
				_elm_lang$core$Basics_ops['++'],
				{
					ctor: '::',
					_0: A2(_user$project$Canvas$attrNum, 'cx', cx),
					_1: {
						ctor: '::',
						_0: A2(_user$project$Canvas$attrNum, 'cy', cy),
						_1: {
							ctor: '::',
							_0: A2(_user$project$Canvas$attrNum, 'r', r),
							_1: {
								ctor: '::',
								_0: _elm_lang$html$Html_Events$onMouseEnter(
									_user$project$Canvas$addHoveredShape(id)),
								_1: {ctor: '[]'}
							}
						}
					}
				},
				transform));
		var zonesSelect = A4(_user$project$Canvas$boxySelectZones, model, id, 'circle', boxyNums);
		var primaryWidgets = A4(
			_user$project$Canvas$boundingBoxZones,
			model,
			id,
			bounds,
			A2(
				_elm_lang$core$Basics_ops['++'],
				{
					ctor: '::',
					_0: zoneInterior,
					_1: {ctor: '[]'}
				},
				A2(
					_elm_lang$core$Basics_ops['++'],
					zonesSelect,
					A5(_user$project$Canvas$eightCardinalZones, model, id, 'circle', transform, bounds))));
		var extraWidgets = A2(
			_elm_lang$core$Basics_ops['++'],
			A6(
				_user$project$Canvas$zoneRotate,
				model,
				id,
				'circle',
				{ctor: '_Tuple2', _0: cx, _1: cy},
				r + _user$project$Canvas$rotZoneDelta,
				_user$project$Canvas$maybeTransformCmds(l)),
			A6(_user$project$Canvas$zonesFillAndStroke, model, id, 'circle', cx - r, cy - r, l));
		return {ctor: '::', _0: primaryWidgets, _1: extraWidgets};
	});
var _user$project$Canvas$makeZonesEllipseOrOval = F4(
	function (model, id, shape, l) {
		var boxyNums = A2(_user$project$ShapeWidgets$evaluateBoxyNums, shape, l);
		var _p160 = boxyNums;
		var left = _p160.left;
		var top = _p160.top;
		var right = _p160.right;
		var bot = _p160.bot;
		var width = _p160.width;
		var height = _p160.height;
		var cx = _p160.cx;
		var cy = _p160.cy;
		var rx = _p160.rx;
		var ry = _p160.ry;
		var bounds = {ctor: '_Tuple4', _0: left, _1: top, _2: right, _3: bot};
		var transform = _user$project$Canvas$maybeTransformAttr(l);
		var zoneInterior = A7(
			_user$project$Canvas$draggableZone,
			_elm_lang$svg$Svg$ellipse,
			false,
			model,
			id,
			shape,
			_user$project$ShapeWidgets$ZInterior,
			A2(
				_elm_lang$core$Basics_ops['++'],
				{
					ctor: '::',
					_0: A2(_user$project$Canvas$attrNum, 'cx', cx),
					_1: {
						ctor: '::',
						_0: A2(_user$project$Canvas$attrNum, 'cy', cy),
						_1: {
							ctor: '::',
							_0: A2(_user$project$Canvas$attrNum, 'rx', rx),
							_1: {
								ctor: '::',
								_0: A2(_user$project$Canvas$attrNum, 'ry', ry),
								_1: {
									ctor: '::',
									_0: _elm_lang$html$Html_Events$onMouseEnter(
										_user$project$Canvas$addHoveredShape(id)),
									_1: {ctor: '[]'}
								}
							}
						}
					}
				},
				transform));
		var zonesSelect = A4(_user$project$Canvas$boxySelectZones, model, id, shape, boxyNums);
		var primaryWidgets = A4(
			_user$project$Canvas$boundingBoxZones,
			model,
			id,
			bounds,
			A2(
				_elm_lang$core$Basics_ops['++'],
				{
					ctor: '::',
					_0: zoneInterior,
					_1: {ctor: '[]'}
				},
				A2(
					_elm_lang$core$Basics_ops['++'],
					zonesSelect,
					A5(_user$project$Canvas$eightCardinalZones, model, id, shape, transform, bounds))));
		var extraWidgets = A2(
			_elm_lang$core$Basics_ops['++'],
			A6(
				_user$project$Canvas$zoneRotate,
				model,
				id,
				shape,
				{ctor: '_Tuple2', _0: cx, _1: cy},
				ry + _user$project$Canvas$rotZoneDelta,
				_user$project$Canvas$maybeTransformCmds(l)),
			A6(_user$project$Canvas$zonesFillAndStroke, model, id, shape, cx - rx, cy - ry, l));
		return {ctor: '::', _0: primaryWidgets, _1: extraWidgets};
	});
var _user$project$Canvas$makeZones = F4(
	function (model, shape, id, l) {
		var _p161 = shape;
		switch (_p161) {
			case 'line':
				return A3(_user$project$Canvas$makeZonesLine, model, id, l);
			case 'rect':
				return A4(_user$project$Canvas$makeZonesRectOrBox, model, id, shape, l);
			case 'BOX':
				return A4(_user$project$Canvas$makeZonesRectOrBox, model, id, shape, l);
			case 'circle':
				return A3(_user$project$Canvas$makeZonesCircle, model, id, l);
			case 'ellipse':
				return A4(_user$project$Canvas$makeZonesEllipseOrOval, model, id, shape, l);
			case 'OVAL':
				return A4(_user$project$Canvas$makeZonesEllipseOrOval, model, id, shape, l);
			case 'polygon':
				return A4(_user$project$Canvas$makeZonesPoly, model, shape, id, l);
			case 'polyline':
				return A4(_user$project$Canvas$makeZonesPoly, model, shape, id, l);
			case 'path':
				return A4(_user$project$Canvas$makeZonesPath, model, shape, id, l);
			default:
				return {ctor: '[]'};
		}
	});
var _user$project$Canvas$buildSvg_ = F3(
	function (stuff, d, i) {
		var _p162 = stuff;
		var model = _p162._0;
		var addZones = _p162._1;
		var _p163 = A3(
			_user$project$Utils$justGet_,
			A2(
				_elm_lang$core$Basics_ops['++'],
				'buildSvg_ ',
				_elm_lang$core$Basics$toString(i)),
			i,
			d);
		if (_p163.ctor === 'TextNode') {
			return _elm_lang$virtual_dom$VirtualDom$text(_p163._0);
		} else {
			var _p170 = _p163._0;
			var _p169 = _p163._1;
			var _p164 = {
				ctor: '_Tuple2',
				_0: model.showGhosts,
				_1: A2(_user$project$Utils$maybeRemoveFirst, 'HIDDEN', _p169)
			};
			if (((_p164.ctor === '_Tuple2') && (_p164._0 === false)) && (_p164._1.ctor === 'Just')) {
				return A2(
					_elm_lang$svg$Svg$svg,
					{ctor: '[]'},
					{ctor: '[]'});
			} else {
				var _p165 = function () {
					var _p166 = {
						ctor: '_Tuple2',
						_0: addZones,
						_1: A2(_user$project$Utils$maybeRemoveFirst, 'ZONES', _p169)
					};
					if (_p166._0 === false) {
						if (_p166._1.ctor === 'Nothing') {
							return {
								ctor: '_Tuple2',
								_0: {ctor: '[]'},
								_1: _p169
							};
						} else {
							return {
								ctor: '_Tuple2',
								_0: {ctor: '[]'},
								_1: _p166._1._0._1
							};
						}
					} else {
						if (_p166._1.ctor === 'Nothing') {
							return {
								ctor: '_Tuple2',
								_0: A4(_user$project$Canvas$makeZones, model, _p170, i, _p169),
								_1: _p169
							};
						} else {
							var _p167 = _p166._1._0._0.av_;
							return {
								ctor: '_Tuple2',
								_0: A4(_user$project$Canvas$makeZones, model, _p170, i, _p169),
								_1: _p166._1._0._1
							};
						}
					}
				}();
				var zones = _p165._0;
				var attrs_ = _p165._1;
				var children = A2(
					_elm_lang$core$List$map,
					A2(_user$project$Canvas$buildSvg_, stuff, d),
					_p163._2);
				var mainshape = function () {
					var _p168 = A2(_user$project$LangSvg$desugarShapeAttrs, _p170, attrs_);
					var rawKind = _p168._0;
					var rawAttrs = _p168._1;
					return A3(
						_elm_lang$svg$Svg$node,
						rawKind,
						_user$project$LangSvg$compileAttrs(rawAttrs),
						children);
				}();
				return _elm_lang$core$Native_Utils.eq(
					zones,
					{ctor: '[]'}) ? mainshape : A2(
					_elm_lang$svg$Svg$svg,
					{ctor: '[]'},
					{ctor: '::', _0: mainshape, _1: zones});
			}
		}
	});
var _user$project$Canvas$buildSvg = F2(
	function (options, _p171) {
		var _p172 = _p171;
		return A3(_user$project$Canvas$buildSvg_, options, _p172._1, _p172._0);
	});
var _user$project$Canvas$iconify = F2(
	function (env, code) {
		var subPadding = function (x) {
			return x - 10;
		};
		var exp = A2(
			_user$project$Utils$fromOkay,
			'Error parsing icon',
			_user$project$FastParser$parseE(code));
		var _p173 = A2(
			_user$project$Utils$fromOkay,
			'Error evaluating icon',
			A2(_user$project$Eval$doEval, env, exp));
		var val = _p173._0._0;
		var tree = A2(
			_user$project$Utils$fromOkay,
			'Error resolving index tree of icon',
			A4(_user$project$LangSvg$resolveToIndexedTree, 1, 1, 0, val));
		var svgElements = A2(
			_user$project$Canvas$buildSvg,
			{
				ctor: '_Tuple2',
				_0: _elm_lang$core$Native_Utils.update(
					_user$project$InterfaceModel$initModel,
					{showGhosts: false}),
				_1: false
			},
			tree);
		return A2(
			_elm_lang$svg$Svg$svg,
			{
				ctor: '::',
				_0: _elm_lang$svg$Svg_Attributes$width(
					function (_p174) {
						return _user$project$SleekLayout$px(
							subPadding(
								function (_) {
									return _.width;
								}(_p174)));
					}(_user$project$SleekLayout$iconButton)),
				_1: {
					ctor: '::',
					_0: _elm_lang$svg$Svg_Attributes$height(
						function (_p175) {
							return _user$project$SleekLayout$px(
								subPadding(
									function (_) {
										return _.height;
									}(_p175)));
						}(_user$project$SleekLayout$iconButton)),
					_1: {ctor: '[]'}
				}
			},
			{
				ctor: '::',
				_0: svgElements,
				_1: {ctor: '[]'}
			});
	});
var _user$project$Canvas$pixels = function (n) {
	return A2(
		_elm_lang$core$Basics_ops['++'],
		_elm_lang$core$Basics$toString(n),
		'px');
};
var _user$project$Canvas$strOldButtonTopColor = 'rgba(231,76,60,1.0)';
var _user$project$Canvas$strOldInterfaceColor = 'rgba(52,73,94,1.0)';
var _user$project$Canvas$buildSvgWidgets = F4(
	function (wCanvas, hCanvas, widgets, model) {
		var numWidgets = _elm_lang$core$List$length(widgets);
		var wCaption = _user$project$Config$params.mainSection.uiWidgets.wCaption;
		var hSlider = _user$project$Config$params.mainSection.uiWidgets.hSlider;
		var wSlider = _user$project$Config$params.mainSection.uiWidgets.wSlider;
		var pad = _user$project$Config$params.mainSection.uiWidgets.pad;
		var wWidget = (wSlider + wCaption) + (2 * pad);
		var hWidget = hSlider + (2 * pad);
		var wToolBoxMax = _elm_lang$core$Basics$toFloat(wCanvas - (2 * pad));
		var numCols = _elm_lang$core$Basics$floor(wToolBoxMax / wWidget);
		var numRows = _elm_lang$core$Basics$ceiling(
			_elm_lang$core$Basics$toFloat(numWidgets) / _elm_lang$core$Basics$toFloat(numCols));
		var hToolBox = numRows * hWidget;
		var wToolBox = numCols * wWidget;
		var xL = pad;
		var yBL = (hCanvas - hWidget) - pad;
		var drawNumWidget = F7(
			function (i_, widget, locId, cap_, minVal, maxVal, curVal) {
				var i = i_ - 1;
				var idAsShape = -2 - i_;
				var _p176 = {
					ctor: '_Tuple2',
					_0: A2(_elm_lang$core$Basics_ops['%'], i, numRows),
					_1: (i / numRows) | 0
				};
				var r = _p176._0;
				var c = _p176._1;
				var xi = xL + (c * wWidget);
				var xi_ = xi + pad;
				var yi = yBL - (r * hWidget);
				var yi_ = yi + pad;
				var region = A3(
					_elm_lang$core$Basics$flip,
					_elm_lang$svg$Svg$rect,
					{ctor: '[]'},
					{
						ctor: '::',
						_0: A2(_user$project$LangSvg$attr, 'fill', 'lightgray'),
						_1: {
							ctor: '::',
							_0: A2(_user$project$LangSvg$attr, 'stroke', _user$project$Canvas$strOldInterfaceColor),
							_1: {
								ctor: '::',
								_0: A2(_user$project$LangSvg$attr, 'stroke-width', '3px'),
								_1: {
									ctor: '::',
									_0: A2(_user$project$LangSvg$attr, 'rx', '9px'),
									_1: {
										ctor: '::',
										_0: A2(_user$project$LangSvg$attr, 'ry', '9px'),
										_1: {
											ctor: '::',
											_0: A2(
												_user$project$LangSvg$attr,
												'x',
												_elm_lang$core$Basics$toString(xL + (c * wWidget))),
											_1: {
												ctor: '::',
												_0: A2(
													_user$project$LangSvg$attr,
													'y',
													_elm_lang$core$Basics$toString(yBL - (r * hWidget))),
												_1: {
													ctor: '::',
													_0: A2(
														_user$project$LangSvg$attr,
														'width',
														_elm_lang$core$Basics$toString(wWidget)),
													_1: {
														ctor: '::',
														_0: A2(
															_user$project$LangSvg$attr,
															'height',
															_elm_lang$core$Basics$toString(hWidget)),
														_1: {ctor: '[]'}
													}
												}
											}
										}
									}
								}
							}
						}
					});
				var box = function () {
					var nodeIdAndFeatureName = {ctor: '_Tuple2', _0: idAsShape, _1: 'slider'};
					var color = function () {
						var _p177 = model.tool;
						if (_p177.ctor === 'Cursor') {
							return A2(_elm_lang$core$Set$member, nodeIdAndFeatureName, model.selectedFeatures) ? _user$project$Canvas$colorPointSelected : _user$project$Canvas$strOldInterfaceColor;
						} else {
							return _user$project$Canvas$strOldInterfaceColor;
						}
					}();
					return A3(
						_elm_lang$core$Basics$flip,
						_elm_lang$svg$Svg$rect,
						{ctor: '[]'},
						{
							ctor: '::',
							_0: A2(_user$project$LangSvg$attr, 'fill', color),
							_1: {
								ctor: '::',
								_0: A2(_user$project$LangSvg$attr, 'stroke', '20px'),
								_1: {
									ctor: '::',
									_0: A2(_user$project$LangSvg$attr, 'stroke-width', '20px'),
									_1: {
										ctor: '::',
										_0: A2(
											_user$project$LangSvg$attr,
											'x',
											_elm_lang$core$Basics$toString((xL + (c * wWidget)) + pad)),
										_1: {
											ctor: '::',
											_0: A2(
												_user$project$LangSvg$attr,
												'y',
												_elm_lang$core$Basics$toString((yBL - (r * hWidget)) + pad)),
											_1: {
												ctor: '::',
												_0: A2(
													_user$project$LangSvg$attr,
													'width',
													_elm_lang$core$Basics$toString(wSlider)),
												_1: {
													ctor: '::',
													_0: A2(
														_user$project$LangSvg$attr,
														'height',
														_elm_lang$core$Basics$toString(hSlider)),
													_1: {
														ctor: '::',
														_0: _elm_lang$svg$Svg_Events$onMouseDown(
															_user$project$Canvas$toggleSelected(
																{
																	ctor: '::',
																	_0: nodeIdAndFeatureName,
																	_1: {ctor: '[]'}
																})),
														_1: {ctor: '[]'}
													}
												}
											}
										}
									}
								}
							}
						});
				}();
				var ball = function () {
					var _p178 = {ctor: '_Tuple2', _0: maxVal - minVal, _1: curVal - minVal};
					var range = _p178._0;
					var diff = _p178._1;
					var pct = diff / range;
					var cx = (xi + pad) + _elm_lang$core$Basics$round(pct * wSlider);
					var cy = (yi + pad) + ((hSlider / 2) | 0);
					return A3(
						_elm_lang$core$Basics$flip,
						_elm_lang$svg$Svg$circle,
						{ctor: '[]'},
						A2(
							_elm_lang$core$Basics_ops['++'],
							{
								ctor: '::',
								_0: A2(_user$project$LangSvg$attr, 'stroke', 'black'),
								_1: {
									ctor: '::',
									_0: A2(_user$project$LangSvg$attr, 'stroke-width', '2px'),
									_1: {
										ctor: '::',
										_0: A2(_user$project$LangSvg$attr, 'fill', _user$project$Canvas$strOldButtonTopColor),
										_1: {
											ctor: '::',
											_0: A2(_user$project$LangSvg$attr, 'r', _user$project$Config$params.mainSection.uiWidgets.rBall),
											_1: {
												ctor: '::',
												_0: A2(
													_user$project$LangSvg$attr,
													'cx',
													_elm_lang$core$Basics$toString(cx)),
												_1: {
													ctor: '::',
													_0: A2(
														_user$project$LangSvg$attr,
														'cy',
														_elm_lang$core$Basics$toString(cy)),
													_1: {
														ctor: '::',
														_0: A2(_user$project$Canvas$cursorOfZone, _user$project$ShapeWidgets$ZSlider, 'default'),
														_1: {ctor: '[]'}
													}
												}
											}
										}
									}
								}
							},
							A3(_user$project$Canvas$dragZoneEvents, idAsShape, 'slider', _user$project$ShapeWidgets$ZSlider)));
				}();
				var text = function () {
					var cap = A2(
						_elm_lang$core$Basics_ops['++'],
						cap_,
						A2(_user$project$Lang$strNumTrunc, 5, curVal));
					return A3(
						_elm_lang$core$Basics$flip,
						_elm_lang$svg$Svg$text_,
						{
							ctor: '::',
							_0: _elm_lang$virtual_dom$VirtualDom$text(cap),
							_1: {ctor: '[]'}
						},
						{
							ctor: '::',
							_0: A2(_user$project$LangSvg$attr, 'fill', 'black'),
							_1: {
								ctor: '::',
								_0: A2(_user$project$LangSvg$attr, 'font-family', _user$project$Config$params.mainSection.uiWidgets.font),
								_1: {
									ctor: '::',
									_0: A2(_user$project$LangSvg$attr, 'font-size', _user$project$Config$params.mainSection.uiWidgets.fontSize),
									_1: {
										ctor: '::',
										_0: A2(
											_user$project$LangSvg$attr,
											'x',
											_elm_lang$core$Basics$toString((xi_ + wSlider) + 10)),
										_1: {
											ctor: '::',
											_0: A2(
												_user$project$LangSvg$attr,
												'y',
												_elm_lang$core$Basics$toString(yi_ + 18)),
											_1: {ctor: '[]'}
										}
									}
								}
							}
						});
				}();
				return {
					ctor: '::',
					_0: region,
					_1: {
						ctor: '::',
						_0: box,
						_1: {
							ctor: '::',
							_0: text,
							_1: {
								ctor: '::',
								_0: ball,
								_1: {ctor: '[]'}
							}
						}
					}
				};
			});
		var drawPointWidget = F4(
			function (i_, widget, _p180, _p179) {
				var _p181 = _p180;
				var _p184 = _p181._0;
				var _p182 = _p179;
				var _p183 = _p182._0;
				var idAsShape = -2 - i_;
				return A2(
					_elm_lang$core$Basics_ops['++'],
					A5(
						_user$project$Canvas$zoneSelectCrossDot,
						model,
						true,
						{ctor: '_Tuple3', _0: idAsShape, _1: 'point', _2: _user$project$ShapeWidgets$LonePoint},
						{ctor: '_Tuple2', _0: _p184, _1: _p181._1},
						{ctor: '_Tuple2', _0: _p183, _1: _p182._1}),
					(!_elm_lang$core$Native_Utils.eq(model.tool, _user$project$InterfaceModel$Cursor)) ? {ctor: '[]'} : A7(
						_user$project$Canvas$zonePoint,
						model,
						true,
						idAsShape,
						'point',
						_user$project$ShapeWidgets$ZPoint(_user$project$ShapeWidgets$LonePoint),
						{ctor: '[]'},
						{
							ctor: '::',
							_0: A2(_user$project$Canvas$attrNum, 'cx', _p184),
							_1: {
								ctor: '::',
								_0: A2(_user$project$Canvas$attrNum, 'cy', _p183),
								_1: {ctor: '[]'}
							}
						}));
			});
		var drawOffsetWidget1D = F6(
			function (i_, baseX, baseY, axis, sign, _p185) {
				var _p186 = _p185;
				var _p188 = _p186._0;
				var idAsShape = -2 - i_;
				var isSelected = A2(
					_elm_lang$core$Set$member,
					{ctor: '_Tuple2', _0: idAsShape, _1: 'offset'},
					model.selectedFeatures);
				var dragStyle = _elm_lang$core$Native_Utils.eq(model.tool, _user$project$InterfaceModel$Cursor) ? A2(
					_elm_lang$core$Basics_ops['++'],
					{
						ctor: '::',
						_0: A2(_user$project$LangSvg$attr, 'cursor', 'pointer'),
						_1: {
							ctor: '::',
							_0: _elm_lang$html$Html_Events$onMouseEnter(
								_user$project$Canvas$addHoveredShape(idAsShape)),
							_1: {ctor: '[]'}
						}
					},
					A3(_user$project$Canvas$dragZoneEvents, idAsShape, 'offset', _user$project$ShapeWidgets$ZOffset1D)) : {
					ctor: '::',
					_0: A2(_user$project$LangSvg$attr, 'cursor', 'default'),
					_1: {ctor: '[]'}
				};
				var maybeCaptionText = _user$project$Lang$traceToMaybeIdent(_p186._1);
				var _p187 = A7(
					_user$project$Canvas$svgOffsetWidget1DArrowPartsAndEndPoint,
					{ctor: '_Tuple2', _0: baseX, _1: baseY},
					axis,
					sign,
					_p188,
					maybeCaptionText,
					isSelected,
					dragStyle);
				var arrowParts = _p187._0;
				var endX = _p187._1._0;
				var endY = _p187._1._1;
				var endPt = A5(
					_user$project$Canvas$zoneSelectCrossDot,
					model,
					false,
					{ctor: '_Tuple3', _0: idAsShape, _1: 'offset', _2: _user$project$ShapeWidgets$EndPoint},
					{ctor: '_Tuple2', _0: endX, _1: _user$project$Lang$dummyTrace},
					{ctor: '_Tuple2', _0: endY, _1: _user$project$Lang$dummyTrace});
				return (!_elm_lang$core$Native_Utils.eq(_p188, 0)) ? {
					ctor: '::',
					_0: A2(
						_elm_lang$svg$Svg$g,
						{
							ctor: '::',
							_0: _elm_lang$html$Html_Events$onMouseLeave(
								_user$project$Canvas$removeHoveredShape(idAsShape)),
							_1: {ctor: '[]'}
						},
						A2(_elm_lang$core$Basics_ops['++'], arrowParts, endPt)),
					_1: {ctor: '[]'}
				} : {ctor: '[]'};
			});
		var draw = function (_p189) {
			var _p190 = _p189;
			var _p194 = _p190._1;
			var _p193 = _p190._0;
			var _p191 = _p194;
			switch (_p191.ctor) {
				case 'WNumSlider':
					if (_p191._5 === true) {
						return {ctor: '[]'};
					} else {
						return A7(drawNumWidget, _p193, _p194, _p191._4._0, _p191._2, _p191._0, _p191._1, _p191._3);
					}
				case 'WIntSlider':
					if (_p191._5 === true) {
						return {ctor: '[]'};
					} else {
						var _p192 = {
							ctor: '_Tuple3',
							_0: _elm_lang$core$Basics$toFloat(_p191._0),
							_1: _elm_lang$core$Basics$toFloat(_p191._1),
							_2: _elm_lang$core$Basics$toFloat(_p191._3)
						};
						var minVal = _p192._0;
						var maxVal = _p192._1;
						var curVal = _p192._2;
						return A7(drawNumWidget, _p193, _p194, _p191._4._0, _p191._2, minVal, maxVal, curVal);
					}
				case 'WPoint':
					return _user$project$InterfaceModel$splash_i_2017_demo ? {ctor: '[]'} : A4(drawPointWidget, _p193, _p194, _p191._0, _p191._1);
				default:
					return _user$project$InterfaceModel$splash_i_2017_demo ? {ctor: '[]'} : A6(drawOffsetWidget1D, _p193, _p191._0._0, _p191._1._0, _p191._2, _p191._3, _p191._4);
			}
		};
		return _elm_lang$core$List$concat(
			A2(_user$project$Utils$mapi1, draw, widgets));
	});
var _user$project$Canvas$build = F3(
	function (wCanvas, hCanvas, model) {
		var addZones = function () {
			var _p195 = {ctor: '_Tuple3', _0: _user$project$UserStudy$enabled, _1: model.outputMode, _2: model.preview};
			_v81_2:
			do {
				if (_p195.ctor === '_Tuple3') {
					if (_p195._0 === true) {
						return false;
					} else {
						if ((_p195._1.ctor === 'Live') && (_p195._2.ctor === 'Nothing')) {
							return _elm_lang$core$Native_Utils.eq(model.tool, _user$project$InterfaceModel$Cursor);
						} else {
							break _v81_2;
						}
					}
				} else {
					break _v81_2;
				}
			} while(false);
			return false;
		}();
		var _p196 = function () {
			var _p197 = model.preview;
			if ((((_p197.ctor === 'Just') && (_p197._0.ctor === '_Tuple2')) && (_p197._0._1.ctor === 'Ok')) && (_p197._0._1._0.ctor === '_Tuple3')) {
				return {ctor: '_Tuple2', _0: _p197._0._1._0._1, _1: _p197._0._1._0._2};
			} else {
				return {ctor: '_Tuple2', _0: model.widgets, _1: model.slate};
			}
		}();
		var widgets = _p196._0;
		var slate = _p196._1;
		var outputShapes = A2(
			_user$project$Canvas$buildSvg,
			{ctor: '_Tuple2', _0: model, _1: addZones},
			slate);
		var newShape = _user$project$Canvas$drawNewShape(model);
		var svgWidgets = function () {
			var _p198 = {ctor: '_Tuple2', _0: model.outputMode, _1: model.showGhosts};
			if (((_p198.ctor === '_Tuple2') && (_p198._0.ctor === 'Live')) && (_p198._1 === true)) {
				return A4(_user$project$Canvas$buildSvgWidgets, wCanvas, hCanvas, widgets, model);
			} else {
				return {ctor: '[]'};
			}
		}();
		return A2(
			_elm_lang$svg$Svg$svg,
			{
				ctor: '::',
				_0: _elm_lang$html$Html_Attributes$id('outputCanvas'),
				_1: {
					ctor: '::',
					_0: _elm_lang$svg$Svg_Events$onMouseDown(_user$project$Canvas$msgMouseClickCanvas),
					_1: {
						ctor: '::',
						_0: _elm_lang$html$Html_Attributes$style(
							{
								ctor: '::',
								_0: {
									ctor: '_Tuple2',
									_0: 'width',
									_1: _user$project$Canvas$pixels(wCanvas)
								},
								_1: {
									ctor: '::',
									_0: {
										ctor: '_Tuple2',
										_0: 'height',
										_1: _user$project$Canvas$pixels(hCanvas)
									},
									_1: {ctor: '[]'}
								}
							}),
						_1: {ctor: '[]'}
					}
				}
			},
			A2(
				_elm_lang$core$Basics_ops['++'],
				{
					ctor: '::',
					_0: outputShapes,
					_1: {ctor: '[]'}
				},
				A2(_elm_lang$core$Basics_ops['++'], newShape, svgWidgets)));
	});

var _user$project$LangSimplify$simpleIdentsAndAssigns = F2(
	function (letPat, letAssign) {
		var _p0 = {ctor: '_Tuple2', _0: letPat.val.p__, _1: letAssign.val.e__};
		_v0_2:
		do {
			if (_p0.ctor === '_Tuple2') {
				switch (_p0._0.ctor) {
					case 'PVar':
						return {
							ctor: '::',
							_0: {ctor: '_Tuple2', _0: _p0._0._1, _1: letAssign},
							_1: {ctor: '[]'}
						};
					case 'PList':
						if (((_p0._0._3.ctor === 'Nothing') && (_p0._1.ctor === 'EList')) && (_p0._1._3.ctor === 'Nothing')) {
							var patsAssigns = A2(_user$project$Utils$zip, _p0._0._1, _p0._1._1);
							var simplePatsAssigns = A2(
								_elm_lang$core$List$filterMap,
								function (_p1) {
									var _p2 = _p1;
									var _p3 = _p2._0.val.p__;
									if (_p3.ctor === 'PVar') {
										return _elm_lang$core$Maybe$Just(
											{ctor: '_Tuple2', _0: _p3._1, _1: _p2._1});
									} else {
										return _elm_lang$core$Maybe$Nothing;
									}
								},
								patsAssigns);
							return simplePatsAssigns;
						} else {
							break _v0_2;
						}
					default:
						break _v0_2;
				}
			} else {
				break _v0_2;
			}
		} while(false);
		return {ctor: '[]'};
	});
var _user$project$LangSimplify$inlineTrivialRenamings = function (exp) {
	var inlineReplaceIfTrivialRename = F3(
		function (targetIdent, newExp, e__) {
			var _p4 = e__;
			if (_p4.ctor === 'ELet') {
				var _p12 = _p4._6;
				var _p11 = _p4._0;
				var _p10 = _p4._2;
				var _p9 = _p4._3;
				var _p8 = _p4._1;
				var _p7 = _p4._5;
				var _p5 = {ctor: '_Tuple2', _0: _p9.val.p__, _1: _p4._4.val.e__};
				_v4_2:
				do {
					if (_p5.ctor === '_Tuple2') {
						switch (_p5._0.ctor) {
							case 'PVar':
								if (_p5._1.ctor === 'EVar') {
									if (_elm_lang$core$Native_Utils.eq(_p5._1._1, targetIdent)) {
										var newExpAdjustedWs = A2(_user$project$Lang$replacePrecedingWhitespace, _p5._1._0.val, newExp);
										return A7(_user$project$Lang$ELet, _p11, _p8, _p10, _p9, newExpAdjustedWs, _p7, _p12);
									} else {
										return e__;
									}
								} else {
									break _v4_2;
								}
							case 'PList':
								if (((_p5._0._3.ctor === 'Nothing') && (_p5._1.ctor === 'EList')) && (_p5._1._3.ctor === 'Nothing')) {
									var newAssigns = A2(
										_elm_lang$core$List$map,
										function (assignExp) {
											var _p6 = assignExp.val.e__;
											if (_p6.ctor === 'EVar') {
												if (_elm_lang$core$Native_Utils.eq(_p6._1, targetIdent)) {
													var oldPrecedingWs = _user$project$Lang$precedingWhitespace(assignExp);
													return A2(_user$project$Lang$replacePrecedingWhitespace, oldPrecedingWs, newExp);
												} else {
													return assignExp;
												}
											} else {
												return assignExp;
											}
										},
										_p5._1._1);
									var newAssignsListExp = _user$project$Lang$withDummyExpInfo(
										A5(_user$project$Lang$EList, _p5._1._0, newAssigns, _p5._1._2, _elm_lang$core$Maybe$Nothing, _p5._1._4));
									return A7(_user$project$Lang$ELet, _p11, _p8, _p10, _p9, newAssignsListExp, _p7, _p12);
								} else {
									break _v4_2;
								}
							default:
								break _v4_2;
						}
					} else {
						break _v4_2;
					}
				} while(false);
				return e__;
			} else {
				return e__;
			}
		});
	var inliner = function (e__) {
		var _p13 = e__;
		if (_p13.ctor === 'ELet') {
			var _p20 = _p13._3;
			var _p19 = _p13._5;
			var _p18 = _p13._4;
			var nameCounts = _user$project$LangTools$identifierCounts(_p19);
			var letRemoved = function (newBody) {
				var oldPrecedingWs = _user$project$Lang$precedingWhitespaceExp__(e__);
				return A2(_user$project$Lang$replacePrecedingWhitespace, oldPrecedingWs, newBody).val.e__;
			};
			var identsAndAssignsInliningCandidates = A2(
				_elm_lang$core$List$filter,
				function (_p14) {
					var _p15 = _p14;
					return _elm_lang$core$Native_Utils.eq(
						1,
						A3(_user$project$Utils$getWithDefault, _p15._0, 0, nameCounts));
				},
				A2(_user$project$LangSimplify$simpleIdentsAndAssigns, _p20, _p18));
			var newBody = A3(
				_elm_lang$core$List$foldl,
				F2(
					function (_p16, resultExp) {
						var _p17 = _p16;
						return A2(
							_user$project$Lang$mapExpViaExp__,
							A2(inlineReplaceIfTrivialRename, _p17._0, _p17._1),
							resultExp);
					}),
				_p19,
				identsAndAssignsInliningCandidates);
			return A7(_user$project$Lang$ELet, _p13._0, _p13._1, _p13._2, _p20, _p18, newBody, _p13._6);
		} else {
			return e__;
		}
	};
	return A2(_user$project$Lang$mapExpViaExp__, inliner, exp);
};
var _user$project$LangSimplify$changeRenamedVarsToOuter_ = F2(
	function (renamings, exp) {
		var recurse = _user$project$LangSimplify$changeRenamedVarsToOuter_(renamings);
		var e__New = function () {
			var e__ = exp.val.e__;
			var removeIdentsFromRenaming = F2(
				function (identsToRemove, renamings) {
					return A2(
						_elm_lang$core$Dict$filter,
						F2(
							function (oldName, newName) {
								return (!A2(_elm_lang$core$Set$member, oldName, identsToRemove)) && (!A2(_elm_lang$core$Set$member, newName, identsToRemove));
							}),
						renamings);
				});
			var _p21 = e__;
			switch (_p21.ctor) {
				case 'EConst':
					return e__;
				case 'EBase':
					return e__;
				case 'EVar':
					var _p22 = A2(_elm_lang$core$Dict$get, _p21._1, renamings);
					if (_p22.ctor === 'Just') {
						return A2(_user$project$Lang$EVar, _p21._0, _p22._0);
					} else {
						return e__;
					}
				case 'ELet':
					var _p28 = _p21._2;
					var _p27 = _p21._3;
					var _p26 = _p21._4;
					var newlyAssignedIdents = _user$project$LangTools$identifiersSetInPat(_p27);
					var renamingsShadowsRemoved = A2(removeIdentsFromRenaming, newlyAssignedIdents, renamings);
					var assign_ = _p28 ? A2(_user$project$LangSimplify$changeRenamedVarsToOuter_, renamingsShadowsRemoved, _p26) : recurse(_p26);
					var identsAndAssigns = A2(_user$project$LangSimplify$simpleIdentsAndAssigns, _p27, assign_);
					var simpleRenamings = A2(
						_elm_lang$core$List$filterMap,
						function (_p23) {
							var _p24 = _p23;
							var _p25 = _p24._1.val.e__;
							if (_p25.ctor === 'EVar') {
								return _elm_lang$core$Maybe$Just(
									{ctor: '_Tuple2', _0: _p24._0, _1: _p25._1});
							} else {
								return _elm_lang$core$Maybe$Nothing;
							}
						},
						identsAndAssigns);
					var renamings_ = A2(
						_elm_lang$core$Dict$union,
						_elm_lang$core$Dict$fromList(simpleRenamings),
						renamingsShadowsRemoved);
					var body_ = A2(_user$project$LangSimplify$changeRenamedVarsToOuter_, renamings_, _p21._5);
					return A7(_user$project$Lang$ELet, _p21._0, _p21._1, _p28, _p27, assign_, body_, _p21._6);
				case 'EFun':
					var _p29 = _p21._1;
					var newlyAssignedIdents = A3(
						_elm_lang$core$List$foldl,
						_elm_lang$core$Set$union,
						_elm_lang$core$Set$empty,
						A2(_elm_lang$core$List$map, _user$project$LangTools$identifiersSetInPat, _p29));
					var renamingsShadowsRemoved = A2(removeIdentsFromRenaming, newlyAssignedIdents, renamings);
					return A4(
						_user$project$Lang$EFun,
						_p21._0,
						_p29,
						A2(_user$project$LangSimplify$changeRenamedVarsToOuter_, renamingsShadowsRemoved, _p21._2),
						_p21._3);
				case 'EApp':
					return A4(
						_user$project$Lang$EApp,
						_p21._0,
						recurse(_p21._1),
						A2(_elm_lang$core$List$map, recurse, _p21._2),
						_p21._3);
				case 'EOp':
					return A4(
						_user$project$Lang$EOp,
						_p21._0,
						_p21._1,
						A2(_elm_lang$core$List$map, recurse, _p21._2),
						_p21._3);
				case 'EList':
					return A5(
						_user$project$Lang$EList,
						_p21._0,
						A2(_elm_lang$core$List$map, recurse, _p21._1),
						_p21._2,
						A2(_user$project$Utils$mapMaybe, recurse, _p21._3),
						_p21._4);
				case 'EIf':
					return A5(
						_user$project$Lang$EIf,
						_p21._0,
						recurse(_p21._1),
						recurse(_p21._2),
						recurse(_p21._3),
						_p21._4);
				case 'ECase':
					var newBranches = A2(
						_elm_lang$core$List$map,
						_user$project$Lang$mapValField(
							function (_p30) {
								var _p31 = _p30;
								var _p32 = _p31._1;
								var newlyAssignedIdents = _user$project$LangTools$identifiersSetInPat(_p32);
								var renamingsShadowsRemoved = A2(removeIdentsFromRenaming, newlyAssignedIdents, renamings);
								return A4(
									_user$project$Lang$Branch_,
									_p31._0,
									_p32,
									A2(_user$project$LangSimplify$changeRenamedVarsToOuter_, renamingsShadowsRemoved, _p31._2),
									_p31._3);
							}),
						_p21._2);
					return A4(
						_user$project$Lang$ECase,
						_p21._0,
						recurse(_p21._1),
						newBranches,
						_p21._3);
				case 'ETypeCase':
					var newBranches = A2(
						_elm_lang$core$List$map,
						_user$project$Lang$mapValField(
							function (_p33) {
								var _p34 = _p33;
								return A4(
									_user$project$Lang$TBranch_,
									_p34._0,
									_p34._1,
									recurse(_p34._2),
									_p34._3);
							}),
						_p21._2);
					return A4(_user$project$Lang$ETypeCase, _p21._0, _p21._1, newBranches, _p21._3);
				case 'EComment':
					return A3(
						_user$project$Lang$EComment,
						_p21._0,
						_p21._1,
						recurse(_p21._2));
				case 'EOption':
					return A5(
						_user$project$Lang$EOption,
						_p21._0,
						_p21._1,
						_p21._2,
						_p21._3,
						recurse(_p21._4));
				case 'ETyp':
					return A5(
						_user$project$Lang$ETyp,
						_p21._0,
						_p21._1,
						_p21._2,
						recurse(_p21._3),
						_p21._4);
				case 'EColonType':
					return A5(
						_user$project$Lang$EColonType,
						_p21._0,
						recurse(_p21._1),
						_p21._2,
						_p21._3,
						_p21._4);
				default:
					return A5(
						_user$project$Lang$ETypeAlias,
						_p21._0,
						_p21._1,
						_p21._2,
						recurse(_p21._3),
						_p21._4);
			}
		}();
		return A2(_user$project$Lang$replaceE__, exp, e__New);
	});
var _user$project$LangSimplify$changeRenamedVarsToOuter = function (exp) {
	return A2(_user$project$LangSimplify$changeRenamedVarsToOuter_, _elm_lang$core$Dict$empty, exp);
};
var _user$project$LangSimplify$simplifyPatBoundExp = F2(
	function (pat, boundExp) {
		var _p35 = {ctor: '_Tuple2', _0: pat.val.p__, _1: boundExp.val.e__};
		_v15_3:
		do {
			if (_p35.ctor === '_Tuple2') {
				switch (_p35._0.ctor) {
					case 'PVar':
						if (_p35._0._1 === '*RemoveMe*') {
							return _elm_lang$core$Maybe$Nothing;
						} else {
							break _v15_3;
						}
					case 'PAs':
						var _p36 = A2(_user$project$LangSimplify$simplifyPatBoundExp, _p35._0._3, boundExp);
						if (_p36.ctor === 'Just') {
							return _elm_lang$core$Maybe$Just(
								{
									ctor: '_Tuple2',
									_0: A2(
										_user$project$Lang$replaceP__,
										pat,
										A4(_user$project$Lang$PAs, _p35._0._0, _p35._0._1, _p35._0._2, _p36._0._0)),
									_1: _p36._0._1
								});
						} else {
							return _elm_lang$core$Maybe$Nothing;
						}
					case 'PList':
						if (_p35._1.ctor === 'EList') {
							var _p45 = _p35._0._1;
							var _p44 = _p35._0._3;
							var _p43 = _p35._1._3;
							var _p42 = _p35._1._1;
							var _p37 = A3(_user$project$Utils$filterMapTogetherPreservingLeftovers, _user$project$LangSimplify$simplifyPatBoundExp, _p45, _p42);
							var newPs = _p37._0;
							var newEs = _p37._1;
							var _p38 = function () {
								var _p39 = {ctor: '_Tuple2', _0: _p44, _1: _p43};
								if (((_p39.ctor === '_Tuple2') && (_p39._0.ctor === 'Just')) && (_p39._1.ctor === 'Just')) {
									var _p40 = A2(_user$project$LangSimplify$simplifyPatBoundExp, _p39._0._0, _p39._1._0);
									if (_p40.ctor === 'Just') {
										return {
											ctor: '_Tuple2',
											_0: _elm_lang$core$Maybe$Just(_p40._0._0),
											_1: _elm_lang$core$Maybe$Just(_p40._0._1)
										};
									} else {
										return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _elm_lang$core$Maybe$Nothing};
									}
								} else {
									return {ctor: '_Tuple2', _0: _p44, _1: _p43};
								}
							}();
							var newMaybePTail = _p38._0;
							var newMaybeETail = _p38._1;
							var _p41 = {ctor: '_Tuple4', _0: newPs, _1: newEs, _2: newMaybePTail, _3: newMaybeETail};
							_v19_2:
							do {
								if (_p41.ctor === '_Tuple4') {
									if (_p41._0.ctor === '[]') {
										if (((_p41._1.ctor === '[]') && (_p41._2.ctor === 'Nothing')) && (_p41._3.ctor === 'Nothing')) {
											return _elm_lang$core$Maybe$Nothing;
										} else {
											break _v19_2;
										}
									} else {
										if (((((_p41._0._1.ctor === '[]') && (_p41._1.ctor === '::')) && (_p41._1._1.ctor === '[]')) && (_p41._2.ctor === 'Nothing')) && (_p41._3.ctor === 'Nothing')) {
											return _elm_lang$core$Maybe$Just(
												{ctor: '_Tuple2', _0: _p41._0._0, _1: _p41._1._0});
										} else {
											break _v19_2;
										}
									}
								} else {
									break _v19_2;
								}
							} while(false);
							return _elm_lang$core$Maybe$Just(
								{
									ctor: '_Tuple2',
									_0: A2(
										_user$project$Lang$replaceP__,
										pat,
										A5(
											_user$project$Lang$PList,
											_p35._0._0,
											A2(_user$project$Lang$imitatePatListWhitespace, _p45, newPs),
											_p35._0._2,
											newMaybePTail,
											_p35._0._4)),
									_1: A2(
										_user$project$Lang$replaceE__,
										boundExp,
										A5(
											_user$project$Lang$EList,
											_p35._1._0,
											A2(_user$project$Lang$imitateExpListWhitespace, _p42, newEs),
											_p35._1._2,
											newMaybeETail,
											_p35._1._4))
								});
						} else {
							break _v15_3;
						}
					default:
						break _v15_3;
				}
			} else {
				break _v15_3;
			}
		} while(false);
		return _elm_lang$core$Maybe$Just(
			{ctor: '_Tuple2', _0: pat, _1: boundExp});
	});
var _user$project$LangSimplify$simplifyAssignments = function (program) {
	return A2(
		_user$project$Lang$mapExp,
		function (exp) {
			var _p46 = exp.val.e__;
			if (_p46.ctor === 'ELet') {
				var _p48 = _p46._5;
				var _p47 = A2(_user$project$LangSimplify$simplifyPatBoundExp, _p46._3, _p46._4);
				if (_p47.ctor === 'Just') {
					return A2(
						_user$project$Lang$replaceE__,
						exp,
						A7(
							_user$project$Lang$ELet,
							_p46._0,
							_p46._1,
							_p46._2,
							_user$project$Lang$ensureWhitespacePat(_p47._0._0),
							_user$project$Lang$ensureWhitespaceExp(_p47._0._1),
							_p48,
							_p46._6));
				} else {
					return _p48;
				}
			} else {
				return exp;
			}
		},
		program);
};
var _user$project$LangSimplify$removeUnusedVars = function (exp) {
	var remover = function (e__) {
		var _p49 = e__;
		if (_p49.ctor === 'ELet') {
			var _p66 = _p49._6;
			var _p65 = _p49._0;
			var _p64 = _p49._2;
			var _p63 = _p49._1;
			var _p62 = _p49._5;
			var _p61 = _p49._4;
			var usedNames = _user$project$LangTools$identifiersSet(_p62);
			var letRemoved = _p62.val.e__;
			var _p50 = {ctor: '_Tuple2', _0: _p49._3.val.p__, _1: _p61.val.e__};
			_v23_3:
			do {
				if (_p50.ctor === '_Tuple2') {
					switch (_p50._0.ctor) {
						case 'PVar':
							return A2(_elm_lang$core$Set$member, _p50._0._1, usedNames) ? e__ : letRemoved;
						case 'PAs':
							return A2(_elm_lang$core$Set$member, _p50._0._1, usedNames) ? e__ : A7(
								_user$project$Lang$ELet,
								_p65,
								_p63,
								_p64,
								A2(_user$project$Lang$replacePrecedingWhitespacePat, _p50._0._0.val, _p50._0._3),
								_p61,
								_p62,
								_p66);
						case 'PList':
							if (((_p50._0._3.ctor === 'Nothing') && (_p50._1.ctor === 'EList')) && (_p50._1._3.ctor === 'Nothing')) {
								var _p60 = _p50._0._0;
								var _p59 = _p50._0._1;
								var _p58 = _p50._1._0;
								var _p57 = _p50._1._1;
								if (!_elm_lang$core$Native_Utils.eq(
									_elm_lang$core$List$length(_p59),
									_elm_lang$core$List$length(_p57))) {
									return e__;
								} else {
									var patsAssigns = A2(_user$project$Utils$zip, _p59, _p57);
									var usedPatsAssigns = A2(
										_elm_lang$core$List$filter,
										function (_p51) {
											var _p52 = _p51;
											var _p53 = _p52._0.val.p__;
											if (_p53.ctor === 'PVar') {
												return A2(_elm_lang$core$Set$member, _p53._1, usedNames);
											} else {
												return true;
											}
										},
										patsAssigns);
									var _p54 = _elm_lang$core$List$length(usedPatsAssigns);
									switch (_p54) {
										case 0:
											return letRemoved;
										case 1:
											var _p55 = _user$project$Utils$head_(usedPatsAssigns);
											var thePat = _p55._0;
											var theAssign = _p55._1;
											var newPat = A2(_user$project$Lang$replacePrecedingWhitespacePat, _p60.val, thePat);
											var newAssign = A2(_user$project$Lang$replacePrecedingWhitespace, _p58.val, theAssign);
											return A7(_user$project$Lang$ELet, _p65, _p63, _p64, newPat, newAssign, _p62, _p66);
										default:
											if (_elm_lang$core$Native_Utils.eq(
												_elm_lang$core$List$length(usedPatsAssigns),
												_elm_lang$core$List$length(_p59))) {
												return e__;
											} else {
												var _p56 = _elm_lang$core$List$unzip(usedPatsAssigns);
												var usedPats = _p56._0;
												var usedAssigns = _p56._1;
												var newPat = _user$project$Lang$withDummyPatInfo(
													A5(
														_user$project$Lang$PList,
														_p60,
														A3(_user$project$Lang$setPatListWhitespace, '', ' ', usedPats),
														_p50._0._2,
														_elm_lang$core$Maybe$Nothing,
														_p50._0._4));
												var newAssign = _user$project$Lang$withDummyExpInfo(
													A5(
														_user$project$Lang$EList,
														_p58,
														A3(_user$project$Lang$setExpListWhitespace, '', ' ', usedAssigns),
														_p50._1._2,
														_elm_lang$core$Maybe$Nothing,
														_p50._1._4));
												return A7(_user$project$Lang$ELet, _p65, _p63, _p64, newPat, newAssign, _p62, _p66);
											}
									}
								}
							} else {
								break _v23_3;
							}
						default:
							break _v23_3;
					}
				} else {
					break _v23_3;
				}
			} while(false);
			return e__;
		} else {
			return e__;
		}
	};
	return A2(_user$project$Lang$mapExpViaExp__, remover, exp);
};
var _user$project$LangSimplify$simplify = function (exp) {
	simplify:
	while (true) {
		var repeatedlyApplyFirstTwo = function (e) {
			repeatedlyApplyFirstTwo:
			while (true) {
				var firstTwoSimplified = _user$project$LangSimplify$removeUnusedVars(
					_user$project$LangSimplify$inlineTrivialRenamings(e));
				if (_elm_lang$core$Native_Utils.eq(firstTwoSimplified, e)) {
					return e;
				} else {
					var _v27 = firstTwoSimplified;
					e = _v27;
					continue repeatedlyApplyFirstTwo;
				}
			}
		};
		var simplified = _user$project$LangSimplify$changeRenamedVarsToOuter(
			repeatedlyApplyFirstTwo(exp));
		if (_elm_lang$core$Native_Utils.eq(simplified, exp)) {
			return exp;
		} else {
			var _v28 = simplified;
			exp = _v28;
			continue simplify;
		}
	}
};
var _user$project$LangSimplify$removeExtraPostfixes = F2(
	function (postfixes, program) {
		removeExtraPostfixes:
		while (true) {
			var maybeNewName = function (oldName) {
				return A2(
					_elm_lang$core$Maybe$map,
					function (postfix) {
						return A2(
							_elm_lang$core$String$dropRight,
							_elm_lang$core$String$length(postfix),
							oldName);
					},
					A2(
						_user$project$Utils$findFirst,
						function (postfix) {
							return A2(_elm_lang$core$String$endsWith, postfix, oldName);
						},
						postfixes));
			};
			var newProgram = A2(
				_user$project$Lang$mapExpViaExp__,
				function (e__) {
					var _p67 = e__;
					if ((_p67.ctor === 'ELet') && (_p67._2 === false)) {
						var _p75 = _p67._3;
						var _p68 = A3(
							_elm_lang$core$List$foldl,
							F2(
								function (oldName, _p69) {
									var _p70 = _p69;
									var _p74 = _p70._0;
									var _p73 = _p70._1;
									var _p71 = maybeNewName(oldName);
									if (_p71.ctor === 'Nothing') {
										return {ctor: '_Tuple2', _0: _p74, _1: _p73};
									} else {
										var _p72 = _p71._0;
										return ((!A2(
											_elm_lang$core$List$member,
											_p72,
											_user$project$LangTools$identifiersListInPat(_p74))) && (!A2(
											_elm_lang$core$Set$member,
											_p72,
											A2(
												_user$project$LangTools$visibleIdentifiersAtPredicateNoPrelude,
												_p73,
												function (e) {
													return _elm_lang$core$Native_Utils.eq(
														_user$project$LangTools$expToMaybeIdent(e),
														_elm_lang$core$Maybe$Just(oldName));
												})))) ? {
											ctor: '_Tuple2',
											_0: A3(_user$project$LangTools$renameIdentifierInPat, oldName, _p72, _p74),
											_1: A3(_user$project$LangTools$renameVarUntilBound, oldName, _p72, _p73)
										} : {ctor: '_Tuple2', _0: _p74, _1: _p73};
									}
								}),
							{ctor: '_Tuple2', _0: _p75, _1: _p67._5},
							_user$project$LangTools$identifiersListInPat(_p75));
						var newPat = _p68._0;
						var newBody = _p68._1;
						return (!_elm_lang$core$Native_Utils.eq(_p75, newPat)) ? A7(_user$project$Lang$ELet, _p67._0, _p67._1, false, newPat, _p67._4, newBody, _p67._6) : e__;
					} else {
						return e__;
					}
				},
				program);
			if (_elm_lang$core$Native_Utils.eq(
				_user$project$LangTools$identifiersList(newProgram),
				_user$project$LangTools$identifiersList(program))) {
				return program;
			} else {
				var _v32 = postfixes,
					_v33 = newProgram;
				postfixes = _v32;
				program = _v33;
				continue removeExtraPostfixes;
			}
		}
	});
var _user$project$LangSimplify$cleanCode = function (program) {
	return _user$project$FastParser$freshen(
		A2(
			_user$project$Lang$mapExpTopDown,
			function (e) {
				return _user$project$Lang$isLet(e) ? A2(_user$project$LangTools$reflowLetWhitespace, program, e) : e;
			},
			A2(
				_user$project$LangSimplify$removeExtraPostfixes,
				{
					ctor: '::',
					_0: '_orig',
					_1: {
						ctor: '::',
						_0: '\'',
						_1: {ctor: '[]'}
					}
				},
				_user$project$LangSimplify$simplify(program))));
};

var _user$project$CodeMotion$introduceVarTransformation_ = F4(
	function (m, expIds, addNewVarsAtThisId, addNewEquationsAt) {
		var toolName = A2(
			_elm_lang$core$Basics_ops['++'],
			'Introduce Variable',
			_elm_lang$core$Native_Utils.eq(
				_elm_lang$core$List$length(expIds),
				1) ? '' : 's');
		var visibleAtTargetBody = function () {
			var targetBodyEId = function () {
				var exp = A2(_user$project$LangTools$justFindExpByEId, m.inputExp, addNewVarsAtThisId);
				var _p0 = exp.val.e__;
				if (_p0.ctor === 'ELet') {
					return _p0._5.val.eid;
				} else {
					return exp.val.eid;
				}
			}();
			return A2(
				_user$project$LangTools$visibleIdentifiersAtEIds,
				m.inputExp,
				_elm_lang$core$Set$singleton(targetBodyEId));
		}();
		var _p1 = A3(
			_elm_lang$core$List$foldl,
			F2(
				function (eId, _p2) {
					var _p3 = _p2;
					var _p4 = _p3._0;
					var name = A2(_user$project$LangTools$expNameForEId, m.inputExp, eId);
					var namesToAvoid = A2(
						_elm_lang$core$Set$union,
						visibleAtTargetBody,
						_elm_lang$core$Set$fromList(
							A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$first, _p4)));
					var newVar = A3(_user$project$LangTools$nonCollidingName, name, 1, namesToAvoid);
					var expAtEId = A2(_user$project$LangTools$justFindExpByEId, m.inputExp, eId);
					var expWithNewVarUsed = A3(
						_user$project$Lang$replaceExpNodePreservingPrecedingWhitespace,
						eId,
						_user$project$Lang$eVar(newVar),
						_p3._1);
					return {
						ctor: '_Tuple2',
						_0: {
							ctor: '::',
							_0: {ctor: '_Tuple2', _0: newVar, _1: expAtEId},
							_1: _p4
						},
						_1: expWithNewVarUsed
					};
				}),
			{
				ctor: '_Tuple2',
				_0: {ctor: '[]'},
				_1: m.inputExp
			},
			expIds);
		var newEquations = _p1._0;
		var expWithNewVarsUsed = _p1._1;
		var newExp = A2(
			_user$project$Lang$mapExp,
			function (e) {
				return _elm_lang$core$Native_Utils.eq(e.val.eid, addNewVarsAtThisId) ? A2(addNewEquationsAt, newEquations, e) : e;
			},
			expWithNewVarsUsed);
		return _elm_lang$core$List$singleton(
			A2(
				_user$project$InterfaceModel$setResultSafe,
				_elm_lang$core$Native_Utils.eq(
					_user$project$LangTools$freeVars(newExp),
					_user$project$LangTools$freeVars(m.inputExp)),
				A2(_user$project$InterfaceModel$synthesisResult, toolName, newExp)));
	});
var _user$project$CodeMotion$maybePathAfterPathsRemoved = F2(
	function (pathsRemoved, path) {
		return A3(
			_user$project$Utils$foldrMaybe,
			_user$project$Lang$pathAfterElementRemoved,
			_elm_lang$core$Maybe$Just(path),
			_elm_lang$core$List$sort(pathsRemoved));
	});
var _user$project$CodeMotion$shouldBeParameterIsNamedUnfrozenConstant = F2(
	function (exp, originalProgram) {
		var _p5 = exp.val.e__;
		_v2_2:
		do {
			switch (_p5.ctor) {
				case 'EConst':
					if (_p5._2.ctor === '_Tuple3') {
						return (!_elm_lang$core$Native_Utils.eq(_p5._2._2, '')) && (!_elm_lang$core$Native_Utils.eq(_p5._2._1, _user$project$Lang$frozen));
					} else {
						break _v2_2;
					}
				case 'EBase':
					if (_p5._1.ctor === 'EString') {
						var bindings = A2(
							_elm_lang$core$List$concatMap,
							function (_p6) {
								var _p7 = _p6;
								return A2(_user$project$LangTools$tryMatchExpReturningList, _p7._0, _p7._1);
							},
							A2(
								_elm_lang$core$List$filterMap,
								_user$project$LangTools$expToMaybeLetPatAndBoundExp,
								A2(_user$project$LangTools$justFindExpWithAncestorsByEId, originalProgram, exp.val.eid)));
						return _user$project$Utils$maybeToBool(
							A2(
								_user$project$Utils$findFirst,
								function (_p8) {
									var _p9 = _p8;
									return _elm_lang$core$Native_Utils.eq(_p9._1.val.eid, exp.val.eid);
								},
								bindings));
					} else {
						break _v2_2;
					}
				default:
					break _v2_2;
			}
		} while(false);
		return false;
	});
var _user$project$CodeMotion$shouldBeParameterIsConstant = F2(
	function (exp, originalProgram) {
		var _p10 = exp.val.e__;
		_v5_2:
		do {
			switch (_p10.ctor) {
				case 'EConst':
					return true;
				case 'EBase':
					if (_p10._1.ctor === 'EString') {
						return true;
					} else {
						break _v5_2;
					}
				default:
					break _v5_2;
			}
		} while(false);
		return false;
	});
var _user$project$CodeMotion$abstract = F3(
	function (eid, shouldBeParameter, originalProgram) {
		var expToAbstact = A2(_user$project$LangTools$justFindExpByEId, originalProgram, eid);
		var eidsToParameterize = _elm_lang$core$Set$fromList(
			A2(
				_elm_lang$core$List$map,
				function (_p11) {
					return function (_) {
						return _.eid;
					}(
						function (_) {
							return _.val;
						}(_p11));
				},
				A2(
					_elm_lang$core$List$filter,
					function (_p12) {
						return A2(
							F2(
								function (x, y) {
									return _elm_lang$core$Native_Utils.eq(x, y);
								}),
							_elm_lang$core$Maybe$Just('INSERT_ARGUMENT_HERE'),
							_user$project$LangTools$expToMaybeIdent(_p12));
					},
					_user$project$Lang$flattenExpTree(
						A2(
							_user$project$Lang$mapExp,
							function (e) {
								return A2(shouldBeParameter, e, originalProgram) ? A2(
									_user$project$Lang$replaceE__,
									e,
									A2(_user$project$Lang$EVar, _user$project$Lang$space1, 'INSERT_ARGUMENT_HERE')) : e;
							},
							expToAbstact)))));
		var _p13 = A3(
			_user$project$Lang$mapFoldExp,
			F2(
				function (e, _p14) {
					var _p15 = _p14;
					var _p18 = _p15._1;
					var _p17 = _p15._2;
					var _p16 = _p15._0;
					if (A2(_elm_lang$core$Set$member, e.val.eid, eidsToParameterize)) {
						var naiveName = A2(
							_elm_lang$core$Basics_ops['++'],
							A3(_user$project$LangTools$expNameForEIdWithDefault, 'arg', originalProgram, e.val.eid),
							'_ARRRG!!!');
						var name = A3(_user$project$LangTools$nonCollidingName, naiveName, 2, _p16);
						var namesToAvoid_ = A2(_elm_lang$core$Set$insert, name, _p16);
						return {
							ctor: '_Tuple2',
							_0: A2(
								_user$project$Lang$copyPrecedingWhitespace,
								e,
								_user$project$Lang$eVar(name)),
							_1: {
								ctor: '_Tuple3',
								_0: namesToAvoid_,
								_1: {ctor: '::', _0: name, _1: _p18},
								_2: {
									ctor: '::',
									_0: _user$project$FastParser$clearAllIds(e),
									_1: _p17
								}
							}
						};
					} else {
						return {
							ctor: '_Tuple2',
							_0: e,
							_1: {ctor: '_Tuple3', _0: _p16, _1: _p18, _2: _p17}
						};
					}
				}),
			{
				ctor: '_Tuple3',
				_0: _user$project$LangTools$identifiersSet(expToAbstact),
				_1: {ctor: '[]'},
				_2: {ctor: '[]'}
			},
			expToAbstact);
		var abstractionBody = _p13._0;
		var paramNamesARRRGTagged = _p13._1._1;
		var paramExps = _p13._1._2;
		var _p19 = function () {
			var abstractionBodySimplifiedARRRGTags = _user$project$Lang$ensureWhitespaceExp(
				_user$project$LangSimplify$removeUnusedVars(
					_user$project$LangSimplify$changeRenamedVarsToOuter(abstractionBody)));
			var arrrgTagRegex = _elm_lang$core$Regex$regex('_ARRRG!!!\\d*$');
			var removeARRRGTag = function (name) {
				return A4(
					_elm_lang$core$Regex$replace,
					_elm_lang$core$Regex$AtMost(1),
					arrrgTagRegex,
					function (_p20) {
						return '';
					},
					name);
			};
			return A3(
				_elm_lang$core$List$foldl,
				F2(
					function (nameARRRGTagged, _p21) {
						var _p22 = _p21;
						var _p23 = _p22._1;
						var noARRRGTag = removeARRRGTag(nameARRRGTagged);
						var name = A3(_user$project$LangTools$nonCollidingName, noARRRGTag, 2, _p23);
						return {
							ctor: '_Tuple3',
							_0: A3(_user$project$LangTools$renameIdentifier, nameARRRGTagged, name, _p22._0),
							_1: A2(_elm_lang$core$Set$insert, name, _p23),
							_2: A2(
								_elm_lang$core$Basics_ops['++'],
								_p22._2,
								{
									ctor: '::',
									_0: name,
									_1: {ctor: '[]'}
								})
						};
					}),
				{
					ctor: '_Tuple3',
					_0: abstractionBodySimplifiedARRRGTags,
					_1: _user$project$LangTools$identifiersSet(abstractionBodySimplifiedARRRGTags),
					_2: {ctor: '[]'}
				},
				paramNamesARRRGTagged);
		}();
		var abstractionBodySimplified = _p19._0;
		var paramNames = _p19._2;
		var _p24 = paramExps;
		if (_p24.ctor === '[]') {
			var funcExp = A2(
				_user$project$Lang$eFun,
				{
					ctor: '::',
					_0: _user$project$Lang$pList0(
						{ctor: '[]'}),
					_1: {ctor: '[]'}
				},
				abstractionBodySimplified);
			return {
				ctor: '_Tuple2',
				_0: {
					ctor: '::',
					_0: _user$project$Lang$eTuple(
						{ctor: '[]'}),
					_1: {ctor: '[]'}
				},
				_1: funcExp
			};
		} else {
			var funcExp = A2(
				_user$project$Lang$eFun,
				_user$project$Lang$listOfPVars(paramNames),
				abstractionBodySimplified);
			return {ctor: '_Tuple2', _0: paramExps, _1: funcExp};
		}
	});
var _user$project$CodeMotion$abstractExp = F2(
	function (eidToAbstract, originalProgram) {
		var expToAbstract = A2(_user$project$LangTools$justFindExpByEId, originalProgram, eidToAbstract);
		var doAbstract = function (shouldBeParameter) {
			var _p25 = A3(_user$project$CodeMotion$abstract, eidToAbstract, shouldBeParameter, originalProgram);
			var argumentsForCallSite = _p25._0;
			var abstractedFuncExp = _p25._1;
			var funcName = function () {
				var naiveName = A3(_user$project$LangTools$expNameForEIdWithDefault, 'func', originalProgram, eidToAbstract);
				var namesToAvoid = A2(
					_user$project$LangTools$visibleIdentifiersAtEIds,
					originalProgram,
					_elm_lang$core$Set$singleton(eidToAbstract));
				return A3(_user$project$LangTools$nonCollidingName, naiveName, 2, namesToAvoid);
			}();
			var expToWrap = A2(_user$project$LangTools$deepestAncestorWithNewline, originalProgram, eidToAbstract);
			var expToWrapWithTargetReplaced = A3(
				_user$project$Lang$replaceExpNodePreservingPrecedingWhitespace,
				eidToAbstract,
				A2(
					_user$project$Lang$eApp,
					_user$project$Lang$eVar0(funcName),
					A3(_user$project$Lang$setExpListWhitespace, ' ', ' ', argumentsForCallSite)),
				expToWrap);
			var wrapped = A5(
				_user$project$LangTools$newLetFancyWhitespace,
				-1,
				_user$project$Lang$pVar(funcName),
				abstractedFuncExp,
				expToWrapWithTargetReplaced,
				originalProgram);
			var newProgram = A3(_user$project$Lang$replaceExpNodePreservingPrecedingWhitespace, expToWrap.val.eid, wrapped, originalProgram);
			return newProgram;
		};
		var abstractedOverAllConstantsResult = function () {
			var newProgram = doAbstract(_user$project$CodeMotion$shouldBeParameterIsConstant);
			return A2(
				_user$project$InterfaceModel$synthesisResult,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'Abstract ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						A3(
							_user$project$Utils$niceTruncateString,
							20,
							'...',
							_user$project$Utils$squish(
								_user$project$LangUnparser$unparse(expToAbstract))),
						' over its constants')),
				newProgram);
		}();
		var abstractedOverNamedUnfrozenConstantsResult = function () {
			var newProgram = doAbstract(_user$project$CodeMotion$shouldBeParameterIsNamedUnfrozenConstant);
			return A2(
				_user$project$InterfaceModel$synthesisResult,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'Abstract ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						A3(
							_user$project$Utils$niceTruncateString,
							20,
							'...',
							_user$project$Utils$squish(
								_user$project$LangUnparser$unparse(expToAbstract))),
						' over its named constants')),
				newProgram);
		}();
		return {
			ctor: '::',
			_0: abstractedOverAllConstantsResult,
			_1: {
				ctor: '::',
				_0: abstractedOverNamedUnfrozenConstantsResult,
				_1: {ctor: '[]'}
			}
		};
	});
var _user$project$CodeMotion$addExpToExpsByPath = F3(
	function (expToInsert, path, exps) {
		var _p26 = path;
		if (_p26.ctor === '::') {
			if (_p26._1.ctor === '[]') {
				return _elm_lang$core$Maybe$Just(
					A2(
						_user$project$Lang$imitateExpListWhitespace,
						exps,
						A3(_user$project$Utils$inserti, _p26._0, expToInsert, exps)));
			} else {
				var _p27 = _p26._0;
				return A2(
					_elm_lang$core$Maybe$map,
					function (newExp) {
						return A3(_user$project$Utils$replacei, _p27, newExp, exps);
					},
					A2(
						_elm_lang$core$Maybe$andThen,
						A2(_user$project$CodeMotion$addExpToExpByPath, expToInsert, _p26._1),
						A2(_user$project$Utils$maybeGeti1, _p27, exps)));
			}
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$CodeMotion$addExpToExpByPath = F3(
	function (expToInsert, path, exp) {
		var _p28 = {ctor: '_Tuple2', _0: exp.val.e__, _1: path};
		_v10_2:
		do {
			if (_p28.ctor === '_Tuple2') {
				if (_p28._1.ctor === '[]') {
					return _elm_lang$core$Maybe$Nothing;
				} else {
					if (_p28._0.ctor === 'EList') {
						var _p35 = _p28._0._4;
						var _p34 = _p28._0._2;
						var _p33 = _p28._0._0;
						var _p32 = _p28._0._3;
						var _p31 = _p28._1._1;
						var _p30 = _p28._1._0;
						var _p29 = _p28._0._1;
						return (_elm_lang$core$Native_Utils.eq(
							_p30,
							_elm_lang$core$List$length(_p29) + 1) && (!_elm_lang$core$Native_Utils.eq(
							_p31,
							{ctor: '[]'}))) ? A2(
							_elm_lang$core$Maybe$map,
							function (newTail) {
								return A2(
									_user$project$Lang$replaceE__,
									exp,
									A5(
										_user$project$Lang$EList,
										_p33,
										_p29,
										_p34,
										_elm_lang$core$Maybe$Just(newTail),
										_p35));
							},
							A2(
								_elm_lang$core$Maybe$andThen,
								A2(_user$project$CodeMotion$addExpToExpByPath, expToInsert, _p31),
								_p32)) : ((_elm_lang$core$Native_Utils.cmp(
							_p30,
							_elm_lang$core$List$length(_p29) + 1) < 1) ? A2(
							_elm_lang$core$Maybe$map,
							function (newEs) {
								return A2(
									_user$project$Lang$replaceE__,
									exp,
									A5(_user$project$Lang$EList, _p33, newEs, _p34, _p32, _p35));
							},
							A3(
								_user$project$CodeMotion$addExpToExpsByPath,
								expToInsert,
								{ctor: '::', _0: _p30, _1: _p31},
								_p29)) : _elm_lang$core$Maybe$Nothing);
					} else {
						break _v10_2;
					}
				}
			} else {
				break _v10_2;
			}
		} while(false);
		return _elm_lang$core$Maybe$Nothing;
	});
var _user$project$CodeMotion$addPatToPats = F3(
	function (patToInsert, path, pats) {
		var _p36 = path;
		if (_p36.ctor === '::') {
			if (_p36._1.ctor === '[]') {
				return _elm_lang$core$Maybe$Just(
					A2(
						_user$project$Lang$imitatePatListWhitespace,
						pats,
						A3(_user$project$Utils$inserti, _p36._0, patToInsert, pats)));
			} else {
				var _p37 = _p36._0;
				return A2(
					_elm_lang$core$Maybe$map,
					function (newPat) {
						return A3(_user$project$Utils$replacei, _p37, newPat, pats);
					},
					A2(
						_elm_lang$core$Maybe$andThen,
						A2(_user$project$CodeMotion$addPatToPat, patToInsert, _p36._1),
						A2(_user$project$Utils$maybeGeti1, _p37, pats)));
			}
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$CodeMotion$addPatToPat = F3(
	function (patToInsert, path, pat) {
		var _p38 = {ctor: '_Tuple2', _0: pat.val.p__, _1: path};
		_v12_3:
		do {
			if (_p38.ctor === '_Tuple2') {
				if (_p38._1.ctor === '[]') {
					return _elm_lang$core$Maybe$Nothing;
				} else {
					switch (_p38._0.ctor) {
						case 'PAs':
							if (_p38._1._0 === 1) {
								var _p39 = A2(
									_elm_lang$core$Debug$log,
									'adding to as pattern not allowed yet because when adding argument, pattern path will not be the same as the path for adding arguments to call sites',
									{ctor: '_Tuple0'});
								return _elm_lang$core$Maybe$Nothing;
							} else {
								break _v12_3;
							}
						case 'PList':
							var _p46 = _p38._0._4;
							var _p45 = _p38._0._2;
							var _p44 = _p38._0._0;
							var _p43 = _p38._0._1;
							var _p42 = _p38._0._3;
							var _p41 = _p38._1._1;
							var _p40 = _p38._1._0;
							return (_elm_lang$core$Native_Utils.eq(
								_p40,
								_elm_lang$core$List$length(_p43) + 1) && (!_elm_lang$core$Native_Utils.eq(
								_p41,
								{ctor: '[]'}))) ? A2(
								_elm_lang$core$Maybe$map,
								function (newTail) {
									return A2(
										_user$project$Lang$replaceP__,
										pat,
										A5(
											_user$project$Lang$PList,
											_p44,
											_p43,
											_p45,
											_elm_lang$core$Maybe$Just(newTail),
											_p46));
								},
								A2(
									_elm_lang$core$Maybe$andThen,
									A2(_user$project$CodeMotion$addPatToPat, patToInsert, _p41),
									_p42)) : ((_elm_lang$core$Native_Utils.cmp(
								_p40,
								_elm_lang$core$List$length(_p43) + 1) < 1) ? A2(
								_elm_lang$core$Maybe$map,
								function (newPs) {
									return A2(
										_user$project$Lang$replaceP__,
										pat,
										A5(_user$project$Lang$PList, _p44, newPs, _p45, _p42, _p46));
								},
								A3(
									_user$project$CodeMotion$addPatToPats,
									patToInsert,
									{ctor: '::', _0: _p40, _1: _p41},
									_p43)) : _elm_lang$core$Maybe$Nothing);
						default:
							break _v12_3;
					}
				}
			} else {
				break _v12_3;
			}
		} while(false);
		return _elm_lang$core$Maybe$Nothing;
	});
var _user$project$CodeMotion$addArg_ = F3(
	function (pathedPatId, funcToIsSafePatToInsertArgValExpAndNewFuncBody, originalProgram) {
		var _p47 = pathedPatId;
		var funcEId = _p47._0._0;
		var path = _p47._1;
		var _p48 = A2(_user$project$LangTools$findLetAndIdentBindingExp, funcEId, originalProgram);
		if (_p48.ctor === 'Just') {
			var _p68 = _p48._0._1;
			var _p49 = _p48._0._0.val.e__;
			if (_p49.ctor === 'ELet') {
				var _p66 = _p49._5;
				var _p65 = _p49._4;
				var funcVarUsageEIds = _p49._2 ? _elm_lang$core$Set$fromList(
					A2(
						_elm_lang$core$Basics_ops['++'],
						A2(_user$project$LangTools$identifierUsageEIds, _p68, _p65),
						A2(_user$project$LangTools$identifierUsageEIds, _p68, _p66))) : _elm_lang$core$Set$fromList(
					A2(_user$project$LangTools$identifierUsageEIds, _p68, _p66));
				var _p50 = _p65.val.e__;
				if (_p50.ctor === 'EFun') {
					var _p63 = _p50._1;
					var _p51 = A2(funcToIsSafePatToInsertArgValExpAndNewFuncBody, _p65, _p50._2);
					if (_p51.ctor === 'Nothing') {
						return {ctor: '[]'};
					} else {
						var _p62 = _p51._0._1;
						var _p61 = _p51._0._2;
						var _p52 = A3(_user$project$CodeMotion$addPatToPats, _p62, path, _p63);
						if (_p52.ctor === 'Nothing') {
							var _p53 = A2(
								_elm_lang$core$Debug$log,
								A2(
									_elm_lang$core$Basics_ops['++'],
									'Could not insert pattern into ',
									A2(
										_elm_lang$core$Basics_ops['++'],
										A2(
											_elm_lang$core$String$join,
											' ',
											A2(_elm_lang$core$List$map, _user$project$LangUnparser$unparsePat, _p63)),
										' at path')),
								path);
							return {ctor: '[]'};
						} else {
							var _p60 = _p52._0;
							var _p54 = A3(
								_user$project$Lang$mapFoldExp,
								F2(
									function (exp, funcVarUsagesTransformed) {
										var _p55 = exp.val.e__;
										if (_p55.ctor === 'EApp') {
											var _p57 = _p55._1;
											if (A2(_elm_lang$core$Set$member, _p57.val.eid, funcVarUsageEIds)) {
												var _p56 = A3(
													_user$project$CodeMotion$addExpToExpsByPath,
													_user$project$FastParser$clearAllIds(_p61),
													path,
													_p55._2);
												if (_p56.ctor === 'Nothing') {
													return {ctor: '_Tuple2', _0: exp, _1: funcVarUsagesTransformed};
												} else {
													return {
														ctor: '_Tuple2',
														_0: A2(
															_user$project$Lang$replaceE__,
															exp,
															A4(_user$project$Lang$EApp, _p55._0, _p57, _p56._0, _p55._3)),
														_1: A2(_elm_lang$core$Set$insert, _p57.val.eid, funcVarUsagesTransformed)
													};
												}
											} else {
												return {ctor: '_Tuple2', _0: exp, _1: funcVarUsagesTransformed};
											}
										} else {
											return {ctor: '_Tuple2', _0: exp, _1: funcVarUsagesTransformed};
										}
									}),
								_elm_lang$core$Set$empty,
								A3(
									_user$project$Lang$replaceExpNodeE__ByEId,
									_p65.val.eid,
									A4(_user$project$Lang$EFun, _p50._0, _p60, _p51._0._3, _p50._3),
									originalProgram));
							var newProgram = _p54._0;
							var funcVarUsagesTransformed = _p54._1;
							var isSafe = function () {
								var argAdditionsSafe = A2(
									_elm_lang$core$List$all,
									function (freeVarInArgSource) {
										var originalBindingScopeId = A2(_user$project$LangTools$bindingScopeIdFor, freeVarInArgSource, originalProgram);
										var freeIdentInArgSource = _user$project$LangTools$expToIdent(freeVarInArgSource);
										return A2(
											_elm_lang$core$List$all,
											function (funcVarUsageEId) {
												return _elm_lang$core$Native_Utils.eq(
													originalBindingScopeId,
													A3(_user$project$LangTools$bindingScopeIdForIdentAtEId, freeIdentInArgSource, funcVarUsageEId, newProgram));
											},
											_elm_lang$core$Set$toList(funcVarUsagesTransformed));
									},
									_user$project$LangTools$freeVars(_p61));
								var noDuplicateNamesInPat = function () {
									var newArgList = _user$project$LangTools$identifiersListInPats(_p60);
									return _elm_lang$core$Native_Utils.eq(
										newArgList,
										_user$project$Utils$dedup(newArgList));
								}();
								return _p51._0._0 && (_elm_lang$core$Native_Utils.eq(funcVarUsagesTransformed, funcVarUsageEIds) && (argAdditionsSafe && noDuplicateNamesInPat));
							}();
							var caption = function () {
								var baseCaption = A2(
									_elm_lang$core$Basics_ops['++'],
									'Insert Argument ',
									_user$project$Utils$squish(
										_user$project$LangUnparser$unparsePat(_p62)));
								var intoFuncString = A2(
									_elm_lang$core$Maybe$withDefault,
									'',
									A2(
										_elm_lang$core$Maybe$map,
										function (_p58) {
											var _p59 = _p58;
											return A2(_elm_lang$core$Basics_ops['++'], ' into ', _p59._1);
										},
										A2(_user$project$LangTools$findLetAndIdentBindingExp, _p65.val.eid, originalProgram)));
								return A2(_elm_lang$core$Basics_ops['++'], baseCaption, intoFuncString);
							}();
							return {
								ctor: '::',
								_0: A2(
									_user$project$InterfaceModel$setResultSafe,
									isSafe,
									A2(_user$project$InterfaceModel$synthesisResult, caption, newProgram)),
								_1: {ctor: '[]'}
							};
						}
					}
				} else {
					return _elm_lang$core$Native_Utils.crashCase(
						'CodeMotion',
						{
							start: {line: 1865, column: 11},
							end: {line: 1940, column: 77}
						},
						_p50)('CodeMotion.addArg_ should\'ve had an EFun here');
				}
			} else {
				return _elm_lang$core$Native_Utils.crashCase(
					'CodeMotion',
					{
						start: {line: 1857, column: 7},
						end: {line: 1943, column: 96}
					},
					_p49)('CodeMotion.addArg_ expected findLetAndIdentBindingExp to return ELet');
			}
		} else {
			return {ctor: '[]'};
		}
	});
var _user$project$CodeMotion$addArg = F3(
	function (argSourceEId, pathedPatId, originalProgram) {
		var funcToIsSafePatToInsertArgValExpAndNewFuncBody = F2(
			function (func, fbody) {
				var _p69 = A2(_user$project$Lang$findExpByEId, fbody, argSourceEId);
				if (_p69.ctor === 'Nothing') {
					var _p70 = A2(
						_elm_lang$core$Debug$log,
						A2(
							_elm_lang$core$Basics_ops['++'],
							'couldn\'t find argument source ',
							A2(
								_elm_lang$core$Basics_ops['++'],
								_elm_lang$core$Basics$toString(argSourceEId),
								A2(
									_elm_lang$core$Basics_ops['++'],
									' in function ',
									_user$project$LangUnparser$unparseWithIds(func)))),
						{ctor: '_Tuple0'});
					return _elm_lang$core$Maybe$Nothing;
				} else {
					var argName = function () {
						var namesToAvoid = _user$project$LangTools$identifiersSet(
							A3(
								_user$project$Lang$replaceExpNode,
								argSourceEId,
								_user$project$Lang$eVar('DUMMY VAR'),
								func));
						return A3(
							_user$project$LangTools$nonCollidingName,
							A2(_user$project$LangTools$expNameForEId, originalProgram, argSourceEId),
							2,
							namesToAvoid);
					}();
					var patToInsert = _user$project$Lang$pVar(argName);
					return _elm_lang$core$Maybe$Just(
						{
							ctor: '_Tuple4',
							_0: true,
							_1: patToInsert,
							_2: _p69._0,
							_3: A3(
								_user$project$Lang$replaceExpNodePreservingPrecedingWhitespace,
								argSourceEId,
								_user$project$Lang$eVar(argName),
								fbody)
						});
				}
			});
		return A3(_user$project$CodeMotion$addArg_, pathedPatId, funcToIsSafePatToInsertArgValExpAndNewFuncBody, originalProgram);
	});
var _user$project$CodeMotion$addArgs = F3(
	function (argSourceEIds, pathedPatId, originalProgram) {
		var _p71 = A3(
			_elm_lang$core$List$foldr,
			F2(
				function (argSourceEId, _p72) {
					var _p73 = _p72;
					var _p76 = _p73._1;
					var _p74 = A2(
						_elm_lang$core$Maybe$map,
						A2(_user$project$CodeMotion$addArg, argSourceEId, pathedPatId),
						_p73._0);
					if ((_p74.ctor === 'Just') && (_p74._0.ctor === '::')) {
						var _p75 = _p74._0._0._0;
						return {
							ctor: '_Tuple3',
							_0: _elm_lang$core$Maybe$Just(_p75.exp),
							_1: {ctor: '::', _0: _p75.description, _1: _p76},
							_2: _p73._2 && _p75.isSafe
						};
					} else {
						return {ctor: '_Tuple3', _0: _elm_lang$core$Maybe$Nothing, _1: _p76, _2: false};
					}
				}),
			{
				ctor: '_Tuple3',
				_0: _elm_lang$core$Maybe$Just(originalProgram),
				_1: {ctor: '[]'},
				_2: true
			},
			A2(
				_elm_lang$core$List$sortBy,
				_user$project$LangTools$locationInProgram(originalProgram),
				argSourceEIds));
		var maybeNewProgram = _p71._0;
		var resultDescs = _p71._1;
		var isSafe = _p71._2;
		var _p77 = maybeNewProgram;
		if (_p77.ctor === 'Just') {
			var caption = A3(
				_user$project$Utils$stringReplace,
				'Argument ',
				'Arguments ',
				_user$project$Utils$mergeStrings(resultDescs));
			return {
				ctor: '::',
				_0: A2(
					_user$project$InterfaceModel$setResultSafe,
					isSafe,
					A2(_user$project$InterfaceModel$synthesisResult, caption, _p77._0)),
				_1: {ctor: '[]'}
			};
		} else {
			return {ctor: '[]'};
		}
	});
var _user$project$CodeMotion$insertPat__ = F4(
	function (_p78, p, e1, path) {
		var _p79 = _p78;
		var _p110 = _p79._0;
		var _p109 = _p79._1;
		var maybeNewP_E__Pair = function () {
			var _p80 = {ctor: '_Tuple3', _0: p.val.p__, _1: e1.val.e__, _2: path};
			_v26_5:
			do {
				if ((_p80.ctor === '_Tuple3') && (_p80._2.ctor === '::')) {
					switch (_p80._0.ctor) {
						case 'PVar':
							if (_p80._2._1.ctor === '[]') {
								var _p81 = _p80._2._0;
								return _elm_lang$core$Maybe$Just(
									{
										ctor: '_Tuple2',
										_0: A5(
											_user$project$Lang$PList,
											_p80._0._0,
											A3(
												_user$project$Lang$setPatListWhitespace,
												'',
												' ',
												A3(
													_user$project$Utils$inserti,
													_p81,
													_p110,
													{
														ctor: '::',
														_0: p,
														_1: {ctor: '[]'}
													})),
											_user$project$Lang$space0,
											_elm_lang$core$Maybe$Nothing,
											_user$project$Lang$space0),
										_1: A5(
											_user$project$Lang$EList,
											_user$project$Lang$ws(
												_user$project$Lang$precedingWhitespace(e1)),
											A3(
												_user$project$Lang$setExpListWhitespace,
												'',
												' ',
												A3(
													_user$project$Utils$inserti,
													_p81,
													_p109,
													{
														ctor: '::',
														_0: e1,
														_1: {ctor: '[]'}
													})),
											_user$project$Lang$space0,
											_elm_lang$core$Maybe$Nothing,
											_user$project$Lang$space0)
									});
							} else {
								break _v26_5;
							}
						case 'PAs':
							if (_p80._2._1.ctor === '[]') {
								var _p82 = _p80._2._0;
								return _elm_lang$core$Maybe$Just(
									{
										ctor: '_Tuple2',
										_0: A5(
											_user$project$Lang$PList,
											_p80._0._0,
											A3(
												_user$project$Lang$setPatListWhitespace,
												'',
												' ',
												A3(
													_user$project$Utils$inserti,
													_p82,
													_p110,
													{
														ctor: '::',
														_0: p,
														_1: {ctor: '[]'}
													})),
											_user$project$Lang$space0,
											_elm_lang$core$Maybe$Nothing,
											_user$project$Lang$space0),
										_1: A5(
											_user$project$Lang$EList,
											_user$project$Lang$ws(
												_user$project$Lang$precedingWhitespace(e1)),
											A3(
												_user$project$Lang$setExpListWhitespace,
												'',
												' ',
												A3(
													_user$project$Utils$inserti,
													_p82,
													_p109,
													{
														ctor: '::',
														_0: e1,
														_1: {ctor: '[]'}
													})),
											_user$project$Lang$space0,
											_elm_lang$core$Maybe$Nothing,
											_user$project$Lang$space0)
									});
							} else {
								var _p83 = A2(
									_elm_lang$core$Debug$log,
									'can\'t insert into as-pattern yet (unsafe)',
									{ctor: '_Tuple0'});
								return _elm_lang$core$Maybe$Nothing;
							}
						case 'PList':
							if (_p80._1.ctor === 'EList') {
								if (_p80._2._1.ctor === '[]') {
									var _p87 = _p80._0._1;
									var _p86 = _p80._2._0;
									var _p85 = _p80._1._1;
									if ((_elm_lang$core$Native_Utils.cmp(
										_elm_lang$core$List$length(_p87) + 1,
										_p86) > -1) && (_elm_lang$core$Native_Utils.cmp(
										_elm_lang$core$List$length(_p85) + 1,
										_p86) > -1)) {
										return _elm_lang$core$Maybe$Just(
											{
												ctor: '_Tuple2',
												_0: A5(
													_user$project$Lang$PList,
													_p80._0._0,
													A2(
														_user$project$Lang$imitatePatListWhitespace,
														_p87,
														A3(_user$project$Utils$inserti, _p86, _p110, _p87)),
													_p80._0._2,
													_elm_lang$core$Maybe$Nothing,
													_p80._0._4),
												_1: A5(
													_user$project$Lang$EList,
													_p80._1._0,
													A2(
														_user$project$Lang$imitateExpListWhitespace,
														_p85,
														A3(_user$project$Utils$inserti, _p86, _p109, _p85)),
													_p80._1._2,
													_elm_lang$core$Maybe$Nothing,
													_p80._1._4)
											});
									} else {
										var _p84 = A2(
											_elm_lang$core$Debug$log,
											'can\'t insert into this list (note: cannot insert on list tail)',
											{
												ctor: '_Tuple3',
												_0: _user$project$LangUnparser$unparsePat(p),
												_1: _user$project$LangUnparser$unparse(e1),
												_2: path
											});
										return _elm_lang$core$Maybe$Nothing;
									}
								} else {
									var _p106 = _p80._0._4;
									var _p105 = _p80._0._2;
									var _p104 = _p80._0._0;
									var _p103 = _p80._0._1;
									var _p102 = _p80._0._3;
									var _p101 = _p80._1._3;
									var _p100 = _p80._2._1;
									var _p99 = _p80._2._0;
									var _p98 = _p80._1._4;
									var _p97 = _p80._1._2;
									var _p96 = _p80._1._0;
									var _p95 = _p80._1._1;
									if ((_elm_lang$core$Native_Utils.cmp(
										_elm_lang$core$List$length(_p103),
										_p99) > -1) && (_elm_lang$core$Native_Utils.cmp(
										_elm_lang$core$List$length(_p95),
										_p99) > -1)) {
										var _p88 = {
											ctor: '_Tuple2',
											_0: A2(_user$project$Utils$geti, _p99, _p103),
											_1: A2(_user$project$Utils$geti, _p99, _p95)
										};
										var pi = _p88._0;
										var ei = _p88._1;
										return A2(
											_elm_lang$core$Maybe$map,
											function (_p89) {
												var _p90 = _p89;
												var _p91 = {
													ctor: '_Tuple2',
													_0: A2(
														_user$project$Lang$imitatePatListWhitespace,
														_p103,
														A3(_user$project$Utils$replacei, _p99, _p90._0, _p103)),
													_1: A2(
														_user$project$Lang$imitateExpListWhitespace,
														_p95,
														A3(_user$project$Utils$replacei, _p99, _p90._1, _p95))
												};
												var newPs = _p91._0;
												var newEs = _p91._1;
												return {
													ctor: '_Tuple2',
													_0: A5(_user$project$Lang$PList, _p104, newPs, _p105, _p102, _p106),
													_1: A5(_user$project$Lang$EList, _p96, newEs, _p97, _p101, _p98)
												};
											},
											A4(
												_user$project$CodeMotion$insertPat__,
												{ctor: '_Tuple2', _0: _p110, _1: _p109},
												pi,
												ei,
												_p100));
									} else {
										if (_elm_lang$core$Native_Utils.eq(
											_elm_lang$core$List$length(_p103),
											_elm_lang$core$List$length(_p95)) && (_elm_lang$core$Native_Utils.eq(
											_p99,
											1 + _elm_lang$core$List$length(_p103)) && (_user$project$Utils$maybeToBool(_p102) && _user$project$Utils$maybeToBool(_p101)))) {
											var pi = _user$project$Utils$fromJust(_p102);
											var ei = _user$project$Utils$fromJust(_p101);
											return A2(
												_elm_lang$core$Maybe$map,
												function (_p92) {
													var _p93 = _p92;
													return {
														ctor: '_Tuple2',
														_0: A5(
															_user$project$Lang$PList,
															_p104,
															_p103,
															_p105,
															_elm_lang$core$Maybe$Just(_p93._0),
															_p106),
														_1: A5(
															_user$project$Lang$EList,
															_p96,
															_p95,
															_p97,
															_elm_lang$core$Maybe$Just(_p93._1),
															_p98)
													};
												},
												A4(
													_user$project$CodeMotion$insertPat__,
													{ctor: '_Tuple2', _0: _p110, _1: _p109},
													pi,
													ei,
													_p100));
										} else {
											var _p94 = A2(
												_elm_lang$core$Debug$log,
												'can\'t insert into this list (note: cannot insert on list tail)',
												{
													ctor: '_Tuple3',
													_0: _user$project$LangUnparser$unparsePat(p),
													_1: _user$project$LangUnparser$unparse(e1),
													_2: path
												});
											return _elm_lang$core$Maybe$Nothing;
										}
									}
								}
							} else {
								break _v26_5;
							}
						default:
							break _v26_5;
					}
				} else {
					break _v26_5;
				}
			} while(false);
			var _p107 = A2(
				_elm_lang$core$Debug$log,
				'insertPat__: pattern, path ',
				{ctor: '_Tuple2', _0: p.val.p__, _1: path});
			return _elm_lang$core$Maybe$Nothing;
		}();
		var _p108 = maybeNewP_E__Pair;
		if (_p108.ctor === 'Just') {
			return _elm_lang$core$Maybe$Just(
				{
					ctor: '_Tuple2',
					_0: A2(_user$project$Lang$replaceP__, p, _p108._0._0),
					_1: A2(_user$project$Lang$replaceE__, e1, _p108._0._1)
				});
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$CodeMotion$insertPat_ = F3(
	function (_p111, targetPath, exp) {
		var _p112 = _p111;
		var _p113 = exp.val.e__;
		if (_p113.ctor === 'ELet') {
			var _p116 = _p113._3;
			var _p114 = A4(
				_user$project$CodeMotion$insertPat__,
				{ctor: '_Tuple2', _0: _p112._0, _1: _p112._1},
				_p116,
				_p113._4,
				targetPath);
			if (_p114.ctor === 'Just') {
				return A2(
					_user$project$Lang$replaceE__,
					exp,
					A7(_user$project$Lang$ELet, _p113._0, _p113._1, _p113._2, _p114._0._0, _p114._0._1, _p113._5, _p113._6));
			} else {
				var _p115 = A2(
					_elm_lang$core$Debug$log,
					'insertPat_: pattern, path ',
					{ctor: '_Tuple2', _0: _p116.val.p__, _1: targetPath});
				return exp;
			}
		} else {
			var _p117 = A2(_elm_lang$core$Debug$log, 'insertPat_: not ELet', exp.val.e__);
			return exp;
		}
	});
var _user$project$CodeMotion$introduceVarTransformation = F3(
	function (m, expIds, maybeTargetPos) {
		var addNewEquationsAround = F4(
			function (insertedLetEId, program, namesAndBoundExps, e) {
				var _p118 = _user$project$Lang$patBoundExpOf(namesAndBoundExps);
				var pat = _p118._0;
				var boundExp = _p118._1;
				return A5(_user$project$LangTools$newLetFancyWhitespace, insertedLetEId, pat, boundExp, e, program);
			});
		var addNewEquationsInside = F3(
			function (targetPath, newEquations, e) {
				return A3(
					_user$project$CodeMotion$insertPat_,
					_user$project$Lang$patBoundExpOf(newEquations),
					targetPath,
					e);
			});
		var _p119 = maybeTargetPos;
		if (_p119.ctor === 'Nothing') {
			return _elm_lang$core$Maybe$Just(
				function (_p120) {
					var _p121 = _p120;
					var expToWrap = A2(
						_user$project$LangTools$deepestCommonAncestorWithNewline,
						m.inputExp,
						function (e) {
							return A2(_elm_lang$core$List$member, e.val.eid, expIds);
						});
					return A4(
						_user$project$CodeMotion$introduceVarTransformation_,
						m,
						expIds,
						expToWrap.val.eid,
						A2(addNewEquationsAround, -1, m.inputExp));
				});
		} else {
			if (_p119._0.ctor === 'ExpTargetPosition') {
				if (_p119._0._0._0.ctor === 'After') {
					return _elm_lang$core$Maybe$Nothing;
				} else {
					return _elm_lang$core$Maybe$Just(
						function (_p122) {
							var _p123 = _p122;
							return A4(
								_user$project$CodeMotion$introduceVarTransformation_,
								m,
								expIds,
								_p119._0._0._1,
								A2(addNewEquationsAround, -1, m.inputExp));
						});
				}
			} else {
				var _p124 = _user$project$Lang$patTargetPositionToTargetPathedPatId(_p119._0._0);
				if (((_p124.ctor === '_Tuple2') && (_p124._0.ctor === '_Tuple2')) && (_p124._0._1 === 1)) {
					var _p128 = _p124._0._0;
					var _p125 = A2(_user$project$Lang$findExpByEId, m.inputExp, _p128);
					if (_p125.ctor === 'Just') {
						return _user$project$Lang$isLet(_p125._0) ? _elm_lang$core$Maybe$Just(
							function (_p126) {
								var _p127 = _p126;
								return A4(
									_user$project$CodeMotion$introduceVarTransformation_,
									m,
									expIds,
									_p128,
									addNewEquationsInside(_p124._1));
							}) : _elm_lang$core$Maybe$Nothing;
					} else {
						return _elm_lang$core$Maybe$Nothing;
					}
				} else {
					return _elm_lang$core$Maybe$Nothing;
				}
			}
		}
	});
var _user$project$CodeMotion$makeDuplicateResults_ = F4(
	function (newScopeEId, pluckedPatAndBoundExps, newProgram, originalProgram) {
		var _p129 = _elm_lang$core$List$unzip(pluckedPatAndBoundExps);
		var pluckedPats = _p129._0;
		var pluckedBoundExps = _p129._1;
		var newScopeExp = A2(_user$project$LangTools$justFindExpByEId, newProgram, newScopeEId);
		var newScopePat = _user$project$LangTools$expToLetPat(newScopeExp);
		var newScopeBoundExp = _user$project$LangTools$expToLetBoundExp(newScopeExp);
		var newScopeBody = _user$project$LangTools$expToLetBody(newScopeExp);
		var isSafe = function () {
			var identUsesSafe = _elm_lang$core$Native_Utils.eq(
				0,
				_elm_lang$core$Set$size(
					A2(
						_elm_lang$core$Set$intersect,
						_user$project$LangTools$identifiersSetInPats(pluckedPats),
						_user$project$LangTools$freeIdentifiers(newScopeBody))));
			var boundExpVarsSafe = function () {
				var oldBoundExpFreeIdentBindingScopeIds = _elm_lang$core$Set$fromList(
					A2(
						_elm_lang$core$List$map,
						function ($var) {
							return {
								ctor: '_Tuple2',
								_0: _user$project$LangTools$expToIdent($var),
								_1: A2(
									_elm_lang$core$Maybe$withDefault,
									{ctor: '_Tuple2', _0: -1, _1: -1},
									A2(_user$project$LangTools$bindingScopeIdFor, $var, originalProgram))
							};
						},
						A2(_elm_lang$core$List$concatMap, _user$project$LangTools$freeVars, pluckedBoundExps)));
				var newBoundExpFreeIdentBindingScopeIds = _elm_lang$core$Set$fromList(
					A2(
						_elm_lang$core$List$map,
						function ($var) {
							return {
								ctor: '_Tuple2',
								_0: _user$project$LangTools$expToIdent($var),
								_1: A2(
									_elm_lang$core$Maybe$withDefault,
									{ctor: '_Tuple2', _0: -1, _1: -1},
									A2(_user$project$LangTools$bindingScopeIdFor, $var, newProgram))
							};
						},
						_user$project$LangTools$freeVars(newScopeBoundExp)));
				return A2(_user$project$Utils$isSubset, oldBoundExpFreeIdentBindingScopeIds, newBoundExpFreeIdentBindingScopeIds);
			}();
			var noDuplicateNamesInPat = function () {
				var namesDefinedAtNewScope = _user$project$LangTools$identifiersListInPat(newScopePat);
				return _elm_lang$core$Native_Utils.eq(
					namesDefinedAtNewScope,
					_user$project$Utils$dedup(namesDefinedAtNewScope));
			}();
			return identUsesSafe && (boundExpVarsSafe && noDuplicateNamesInPat);
		}();
		var caption = function () {
			var patStrs = A2(
				_elm_lang$core$List$map,
				function (_p130) {
					return _user$project$Utils$squish(
						_user$project$LangUnparser$unparsePat(_p130));
				},
				pluckedPats);
			return A2(
				_elm_lang$core$Basics_ops['++'],
				'Duplicate ',
				A2(
					_elm_lang$core$Basics_ops['++'],
					_elm_lang$core$Native_Utils.eq(
						_elm_lang$core$List$length(patStrs),
						1) ? 'Definition' : 'Definitions',
					A2(
						_elm_lang$core$Basics_ops['++'],
						' of ',
						_user$project$Utils$toSentence(patStrs))));
		}();
		var result = A2(
			_user$project$InterfaceModel$setResultSafe,
			isSafe,
			A2(_user$project$InterfaceModel$synthesisResult, caption, newProgram));
		return {
			ctor: '::',
			_0: result,
			_1: {ctor: '[]'}
		};
	});
var _user$project$CodeMotion$makeResult = function (baseDescription) {
	return function (uniqueNameToOldName) {
		return function (renamings) {
			return function (liftedUniqueIdents) {
				return function (identsInvalidlyFreeRewritten) {
					return function (identsWithInvalidlyFreeVarsHandled) {
						return function (varEIdsDeliberatelyRemoved) {
							return function (insertedVarEIdToBindingPId) {
								return function (originalProgramUniqueNames) {
									return function (newProgram) {
										var uniqueNameToOldNameUsed = A2(
											_elm_lang$core$Dict$diff,
											uniqueNameToOldName,
											_elm_lang$core$Dict$fromList(
												A2(
													_elm_lang$core$List$map,
													function (_p131) {
														var _p132 = _p131;
														return {ctor: '_Tuple2', _0: _p132._2, _1: _p132._1};
													},
													renamings)));
										var isSafe = function () {
											var originalVarRefs = _user$project$LangTools$allVarEIdsToBindingPIdList(originalProgramUniqueNames);
											var newVarRefs = _user$project$LangTools$allVarEIdsToBindingPIdList(newProgram);
											var allOldReferencesSame = A2(
												_elm_lang$core$List$all,
												function (_p133) {
													var _p134 = _p133;
													var _p136 = _p134._0;
													return A2(_elm_lang$core$List$member, _p136, varEIdsDeliberatelyRemoved) || A2(
														_user$project$Utils$equalAsSets,
														A2(
															_elm_lang$core$List$filter,
															function (_p135) {
																return A2(
																	F2(
																		function (x, y) {
																			return _elm_lang$core$Native_Utils.eq(x, y);
																		}),
																	_p136,
																	_elm_lang$core$Tuple$first(_p135));
															},
															newVarRefs),
														{
															ctor: '::',
															_0: {ctor: '_Tuple2', _0: _p136, _1: _p134._1},
															_1: {ctor: '[]'}
														});
												},
												originalVarRefs);
											var allNewReferencesGood = function () {
												var apparentlyInsertedVarRefs = A2(_user$project$Utils$diffAsSet, newVarRefs, originalVarRefs);
												return A2(
													_user$project$Utils$equalAsSets,
													apparentlyInsertedVarRefs,
													_elm_lang$core$Dict$toList(insertedVarEIdToBindingPId));
											}();
											var noDuplicateNamesInPats = A2(
												_elm_lang$core$List$all,
												function (pat) {
													var namesDefinedAtPat = _user$project$LangTools$identifiersListInPat(pat);
													return _elm_lang$core$Native_Utils.eq(
														namesDefinedAtPat,
														_user$project$Utils$dedup(namesDefinedAtPat));
												},
												_user$project$LangTools$allPats(newProgram));
											return allOldReferencesSame && (allNewReferencesGood && noDuplicateNamesInPats);
										}();
										var caption = function () {
											var liftingsStr = function () {
												if (_elm_lang$core$Native_Utils.cmp(
													_elm_lang$core$List$length(liftedUniqueIdents),
													0) > 0) {
													var liftedNames = A2(
														_elm_lang$core$List$map,
														function (uniqueIdent) {
															return A3(_user$project$Utils$getWithDefault, uniqueIdent, uniqueIdent, uniqueNameToOldName);
														},
														liftedUniqueIdents);
													return A2(
														_elm_lang$core$Basics_ops['++'],
														' lifting ',
														_user$project$Utils$toSentence(liftedNames));
												} else {
													return '';
												}
											}();
											var rewrittingsStr = function () {
												var rewrittenThings = A2(
													_elm_lang$core$List$map,
													function (ident) {
														return A3(_user$project$Utils$getWithDefault, ident, ident, uniqueNameToOldNameUsed);
													},
													A2(_elm_lang$core$Basics_ops['++'], identsInvalidlyFreeRewritten, identsWithInvalidlyFreeVarsHandled));
												return (!_elm_lang$core$List$isEmpty(rewrittenThings)) ? A2(
													_elm_lang$core$Basics_ops['++'],
													' rewriting ',
													_user$project$Utils$toSentence(rewrittenThings)) : '';
											}();
											var renamingsStr = (!_elm_lang$core$List$isEmpty(renamings)) ? A2(
												_elm_lang$core$Basics_ops['++'],
												' renaming ',
												_user$project$Utils$toSentence(
													A2(
														_elm_lang$core$List$map,
														function (_p137) {
															var _p138 = _p137;
															return A2(
																_elm_lang$core$Basics_ops['++'],
																_p138._0,
																A2(
																	_elm_lang$core$Basics_ops['++'],
																	' ',
																	A2(
																		_elm_lang$core$Basics_ops['++'],
																		_p138._1,
																		A2(_elm_lang$core$Basics_ops['++'], ' to ', _p138._2))));
														},
														renamings))) : '';
											return A2(
												_elm_lang$core$Basics_ops['++'],
												baseDescription,
												_user$project$Utils$toSentence(
													A2(
														_elm_lang$core$List$filter,
														F2(
															function (x, y) {
																return !_elm_lang$core$Native_Utils.eq(x, y);
															})(''),
														{
															ctor: '::',
															_0: liftingsStr,
															_1: {
																ctor: '::',
																_0: rewrittingsStr,
																_1: {
																	ctor: '::',
																	_0: renamingsStr,
																	_1: {ctor: '[]'}
																}
															}
														})));
										}();
										var result = A2(
											_user$project$InterfaceModel$setResultSafe,
											isSafe,
											A2(_user$project$InterfaceModel$synthesisResult, caption, newProgram));
										return result;
									};
								};
							};
						};
					};
				};
			};
		};
	};
};
var _user$project$CodeMotion$maybeSatisfyUniqueNamesDependenciesByTwiddlingArithmetic = function (programUniqueNames) {
	var numericIdents = _user$project$LangTools$numericLetBoundIdentifiers(programUniqueNames);
	var allFreeVars = _user$project$LangTools$freeVars(programUniqueNames);
	var simpleLetBindings = _elm_lang$core$Dict$fromList(
		_user$project$LangTools$allSimplyResolvableLetBindings(programUniqueNames));
	var defsWithInvalidFreeNumericVars = A2(
		_elm_lang$core$Dict$filter,
		F2(
			function (ident, boundExp) {
				return A2(
					_elm_lang$core$List$any,
					function (varExp) {
						return A2(
							_elm_lang$core$Set$member,
							_user$project$LangTools$expToIdent(varExp),
							numericIdents) && A2(_elm_lang$core$List$member, varExp, allFreeVars);
					},
					_user$project$LangTools$freeVars(boundExp));
			}),
		simpleLetBindings);
	var identsOriginallySomewhereInvalidlyFreeWithDefWhereUsedInvalidly = A2(
		_elm_lang$core$List$concatMap,
		function (_p139) {
			var _p140 = _p139;
			var _p141 = _p140._1;
			return A2(
				_elm_lang$core$List$map,
				function (invalidlyUsedVarExp) {
					return {
						ctor: '_Tuple3',
						_0: _user$project$LangTools$expToIdent(invalidlyUsedVarExp),
						_1: _p140._0,
						_2: _p141
					};
				},
				A2(
					_elm_lang$core$List$filter,
					function (varExp) {
						return A2(
							_elm_lang$core$Set$member,
							_user$project$LangTools$expToIdent(varExp),
							numericIdents) && A2(_elm_lang$core$List$member, varExp, allFreeVars);
					},
					_user$project$LangTools$freeVars(_p141)));
		},
		_elm_lang$core$Dict$toList(defsWithInvalidFreeNumericVars));
	var inlineInvalidFreeNumericIdentsUntilConvergence = function (program) {
		inlineInvalidFreeNumericIdentsUntilConvergence:
		while (true) {
			var freshened = _user$project$FastParser$freshen(program);
			var allFreeVars = _user$project$LangTools$freeVars(freshened);
			var _p142 = A3(
				_user$project$Lang$mapFoldExp,
				F2(
					function (exp, somethingHappened) {
						var _p143 = _user$project$LangTools$expToMaybeIdent(exp);
						if (_p143.ctor === 'Nothing') {
							return {ctor: '_Tuple2', _0: exp, _1: somethingHappened};
						} else {
							var _p144 = _p143._0;
							return (A2(_elm_lang$core$Set$member, _p144, numericIdents) && A2(_elm_lang$core$List$member, exp, allFreeVars)) ? {
								ctor: '_Tuple2',
								_0: A2(
									_user$project$Lang$copyPrecedingWhitespace,
									exp,
									_user$project$FastParser$clearAllIds(
										A3(_user$project$Utils$justGet_, 'maybeSatisfyUniqueNamesDependenciesByTwiddlingArithmetic', _p144, simpleLetBindings))),
								_1: true
							} : {ctor: '_Tuple2', _0: exp, _1: somethingHappened};
						}
					}),
				false,
				freshened);
			var programInlinedOnce = _p142._0;
			var somethingHappened = _p142._1;
			if (somethingHappened) {
				var _v44 = programInlinedOnce;
				program = _v44;
				continue inlineInvalidFreeNumericIdentsUntilConvergence;
			} else {
				return freshened;
			}
		}
	};
	var identToEqnLocId = _elm_lang$core$Dict$fromList(
		A2(
			_elm_lang$core$List$map,
			_user$project$Utils$flip,
			_user$project$Utils$zipi1(
				_elm_lang$core$Set$toList(
					_user$project$LangTools$identifiersSetPlusPrelude(programUniqueNames)))));
	var expToMaybeLocEqn = function (exp) {
		expToMaybeLocEqn:
		while (true) {
			var _p145 = exp.val.e__;
			switch (_p145.ctor) {
				case 'EConst':
					return _elm_lang$core$Maybe$Just(
						_user$project$LocEqn$LocEqnConst(_p145._1));
				case 'EVar':
					return A2(
						_elm_lang$core$Maybe$map,
						_user$project$LocEqn$LocEqnLoc,
						A2(_elm_lang$core$Dict$get, _p145._1, identToEqnLocId));
				case 'EOp':
					var _p147 = _p145._2;
					var _p146 = _p145._1.val;
					switch (_p146.ctor) {
						case 'Plus':
							return A2(
								_elm_lang$core$Maybe$map,
								_user$project$LocEqn$LocEqnOp(_user$project$Lang$Plus),
								_user$project$Utils$projJusts(
									A2(_elm_lang$core$List$map, expToMaybeLocEqn, _p147)));
						case 'Minus':
							return A2(
								_elm_lang$core$Maybe$map,
								_user$project$LocEqn$LocEqnOp(_user$project$Lang$Minus),
								_user$project$Utils$projJusts(
									A2(_elm_lang$core$List$map, expToMaybeLocEqn, _p147)));
						case 'Mult':
							return A2(
								_elm_lang$core$Maybe$map,
								_user$project$LocEqn$LocEqnOp(_user$project$Lang$Mult),
								_user$project$Utils$projJusts(
									A2(_elm_lang$core$List$map, expToMaybeLocEqn, _p147)));
						case 'Div':
							return A2(
								_elm_lang$core$Maybe$map,
								_user$project$LocEqn$LocEqnOp(_user$project$Lang$Div),
								_user$project$Utils$projJusts(
									A2(_elm_lang$core$List$map, expToMaybeLocEqn, _p147)));
						default:
							return _elm_lang$core$Maybe$Nothing;
					}
				case 'EComment':
					var _v47 = _p145._2;
					exp = _v47;
					continue expToMaybeLocEqn;
				case 'EOption':
					var _v48 = _p145._4;
					exp = _v48;
					continue expToMaybeLocEqn;
				case 'ELet':
					var _v49 = _p145._5;
					exp = _v49;
					continue expToMaybeLocEqn;
				case 'ETyp':
					var _v50 = _p145._3;
					exp = _v50;
					continue expToMaybeLocEqn;
				case 'EColonType':
					var _v51 = _p145._1;
					exp = _v51;
					continue expToMaybeLocEqn;
				case 'ETypeAlias':
					var _v52 = _p145._3;
					exp = _v52;
					continue expToMaybeLocEqn;
				default:
					return _elm_lang$core$Maybe$Nothing;
			}
		}
	};
	var locEqnToExp = function (locEqn) {
		return A4(
			_user$project$LocEqn$locEqnToExp,
			_user$project$Lang$unann,
			_elm_lang$core$Dict$empty,
			_user$project$Utils$flipDict(identToEqnLocId),
			locEqn);
	};
	var inlinedSimplifiedProgram = function () {
		var inlinedProgram = inlineInvalidFreeNumericIdentsUntilConvergence(programUniqueNames);
		var boundEIdsToSimplify = _elm_lang$core$Set$fromList(
			A2(
				_elm_lang$core$List$filterMap,
				function (_p148) {
					var _p149 = _p148;
					return A2(
						_elm_lang$core$Maybe$map,
						function (_p150) {
							return _p149._1.val.eid;
						},
						A2(_elm_lang$core$Dict$get, _p149._0, defsWithInvalidFreeNumericVars));
				},
				_user$project$LangTools$allSimplyResolvableLetBindings(inlinedProgram)));
		return _user$project$FastParser$freshen(
			A2(
				_user$project$Lang$mapExp,
				function (exp) {
					if (A2(_elm_lang$core$Set$member, exp.val.eid, boundEIdsToSimplify)) {
						var _p151 = expToMaybeLocEqn(exp);
						if (_p151.ctor === 'Just') {
							return A2(
								_user$project$Lang$copyPrecedingWhitespace,
								exp,
								locEqnToExp(
									_user$project$LocEqn$normalizeSimplify(_p151._0)));
						} else {
							return exp;
						}
					} else {
						return exp;
					}
				},
				inlinedProgram));
	}();
	var _p152 = A3(
		_elm_lang$core$List$foldr,
		F2(
			function (_p154, _p153) {
				var _p155 = _p154;
				var _p168 = _p155._1;
				var _p167 = _p155._0;
				var _p156 = _p153;
				var _p166 = _p156._0;
				var _p165 = _p156._2;
				var _p164 = _p156._1;
				var noChange = {ctor: '_Tuple3', _0: _p166, _1: _p164, _2: _p165};
				if (A2(_elm_lang$core$Set$member, _p167, _p164) || A2(_elm_lang$core$Set$member, _p168, _p165)) {
					return noChange;
				} else {
					var _p157 = expToMaybeLocEqn(_p155._2);
					if (_p157.ctor === 'Nothing') {
						return noChange;
					} else {
						var lhs = A2(
							_user$project$Utils$fromJust_,
							'maybeSatisfyUniqueNamesDependenciesByTwiddlingArithmetic expToMaybeLocEqn (eVar identOfDefWhereUsedInvalidly)',
							expToMaybeLocEqn(
								_user$project$Lang$eVar(_p168)));
						var locIdInvalidlyFree = A3(_user$project$Utils$justGet_, 'maybeSatisfyUniqueNamesDependenciesByTwiddlingArithmetic Utils.justGet_ identInvalidlyFree identToEqnLocId', _p167, identToEqnLocId);
						var _p158 = A2(
							_elm_lang$core$Maybe$map,
							locEqnToExp,
							A4(_user$project$LocEqn$solveForLocUnchecked, locIdInvalidlyFree, _elm_lang$core$Dict$empty, lhs, _p157._0));
						if (_p158.ctor === 'Nothing') {
							return noChange;
						} else {
							var _p163 = _p158._0;
							var simpleLetBindings = _elm_lang$core$Dict$fromList(
								_user$project$LangTools$allSimplyResolvableLetBindings(_p166));
							var invalidlyFreeIdentBoundExpOld = A3(_user$project$Utils$justGet_, 'maybeSatisfyUniqueNamesDependenciesByTwiddlingArithmetic invalidlyFreeIdentBoundExpOld', _p167, simpleLetBindings);
							var boundExpWhereUsedInvalidlyPartiallyReduced = A3(_user$project$Utils$justGet_, 'maybeSatisfyUniqueNamesDependenciesByTwiddlingArithmetic boundExpWhereUsedInvalidlyPartiallyReduced', _p168, simpleLetBindings);
							var boundExpWhereUsedInvalidlyReduced = function () {
								var identsToReduce = A2(
									_elm_lang$core$Set$intersect,
									numericIdents,
									A2(
										_elm_lang$core$Set$diff,
										_user$project$LangTools$identifiersSet(_p163),
										_user$project$LangTools$identifiersSet(invalidlyFreeIdentBoundExpOld)));
								var inlineUntilConvergence = function (boundExpWhereUsedInvalidlyPartiallyReduced) {
									inlineUntilConvergence:
									while (true) {
										var _p159 = A3(
											_user$project$Lang$mapFoldExp,
											F2(
												function (exp, somethingHappened) {
													var _p160 = _user$project$LangTools$expToMaybeIdent(exp);
													if (_p160.ctor === 'Nothing') {
														return {ctor: '_Tuple2', _0: exp, _1: somethingHappened};
													} else {
														var _p161 = _p160._0;
														return A2(_elm_lang$core$Set$member, _p161, identsToReduce) ? {
															ctor: '_Tuple2',
															_0: A2(
																_user$project$Lang$copyPrecedingWhitespace,
																exp,
																_user$project$FastParser$clearAllIds(
																	A3(_user$project$Utils$justGet_, 'maybeSatisfyUniqueNamesDependenciesByTwiddlingArithmetic inlineUntilConvergence', _p161, simpleLetBindings))),
															_1: true
														} : {ctor: '_Tuple2', _0: exp, _1: somethingHappened};
													}
												}),
											false,
											boundExpWhereUsedInvalidlyPartiallyReduced);
										var inlinedOnce = _p159._0;
										var somethingHappened = _p159._1;
										if (somethingHappened) {
											var _v60 = inlinedOnce;
											boundExpWhereUsedInvalidlyPartiallyReduced = _v60;
											continue inlineUntilConvergence;
										} else {
											return boundExpWhereUsedInvalidlyPartiallyReduced;
										}
									}
								};
								var inlined = inlineUntilConvergence(boundExpWhereUsedInvalidlyPartiallyReduced);
								var inlinedSimplified = function () {
									if (_elm_lang$core$Native_Utils.eq(inlined, boundExpWhereUsedInvalidlyPartiallyReduced)) {
										return inlined;
									} else {
										var _p162 = expToMaybeLocEqn(inlined);
										if (_p162.ctor === 'Just') {
											return locEqnToExp(
												_user$project$LocEqn$normalizeSimplify(_p162._0));
										} else {
											return inlined;
										}
									}
								}();
								return inlinedSimplified;
							}();
							var newProgram = _user$project$FastParser$freshen(
								A3(
									_user$project$Lang$replaceExpNodePreservingPrecedingWhitespace,
									invalidlyFreeIdentBoundExpOld.val.eid,
									_p163,
									A3(_user$project$Lang$replaceExpNodePreservingPrecedingWhitespace, boundExpWhereUsedInvalidlyPartiallyReduced.val.eid, boundExpWhereUsedInvalidlyReduced, _p166)));
							return {
								ctor: '_Tuple3',
								_0: newProgram,
								_1: A2(_elm_lang$core$Set$insert, _p167, _p164),
								_2: A2(_elm_lang$core$Set$insert, _p168, _p165)
							};
						}
					}
				}
			}),
		{ctor: '_Tuple3', _0: inlinedSimplifiedProgram, _1: _elm_lang$core$Set$empty, _2: _elm_lang$core$Set$empty},
		A2(
			_elm_lang$core$List$sortBy,
			function (_p169) {
				var _p170 = _p169;
				return {
					ctor: '_Tuple2',
					_0: _user$project$LangTools$expToLocation(
						A3(_user$project$Utils$justGet_, 'maybeSatisfyUniqueNamesDependenciesByTwiddlingArithmetic maybeTwiddledProgram sortBy1', _p170._0, simpleLetBindings)),
					_1: _user$project$LangTools$expToLocation(
						A3(_user$project$Utils$justGet_, 'maybeSatisfyUniqueNamesDependenciesByTwiddlingArithmetic maybeTwiddledProgram sortBy2', _p170._1, simpleLetBindings))
				};
			},
			identsOriginallySomewhereInvalidlyFreeWithDefWhereUsedInvalidly));
	var twiddledProgram = _p152._0;
	var identsInvalidlyFreeRewritten = _p152._1;
	var identsWithInvalidlyFreeVarsHandled = _p152._2;
	return (_elm_lang$core$Native_Utils.cmp(
		_elm_lang$core$Set$size(identsInvalidlyFreeRewritten),
		0) > 0) ? _elm_lang$core$Maybe$Just(
		{
			ctor: '_Tuple3',
			_0: twiddledProgram,
			_1: _elm_lang$core$Set$toList(identsInvalidlyFreeRewritten),
			_2: _elm_lang$core$Set$toList(identsWithInvalidlyFreeVarsHandled)
		}) : _elm_lang$core$Maybe$Nothing;
};
var _user$project$CodeMotion$removeNoopResults = F2(
	function (originalProgram, results) {
		var originalUnparsed = A3(_user$project$LangUnparser$unparseWithUniformWhitespace, true, true, originalProgram);
		return A2(
			_elm_lang$core$List$filter,
			function (_p171) {
				var _p172 = _p171;
				return !_elm_lang$core$Native_Utils.eq(
					originalUnparsed,
					A3(_user$project$LangUnparser$unparseWithUniformWhitespace, true, true, _p172._0.exp));
			},
			results);
	});
var _user$project$CodeMotion$pluckExpFromExpsByPath = F2(
	function (path, exps) {
		var _p173 = path;
		if (_p173.ctor === '::') {
			var _p178 = _p173._0;
			return A2(
				_elm_lang$core$Maybe$map,
				function (_p174) {
					var _p175 = _p174;
					var _p177 = _p175._0;
					var _p176 = _p175._1;
					if (_p176.ctor === 'Just') {
						return {
							ctor: '_Tuple2',
							_0: _p177,
							_1: A3(_user$project$Utils$replacei, _p178, _p176._0, exps)
						};
					} else {
						return {
							ctor: '_Tuple2',
							_0: _p177,
							_1: A2(_user$project$Utils$removei, _p178, exps)
						};
					}
				},
				A2(
					_elm_lang$core$Maybe$andThen,
					_user$project$CodeMotion$pluckExpByPath(_p173._1),
					A2(_user$project$Utils$maybeGeti1, _p178, exps)));
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$CodeMotion$pluckExpByPath = F2(
	function (path, exp) {
		var _p179 = {ctor: '_Tuple2', _0: exp.val.e__, _1: path};
		_v67_2:
		do {
			if (_p179.ctor === '_Tuple2') {
				if (_p179._1.ctor === '[]') {
					return _elm_lang$core$Maybe$Just(
						{ctor: '_Tuple2', _0: exp, _1: _elm_lang$core$Maybe$Nothing});
				} else {
					if (_p179._0.ctor === 'EList') {
						var _p190 = _p179._0._4;
						var _p189 = _p179._0._2;
						var _p188 = _p179._0._0;
						var _p187 = _p179._0._3;
						var _p186 = _p179._1._1;
						var _p185 = _p179._1._0;
						var _p184 = _p179._0._1;
						return (_elm_lang$core$Native_Utils.cmp(
							_p185,
							_elm_lang$core$List$length(_p184)) < 1) ? A2(
							_elm_lang$core$Maybe$map,
							function (_p180) {
								var _p181 = _p180;
								return {
									ctor: '_Tuple2',
									_0: _p181._0,
									_1: _elm_lang$core$Maybe$Just(
										A2(
											_user$project$Lang$replaceE__,
											exp,
											A5(_user$project$Lang$EList, _p188, _p181._1, _p189, _p187, _p190)))
								};
							},
							A2(
								_user$project$CodeMotion$pluckExpFromExpsByPath,
								{ctor: '::', _0: _p185, _1: _p186},
								_p184)) : (_elm_lang$core$Native_Utils.eq(
							_p185,
							_elm_lang$core$List$length(_p184) + 1) ? A2(
							_elm_lang$core$Maybe$map,
							function (_p182) {
								var _p183 = _p182;
								return {
									ctor: '_Tuple2',
									_0: _p183._0,
									_1: _elm_lang$core$Maybe$Just(
										A2(
											_user$project$Lang$replaceE__,
											exp,
											A5(_user$project$Lang$EList, _p188, _p184, _p189, _p183._1, _p190)))
								};
							},
							A2(
								_elm_lang$core$Maybe$andThen,
								_user$project$CodeMotion$pluckExpByPath(_p186),
								_p187)) : _elm_lang$core$Maybe$Nothing);
					} else {
						break _v67_2;
					}
				}
			} else {
				break _v67_2;
			}
		} while(false);
		return _elm_lang$core$Maybe$Nothing;
	});
var _user$project$CodeMotion$tryReorderExps = F4(
	function (pathsToMove, insertPath, pathsToRemove, exps) {
		var _p191 = A2(_user$project$CodeMotion$maybePathAfterPathsRemoved, pathsToMove, insertPath);
		if (_p191.ctor === 'Nothing') {
			var _p192 = A2(
				_elm_lang$core$Debug$log,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'can\'t insert at that path in ',
					A2(
						_elm_lang$core$String$join,
						' ',
						A2(_elm_lang$core$List$map, _user$project$LangUnparser$unparse, exps))),
				insertPath);
			return _elm_lang$core$Maybe$Nothing;
		} else {
			var maybePluckedExpsAndExpsAfterRemoved1 = A3(
				_user$project$Utils$foldrMaybe,
				F2(
					function (pathToRemove, _p193) {
						var _p194 = _p193;
						return A2(
							_elm_lang$core$Maybe$map,
							function (_p195) {
								var _p196 = _p195;
								return {
									ctor: '_Tuple2',
									_0: {ctor: '::', _0: _p196._0, _1: _p194._0},
									_1: _p196._1
								};
							},
							A2(_user$project$CodeMotion$pluckExpFromExpsByPath, pathToRemove, _p194._1));
					}),
				_elm_lang$core$Maybe$Just(
					{
						ctor: '_Tuple2',
						_0: {ctor: '[]'},
						_1: exps
					}),
				_elm_lang$core$List$sort(pathsToMove));
			var _p197 = maybePluckedExpsAndExpsAfterRemoved1;
			if (_p197.ctor === 'Just') {
				var maybeExpsAfterInsertion = A3(
					_user$project$Utils$foldrMaybe,
					F2(
						function (pluckedExp, newExps) {
							return A3(_user$project$CodeMotion$addExpToExpsByPath, pluckedExp, _p191._0, newExps);
						}),
					_elm_lang$core$Maybe$Just(_p197._0._1),
					_p197._0._0);
				var maybeNewExps = function () {
					var removeExpFromExpsByPath = F2(
						function (pathToRemove, exps) {
							return A2(
								_elm_lang$core$Maybe$map,
								_elm_lang$core$Tuple$second,
								A2(_user$project$CodeMotion$pluckExpFromExpsByPath, pathToRemove, exps));
						});
					return A3(
						_user$project$Utils$foldrMaybe,
						removeExpFromExpsByPath,
						maybeExpsAfterInsertion,
						_elm_lang$core$List$sort(pathsToRemove));
				}();
				return maybeNewExps;
			} else {
				return _elm_lang$core$Maybe$Nothing;
			}
		}
	});
var _user$project$CodeMotion$reorderExpressionsTransformation = F2(
	function (originalProgram, selections) {
		var _p198 = selections;
		_v74_2:
		do {
			if (_p198.ctor === '_Tuple7') {
				if (_p198._2.ctor === '[]') {
					return _elm_lang$core$Maybe$Nothing;
				} else {
					if (((((_p198._3.ctor === '[]') && (_p198._4.ctor === '[]')) && (_p198._5.ctor === '::')) && (_p198._5._1.ctor === '[]')) && (_p198._6.ctor === '[]')) {
						var _p207 = _p198._2;
						var _p199 = _p198._5._0;
						var beforeAfter = _p199._0;
						var expTargetEId = _p199._1;
						var relevantEIds = {ctor: '::', _0: expTargetEId, _1: _p207};
						var maybeSharedAncestor = _user$project$Utils$maybeLast(
							A2(
								_user$project$Lang$commonAncestors,
								function (e) {
									return A2(_elm_lang$core$List$member, e.val.eid, relevantEIds);
								},
								originalProgram));
						var reorder = F3(
							function (sharedAncestorEId, expList, makeNewAncestorE__) {
								var maybeInsertPath = function () {
									var _p200 = {
										ctor: '_Tuple2',
										_0: beforeAfter,
										_1: A2(_user$project$LangTools$eidPathInExpList, expList, expTargetEId)
									};
									_v75_2:
									do {
										if (_p200.ctor === '_Tuple2') {
											if (_p200._0.ctor === 'Before') {
												if (_p200._1.ctor === 'Just') {
													return _elm_lang$core$Maybe$Just(_p200._1._0);
												} else {
													break _v75_2;
												}
											} else {
												if (_p200._1.ctor === 'Just') {
													return _user$project$Lang$pathRightSibling(_p200._1._0);
												} else {
													break _v75_2;
												}
											}
										} else {
											break _v75_2;
										}
									} while(false);
									return _elm_lang$core$Maybe$Nothing;
								}();
								var maybePathsToMove = _user$project$Utils$projJusts(
									A2(
										_elm_lang$core$List$map,
										_user$project$LangTools$eidPathInExpList(expList),
										_p207));
								var _p201 = A3(
									_user$project$Utils$bindMaybe2,
									F2(
										function (pathsToMove, insertPath) {
											return A4(
												_user$project$CodeMotion$tryReorderExps,
												pathsToMove,
												insertPath,
												{ctor: '[]'},
												expList);
										}),
									maybePathsToMove,
									maybeInsertPath);
								if (_p201.ctor === 'Nothing') {
									return _elm_lang$core$Maybe$Nothing;
								} else {
									var ancestorE__WithReorderedChildren = makeNewAncestorE__(
										A2(_user$project$Lang$imitateExpListWhitespace, expList, _p201._0));
									var newProgram = A3(_user$project$Lang$replaceExpNodeE__ByEId, sharedAncestorEId, ancestorE__WithReorderedChildren, originalProgram);
									return _elm_lang$core$Maybe$Just(
										function (_p202) {
											var _p203 = _p202;
											return {
												ctor: '::',
												_0: A2(_user$project$InterfaceModel$synthesisResult, 'Reorder Expressions', newProgram),
												_1: {ctor: '[]'}
											};
										});
								}
							});
						var _p204 = maybeSharedAncestor;
						if (_p204.ctor === 'Just') {
							var _p206 = _p204._0;
							var sharedAncestorEId = _p206.val.eid;
							var _p205 = _p206.val.e__;
							switch (_p205.ctor) {
								case 'EList':
									return A3(
										reorder,
										sharedAncestorEId,
										_p205._1,
										function (newListExps) {
											return A5(_user$project$Lang$EList, _p205._0, newListExps, _p205._2, _p205._3, _p205._4);
										});
								case 'EApp':
									return A3(
										reorder,
										sharedAncestorEId,
										_p205._2,
										function (newArgExps) {
											return A4(_user$project$Lang$EApp, _p205._0, _p205._1, newArgExps, _p205._3);
										});
								case 'EOp':
									return A3(
										reorder,
										sharedAncestorEId,
										_p205._2,
										function (newOperands) {
											return A4(_user$project$Lang$EOp, _p205._0, _p205._1, newOperands, _p205._3);
										});
								default:
									return _elm_lang$core$Maybe$Nothing;
							}
						} else {
							return _elm_lang$core$Maybe$Nothing;
						}
					} else {
						break _v74_2;
					}
				}
			} else {
				break _v74_2;
			}
		} while(false);
		return _elm_lang$core$Maybe$Nothing;
	});
var _user$project$CodeMotion$pluckPatFromPats = F2(
	function (path, pats) {
		var _p208 = path;
		if (_p208.ctor === '::') {
			var _p213 = _p208._0;
			return A2(
				_elm_lang$core$Maybe$map,
				function (_p209) {
					var _p210 = _p209;
					var _p212 = _p210._0;
					var _p211 = _p210._1;
					if (_p211.ctor === 'Just') {
						return {
							ctor: '_Tuple2',
							_0: _p212,
							_1: A2(
								_user$project$Lang$imitatePatListWhitespace,
								pats,
								A3(_user$project$Utils$replacei, _p213, _p211._0, pats))
						};
					} else {
						return {
							ctor: '_Tuple2',
							_0: _p212,
							_1: A2(
								_user$project$Lang$imitatePatListWhitespace,
								pats,
								A2(_user$project$Utils$removei, _p213, pats))
						};
					}
				},
				A2(
					_elm_lang$core$Maybe$andThen,
					_user$project$CodeMotion$pluckPat(_p208._1),
					A2(_user$project$Utils$maybeGeti1, _p213, pats)));
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$CodeMotion$pluckPat = F2(
	function (path, pat) {
		var _p214 = {ctor: '_Tuple2', _0: pat.val.p__, _1: path};
		_v83_3:
		do {
			if (_p214.ctor === '_Tuple2') {
				if (_p214._1.ctor === '[]') {
					return _elm_lang$core$Maybe$Just(
						{ctor: '_Tuple2', _0: pat, _1: _elm_lang$core$Maybe$Nothing});
				} else {
					switch (_p214._0.ctor) {
						case 'PAs':
							if (_p214._1._0 === 1) {
								var _p215 = A2(
									_elm_lang$core$Debug$log,
									'plucking out of as-pattern is generally unsafe (not allowed yet)',
									{ctor: '_Tuple0'});
								return _elm_lang$core$Maybe$Nothing;
							} else {
								break _v83_3;
							}
						case 'PList':
							var _p226 = _p214._0._4;
							var _p225 = _p214._0._2;
							var _p224 = _p214._0._0;
							var _p223 = _p214._0._1;
							var _p222 = _p214._0._3;
							var _p221 = _p214._1._1;
							var _p220 = _p214._1._0;
							return (_elm_lang$core$Native_Utils.cmp(
								_p220,
								_elm_lang$core$List$length(_p223)) < 1) ? A2(
								_elm_lang$core$Maybe$map,
								function (_p216) {
									var _p217 = _p216;
									return {
										ctor: '_Tuple2',
										_0: _p217._0,
										_1: _elm_lang$core$Maybe$Just(
											A2(
												_user$project$Lang$replaceP__,
												pat,
												A5(_user$project$Lang$PList, _p224, _p217._1, _p225, _p222, _p226)))
									};
								},
								A2(
									_user$project$CodeMotion$pluckPatFromPats,
									{ctor: '::', _0: _p220, _1: _p221},
									_p223)) : (_elm_lang$core$Native_Utils.eq(
								_p220,
								_elm_lang$core$List$length(_p223) + 1) ? A2(
								_elm_lang$core$Maybe$map,
								function (_p218) {
									var _p219 = _p218;
									return {
										ctor: '_Tuple2',
										_0: _p219._0,
										_1: _elm_lang$core$Maybe$Just(
											A2(
												_user$project$Lang$replaceP__,
												pat,
												A5(_user$project$Lang$PList, _p224, _p223, _p225, _p219._1, _p226)))
									};
								},
								A2(
									_elm_lang$core$Maybe$andThen,
									_user$project$CodeMotion$pluckPat(_p221),
									_p222)) : _elm_lang$core$Maybe$Nothing);
						default:
							break _v83_3;
					}
				}
			} else {
				break _v83_3;
			}
		} while(false);
		return _elm_lang$core$Maybe$Nothing;
	});
var _user$project$CodeMotion$justRemovePatFromPats = F3(
	function (failureMessage, path, pats) {
		return _elm_lang$core$Tuple$second(
			A2(
				_user$project$Utils$fromJust_,
				failureMessage,
				A2(_user$project$CodeMotion$pluckPatFromPats, path, pats)));
	});
var _user$project$CodeMotion$removeArg = F2(
	function (pathedPatId, originalProgram) {
		var _p227 = pathedPatId;
		var funcEId = _p227._0._0;
		var path = _p227._1;
		var _p228 = A2(_user$project$LangTools$findLetAndIdentBindingExp, funcEId, originalProgram);
		if (_p228.ctor === 'Just') {
			var _p258 = _p228._0._1;
			var _p229 = _p228._0._0.val.e__;
			if (_p229.ctor === 'ELet') {
				var _p256 = _p229._5;
				var _p255 = _p229._2;
				var _p254 = _p229._4;
				var funcVarUsageEIds = _p255 ? _elm_lang$core$Set$fromList(
					A2(
						_elm_lang$core$Basics_ops['++'],
						A2(_user$project$LangTools$identifierUsageEIds, _p258, _p254),
						A2(_user$project$LangTools$identifierUsageEIds, _p258, _p256))) : _elm_lang$core$Set$fromList(
					A2(_user$project$LangTools$identifierUsageEIds, _p258, _p256));
				var _p230 = _p254.val.e__;
				if (_p230.ctor === 'EFun') {
					var _p252 = _p230._1;
					var _p251 = _p230._2;
					var _p231 = A2(_user$project$CodeMotion$pluckPatFromPats, path, _p252);
					if ((_p231.ctor === 'Just') && (_p231._0.ctor === '_Tuple2')) {
						var _p249 = _p231._0._1;
						var _p248 = _p231._0._0;
						var transformedApplicationsWithRemovedCallsiteArgument = A2(
							_elm_lang$core$List$filterMap,
							function (exp) {
								var _p232 = exp.val.e__;
								if (_p232.ctor === 'EApp') {
									var _p236 = _p232._1;
									var _p235 = _p232._2;
									return A2(_elm_lang$core$Set$member, _p236.val.eid, funcVarUsageEIds) ? A2(
										_elm_lang$core$Maybe$map,
										function (_p233) {
											var _p234 = _p233;
											var newAppArgs = (_elm_lang$core$Native_Utils.eq(
												_p249,
												{ctor: '[]'}) && (!_elm_lang$core$Native_Utils.eq(
												_p235,
												{ctor: '[]'}))) ? {
												ctor: '::',
												_0: _user$project$Lang$eTuple(
													{ctor: '[]'}),
												_1: {ctor: '[]'}
											} : _p234._1;
											return {
												ctor: '_Tuple4',
												_0: exp.val.eid,
												_1: A2(
													_user$project$Lang$replaceE__,
													exp,
													A4(_user$project$Lang$EApp, _p232._0, _p236, newAppArgs, _p232._3)),
												_2: _p236.val.eid,
												_3: _p234._0
											};
										},
										A2(_user$project$CodeMotion$pluckExpFromExpsByPath, path, _p235)) : _elm_lang$core$Maybe$Nothing;
								} else {
									return _elm_lang$core$Maybe$Nothing;
								}
							},
							_p255 ? A2(
								_elm_lang$core$Basics_ops['++'],
								_user$project$Lang$flattenExpTree(_p254),
								_user$project$Lang$flattenExpTree(_p256)) : _user$project$Lang$flattenExpTree(_p256));
						var _p237 = transformedApplicationsWithRemovedCallsiteArgument;
						if ((_p237.ctor === '::') && (_p237._0.ctor === '_Tuple4')) {
							var _p246 = _p237._0._3;
							var _p238 = function () {
								var _p239 = {
									ctor: '_Tuple2',
									_0: _p248.val.p__,
									_1: _user$project$LangTools$nodeCount(_p246)
								};
								if (((_p239.ctor === '_Tuple2') && (_p239._0.ctor === 'PVar')) && (_p239._1 === 1)) {
									var _p241 = _p239._0._1;
									var newFBody = A2(
										_user$project$LangTools$transformVarsUntilBound,
										A2(
											_elm_lang$core$Dict$singleton,
											_p241,
											function (varExp) {
												return A2(
													_user$project$Lang$setEId,
													varExp.val.eid,
													_user$project$FastParser$clearAllIds(_p246));
											}),
										_p251);
									var replacementLocationEIds = A2(
										_elm_lang$core$List$map,
										function (_p240) {
											return function (_) {
												return _.eid;
											}(
												function (_) {
													return _.val;
												}(_p240));
										},
										A2(_user$project$LangTools$identifierUses, _p241, _p251));
									return {ctor: '_Tuple2', _0: newFBody, _1: replacementLocationEIds};
								} else {
									var inlinedArgEId = _user$project$FastParser$maxId(originalProgram) + 1;
									var newFBody = A5(
										_user$project$LangTools$newLetFancyWhitespace,
										-1,
										_p248,
										A2(
											_user$project$Lang$setEId,
											inlinedArgEId,
											_user$project$FastParser$clearAllIds(_p246)),
										_p251,
										originalProgram);
									var replacementLocationEIds = {
										ctor: '::',
										_0: inlinedArgEId,
										_1: {ctor: '[]'}
									};
									return {ctor: '_Tuple2', _0: newFBody, _1: replacementLocationEIds};
								}
							}();
							var newFBody = _p238._0;
							var replacementLocationEIds = _p238._1;
							var newProgram = function () {
								var eidToNewNode = _elm_lang$core$Dict$fromList(
									A2(
										_elm_lang$core$List$map,
										function (_p242) {
											var _p243 = _p242;
											return {ctor: '_Tuple2', _0: _p243._0, _1: _p243._1};
										},
										transformedApplicationsWithRemovedCallsiteArgument));
								var newArgPats = _elm_lang$core$Native_Utils.eq(
									_p249,
									{ctor: '[]'}) ? {
									ctor: '::',
									_0: _user$project$Lang$pList0(
										{ctor: '[]'}),
									_1: {ctor: '[]'}
								} : _p249;
								return A2(
									_user$project$Lang$replaceExpNodes,
									eidToNewNode,
									A3(
										_user$project$Lang$replaceExpNodeE__,
										_p254,
										A4(_user$project$Lang$EFun, _p230._0, newArgPats, newFBody, _p230._3),
										originalProgram));
							}();
							var isSafe = function () {
								var allCallsitesTransformed = function () {
									var usagesTransformed = _elm_lang$core$Set$fromList(
										A2(
											_elm_lang$core$List$map,
											function (_p244) {
												var _p245 = _p244;
												return _p245._2;
											},
											transformedApplicationsWithRemovedCallsiteArgument));
									return _elm_lang$core$Native_Utils.eq(funcVarUsageEIds, usagesTransformed);
								}();
								var argReplacementSafe = A2(
									_elm_lang$core$List$all,
									function (freeVarInReplacement) {
										var originalBindingScopeId = A2(_user$project$LangTools$bindingScopeIdFor, freeVarInReplacement, originalProgram);
										var freeIdentInReplacement = _user$project$LangTools$expToIdent(freeVarInReplacement);
										return A2(
											_elm_lang$core$List$all,
											function (replacedEId) {
												return _elm_lang$core$Native_Utils.eq(
													originalBindingScopeId,
													A3(_user$project$LangTools$bindingScopeIdForIdentAtEId, freeIdentInReplacement, replacedEId, newProgram));
											},
											replacementLocationEIds);
									},
									_user$project$LangTools$freeVars(_p246));
								return allCallsitesTransformed && argReplacementSafe;
							}();
							return {
								ctor: '::',
								_0: A2(
									_user$project$InterfaceModel$setResultSafe,
									isSafe,
									A2(
										_user$project$InterfaceModel$synthesisResult,
										A2(
											_elm_lang$core$Basics_ops['++'],
											'Remove Argument ',
											_user$project$Utils$squish(
												_user$project$LangUnparser$unparsePat(_p248))),
										newProgram)),
								_1: {ctor: '[]'}
							};
						} else {
							var _p247 = A2(_elm_lang$core$Debug$log, 'no uses to provide arg replacement value', transformedApplicationsWithRemovedCallsiteArgument);
							return {ctor: '[]'};
						}
					} else {
						var _p250 = A2(
							_elm_lang$core$Debug$log,
							'cannot pluck argument',
							{ctor: '_Tuple2', _0: path, _1: _p252});
						return {ctor: '[]'};
					}
				} else {
					return _elm_lang$core$Native_Utils.crashCase(
						'CodeMotion',
						{
							start: {line: 2089, column: 11},
							end: {line: 2198, column: 79}
						},
						_p230)('CodeMotion.removeArg should\'ve had an EFun here');
				}
			} else {
				return _elm_lang$core$Native_Utils.crashCase(
					'CodeMotion',
					{
						start: {line: 2081, column: 7},
						end: {line: 2201, column: 98}
					},
					_p229)('CodeMotion.removeArg expected findLetAndIdentBindingExp to return ELet');
			}
		} else {
			return {ctor: '[]'};
		}
	});
var _user$project$CodeMotion$removeArgs = F2(
	function (pathedPatIds, originalProgram) {
		var _p259 = A3(
			_elm_lang$core$List$foldr,
			F2(
				function (pathedPatId, _p260) {
					var _p261 = _p260;
					var _p262 = A2(
						_elm_lang$core$Maybe$map,
						_user$project$CodeMotion$removeArg(pathedPatId),
						_p261._0);
					if ((_p262.ctor === 'Just') && (_p262._0.ctor === '::')) {
						var _p263 = _p262._0._0._0;
						return {
							ctor: '_Tuple2',
							_0: _elm_lang$core$Maybe$Just(_p263.exp),
							_1: _p261._1 && _p263.isSafe
						};
					} else {
						return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: false};
					}
				}),
			{
				ctor: '_Tuple2',
				_0: _elm_lang$core$Maybe$Just(originalProgram),
				_1: true
			},
			_elm_lang$core$List$sort(pathedPatIds));
		var maybeNewProgram = _p259._0;
		var isSafe = _p259._1;
		var _p264 = maybeNewProgram;
		if (_p264.ctor === 'Just') {
			return {
				ctor: '::',
				_0: A2(
					_user$project$InterfaceModel$setResultSafe,
					isSafe,
					A2(_user$project$InterfaceModel$synthesisResult, 'Remove Arguments', _p264._0)),
				_1: {ctor: '[]'}
			};
		} else {
			return {ctor: '[]'};
		}
	});
var _user$project$CodeMotion$deadPathsInPats = function (pats) {
	return A2(
		_elm_lang$core$List$concatMap,
		function (_p265) {
			var _p266 = _p265;
			return A2(
				_elm_lang$core$List$map,
				F2(
					function (x, y) {
						return {ctor: '::', _0: x, _1: y};
					})(_p266._0),
				_user$project$CodeMotion$deadPathsInPat(_p266._1));
		},
		_user$project$Utils$zipi1(pats));
};
var _user$project$CodeMotion$deadPathsInPat = function (pat) {
	if (_elm_lang$core$Native_Utils.eq(
		_user$project$LangTools$identifiersListInPat(pat),
		{ctor: '[]'})) {
		return {
			ctor: '::',
			_0: {ctor: '[]'},
			_1: {ctor: '[]'}
		};
	} else {
		var _p267 = pat.val.p__;
		switch (_p267.ctor) {
			case 'PVar':
				return {ctor: '[]'};
			case 'PConst':
				return A2(
					_elm_lang$core$Debug$log,
					'why do you put constants in your function arguments?!',
					{ctor: '[]'});
			case 'PBase':
				return A2(
					_elm_lang$core$Debug$log,
					'why do you put base vals in your function arguments?!',
					{ctor: '[]'});
			case 'PAs':
				return {ctor: '[]'};
			default:
				var _p268 = _p267._1;
				var deadPathsInTail = A2(
					_elm_lang$core$Maybe$withDefault,
					{ctor: '[]'},
					A2(
						_elm_lang$core$Maybe$map,
						function (tailPat) {
							var tailI = _elm_lang$core$List$length(_p268) + 1;
							return A2(
								_elm_lang$core$List$map,
								F2(
									function (x, y) {
										return {ctor: '::', _0: x, _1: y};
									})(tailI),
								_user$project$CodeMotion$deadPathsInPat(tailPat));
						},
						_p267._3));
				return A2(
					_elm_lang$core$Basics_ops['++'],
					_user$project$CodeMotion$deadPathsInPats(_p268),
					deadPathsInTail);
		}
	}
};
var _user$project$CodeMotion$reorderFunctionArgs = F4(
	function (funcEId, paths, targetPath, originalProgram) {
		var _p269 = A2(_user$project$LangTools$findLetAndIdentBindingExp, funcEId, originalProgram);
		if (_p269.ctor === 'Just') {
			var _p294 = _p269._0._1;
			var _p270 = _p269._0._0.val.e__;
			if (_p270.ctor === 'ELet') {
				var _p292 = _p270._5;
				var _p291 = _p270._4;
				var funcVarUsageEIds = _p270._2 ? _elm_lang$core$Set$fromList(
					A2(
						_elm_lang$core$Basics_ops['++'],
						A2(_user$project$LangTools$identifierUsageEIds, _p294, _p291),
						A2(_user$project$LangTools$identifierUsageEIds, _p294, _p292))) : _elm_lang$core$Set$fromList(
					A2(_user$project$LangTools$identifierUsageEIds, _p294, _p292));
				var _p271 = _p291.val.e__;
				if (_p271.ctor === 'EFun') {
					var _p289 = _p271._1;
					var _p272 = A3(
						_elm_lang$core$List$foldr,
						F2(
							function (pathToRemove, _p273) {
								var _p274 = _p273;
								var _p278 = _p274._0;
								var _p277 = _p274._2;
								var _p276 = _p274._1;
								var _p275 = A2(_user$project$CodeMotion$pluckPatFromPats, pathToRemove, _p276);
								if ((_p275.ctor === 'Just') && (_p275._0.ctor === '_Tuple2')) {
									return {
										ctor: '_Tuple3',
										_0: {ctor: '::', _0: _p275._0._0, _1: _p278},
										_1: _p275._0._1,
										_2: {ctor: '::', _0: pathToRemove, _1: _p277}
									};
								} else {
									return {ctor: '_Tuple3', _0: _p278, _1: _p276, _2: _p277};
								}
							}),
						{
							ctor: '_Tuple3',
							_0: {ctor: '[]'},
							_1: _p289,
							_2: {ctor: '[]'}
						},
						_elm_lang$core$List$sort(paths));
					var pluckedPats = _p272._0;
					var fpatsAfterRemoved1 = _p272._1;
					var pathsRemoved1 = _p272._2;
					var _p279 = A2(_user$project$CodeMotion$maybePathAfterPathsRemoved, pathsRemoved1, targetPath);
					if (_p279.ctor === 'Nothing') {
						var _p280 = A2(
							_elm_lang$core$Debug$log,
							'can\'t insert at that path',
							{ctor: '_Tuple2', _0: targetPath, _1: _p289});
						return {ctor: '[]'};
					} else {
						var _p288 = _p279._0;
						var maybeFPatsAfterInsertion = A3(
							_user$project$Utils$foldrMaybe,
							F2(
								function (pluckedPat, newFPats) {
									return A3(_user$project$CodeMotion$addPatToPats, pluckedPat, _p288, newFPats);
								}),
							_elm_lang$core$Maybe$Just(fpatsAfterRemoved1),
							pluckedPats);
						var _p281 = maybeFPatsAfterInsertion;
						if (_p281.ctor === 'Nothing') {
							var _p282 = A2(
								_elm_lang$core$Debug$log,
								'couldn\'t reorder patterns',
								{ctor: '_Tuple2', _0: _p288, _1: fpatsAfterRemoved1});
							return {ctor: '[]'};
						} else {
							var _p287 = _p281._0;
							var pathsRemoved2 = _user$project$CodeMotion$deadPathsInPats(_p287);
							var newFPats = A3(
								_elm_lang$core$List$foldr,
								_user$project$CodeMotion$justRemovePatFromPats('CodeMotion.reorderFunctionArgs shouldn\'t crash because we are removing paths known to exist'),
								_p287,
								pathsRemoved2);
							var _p283 = A3(
								_user$project$Lang$mapFoldExp,
								F2(
									function (exp, funcVarUsagesTransformed) {
										var _p284 = exp.val.e__;
										if (_p284.ctor === 'EApp') {
											var _p286 = _p284._1;
											if (A2(_elm_lang$core$Set$member, _p286.val.eid, funcVarUsageEIds)) {
												var _p285 = A4(_user$project$CodeMotion$tryReorderExps, pathsRemoved1, targetPath, pathsRemoved2, _p284._2);
												if (_p285.ctor === 'Just') {
													return {
														ctor: '_Tuple2',
														_0: A2(
															_user$project$Lang$replaceE__,
															exp,
															A4(_user$project$Lang$EApp, _p284._0, _p286, _p285._0, _p284._3)),
														_1: A2(_elm_lang$core$Set$insert, _p286.val.eid, funcVarUsagesTransformed)
													};
												} else {
													return {ctor: '_Tuple2', _0: exp, _1: funcVarUsagesTransformed};
												}
											} else {
												return {ctor: '_Tuple2', _0: exp, _1: funcVarUsagesTransformed};
											}
										} else {
											return {ctor: '_Tuple2', _0: exp, _1: funcVarUsagesTransformed};
										}
									}),
								_elm_lang$core$Set$empty,
								A3(
									_user$project$Lang$replaceExpNodeE__ByEId,
									_p291.val.eid,
									A4(_user$project$Lang$EFun, _p271._0, newFPats, _p271._2, _p271._3),
									originalProgram));
							var newProgram = _p283._0;
							var funcVarUsagesTransformed = _p283._1;
							var isSafe = _elm_lang$core$Native_Utils.eq(funcVarUsageEIds, funcVarUsagesTransformed);
							return {
								ctor: '::',
								_0: A2(
									_user$project$InterfaceModel$setResultSafe,
									isSafe,
									A2(_user$project$InterfaceModel$synthesisResult, 'Reorder Arguments', newProgram)),
								_1: {ctor: '[]'}
							};
						}
					}
				} else {
					return _elm_lang$core$Native_Utils.crashCase(
						'CodeMotion',
						{
							start: {line: 2281, column: 11},
							end: {line: 2356, column: 89}
						},
						_p271)('CodeMotion.reorderFunctionArgs should\'ve had an EFun here');
				}
			} else {
				return _elm_lang$core$Native_Utils.crashCase(
					'CodeMotion',
					{
						start: {line: 2273, column: 7},
						end: {line: 2359, column: 108}
					},
					_p270)('CodeMotion.reorderFunctionArgs expected findLetAndIdentBindingExp to return ELet');
			}
		} else {
			return {ctor: '[]'};
		}
	});
var _user$project$CodeMotion$pluck__ = F3(
	function (p, e1, path) {
		var _p295 = {ctor: '_Tuple3', _0: p.val.p__, _1: e1.val.e__, _2: path};
		_v110_3:
		do {
			if (_p295.ctor === '_Tuple3') {
				if (_p295._2.ctor === '[]') {
					return _elm_lang$core$Maybe$Just(
						{
							ctor: '_Tuple3',
							_0: {ctor: '_Tuple2', _0: p, _1: e1},
							_1: A2(
								_user$project$Lang$replaceP__,
								p,
								A3(
									_user$project$Lang$PVar,
									_user$project$Lang$ws(
										_user$project$Lang$precedingWhitespacePat(p)),
									'*RemoveMe*',
									_user$project$Lang$noWidgetDecl)),
							_2: A2(
								_user$project$Lang$replaceE__,
								e1,
								A5(
									_user$project$Lang$EList,
									_user$project$Lang$ws(
										_user$project$Lang$precedingWhitespace(e1)),
									{ctor: '[]'},
									_user$project$Lang$space0,
									_elm_lang$core$Maybe$Nothing,
									_user$project$Lang$space0))
						});
				} else {
					switch (_p295._0.ctor) {
						case 'PAs':
							var _p296 = A2(
								_elm_lang$core$Debug$log,
								'can\'t pluck out of as-pattern yet (unsafe)',
								{ctor: '_Tuple0'});
							return _elm_lang$core$Maybe$Nothing;
						case 'PList':
							if (_p295._1.ctor === 'EList') {
								var _p313 = _p295._0._4;
								var _p312 = _p295._0._2;
								var _p311 = _p295._0._0;
								var _p310 = _p295._0._1;
								var _p309 = _p295._0._3;
								var _p308 = _p295._1._3;
								var _p307 = _p295._2._1;
								var _p306 = _p295._2._0;
								var _p305 = _p295._1._4;
								var _p304 = _p295._1._2;
								var _p303 = _p295._1._0;
								var _p302 = _p295._1._1;
								if ((_elm_lang$core$Native_Utils.cmp(
									_elm_lang$core$List$length(_p310),
									_p306) > -1) && (_elm_lang$core$Native_Utils.cmp(
									_elm_lang$core$List$length(_p302),
									_p306) > -1)) {
									var pi = A2(_user$project$Utils$geti, _p306, _p310);
									var ei = A2(_user$project$Utils$geti, _p306, _p302);
									return A2(
										_elm_lang$core$Maybe$map,
										function (_p297) {
											var _p298 = _p297;
											var _p299 = {
												ctor: '_Tuple2',
												_0: A3(_user$project$Utils$replacei, _p306, _p298._1, _p310),
												_1: A3(_user$project$Utils$replacei, _p306, _p298._2, _p302)
											};
											var newPs = _p299._0;
											var newEs = _p299._1;
											return {
												ctor: '_Tuple3',
												_0: _p298._0,
												_1: A2(
													_user$project$Lang$replaceP__,
													p,
													A5(_user$project$Lang$PList, _p311, newPs, _p312, _p309, _p313)),
												_2: A2(
													_user$project$Lang$replaceE__,
													e1,
													A5(_user$project$Lang$EList, _p303, newEs, _p304, _p308, _p305))
											};
										},
										A3(_user$project$CodeMotion$pluck__, pi, ei, _p307));
								} else {
									if (_elm_lang$core$Native_Utils.eq(
										_elm_lang$core$List$length(_p310),
										_elm_lang$core$List$length(_p302)) && (_elm_lang$core$Native_Utils.eq(
										_p306,
										1 + _elm_lang$core$List$length(_p310)) && (_user$project$Utils$maybeToBool(_p309) && _user$project$Utils$maybeToBool(_p308)))) {
										var pi = _user$project$Utils$fromJust(_p309);
										var ei = _user$project$Utils$fromJust(_p308);
										return A2(
											_elm_lang$core$Maybe$map,
											function (_p300) {
												var _p301 = _p300;
												return {
													ctor: '_Tuple3',
													_0: _p301._0,
													_1: A2(
														_user$project$Lang$replaceP__,
														p,
														A5(
															_user$project$Lang$PList,
															_p311,
															_p310,
															_p312,
															_elm_lang$core$Maybe$Just(_p301._1),
															_p313)),
													_2: A2(
														_user$project$Lang$replaceE__,
														e1,
														A5(
															_user$project$Lang$EList,
															_p303,
															_p302,
															_p304,
															_elm_lang$core$Maybe$Just(_p301._2),
															_p305))
												};
											},
											A3(_user$project$CodeMotion$pluck__, pi, ei, _p307));
									} else {
										return A2(_elm_lang$core$Debug$log, 'pluck index longer than head list of PList or EList', _elm_lang$core$Maybe$Nothing);
									}
								}
							} else {
								break _v110_3;
							}
						default:
							break _v110_3;
					}
				}
			} else {
				break _v110_3;
			}
		} while(false);
		var _p314 = A2(
			_elm_lang$core$Debug$log,
			A2(
				_elm_lang$core$Basics_ops['++'],
				'pluck_: bad pattern ',
				_user$project$LangUnparser$unparsePat(p)),
			path);
		return _elm_lang$core$Maybe$Nothing;
	});
var _user$project$CodeMotion$pluck_ = F3(
	function (scopeExp, path, program) {
		var _p315 = function () {
			var _p316 = scopeExp.val.e__;
			if (_p316.ctor === 'ELet') {
				if (_p316._2 === false) {
					return {
						ctor: '_Tuple6',
						_0: A3(_user$project$CodeMotion$pluck__, _p316._3, _p316._4, path),
						_1: _p316._0,
						_2: _p316._1,
						_3: false,
						_4: _p316._5,
						_5: _p316._6
					};
				} else {
					var _p317 = A2(
						_elm_lang$core$Debug$log,
						'pluck: letrec not supported',
						{ctor: '_Tuple0'});
					return {ctor: '_Tuple6', _0: _elm_lang$core$Maybe$Nothing, _1: _p316._0, _2: _p316._1, _3: true, _4: _p316._5, _5: _p316._6};
				}
			} else {
				return _elm_lang$core$Native_Utils.crashCase(
					'CodeMotion',
					{
						start: {line: 215, column: 5},
						end: {line: 218, column: 158}
					},
					_p316)(
					A2(
						_elm_lang$core$Basics_ops['++'],
						'pluck_: bad Exp__ (note: case branches, and func args not supported) ',
						_user$project$LangUnparser$unparseWithIds(scopeExp)));
			}
		}();
		var maybePluckedAndNewPatAndBoundExp = _p315._0;
		var ws1 = _p315._1;
		var letKind = _p315._2;
		var isRec = _p315._3;
		var e2 = _p315._4;
		var ws2 = _p315._5;
		var _p319 = maybePluckedAndNewPatAndBoundExp;
		if (_p319.ctor === 'Nothing') {
			return _elm_lang$core$Maybe$Nothing;
		} else {
			return _elm_lang$core$Maybe$Just(
				{
					ctor: '_Tuple2',
					_0: _p319._0._0,
					_1: A3(
						_user$project$Lang$replaceExpNodeE__,
						scopeExp,
						A7(_user$project$Lang$ELet, ws1, letKind, isRec, _p319._0._1, _p319._0._2, e2, ws2),
						program)
				});
		}
	});
var _user$project$CodeMotion$pluck = F2(
	function (_p320, program) {
		var _p321 = _p320;
		return A2(
			_elm_lang$core$Maybe$andThen,
			function (scope) {
				return A3(_user$project$CodeMotion$pluck_, scope, _p321._1, program);
			},
			A2(
				_user$project$Utils$filterMaybe,
				_user$project$Lang$isLet,
				A2(_user$project$Lang$findExpByEId, program, _p321._0._0)));
	});
var _user$project$CodeMotion$liftDependenciesBasedOnUniqueNames = function (program) {
	var needToLift = _elm_lang$core$Set$toList(
		A2(
			_elm_lang$core$Set$diff,
			_user$project$LangTools$freeIdentifiers(program),
			_user$project$LangTools$preludeIdentifiers));
	var safeToLift = function () {
		var identToDependentIdents = _elm_lang$core$Dict$fromList(
			A2(
				_elm_lang$core$List$map,
				function (_p322) {
					var _p323 = _p322;
					return {
						ctor: '_Tuple2',
						_0: _p323._0,
						_1: _elm_lang$core$Set$toList(
							_user$project$LangTools$freeIdentifiers(_p323._1))
					};
				},
				_user$project$LangTools$allSimplyResolvableLetBindings(program)));
		var hasCyclicDependencies = F2(
			function (seenIdents, ident) {
				if (A2(_elm_lang$core$Set$member, ident, seenIdents)) {
					return true;
				} else {
					var _p324 = A2(_elm_lang$core$Dict$get, ident, identToDependentIdents);
					if (_p324.ctor === 'Just') {
						return A2(
							_elm_lang$core$List$any,
							hasCyclicDependencies(
								A2(_elm_lang$core$Set$insert, ident, seenIdents)),
							_p324._0);
					} else {
						return false;
					}
				}
			});
		return A2(
			_elm_lang$core$List$filter,
			function (_p325) {
				return !A2(hasCyclicDependencies, _elm_lang$core$Set$empty, _p325);
			},
			needToLift);
	}();
	var bringIdentIntoScope = function (identToLift) {
		var maybeOriginalDefiningScope = A2(
			_user$project$Lang$findFirstNode,
			function (_p326) {
				return A2(
					_elm_lang$core$Maybe$withDefault,
					false,
					A2(
						_elm_lang$core$Maybe$map,
						function (_p327) {
							return A2(
								_elm_lang$core$List$member,
								identToLift,
								_user$project$LangTools$identifiersListInPat(_p327));
						},
						_user$project$LangTools$expToMaybeLetPat(_p326)));
			},
			program);
		var _p328 = maybeOriginalDefiningScope;
		if (_p328.ctor === 'Nothing') {
			return _elm_lang$core$Maybe$Nothing;
		} else {
			var _p333 = _p328._0;
			var _p329 = A2(
				_user$project$LangTools$pathForIdentInPat,
				identToLift,
				_user$project$LangTools$expToLetPat(_p333));
			if (_p329.ctor === 'Nothing') {
				return _elm_lang$core$Maybe$Nothing;
			} else {
				var _p330 = A2(
					_user$project$CodeMotion$pluck,
					{
						ctor: '_Tuple2',
						_0: {ctor: '_Tuple2', _0: _p333.val.eid, _1: 1},
						_1: _p329._0
					},
					program);
				if (_p330.ctor === 'Nothing') {
					return _elm_lang$core$Maybe$Nothing;
				} else {
					var _p332 = _p330._0._1;
					var eidToWrap = function (_) {
						return _.eid;
					}(
						function (_) {
							return _.val;
						}(
							A2(
								_user$project$LangTools$deepestCommonAncestorWithNewline,
								program,
								function (_p331) {
									return A2(
										F2(
											function (x, y) {
												return _elm_lang$core$Native_Utils.eq(x, y);
											}),
										_elm_lang$core$Maybe$Just(identToLift),
										_user$project$LangTools$expToMaybeIdent(_p331));
								})));
					var insertedLetEId = _user$project$FastParser$maxId(program) + 1;
					var newProgram = A3(
						_user$project$Lang$mapExpNode,
						eidToWrap,
						function (expToWrap) {
							return A5(_user$project$LangTools$newLetFancyWhitespace, insertedLetEId, _p330._0._0._0, _p330._0._0._1, expToWrap, _p332);
						},
						_p332);
					return _elm_lang$core$Maybe$Just(
						{ctor: '_Tuple2', _0: newProgram, _1: identToLift});
				}
			}
		}
	};
	var maybeNewProgramAndMovedIdent = A2(_user$project$Utils$mapFirstSuccess, bringIdentIntoScope, safeToLift);
	var _p334 = maybeNewProgramAndMovedIdent;
	if (_p334.ctor === 'Nothing') {
		return {
			ctor: '_Tuple2',
			_0: _user$project$LangSimplify$simplifyAssignments(program),
			_1: {ctor: '[]'}
		};
	} else {
		var _p335 = _user$project$CodeMotion$liftDependenciesBasedOnUniqueNames(_p334._0._0);
		var finalProgram = _p335._0;
		var movedIdents = _p335._1;
		return {
			ctor: '_Tuple2',
			_0: finalProgram,
			_1: {ctor: '::', _0: _p334._0._1, _1: movedIdents}
		};
	}
};
var _user$project$CodeMotion$tryResolvingProblemsAfterTransform_ = function (baseDescription) {
	return function (uniqueNameToOldName) {
		return function (maybeNewScopeEId) {
			return function (_p336) {
				return function (namesUniqueTouched) {
					return function (varEIdsPreviouslyDeliberatelyRemoved) {
						return function (insertedVarEIdToBindingPId) {
							return function (originalProgramUniqueNames) {
								return function (newProgramUniqueNames) {
									return function (tryTwiddling) {
										var _p337 = _p336;
										var maybeNewPatUniqueNames = A2(
											_elm_lang$core$Maybe$map,
											function (newScopeEId) {
												return _user$project$LangTools$expToLetPat(
													A2(_user$project$LangTools$justFindExpByEId, newProgramUniqueNames, newScopeEId));
											},
											maybeNewScopeEId);
										var resultForOriginalNamesPriority = F7(
											function (uniqueNameToOldNameDescribedPrioritized, movedUniqueIdents, identsInvalidlyFreeRewritten, identsWithInvalidlyFreeVarsHandled, varEIdsDeliberatelyRemoved, insertedVarEIdToBindingPId, programWithUniqueNames) {
												var _p338 = A3(
													_elm_lang$core$List$foldl,
													F2(
														function (_p340, _p339) {
															var _p341 = _p340;
															var _p350 = _p341._1;
															var _p349 = _p341._2;
															var _p348 = _p341._0;
															var _p342 = _p339;
															var _p347 = _p342._2;
															var _p346 = _p342._0;
															var _p345 = _p342._1;
															var intendedUses = A2(
																_elm_lang$core$List$map,
																function (_p343) {
																	return function (_) {
																		return _.eid;
																	}(
																		function (_) {
																			return _.val;
																		}(_p343));
																},
																A2(_user$project$LangTools$varsWithName, _p350, originalProgramUniqueNames));
															var usesInNewProgram = A2(
																_elm_lang$core$List$map,
																function (_p344) {
																	return function (_) {
																		return _.eid;
																	}(
																		function (_) {
																			return _.val;
																		}(_p344));
																},
																A2(_user$project$LangTools$identifierUsesAfterDefiningPat, _p350, _p346));
															var identifiersInNewPat = A2(
																_elm_lang$core$Maybe$withDefault,
																{ctor: '[]'},
																A2(_elm_lang$core$Maybe$map, _user$project$LangTools$identifiersListInPat, _p345));
															if (A2(_elm_lang$core$List$member, _p350, identifiersInNewPat) && A2(_elm_lang$core$List$member, _p349, identifiersInNewPat)) {
																return {
																	ctor: '_Tuple3',
																	_0: _p346,
																	_1: _p345,
																	_2: A2(
																		_elm_lang$core$Basics_ops['++'],
																		_p347,
																		{
																			ctor: '::',
																			_0: {ctor: '_Tuple3', _0: _p348, _1: _p349, _2: _p350},
																			_1: {ctor: '[]'}
																		})
																};
															} else {
																if (!A2(_user$project$Utils$equalAsSets, intendedUses, usesInNewProgram)) {
																	return {
																		ctor: '_Tuple3',
																		_0: A3(_user$project$LangTools$renameIdentifier, _p350, _p349, _p346),
																		_1: A2(
																			_elm_lang$core$Maybe$map,
																			A2(_user$project$LangTools$renameIdentifierInPat, _p350, _p349),
																			_p345),
																		_2: _p347
																	};
																} else {
																	var usesIfRenamed = function () {
																		var identScopeAreas = A2(_user$project$LangTools$findScopeAreasByIdent, _p350, _p346);
																		return A2(
																			_elm_lang$core$List$concatMap,
																			_user$project$LangTools$identifierUsageEIds(_p349),
																			A2(
																				_elm_lang$core$List$map,
																				A2(_user$project$LangTools$renameIdentifier, _p350, _p349),
																				identScopeAreas));
																	}();
																	return A2(_user$project$Utils$equalAsSets, intendedUses, usesIfRenamed) ? {
																		ctor: '_Tuple3',
																		_0: A3(_user$project$LangTools$renameIdentifier, _p350, _p349, _p346),
																		_1: A2(
																			_elm_lang$core$Maybe$map,
																			A2(_user$project$LangTools$renameIdentifierInPat, _p350, _p349),
																			_p345),
																		_2: _p347
																	} : {
																		ctor: '_Tuple3',
																		_0: _p346,
																		_1: _p345,
																		_2: A2(
																			_elm_lang$core$Basics_ops['++'],
																			_p347,
																			{
																				ctor: '::',
																				_0: {ctor: '_Tuple3', _0: _p348, _1: _p349, _2: _p350},
																				_1: {ctor: '[]'}
																			})
																	};
																}
															}
														}),
													{
														ctor: '_Tuple3',
														_0: programWithUniqueNames,
														_1: maybeNewPatUniqueNames,
														_2: {ctor: '[]'}
													},
													uniqueNameToOldNameDescribedPrioritized);
												var newProgramPartiallyOriginalNames = _p338._0;
												var renamingsPreserved = _p338._2;
												return _user$project$CodeMotion$makeResult(baseDescription)(uniqueNameToOldName)(renamingsPreserved)(movedUniqueIdents)(identsInvalidlyFreeRewritten)(identsWithInvalidlyFreeVarsHandled)(
													A2(_elm_lang$core$Basics_ops['++'], varEIdsPreviouslyDeliberatelyRemoved, varEIdsDeliberatelyRemoved))(insertedVarEIdToBindingPId)(originalProgramUniqueNames)(newProgramPartiallyOriginalNames);
											});
										var _p351 = A2(
											_elm_lang$core$List$partition,
											function (_p352) {
												var _p353 = _p352;
												return A2(_elm_lang$core$Set$member, _p353._0, namesUniqueTouched);
											},
											_elm_lang$core$Dict$toList(uniqueNameToOldName));
										var uniqueNameToOldNameTouched = _p351._0;
										var uniqueNameToOldNameUntouched = _p351._1;
										var uniqueNameToOldNameTouchedDescribed = A2(
											_elm_lang$core$List$map,
											function (_p354) {
												var _p355 = _p354;
												return {ctor: '_Tuple3', _0: _p337._0, _1: _p355._0, _2: _p355._1};
											},
											uniqueNameToOldNameTouched);
										var uniqueNameToOldNameUntouchedDescribed = A2(
											_elm_lang$core$List$map,
											function (_p356) {
												var _p357 = _p356;
												return {ctor: '_Tuple3', _0: _p337._1, _1: _p357._0, _2: _p357._1};
											},
											uniqueNameToOldNameUntouched);
										var twiddledResults = function () {
											if (tryTwiddling) {
												var _p358 = _user$project$CodeMotion$maybeSatisfyUniqueNamesDependenciesByTwiddlingArithmetic(newProgramUniqueNames);
												if (_p358.ctor === 'Nothing') {
													return {ctor: '[]'};
												} else {
													var _p365 = _p358._0._0;
													var _p364 = _p358._0._2;
													var _p363 = _p358._0._1;
													var oldVarEIds = A2(
														_elm_lang$core$List$map,
														function (_p359) {
															return function (_) {
																return _.eid;
															}(
																function (_) {
																	return _.val;
																}(_p359));
														},
														_user$project$LangTools$allVars(newProgramUniqueNames));
													var newVarEIds = A2(
														_elm_lang$core$List$map,
														function (_p360) {
															return function (_) {
																return _.eid;
															}(
																function (_) {
																	return _.val;
																}(_p360));
														},
														_user$project$LangTools$allVars(_p365));
													var varEIdsDeliberatelyRemoved = A2(_user$project$Utils$listDiff, oldVarEIds, newVarEIds);
													var newInsertedVarEIdToBindingPId = function () {
														var insertedVarEIds = _elm_lang$core$Set$fromList(
															A2(_user$project$Utils$listDiff, newVarEIds, oldVarEIds));
														return A2(
															_elm_lang$core$Dict$union,
															insertedVarEIdToBindingPId,
															A2(
																_elm_lang$core$Dict$filter,
																F2(
																	function (eid, _p361) {
																		return A2(_elm_lang$core$Set$member, eid, insertedVarEIds);
																	}),
																_user$project$LangTools$allVarEIdsToBindingPIdBasedOnUniqueName(_p365)));
													}();
													var _p362 = _user$project$CodeMotion$liftDependenciesBasedOnUniqueNames(_p365);
													var newProgramTwiddledArithmeticToSwapDependenciesAndLifted = _p362._0;
													var liftedUniqueIdents = _p362._1;
													return {
														ctor: '::',
														_0: A7(
															resultForOriginalNamesPriority,
															A2(_elm_lang$core$Basics_ops['++'], uniqueNameToOldNameUntouchedDescribed, uniqueNameToOldNameTouchedDescribed),
															liftedUniqueIdents,
															_p363,
															_p364,
															varEIdsDeliberatelyRemoved,
															newInsertedVarEIdToBindingPId,
															newProgramTwiddledArithmeticToSwapDependenciesAndLifted),
														_1: {
															ctor: '::',
															_0: A7(
																resultForOriginalNamesPriority,
																A2(_elm_lang$core$Basics_ops['++'], uniqueNameToOldNameTouchedDescribed, uniqueNameToOldNameUntouchedDescribed),
																liftedUniqueIdents,
																_p363,
																_p364,
																varEIdsDeliberatelyRemoved,
																newInsertedVarEIdToBindingPId,
																newProgramTwiddledArithmeticToSwapDependenciesAndLifted),
															_1: {ctor: '[]'}
														}
													};
												}
											} else {
												return {ctor: '[]'};
											}
										}();
										var _p366 = _user$project$CodeMotion$liftDependenciesBasedOnUniqueNames(newProgramUniqueNames);
										var newProgramUniqueNamesDependenciesLifted = _p366._0;
										var liftedUniqueIdents = _p366._1;
										return A2(
											_elm_lang$core$Basics_ops['++'],
											{
												ctor: '::',
												_0: A7(
													resultForOriginalNamesPriority,
													A2(_elm_lang$core$Basics_ops['++'], uniqueNameToOldNameUntouchedDescribed, uniqueNameToOldNameTouchedDescribed),
													liftedUniqueIdents,
													{ctor: '[]'},
													{ctor: '[]'},
													{ctor: '[]'},
													insertedVarEIdToBindingPId,
													newProgramUniqueNamesDependenciesLifted),
												_1: {
													ctor: '::',
													_0: A7(
														resultForOriginalNamesPriority,
														A2(_elm_lang$core$Basics_ops['++'], uniqueNameToOldNameTouchedDescribed, uniqueNameToOldNameUntouchedDescribed),
														liftedUniqueIdents,
														{ctor: '[]'},
														{ctor: '[]'},
														{ctor: '[]'},
														insertedVarEIdToBindingPId,
														newProgramUniqueNamesDependenciesLifted),
													_1: {ctor: '[]'}
												}
											},
											twiddledResults);
									};
								};
							};
						};
					};
				};
			};
		};
	};
};
var _user$project$CodeMotion$tryResolvingProblemsAfterTransform = F9(
	function (baseDescription, uniqueNameToOldName, maybeNewScopeEId, _p367, namesUniqueTouched, varEIdsPreviouslyDeliberatelyRemoved, insertedVarEIdToBindingPId, originalProgramUniqueNames, newProgramUniqueNames) {
		var _p368 = _p367;
		return _user$project$CodeMotion$tryResolvingProblemsAfterTransform_(baseDescription)(uniqueNameToOldName)(maybeNewScopeEId)(
			{ctor: '_Tuple2', _0: _p368._0, _1: _p368._1})(namesUniqueTouched)(varEIdsPreviouslyDeliberatelyRemoved)(insertedVarEIdToBindingPId)(originalProgramUniqueNames)(newProgramUniqueNames)(true);
	});
var _user$project$CodeMotion$programOriginalNamesAndMaybeRenamedLiftedTwiddledResults = F9(
	function (baseDescription, uniqueNameToOldName, maybeNewScopeEId, _p369, namesUniqueTouched, varEIdsPreviouslyDeliberatelyRemoved, insertedVarEIdToBindingPId, originalProgramUniqueNames, newProgramUniqueNames) {
		var _p370 = _p369;
		var newProgramOriginalNamesResult = function () {
			var newProgramOriginalNames = A2(_user$project$LangTools$renameIdentifiers, uniqueNameToOldName, newProgramUniqueNames);
			return {
				ctor: '::',
				_0: _user$project$CodeMotion$makeResult(baseDescription)(uniqueNameToOldName)(
					{ctor: '[]'})(
					{ctor: '[]'})(
					{ctor: '[]'})(
					{ctor: '[]'})(varEIdsPreviouslyDeliberatelyRemoved)(insertedVarEIdToBindingPId)(originalProgramUniqueNames)(newProgramOriginalNames),
				_1: {ctor: '[]'}
			};
		}();
		var newProgramMaybeRenamedLiftedTwiddledResults = _user$project$InterfaceModel$isResultSafe(
			A2(_user$project$Utils$head, 'CodeMotion.programOriginalNamesAndMaybeRenamedLiftedTwiddledResults', newProgramOriginalNamesResult)) ? {ctor: '[]'} : A9(
			_user$project$CodeMotion$tryResolvingProblemsAfterTransform,
			baseDescription,
			uniqueNameToOldName,
			maybeNewScopeEId,
			{ctor: '_Tuple2', _0: _p370._0, _1: _p370._1},
			namesUniqueTouched,
			varEIdsPreviouslyDeliberatelyRemoved,
			insertedVarEIdToBindingPId,
			originalProgramUniqueNames,
			newProgramUniqueNames);
		var originalProgram = A2(_user$project$LangTools$renameIdentifiers, uniqueNameToOldName, originalProgramUniqueNames);
		return A2(
			_user$project$CodeMotion$removeNoopResults,
			originalProgram,
			A2(
				_user$project$Utils$dedupBy,
				function (_p371) {
					var _p372 = _p371;
					return A3(_user$project$LangUnparser$unparseWithUniformWhitespace, false, false, _p372._0.exp);
				},
				A2(_elm_lang$core$Basics_ops['++'], newProgramOriginalNamesResult, newProgramMaybeRenamedLiftedTwiddledResults)));
	});
var _user$project$CodeMotion$moveEquationsBeforeEId = F3(
	function (letEIds, targetEId, originalProgram) {
		var letEIdsSorted = A2(
			_elm_lang$core$List$sortBy,
			_user$project$LangTools$locationInProgram(originalProgram),
			letEIds);
		var maxId = _user$project$FastParser$maxId(originalProgram);
		var letEIdToReinsertedLetEId = _elm_lang$core$Dict$fromList(
			A2(
				_user$project$Utils$mapi1,
				function (_p373) {
					var _p374 = _p373;
					return {ctor: '_Tuple2', _0: _p374._1, _1: maxId + _p374._0};
				},
				letEIds));
		var _p375 = _user$project$LangTools$assignUniqueNames(originalProgram);
		var originalProgramUniqueNames = _p375._0;
		var uniqueNameToOldName = _p375._1;
		var programWithDuplicatedLets = A3(
			_elm_lang$core$List$foldl,
			F2(
				function (letEIdToDup, program) {
					var letExp = A2(_user$project$LangTools$justFindExpByEId, originalProgramUniqueNames, letEIdToDup);
					return A3(
						_user$project$Lang$mapExpNode,
						targetEId,
						function (expToWrap) {
							var insertedLetEId = A3(_user$project$Utils$justGet_, 'moveEquationsBeforeEId', letEIdToDup, letEIdToReinsertedLetEId);
							var _p376 = _user$project$LangTools$expToLetParts(letExp);
							var ws1 = _p376._0;
							var isRec = _p376._2;
							var pat = _p376._3;
							var boundExp = _p376._4;
							var letOrDef = A2(_user$project$LangTools$isTopLevelEId, targetEId, program) ? _user$project$Lang$Def : _user$project$Lang$Let;
							var newLetIndentation = function () {
								var _p377 = A2(_user$project$Lang$parentByEId, program, targetEId);
								if ((_p377.ctor === 'Just') && (_p377._0.ctor === 'Just')) {
									var _p379 = _p377._0._0;
									return _elm_lang$core$Native_Utils.eq(
										A2(
											_elm_lang$core$Maybe$map,
											function (_p378) {
												return function (_) {
													return _.eid;
												}(
													function (_) {
														return _.val;
													}(_p378));
											},
											_user$project$LangTools$expToMaybeLetBody(_p379)),
										_elm_lang$core$Maybe$Just(targetEId)) ? A2(_user$project$Lang$indentationAt, _p379.val.eid, program) : A2(_user$project$Lang$indentationAt, targetEId, program);
								} else {
									return A2(_user$project$Lang$indentationAt, targetEId, program);
								}
							}();
							return A2(
								_user$project$Lang$replaceIndentation,
								newLetIndentation,
								_user$project$Lang$ensureWhitespaceNewlineExp(
									A2(
										_user$project$Lang$withDummyExpInfoEId,
										insertedLetEId,
										A7(
											_user$project$Lang$ELet,
											ws1,
											letOrDef,
											isRec,
											pat,
											boundExp,
											A3(
												_user$project$Lang$ensureWhitespaceSmartExp,
												1,
												A2(
													_elm_lang$core$Basics_ops['++'],
													_user$project$Lang$indentationOf(letExp),
													_user$project$Lang$isLet(expToWrap) ? '' : '  '),
												expToWrap),
											_user$project$Lang$space0))));
						},
						program);
				}),
			originalProgramUniqueNames,
			letEIdsSorted);
		var programWithDuplicatedLetsRemoved = A2(
			_user$project$Lang$mapExp,
			function (exp) {
				return A2(_elm_lang$core$List$member, exp.val.eid, letEIds) ? A2(
					_user$project$Lang$copyPrecedingWhitespace,
					exp,
					_user$project$LangTools$expToLetBody(exp)) : exp;
			},
			programWithDuplicatedLets);
		var programWithNewLetsOriginalEIds = function () {
			var reinsertedLetEIdToOldLetEId = _user$project$Utils$flipDict(letEIdToReinsertedLetEId);
			return A2(
				_user$project$Lang$mapExp,
				function (exp) {
					var _p380 = A2(_elm_lang$core$Dict$get, exp.val.eid, reinsertedLetEIdToOldLetEId);
					if (_p380.ctor === 'Just') {
						return A2(_user$project$Lang$setEId, _p380._0, exp);
					} else {
						return exp;
					}
				},
				programWithDuplicatedLetsRemoved);
		}();
		var _p381 = _elm_lang$core$List$unzip(
			A2(
				_elm_lang$core$List$map,
				function (_p382) {
					return _user$project$LangTools$expToLetPatAndBoundExp(
						A2(_user$project$LangTools$justFindExpByEId, originalProgramUniqueNames, _p382));
				},
				letEIdsSorted));
		var movedPats = _p381._0;
		var movedBoundExps = _p381._1;
		var namesUniqueExplicitlyMoved = _user$project$Utils$unionAll(
			A2(
				_elm_lang$core$Basics_ops['++'],
				{
					ctor: '::',
					_0: _user$project$LangTools$identifiersSetInPats(movedPats),
					_1: {ctor: '[]'}
				},
				A2(_elm_lang$core$List$map, _user$project$LangTools$freeIdentifiers, movedBoundExps)));
		var movedThingsStr = _user$project$Utils$toSentence(
			A2(
				_elm_lang$core$List$map,
				function (_p383) {
					return _user$project$Utils$squish(
						_user$project$LangUnparser$unparsePat(
							A2(_user$project$LangTools$renameIdentifiersInPat, uniqueNameToOldName, _p383)));
				},
				movedPats));
		return A9(
			_user$project$CodeMotion$programOriginalNamesAndMaybeRenamedLiftedTwiddledResults,
			A2(_elm_lang$core$Basics_ops['++'], 'Move ', movedThingsStr),
			uniqueNameToOldName,
			_elm_lang$core$Maybe$Nothing,
			{ctor: '_Tuple2', _0: 'moved', _1: 'unmoved'},
			namesUniqueExplicitlyMoved,
			{ctor: '[]'},
			_elm_lang$core$Dict$empty,
			originalProgramUniqueNames,
			programWithNewLetsOriginalEIds);
	});
var _user$project$CodeMotion$makeEqualTransformation_ = F4(
	function (originalProgram, eids, newBindingLocationEId, makeNewLet) {
		var firstEId = A2(_user$project$Utils$head, 'CodeMotion.makeEqualTransform expected some eids, got []', eids);
		var potentialNames = function () {
			var namesToAvoid = A2(
				_user$project$LangTools$visibleIdentifiersAtEIds,
				originalProgram,
				_elm_lang$core$Set$fromList(
					{ctor: '::', _0: newBindingLocationEId, _1: eids}));
			var names = _user$project$Utils$dedupByEquality(
				A2(
					_elm_lang$core$List$map,
					_user$project$LangTools$expNameForEId(originalProgram),
					eids));
			var joinedName = A2(_elm_lang$core$String$join, '_', names);
			var commonName = A3(_user$project$LangTools$commonNameForEIdsWithDefault, joinedName, originalProgram, eids);
			return A2(
				_elm_lang$core$List$sortBy,
				function (s) {
					return {
						ctor: '_Tuple2',
						_0: _elm_lang$core$String$length(s),
						_1: s
					};
				},
				_user$project$Utils$dedupByEquality(
					A2(
						_elm_lang$core$List$map,
						function (name) {
							return A3(_user$project$LangTools$nonCollidingName, name, 1, namesToAvoid);
						},
						{
							ctor: '::',
							_0: commonName,
							_1: {ctor: '::', _0: joinedName, _1: names}
						})));
		}();
		var _p384 = _user$project$LangTools$assignUniqueNames(originalProgram);
		var originalProgramUniqueNames = _p384._0;
		var uniqueNameToOldName = _p384._1;
		var maxId = _user$project$FastParser$maxId(originalProgram);
		var _p385 = {ctor: '_Tuple4', _0: maxId + 1, _1: maxId + 2, _2: maxId + 3, _3: maxId + 4};
		var insertedLetEId = _p385._0;
		var insertedVarsEId = _p385._1;
		var newBindingPId = _p385._2;
		var dummyBoundExpEId = _p385._3;
		var varTempName = '* New Variable *';
		var newBoundExp = A2(_user$project$LangTools$justFindExpByEId, originalProgramUniqueNames, firstEId);
		var _p386 = A5(
			makeNewLet,
			insertedLetEId,
			A2(
				_user$project$Lang$setPId,
				newBindingPId,
				_user$project$Lang$pVar(varTempName)),
			A2(_user$project$Lang$setEId, dummyBoundExpEId, newBoundExp),
			A2(_user$project$LangTools$justFindExpByEId, originalProgramUniqueNames, newBindingLocationEId),
			originalProgramUniqueNames);
		var newLet = _p386._0;
		var maybeNewScopeEId = _p386._1;
		var newProgramUniqueNames = function () {
			var expSubst = _elm_lang$core$Dict$fromList(
				A2(
					_elm_lang$core$List$map,
					function (eid) {
						return {
							ctor: '_Tuple2',
							_0: eid,
							_1: A2(
								_user$project$Lang$setEId,
								insertedVarsEId,
								_user$project$Lang$eVar(varTempName))
						};
					},
					eids));
			return A3(
				_user$project$Lang$mapExpNode,
				dummyBoundExpEId,
				_user$project$Lang$setEId(newBoundExp.val.eid),
				A2(
					_user$project$Lang$replaceExpNodesPreservingPrecedingWhitespace,
					expSubst,
					A3(_user$project$Lang$replaceExpNode, newBindingLocationEId, newLet, originalProgramUniqueNames)));
		}();
		var varEIdsPreviouslyDeliberatelyRemoved = A2(
			_elm_lang$core$List$map,
			function (_p387) {
				return function (_) {
					return _.eid;
				}(
					function (_) {
						return _.val;
					}(_p387));
			},
			A2(
				_elm_lang$core$List$concatMap,
				function (eid) {
					return _user$project$LangTools$allVars(
						A2(_user$project$LangTools$justFindExpByEId, originalProgramUniqueNames, eid));
				},
				A2(_elm_lang$core$List$drop, 1, eids)));
		var namesUniqueTouched = A2(
			_elm_lang$core$Set$insert,
			varTempName,
			_user$project$LangTools$identifiersSet(newBoundExp));
		return A2(
			_elm_lang$core$List$concatMap,
			function (varName) {
				return A9(
					_user$project$CodeMotion$programOriginalNamesAndMaybeRenamedLiftedTwiddledResults,
					A2(_elm_lang$core$Basics_ops['++'], 'New variable: ', varName),
					A3(_elm_lang$core$Dict$insert, varTempName, varName, uniqueNameToOldName),
					maybeNewScopeEId,
					{ctor: '_Tuple2', _0: 'touched', _1: 'untouched'},
					namesUniqueTouched,
					varEIdsPreviouslyDeliberatelyRemoved,
					A2(
						_elm_lang$core$Dict$singleton,
						insertedVarsEId,
						_elm_lang$core$Maybe$Just(newBindingPId)),
					originalProgramUniqueNames,
					newProgramUniqueNames);
			},
			potentialNames);
	});
var _user$project$CodeMotion$makeEqualTransformation = F3(
	function (originalProgram, eids, maybeTargetPosition) {
		var insertNewLet = F5(
			function (insertedLetEId, pat, boundExp, expToWrap, program) {
				return {
					ctor: '_Tuple2',
					_0: A5(_user$project$LangTools$newLetFancyWhitespace, insertedLetEId, pat, boundExp, expToWrap, program),
					_1: _elm_lang$core$Maybe$Just(insertedLetEId)
				};
			});
		var addToExistingLet = F6(
			function (targetPath, _p389, pat, boundExp, letExpToInsertInto, _p388) {
				return {
					ctor: '_Tuple2',
					_0: A3(
						_user$project$CodeMotion$insertPat_,
						{ctor: '_Tuple2', _0: pat, _1: boundExp},
						targetPath,
						letExpToInsertInto),
					_1: _elm_lang$core$Maybe$Nothing
				};
			});
		var _p390 = maybeTargetPosition;
		if (_p390.ctor === 'Nothing') {
			return _elm_lang$core$Maybe$Just(
				function (_p391) {
					var _p392 = _p391;
					var expToWrap = A2(
						_user$project$LangTools$deepestCommonAncestorWithNewline,
						originalProgram,
						function (e) {
							return A2(_elm_lang$core$List$member, e.val.eid, eids);
						});
					return A4(_user$project$CodeMotion$makeEqualTransformation_, originalProgram, eids, expToWrap.val.eid, insertNewLet);
				});
		} else {
			if (_p390._0.ctor === 'ExpTargetPosition') {
				if (_p390._0._0._0.ctor === 'After') {
					return _elm_lang$core$Maybe$Nothing;
				} else {
					return _elm_lang$core$Maybe$Just(
						function (_p393) {
							var _p394 = _p393;
							return A4(_user$project$CodeMotion$makeEqualTransformation_, originalProgram, eids, _p390._0._0._1, insertNewLet);
						});
				}
			} else {
				var _p395 = _user$project$Lang$patTargetPositionToTargetPathedPatId(_p390._0._0);
				if (((_p395.ctor === '_Tuple2') && (_p395._0.ctor === '_Tuple2')) && (_p395._0._1 === 1)) {
					var _p399 = _p395._0._0;
					var _p396 = A2(_user$project$Lang$findExpByEId, originalProgram, _p399);
					if (_p396.ctor === 'Just') {
						return _user$project$Lang$isLet(_p396._0) ? _elm_lang$core$Maybe$Just(
							function (_p397) {
								var _p398 = _p397;
								return A4(
									_user$project$CodeMotion$makeEqualTransformation_,
									originalProgram,
									eids,
									_p399,
									addToExistingLet(_p395._1));
							}) : _elm_lang$core$Maybe$Nothing;
					} else {
						return _elm_lang$core$Maybe$Nothing;
					}
				} else {
					return _elm_lang$core$Maybe$Nothing;
				}
			}
		}
	});
var _user$project$CodeMotion$copyExpressionTransformation = F2(
	function (originalProgram, eids) {
		var exps = A2(
			_elm_lang$core$List$map,
			_user$project$LangTools$justFindExpByEId(originalProgram),
			eids);
		var uniqueExps = A2(
			_user$project$Utils$dedupBy,
			A2(_user$project$LangUnparser$unparseWithUniformWhitespace, true, true),
			exps);
		return (_elm_lang$core$Native_Utils.cmp(
			_elm_lang$core$List$length(uniqueExps),
			2) < 0) ? _elm_lang$core$Maybe$Nothing : _elm_lang$core$Maybe$Just(
			function (_p400) {
				var _p401 = _p400;
				var _p402 = _user$project$LangTools$assignUniqueNames(originalProgram);
				var originalProgramUniqueNames = _p402._0;
				var uniqueNameToOldName = _p402._1;
				return A2(
					_elm_lang$core$List$concatMap,
					function (eidToCopy) {
						var expToCopy = A2(_user$project$LangTools$justFindExpByEId, originalProgramUniqueNames, eidToCopy);
						var expToCopyOriginalNames = A2(_user$project$LangTools$justFindExpByEId, originalProgram, eidToCopy);
						var eidsToChange = A2(
							_elm_lang$core$List$filter,
							F2(
								function (x, y) {
									return !_elm_lang$core$Native_Utils.eq(x, y);
								})(eidToCopy),
							eids);
						var newProgramUniqueNames = A3(
							_elm_lang$core$List$foldl,
							function (eid) {
								return A2(_user$project$Lang$replaceExpNodePreservingPrecedingWhitespace, eid, expToCopy);
							},
							originalProgramUniqueNames,
							eidsToChange);
						var namesUniqueTouched = _user$project$LangTools$identifiersSet(expToCopy);
						var varEIdsPreviouslyDeliberatelyRemoved = A2(
							_elm_lang$core$List$map,
							function (_p403) {
								return function (_) {
									return _.eid;
								}(
									function (_) {
										return _.val;
									}(_p403));
							},
							A2(
								_elm_lang$core$List$concatMap,
								function (_p404) {
									return _user$project$LangTools$allVars(
										A2(_user$project$LangTools$justFindExpByEId, originalProgramUniqueNames, _p404));
								},
								eidsToChange));
						return A9(
							_user$project$CodeMotion$programOriginalNamesAndMaybeRenamedLiftedTwiddledResults,
							A2(
								_elm_lang$core$Basics_ops['++'],
								'Copy expression: ',
								_user$project$Utils$squish(
									_user$project$LangUnparser$unparse(expToCopyOriginalNames))),
							uniqueNameToOldName,
							_elm_lang$core$Maybe$Nothing,
							{ctor: '_Tuple2', _0: 'copied', _1: 'untouched'},
							namesUniqueTouched,
							varEIdsPreviouslyDeliberatelyRemoved,
							_elm_lang$core$Dict$empty,
							originalProgramUniqueNames,
							newProgramUniqueNames);
					},
					A2(
						_elm_lang$core$List$map,
						function (_p405) {
							return function (_) {
								return _.eid;
							}(
								function (_) {
									return _.val;
								}(_p405));
						},
						uniqueExps));
			});
	});
var _user$project$CodeMotion$swapExpressionsTransformation = F3(
	function (originalProgram, eid1, eid2) {
		var exp1 = A2(_user$project$LangTools$justFindExpByEId, originalProgram, eid1);
		var exp2 = A2(_user$project$LangTools$justFindExpByEId, originalProgram, eid2);
		return _elm_lang$core$Native_Utils.eq(
			A3(_user$project$LangUnparser$unparseWithUniformWhitespace, true, true, exp1),
			A3(_user$project$LangUnparser$unparseWithUniformWhitespace, true, true, exp2)) ? _elm_lang$core$Maybe$Nothing : ((A2(
			_elm_lang$core$List$member,
			exp1,
			_user$project$Lang$flattenExpTree(exp2)) || A2(
			_elm_lang$core$List$member,
			exp2,
			_user$project$Lang$flattenExpTree(exp1))) ? _elm_lang$core$Maybe$Nothing : _elm_lang$core$Maybe$Just(
			function (_p406) {
				var _p407 = _p406;
				var _p408 = _user$project$LangTools$assignUniqueNames(originalProgram);
				var originalProgramUniqueNames = _p408._0;
				var uniqueNameToOldName = _p408._1;
				var tempEId = _user$project$FastParser$maxId(originalProgramUniqueNames) + 1;
				var exp1UniqueNames = A2(_user$project$LangTools$justFindExpByEId, originalProgramUniqueNames, eid1);
				var exp2UniqueNames = A2(_user$project$LangTools$justFindExpByEId, originalProgramUniqueNames, eid2);
				var newProgramUniqueNames = A3(
					_user$project$Lang$replaceExpNodePreservingPrecedingWhitespace,
					tempEId,
					exp2UniqueNames,
					A3(
						_user$project$Lang$replaceExpNodePreservingPrecedingWhitespace,
						eid2,
						exp1UniqueNames,
						A3(
							_user$project$Lang$replaceExpNodePreservingPrecedingWhitespace,
							eid1,
							A2(_user$project$Lang$setEId, tempEId, exp1UniqueNames),
							originalProgramUniqueNames)));
				var namesUniqueTouched = A2(
					_elm_lang$core$Set$union,
					_user$project$LangTools$identifiersSet(exp1UniqueNames),
					_user$project$LangTools$identifiersSet(exp2UniqueNames));
				return A9(
					_user$project$CodeMotion$programOriginalNamesAndMaybeRenamedLiftedTwiddledResults,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'Swap ',
						A2(
							_elm_lang$core$Basics_ops['++'],
							_user$project$Utils$squish(
								_user$project$LangUnparser$unparse(exp1)),
							A2(
								_elm_lang$core$Basics_ops['++'],
								' and ',
								_user$project$Utils$squish(
									_user$project$LangUnparser$unparse(exp2))))),
					uniqueNameToOldName,
					_elm_lang$core$Maybe$Nothing,
					{ctor: '_Tuple2', _0: 'swapped', _1: 'untouched'},
					namesUniqueTouched,
					{ctor: '[]'},
					_elm_lang$core$Dict$empty,
					originalProgramUniqueNames,
					newProgramUniqueNames);
			}));
	});
var _user$project$CodeMotion$swapDefinitionsTransformation = F3(
	function (originalProgram, pid1, pid2) {
		var _p409 = {
			ctor: '_Tuple2',
			_0: A2(_user$project$LangTools$findPatAndBoundExpByPId, pid1, originalProgram),
			_1: A2(_user$project$LangTools$findPatAndBoundExpByPId, pid2, originalProgram)
		};
		if (((((_p409.ctor === '_Tuple2') && (_p409._0.ctor === 'Just')) && (_p409._0._0.ctor === '_Tuple2')) && (_p409._1.ctor === 'Just')) && (_p409._1._0.ctor === '_Tuple2')) {
			var _p419 = _p409._1._0._0;
			var _p418 = _p409._0._0._0;
			var _p417 = _p409._1._0._1;
			var _p416 = _p409._0._0._1;
			return (_elm_lang$core$Native_Utils.eq(
				A2(_user$project$LangUnparser$unparsePatWithUniformWhitespace, true, _p418),
				A2(_user$project$LangUnparser$unparsePatWithUniformWhitespace, true, _p419)) && _elm_lang$core$Native_Utils.eq(
				A3(_user$project$LangUnparser$unparseWithUniformWhitespace, true, true, _p416),
				A3(_user$project$LangUnparser$unparseWithUniformWhitespace, true, true, _p417))) ? _elm_lang$core$Maybe$Nothing : ((A2(
				_elm_lang$core$List$member,
				_p416,
				_user$project$Lang$flattenExpTree(_p417)) || A2(
				_elm_lang$core$List$member,
				_p417,
				_user$project$Lang$flattenExpTree(_p416))) ? _elm_lang$core$Maybe$Nothing : _elm_lang$core$Maybe$Just(
				function (_p410) {
					var _p411 = _p410;
					var _p412 = _user$project$LangTools$assignUniqueNames(originalProgram);
					var originalProgramUniqueNames = _p412._0;
					var uniqueNameToOldName = _p412._1;
					var maxId = _user$project$FastParser$maxId(originalProgramUniqueNames);
					var _p413 = {ctor: '_Tuple2', _0: maxId + 1, _1: maxId + 2};
					var tempPId = _p413._0;
					var tempEId = _p413._1;
					var _p414 = A2(
						_user$project$Utils$fromJust_,
						'CodeMotion.swapDefinitionsTransformation',
						A2(_user$project$LangTools$findPatAndBoundExpByPId, pid1, originalProgramUniqueNames));
					var pat1UniqueNames = _p414._0;
					var boundExp1UniqueNames = _p414._1;
					var _p415 = A2(
						_user$project$Utils$fromJust_,
						'CodeMotion.swapDefinitionsTransformation',
						A2(_user$project$LangTools$findPatAndBoundExpByPId, pid2, originalProgramUniqueNames));
					var pat2UniqueNames = _p415._0;
					var boundExp2UniqueNames = _p415._1;
					var newProgramUniqueNames = A3(
						_user$project$Lang$replacePatNodePreservingPrecedingWhitespace,
						tempPId,
						pat2UniqueNames,
						A3(
							_user$project$Lang$replacePatNodePreservingPrecedingWhitespace,
							pat2UniqueNames.val.pid,
							pat1UniqueNames,
							A3(
								_user$project$Lang$replacePatNodePreservingPrecedingWhitespace,
								pat1UniqueNames.val.pid,
								A2(_user$project$Lang$setPId, tempPId, pat1UniqueNames),
								A3(
									_user$project$Lang$replaceExpNodePreservingPrecedingWhitespace,
									tempEId,
									boundExp2UniqueNames,
									A3(
										_user$project$Lang$replaceExpNodePreservingPrecedingWhitespace,
										boundExp2UniqueNames.val.eid,
										boundExp1UniqueNames,
										A3(
											_user$project$Lang$replaceExpNodePreservingPrecedingWhitespace,
											boundExp1UniqueNames.val.eid,
											A2(_user$project$Lang$setEId, tempEId, boundExp1UniqueNames),
											originalProgramUniqueNames))))));
					var namesUniqueTouched = _user$project$Utils$unionAll(
						{
							ctor: '::',
							_0: _user$project$LangTools$identifiersSetInPat(pat1UniqueNames),
							_1: {
								ctor: '::',
								_0: _user$project$LangTools$identifiersSetInPat(pat2UniqueNames),
								_1: {
									ctor: '::',
									_0: _user$project$LangTools$identifiersSet(boundExp1UniqueNames),
									_1: {
										ctor: '::',
										_0: _user$project$LangTools$identifiersSet(boundExp2UniqueNames),
										_1: {ctor: '[]'}
									}
								}
							}
						});
					return A9(
						_user$project$CodeMotion$programOriginalNamesAndMaybeRenamedLiftedTwiddledResults,
						A2(
							_elm_lang$core$Basics_ops['++'],
							'Swap Definitions ',
							A2(
								_elm_lang$core$Basics_ops['++'],
								_user$project$Utils$squish(
									_user$project$LangUnparser$unparsePat(_p418)),
								A2(
									_elm_lang$core$Basics_ops['++'],
									' and ',
									_user$project$Utils$squish(
										_user$project$LangUnparser$unparsePat(_p419))))),
						uniqueNameToOldName,
						_elm_lang$core$Maybe$Nothing,
						{ctor: '_Tuple2', _0: 'swapped', _1: 'untouched'},
						namesUniqueTouched,
						{ctor: '[]'},
						_elm_lang$core$Dict$empty,
						originalProgramUniqueNames,
						newProgramUniqueNames);
				}));
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$CodeMotion$tryResolvingProblemsAfterTransformNoTwiddling = F9(
	function (baseDescription, uniqueNameToOldName, maybeNewScopeEId, _p420, namesUniqueTouched, varEIdsPreviouslyDeliberatelyRemoved, insertedVarEIdToBindingPId, originalProgramUniqueNames, newProgramUniqueNames) {
		var _p421 = _p420;
		return _user$project$CodeMotion$tryResolvingProblemsAfterTransform_(baseDescription)(uniqueNameToOldName)(maybeNewScopeEId)(
			{ctor: '_Tuple2', _0: _p421._0, _1: _p421._1})(namesUniqueTouched)(varEIdsPreviouslyDeliberatelyRemoved)(insertedVarEIdToBindingPId)(originalProgramUniqueNames)(newProgramUniqueNames)(false);
	});
var _user$project$CodeMotion$abstractPVar = F3(
	function (pathedPatId, perhapsArgEIds, originalProgram) {
		var _p422 = A2(_user$project$CodeMotion$pluck, pathedPatId, originalProgram);
		if (_p422.ctor === 'Nothing') {
			return A2(
				_elm_lang$core$Debug$log,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'abstractPVar Could not find pathedPatternId ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_elm_lang$core$Basics$toString(pathedPatId),
						A2(
							_elm_lang$core$Basics_ops['++'],
							' in program\n',
							_user$project$LangUnparser$unparseWithIds(originalProgram)))),
				{ctor: '[]'});
		} else {
			var _p435 = _p422._0._0._1;
			var _p423 = _p422._0._0._0.val.p__;
			if (_p423.ctor === 'PVar') {
				var _p434 = _p423._1;
				var doAbstract = function (shouldBeParameter) {
					var _p424 = pathedPatId;
					var scopeEId = _p424._0._0;
					var scopeExp = A2(_user$project$LangTools$justFindExpByEId, originalProgram, scopeEId);
					var scopeBody = _user$project$LangTools$expToLetBody(scopeExp);
					var _p425 = A3(_user$project$CodeMotion$abstract, _p435.val.eid, shouldBeParameter, originalProgram);
					var argumentsForCallSite = _p425._0;
					var abstractedFuncExp = _p425._1;
					var abstractedFuncExpNiceWs = A2(
						_user$project$Lang$replaceIndentation,
						A2(
							_elm_lang$core$Basics_ops['++'],
							_user$project$Lang$indentationOf(scopeExp),
							'  '),
						A2(_user$project$Lang$replacePrecedingWhitespace, ' ', abstractedFuncExp));
					var newScopeBody = function () {
						var varToApp = function (varExp) {
							return A2(
								_user$project$Lang$replaceE__PreservingPrecedingWhitespace,
								varExp,
								A4(
									_user$project$Lang$EApp,
									_user$project$Lang$space0,
									_user$project$Lang$eVar0(_p434),
									A3(_user$project$Lang$setExpListWhitespace, ' ', ' ', argumentsForCallSite),
									_user$project$Lang$space0));
						};
						return A2(
							_user$project$LangTools$transformVarsUntilBound,
							A2(_elm_lang$core$Dict$singleton, _p434, varToApp),
							scopeBody);
					}();
					var newProgram = A3(
						_user$project$Lang$replaceExpNode,
						_p435.val.eid,
						abstractedFuncExpNiceWs,
						A3(_user$project$Lang$replaceExpNode, scopeBody.val.eid, newScopeBody, originalProgram));
					return {
						ctor: '_Tuple2',
						_0: newProgram,
						_1: _user$project$LangTools$expToFuncPats(abstractedFuncExpNiceWs)
					};
				};
				var _p426 = perhapsArgEIds;
				if (_p426.ctor === '[]') {
					var abstractedOverAllConstantsResult = function () {
						var _p427 = doAbstract(_user$project$CodeMotion$shouldBeParameterIsConstant);
						var newProgram = _p427._0;
						return A2(
							_user$project$InterfaceModel$synthesisResult,
							A2(
								_elm_lang$core$Basics_ops['++'],
								'Abstract ',
								A2(_elm_lang$core$Basics_ops['++'], _p434, ' over its constants')),
							newProgram);
					}();
					var abstractedOverNamedUnfrozenConstantsResult = function () {
						var _p428 = doAbstract(_user$project$CodeMotion$shouldBeParameterIsNamedUnfrozenConstant);
						var newProgram = _p428._0;
						return A2(
							_user$project$InterfaceModel$synthesisResult,
							A2(
								_elm_lang$core$Basics_ops['++'],
								'Abstract ',
								A2(_elm_lang$core$Basics_ops['++'], _p434, ' over its named constants')),
							newProgram);
					}();
					return {
						ctor: '::',
						_0: abstractedOverAllConstantsResult,
						_1: {
							ctor: '::',
							_0: abstractedOverNamedUnfrozenConstantsResult,
							_1: {ctor: '[]'}
						}
					};
				} else {
					var _p433 = _p426;
					var shouldBeParameter = F2(
						function (e, _p429) {
							return A2(_elm_lang$core$List$member, e.val.eid, _p433);
						});
					var _p430 = doAbstract(shouldBeParameter);
					var newProgram = _p430._0;
					var argPats = _p430._1;
					var isSafe = A2(
						_elm_lang$core$List$all,
						function (_p431) {
							return A2(
								F2(
									function (x, y) {
										return _elm_lang$core$Native_Utils.eq(x, y);
									}),
								_elm_lang$core$Maybe$Just(true),
								A2(
									_elm_lang$core$Maybe$map,
									_user$project$LangTools$isLiteral,
									A2(_user$project$Lang$findExpByEId, originalProgram, _p431)));
						},
						_p433);
					return {
						ctor: '::',
						_0: A2(
							_user$project$InterfaceModel$setResultSafe,
							isSafe,
							A2(
								_user$project$InterfaceModel$synthesisResult,
								A2(
									_elm_lang$core$Basics_ops['++'],
									'Abstract ',
									A2(
										_elm_lang$core$Basics_ops['++'],
										_p434,
										A2(
											_elm_lang$core$Basics_ops['++'],
											' over ',
											_user$project$Utils$toSentence(
												A2(
													_elm_lang$core$List$map,
													function (_p432) {
														return _user$project$Utils$squish(
															_user$project$LangUnparser$unparsePat(_p432));
													},
													argPats))))),
								newProgram)),
						_1: {ctor: '[]'}
					};
				}
			} else {
				return A2(
					_elm_lang$core$Debug$log,
					'Can only abstract a PVar',
					{ctor: '[]'});
			}
		}
	});
var _user$project$CodeMotion$addArgFromPat_ = F4(
	function (postProcessFBody, argSourcePathedPatId, targetPathedPatId, originalProgram) {
		var funcToIsSafePatToInsertArgValExpAndNewFuncBody = F2(
			function (func, fbody) {
				var _p436 = A2(_user$project$CodeMotion$pluck, argSourcePathedPatId, fbody);
				if (_p436.ctor === 'Nothing') {
					var _p437 = A2(
						_elm_lang$core$Debug$log,
						'could not pluck argument source pattern from inside the function',
						{ctor: '_Tuple0'});
					return _elm_lang$core$Maybe$Nothing;
				} else {
					var _p439 = _p436._0._0._0;
					var _p438 = _p436._0._1;
					var varUsagesSame = function () {
						var oldScopeAreas = A2(
							_user$project$LangTools$findScopeAreas,
							_user$project$Lang$pathedPatIdToScopeId(argSourcePathedPatId),
							fbody);
						return A2(
							_elm_lang$core$List$all,
							function (ident) {
								return _elm_lang$core$Native_Utils.eq(
									A2(_user$project$LangTools$identifierUses, ident, _p438),
									A2(
										_elm_lang$core$List$concatMap,
										_user$project$LangTools$identifierUses(ident),
										oldScopeAreas));
							},
							_user$project$LangTools$identifiersListInPat(_p439));
					}();
					return _elm_lang$core$Maybe$Just(
						{
							ctor: '_Tuple4',
							_0: varUsagesSame,
							_1: _p439,
							_2: _p436._0._0._1,
							_3: postProcessFBody(_p438)
						});
				}
			});
		return A3(_user$project$CodeMotion$addArg_, targetPathedPatId, funcToIsSafePatToInsertArgValExpAndNewFuncBody, originalProgram);
	});
var _user$project$CodeMotion$addArgsFromPats = F3(
	function (argSourcePathedPatIds, pathedPatId, originalProgram) {
		var _p440 = A3(
			_elm_lang$core$List$foldr,
			F2(
				function (argSourcePathedPatId, _p441) {
					var _p442 = _p441;
					var _p445 = _p442._1;
					var _p443 = A2(
						_elm_lang$core$Maybe$map,
						A3(_user$project$CodeMotion$addArgFromPat_, _elm_lang$core$Basics$identity, argSourcePathedPatId, pathedPatId),
						_p442._0);
					if ((_p443.ctor === 'Just') && (_p443._0.ctor === '::')) {
						var _p444 = _p443._0._0._0;
						return {
							ctor: '_Tuple3',
							_0: _elm_lang$core$Maybe$Just(_p444.exp),
							_1: {ctor: '::', _0: _p444.description, _1: _p445},
							_2: _p442._2 && _p444.isSafe
						};
					} else {
						return {ctor: '_Tuple3', _0: _elm_lang$core$Maybe$Nothing, _1: _p445, _2: false};
					}
				}),
			{
				ctor: '_Tuple3',
				_0: _elm_lang$core$Maybe$Just(originalProgram),
				_1: {ctor: '[]'},
				_2: true
			},
			A2(
				_elm_lang$core$List$sortBy,
				function (_p446) {
					var _p447 = _p446;
					return A2(_user$project$LangTools$locationInProgram, originalProgram, _p447._0._0);
				},
				argSourcePathedPatIds));
		var maybeNewProgram = _p440._0;
		var resultDescs = _p440._1;
		var isSafe = _p440._2;
		var _p448 = maybeNewProgram;
		if (_p448.ctor === 'Just') {
			var newProgramWithAssignmentsSimplified = A3(
				_user$project$Lang$mapExpNode,
				_user$project$Lang$pathedPatIdToScopeEId(pathedPatId),
				_user$project$LangSimplify$simplifyAssignments,
				_p448._0);
			var caption = A3(
				_user$project$Utils$stringReplace,
				'Argument ',
				'Arguments ',
				_user$project$Utils$mergeStrings(resultDescs));
			return {
				ctor: '::',
				_0: A2(
					_user$project$InterfaceModel$setResultSafe,
					isSafe,
					A2(_user$project$InterfaceModel$synthesisResult, caption, newProgramWithAssignmentsSimplified)),
				_1: {ctor: '[]'}
			};
		} else {
			return {ctor: '[]'};
		}
	});
var _user$project$CodeMotion$addArgFromPat = F3(
	function (argSourcePathedPatId, targetPathedPatId, originalProgram) {
		return A4(_user$project$CodeMotion$addArgFromPat_, _user$project$LangSimplify$simplifyAssignments, argSourcePathedPatId, targetPathedPatId, originalProgram);
	});
var _user$project$CodeMotion$rewriteOffsetTransformation = F3(
	function (m, ppid, nums) {
		var eids = A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$first, nums);
		var isSafe = true;
		if (!isSafe) {
			return _elm_lang$core$Maybe$Nothing;
		} else {
			var _p449 = A2(_user$project$CodeMotion$pluck, ppid, m.inputExp);
			if (_p449.ctor === 'Nothing') {
				return _elm_lang$core$Maybe$Nothing;
			} else {
				var _p450 = {ctor: '_Tuple2', _0: _p449._0._0._0.val.p__, _1: _p449._0._0._1.val.e__};
				if (((_p450.ctor === '_Tuple2') && (_p450._0.ctor === 'PVar')) && (_p450._1.ctor === 'EConst')) {
					var _p455 = _p450._0._1;
					return _elm_lang$core$Maybe$Just(
						function (_p451) {
							var _p452 = _p451;
							var newExp = A3(
								_elm_lang$core$List$foldl,
								function (_p453) {
									var _p454 = _p453;
									var eBasePlusOffset = function () {
										var diff = _p454._1._1 - _p450._1._1;
										return (_elm_lang$core$Native_Utils.cmp(diff, 0) > -1) ? A2(
											_user$project$Lang$ePlus,
											_user$project$Lang$eVar(_p455),
											A2(_user$project$Lang$eConst, diff, _user$project$Lang$dummyLoc)) : A2(
											_user$project$Lang$eMinus,
											_user$project$Lang$eVar(_p455),
											A2(_user$project$Lang$eConst, -1 * diff, _user$project$Lang$dummyLoc));
									}();
									return A2(_user$project$Lang$replaceExpNodePreservingPrecedingWhitespace, _p454._0, eBasePlusOffset);
								},
								m.inputExp,
								nums);
							return _user$project$InterfaceModel$oneSafeResult(newExp);
						});
				} else {
					return _elm_lang$core$Maybe$Nothing;
				}
			}
		}
	});
var _user$project$CodeMotion$pluckAll = F2(
	function (sourcePathedPatIds, program) {
		var sortedSourcePathedPatIds = A2(
			_elm_lang$core$List$sortBy,
			function (_p456) {
				var _p457 = _p456;
				return {
					ctor: '_Tuple3',
					_0: A2(_user$project$LangTools$locationInProgram, program, _p457._0._0),
					_1: _p457._0._1,
					_2: _p457._1
				};
			},
			sourcePathedPatIds);
		var _p458 = A3(
			_elm_lang$core$List$foldr,
			F2(
				function (sourcePathedPatId, _p459) {
					var _p460 = _p459;
					var _p463 = _p460._1;
					var _p462 = _p460._0;
					var _p461 = A2(_user$project$CodeMotion$pluck, sourcePathedPatId, _p463);
					if (_p461.ctor === 'Just') {
						return {
							ctor: '_Tuple2',
							_0: {
								ctor: '::',
								_0: {ctor: '_Tuple2', _0: _p461._0._0._0, _1: _p461._0._0._1},
								_1: _p462
							},
							_1: _p461._0._1
						};
					} else {
						return {ctor: '_Tuple2', _0: _p462, _1: _p463};
					}
				}),
			{
				ctor: '_Tuple2',
				_0: {ctor: '[]'},
				_1: program
			},
			sortedSourcePathedPatIds);
		var pluckedPatAndBoundExps = _p458._0;
		var programWithoutPlucked = _p458._1;
		return {ctor: '_Tuple2', _0: pluckedPatAndBoundExps, _1: programWithoutPlucked};
	});
var _user$project$CodeMotion$moveDefinitions_ = F3(
	function (makeNewProgram, sourcePathedPatIds, program) {
		var _p464 = _user$project$LangTools$assignUniqueNames(program);
		var programUniqueNames = _p464._0;
		var uniqueNameToOldName = _p464._1;
		var _p465 = A2(_user$project$CodeMotion$pluckAll, sourcePathedPatIds, programUniqueNames);
		var pluckedPatAndBoundExps = _p465._0;
		var programWithoutPlucked = _p465._1;
		if (_elm_lang$core$Native_Utils.eq(
			pluckedPatAndBoundExps,
			{ctor: '[]'})) {
			return A2(
				_elm_lang$core$Debug$log,
				'could not pluck anything',
				{ctor: '[]'});
		} else {
			var _p466 = _elm_lang$core$List$unzip(pluckedPatAndBoundExps);
			var pluckedPats = _p466._0;
			var pluckedBoundExps = _p466._1;
			var pluckedPathedPatIdentifiersUnique = _user$project$Utils$unionAll(
				A2(_elm_lang$core$List$map, _user$project$LangTools$identifiersSetInPat, pluckedPats));
			var pluckedBoundExpFreeIdentifiersUnique = _user$project$Utils$unionAll(
				A2(_elm_lang$core$List$map, _user$project$LangTools$freeIdentifiers, pluckedBoundExps));
			var namesUniqueExplicitlyMoved = A2(_elm_lang$core$Set$union, pluckedPathedPatIdentifiersUnique, pluckedBoundExpFreeIdentifiersUnique);
			var _p467 = A2(
				_elm_lang$core$Tuple$mapFirst,
				_user$project$LangSimplify$simplifyAssignments,
				A2(
					makeNewProgram,
					A2(_user$project$Utils$zip, pluckedPats, pluckedBoundExps),
					programWithoutPlucked));
			var newProgramUniqueNames = _p467._0;
			var newScopeEId = _p467._1;
			var movedThingsStr = _user$project$Utils$toSentence(
				A2(
					_elm_lang$core$List$map,
					function (_p468) {
						return _user$project$Utils$squish(
							_user$project$LangUnparser$unparsePat(
								A2(_user$project$LangTools$renameIdentifiersInPat, uniqueNameToOldName, _p468)));
					},
					pluckedPats));
			return A9(
				_user$project$CodeMotion$programOriginalNamesAndMaybeRenamedLiftedTwiddledResults,
				A2(_elm_lang$core$Basics_ops['++'], 'Move ', movedThingsStr),
				uniqueNameToOldName,
				_elm_lang$core$Maybe$Just(newScopeEId),
				{ctor: '_Tuple2', _0: 'moved', _1: 'unmoved'},
				namesUniqueExplicitlyMoved,
				{ctor: '[]'},
				_elm_lang$core$Dict$empty,
				programUniqueNames,
				newProgramUniqueNames);
		}
	});
var _user$project$CodeMotion$moveDefinitionsBeforeEId_ = F3(
	function (sourcePathedPatIds, targetEId, program) {
		var makeNewProgram = F2(
			function (pluckedPatAndBoundExps, programWithoutPluckedUniqueNames) {
				var _p469 = _elm_lang$core$List$unzip(pluckedPatAndBoundExps);
				var pluckedPats = _p469._0;
				var pluckedBoundExps = _p469._1;
				var _p470 = function () {
					var _p471 = {ctor: '_Tuple2', _0: pluckedPats, _1: pluckedBoundExps};
					if (((((_p471.ctor === '_Tuple2') && (_p471._0.ctor === '::')) && (_p471._0._1.ctor === '[]')) && (_p471._1.ctor === '::')) && (_p471._1._1.ctor === '[]')) {
						return {ctor: '_Tuple2', _0: _p471._0._0, _1: _p471._1._0};
					} else {
						return {
							ctor: '_Tuple2',
							_0: _user$project$Lang$withDummyPatInfo(
								A5(
									_user$project$Lang$PList,
									_user$project$Lang$space1,
									A3(_user$project$Lang$setPatListWhitespace, '', ' ', pluckedPats),
									_user$project$Lang$space0,
									_elm_lang$core$Maybe$Nothing,
									_user$project$Lang$space0)),
							_1: _user$project$Lang$withDummyExpInfo(
								A5(
									_user$project$Lang$EList,
									_user$project$Lang$space1,
									A3(_user$project$Lang$setExpListWhitespace, '', ' ', pluckedBoundExps),
									_user$project$Lang$space0,
									_elm_lang$core$Maybe$Nothing,
									_user$project$Lang$space0))
						};
					}
				}();
				var newPatUniqueNames = _p470._0;
				var newBoundExpUniqueNames = _p470._1;
				var insertedLetEId = _user$project$FastParser$maxId(program) + 1;
				var newProgram = A3(
					_user$project$Lang$mapExpNode,
					targetEId,
					function (expToWrap) {
						return A5(_user$project$LangTools$newLetFancyWhitespace, insertedLetEId, newPatUniqueNames, newBoundExpUniqueNames, expToWrap, programWithoutPluckedUniqueNames);
					},
					programWithoutPluckedUniqueNames);
				return {ctor: '_Tuple2', _0: newProgram, _1: insertedLetEId};
			});
		return A3(_user$project$CodeMotion$moveDefinitions_, makeNewProgram, sourcePathedPatIds, program);
	});
var _user$project$CodeMotion$moveDefinitionsBeforeEId = F3(
	function (sourcePathedPatIds, targetEId, program) {
		return A3(_user$project$CodeMotion$moveDefinitionsBeforeEId_, sourcePathedPatIds, targetEId, program);
	});
var _user$project$CodeMotion$makeEIdVisibleToEIds = F3(
	function (originalProgram, mobileEId, viewerEIds) {
		var _p472 = _user$project$LangTools$assignUniqueNames(originalProgram);
		var originalProgramUniqueNames = _p472._0;
		var uniqueNameToOldName = _p472._1;
		var allViewerEIds = A2(_elm_lang$core$Set$insert, mobileEId, viewerEIds);
		var renameIfCollision = F5(
			function (mobileUniqueName, uniqueNameToOldName, viewerEIds, originalProgram, originalProgramUniqueNames) {
				var mobileOriginalName = A3(_user$project$Utils$getWithDefault, mobileUniqueName, '', uniqueNameToOldName);
				var resolvesCorrectly = function (viewerEId) {
					return A2(
						_elm_lang$core$Maybe$withDefault,
						false,
						A2(
							_elm_lang$core$Maybe$map,
							function (e) {
								return _elm_lang$core$Native_Utils.eq(e.val.eid, mobileEId);
							},
							A3(_user$project$LangTools$maybeResolveIdentifierToExp, mobileOriginalName, viewerEId, originalProgram)));
				};
				if (A2(
					_elm_lang$core$List$all,
					resolvesCorrectly,
					_elm_lang$core$Set$toList(viewerEIds))) {
					return _elm_lang$core$Maybe$Just(
						{ctor: '_Tuple2', _0: mobileOriginalName, _1: originalProgram});
				} else {
					var uniqueNameToOldNameWithoutMobileName = A2(_elm_lang$core$Dict$remove, mobileUniqueName, uniqueNameToOldName);
					var newProgram = A2(_user$project$LangTools$renameIdentifiers, uniqueNameToOldNameWithoutMobileName, originalProgramUniqueNames);
					return _elm_lang$core$Maybe$Just(
						{ctor: '_Tuple2', _0: mobileUniqueName, _1: newProgram});
				}
			});
		var makeVisibleByInsertingNewBinding = function (_p473) {
			var _p474 = _p473;
			var expToWrap = A2(
				_user$project$LangTools$deepestCommonAncestorWithNewline,
				originalProgramUniqueNames,
				function (e) {
					return A2(_elm_lang$core$Set$member, e.val.eid, allViewerEIds);
				});
			var maxId = _user$project$FastParser$maxId(originalProgramUniqueNames);
			var _p475 = {ctor: '_Tuple2', _0: maxId + 1, _1: maxId + 2};
			var insertedVarEId = _p475._0;
			var newBindingPId = _p475._1;
			var newProgramUniqueNames = function () {
				var extractedExp = A2(_user$project$LangTools$justFindExpByEId, originalProgramUniqueNames, mobileEId);
				return A3(
					_user$project$Lang$mapExpNode,
					expToWrap.val.eid,
					function (e) {
						return A5(
							_user$project$LangTools$newLetFancyWhitespace,
							-1,
							A2(
								_user$project$Lang$setPId,
								newBindingPId,
								_user$project$Lang$pVar('*EXTRACTED EXPRESSION*')),
							extractedExp,
							e,
							originalProgramUniqueNames);
					},
					A3(
						_user$project$Lang$mapExpNode,
						mobileEId,
						function (e) {
							return A2(
								_user$project$Lang$setEId,
								insertedVarEId,
								_user$project$Lang$eVar('*EXTRACTED EXPRESSION*'));
						},
						originalProgramUniqueNames));
			}();
			var maybeNewProgramWithLiftedDependenciesOldNames = A2(
				_elm_lang$core$Maybe$map,
				function (_p476) {
					var _p477 = _p476;
					return _user$project$FastParser$freshen(_p477._0.exp);
				},
				A2(
					_user$project$Utils$findFirst,
					_user$project$InterfaceModel$isResultSafe,
					A9(
						_user$project$CodeMotion$tryResolvingProblemsAfterTransformNoTwiddling,
						'',
						A3(_elm_lang$core$Dict$insert, '*EXTRACTED EXPRESSION*', '*EXTRACTED EXPRESSION*', uniqueNameToOldName),
						_elm_lang$core$Maybe$Nothing,
						{ctor: '_Tuple2', _0: '', _1: ''},
						_elm_lang$core$Set$empty,
						{ctor: '[]'},
						A2(
							_elm_lang$core$Dict$singleton,
							insertedVarEId,
							_elm_lang$core$Maybe$Just(newBindingPId)),
						originalProgramUniqueNames,
						newProgramUniqueNames)));
			var visibleNameSuggestion = A2(_user$project$LangTools$expNameForEId, originalProgram, mobileEId);
			var _p478 = maybeNewProgramWithLiftedDependenciesOldNames;
			if (_p478.ctor === 'Nothing') {
				return _elm_lang$core$Maybe$Nothing;
			} else {
				var _p481 = _p478._0;
				var namesToAvoid = function () {
					var finalViewerEIds = _elm_lang$core$Set$fromList(
						A2(
							_elm_lang$core$List$map,
							function (_p479) {
								return function (_) {
									return _.eid;
								}(
									function (_) {
										return _.val;
									}(_p479));
							},
							A2(
								_elm_lang$core$List$filter,
								function (_p480) {
									return A2(
										F2(
											function (x, y) {
												return _elm_lang$core$Native_Utils.eq(x, y);
											}),
										_elm_lang$core$Maybe$Just('*EXTRACTED EXPRESSION*'),
										_user$project$LangTools$expToMaybeIdent(_p480));
								},
								_user$project$Lang$flattenExpTree(_p481))));
					return A2(_user$project$LangTools$visibleIdentifiersAtEIds, _p481, finalViewerEIds);
				}();
				var visibleName = A3(_user$project$LangTools$nonCollidingName, visibleNameSuggestion, 2, namesToAvoid);
				return _elm_lang$core$Maybe$Just(
					{
						ctor: '_Tuple2',
						_0: visibleName,
						_1: A3(_user$project$LangTools$renameIdentifier, '*EXTRACTED EXPRESSION*', visibleName, _p481)
					});
			}
		};
		var _p482 = A2(_user$project$LangTools$findLetAndIdentBindingExp, mobileEId, originalProgramUniqueNames);
		if (_p482.ctor === 'Just') {
			var _p490 = _p482._0._1;
			if (A2(
				_elm_lang$core$List$all,
				function (viewerEId) {
					return A2(
						_elm_lang$core$Set$member,
						_p490,
						A2(
							_user$project$LangTools$visibleIdentifiersAtEIds,
							originalProgramUniqueNames,
							_elm_lang$core$Set$singleton(viewerEId)));
				},
				_elm_lang$core$Set$toList(viewerEIds))) {
				return A5(renameIfCollision, _p490, uniqueNameToOldName, viewerEIds, originalProgram, originalProgramUniqueNames);
			} else {
				var expToWrap = A2(
					_user$project$LangTools$deepestCommonAncestorWithNewline,
					originalProgramUniqueNames,
					function (e) {
						return A2(_elm_lang$core$Set$member, e.val.eid, allViewerEIds);
					});
				var pathedPatId = A2(
					_user$project$Utils$fromJust_,
					'makeEIdVisibleToEIds: bindingPathedPatternIdForUniqueName mobileUniqueName originalProgramUniqueNames',
					A2(_user$project$LangTools$bindingPathedPatternIdForUniqueName, _p490, originalProgramUniqueNames));
				var maybeProgramAfterMove = A2(
					_elm_lang$core$Maybe$map,
					function (_p483) {
						var _p484 = _p483;
						return _p484._0.exp;
					},
					A2(
						_user$project$Utils$findFirst,
						_user$project$InterfaceModel$isResultSafe,
						A3(
							_user$project$CodeMotion$moveDefinitionsBeforeEId,
							{
								ctor: '::',
								_0: pathedPatId,
								_1: {ctor: '[]'}
							},
							expToWrap.val.eid,
							originalProgram)));
				var _p485 = maybeProgramAfterMove;
				if (_p485.ctor === 'Nothing') {
					return makeVisibleByInsertingNewBinding(
						{ctor: '_Tuple0'});
				} else {
					var _p489 = _p485._0;
					var _p486 = _user$project$LangTools$assignUniqueNames(_p489);
					var maybeProgramAfterMoveUniqueNames = _p486._0;
					var afterMoveUniqueNameToOldName = _p486._1;
					var _p487 = A2(_user$project$LangTools$findLetAndIdentBindingExp, mobileEId, maybeProgramAfterMoveUniqueNames);
					if (_p487.ctor === 'Nothing') {
						return _elm_lang$core$Native_Utils.crashCase(
							'CodeMotion',
							{
								start: {line: 2718, column: 13},
								end: {line: 2721, column: 141}
							},
							_p487)('makeEIdVisibleToEIds eids got screwed up somewhere');
					} else {
						return A5(renameIfCollision, _p487._0._1, afterMoveUniqueNameToOldName, viewerEIds, _p489, maybeProgramAfterMoveUniqueNames);
					}
				}
			}
		} else {
			return makeVisibleByInsertingNewBinding(
				{ctor: '_Tuple0'});
		}
	});
var _user$project$CodeMotion$moveDefinitionsPat = F3(
	function (sourcePathedPatIds, targetPathedPatId, program) {
		var makeNewProgram = F2(
			function (pluckedPatAndBoundExps, programWithoutPluckedUniqueNames) {
				var _p491 = targetPathedPatId;
				var targetEId = _p491._0._0;
				var targetPath = _p491._1;
				var newProgram = A3(
					_user$project$Lang$mapExpNode,
					targetEId,
					function (newScopeExp) {
						return A3(
							_elm_lang$core$List$foldr,
							F2(
								function (_p492, newScopeExp) {
									var _p493 = _p492;
									return A3(
										_user$project$CodeMotion$insertPat_,
										{ctor: '_Tuple2', _0: _p493._0, _1: _p493._1},
										targetPath,
										newScopeExp);
								}),
							newScopeExp,
							pluckedPatAndBoundExps);
					},
					programWithoutPluckedUniqueNames);
				return {ctor: '_Tuple2', _0: newProgram, _1: targetEId};
			});
		return A3(_user$project$CodeMotion$moveDefinitions_, makeNewProgram, sourcePathedPatIds, program);
	});
var _user$project$CodeMotion$duplicateDefinitionsBeforeEId = F3(
	function (sourcePathedPatIds, targetEId, originalProgram) {
		var _p494 = A2(_user$project$CodeMotion$pluckAll, sourcePathedPatIds, originalProgram);
		var pluckedPatAndBoundExps = _p494._0;
		var _p495 = _elm_lang$core$List$unzip(pluckedPatAndBoundExps);
		var pluckedPats = _p495._0;
		var pluckedBoundExps = _p495._1;
		var insertedLetEId = _user$project$FastParser$maxId(originalProgram) + 1;
		var newProgram = _user$project$FastParser$freshen(
			A3(
				_user$project$Lang$mapExpNode,
				targetEId,
				function (expToWrap) {
					var _p496 = function () {
						var _p497 = {ctor: '_Tuple2', _0: pluckedPats, _1: pluckedBoundExps};
						if (((((_p497.ctor === '_Tuple2') && (_p497._0.ctor === '::')) && (_p497._0._1.ctor === '[]')) && (_p497._1.ctor === '::')) && (_p497._1._1.ctor === '[]')) {
							return {ctor: '_Tuple2', _0: _p497._0._0, _1: _p497._1._0};
						} else {
							return {
								ctor: '_Tuple2',
								_0: _user$project$Lang$withDummyPatInfo(
									A5(
										_user$project$Lang$PList,
										_user$project$Lang$space1,
										A3(_user$project$Lang$setPatListWhitespace, '', ' ', pluckedPats),
										_user$project$Lang$space0,
										_elm_lang$core$Maybe$Nothing,
										_user$project$Lang$space0)),
								_1: _user$project$Lang$withDummyExpInfo(
									A5(
										_user$project$Lang$EList,
										_user$project$Lang$space1,
										A3(_user$project$Lang$setExpListWhitespace, '', ' ', pluckedBoundExps),
										_user$project$Lang$space0,
										_elm_lang$core$Maybe$Nothing,
										_user$project$Lang$space0))
							};
						}
					}();
					var newPat = _p496._0;
					var newBoundExp = _p496._1;
					return A5(_user$project$LangTools$newLetFancyWhitespace, insertedLetEId, newPat, newBoundExp, expToWrap, originalProgram);
				},
				originalProgram));
		return A4(_user$project$CodeMotion$makeDuplicateResults_, insertedLetEId, pluckedPatAndBoundExps, newProgram, originalProgram);
	});
var _user$project$CodeMotion$duplicateDefinitionsPat = F3(
	function (sourcePathedPatIds, targetPathedPatId, originalProgram) {
		var _p498 = A2(_user$project$CodeMotion$pluckAll, sourcePathedPatIds, originalProgram);
		var pluckedPatAndBoundExps = _p498._0;
		var _p499 = targetPathedPatId;
		var targetEId = _p499._0._0;
		var targetPath = _p499._1;
		var newProgram = _user$project$FastParser$freshen(
			A3(
				_user$project$Lang$mapExpNode,
				targetEId,
				function (newScopeExp) {
					return A3(
						_elm_lang$core$List$foldr,
						F2(
							function (_p500, newScopeExp) {
								var _p501 = _p500;
								return A3(
									_user$project$CodeMotion$insertPat_,
									{ctor: '_Tuple2', _0: _p501._0, _1: _p501._1},
									targetPath,
									newScopeExp);
							}),
						newScopeExp,
						pluckedPatAndBoundExps);
				},
				originalProgram));
		return A4(_user$project$CodeMotion$makeDuplicateResults_, targetEId, pluckedPatAndBoundExps, newProgram, originalProgram);
	});
var _user$project$CodeMotion$inlineDefinitions = F2(
	function (selectedPathedPatIds, originalProgram) {
		var _p502 = _user$project$LangTools$assignUniqueNames(originalProgram);
		var programUniqueNames = _p502._0;
		var uniqueNameToOldName = _p502._1;
		var namedPathedPatIdsToPluck = A2(
			_elm_lang$core$List$concatMap,
			function (_p503) {
				var _p504 = _p503;
				var _p510 = _p504._0;
				var paths = A2(_elm_lang$core$List$map, _user$project$Lang$pathedPatIdToPath, _p504._1);
				var _p505 = A2(
					_user$project$LangTools$findPatByPathedPatternId,
					{
						ctor: '_Tuple2',
						_0: _p510,
						_1: {ctor: '[]'}
					},
					programUniqueNames);
				if (_p505.ctor === 'Nothing') {
					return {ctor: '[]'};
				} else {
					return A2(
						_elm_lang$core$List$map,
						function (_p506) {
							var _p507 = _p506;
							return {ctor: '_Tuple2', _0: _p510, _1: _p507._1};
						},
						A2(
							_elm_lang$core$List$filter,
							function (_p508) {
								var _p509 = _p508;
								return A2(
									_elm_lang$core$List$any,
									_user$project$Utils$isPrefixOf(_p509._1),
									paths);
							},
							_user$project$LangTools$indentPathsInPat(_p505._0)));
				}
			},
			_elm_lang$core$Dict$toList(
				A2(_user$project$Utils$groupBy, _user$project$Lang$pathedPatIdToScopeId, selectedPathedPatIds)));
		var _p511 = A2(_user$project$CodeMotion$pluckAll, namedPathedPatIdsToPluck, programUniqueNames);
		var pluckedPatAndBoundExps = _p511._0;
		var programWithoutPlucked = _p511._1;
		if (_elm_lang$core$Native_Utils.eq(
			pluckedPatAndBoundExps,
			{ctor: '[]'})) {
			return A2(
				_elm_lang$core$Debug$log,
				'could not pluck anything',
				{ctor: '[]'});
		} else {
			var _p512 = _elm_lang$core$List$unzip(pluckedPatAndBoundExps);
			var pluckedPats = _p512._0;
			var pluckedBoundExps = _p512._1;
			var pluckedPathedPatIdentifiersUnique = _user$project$Utils$unionAll(
				A2(_elm_lang$core$List$map, _user$project$LangTools$identifiersSetInPat, pluckedPats));
			var pluckedBoundExpFreeIdentifiersUnique = _user$project$Utils$unionAll(
				A2(_elm_lang$core$List$map, _user$project$LangTools$freeIdentifiers, pluckedBoundExps));
			var namesUniqueExplicitlyTouched = A2(_elm_lang$core$Set$union, pluckedPathedPatIdentifiersUnique, pluckedBoundExpFreeIdentifiersUnique);
			var uniqueIdentToExp = _elm_lang$core$Dict$fromList(
				A2(
					_elm_lang$core$List$map,
					function (_p513) {
						var _p514 = _p513;
						var _p518 = _p514._0;
						var _p517 = _p514._1;
						var _p515 = _user$project$LangTools$patToMaybeIdent(_p518);
						if (_p515.ctor === 'Just') {
							return {ctor: '_Tuple2', _0: _p515._0, _1: _p517};
						} else {
							return _elm_lang$core$Native_Utils.crashCase(
								'CodeMotion',
								{
									start: {line: 1613, column: 13},
									end: {line: 1615, column: 144}
								},
								_p515)(
								A2(
									_elm_lang$core$Basics_ops['++'],
									'CodeMotion.inlineDefinitions: should only have PVar or PAs here, got: ',
									_elm_lang$core$Basics$toString(
										{ctor: '_Tuple2', _0: _p518, _1: _p517})));
						}
					},
					pluckedPatAndBoundExps));
			var _p519 = A3(
				_user$project$Lang$mapFoldExp,
				F2(
					function (exp, varEIdsRemoved) {
						var _p520 = A2(
							_elm_lang$core$Maybe$andThen,
							function (ident) {
								return A2(_elm_lang$core$Dict$get, ident, uniqueIdentToExp);
							},
							_user$project$LangTools$expToMaybeIdent(exp));
						if (_p520.ctor === 'Just') {
							return {
								ctor: '_Tuple2',
								_0: A2(_user$project$Lang$copyPrecedingWhitespace, exp, _p520._0),
								_1: {ctor: '::', _0: exp.val.eid, _1: varEIdsRemoved}
							};
						} else {
							return {ctor: '_Tuple2', _0: exp, _1: varEIdsRemoved};
						}
					}),
				{ctor: '[]'},
				_user$project$LangSimplify$simplifyAssignments(programWithoutPlucked));
			var newProgramUniqueNames = _p519._0;
			var varEIdsRemoved = _p519._1;
			var inlinedThingsStr = _user$project$Utils$toSentence(
				A2(
					_elm_lang$core$List$map,
					function (_p521) {
						return _user$project$Utils$squish(
							_user$project$LangUnparser$unparsePat(
								A2(_user$project$LangTools$renameIdentifiersInPat, uniqueNameToOldName, _p521)));
					},
					pluckedPats));
			return A9(
				_user$project$CodeMotion$programOriginalNamesAndMaybeRenamedLiftedTwiddledResults,
				A2(_elm_lang$core$Basics_ops['++'], 'Inline ', inlinedThingsStr),
				uniqueNameToOldName,
				_elm_lang$core$Maybe$Nothing,
				{ctor: '_Tuple2', _0: 'touched', _1: 'untouched'},
				namesUniqueExplicitlyTouched,
				varEIdsRemoved,
				_elm_lang$core$Dict$empty,
				programUniqueNames,
				newProgramUniqueNames);
		}
	});
var _user$project$CodeMotion$renamePat = F3(
	function (_p522, newName, program) {
		var _p523 = _p522;
		var _p532 = _p523._0;
		var _p531 = _p523._1;
		var _p524 = A2(
			_user$project$LangTools$findScopeExpAndPatByPathedPatternId,
			{ctor: '_Tuple2', _0: _p532, _1: _p531},
			program);
		if (_p524.ctor === 'Just') {
			var _p530 = _p524._0._0;
			var _p529 = _p524._0._1;
			var _p525 = _user$project$LangTools$patToMaybeIdent(_p529);
			if (_p525.ctor === 'Just') {
				var _p528 = _p525._0;
				var scopeAreas = A2(_user$project$LangTools$findScopeAreas, _p532, _p530);
				var oldUseEIds = A2(
					_elm_lang$core$List$map,
					function (_p526) {
						return function (_) {
							return _.eid;
						}(
							function (_) {
								return _.val;
							}(_p526));
					},
					A2(
						_elm_lang$core$List$concatMap,
						_user$project$LangTools$identifierUses(_p528),
						scopeAreas));
				var newScopeAreas = A2(
					_elm_lang$core$List$map,
					A2(_user$project$LangTools$renameVarUntilBound, _p528, newName),
					scopeAreas);
				var newUseEIds = A2(
					_elm_lang$core$List$map,
					function (_p527) {
						return function (_) {
							return _.eid;
						}(
							function (_) {
								return _.val;
							}(_p527));
					},
					A2(
						_elm_lang$core$List$concatMap,
						_user$project$LangTools$identifierUses(newName),
						newScopeAreas));
				var isSafe = _elm_lang$core$Native_Utils.eq(oldUseEIds, newUseEIds) && (!A2(
					_elm_lang$core$List$member,
					newName,
					_user$project$LangTools$identifiersListInPat(_p529)));
				var newScopeExp = function () {
					var scopeAreasReplaced = A3(
						_elm_lang$core$List$foldl,
						F2(
							function (newScopeArea, scopeExp) {
								return A3(_user$project$Lang$replaceExpNode, newScopeArea.val.eid, newScopeArea, scopeExp);
							}),
						_p530,
						newScopeAreas);
					return A3(
						_user$project$LangTools$setPatName,
						{ctor: '_Tuple2', _0: _p532, _1: _p531},
						newName,
						scopeAreasReplaced);
				}();
				var newProgram = A3(_user$project$Lang$replaceExpNode, newScopeExp.val.eid, newScopeExp, program);
				var result = function () {
					var descriptionEnd = _elm_lang$core$String$isEmpty(newName) ? '...' : A2(
						_elm_lang$core$Basics_ops['++'],
						' \'',
						A2(_elm_lang$core$Basics_ops['++'], newName, '\''));
					var descriptionStart = A2(
						_elm_lang$core$Basics_ops['++'],
						'Rename \'',
						A2(_elm_lang$core$Basics_ops['++'], _p528, '\' to'));
					var description = A2(_elm_lang$core$Basics_ops['++'], descriptionStart, descriptionEnd);
					return A2(
						_user$project$InterfaceModel$setResultSafe,
						isSafe,
						A2(_user$project$InterfaceModel$synthesisResult, description, newProgram));
				}();
				return {
					ctor: '::',
					_0: result,
					_1: {ctor: '[]'}
				};
			} else {
				return {ctor: '[]'};
			}
		} else {
			return {ctor: '[]'};
		}
	});
var _user$project$CodeMotion$renameVar = F3(
	function (varEId, newName, program) {
		var varExp = A2(_user$project$LangTools$justFindExpByEId, program, varEId);
		var oldName = _user$project$LangTools$expToIdent(varExp);
		var _p533 = A2(_user$project$LangTools$bindingPathedPatternIdFor, varExp, program);
		if (_p533.ctor === 'Just') {
			return A3(_user$project$CodeMotion$renamePat, _p533._0, newName, program);
		} else {
			var _p534 = A2(
				_elm_lang$core$Debug$log,
				A2(_elm_lang$core$Basics_ops['++'], oldName, ' is free at this location in the program'),
				{ctor: '_Tuple0'});
			return {ctor: '[]'};
		}
	});
var _user$project$CodeMotion$swapUsages = F3(
	function (_p536, _p535, originalProgram) {
		var _p537 = _p536;
		var _p538 = _p535;
		var _p539 = {
			ctor: '_Tuple2',
			_0: A2(
				_user$project$LangTools$findScopeExpAndPatByPathedPatternId,
				{ctor: '_Tuple2', _0: _p537._0, _1: _p537._1},
				originalProgram),
			_1: A2(
				_user$project$LangTools$findScopeExpAndPatByPathedPatternId,
				{ctor: '_Tuple2', _0: _p538._0, _1: _p538._1},
				originalProgram)
		};
		if (((((_p539.ctor === '_Tuple2') && (_p539._0.ctor === 'Just')) && (_p539._0._0.ctor === '_Tuple2')) && (_p539._1.ctor === 'Just')) && (_p539._1._0.ctor === '_Tuple2')) {
			var _p547 = _p539._1._0._1;
			var _p546 = _p539._0._0._1;
			var _p540 = {
				ctor: '_Tuple2',
				_0: _user$project$LangTools$patToMaybeIdent(_p546),
				_1: _user$project$LangTools$patToMaybeIdent(_p547)
			};
			if (((_p540.ctor === '_Tuple2') && (_p540._0.ctor === 'Just')) && (_p540._1.ctor === 'Just')) {
				var _p545 = _p540._1._0;
				var _p544 = _p540._0._0;
				var eidToBindingPId = _user$project$LangTools$allVarEIdsToBindingPId(originalProgram);
				var newProgram = A2(
					_user$project$Lang$mapExp,
					function (exp) {
						var _p541 = {
							ctor: '_Tuple2',
							_0: A2(_elm_lang$core$Dict$get, exp.val.eid, eidToBindingPId),
							_1: exp.val.e__
						};
						if ((((_p541.ctor === '_Tuple2') && (_p541._0.ctor === 'Just')) && (_p541._0._0.ctor === 'Just')) && (_p541._1.ctor === 'EVar')) {
							var _p543 = _p541._1._0;
							var _p542 = _p541._0._0._0;
							return _elm_lang$core$Native_Utils.eq(_p542, _p546.val.pid) ? A2(
								_user$project$Lang$replaceE__,
								exp,
								A2(_user$project$Lang$EVar, _p543, _p545)) : (_elm_lang$core$Native_Utils.eq(_p542, _p547.val.pid) ? A2(
								_user$project$Lang$replaceE__,
								exp,
								A2(_user$project$Lang$EVar, _p543, _p544)) : exp);
						} else {
							return exp;
						}
					},
					originalProgram);
				var isSafe = function () {
					var expectedVarEIdsToBindingPId = A2(
						_elm_lang$core$Dict$map,
						F2(
							function (eid, maybePId) {
								return _elm_lang$core$Native_Utils.eq(
									maybePId,
									_elm_lang$core$Maybe$Just(_p546.val.pid)) ? _elm_lang$core$Maybe$Just(_p547.val.pid) : (_elm_lang$core$Native_Utils.eq(
									maybePId,
									_elm_lang$core$Maybe$Just(_p547.val.pid)) ? _elm_lang$core$Maybe$Just(_p546.val.pid) : maybePId);
							}),
						eidToBindingPId);
					return _elm_lang$core$Native_Utils.eq(
						_user$project$LangTools$allVarEIdsToBindingPId(newProgram),
						expectedVarEIdsToBindingPId);
				}();
				var result = A2(
					_user$project$InterfaceModel$setResultSafe,
					isSafe,
					A2(
						_user$project$InterfaceModel$synthesisResult,
						A2(
							_elm_lang$core$Basics_ops['++'],
							'Swap usages of ',
							A2(
								_elm_lang$core$Basics_ops['++'],
								_p544,
								A2(_elm_lang$core$Basics_ops['++'], ' and ', _p545))),
						newProgram));
				return {
					ctor: '::',
					_0: result,
					_1: {ctor: '[]'}
				};
			} else {
				return {ctor: '[]'};
			}
		} else {
			return {ctor: '[]'};
		}
	});
var _user$project$CodeMotion$composeTransformations = F3(
	function (finalCaption, transformations, originalProgram) {
		return A2(
			_elm_lang$core$List$map,
			_user$project$InterfaceModel$setResultDescription(finalCaption),
			A3(
				_elm_lang$core$List$foldl,
				F2(
					function (transformation, results) {
						return A2(
							_elm_lang$core$List$concatMap,
							function (_p548) {
								var _p549 = _p548;
								var _p550 = _p549._0;
								return A2(
									_elm_lang$core$List$map,
									_user$project$InterfaceModel$mapResultSafe(
										F2(
											function (x, y) {
												return x && y;
											})(_p550.isSafe)),
									transformation(
										_user$project$FastParser$freshen(_p550.exp)));
							},
							results);
					}),
				{
					ctor: '::',
					_0: A2(_user$project$InterfaceModel$synthesisResult, 'Original', originalProgram),
					_1: {ctor: '[]'}
				},
				transformations));
	});

var _user$project$ColorScheme$encodeToName = function (colorScheme) {
	var _p0 = colorScheme;
	if (_p0.ctor === 'Light') {
		return 'light';
	} else {
		return 'dark';
	}
};
var _user$project$ColorScheme$updateColorSchemeByName = _elm_lang$core$Native_Platform.outgoingPort(
	'updateColorSchemeByName',
	function (v) {
		return v;
	});
var _user$project$ColorScheme$updateColorScheme = function (_p1) {
	return _user$project$ColorScheme$updateColorSchemeByName(
		_user$project$ColorScheme$encodeToName(_p1));
};

var _user$project$ValueBasedTransform$traceToExp = F3(
	function (locIdToFrozenNum, locIdToIdent, trace) {
		var _p0 = trace;
		if (_p0.ctor === 'TrLoc') {
			var _p3 = _p0._0._0;
			var _p1 = A2(_elm_lang$core$Dict$get, _p3, locIdToIdent);
			if (_p1.ctor === 'Just') {
				return _user$project$Lang$eVar(_p1._0);
			} else {
				var _p2 = A2(_elm_lang$core$Dict$get, _p3, locIdToFrozenNum);
				if (_p2.ctor === 'Just') {
					return A2(
						_user$project$Lang$eConst,
						_p2._0,
						_user$project$Lang$dummyLoc_(_user$project$Lang$frozen));
				} else {
					return _user$project$Lang$eVar(
						A2(
							_elm_lang$core$Basics_ops['++'],
							'couldNotFindLocId',
							_elm_lang$core$Basics$toString(_p3)));
				}
			}
		} else {
			var childExps = A2(
				_elm_lang$core$List$map,
				A2(_user$project$ValueBasedTransform$traceToExp, locIdToFrozenNum, locIdToIdent),
				_p0._1);
			return A2(_user$project$Lang$eOp, _p0._0, childExps);
		}
	});
var _user$project$ValueBasedTransform$equationToExp = F3(
	function (locIdToFrozenNum, locIdToIdent, eqn) {
		var _p4 = eqn;
		if (_p4.ctor === 'EqnNum') {
			return A3(_user$project$ValueBasedTransform$traceToExp, locIdToFrozenNum, locIdToIdent, _p4._0._1);
		} else {
			var childExps = A2(
				_elm_lang$core$List$map,
				A2(_user$project$ValueBasedTransform$equationToExp, locIdToFrozenNum, locIdToIdent),
				_p4._1);
			return A2(_user$project$Lang$eOp, _p4._0, childExps);
		}
	});
var _user$project$ValueBasedTransform$traceToLittle = F2(
	function (substStr, trace) {
		var _p5 = trace;
		if (_p5.ctor === 'TrLoc') {
			var _p6 = A2(_elm_lang$core$Dict$get, _p5._0._0, substStr);
			if (_p6.ctor === 'Just') {
				return _p6._0;
			} else {
				return '?';
			}
		} else {
			var childLittleStrs = A2(
				_elm_lang$core$List$map,
				_user$project$ValueBasedTransform$traceToLittle(substStr),
				_p5._1);
			return A2(
				_elm_lang$core$Basics_ops['++'],
				'(',
				A2(
					_elm_lang$core$Basics_ops['++'],
					_user$project$Lang$strOp(_p5._0),
					A2(
						_elm_lang$core$Basics_ops['++'],
						' ',
						A2(
							_elm_lang$core$Basics_ops['++'],
							A2(_elm_lang$core$String$join, ' ', childLittleStrs),
							')'))));
		}
	});
var _user$project$ValueBasedTransform$equationToLittle = F2(
	function (substStr, eqn) {
		var _p7 = eqn;
		if (_p7.ctor === 'EqnNum') {
			var littlizedTrace = A2(_user$project$ValueBasedTransform$traceToLittle, substStr, _p7._0._1);
			return (!_elm_lang$core$Native_Utils.eq(littlizedTrace, '?')) ? littlizedTrace : A2(
				_elm_lang$core$Basics_ops['++'],
				_elm_lang$core$Basics$toString(_p7._0._0),
				'!');
		} else {
			var childLittleStrs = A2(
				_elm_lang$core$List$map,
				_user$project$ValueBasedTransform$equationToLittle(substStr),
				_p7._1);
			return A2(
				_elm_lang$core$Basics_ops['++'],
				'(',
				A2(
					_elm_lang$core$Basics_ops['++'],
					_user$project$Lang$strOp(_p7._0),
					A2(
						_elm_lang$core$Basics_ops['++'],
						' ',
						A2(
							_elm_lang$core$Basics_ops['++'],
							A2(_elm_lang$core$String$join, ' ', childLittleStrs),
							')'))));
		}
	});
var _user$project$ValueBasedTransform$xOrYFeatureNameRegex = _elm_lang$core$Regex$regex('^(?!ellipseR)(.*)[XY](\\d*)$');
var _user$project$ValueBasedTransform$featureNameIsXOrY = function (featureName) {
	return A2(_elm_lang$core$Regex$contains, _user$project$ValueBasedTransform$xOrYFeatureNameRegex, featureName);
};
var _user$project$ValueBasedTransform$featurePointAndNumber = function (featureName) {
	return function (_) {
		return _.submatches;
	}(
		_user$project$Utils$head_(
			A3(
				_elm_lang$core$Regex$find,
				_elm_lang$core$Regex$AtMost(1),
				_user$project$ValueBasedTransform$xOrYFeatureNameRegex,
				featureName)));
};
var _user$project$ValueBasedTransform$featuresNamesAreXYPairs = F2(
	function (featureNameA, featureNameB) {
		return _user$project$ValueBasedTransform$featureNameIsXOrY(featureNameA) && (_user$project$ValueBasedTransform$featureNameIsXOrY(featureNameB) && ((!_elm_lang$core$Native_Utils.eq(featureNameA, featureNameB)) && _elm_lang$core$Native_Utils.eq(
			_user$project$ValueBasedTransform$featurePointAndNumber(featureNameA),
			_user$project$ValueBasedTransform$featurePointAndNumber(featureNameB))));
	});
var _user$project$ValueBasedTransform$yFeatureNameRegex = _elm_lang$core$Regex$regex('^(?!ellipseR)(.*)Y(\\d*)$');
var _user$project$ValueBasedTransform$featureNameIsY = function (featureName) {
	return A2(_elm_lang$core$Regex$contains, _user$project$ValueBasedTransform$yFeatureNameRegex, featureName);
};
var _user$project$ValueBasedTransform$xFeatureNameRegex = _elm_lang$core$Regex$regex('^(?!ellipseR)(.*)X(\\d*)$');
var _user$project$ValueBasedTransform$featureNameIsX = function (featureName) {
	return A2(_elm_lang$core$Regex$contains, _user$project$ValueBasedTransform$xFeatureNameRegex, featureName);
};
var _user$project$ValueBasedTransform$featurePoints = function (features) {
	featurePoints:
	while (true) {
		var _p8 = features;
		if (_p8.ctor === '[]') {
			return {ctor: '[]'};
		} else {
			var _p15 = _p8._1;
			var _p14 = _p8._0;
			var _p9 = _p14;
			var nodeId = _p9._0;
			var featureName = _p9._1;
			if (!_user$project$ValueBasedTransform$featureNameIsXOrY(featureName)) {
				var _v8 = _p15;
				features = _v8;
				continue featurePoints;
			} else {
				var nodeFeatures = A2(
					_elm_lang$core$List$filter,
					function (_p10) {
						return A2(
							F2(
								function (x, y) {
									return _elm_lang$core$Native_Utils.eq(x, y);
								}),
							nodeId,
							_elm_lang$core$Tuple$first(_p10));
					},
					_p15);
				var maybePairedFeature = A2(
					_user$project$Utils$findFirst,
					function (_p11) {
						return A2(
							_user$project$ValueBasedTransform$featuresNamesAreXYPairs,
							featureName,
							_elm_lang$core$Tuple$second(_p11));
					},
					nodeFeatures);
				var _p12 = maybePairedFeature;
				if (_p12.ctor === 'Just') {
					var _p13 = _p12._0;
					var pairToReturn = _user$project$ValueBasedTransform$featureNameIsX(featureName) ? {ctor: '_Tuple2', _0: _p14, _1: _p13} : {ctor: '_Tuple2', _0: _p13, _1: _p14};
					var remainingFeatures = A2(_user$project$Utils$removeFirst, _p13, _p15);
					return {
						ctor: '::',
						_0: pairToReturn,
						_1: _user$project$ValueBasedTransform$featurePoints(remainingFeatures)
					};
				} else {
					var _v10 = _p15;
					features = _v10;
					continue featurePoints;
				}
			}
		}
	}
};
var _user$project$ValueBasedTransform$featureEquationToLocEquation = function (featureEqn) {
	var _p16 = featureEqn;
	if (_p16.ctor === 'EqnNum') {
		if (_p16._0._1.ctor === 'TrLoc') {
			if (_p16._0._1._0._0 === 0) {
				return _user$project$LocEqn$LocEqnConst(_p16._0._0);
			} else {
				return _user$project$LocEqn$LocEqnLoc(_p16._0._1._0._0);
			}
		} else {
			return A2(
				_user$project$LocEqn$LocEqnOp,
				_p16._0._1._0,
				A2(_elm_lang$core$List$map, _user$project$LocEqn$traceToLocEquation, _p16._0._1._1));
		}
	} else {
		return A2(
			_user$project$LocEqn$LocEqnOp,
			_p16._0,
			A2(_elm_lang$core$List$map, _user$project$ValueBasedTransform$featureEquationToLocEquation, _p16._1));
	}
};
var _user$project$ValueBasedTransform$solveForLoc = F5(
	function (locId, locIdToNum, subst, lhs, rhs) {
		var rhsLocEqn = _user$project$ValueBasedTransform$featureEquationToLocEquation(rhs);
		var lhsLocEqn = _user$project$ValueBasedTransform$featureEquationToLocEquation(lhs);
		return A5(_user$project$LocEqn$solveForLoc, locId, locIdToNum, subst, lhsLocEqn, rhsLocEqn);
	});
var _user$project$ValueBasedTransform$equationVals = function (eqn) {
	var _p17 = eqn;
	if (_p17.ctor === 'EqnNum') {
		return {
			ctor: '::',
			_0: _p17._0,
			_1: {ctor: '[]'}
		};
	} else {
		return A2(_elm_lang$core$List$concatMap, _user$project$ValueBasedTransform$equationVals, _p17._1);
	}
};
var _user$project$ValueBasedTransform$equationLocs = F2(
	function (syncOptions, eqn) {
		return A2(
			_elm_lang$core$List$concatMap,
			function (_p18) {
				return _elm_lang$core$Set$toList(
					A2(
						_user$project$Sync$locsOfTrace,
						syncOptions,
						_elm_lang$core$Tuple$second(_p18)));
			},
			_user$project$ValueBasedTransform$equationVals(eqn));
	});
var _user$project$ValueBasedTransform$nodeIdAndFeatureNameToEquation = F4(
	function (_p19, tree, widgets, locIdToNumberAndLoc) {
		var _p20 = _p19;
		var _p26 = _p20._0;
		var _p25 = _p20._1;
		if (!(_elm_lang$core$Native_Utils.cmp(_p26, -2) < 0)) {
			var _p21 = A2(_elm_lang$core$Dict$get, _p26, tree);
			if (_p21.ctor === 'Just') {
				if (_p21._0.ctor === 'SvgNode') {
					return _elm_lang$core$Maybe$Just(
						A3(_user$project$ShapeWidgets$featureEquation, _p21._0._0, _p25, _p21._0._1));
				} else {
					return _elm_lang$core$Maybe$Nothing;
				}
			} else {
				return _elm_lang$core$Native_Utils.crashCase(
					'ValueBasedTransform',
					{
						start: {line: 867, column: 5},
						end: {line: 875, column: 104}
					},
					_p21)(
					A2(
						_elm_lang$core$Basics_ops['++'],
						'nodeIdAndFeatureNameToEquation ',
						A2(
							_elm_lang$core$Basics_ops['++'],
							_elm_lang$core$Basics$toString(_p26),
							A2(
								_elm_lang$core$Basics_ops['++'],
								' ',
								_elm_lang$core$Basics$toString(tree)))));
			}
		} else {
			var widgetId = (0 - _p26) - 2;
			var _p23 = A2(_user$project$Utils$maybeGeti1, widgetId, widgets);
			if (_p23.ctor === 'Just') {
				return _elm_lang$core$Maybe$Just(
					A3(_user$project$ShapeWidgets$widgetFeatureEquation, _p25, _p23._0, locIdToNumberAndLoc));
			} else {
				return _elm_lang$core$Native_Utils.crashCase(
					'ValueBasedTransform',
					{
						start: {line: 880, column: 5},
						end: {line: 882, column: 140}
					},
					_p23)(
					A2(
						_elm_lang$core$Basics_ops['++'],
						'nodeIdAndFeatureNameToEquation can\'t find widget ',
						A2(
							_elm_lang$core$Basics_ops['++'],
							_elm_lang$core$Basics$toString(widgetId),
							A2(
								_elm_lang$core$Basics_ops['++'],
								' ',
								_elm_lang$core$Basics$toString(widgets)))));
			}
		}
	});
var _user$project$ValueBasedTransform$evaluateFeature = F4(
	function (nodeIdAndFeatureName, slate, widgets, locIdToNumberAndLoc) {
		var _p27 = slate;
		var tree = _p27._1;
		var _p28 = A4(_user$project$ValueBasedTransform$nodeIdAndFeatureNameToEquation, nodeIdAndFeatureName, tree, widgets, locIdToNumberAndLoc);
		if (_p28.ctor === 'Just') {
			return _user$project$ShapeWidgets$evaluateFeatureEquation(_p28._0);
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$ValueBasedTransform$locIdToWidgetDeclOf = function (exp) {
	return A3(
		_user$project$Lang$foldExpViaE__,
		F2(
			function (e__, dict) {
				var _p29 = e__;
				if ((_p29.ctor === 'EConst') && (_p29._2.ctor === '_Tuple3')) {
					return A3(_elm_lang$core$Dict$insert, _p29._2._0, _p29._3, dict);
				} else {
					return dict;
				}
			}),
		_elm_lang$core$Dict$empty,
		exp);
};
var _user$project$ValueBasedTransform$locIdToWidgetDeclLittleOf = function (exp) {
	return A2(
		_elm_lang$core$Dict$map,
		F2(
			function (locId, wd) {
				return _user$project$LangUnparser$unparseWD(wd);
			}),
		_user$project$ValueBasedTransform$locIdToWidgetDeclOf(exp));
};
var _user$project$ValueBasedTransform$locIdToNumberAndLocOf = function (exp) {
	return A3(
		_user$project$Lang$foldExpViaE__,
		F2(
			function (e__, dict) {
				var _p30 = e__;
				if ((_p30.ctor === 'EConst') && (_p30._2.ctor === '_Tuple3')) {
					var _p31 = _p30._2._0;
					return A3(
						_elm_lang$core$Dict$insert,
						_p31,
						{
							ctor: '_Tuple2',
							_0: _p30._1,
							_1: {ctor: '_Tuple3', _0: _p31, _1: _p30._2._1, _2: _p30._2._2}
						},
						dict);
				} else {
					return dict;
				}
			}),
		_elm_lang$core$Dict$empty,
		exp);
};
var _user$project$ValueBasedTransform$pluckFeatureEquationNamed = F4(
	function (_p32, slate, widgets, locIdToNumberAndLoc) {
		var _p33 = _p32;
		var _p36 = _p33._1;
		var _p34 = slate;
		var tree = _p34._1;
		var _p35 = A4(
			_user$project$ValueBasedTransform$nodeIdAndFeatureNameToEquation,
			{ctor: '_Tuple2', _0: _p33._0, _1: _p36},
			tree,
			widgets,
			locIdToNumberAndLoc);
		if (_p35.ctor === 'Just') {
			return _elm_lang$core$Maybe$Just(
				{ctor: '_Tuple2', _0: _p36, _1: _p35._0});
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$ValueBasedTransform$pluckSelectedFeatureEquationsNamed = F4(
	function (selectedFeatures, slate, widgets, locIdToNumberAndLoc) {
		var accumulator = F2(
			function (typeAndNodeIdAndFeature, acc) {
				var _p37 = A4(_user$project$ValueBasedTransform$pluckFeatureEquationNamed, typeAndNodeIdAndFeature, slate, widgets, locIdToNumberAndLoc);
				if (_p37.ctor === 'Just') {
					return {
						ctor: '::',
						_0: {ctor: '_Tuple2', _0: _p37._0._0, _1: _p37._0._1},
						_1: acc
					};
				} else {
					return acc;
				}
			});
		return A3(
			_elm_lang$core$Set$foldr,
			accumulator,
			{ctor: '[]'},
			selectedFeatures);
	});
var _user$project$ValueBasedTransform$pluckSelectedFeatureEquations = F4(
	function (selectedFeatures, slate, widgets, locIdToNumberAndLoc) {
		return A2(
			_elm_lang$core$List$map,
			_elm_lang$core$Tuple$second,
			A4(_user$project$ValueBasedTransform$pluckSelectedFeatureEquationsNamed, selectedFeatures, slate, widgets, locIdToNumberAndLoc));
	});
var _user$project$ValueBasedTransform$pluckSelectedVals = F4(
	function (selectedFeatures, slate, widgets, locIdToNumberAndLoc) {
		var featureEquations = A4(_user$project$ValueBasedTransform$pluckSelectedFeatureEquations, selectedFeatures, slate, widgets, locIdToNumberAndLoc);
		return A2(_elm_lang$core$List$concatMap, _user$project$ValueBasedTransform$equationVals, featureEquations);
	});
var _user$project$ValueBasedTransform$variableifyConstantsAndWrapTargetExpWithLets = F4(
	function (locIdToNewName, listOfListsOfNamesAndAssigns, targetExp, program) {
		var targetExpReplaced = A2(_user$project$LangTools$replaceConstsWithVars, locIdToNewName, targetExp);
		var wrappedTargetExp = A3(
			_user$project$LangTools$wrapWithLets,
			listOfListsOfNamesAndAssigns,
			A2(_user$project$LangTools$isTopLevel, targetExp, program),
			targetExpReplaced);
		var newProgram = _user$project$FastParser$freshen(
			A3(_user$project$Lang$replaceExpNodeE__, targetExp, wrappedTargetExp.val.e__, program));
		return newProgram;
	});
var _user$project$ValueBasedTransform$deepestCommonAncestorWithNewlineByLocSet = F2(
	function (exp, locset) {
		var isLocsetNode = function (exp) {
			var _p38 = exp.val.e__;
			if (_p38.ctor === 'EConst') {
				return A2(_elm_lang$core$Set$member, _p38._2, locset);
			} else {
				return false;
			}
		};
		return A2(_user$project$LangTools$deepestCommonAncestorWithNewline, exp, isLocsetNode);
	});
var _user$project$ValueBasedTransform$liftLocsSoVisibleTo = F3(
	function (originalExp, mobileLocset, observerEIds) {
		var isPredecessor = function (exp) {
			var isMobileLoc = function () {
				var _p39 = exp.val.e__;
				if (_p39.ctor === 'EConst') {
					return A2(_elm_lang$core$Set$member, _p39._2, mobileLocset);
				} else {
					return false;
				}
			}();
			return isMobileLoc || A2(_elm_lang$core$Set$member, exp.val.eid, observerEIds);
		};
		var commonScope = A2(_user$project$LangTools$deepestCommonAncestorWithNewline, originalExp, isPredecessor);
		var locs = _elm_lang$core$Set$toList(mobileLocset);
		var locIds = A2(
			_elm_lang$core$List$map,
			function (_p40) {
				var _p41 = _p40;
				return _p41._0;
			},
			locs);
		var locEIds = A2(
			_elm_lang$core$List$map,
			function (locId) {
				return A2(
					_user$project$Utils$fromJust_,
					'ValueBasedTransform.liftLocsSoVisibleTo locEIds',
					A2(_user$project$Lang$locIdToEId, originalExp, locId));
			},
			locIds);
		var eids = A2(
			_elm_lang$core$Set$union,
			_elm_lang$core$Set$fromList(locEIds),
			observerEIds);
		var existingNames = A2(_user$project$LangTools$visibleIdentifiersAtEIds, originalExp, eids);
		var _p42 = A3(
			_elm_lang$core$List$foldr,
			F2(
				function (_p44, _p43) {
					var _p45 = _p44;
					var _p49 = _p45._0;
					var _p48 = _p45._2;
					var _p46 = _p43;
					var _p47 = _p46._0;
					var baseIdent = A2(
						_elm_lang$core$Maybe$withDefault,
						_elm_lang$core$Native_Utils.eq(_p48, '') ? 'num' : _p48,
						A2(
							_elm_lang$core$Maybe$map,
							_user$project$LangTools$expNameForEId(originalExp),
							A2(_user$project$Lang$locIdToEId, originalExp, _p49)));
					var scopeNamesLiftedThrough = A2(
						_user$project$LangTools$scopeNamesLocLiftedThrough,
						commonScope,
						{ctor: '_Tuple3', _0: _p49, _1: _user$project$Lang$frozen, _2: _p48});
					var scopesAndBaseIdent = A2(
						_elm_lang$core$String$join,
						'_',
						A2(
							_elm_lang$core$Basics_ops['++'],
							scopeNamesLiftedThrough,
							{
								ctor: '::',
								_0: baseIdent,
								_1: {ctor: '[]'}
							}));
					var ident = _elm_lang$core$Native_Utils.eq(scopesAndBaseIdent, baseIdent) ? A3(
						_user$project$LangTools$nonCollidingName,
						A2(_elm_lang$core$Basics_ops['++'], baseIdent, '_orig'),
						2,
						_p47) : A3(_user$project$LangTools$nonCollidingName, scopesAndBaseIdent, 2, _p47);
					return {
						ctor: '_Tuple2',
						_0: A2(_elm_lang$core$Set$insert, ident, _p47),
						_1: A3(_elm_lang$core$Dict$insert, _p49, ident, _p46._1)
					};
				}),
			{ctor: '_Tuple2', _0: existingNames, _1: _elm_lang$core$Dict$empty},
			_elm_lang$core$Set$toList(mobileLocset));
		var locIdToNewName = _p42._1;
		var locNames = A2(
			_elm_lang$core$List$map,
			function (locId) {
				return A3(_user$project$Utils$justGet_, 'ValueBasedTransform.liftLocsSoVisibleTo locNames', locId, locIdToNewName);
			},
			locIds);
		var locExps = A2(
			_elm_lang$core$List$map,
			_user$project$Lang$clearEId,
			A2(
				_elm_lang$core$List$map,
				function (locId) {
					return A2(
						_user$project$Utils$fromJust_,
						'ValueBasedTransform.liftLocsSoVisibleTo locExps',
						A2(_user$project$Lang$findExpByLocId, commonScope, locId));
				},
				locIds));
		var listOfListsOfNamesAndAssigns = {
			ctor: '::',
			_0: A2(_user$project$Utils$zip, locNames, locExps),
			_1: {ctor: '[]'}
		};
		var newExp = A4(_user$project$ValueBasedTransform$variableifyConstantsAndWrapTargetExpWithLets, locIdToNewName, listOfListsOfNamesAndAssigns, commonScope, originalExp);
		return {ctor: '_Tuple2', _0: newExp, _1: locIdToNewName};
	});
var _user$project$ValueBasedTransform$rankComparedTo = F2(
	function (originalExp, synthesisResults) {
		var isLocId = F2(
			function (targetLocId, exp) {
				var _p50 = exp.val.e__;
				if ((_p50.ctor === 'EConst') && (_p50._2.ctor === '_Tuple3')) {
					return _elm_lang$core$Native_Utils.eq(targetLocId, _p50._2._0);
				} else {
					return false;
				}
			});
		return A2(
			_elm_lang$core$List$map,
			function (_p51) {
				var _p52 = _p51;
				var locLineNums = A2(
					_elm_lang$core$List$map,
					function (locId) {
						var _p53 = A2(
							_user$project$Lang$findFirstNode,
							isLocId(locId),
							originalExp);
						if (_p53.ctor === 'Just') {
							return _elm_lang$core$Basics$toFloat(_p53._0.start.line);
						} else {
							return 0 - _user$project$Utils$infinity;
						}
					},
					_p52.dependentLocIds);
				var removedLocDistance = ((_elm_lang$core$Native_Utils.cmp(
					_elm_lang$core$List$length(locLineNums),
					1) < 1) || A2(_elm_lang$core$List$any, _elm_lang$core$Basics$isInfinite, locLineNums)) ? _user$project$Utils$infinity : (_user$project$Utils$fromJust(
					_elm_lang$core$List$maximum(locLineNums)) - _user$project$Utils$fromJust(
					_elm_lang$core$List$minimum(locLineNums)));
				return _user$project$InterfaceModel$SynthesisResult(
					{
						description: _p52.description,
						exp: _p52.exp,
						isSafe: true,
						sortKey: A2(
							_elm_lang$core$Basics_ops['++'],
							{
								ctor: '::',
								_0: removedLocDistance,
								_1: {ctor: '[]'}
							},
							_elm_lang$core$List$reverse(
								A2(_elm_lang$core$List$map, _elm_lang$core$Basics$negate, locLineNums))),
						children: _elm_lang$core$Maybe$Nothing
					});
			},
			synthesisResults);
	});
var _user$project$ValueBasedTransform$indexLocId = -2;
var _user$project$ValueBasedTransform$indexedRelateDistanceScore = F3(
	function (subst, indexedLocIdsWithTarget, locEqn) {
		var _p54 = _user$project$Utils$unzip3(indexedLocIdsWithTarget);
		var targets = _p54._2;
		var meanAbsoluteDeviation = function () {
			var absDevs = A2(
				_elm_lang$core$List$map,
				function (_p55) {
					var _p56 = _p55;
					return _p56._1 - _p56._0;
				},
				A2(
					_user$project$Utils$zip,
					targets,
					A2(_elm_lang$core$List$drop, 1, targets)));
			return _elm_lang$core$List$sum(absDevs) / _elm_lang$core$Basics$toFloat(
				_elm_lang$core$List$length(absDevs));
		}();
		var sumOfSquares = _elm_lang$core$List$sum(
			A2(
				_elm_lang$core$List$map,
				function (distance) {
					return Math.pow(distance / meanAbsoluteDeviation, 2);
				},
				A2(
					_elm_lang$core$List$map,
					function (_p57) {
						var _p58 = _p57;
						return A2(
							_user$project$LocEqn$locEqnEval,
							A3(
								_elm_lang$core$Dict$insert,
								_user$project$ValueBasedTransform$indexLocId,
								_elm_lang$core$Basics$toFloat(_p58._0),
								subst),
							locEqn) - _p58._2;
					},
					indexedLocIdsWithTarget)));
		return sumOfSquares / _elm_lang$core$Basics$toFloat(
			_elm_lang$core$List$length(indexedLocIdsWithTarget));
	});
var _user$project$ValueBasedTransform$stormTheBastille = F2(
	function (subst, indexedLocIdsWithTarget) {
		var _p59 = _user$project$Utils$unzip3(indexedLocIdsWithTarget);
		var locIds = _p59._1;
		var locIdsAndIndex = {ctor: '::', _0: _user$project$ValueBasedTransform$indexLocId, _1: locIds};
		var distanceScore = function (locEqn) {
			return A3(_user$project$ValueBasedTransform$indexedRelateDistanceScore, subst, indexedLocIdsWithTarget, locEqn);
		};
		var eqnsOfSize = function (astSize) {
			return A2(
				_elm_lang$core$List$filter,
				function (locEqn) {
					return _elm_lang$core$Native_Utils.cmp(
						_user$project$LocEqn$locEqnSize(locEqn),
						astSize) > -1;
				},
				A2(
					_elm_lang$core$List$map,
					_user$project$LocEqn$normalizeSimplify,
					A2(
						_elm_lang$core$List$filter,
						function (locEqn) {
							return _elm_lang$core$Native_Utils.cmp(
								distanceScore(locEqn),
								Math.pow(0.2, 2)) < 0;
						},
						A2(
							_elm_lang$core$List$map,
							function (locsFilledTemplate) {
								return A2(
									_user$project$Utils$head,
									'ValueBasedTransform.stormTheBastille constantFillingRanking',
									A2(
										_elm_lang$core$List$sortBy,
										distanceScore,
										A2(_user$project$LocEqn$locEqnTemplateConstantFillings, _user$project$LocEqn$littleConstants, locsFilledTemplate)));
							},
							A2(
								_elm_lang$core$List$concatMap,
								_user$project$LocEqn$locEqnTemplateLocFillings(locIdsAndIndex),
								A3(_user$project$LocEqn$locEqnsTemplatesOfSize, 1, 1, astSize))))));
		};
		return A2(
			_elm_lang$core$List$concatMap,
			eqnsOfSize,
			A2(_elm_lang$core$List$range, 1, 5));
	});
var _user$project$ValueBasedTransform$getIndexedLocIdsWithTarget = F2(
	function (originalExp, locsToRevolutionize) {
		var subst = _user$project$FastParser$substOf(originalExp);
		return A2(
			_user$project$Utils$mapi0,
			function (_p60) {
				var _p61 = _p60;
				return {ctor: '_Tuple3', _0: _p61._0, _1: _p61._1._0, _2: _p61._1._1};
			},
			A2(
				_elm_lang$core$List$sortBy,
				_elm_lang$core$Tuple$second,
				A2(
					_elm_lang$core$List$map,
					function (_p62) {
						var _p63 = _p62;
						var _p64 = _p63._0;
						return {
							ctor: '_Tuple2',
							_0: _p64,
							_1: A3(_user$project$Utils$justGet_, 'ValueBasedTransform.stormTheBastille sortedLocs', _p64, subst)
						};
					},
					locsToRevolutionize)));
	});
var _user$project$ValueBasedTransform$evalToSlateAndWidgetsResult = F4(
	function (exp, slideNumber, movieNumber, movieTime) {
		return A2(
			_elm_lang$core$Result$andThen,
			function (_p65) {
				var _p66 = _p65;
				return A2(
					_elm_lang$core$Result$map,
					function (tree) {
						return {ctor: '_Tuple2', _0: tree, _1: _p66._1};
					},
					A4(_user$project$LangSvg$resolveToIndexedTree, slideNumber, movieNumber, movieTime, _p66._0));
			},
			_user$project$Eval$run(exp));
	});
var _user$project$ValueBasedTransform$indexedRelate = F7(
	function (originalExp, selectedFeatures, selectedShapes, slideNumber, movieNumber, movieTime, syncOptions) {
		var _p67 = A4(_user$project$ValueBasedTransform$evalToSlateAndWidgetsResult, originalExp, slideNumber, movieNumber, movieTime);
		if (_p67.ctor === 'Err') {
			return {ctor: '[]'};
		} else {
			var _p76 = _p67._0._0;
			var _p68 = _p76;
			var tree = _p68._1;
			var featuresToRevolutionize = (_elm_lang$core$Native_Utils.cmp(
				_elm_lang$core$Set$size(selectedFeatures),
				0) > 0) ? _elm_lang$core$Set$toList(selectedFeatures) : A2(
				_elm_lang$core$List$concatMap,
				function (nodeId) {
					var _p69 = A3(_user$project$LangSvg$justGetSvgNode, 'ValueBasedTransform.indexedRelate', nodeId, _p76);
					var kind = _p69._0;
					var attrs = _p69._1;
					return A2(
						_elm_lang$core$List$map,
						function (featureString) {
							return {ctor: '_Tuple2', _0: nodeId, _1: featureString};
						},
						A2(
							_elm_lang$core$List$take,
							1,
							A2(
								_elm_lang$core$List$map,
								_user$project$ShapeWidgets$strFeatureNum(kind),
								A2(
									_elm_lang$core$List$concatMap,
									_user$project$ShapeWidgets$featureNumsOfFeature,
									A2(_user$project$ShapeWidgets$featuresOfShape, kind, attrs)))));
				},
				_elm_lang$core$Set$toList(selectedShapes));
			var locsToRevolutionize = function () {
				var locIdToNumberAndLoc = _user$project$ValueBasedTransform$locIdToNumberAndLocOf(originalExp);
				var featureEqns = A2(
					_elm_lang$core$Maybe$withDefault,
					{ctor: '[]'},
					_user$project$Utils$projJusts(
						A2(
							_elm_lang$core$List$map,
							function (feature) {
								return A4(_user$project$ValueBasedTransform$nodeIdAndFeatureNameToEquation, feature, tree, _p67._0._1, locIdToNumberAndLoc);
							},
							featuresToRevolutionize)));
				var isRevolutionizable = function (featureEqn) {
					return _elm_lang$core$Native_Utils.eq(
						_elm_lang$core$List$length(
							A2(_user$project$ValueBasedTransform$equationLocs, syncOptions, featureEqn)),
						1);
				};
				if (A2(_elm_lang$core$List$all, isRevolutionizable, featureEqns)) {
					var locs = A2(
						_elm_lang$core$List$concatMap,
						_user$project$ValueBasedTransform$equationLocs(syncOptions),
						featureEqns);
					return _elm_lang$core$Native_Utils.eq(
						locs,
						_user$project$Utils$dedupByEquality(locs)) ? locs : {ctor: '[]'};
				} else {
					return {ctor: '[]'};
				}
			}();
			var subst = _user$project$FastParser$substOf(originalExp);
			var indexedLocIdsWithTarget = A2(_user$project$ValueBasedTransform$getIndexedLocIdsWithTarget, originalExp, locsToRevolutionize);
			var possibleEqns = A2(_user$project$ValueBasedTransform$stormTheBastille, subst, indexedLocIdsWithTarget);
			var _p70 = _user$project$Utils$unzip3(indexedLocIdsWithTarget);
			var locIds = _p70._1;
			var targets = _p70._2;
			var locEIds = A2(
				_elm_lang$core$List$map,
				function (locId) {
					return A2(
						_user$project$Utils$fromJust_,
						'ValueBasedTransform.liftLocsSoVisibleTo locEIds',
						A2(_user$project$Lang$locIdToEId, originalExp, locId));
				},
				locIds);
			return A2(
				_elm_lang$core$List$map,
				function (eqn) {
					var eqnLocIds = _user$project$LocEqn$locEqnLocIdSet(eqn);
					var locsToLift = A2(
						_elm_lang$core$List$filter,
						function (_p71) {
							var _p72 = _p71;
							return A2(_elm_lang$core$Set$member, _p72._0, eqnLocIds);
						},
						locsToRevolutionize);
					var _p73 = A3(
						_user$project$ValueBasedTransform$liftLocsSoVisibleTo,
						originalExp,
						_elm_lang$core$Set$fromList(locsToLift),
						_elm_lang$core$Set$fromList(locEIds));
					var locsLifted = _p73._0;
					var locIdToNewName = _p73._1;
					var description = function () {
						var eqnDesc = _user$project$LangUnparser$unparse(
							A4(
								_user$project$LocEqn$locEqnToExp,
								_user$project$Lang$unann,
								_elm_lang$core$Dict$empty,
								A3(_elm_lang$core$Dict$insert, _user$project$ValueBasedTransform$indexLocId, 'i', locIdToNewName),
								eqn));
						var locDescs = A2(
							_elm_lang$core$List$map,
							_user$project$LangTools$locDescription(originalExp),
							locsToRevolutionize);
						return A2(
							_elm_lang$core$Basics_ops['++'],
							'compute ',
							A2(
								_elm_lang$core$Basics_ops['++'],
								A2(_elm_lang$core$String$join, ', ', locDescs),
								A2(_elm_lang$core$Basics_ops['++'], ' by ', eqnDesc)));
					}();
					var newExp = A3(
						_user$project$Utils$foldli0,
						F2(
							function (_p74, priorExp) {
								var _p75 = _p74;
								var eqnExp = A4(
									_user$project$LocEqn$locEqnToExp,
									_user$project$Lang$unann,
									A2(
										_elm_lang$core$Dict$singleton,
										_user$project$ValueBasedTransform$indexLocId,
										_elm_lang$core$Basics$toFloat(_p75._0)),
									locIdToNewName,
									eqn);
								return A3(_user$project$Lang$replaceExpNodeE__ByEId, _p75._1, eqnExp.val.e__, priorExp);
							}),
						locsLifted,
						locEIds);
					var distanceScore = A3(_user$project$ValueBasedTransform$indexedRelateDistanceScore, subst, indexedLocIdsWithTarget, eqn);
					return _user$project$InterfaceModel$SynthesisResult(
						{
							description: description,
							exp: newExp,
							isSafe: true,
							sortKey: {
								ctor: '::',
								_0: distanceScore,
								_1: {ctor: '[]'}
							},
							children: _elm_lang$core$Maybe$Nothing
						});
				},
				possibleEqns);
		}
	});
var _user$project$ValueBasedTransform$debugLog = _user$project$Config$debugLog(_user$project$Config$debugSync);
var _user$project$ValueBasedTransform$digHole = F5(
	function (originalExp, selectedFeatures, slate, widgets, syncOptions) {
		var locIdToNumberAndLoc = _user$project$ValueBasedTransform$locIdToNumberAndLocOf(originalExp);
		var selectedFeatureEquationsNamed = A2(
			_user$project$ValueBasedTransform$debugLog,
			'selectedFeatureEquations',
			A4(_user$project$ValueBasedTransform$pluckSelectedFeatureEquationsNamed, selectedFeatures, slate, widgets, locIdToNumberAndLoc));
		var locset = function () {
			var selectedVals = A2(
				_user$project$ValueBasedTransform$debugLog,
				'selectedVals',
				A4(_user$project$ValueBasedTransform$pluckSelectedVals, selectedFeatures, slate, widgets, locIdToNumberAndLoc));
			var tracesLocsets = A2(
				_elm_lang$core$List$map,
				function (_p77) {
					return A2(
						_user$project$Sync$locsOfTrace,
						syncOptions,
						_elm_lang$core$Tuple$second(_p77));
				},
				selectedVals);
			var allLocs = A3(_elm_lang$core$List$foldl, _elm_lang$core$Set$union, _elm_lang$core$Set$empty, tracesLocsets);
			var _p78 = A2(
				_elm_lang$core$Set$partition,
				function (_p79) {
					var _p80 = _p79;
					return _elm_lang$core$Native_Utils.eq(_p80._1, _user$project$Lang$thawed);
				},
				allLocs);
			var thawed = _p78._0;
			var others = _p78._1;
			return _elm_lang$core$Set$isEmpty(thawed) ? others : thawed;
		}();
		var locsetList = _elm_lang$core$Set$toList(locset);
		var subst = _user$project$FastParser$substOf(originalExp);
		var commonScope = A2(_user$project$ValueBasedTransform$deepestCommonAncestorWithNewlineByLocSet, originalExp, locset);
		var existingNames = _user$project$LangTools$identifiersSet(originalExp);
		var locIdNameOrigNamePrime = function () {
			var _p81 = A3(
				_elm_lang$core$List$foldr,
				F2(
					function (_p83, _p82) {
						var _p84 = _p83;
						var _p88 = _p84._0;
						var _p87 = _p84._2;
						var _p85 = _p82;
						var _p86 = _p85._0;
						var baseIdent = A2(
							_elm_lang$core$Maybe$withDefault,
							_elm_lang$core$Native_Utils.eq(_p87, '') ? 'num' : _p87,
							A2(
								_elm_lang$core$Maybe$map,
								_user$project$LangTools$expNameForEId(originalExp),
								A2(_user$project$Lang$locIdToEId, originalExp, _p88)));
						var scopeNamesLiftedThrough = A2(
							_user$project$LangTools$scopeNamesLocLiftedThrough,
							commonScope,
							{ctor: '_Tuple3', _0: _p88, _1: _p84._1, _2: _p87});
						var scopesAndBaseIdent = A2(
							_elm_lang$core$String$join,
							'_',
							A2(
								_elm_lang$core$Basics_ops['++'],
								scopeNamesLiftedThrough,
								{
									ctor: '::',
									_0: baseIdent,
									_1: {ctor: '[]'}
								}));
						var baseIdentOrig = _elm_lang$core$Native_Utils.eq(scopesAndBaseIdent, baseIdent) ? A2(_elm_lang$core$Basics_ops['++'], baseIdent, '_orig') : scopesAndBaseIdent;
						var baseIdentPrime = A2(_elm_lang$core$Basics_ops['++'], scopesAndBaseIdent, '\'');
						var identOrig = A3(_user$project$LangTools$nonCollidingName, baseIdentOrig, 2, _p86);
						var identPrime = A3(_user$project$LangTools$nonCollidingName, baseIdentPrime, 2, _p86);
						return {
							ctor: '_Tuple2',
							_0: A2(
								_elm_lang$core$Set$union,
								_p86,
								_elm_lang$core$Set$fromList(
									{
										ctor: '::',
										_0: identOrig,
										_1: {
											ctor: '::',
											_0: identPrime,
											_1: {ctor: '[]'}
										}
									})),
							_1: {
								ctor: '::',
								_0: {ctor: '_Tuple3', _0: _p88, _1: identOrig, _2: identPrime},
								_1: _p85._1
							}
						};
					}),
				{
					ctor: '_Tuple2',
					_0: existingNames,
					_1: {ctor: '[]'}
				},
				locsetList);
			var result = _p81._1;
			return result;
		}();
		var newNames = A2(
			_elm_lang$core$List$concatMap,
			function (_p89) {
				var _p90 = _p89;
				return {
					ctor: '::',
					_0: _p90._1,
					_1: {
						ctor: '::',
						_0: _p90._2,
						_1: {ctor: '[]'}
					}
				};
			},
			locIdNameOrigNamePrime);
		var namesToAvoid = A2(
			_elm_lang$core$Set$union,
			existingNames,
			_elm_lang$core$Set$fromList(newNames));
		var locIdToNewName = A2(
			_user$project$ValueBasedTransform$debugLog,
			'locIdToNewName',
			_elm_lang$core$Dict$fromList(
				A2(
					_elm_lang$core$List$map,
					function (_p91) {
						var _p92 = _p91;
						return {ctor: '_Tuple2', _0: _p92._0, _1: _p92._2};
					},
					locIdNameOrigNamePrime)));
		var origNames = _elm_lang$core$List$reverse(
			A2(_elm_lang$core$List$map, _user$project$Utils$snd3, locIdNameOrigNamePrime));
		var primeNames = _elm_lang$core$List$reverse(
			A2(_elm_lang$core$List$map, _user$project$Utils$thd3, locIdNameOrigNamePrime));
		var valueExps = A2(
			_elm_lang$core$List$map,
			function (_p93) {
				var _p94 = _p93;
				return A2(
					_user$project$Utils$fromJust_,
					'ValueBasedTransform.digHole valueExps',
					A2(_user$project$Lang$findExpByLocId, commonScope, _p94._0));
			},
			_elm_lang$core$List$reverse(locsetList));
		var selectedFeatureEquationsNamedWithScopes = A2(
			_elm_lang$core$List$map,
			function (_p95) {
				var _p96 = _p95;
				var _p97 = _p96._1;
				var featureLocs = A2(_user$project$ValueBasedTransform$equationLocs, syncOptions, _p97);
				var scopeNamesLocsLiftedThrough = A2(
					_elm_lang$core$List$map,
					_user$project$LangTools$scopeNamesLocLiftedThrough(commonScope),
					featureLocs);
				var commonScopeNamesLocsLiftedThrough = _user$project$Utils$commonPrefix(scopeNamesLocsLiftedThrough);
				var featureName_ = A2(
					_elm_lang$core$String$join,
					'_',
					A2(
						_elm_lang$core$Basics_ops['++'],
						commonScopeNamesLocsLiftedThrough,
						{
							ctor: '::',
							_0: _p96._0,
							_1: {ctor: '[]'}
						}));
				return {ctor: '_Tuple2', _0: featureName_, _1: _p97};
			},
			selectedFeatureEquationsNamed);
		var featureNamesWithExpressionExps = function () {
			var locIdToOrigName = _elm_lang$core$Dict$fromList(
				A2(
					_elm_lang$core$List$map,
					function (_p98) {
						var _p99 = _p98;
						return {ctor: '_Tuple2', _0: _p99._0, _1: _p99._1};
					},
					locIdNameOrigNamePrime));
			return A2(
				_elm_lang$core$List$map,
				_elm_lang$core$Tuple$mapSecond(
					A2(_user$project$ValueBasedTransform$equationToExp, subst, locIdToOrigName)),
				selectedFeatureEquationsNamedWithScopes);
		}();
		var significantFeatureNamesWithExpressionExps = A2(
			_elm_lang$core$List$filter,
			function (_p100) {
				var _p101 = _p100;
				return _elm_lang$core$Native_Utils.cmp(
					_user$project$LangTools$nodeCount(_p101._1),
					1) > 0;
			},
			featureNamesWithExpressionExps);
		var featureNames = A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$first, significantFeatureNamesWithExpressionExps);
		var featureExpressionExps = A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$second, significantFeatureNamesWithExpressionExps);
		var nonCollidingFeatureNames = function () {
			var _p102 = A3(
				_elm_lang$core$List$foldr,
				F2(
					function (featureName, _p103) {
						var _p104 = _p103;
						var _p105 = _p104._0;
						var featureName_ = A3(_user$project$LangTools$nonCollidingName, featureName, 2, _p105);
						return {
							ctor: '_Tuple2',
							_0: A2(_elm_lang$core$Set$insert, featureName_, _p105),
							_1: {ctor: '::', _0: featureName_, _1: _p104._1}
						};
					}),
				{
					ctor: '_Tuple2',
					_0: namesToAvoid,
					_1: {ctor: '[]'}
				},
				featureNames);
			var newNamesToAvoid = _p102._0;
			var result = _p102._1;
			return result;
		}();
		var listOfListsOfNamesAndAssigns = {
			ctor: '::',
			_0: A2(_user$project$Utils$zip, origNames, valueExps),
			_1: {
				ctor: '::',
				_0: A2(_user$project$Utils$zip, nonCollidingFeatureNames, featureExpressionExps),
				_1: {
					ctor: '::',
					_0: A2(
						_user$project$Utils$zip,
						primeNames,
						_user$project$Lang$listOfVars(origNames)),
					_1: {ctor: '[]'}
				}
			}
		};
		var newExp = A4(_user$project$ValueBasedTransform$variableifyConstantsAndWrapTargetExpWithLets, locIdToNewName, listOfListsOfNamesAndAssigns, commonScope, originalExp);
		return newExp;
	});
var _user$project$ValueBasedTransform$Relate = {ctor: 'Relate'};
var _user$project$ValueBasedTransform$relate__ = F5(
	function (relateType, originalExp, featureAEqn, featureBEqn, syncOptions) {
		var frozenLocIdToNum = _elm_lang$core$Dict$fromList(
			A2(
				_elm_lang$core$Basics_ops['++'],
				_user$project$LangTools$frozenLocIdsAndNumbers(originalExp),
				_user$project$LangTools$frozenLocIdsAndNumbers(_user$project$FastParser$prelude)));
		var aUnfrozenLocset = _elm_lang$core$Set$fromList(
			A2(_user$project$ValueBasedTransform$equationLocs, syncOptions, featureAEqn));
		var bUnfrozenLocset = _elm_lang$core$Set$fromList(
			A2(_user$project$ValueBasedTransform$equationLocs, syncOptions, featureBEqn));
		var unfrozenLocset = A2(_elm_lang$core$Set$union, aUnfrozenLocset, bUnfrozenLocset);
		var aSignificantUnfrozenLocIdSet = _user$project$LocEqn$locEqnLocIdSet(
			_user$project$LocEqn$normalizeSimplify(
				A2(
					_user$project$LocEqn$constantifyLocs,
					frozenLocIdToNum,
					_user$project$ValueBasedTransform$featureEquationToLocEquation(featureAEqn))));
		var bSignificantUnfrozenLocIdSet = _user$project$LocEqn$locEqnLocIdSet(
			_user$project$LocEqn$normalizeSimplify(
				A2(
					_user$project$LocEqn$constantifyLocs,
					frozenLocIdToNum,
					_user$project$ValueBasedTransform$featureEquationToLocEquation(featureBEqn))));
		var sharedSignificantUnfrozenLocIdSet = A2(_elm_lang$core$Set$intersect, aSignificantUnfrozenLocIdSet, bSignificantUnfrozenLocIdSet);
		var subst = _user$project$FastParser$substOf(originalExp);
		var thawedLocsFirst = function () {
			var _p106 = A2(
				_elm_lang$core$List$partition,
				function (_p107) {
					var _p108 = _p107;
					return _elm_lang$core$Native_Utils.eq(_p108._1, _user$project$Lang$thawed);
				},
				_elm_lang$core$Set$toList(unfrozenLocset));
			var thawed = _p106._0;
			var others = _p106._1;
			return A2(_elm_lang$core$Basics_ops['++'], thawed, others);
		}();
		var solutionsForLoc = function (dependentLoc) {
			var _p109 = dependentLoc;
			var dependentLocId = _p109._0;
			var dependentFrozen = _p109._1;
			var dependentIdent = _p109._2;
			var dependentIdentDesc = A2(_user$project$LangTools$locDescription, originalExp, dependentLoc);
			var _p110 = relateType;
			if (_p110.ctor === 'Equalize') {
				var _p111 = A5(_user$project$ValueBasedTransform$solveForLoc, dependentLocId, frozenLocIdToNum, subst, featureAEqn, featureBEqn);
				if (_p111.ctor === 'Nothing') {
					return {ctor: '[]'};
				} else {
					return {
						ctor: '::',
						_0: {
							ctor: '_Tuple2',
							_0: _p111._0,
							_1: A2(_elm_lang$core$Basics_ops['++'], 'by removing ', dependentIdentDesc)
						},
						_1: {ctor: '[]'}
					};
				}
			} else {
				var independentLocIdSet = A2(_elm_lang$core$Set$member, dependentLocId, sharedSignificantUnfrozenLocIdSet) ? _elm_lang$core$Set$empty : (A2(_elm_lang$core$Set$member, dependentLocId, aSignificantUnfrozenLocIdSet) ? bSignificantUnfrozenLocIdSet : (A2(_elm_lang$core$Set$member, dependentLocId, bSignificantUnfrozenLocIdSet) ? aSignificantUnfrozenLocIdSet : _elm_lang$core$Set$empty));
				var targetValue = A3(_user$project$Utils$justGet_, 'ValueBasedTransform.relate__ targetValue', dependentLocId, subst);
				var isGoodEnough = function (locEqn) {
					if (_elm_lang$core$Native_Utils.eq(
						_elm_lang$core$Set$size(
							_user$project$LocEqn$locEqnLocIdSet(locEqn)),
						0)) {
						return false;
					} else {
						var diff = A2(_user$project$LocEqn$locEqnEval, subst, locEqn) - targetValue;
						return _elm_lang$core$Native_Utils.eq(targetValue, 0) ? _elm_lang$core$Native_Utils.eq(diff, 0) : (_elm_lang$core$Native_Utils.cmp(
							_elm_lang$core$Basics$abs(diff / targetValue),
							0.2) < 0);
					}
				};
				var synthesizeMore = F2(
					function (astSize, results) {
						if (false) {
							return results;
						} else {
							var newEqns = A2(
								_elm_lang$core$List$filter,
								function (locEqn) {
									return _elm_lang$core$Native_Utils.cmp(
										_user$project$LocEqn$locEqnSize(locEqn),
										astSize) > -1;
								},
								A2(
									_elm_lang$core$List$map,
									_user$project$LocEqn$normalizeSimplify,
									A2(
										_elm_lang$core$List$filter,
										isGoodEnough,
										A2(
											_elm_lang$core$List$concatMap,
											function (template) {
												return A4(_user$project$LocEqn$locEqnTemplateFillings, targetValue, subst, independentLocIdSet, template);
											},
											A3(_user$project$LocEqn$locEqnsTemplatesOfSize, 1, 1, astSize)))));
							return _user$project$Utils$dedupByEquality(
								A2(_elm_lang$core$Basics_ops['++'], results, newEqns));
						}
					});
				var resultEqns = A3(
					_elm_lang$core$List$foldl,
					synthesizeMore,
					{ctor: '[]'},
					A2(_elm_lang$core$List$range, 1, 5));
				return A2(
					_elm_lang$core$List$map,
					function (resultLocEqn) {
						return {
							ctor: '_Tuple2',
							_0: resultLocEqn,
							_1: A2(_elm_lang$core$Basics_ops['++'], dependentIdentDesc, ' = ')
						};
					},
					resultEqns);
			}
		};
		return A2(
			_elm_lang$core$List$concatMap,
			function (dependentLoc) {
				var _p112 = dependentLoc;
				var dependentLocId = _p112._0;
				var dependentFrozen = _p112._1;
				var dependentIdent = _p112._2;
				return A2(
					_elm_lang$core$List$map,
					function (_p113) {
						var _p114 = _p113;
						var _p131 = _p114._0;
						var _p130 = _p114._1;
						var locIdSet = A2(
							_elm_lang$core$Set$insert,
							dependentLocId,
							_user$project$LocEqn$locEqnLocIdSet(_p131));
						var locsetToDig = A2(
							_elm_lang$core$Set$filter,
							function (_p115) {
								var _p116 = _p115;
								return A2(_elm_lang$core$Set$member, _p116._0, locIdSet);
							},
							unfrozenLocset);
						var commonScope = A2(_user$project$ValueBasedTransform$deepestCommonAncestorWithNewlineByLocSet, originalExp, locsetToDig);
						var existingNames = _user$project$LangTools$identifiersSet(commonScope);
						var independentLocs = A2(
							_elm_lang$core$List$filter,
							function (_p117) {
								var _p118 = _p117;
								return !_elm_lang$core$Native_Utils.eq(_p118._0, dependentLocId);
							},
							_elm_lang$core$Set$toList(locsetToDig));
						var independentLocIds = A2(_elm_lang$core$List$map, _user$project$Utils$fst3, independentLocs);
						var locIdToNewName = function () {
							var _p119 = A3(
								_elm_lang$core$List$foldr,
								F2(
									function (_p121, _p120) {
										var _p122 = _p121;
										var _p126 = _p122._0;
										var _p125 = _p122._2;
										var _p123 = _p120;
										var _p124 = _p123._0;
										var baseIdent = A2(
											_elm_lang$core$Maybe$withDefault,
											_elm_lang$core$Native_Utils.eq(_p125, '') ? 'num' : _p125,
											A2(
												_elm_lang$core$Maybe$map,
												_user$project$LangTools$expNameForEId(originalExp),
												A2(_user$project$Lang$locIdToEId, originalExp, _p126)));
										var scopeNamesLiftedThrough = A2(
											_user$project$LangTools$scopeNamesLocLiftedThrough,
											commonScope,
											{ctor: '_Tuple3', _0: _p126, _1: _p122._1, _2: _p125});
										var scopesAndBaseIdent = A2(
											_elm_lang$core$String$join,
											'_',
											A2(
												_elm_lang$core$Basics_ops['++'],
												scopeNamesLiftedThrough,
												{
													ctor: '::',
													_0: baseIdent,
													_1: {ctor: '[]'}
												}));
										var ident = _elm_lang$core$Native_Utils.eq(_p126, dependentLocId) ? A3(
											_user$project$LangTools$nonCollidingName,
											A2(_elm_lang$core$Basics_ops['++'], baseIdent, '\''),
											2,
											_p124) : (_elm_lang$core$Native_Utils.eq(scopesAndBaseIdent, baseIdent) ? A3(
											_user$project$LangTools$nonCollidingName,
											A2(_elm_lang$core$Basics_ops['++'], baseIdent, '_orig'),
											2,
											_p124) : A3(_user$project$LangTools$nonCollidingName, scopesAndBaseIdent, 2, _p124));
										return {
											ctor: '_Tuple2',
											_0: A2(_elm_lang$core$Set$insert, ident, _p124),
											_1: {
												ctor: '::',
												_0: {ctor: '_Tuple2', _0: _p126, _1: ident},
												_1: _p123._1
											}
										};
									}),
								{
									ctor: '_Tuple2',
									_0: existingNames,
									_1: {ctor: '[]'}
								},
								{ctor: '::', _0: dependentLoc, _1: independentLocs});
							var result = _p119._1;
							return _elm_lang$core$Dict$fromList(result);
						}();
						var independentLocNames = A2(
							_elm_lang$core$List$map,
							function (locId) {
								return A3(_user$project$Utils$justGet_, 'ValueBasedTransform.relate__ independentLocNames', locId, locIdToNewName);
							},
							independentLocIds);
						var independentLocExps = A2(
							_elm_lang$core$List$map,
							function (_p127) {
								var _p128 = _p127;
								return A2(
									_user$project$Utils$fromJust_,
									'ValueBasedTransform.relate__ independentLocValues',
									A2(_user$project$Lang$findExpByLocId, commonScope, _p128._0));
							},
							independentLocs);
						var dependentLocNameStr = A3(_user$project$Utils$justGet_, 'ValueBasedTransform.relate__ dependentLocNameStr', dependentLocId, locIdToNewName);
						var dependentLocExp = function () {
							var constantAnnotation = _elm_lang$core$Native_Utils.eq(relateType, _user$project$ValueBasedTransform$Relate) ? _user$project$Lang$unann : _user$project$Lang$frozen;
							return A4(_user$project$LocEqn$locEqnToExp, constantAnnotation, frozenLocIdToNum, locIdToNewName, _p131);
						}();
						var listOfListsOfNamesAndAssigns = {
							ctor: '::',
							_0: A2(_user$project$Utils$zip, independentLocNames, independentLocExps),
							_1: {
								ctor: '::',
								_0: {
									ctor: '::',
									_0: {ctor: '_Tuple2', _0: dependentLocNameStr, _1: dependentLocExp},
									_1: {ctor: '[]'}
								},
								_1: {ctor: '[]'}
							}
						};
						var newExp = A4(_user$project$ValueBasedTransform$variableifyConstantsAndWrapTargetExpWithLets, locIdToNewName, listOfListsOfNamesAndAssigns, commonScope, originalExp);
						var _p129 = relateType;
						if (_p129.ctor === 'Equalize') {
							return {
								description: _p130,
								exp: newExp,
								sortKey: {ctor: '[]'},
								dependentLocIds: {
									ctor: '::',
									_0: dependentLocId,
									_1: {ctor: '[]'}
								}
							};
						} else {
							return {
								description: A2(
									_elm_lang$core$Basics_ops['++'],
									_p130,
									_user$project$LangUnparser$unparse(dependentLocExp)),
								exp: newExp,
								sortKey: {ctor: '[]'},
								dependentLocIds: {
									ctor: '::',
									_0: dependentLocId,
									_1: {ctor: '[]'}
								}
							};
						}
					},
					solutionsForLoc(dependentLoc));
			},
			thawedLocsFirst);
	});
var _user$project$ValueBasedTransform$relate_ = F7(
	function (relateType, originalExp, featureA, featureB, slate, widgets, syncOptions) {
		var _p132 = slate;
		var tree = _p132._1;
		var locIdToNumberAndLoc = _user$project$ValueBasedTransform$locIdToNumberAndLocOf(originalExp);
		var featureDescription = F2(
			function (_p133, tree) {
				var _p134 = _p133;
				return _p134._1;
			});
		var _p135 = {
			ctor: '_Tuple2',
			_0: A4(_user$project$ValueBasedTransform$nodeIdAndFeatureNameToEquation, featureA, tree, widgets, locIdToNumberAndLoc),
			_1: A4(_user$project$ValueBasedTransform$nodeIdAndFeatureNameToEquation, featureB, tree, widgets, locIdToNumberAndLoc)
		};
		if (_p135._0.ctor === 'Nothing') {
			return {ctor: '[]'};
		} else {
			if (_p135._1.ctor === 'Nothing') {
				return {ctor: '[]'};
			} else {
				var descriptionPrefix = function () {
					var _p136 = relateType;
					if (_p136.ctor === 'Equalize') {
						return A2(
							_elm_lang$core$Basics_ops['++'],
							A2(featureDescription, featureA, tree),
							A2(
								_elm_lang$core$Basics_ops['++'],
								' = ',
								A2(
									_elm_lang$core$Basics_ops['++'],
									A2(featureDescription, featureB, tree),
									' ')));
					} else {
						return '';
					}
				}();
				return A2(
					_elm_lang$core$List$map,
					_user$project$InterfaceModel$prependDescription(descriptionPrefix),
					A5(_user$project$ValueBasedTransform$relate__, relateType, originalExp, _p135._0._0, _p135._1._0, syncOptions));
			}
		}
	});
var _user$project$ValueBasedTransform$relateOverlappingPairs = F7(
	function (relateType, priorResults, features, slideNumber, movieNumber, movieTime, syncOptions) {
		var relateMore = function (results) {
			var _p137 = features;
			if (_p137.ctor === '::') {
				return A7(_user$project$ValueBasedTransform$relateOverlappingPairs, relateType, results, _p137._1, slideNumber, movieNumber, movieTime, syncOptions);
			} else {
				return _elm_lang$core$Native_Utils.crashCase(
					'ValueBasedTransform',
					{
						start: {line: 396, column: 5},
						end: {line: 402, column: 56}
					},
					_p137)('relateOverlappingPairs relateMore');
			}
		};
		var _p139 = A2(_elm_lang$core$List$take, 2, features);
		if (((_p139.ctor === '::') && (_p139._1.ctor === '::')) && (_p139._1._1.ctor === '[]')) {
			return A2(
				_elm_lang$core$List$concatMap,
				function (_p140) {
					var _p141 = _p140;
					var _p145 = _p141.description;
					var _p144 = _p141.dependentLocIds;
					var priorExp = _p141.exp;
					var _p142 = A4(_user$project$ValueBasedTransform$evalToSlateAndWidgetsResult, priorExp, slideNumber, movieNumber, movieTime);
					if (_p142.ctor === 'Err') {
						return {ctor: '[]'};
					} else {
						var newResults = A7(_user$project$ValueBasedTransform$relate_, relateType, priorExp, _p139._0, _p139._1._0, _p142._0._0, _p142._0._1, syncOptions);
						var _p143 = newResults;
						if (_p143.ctor === '[]') {
							return relateMore(
								{
									ctor: '::',
									_0: {description: _p145, exp: priorExp, sortKey: _p141.sortKey, dependentLocIds: _p144},
									_1: {ctor: '[]'}
								});
						} else {
							return relateMore(
								A2(
									_elm_lang$core$List$map,
									function (result) {
										return _elm_lang$core$Native_Utils.update(
											result,
											{
												dependentLocIds: A2(_elm_lang$core$Basics_ops['++'], _p144, result.dependentLocIds)
											});
									},
									A2(
										_elm_lang$core$List$map,
										_user$project$InterfaceModel$prependDescription(
											A2(_elm_lang$core$Basics_ops['++'], _p145, ' -> ')),
										newResults)));
						}
					}
				},
				priorResults);
		} else {
			return priorResults;
		}
	});
var _user$project$ValueBasedTransform$synthesizeRelation = F7(
	function (relateType, originalExp, selectedFeatures, slideNumber, movieNumber, movieTime, syncOptions) {
		var relateByPairs = F2(
			function (priorResults, features) {
				return A7(_user$project$ValueBasedTransform$relateOverlappingPairs, relateType, priorResults, features, slideNumber, movieNumber, movieTime, syncOptions);
			});
		var selectedPoints = _user$project$ValueBasedTransform$featurePoints(
			_elm_lang$core$Set$toList(selectedFeatures));
		var startingResult = {
			description: 'Original',
			exp: originalExp,
			sortKey: {ctor: '[]'},
			dependentLocIds: {ctor: '[]'}
		};
		if (_elm_lang$core$Native_Utils.eq(
			2 * _elm_lang$core$List$length(selectedPoints),
			_elm_lang$core$Set$size(selectedFeatures))) {
			var xFeatures = A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$first, selectedPoints);
			var yFeatures = A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$second, selectedPoints);
			var xsEqualized = A2(
				relateByPairs,
				{
					ctor: '::',
					_0: startingResult,
					_1: {ctor: '[]'}
				},
				xFeatures);
			var xysEqualized = A2(relateByPairs, xsEqualized, yFeatures);
			return A2(_user$project$ValueBasedTransform$rankComparedTo, originalExp, xysEqualized);
		} else {
			return A2(
				_user$project$ValueBasedTransform$rankComparedTo,
				originalExp,
				A2(
					relateByPairs,
					{
						ctor: '::',
						_0: startingResult,
						_1: {ctor: '[]'}
					},
					_elm_lang$core$Set$toList(selectedFeatures)));
		}
	});
var _user$project$ValueBasedTransform$relate = _user$project$ValueBasedTransform$synthesizeRelation(_user$project$ValueBasedTransform$Relate);
var _user$project$ValueBasedTransform$Equalize = {ctor: 'Equalize'};
var _user$project$ValueBasedTransform$makeEqual = _user$project$ValueBasedTransform$synthesizeRelation(_user$project$ValueBasedTransform$Equalize);

var _user$project$ExpressionBasedTransform$annotatedNumToComparable = function (_p0) {
	var _p1 = _p0;
	var _p4 = _p1._0;
	var _p3 = _p1._1;
	var _p2 = _p1._2.val;
	switch (_p2.ctor) {
		case 'IntSlider':
			return {
				ctor: '_Tuple4',
				_0: _p4,
				_1: _p3,
				_2: _elm_lang$core$Basics$toFloat(_p2._0.val),
				_3: _elm_lang$core$Basics$toFloat(_p2._2.val)
			};
		case 'NumSlider':
			return {ctor: '_Tuple4', _0: _p4, _1: _p3, _2: _p2._0.val, _3: _p2._2.val};
		default:
			return {ctor: '_Tuple4', _0: _p4, _1: _p3, _2: 1, _3: -1};
	}
};
var _user$project$ExpressionBasedTransform$mergeTypes = F2(
	function (tFirst, tRest) {
		return A2(
			_elm_lang$core$List$all,
			_user$project$Types$equal(tFirst),
			tRest) ? _elm_lang$core$Maybe$Just(
			{ctor: '_Tuple0'}) : _elm_lang$core$Maybe$Nothing;
	});
var _user$project$ExpressionBasedTransform$matchAllAndBind = F3(
	function (f, xs, g) {
		return A2(
			_user$project$Utils$bindMaybe,
			g,
			_user$project$Utils$projJusts(
				A2(_elm_lang$core$List$map, f, xs)));
	});
var _user$project$ExpressionBasedTransform$matchAllAndCheckEqual = F3(
	function (f, xs, x) {
		var g = function (ys) {
			return A2(
				_elm_lang$core$List$all,
				F2(
					function (x, y) {
						return _elm_lang$core$Native_Utils.eq(x, y);
					})(x),
				ys) ? _elm_lang$core$Maybe$Just(
				{ctor: '_Tuple0'}) : _elm_lang$core$Maybe$Nothing;
		};
		return A3(_user$project$ExpressionBasedTransform$matchAllAndBind, f, xs, g);
	});
var _user$project$ExpressionBasedTransform$mergePatterns = F2(
	function (pFirst, pRest) {
		var _p5 = pFirst.val.p__;
		switch (_p5.ctor) {
			case 'PVar':
				var match = function (pNext) {
					var _p6 = pNext.val.p__;
					if (_p6.ctor === 'PVar') {
						return _elm_lang$core$Maybe$Just(_p6._1);
					} else {
						return _elm_lang$core$Maybe$Nothing;
					}
				};
				return A3(_user$project$ExpressionBasedTransform$matchAllAndCheckEqual, match, pRest, _p5._1);
			case 'PConst':
				var match = function (pNext) {
					var _p7 = pNext.val.p__;
					if (_p7.ctor === 'PConst') {
						return _elm_lang$core$Maybe$Just(_p7._1);
					} else {
						return _elm_lang$core$Maybe$Nothing;
					}
				};
				return A3(_user$project$ExpressionBasedTransform$matchAllAndCheckEqual, match, pRest, _p5._1);
			case 'PBase':
				var match = function (pNext) {
					var _p8 = pNext.val.p__;
					if (_p8.ctor === 'PBase') {
						return _elm_lang$core$Maybe$Just(_p8._1);
					} else {
						return _elm_lang$core$Maybe$Nothing;
					}
				};
				return A3(_user$project$ExpressionBasedTransform$matchAllAndCheckEqual, match, pRest, _p5._1);
			case 'PList':
				var match = function (pNext) {
					var _p9 = pNext.val.p__;
					if (_p9.ctor === 'PList') {
						return _elm_lang$core$Maybe$Just(
							{ctor: '_Tuple2', _0: _p9._1, _1: _p9._3});
					} else {
						return _elm_lang$core$Maybe$Nothing;
					}
				};
				return A3(
					_user$project$ExpressionBasedTransform$matchAllAndBind,
					match,
					pRest,
					function (stuff) {
						var _p10 = _elm_lang$core$List$unzip(stuff);
						var psList = _p10._0;
						var mpList = _p10._1;
						return A3(
							_user$project$Utils$bindMaybe2,
							F2(
								function (_p12, _p11) {
									var _p13 = _p11;
									return _elm_lang$core$Maybe$Just(
										{ctor: '_Tuple0'});
								}),
							_user$project$ExpressionBasedTransform$mergePatternLists(
								{ctor: '::', _0: _p5._1, _1: psList}),
							A2(_user$project$ExpressionBasedTransform$mergeMaybePatterns, _p5._3, mpList));
					});
			default:
				var match = function (pNext) {
					var _p14 = pNext.val.p__;
					if (_p14.ctor === 'PAs') {
						return _elm_lang$core$Maybe$Just(
							{ctor: '_Tuple2', _0: _p14._1, _1: _p14._3});
					} else {
						return _elm_lang$core$Maybe$Nothing;
					}
				};
				return A3(
					_user$project$ExpressionBasedTransform$matchAllAndBind,
					match,
					pRest,
					function (stuff) {
						var _p15 = _elm_lang$core$List$unzip(stuff);
						var indentList = _p15._0;
						var pList = _p15._1;
						return A2(
							_user$project$Utils$bindMaybe,
							function (_p16) {
								var _p17 = _p16;
								return A2(
									_elm_lang$core$List$all,
									F2(
										function (x, y) {
											return _elm_lang$core$Native_Utils.eq(x, y);
										})(_p5._1),
									indentList) ? _elm_lang$core$Maybe$Just(
									{ctor: '_Tuple0'}) : _elm_lang$core$Maybe$Nothing;
							},
							A2(_user$project$ExpressionBasedTransform$mergePatterns, _p5._3, pList));
					});
		}
	});
var _user$project$ExpressionBasedTransform$mergeMaybePatterns = F2(
	function (mp, mps) {
		var _p18 = mp;
		if (_p18.ctor === 'Nothing') {
			return A2(
				_elm_lang$core$List$all,
				F2(
					function (x, y) {
						return _elm_lang$core$Native_Utils.eq(x, y);
					})(_elm_lang$core$Maybe$Nothing),
				mps) ? _elm_lang$core$Maybe$Just(
				{ctor: '_Tuple0'}) : _elm_lang$core$Maybe$Nothing;
		} else {
			return A2(
				_user$project$Utils$bindMaybe,
				_user$project$ExpressionBasedTransform$mergePatterns(_p18._0),
				_user$project$Utils$projJusts(mps));
		}
	});
var _user$project$ExpressionBasedTransform$mergePatternLists = function (lists) {
	var _p19 = _user$project$Utils$maybeZipN(lists);
	if (_p19.ctor === 'Nothing') {
		return _elm_lang$core$Maybe$Nothing;
	} else {
		var foo = F2(
			function (listPat, maybeAcc) {
				var _p20 = {ctor: '_Tuple2', _0: listPat, _1: maybeAcc};
				if ((((_p20.ctor === '_Tuple2') && (_p20._0.ctor === '::')) && (_p20._1.ctor === 'Just')) && (_p20._1._0.ctor === '_Tuple0')) {
					return A2(_user$project$ExpressionBasedTransform$mergePatterns, _p20._0._0, _p20._0._1);
				} else {
					return _elm_lang$core$Maybe$Nothing;
				}
			});
		return A3(
			_elm_lang$core$List$foldl,
			foo,
			_elm_lang$core$Maybe$Just(
				{ctor: '_Tuple0'}),
			_p19._0);
	}
};
var _user$project$ExpressionBasedTransform$mergeExpressions = F2(
	function (eFirst, eRest) {
		var $return = F2(
			function (e__, list) {
				return _elm_lang$core$Maybe$Just(
					{
						ctor: '_Tuple2',
						_0: A2(_user$project$Lang$replaceE__, eFirst, e__),
						_1: list
					});
			});
		var _p21 = eFirst.val.e__;
		switch (_p21.ctor) {
			case 'EConst':
				var match = function (eNext) {
					var _p22 = eNext.val.e__;
					if ((_p22.ctor === 'EConst') && (_p22._2.ctor === '_Tuple3')) {
						return _elm_lang$core$Maybe$Just(
							{ctor: '_Tuple3', _0: _p22._1, _1: _p22._2._1, _2: _p22._3});
					} else {
						return _elm_lang$core$Maybe$Nothing;
					}
				};
				return A3(
					_user$project$ExpressionBasedTransform$matchAllAndBind,
					match,
					eRest,
					function (restAnnotatedNums) {
						var _p23 = _p21._2;
						var locid = _p23._0;
						var ann = _p23._1;
						var x = _p23._2;
						var allAnnotatedNums = {
							ctor: '::',
							_0: {ctor: '_Tuple3', _0: _p21._1, _1: ann, _2: _p21._3},
							_1: restAnnotatedNums
						};
						var _p24 = A2(_user$project$Utils$dedupBy, _user$project$ExpressionBasedTransform$annotatedNumToComparable, allAnnotatedNums);
						if ((_p24.ctor === '::') && (_p24._1.ctor === '[]')) {
							return A2(
								$return,
								eFirst.val.e__,
								{ctor: '[]'});
						} else {
							var $var = _elm_lang$core$Native_Utils.eq(x, '') ? A2(
								_elm_lang$core$Basics_ops['++'],
								'k',
								_elm_lang$core$Basics$toString(locid)) : x;
							return A2(
								$return,
								A2(_user$project$Lang$EVar, _p21._0, $var),
								{
									ctor: '::',
									_0: {ctor: '_Tuple2', _0: $var, _1: allAnnotatedNums},
									_1: {ctor: '[]'}
								});
						}
					});
			case 'EBase':
				var match = function (eNext) {
					var _p25 = eNext.val.e__;
					if (_p25.ctor === 'EBase') {
						return _elm_lang$core$Maybe$Just(_p25._1);
					} else {
						return _elm_lang$core$Maybe$Nothing;
					}
				};
				return A3(
					_user$project$ExpressionBasedTransform$matchAllAndBind,
					match,
					eRest,
					function (bvs) {
						return A2(
							_elm_lang$core$List$all,
							F2(
								function (x, y) {
									return _elm_lang$core$Native_Utils.eq(x, y);
								})(_p21._1),
							bvs) ? A2(
							$return,
							eFirst.val.e__,
							{ctor: '[]'}) : _elm_lang$core$Maybe$Nothing;
					});
			case 'EVar':
				var match = function (eNext) {
					var _p26 = eNext.val.e__;
					if (_p26.ctor === 'EVar') {
						return _elm_lang$core$Maybe$Just(_p26._1);
					} else {
						return _elm_lang$core$Maybe$Nothing;
					}
				};
				return A3(
					_user$project$ExpressionBasedTransform$matchAllAndBind,
					match,
					eRest,
					function (xs) {
						return A2(
							_elm_lang$core$List$all,
							F2(
								function (x, y) {
									return _elm_lang$core$Native_Utils.eq(x, y);
								})(_p21._1),
							xs) ? A2(
							$return,
							eFirst.val.e__,
							{ctor: '[]'}) : _elm_lang$core$Maybe$Nothing;
					});
			case 'EFun':
				var _p33 = _p21._1;
				var match = function (eNext) {
					var _p27 = eNext.val.e__;
					if (_p27.ctor === 'EFun') {
						return _elm_lang$core$Maybe$Just(
							{ctor: '_Tuple2', _0: _p27._1, _1: _p27._2});
					} else {
						return _elm_lang$core$Maybe$Nothing;
					}
				};
				return A3(
					_user$project$ExpressionBasedTransform$matchAllAndBind,
					match,
					eRest,
					function (stuff) {
						var _p28 = _elm_lang$core$List$unzip(stuff);
						var psList = _p28._0;
						var eBodyList = _p28._1;
						return A3(
							_user$project$Utils$bindMaybe2,
							F2(
								function (_p30, _p29) {
									var _p31 = _p30;
									var _p32 = _p29;
									return A2(
										$return,
										A4(_user$project$Lang$EFun, _p21._0, _p33, _p32._0, _p21._3),
										_p32._1);
								}),
							_user$project$ExpressionBasedTransform$mergePatternLists(
								{ctor: '::', _0: _p33, _1: psList}),
							A2(_user$project$ExpressionBasedTransform$mergeExpressions, _p21._2, eBodyList));
					});
			case 'EApp':
				var match = function (eNext) {
					var _p34 = eNext.val.e__;
					if (_p34.ctor === 'EApp') {
						return _elm_lang$core$Maybe$Just(
							{ctor: '_Tuple2', _0: _p34._1, _1: _p34._2});
					} else {
						return _elm_lang$core$Maybe$Nothing;
					}
				};
				return A3(
					_user$project$ExpressionBasedTransform$matchAllAndBind,
					match,
					eRest,
					function (stuff) {
						var _p35 = _elm_lang$core$List$unzip(stuff);
						var eFuncList = _p35._0;
						var eArgsList = _p35._1;
						return A3(
							_user$project$Utils$bindMaybe2,
							F2(
								function (_p37, _p36) {
									var _p38 = _p37;
									var _p39 = _p36;
									return A2(
										$return,
										A4(_user$project$Lang$EApp, _p21._0, _p38._0, _p39._0, _p21._3),
										A2(_elm_lang$core$Basics_ops['++'], _p38._1, _p39._1));
								}),
							A2(_user$project$ExpressionBasedTransform$mergeExpressions, _p21._1, eFuncList),
							_user$project$ExpressionBasedTransform$mergeExpressionLists(
								{ctor: '::', _0: _p21._2, _1: eArgsList}));
					});
			case 'ELet':
				var _p47 = _p21._3;
				var match = function (eNext) {
					var _p40 = eNext.val.e__;
					if (_p40.ctor === 'ELet') {
						return _elm_lang$core$Maybe$Just(
							{
								ctor: '_Tuple2',
								_0: {ctor: '_Tuple2', _0: _p40._3, _1: _p40._4},
								_1: _p40._5
							});
					} else {
						return _elm_lang$core$Maybe$Nothing;
					}
				};
				return A3(
					_user$project$ExpressionBasedTransform$matchAllAndBind,
					match,
					eRest,
					function (stuff) {
						var _p41 = A2(
							_elm_lang$core$Tuple$mapFirst,
							_elm_lang$core$List$unzip,
							_elm_lang$core$List$unzip(stuff));
						var p1List = _p41._0._0;
						var e1List = _p41._0._1;
						var e2List = _p41._1;
						return A4(
							_user$project$Utils$bindMaybe3,
							F3(
								function (_p44, _p43, _p42) {
									var _p45 = _p43;
									var _p46 = _p42;
									return A2(
										$return,
										A7(_user$project$Lang$ELet, _p21._0, _p21._1, _p21._2, _p47, _p45._0, _p46._0, _p21._6),
										A2(_elm_lang$core$Basics_ops['++'], _p45._1, _p46._1));
								}),
							A2(_user$project$ExpressionBasedTransform$mergePatterns, _p47, p1List),
							A2(_user$project$ExpressionBasedTransform$mergeExpressions, _p21._4, e1List),
							A2(_user$project$ExpressionBasedTransform$mergeExpressions, _p21._5, e2List));
					});
			case 'EList':
				var match = function (eNext) {
					var _p48 = eNext.val.e__;
					if (_p48.ctor === 'EList') {
						return _elm_lang$core$Maybe$Just(
							{ctor: '_Tuple2', _0: _p48._1, _1: _p48._3});
					} else {
						return _elm_lang$core$Maybe$Nothing;
					}
				};
				return A3(
					_user$project$ExpressionBasedTransform$matchAllAndBind,
					match,
					eRest,
					function (stuff) {
						var _p49 = _elm_lang$core$List$unzip(stuff);
						var esList = _p49._0;
						var meList = _p49._1;
						return A3(
							_user$project$Utils$bindMaybe2,
							F2(
								function (_p51, _p50) {
									var _p52 = _p51;
									var _p53 = _p50;
									return A2(
										$return,
										A5(_user$project$Lang$EList, _p21._0, _p52._0, _p21._2, _p53._0, _p21._4),
										A2(_elm_lang$core$Basics_ops['++'], _p52._1, _p53._1));
								}),
							_user$project$ExpressionBasedTransform$mergeExpressionLists(
								{ctor: '::', _0: _p21._1, _1: esList}),
							A2(_user$project$ExpressionBasedTransform$mergeMaybeExpressions, _p21._3, meList));
					});
			case 'EOp':
				var _p58 = _p21._1;
				var match = function (eNext) {
					var _p54 = eNext.val.e__;
					if (_p54.ctor === 'EOp') {
						return _elm_lang$core$Maybe$Just(
							{ctor: '_Tuple2', _0: _p54._1, _1: _p54._2});
					} else {
						return _elm_lang$core$Maybe$Nothing;
					}
				};
				return A3(
					_user$project$ExpressionBasedTransform$matchAllAndBind,
					match,
					eRest,
					function (stuff) {
						var _p55 = _elm_lang$core$List$unzip(stuff);
						var opList = _p55._0;
						var esList = _p55._1;
						return A2(
							_elm_lang$core$List$all,
							F2(
								function (x, y) {
									return _elm_lang$core$Native_Utils.eq(x, y);
								})(_p58.val),
							A2(
								_elm_lang$core$List$map,
								function (_) {
									return _.val;
								},
								opList)) ? A2(
							_user$project$Utils$bindMaybe,
							function (_p56) {
								var _p57 = _p56;
								return A2(
									$return,
									A4(_user$project$Lang$EOp, _p21._0, _p58, _p57._0, _p21._3),
									_p57._1);
							},
							_user$project$ExpressionBasedTransform$mergeExpressionLists(
								{ctor: '::', _0: _p21._2, _1: esList})) : _elm_lang$core$Maybe$Nothing;
					});
			case 'EIf':
				var match = function (eNext) {
					var _p59 = eNext.val.e__;
					if (_p59.ctor === 'EIf') {
						return _elm_lang$core$Maybe$Just(
							{
								ctor: '_Tuple2',
								_0: {ctor: '_Tuple2', _0: _p59._1, _1: _p59._2},
								_1: _p59._3
							});
					} else {
						return _elm_lang$core$Maybe$Nothing;
					}
				};
				return A3(
					_user$project$ExpressionBasedTransform$matchAllAndBind,
					match,
					eRest,
					function (stuff) {
						var _p60 = A2(
							_elm_lang$core$Tuple$mapFirst,
							_elm_lang$core$List$unzip,
							_elm_lang$core$List$unzip(stuff));
						var e1List = _p60._0._0;
						var e2List = _p60._0._1;
						var e3List = _p60._1;
						return A4(
							_user$project$Utils$bindMaybe3,
							F3(
								function (_p63, _p62, _p61) {
									var _p64 = _p63;
									var _p65 = _p62;
									var _p66 = _p61;
									return A2(
										$return,
										A5(_user$project$Lang$EIf, _p21._0, _p64._0, _p65._0, _p66._0, _p21._4),
										A2(
											_elm_lang$core$Basics_ops['++'],
											_p64._1,
											A2(_elm_lang$core$Basics_ops['++'], _p65._1, _p66._1)));
								}),
							A2(_user$project$ExpressionBasedTransform$mergeExpressions, _p21._1, e1List),
							A2(_user$project$ExpressionBasedTransform$mergeExpressions, _p21._2, e2List),
							A2(_user$project$ExpressionBasedTransform$mergeExpressions, _p21._3, e3List));
					});
			case 'EComment':
				var match = function (eNext) {
					var _p67 = eNext.val.e__;
					if (_p67.ctor === 'EComment') {
						return _elm_lang$core$Maybe$Just(_p67._2);
					} else {
						return _elm_lang$core$Maybe$Nothing;
					}
				};
				return A3(
					_user$project$ExpressionBasedTransform$matchAllAndBind,
					match,
					eRest,
					function (es) {
						return A2(
							_user$project$Utils$bindMaybe,
							function (_p68) {
								var _p69 = _p68;
								return A2(
									$return,
									A3(_user$project$Lang$EComment, _p21._0, _p21._1, _p69._0),
									_p69._1);
							},
							A2(_user$project$ExpressionBasedTransform$mergeExpressions, _p21._2, es));
					});
			case 'ETyp':
				var _p77 = _p21._2;
				var _p76 = _p21._1;
				var match = function (eNext) {
					var _p70 = eNext.val.e__;
					if (_p70.ctor === 'ETyp') {
						return _elm_lang$core$Maybe$Just(
							{
								ctor: '_Tuple2',
								_0: {ctor: '_Tuple2', _0: _p70._1, _1: _p70._2},
								_1: _p70._3
							});
					} else {
						return _elm_lang$core$Maybe$Nothing;
					}
				};
				return A3(
					_user$project$ExpressionBasedTransform$matchAllAndBind,
					match,
					eRest,
					function (stuff) {
						var _p71 = A2(
							_elm_lang$core$Tuple$mapFirst,
							_elm_lang$core$List$unzip,
							_elm_lang$core$List$unzip(stuff));
						var patList = _p71._0._0;
						var typeList = _p71._0._1;
						var eList = _p71._1;
						return A4(
							_user$project$Utils$bindMaybe3,
							F3(
								function (_p74, _p73, _p72) {
									var _p75 = _p72;
									return A2(
										$return,
										A5(_user$project$Lang$ETyp, _p21._0, _p76, _p77, _p75._0, _p21._4),
										_p75._1);
								}),
							A2(_user$project$ExpressionBasedTransform$mergePatterns, _p76, patList),
							A2(_user$project$ExpressionBasedTransform$mergeTypes, _p77, typeList),
							A2(_user$project$ExpressionBasedTransform$mergeExpressions, _p21._3, eList));
					});
			case 'EColonType':
				var _p83 = _p21._3;
				var match = function (eNext) {
					var _p78 = eNext.val.e__;
					if (_p78.ctor === 'EColonType') {
						return _elm_lang$core$Maybe$Just(
							{ctor: '_Tuple2', _0: _p78._1, _1: _p78._3});
					} else {
						return _elm_lang$core$Maybe$Nothing;
					}
				};
				return A3(
					_user$project$ExpressionBasedTransform$matchAllAndBind,
					match,
					eRest,
					function (stuff) {
						var _p79 = _elm_lang$core$List$unzip(stuff);
						var eList = _p79._0;
						var typeList = _p79._1;
						return A3(
							_user$project$Utils$bindMaybe2,
							F2(
								function (_p81, _p80) {
									var _p82 = _p81;
									return A2(
										$return,
										A5(_user$project$Lang$EColonType, _p21._0, _p82._0, _p21._2, _p83, _p21._4),
										_p82._1);
								}),
							A2(_user$project$ExpressionBasedTransform$mergeExpressions, _p21._1, eList),
							A2(_user$project$ExpressionBasedTransform$mergeTypes, _p83, typeList));
					});
			case 'ETypeAlias':
				var _p91 = _p21._2;
				var _p90 = _p21._1;
				var match = function (eNext) {
					var _p84 = eNext.val.e__;
					if (_p84.ctor === 'ETypeAlias') {
						return _elm_lang$core$Maybe$Just(
							{
								ctor: '_Tuple2',
								_0: {ctor: '_Tuple2', _0: _p84._1, _1: _p84._2},
								_1: _p84._3
							});
					} else {
						return _elm_lang$core$Maybe$Nothing;
					}
				};
				return A3(
					_user$project$ExpressionBasedTransform$matchAllAndBind,
					match,
					eRest,
					function (stuff) {
						var _p85 = A2(
							_elm_lang$core$Tuple$mapFirst,
							_elm_lang$core$List$unzip,
							_elm_lang$core$List$unzip(stuff));
						var patList = _p85._0._0;
						var typeList = _p85._0._1;
						var eList = _p85._1;
						return A4(
							_user$project$Utils$bindMaybe3,
							F3(
								function (_p88, _p87, _p86) {
									var _p89 = _p86;
									return A2(
										$return,
										A5(_user$project$Lang$ETypeAlias, _p21._0, _p90, _p91, _p89._0, _p21._4),
										_p89._1);
								}),
							A2(_user$project$ExpressionBasedTransform$mergePatterns, _p90, patList),
							A2(_user$project$ExpressionBasedTransform$mergeTypes, _p91, typeList),
							A2(_user$project$ExpressionBasedTransform$mergeExpressions, _p21._3, eList));
					});
			case 'ECase':
				var _p92 = A2(_elm_lang$core$Debug$log, 'mergeExpressions: TODO handle: ', eFirst);
				return _elm_lang$core$Maybe$Nothing;
			case 'ETypeCase':
				var _p93 = A2(_elm_lang$core$Debug$log, 'mergeExpressions: TODO handle: ', eFirst);
				return _elm_lang$core$Maybe$Nothing;
			default:
				var _p94 = A2(
					_elm_lang$core$Debug$log,
					'mergeExpressions: options shouldn\'t appear nested: ',
					{ctor: '_Tuple0'});
				return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$ExpressionBasedTransform$mergeExpressionLists = function (lists) {
	var _p95 = _user$project$Utils$maybeZipN(lists);
	if (_p95.ctor === 'Nothing') {
		return _elm_lang$core$Maybe$Nothing;
	} else {
		var foo = F2(
			function (listExp, maybeAcc) {
				var _p96 = {ctor: '_Tuple2', _0: listExp, _1: maybeAcc};
				if ((((_p96.ctor === '_Tuple2') && (_p96._0.ctor === '::')) && (_p96._1.ctor === 'Just')) && (_p96._1._0.ctor === '_Tuple2')) {
					var _p97 = A2(_user$project$ExpressionBasedTransform$mergeExpressions, _p96._0._0, _p96._0._1);
					if (_p97.ctor === 'Nothing') {
						return _elm_lang$core$Maybe$Nothing;
					} else {
						return _elm_lang$core$Maybe$Just(
							{
								ctor: '_Tuple2',
								_0: A2(
									_elm_lang$core$Basics_ops['++'],
									_p96._1._0._0,
									{
										ctor: '::',
										_0: _p97._0._0,
										_1: {ctor: '[]'}
									}),
								_1: A2(_elm_lang$core$Basics_ops['++'], _p96._1._0._1, _p97._0._1)
							});
					}
				} else {
					return _elm_lang$core$Maybe$Nothing;
				}
			});
		return A3(
			_elm_lang$core$List$foldl,
			foo,
			_elm_lang$core$Maybe$Just(
				{
					ctor: '_Tuple2',
					_0: {ctor: '[]'},
					_1: {ctor: '[]'}
				}),
			_p95._0);
	}
};
var _user$project$ExpressionBasedTransform$mergeMaybeExpressions = F2(
	function (me, mes) {
		var _p98 = me;
		if (_p98.ctor === 'Nothing') {
			return A2(
				_elm_lang$core$List$all,
				F2(
					function (x, y) {
						return _elm_lang$core$Native_Utils.eq(x, y);
					})(_elm_lang$core$Maybe$Nothing),
				mes) ? _elm_lang$core$Maybe$Just(
				{
					ctor: '_Tuple2',
					_0: _elm_lang$core$Maybe$Nothing,
					_1: {ctor: '[]'}
				}) : _elm_lang$core$Maybe$Nothing;
		} else {
			return A2(
				_user$project$Utils$bindMaybe,
				function (_p99) {
					return A2(
						_user$project$Utils$mapMaybe,
						_elm_lang$core$Tuple$mapFirst(_elm_lang$core$Maybe$Just),
						A2(_user$project$ExpressionBasedTransform$mergeExpressions, _p98._0, _p99));
				},
				_user$project$Utils$projJusts(mes));
		}
	});
var _user$project$ExpressionBasedTransform$deleteSelectedBlobs = function (model) {
	var _p100 = _user$project$Blobs$splitExp(model.inputExp);
	var defs = _p100._0;
	var mainExp = _p100._1;
	var _p101 = mainExp;
	if (_p101.ctor === 'Blobs') {
		var blobs_ = A2(
			_user$project$Utils$filteri1,
			function (_p102) {
				var _p103 = _p102;
				return !A2(_elm_lang$core$Dict$member, _p103._0, model.selectedBlobs);
			},
			_p101._0);
		var code_ = _user$project$LangUnparser$unparse(
			_user$project$Blobs$fuseExp(
				{
					ctor: '_Tuple2',
					_0: defs,
					_1: A2(_user$project$Blobs$Blobs, blobs_, _p101._1)
				}));
		return _elm_lang$core$Native_Utils.update(
			model,
			{code: code_, selectedBlobs: _elm_lang$core$Dict$empty});
	} else {
		return model;
	}
};
var _user$project$ExpressionBasedTransform$stripBoundsExp = function (e) {
	stripBoundsExp:
	while (true) {
		var _p104 = e.val.e__;
		_v50_2:
		do {
			switch (_p104.ctor) {
				case 'EList':
					if (_p104._3.ctor === 'Nothing') {
						var _p106 = A2(
							_elm_lang$core$List$map,
							function (_p105) {
								return function (_) {
									return _.e__;
								}(
									function (_) {
										return _.val;
									}(_p105));
							},
							_p104._1);
						if (((((((((_p106.ctor === '::') && (_p106._0.ctor === 'EConst')) && (_p106._1.ctor === '::')) && (_p106._1._0.ctor === 'EConst')) && (_p106._1._1.ctor === '::')) && (_p106._1._1._0.ctor === 'EConst')) && (_p106._1._1._1.ctor === '::')) && (_p106._1._1._1._0.ctor === 'EConst')) && (_p106._1._1._1._1.ctor === '[]')) {
							return _elm_lang$core$Maybe$Just(
								{ctor: '_Tuple4', _0: _p106._0._1, _1: _p106._1._0._1, _2: _p106._1._1._0._1, _3: _p106._1._1._1._0._1});
						} else {
							return _elm_lang$core$Maybe$Nothing;
						}
					} else {
						break _v50_2;
					}
				case 'EColonType':
					var _v52 = _p104._1;
					e = _v52;
					continue stripBoundsExp;
				default:
					break _v50_2;
			}
		} while(false);
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$ExpressionBasedTransform$stripPointExp = function (e) {
	stripPointExp:
	while (true) {
		var _p107 = e.val.e__;
		_v53_2:
		do {
			switch (_p107.ctor) {
				case 'EList':
					if ((((_p107._1.ctor === '::') && (_p107._1._1.ctor === '::')) && (_p107._1._1._1.ctor === '[]')) && (_p107._3.ctor === 'Nothing')) {
						var _p108 = {ctor: '_Tuple2', _0: _p107._1._0.val.e__, _1: _p107._1._1._0.val.e__};
						if (((_p108.ctor === '_Tuple2') && (_p108._0.ctor === 'EConst')) && (_p108._1.ctor === 'EConst')) {
							return _elm_lang$core$Maybe$Just(
								{ctor: '_Tuple2', _0: _p108._0._1, _1: _p108._1._1});
						} else {
							return _elm_lang$core$Maybe$Nothing;
						}
					} else {
						break _v53_2;
					}
				case 'EColonType':
					var _v55 = _p107._1;
					e = _v55;
					continue stripPointExp;
				default:
					break _v53_2;
			}
		} while(false);
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$ExpressionBasedTransform$redundantBinding = function (_p109) {
	redundantBinding:
	while (true) {
		var _p110 = _p109;
		var _p112 = _p110._0;
		var _p111 = {ctor: '_Tuple2', _0: _p112.val.p__, _1: _p110._1.val.e__};
		_v57_6:
		do {
			if (_p111.ctor === '_Tuple2') {
				switch (_p111._1.ctor) {
					case 'EConst':
						if (_p111._0.ctor === 'PConst') {
							return _elm_lang$core$Native_Utils.eq(_p111._0._1, _p111._1._1);
						} else {
							break _v57_6;
						}
					case 'EBase':
						if (_p111._0.ctor === 'PBase') {
							return _elm_lang$core$Native_Utils.eq(_p111._0._1, _p111._1._1);
						} else {
							break _v57_6;
						}
					case 'EVar':
						if (_p111._0.ctor === 'PVar') {
							return _elm_lang$core$Native_Utils.eq(_p111._0._1, _p111._1._1);
						} else {
							break _v57_6;
						}
					case 'EList':
						if (_p111._0.ctor === 'PList') {
							if (_p111._0._3.ctor === 'Nothing') {
								if (_p111._1._3.ctor === 'Nothing') {
									return A2(
										_elm_lang$core$List$all,
										_user$project$ExpressionBasedTransform$redundantBinding,
										A2(_user$project$Utils$zip, _p111._0._1, _p111._1._1));
								} else {
									break _v57_6;
								}
							} else {
								if (_p111._1._3.ctor === 'Just') {
									return A2(
										_elm_lang$core$List$all,
										_user$project$ExpressionBasedTransform$redundantBinding,
										A2(
											_user$project$Utils$zip,
											{ctor: '::', _0: _p111._0._3._0, _1: _p111._0._1},
											{ctor: '::', _0: _p111._1._3._0, _1: _p111._1._1}));
								} else {
									break _v57_6;
								}
							}
						} else {
							break _v57_6;
						}
					case 'EColonType':
						var _v58 = {ctor: '_Tuple2', _0: _p112, _1: _p111._1._1};
						_p109 = _v58;
						continue redundantBinding;
					default:
						break _v57_6;
				}
			} else {
				break _v57_6;
			}
		} while(false);
		return false;
	}
};
var _user$project$ExpressionBasedTransform$removeRedundantBindings = _user$project$Lang$mapExp(
	function (e) {
		var _p113 = e.val.e__;
		if (_p113.ctor === 'ELet') {
			return _user$project$ExpressionBasedTransform$redundantBinding(
				{ctor: '_Tuple2', _0: _p113._3, _1: _p113._4}) ? _p113._5 : e;
		} else {
			return e;
		}
	});
var _user$project$ExpressionBasedTransform$clean = function (_p114) {
	return _user$project$ExpressionBasedTransform$removeRedundantBindings(
		_user$project$LangSimplify$simplify(_p114));
};
var _user$project$ExpressionBasedTransform$collectUnfrozenConstants_ = F2(
	function (maybeVarCounts, e) {
		var foo = function (e__) {
			var $default = {
				ctor: '_Tuple2',
				_0: e__,
				_1: {ctor: '[]'}
			};
			var _p115 = e__;
			if ((_p115.ctor === 'EConst') && (_p115._2.ctor === '_Tuple3')) {
				var _p118 = _p115._2._2;
				var _p117 = _p115._2._1;
				if (_elm_lang$core$Native_Utils.eq(_p117, _user$project$Lang$unann) || _elm_lang$core$Native_Utils.eq(_p117, _user$project$Lang$thawed)) {
					if (_elm_lang$core$Native_Utils.eq(_p118, '')) {
						return $default;
					} else {
						var addVar = function (y) {
							return {
								ctor: '_Tuple2',
								_0: A2(_user$project$Lang$EVar, _p115._0, y),
								_1: {
									ctor: '::',
									_0: {
										ctor: '_Tuple2',
										_0: y,
										_1: {ctor: '_Tuple3', _0: _p115._1, _1: _p117, _2: _p115._3}
									},
									_1: {ctor: '[]'}
								}
							};
						};
						var _p116 = maybeVarCounts;
						if (_p116.ctor === 'Nothing') {
							return addVar(_p118);
						} else {
							return _elm_lang$core$Native_Utils.eq(
								A2(_user$project$Utils$justGet, _p118, _p116._0),
								1) ? addVar(_p118) : addVar(
								A2(
									_elm_lang$core$Basics_ops['++'],
									_p118,
									_elm_lang$core$Basics$toString(_p115._2._0)));
						}
					}
				} else {
					return $default;
				}
			} else {
				return $default;
			}
		};
		var e_ = A2(
			_user$project$Lang$mapExpViaExp__,
			function (_p119) {
				return _elm_lang$core$Tuple$first(
					foo(_p119));
			},
			e);
		var mapping = A3(
			_user$project$Lang$foldExpViaE__,
			function (_p120) {
				return F2(
					function (x, y) {
						return A2(_elm_lang$core$Basics_ops['++'], x, y);
					})(
					_elm_lang$core$Tuple$second(
						foo(_p120)));
			},
			{ctor: '[]'},
			e);
		return {ctor: '_Tuple2', _0: e_, _1: mapping};
	});
var _user$project$ExpressionBasedTransform$collectUnfrozenConstants = function (e) {
	var _p121 = A2(_user$project$ExpressionBasedTransform$collectUnfrozenConstants_, _elm_lang$core$Maybe$Nothing, e);
	var list0 = _p121._1;
	var varCounts = A3(
		_elm_lang$core$List$foldl,
		F2(
			function ($var, acc) {
				var _p122 = A2(_elm_lang$core$Dict$get, $var, acc);
				if (_p122.ctor === 'Nothing') {
					return A3(_elm_lang$core$Dict$insert, $var, 1, acc);
				} else {
					return A3(_elm_lang$core$Dict$insert, $var, 1 + _p122._0, acc);
				}
			}),
		_elm_lang$core$Dict$empty,
		A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$first, list0));
	var _p123 = A2(
		_user$project$ExpressionBasedTransform$collectUnfrozenConstants_,
		_elm_lang$core$Maybe$Just(varCounts),
		e);
	var e_ = _p123._0;
	var list = _p123._1;
	return {
		ctor: '_Tuple2',
		_0: _user$project$ExpressionBasedTransform$clean(e_),
		_1: _elm_lang$core$List$reverse(list)
	};
};
var _user$project$ExpressionBasedTransform$pAsTight = F2(
	function (x, p) {
		var p_ = A2(_user$project$Lang$replacePrecedingWhitespacePat, '', p);
		return _user$project$Lang$withDummyPatInfo(
			A4(_user$project$Lang$PAs, _user$project$Lang$space1, x, _user$project$Lang$space0, p_));
	});
var _user$project$ExpressionBasedTransform$eAsPoint = function (e) {
	var insertPointAnnotations = false;
	if (!insertPointAnnotations) {
		return e;
	} else {
		var e_ = A2(_user$project$Lang$replacePrecedingWhitespace, '', e);
		return _user$project$Lang$withDummyExpInfo(
			A5(
				_user$project$Lang$EColonType,
				_user$project$Lang$space1,
				e_,
				_user$project$Lang$space1,
				_user$project$Lang$withDummyRange(
					A2(_user$project$Lang$TNamed, _user$project$Lang$space1, 'Point')),
				_user$project$Lang$space0));
	}
};
var _user$project$ExpressionBasedTransform$eBaseOffset = F2(
	function (baseVar, offsetNum) {
		var allowZeroOffsets = true;
		return (_elm_lang$core$Native_Utils.eq(offsetNum, 0) && (!allowZeroOffsets)) ? A2(_user$project$Lang$EVar, _user$project$Lang$space1, baseVar) : function (_) {
			return _.e__;
		}(
			function (_) {
				return _.val;
			}(
				A2(
					_user$project$Lang$replacePrecedingWhitespace,
					' ',
					A2(
						_user$project$Lang$ePlus,
						_user$project$Lang$eVar(baseVar),
						A2(
							_user$project$Lang$eConst,
							offsetNum,
							_user$project$Lang$dummyLoc_(_user$project$Lang$unann))))));
	});
var _user$project$ExpressionBasedTransform$rewritePrimitivePointsOfSelectedBlobs = F3(
	function (model, _p125, _p124) {
		var _p126 = _p125;
		var _p139 = _p126._0;
		var _p127 = _p124;
		var _p138 = _p127._0;
		var _p128 = _p126._1;
		var xId = _p128._0;
		var xName = _p128._2;
		var _p129 = _p127._1;
		var yId = _p129._0;
		var yName = _p129._2;
		var _p130 = {ctor: '_Tuple2', _0: 'xAnchor', _1: 'yAnchor'};
		var xAnchor = _p130._0;
		var yAnchor = _p130._1;
		var pointsOfSelectedBlobs = A3(
			_elm_lang$core$Dict$foldl,
			F3(
				function (_p131, nodeId, acc) {
					return A2(
						_elm_lang$core$Basics_ops['++'],
						acc,
						A2(_user$project$ShapeWidgets$getPrimitivePointEquations, model.slate, nodeId));
				}),
			{ctor: '[]'},
			model.selectedBlobs);
		var anchorDef = {
			ctor: '_Tuple4',
			_0: _user$project$Lang$ws('\n  '),
			_1: A2(
				_user$project$Lang$pAs,
				'anchor',
				_user$project$Lang$pList(
					_user$project$Lang$listOfPVars(
						{
							ctor: '::',
							_0: xAnchor,
							_1: {
								ctor: '::',
								_0: yAnchor,
								_1: {ctor: '[]'}
							}
						}))),
			_2: _user$project$ExpressionBasedTransform$eAsPoint(
				A2(
					_user$project$Lang$eList,
					_user$project$Lang$listOfNums(
						{
							ctor: '::',
							_0: _p139,
							_1: {
								ctor: '::',
								_0: _p138,
								_1: {ctor: '[]'}
							}
						}),
					_elm_lang$core$Maybe$Nothing)),
			_3: _user$project$Lang$space0
		};
		var eSubst = function () {
			var locIdToEId = function (_p132) {
				return A2(
					_user$project$Utils$fromJust_,
					'rewritePrimitivePointsOfSelectedBlobs',
					A2(_user$project$Lang$locIdToEId, model.inputExp, _p132));
			};
			return A3(
				_elm_lang$core$List$foldl,
				F2(
					function (_p133, acc) {
						var _p134 = _p133;
						var _p137 = _p134._1;
						var _p136 = _p134._0;
						if (_elm_lang$core$Native_Utils.eq(
							{ctor: '_Tuple2', _0: _p139, _1: _p138},
							{
								ctor: '_Tuple2',
								_0: _elm_lang$core$Tuple$first(_p136),
								_1: _elm_lang$core$Tuple$first(_p137)
							})) {
							return A3(
								_elm_lang$core$Dict$insert,
								locIdToEId(yId),
								A2(_user$project$Lang$EVar, _user$project$Lang$space1, yAnchor),
								A3(
									_elm_lang$core$Dict$insert,
									locIdToEId(xId),
									A2(_user$project$Lang$EVar, _user$project$Lang$space1, xAnchor),
									acc));
						} else {
							var _p135 = {ctor: '_Tuple2', _0: _p136, _1: _p137};
							if (((((((_p135.ctor === '_Tuple2') && (_p135._0.ctor === '_Tuple2')) && (_p135._0._1.ctor === 'TrLoc')) && (_p135._0._1._0.ctor === '_Tuple3')) && (_p135._1.ctor === '_Tuple2')) && (_p135._1._1.ctor === 'TrLoc')) && (_p135._1._1._0.ctor === '_Tuple3')) {
								return A3(
									_elm_lang$core$Dict$insert,
									locIdToEId(_p135._1._1._0._0),
									A2(_user$project$ExpressionBasedTransform$eBaseOffset, yAnchor, _p135._1._0 - _p138),
									A3(
										_elm_lang$core$Dict$insert,
										locIdToEId(_p135._0._1._0._0),
										A2(_user$project$ExpressionBasedTransform$eBaseOffset, xAnchor, _p135._0._0 - _p139),
										acc));
							} else {
								return acc;
							}
						}
					}),
				_elm_lang$core$Dict$empty,
				pointsOfSelectedBlobs);
		}();
		return {
			ctor: '_Tuple2',
			_0: {
				ctor: '::',
				_0: anchorDef,
				_1: {ctor: '[]'}
			},
			_1: eSubst
		};
	});
var _user$project$ExpressionBasedTransform$anchorOfSelectedFeatures = function (selectedFeatures) {
	var err = _elm_lang$core$Result$Err('To group around an anchor, need to select exactly one point.');
	var _p140 = _elm_lang$core$Set$toList(selectedFeatures);
	if (_p140.ctor === '::') {
		if ((_p140._1.ctor === '::') && (_p140._1._1.ctor === '[]')) {
			var _p141 = A2(_user$project$ShapeWidgets$selectedPointFeatureOf, _p140._0, _p140._1._0);
			if (_p141.ctor === 'Just') {
				return _elm_lang$core$Result$Ok(
					_elm_lang$core$Maybe$Just(_p141._0));
			} else {
				return err;
			}
		} else {
			return err;
		}
	} else {
		return _elm_lang$core$Result$Ok(_elm_lang$core$Maybe$Nothing);
	}
};
var _user$project$ExpressionBasedTransform$undoGroupPadding = function (_p142) {
	var _p143 = _p142;
	var clean = function (_p144) {
		var _p145 = _p144;
		var _p148 = _p145._1;
		var _p147 = _p145._0;
		var _p146 = _p148;
		_v71_4:
		do {
			if ((((((_p146.ctor === 'TrOp') && (_p146._1.ctor === '::')) && (_p146._1._1.ctor === '::')) && (_p146._1._1._0.ctor === 'TrLoc')) && (_p146._1._1._0._0.ctor === '_Tuple3')) && (_p146._1._1._1.ctor === '[]')) {
				switch (_p146._0.ctor) {
					case 'Minus':
						switch (_p146._1._1._0._0._2) {
							case 'nGroupPad':
								return {ctor: '_Tuple2', _0: _p147 + 20, _1: _p146._1._0};
							case 'nPolyPathPad':
								return {ctor: '_Tuple2', _0: _p147 + 10, _1: _p146._1._0};
							default:
								break _v71_4;
						}
					case 'Plus':
						switch (_p146._1._1._0._0._2) {
							case 'nGroupPad':
								return {ctor: '_Tuple2', _0: _p147 - 20, _1: _p146._1._0};
							case 'nPolyPathPad':
								return {ctor: '_Tuple2', _0: _p147 - 10, _1: _p146._1._0};
							default:
								break _v71_4;
						}
					default:
						break _v71_4;
				}
			} else {
				break _v71_4;
			}
		} while(false);
		return {ctor: '_Tuple2', _0: _p147, _1: _p148};
	};
	return {
		ctor: '_Tuple4',
		_0: clean(_p143._0),
		_1: clean(_p143._1),
		_2: clean(_p143._2),
		_3: clean(_p143._3)
	};
};
var _user$project$ExpressionBasedTransform$computeSelectedBlobsAndBounds = function (model) {
	var tree = _elm_lang$core$Tuple$second(model.slate);
	return A2(
		_elm_lang$core$Dict$map,
		F2(
			function (blobId, nodeId) {
				return _user$project$ExpressionBasedTransform$undoGroupPadding(
					function () {
						var _p149 = A2(_elm_lang$core$Dict$get, nodeId, tree);
						_v72_7:
						do {
							if ((_p149.ctor === 'Just') && (_p149._0.ctor === 'SvgNode')) {
								switch (_p149._0._0) {
									case 'BOX':
										var get = function (attr) {
											return A2(_user$project$LangSvg$findNumishAttr, attr, _p149._0._1);
										};
										return {
											ctor: '_Tuple4',
											_0: get('LEFT'),
											_1: get('TOP'),
											_2: get('RIGHT'),
											_3: get('BOT')
										};
									case 'OVAL':
										var get = function (attr) {
											return A2(_user$project$LangSvg$findNumishAttr, attr, _p149._0._1);
										};
										return {
											ctor: '_Tuple4',
											_0: get('LEFT'),
											_1: get('TOP'),
											_2: get('RIGHT'),
											_3: get('BOT')
										};
									case 'g':
										var _p150 = _user$project$LangSvg$maybeFindBounds(_p149._0._1);
										if (_p150.ctor === 'Just') {
											return _p150._0;
										} else {
											return _elm_lang$core$Native_Utils.crashCase(
												'ExpressionBasedTransform',
												{
													start: {line: 849, column: 12},
													end: {line: 851, column: 72}
												},
												_p150)('computeSelectedBlobsAndBounds');
										}
									case 'line':
										var get = function (attr) {
											return A2(_user$project$LangSvg$findNumishAttr, attr, _p149._0._1);
										};
										var _p152 = {
											ctor: '_Tuple4',
											_0: get('x1'),
											_1: get('y1'),
											_2: get('x2'),
											_3: get('y2')
										};
										var x1 = _p152._0;
										var y1 = _p152._1;
										var x2 = _p152._2;
										var y2 = _p152._3;
										return {
											ctor: '_Tuple4',
											_0: A2(_user$project$Lang$minNumTr, x1, x2),
											_1: A2(_user$project$Lang$minNumTr, y1, y2),
											_2: A2(_user$project$Lang$maxNumTr, x1, x2),
											_3: A2(_user$project$Lang$maxNumTr, y1, y2)
										};
									case 'ellipse':
										var get = function (attr) {
											return A2(_user$project$LangSvg$findNumishAttr, attr, _p149._0._1);
										};
										var _p153 = {
											ctor: '_Tuple4',
											_0: get('cx'),
											_1: get('cy'),
											_2: get('rx'),
											_3: get('ry')
										};
										var cx = _p153._0;
										var cy = _p153._1;
										var rx = _p153._2;
										var ry = _p153._3;
										return {
											ctor: '_Tuple4',
											_0: A2(_user$project$Lang$minusNumTr, cx, rx),
											_1: A2(_user$project$Lang$minusNumTr, cy, ry),
											_2: A2(_user$project$Lang$plusNumTr, cx, rx),
											_3: A2(_user$project$Lang$plusNumTr, cy, ry)
										};
									case 'circle':
										var get = function (attr) {
											return A2(_user$project$LangSvg$findNumishAttr, attr, _p149._0._1);
										};
										var _p154 = {
											ctor: '_Tuple3',
											_0: get('cx'),
											_1: get('cy'),
											_2: get('r')
										};
										var cx = _p154._0;
										var cy = _p154._1;
										var r = _p154._2;
										return {
											ctor: '_Tuple4',
											_0: A2(_user$project$Lang$minusNumTr, cx, r),
											_1: A2(_user$project$Lang$minusNumTr, cy, r),
											_2: A2(_user$project$Lang$plusNumTr, cx, r),
											_3: A2(_user$project$Lang$plusNumTr, cy, r)
										};
									case 'rect':
										var get = function (attr) {
											return A2(_user$project$LangSvg$findNumishAttr, attr, _p149._0._1);
										};
										var _p155 = {
											ctor: '_Tuple4',
											_0: get('x'),
											_1: get('y'),
											_2: get('width'),
											_3: get('height')
										};
										var x = _p155._0;
										var y = _p155._1;
										var width = _p155._2;
										var height = _p155._3;
										return {
											ctor: '_Tuple4',
											_0: x,
											_1: y,
											_2: A2(_user$project$Lang$plusNumTr, x, width),
											_3: A2(_user$project$Lang$plusNumTr, y, height)
										};
									default:
										break _v72_7;
								}
							} else {
								break _v72_7;
							}
						} while(false);
						return _elm_lang$core$Native_Utils.crashCase(
							'ExpressionBasedTransform',
							{
								start: {line: 836, column: 8},
								end: {line: 875, column: 58}
							},
							_p149)('computeSelectedBlobsAndBounds');
					}());
			}),
		model.selectedBlobs);
};
var _user$project$ExpressionBasedTransform$occursFreeIn = F2(
	function (x, e) {
		var vars = A3(
			_user$project$Lang$foldExpViaE__,
			F2(
				function (e__, acc) {
					var _p157 = e__;
					if (_p157.ctor === 'EVar') {
						return A2(_elm_lang$core$Set$insert, _p157._1, acc);
					} else {
						return acc;
					}
				}),
			_elm_lang$core$Set$empty,
			e);
		return A2(_elm_lang$core$Set$member, x, vars);
	});
var _user$project$ExpressionBasedTransform$offsetXY = F8(
	function (program, base1, base2, baseVal1, baseVal2, ws, _p158, eSubst) {
		var _p159 = _p158;
		var _p164 = _p159._0;
		var _p160 = _p159._1;
		if ((_p160.ctor === 'TrLoc') && (_p160._0.ctor === '_Tuple3')) {
			var _p161 = {
				ctor: '_Tuple2',
				_0: _p164 - _elm_lang$core$Tuple$first(baseVal1),
				_1: _p164 - _elm_lang$core$Tuple$first(baseVal2)
			};
			var off1 = _p161._0;
			var off2 = _p161._1;
			var _p162 = (_elm_lang$core$Native_Utils.cmp(
				off1,
				_elm_lang$core$Basics$abs(off2)) < 1) ? {ctor: '_Tuple2', _0: base1, _1: off1} : {ctor: '_Tuple2', _0: base2, _1: off2};
			var base = _p162._0;
			var off = _p162._1;
			var app = A2(
				_elm_lang$core$Basics_ops['++'],
				ws,
				_user$project$Utils$parens(
					_user$project$Utils$spaces(
						{
							ctor: '::',
							_0: 'evalOffset',
							_1: {
								ctor: '::',
								_0: _user$project$Utils$bracks(
									_user$project$Utils$spaces(
										{
											ctor: '::',
											_0: base,
											_1: {
												ctor: '::',
												_0: _elm_lang$core$Basics$toString(off),
												_1: {ctor: '[]'}
											}
										})),
								_1: {ctor: '[]'}
							}
						})));
			var _p163 = A2(_user$project$Lang$locIdToEId, program, _p160._0._0);
			if (_p163.ctor === 'Just') {
				return A3(
					_elm_lang$core$Dict$insert,
					_p163._0,
					A2(_user$project$Lang$eRaw__, _user$project$Lang$space0, app),
					eSubst);
			} else {
				return eSubst;
			}
		} else {
			return eSubst;
		}
	});
var _user$project$ExpressionBasedTransform$scaleXY = F8(
	function (program, start, end, startVal, widthOrHeight, ws, _p165, eSubst) {
		var _p166 = _p165;
		var _p167 = _p166._1;
		if ((_p167.ctor === 'TrLoc') && (_p167._0.ctor === '_Tuple3')) {
			var pct = (_p166._0 - _elm_lang$core$Tuple$first(startVal)) / widthOrHeight;
			var app = _elm_lang$core$Native_Utils.eq(pct, 0) ? A2(_elm_lang$core$Basics_ops['++'], ws, start) : (_elm_lang$core$Native_Utils.eq(pct, 1) ? A2(_elm_lang$core$Basics_ops['++'], ws, end) : A2(
				_elm_lang$core$Basics_ops['++'],
				ws,
				_user$project$Utils$parens(
					_user$project$Utils$spaces(
						{
							ctor: '::',
							_0: 'scaleBetween',
							_1: {
								ctor: '::',
								_0: start,
								_1: {
									ctor: '::',
									_0: end,
									_1: {
										ctor: '::',
										_0: _elm_lang$core$Basics$toString(pct),
										_1: {ctor: '[]'}
									}
								}
							}
						}))));
			var _p168 = A2(_user$project$Lang$locIdToEId, program, _p167._0._0);
			if (_p168.ctor === 'Just') {
				return A3(
					_elm_lang$core$Dict$insert,
					_p168._0,
					A2(_user$project$Lang$eRaw__, _user$project$Lang$space0, app),
					eSubst);
			} else {
				return eSubst;
			}
		} else {
			return eSubst;
		}
	});
var _user$project$ExpressionBasedTransform$rewriteBoundingBoxesOfSelectedBlobs = F2(
	function (model, selectedBlobsAndBounds) {
		var selectedBlobIndices = _elm_lang$core$Dict$keys(model.selectedBlobs);
		var _p169 = function () {
			var _p170 = selectedBlobIndices;
			if (_p170.ctor === '[]') {
				return _elm_lang$core$Native_Utils.crashCase(
					'ExpressionBasedTransform',
					{
						start: {line: 897, column: 5},
						end: {line: 905, column: 31}
					},
					_p170)('groupAndRearrange: shouldn\'t get here');
			} else {
				var init = A2(_user$project$Utils$justGet, _p170._0, selectedBlobsAndBounds);
				var foo = F2(
					function (j, _p172) {
						var _p173 = _p172;
						var _p174 = A2(_user$project$Utils$justGet, j, selectedBlobsAndBounds);
						var a = _p174._0;
						var b = _p174._1;
						var c = _p174._2;
						var d = _p174._3;
						return {
							ctor: '_Tuple4',
							_0: A2(_user$project$Lang$minNumTr, _p173._0, a),
							_1: A2(_user$project$Lang$minNumTr, _p173._1, b),
							_2: A2(_user$project$Lang$maxNumTr, _p173._2, c),
							_3: A2(_user$project$Lang$maxNumTr, _p173._3, d)
						};
					});
				return A3(_elm_lang$core$List$foldl, foo, init, _p170._1);
			}
		}();
		var left = _p169._0;
		var top = _p169._1;
		var right = _p169._2;
		var bot = _p169._3;
		var _p175 = {
			ctor: '_Tuple2',
			_0: _elm_lang$core$Tuple$first(right) - _elm_lang$core$Tuple$first(left),
			_1: _elm_lang$core$Tuple$first(bot) - _elm_lang$core$Tuple$first(top)
		};
		var width = _p175._0;
		var height = _p175._1;
		var scaleX = A5(_user$project$ExpressionBasedTransform$scaleXY, model.inputExp, 'left', 'right', left, width);
		var scaleY = A5(_user$project$ExpressionBasedTransform$scaleXY, model.inputExp, 'top', 'bot', top, height);
		var offsetX = A5(_user$project$ExpressionBasedTransform$offsetXY, model.inputExp, 'left', 'right', left, right);
		var offsetY = A5(_user$project$ExpressionBasedTransform$offsetXY, model.inputExp, 'top', 'bot', top, bot);
		var eSubst = function () {
			var foo = F2(
				function (i, acc) {
					var _p176 = A2(_user$project$Utils$justGet, i, selectedBlobsAndBounds);
					var a = _p176._0;
					var b = _p176._1;
					var c = _p176._2;
					var d = _p176._3;
					return _elm_lang$core$Native_Utils.eq(
						model.keysDown,
						{
							ctor: '::',
							_0: _user$project$Keys$keyShift,
							_1: {ctor: '[]'}
						}) ? A3(
						offsetY,
						' ',
						d,
						A3(
							offsetX,
							' ',
							c,
							A3(
								offsetY,
								' ',
								b,
								A3(offsetX, '', a, acc)))) : A3(
						scaleY,
						' ',
						d,
						A3(
							scaleX,
							' ',
							c,
							A3(
								scaleY,
								' ',
								b,
								A3(scaleX, ' ', a, acc))));
				});
			return A3(_elm_lang$core$List$foldl, foo, _elm_lang$core$Dict$empty, selectedBlobIndices);
		}();
		var groupDefs = {
			ctor: '::',
			_0: {
				ctor: '_Tuple4',
				_0: _user$project$Lang$ws('\n  '),
				_1: A2(
					_user$project$Lang$pAs,
					'bounds',
					_user$project$Lang$pList(
						_user$project$Lang$listOfPVars(
							{
								ctor: '::',
								_0: 'left',
								_1: {
									ctor: '::',
									_0: 'top',
									_1: {
										ctor: '::',
										_0: 'right',
										_1: {
											ctor: '::',
											_0: 'bot',
											_1: {ctor: '[]'}
										}
									}
								}
							}))),
				_2: A2(
					_user$project$Lang$eList,
					_user$project$Lang$listOfNums(
						{
							ctor: '::',
							_0: _elm_lang$core$Tuple$first(left),
							_1: {
								ctor: '::',
								_0: _elm_lang$core$Tuple$first(top),
								_1: {
									ctor: '::',
									_0: _elm_lang$core$Tuple$first(right),
									_1: {
										ctor: '::',
										_0: _elm_lang$core$Tuple$first(bot),
										_1: {ctor: '[]'}
									}
								}
							}
						}),
					_elm_lang$core$Maybe$Nothing),
				_3: _user$project$Lang$space0
			},
			_1: {ctor: '[]'}
		};
		return {ctor: '_Tuple2', _0: groupDefs, _1: eSubst};
	});
var _user$project$ExpressionBasedTransform$pluckFromList = F2(
	function (pred, xs) {
		var foo = F2(
			function (x, _p177) {
				var _p178 = _p177;
				var _p182 = _p178._0;
				var _p181 = _p178._1;
				var _p180 = _p178._2;
				var _p179 = {
					ctor: '_Tuple2',
					_0: pred(x),
					_1: _p182
				};
				if (_p179._0 === true) {
					return {
						ctor: '_Tuple3',
						_0: A2(
							_elm_lang$core$Basics_ops['++'],
							_p182,
							{
								ctor: '::',
								_0: x,
								_1: {ctor: '[]'}
							}),
						_1: _p181,
						_2: _p180
					};
				} else {
					if (_p179._1.ctor === '[]') {
						return {
							ctor: '_Tuple3',
							_0: _p182,
							_1: A2(
								_elm_lang$core$Basics_ops['++'],
								_p181,
								{
									ctor: '::',
									_0: x,
									_1: {ctor: '[]'}
								}),
							_2: _p180
						};
					} else {
						return {
							ctor: '_Tuple3',
							_0: _p182,
							_1: _p181,
							_2: A2(
								_elm_lang$core$Basics_ops['++'],
								_p180,
								{
									ctor: '::',
									_0: x,
									_1: {ctor: '[]'}
								})
						};
					}
				}
			});
		return A3(
			_elm_lang$core$List$foldl,
			foo,
			{
				ctor: '_Tuple3',
				_0: {ctor: '[]'},
				_1: {ctor: '[]'},
				_2: {ctor: '[]'}
			},
			xs);
	});
var _user$project$ExpressionBasedTransform$unsafePluckFromList = F2(
	function (pred, xs) {
		var _p183 = A2(
			_user$project$ExpressionBasedTransform$pluckFromList,
			pred,
			_elm_lang$core$List$reverse(xs));
		var plucked = _p183._0;
		var before = _p183._1;
		var after = _p183._2;
		return {
			ctor: '_Tuple3',
			_0: _elm_lang$core$List$reverse(plucked),
			_1: _elm_lang$core$List$reverse(after),
			_2: _elm_lang$core$List$reverse(before)
		};
	});
var _user$project$ExpressionBasedTransform$matchesAnySelectedCallBlob_ = F2(
	function (selectedNiceBlobs, def) {
		var findBlobForIdent = function (y) {
			var foo = function (_p184) {
				var _p185 = _p184;
				var _p186 = _p185._2;
				switch (_p186.ctor) {
					case 'VarBlob':
						return false;
					case 'WithBoundsBlob':
						return _elm_lang$core$Native_Utils.eq(_p186._0._1, y);
					case 'WithAnchorBlob':
						return _elm_lang$core$Native_Utils.eq(_p186._0._1, y);
					default:
						return _elm_lang$core$Native_Utils.eq(_p186._0._0, y);
				}
			};
			var _p187 = A2(_user$project$Utils$findFirst, foo, selectedNiceBlobs);
			_v87_3:
			do {
				if ((_p187.ctor === 'Just') && (_p187._0.ctor === '_Tuple3')) {
					switch (_p187._0._2.ctor) {
						case 'CallBlob':
							if (_p187._0._2._0.ctor === '_Tuple2') {
								return _elm_lang$core$Maybe$Just(_p187._0._2._0._0);
							} else {
								break _v87_3;
							}
						case 'WithBoundsBlob':
							if (_p187._0._2._0.ctor === '_Tuple3') {
								return _elm_lang$core$Maybe$Just(_p187._0._2._0._1);
							} else {
								break _v87_3;
							}
						case 'WithAnchorBlob':
							if (_p187._0._2._0.ctor === '_Tuple3') {
								return _elm_lang$core$Maybe$Just(_p187._0._2._0._1);
							} else {
								break _v87_3;
							}
						default:
							break _v87_3;
					}
				} else {
					break _v87_3;
				}
			} while(false);
			return _elm_lang$core$Maybe$Nothing;
		};
		var _p188 = def;
		var p = _p188._1;
		var _p189 = p.val.p__;
		switch (_p189.ctor) {
			case 'PVar':
				return findBlobForIdent(_p189._1);
			case 'PAs':
				return findBlobForIdent(_p189._1);
			default:
				return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$ExpressionBasedTransform$matchesAnySelectedCallBlob = F2(
	function (selectedNiceBlobs, def) {
		var _p190 = A2(_user$project$ExpressionBasedTransform$matchesAnySelectedCallBlob_, selectedNiceBlobs, def);
		if (_p190.ctor === 'Just') {
			return true;
		} else {
			return false;
		}
	});
var _user$project$ExpressionBasedTransform$matchesAnySelectedVarBlob_ = F2(
	function (selectedNiceBlobs, def) {
		var findBlobForIdent = function (y) {
			var foo = function (_p191) {
				var _p192 = _p191;
				var _p193 = _p192._2;
				switch (_p193.ctor) {
					case 'VarBlob':
						return _elm_lang$core$Native_Utils.eq(_p193._0, y);
					case 'WithBoundsBlob':
						return false;
					case 'WithAnchorBlob':
						return false;
					default:
						return false;
				}
			};
			var _p194 = A2(_user$project$Utils$findFirst, foo, selectedNiceBlobs);
			if (((_p194.ctor === 'Just') && (_p194._0.ctor === '_Tuple3')) && (_p194._0._2.ctor === 'VarBlob')) {
				return _elm_lang$core$Maybe$Just(_p194._0._2._0);
			} else {
				return _elm_lang$core$Maybe$Nothing;
			}
		};
		var _p195 = def;
		var p = _p195._1;
		var _p196 = p.val.p__;
		switch (_p196.ctor) {
			case 'PVar':
				return findBlobForIdent(_p196._1);
			case 'PAs':
				return findBlobForIdent(_p196._1);
			default:
				return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$ExpressionBasedTransform$matchesAnySelectedVarBlob = F2(
	function (selectedNiceBlobs, def) {
		var _p197 = A2(_user$project$ExpressionBasedTransform$matchesAnySelectedVarBlob_, selectedNiceBlobs, def);
		if (_p197.ctor === 'Just') {
			return true;
		} else {
			return false;
		}
	});
var _user$project$ExpressionBasedTransform$mergeSelectedVarBlobs = F4(
	function (model, defs, blobs, selectedVarBlobs) {
		var _p198 = function () {
			var selectedNiceBlobs = A2(
				_elm_lang$core$List$map,
				function (_p199) {
					var _p200 = _p199;
					return {
						ctor: '_Tuple3',
						_0: _p200._0,
						_1: _p200._1,
						_2: _user$project$Blobs$VarBlob(_p200._2)
					};
				},
				selectedVarBlobs);
			return A2(
				_user$project$ExpressionBasedTransform$pluckFromList,
				_user$project$ExpressionBasedTransform$matchesAnySelectedVarBlob(selectedNiceBlobs),
				defs);
		}();
		var pluckedDefs = _p198._0;
		var beforeDefs = _p198._1;
		var afterDefs = _p198._2;
		var _p201 = function () {
			var matches = function (_p202) {
				var _p203 = _p202;
				return A2(_elm_lang$core$Dict$member, _p203._0, model.selectedBlobs);
			};
			var _p204 = A2(
				_user$project$ExpressionBasedTransform$pluckFromList,
				matches,
				A2(
					_user$project$Utils$zip,
					A2(
						_elm_lang$core$List$range,
						1,
						_elm_lang$core$List$length(blobs)),
					blobs));
			var plucked = _p204._0;
			var before = _p204._1;
			var after = _p204._2;
			return {
				ctor: '_Tuple3',
				_0: A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$second, plucked),
				_1: A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$second, before),
				_2: A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$second, after)
			};
		}();
		var pluckedBlobs = _p201._0;
		var beforeBlobs = _p201._1;
		var afterBlobs = _p201._2;
		var _p205 = function () {
			var _p206 = pluckedDefs;
			if (_p206.ctor === '::') {
				return {
					ctor: '_Tuple2',
					_0: _p206._0,
					_1: A2(
						_elm_lang$core$List$map,
						function (_p207) {
							var _p208 = _p207;
							return _p208._2;
						},
						_p206._1)
				};
			} else {
				return _elm_lang$core$Native_Utils.crashCase(
					'ExpressionBasedTransform',
					{
						start: {line: 1526, column: 5},
						end: {line: 1528, column: 76}
					},
					_p206)('mergeSelectedVarBlobs: shouldn\'t get here');
			}
		}();
		var ws1 = _p205._0._0;
		var p = _p205._0._1;
		var e = _p205._0._2;
		var ws2 = _p205._0._3;
		var es = _p205._1;
		var _p210 = A2(_user$project$ExpressionBasedTransform$mergeExpressions, e, es);
		if (_p210.ctor === 'Nothing') {
			return {ctor: '_Tuple2', _0: defs, _1: blobs};
		} else {
			if (_p210._0._1.ctor === '[]') {
				var defs_ = A2(
					_elm_lang$core$Basics_ops['++'],
					beforeDefs,
					A2(
						_elm_lang$core$Basics_ops['++'],
						{
							ctor: '::',
							_0: {ctor: '_Tuple4', _0: ws1, _1: p, _2: e, _3: ws2},
							_1: {ctor: '[]'}
						},
						afterDefs));
				var blobs_ = A2(
					_elm_lang$core$Basics_ops['++'],
					beforeBlobs,
					A2(
						_elm_lang$core$Basics_ops['++'],
						{
							ctor: '::',
							_0: _user$project$Utils$head_(pluckedBlobs),
							_1: {ctor: '[]'}
						},
						afterBlobs));
				return {ctor: '_Tuple2', _0: defs_, _1: blobs_};
			} else {
				var _p215 = _p210._0._1;
				var newDef = function () {
					var newFunc = function () {
						var params = _user$project$Lang$listOfPVars(
							A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$first, _p215));
						return _user$project$Lang$withDummyExpInfo(
							A4(
								_user$project$Lang$EFun,
								_user$project$Lang$space1,
								params,
								_user$project$ExpressionBasedTransform$clean(_p210._0._0),
								_user$project$Lang$space0));
					}();
					return {ctor: '_Tuple4', _0: ws1, _1: p, _2: newFunc, _3: ws2};
				}();
				var f = function () {
					var _p211 = p.val.p__;
					if (_p211.ctor === 'PVar') {
						return _p211._1;
					} else {
						return _elm_lang$core$Native_Utils.crashCase(
							'ExpressionBasedTransform',
							{
								start: {line: 1551, column: 9},
								end: {line: 1553, column: 61}
							},
							_p211)('mergeSelected: not var');
					}
				}();
				var newBlobs = function () {
					var _p213 = _user$project$Utils$maybeZipN(
						A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$second, _p215));
					if (_p213.ctor === 'Nothing') {
						return _elm_lang$core$Native_Utils.crashCase(
							'ExpressionBasedTransform',
							{
								start: {line: 1556, column: 9},
								end: {line: 1565, column: 26}
							},
							_p213)('mergeSelected: no arg lists?');
					} else {
						return A2(
							_elm_lang$core$List$map,
							function (nums) {
								var args = _user$project$Lang$listOfAnnotatedNums1(nums);
								var e = _user$project$Lang$withDummyExpInfo(
									A4(
										_user$project$Lang$EApp,
										_user$project$Lang$ws('\n  '),
										_user$project$Lang$eVar0(f),
										args,
										_user$project$Lang$space0));
								return A2(
									_user$project$Blobs$callBlob,
									e,
									{ctor: '_Tuple2', _0: f, _1: args});
							},
							_p213._0);
					}
				}();
				var defs_ = A2(
					_elm_lang$core$Basics_ops['++'],
					beforeDefs,
					A2(
						_elm_lang$core$Basics_ops['++'],
						{
							ctor: '::',
							_0: newDef,
							_1: {ctor: '[]'}
						},
						afterDefs));
				var blobs_ = A2(
					_elm_lang$core$Basics_ops['++'],
					beforeBlobs,
					A2(_elm_lang$core$Basics_ops['++'], newBlobs, afterBlobs));
				return {ctor: '_Tuple2', _0: defs_, _1: blobs_};
			}
		}
	});
var _user$project$ExpressionBasedTransform$matchesAnySelectedBlob = F2(
	function (selectedNiceBlobs, def) {
		var _p216 = A2(_user$project$ExpressionBasedTransform$matchesAnySelectedVarBlob_, selectedNiceBlobs, def);
		if (_p216.ctor === 'Just') {
			return true;
		} else {
			var _p217 = A2(_user$project$ExpressionBasedTransform$matchesAnySelectedCallBlob_, selectedNiceBlobs, def);
			if (_p217.ctor === 'Just') {
				return true;
			} else {
				return false;
			}
		}
	});
var _user$project$ExpressionBasedTransform$groupAndRearrange = F8(
	function (model, newGroup, defs, blobs, selectedNiceBlobs, groupDefs, eSubst, finalExpOfNewGroup) {
		var _p218 = function () {
			var indexedBlobs = A2(
				_user$project$Utils$zip,
				A2(
					_elm_lang$core$List$range,
					1,
					_elm_lang$core$List$length(blobs)),
				blobs);
			var matches = function (_p219) {
				var _p220 = _p219;
				return A2(_elm_lang$core$Dict$member, _p220._0, model.selectedBlobs);
			};
			var _p221 = A2(_user$project$ExpressionBasedTransform$pluckFromList, matches, indexedBlobs);
			var plucked_ = _p221._0;
			var before_ = _p221._1;
			var after_ = _p221._2;
			return {
				ctor: '_Tuple3',
				_0: A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$second, plucked_),
				_1: A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$second, before_),
				_2: A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$second, after_)
			};
		}();
		var pluckedBlobs = _p218._0;
		var beforeBlobs = _p218._1;
		var afterBlobs = _p218._2;
		var defs_ = function () {
			var matches = _user$project$ExpressionBasedTransform$matchesAnySelectedBlob(selectedNiceBlobs);
			var _p222 = function () {
				var _p223 = A2(_user$project$ExpressionBasedTransform$unsafePluckFromList, matches, defs);
				var plucked = _p223._0;
				var before = _p223._1;
				var after = _p223._2;
				var getExps = _elm_lang$core$List$map(
					function (_p224) {
						var _p225 = _p224;
						return _p225._2;
					});
				var _p226 = A3(
					_elm_lang$core$List$foldr,
					F2(
						function (beforeDef, _p227) {
							var _p228 = _p227;
							var _p231 = _p228._1;
							var _p230 = _p228._0;
							var _p229 = beforeDef;
							var p = _p229._1;
							var vars = _user$project$Lang$varsOfPat(p);
							var someVarAppearsIn = function (e) {
								return A2(
									_elm_lang$core$List$any,
									function (x) {
										return A2(_user$project$ExpressionBasedTransform$occursFreeIn, x, e);
									},
									vars);
							};
							var noVarAppearsIn = function (e) {
								return A2(
									_elm_lang$core$List$all,
									function (x) {
										return !A2(_user$project$ExpressionBasedTransform$occursFreeIn, x, e);
									},
									vars);
							};
							return (A2(
								_elm_lang$core$List$any,
								someVarAppearsIn,
								getExps(
									A2(_elm_lang$core$Basics_ops['++'], plucked, _p230))) && A2(
								_elm_lang$core$List$all,
								noVarAppearsIn,
								getExps(
									A2(_elm_lang$core$Basics_ops['++'], after, _p231)))) ? {
								ctor: '_Tuple2',
								_0: {ctor: '::', _0: beforeDef, _1: _p230},
								_1: _p231
							} : {
								ctor: '_Tuple2',
								_0: _p230,
								_1: {ctor: '::', _0: beforeDef, _1: _p231}
							};
						}),
					{
						ctor: '_Tuple2',
						_0: {ctor: '[]'},
						_1: {ctor: '[]'}
					},
					before);
				var beforeInside = _p226._0;
				var beforeOutside = _p226._1;
				return {
					ctor: '_Tuple3',
					_0: A2(_elm_lang$core$Basics_ops['++'], beforeInside, plucked),
					_1: beforeOutside,
					_2: after
				};
			}();
			var pluckedDefs = _p222._0;
			var beforeDefs = _p222._1;
			var afterDefs = _p222._2;
			var listGroup = function () {
				var pluckedBlobs_ = A2(
					_elm_lang$core$List$map,
					function (_p232) {
						return A2(
							_user$project$Lang$replacePrecedingWhitespace,
							' ',
							_user$project$Blobs$fromBlobExp(_p232));
					},
					pluckedBlobs);
				return finalExpOfNewGroup(pluckedBlobs_);
			}();
			var pluckedDefs_ = function () {
				var tab = '  ';
				return A2(
					_elm_lang$core$List$map,
					function (_p233) {
						var _p234 = _p233;
						return {
							ctor: '_Tuple4',
							_0: _user$project$Lang$ws(
								A2(_elm_lang$core$Basics_ops['++'], _p234._0.val, tab)),
							_1: _p234._1,
							_2: A2(_user$project$Lang$indent, tab, _p234._2),
							_3: _user$project$Lang$ws(_p234._3.val)
						};
					},
					pluckedDefs);
			}();
			var newGroupExp = A2(
				_user$project$Lang$applyESubst,
				eSubst,
				_user$project$Blobs$fuseExp(
					{
						ctor: '_Tuple2',
						_0: A2(_elm_lang$core$Basics_ops['++'], groupDefs, pluckedDefs_),
						_1: _user$project$Blobs$OtherExp(listGroup)
					}));
			var newDef = {
				ctor: '_Tuple4',
				_0: _user$project$Lang$newline2,
				_1: _user$project$Lang$pVar(newGroup),
				_2: newGroupExp,
				_3: _user$project$Lang$space0
			};
			return A2(
				_elm_lang$core$Basics_ops['++'],
				beforeDefs,
				A2(
					_elm_lang$core$Basics_ops['++'],
					afterDefs,
					{
						ctor: '::',
						_0: newDef,
						_1: {ctor: '[]'}
					}));
		}();
		var blobs_ = function () {
			var newBlob = A2(
				_user$project$Blobs$varBlob,
				_user$project$Lang$withDummyExpInfo(
					A2(
						_user$project$Lang$EVar,
						_user$project$Lang$ws('\n  '),
						newGroup)),
				newGroup);
			return A2(
				_elm_lang$core$Basics_ops['++'],
				beforeBlobs,
				A2(
					_elm_lang$core$Basics_ops['++'],
					{
						ctor: '::',
						_0: newBlob,
						_1: {ctor: '[]'}
					},
					afterBlobs));
		}();
		return {ctor: '_Tuple2', _0: defs_, _1: blobs_};
	});
var _user$project$ExpressionBasedTransform$selectedBlobsToSelectedNiceBlobs = F2(
	function (model, blobs) {
		var selectedExps = A2(
			_elm_lang$core$List$filter,
			function (_p235) {
				return A3(
					_elm_lang$core$Basics$flip,
					_elm_lang$core$Dict$member,
					model.selectedBlobs,
					_elm_lang$core$Tuple$first(_p235));
			},
			A2(
				_user$project$Utils$zip,
				A2(
					_elm_lang$core$List$range,
					1,
					_elm_lang$core$List$length(blobs)),
				blobs));
		return _user$project$Utils$filterJusts(
			A2(
				_elm_lang$core$List$map,
				function (_p236) {
					var _p237 = _p236;
					var _p238 = _p237._1;
					if (_p238.ctor === 'NiceBlob') {
						return _elm_lang$core$Maybe$Just(
							{ctor: '_Tuple3', _0: _p237._0, _1: _p238._0, _2: _p238._1});
					} else {
						return _elm_lang$core$Maybe$Nothing;
					}
				},
				selectedExps));
	});
var _user$project$ExpressionBasedTransform$groupSelectedBlobs = F2(
	function (model, _p239) {
		var _p240 = _p239;
		var _p243 = _p240._1;
		var selectedNiceBlobs = A2(_user$project$ExpressionBasedTransform$selectedBlobsToSelectedNiceBlobs, model, _p243);
		var selectedBlobsAndBounds = _user$project$ExpressionBasedTransform$computeSelectedBlobsAndBounds(model);
		var newGroup = A2(
			_elm_lang$core$Basics_ops['++'],
			'newGroup',
			_elm_lang$core$Basics$toString(model.genSymCount));
		var _p241 = A2(_user$project$ExpressionBasedTransform$rewriteBoundingBoxesOfSelectedBlobs, model, selectedBlobsAndBounds);
		var groupDefs = _p241._0;
		var eSubst = _p241._1;
		var _p242 = A8(
			_user$project$ExpressionBasedTransform$groupAndRearrange,
			model,
			newGroup,
			_p240._0,
			_p243,
			selectedNiceBlobs,
			groupDefs,
			eSubst,
			function (pluckedBlobs_) {
				return _user$project$Lang$withDummyExpInfo(
					A5(
						_user$project$Lang$EList,
						_user$project$Lang$ws('\n\n  '),
						{
							ctor: '::',
							_0: _user$project$Lang$withDummyExpInfo(
								A4(
									_user$project$Lang$EApp,
									_user$project$Lang$space1,
									_user$project$Lang$eVar0('group'),
									{
										ctor: '::',
										_0: _user$project$Lang$eVar('bounds'),
										_1: {
											ctor: '::',
											_0: _user$project$Lang$withDummyExpInfo(
												A4(
													_user$project$Lang$EApp,
													_user$project$Lang$space1,
													_user$project$Lang$eVar0('concat'),
													{
														ctor: '::',
														_0: _user$project$Lang$withDummyExpInfo(
															A5(_user$project$Lang$EList, _user$project$Lang$space1, pluckedBlobs_, _user$project$Lang$space0, _elm_lang$core$Maybe$Nothing, _user$project$Lang$space1)),
														_1: {ctor: '[]'}
													},
													_user$project$Lang$space0)),
											_1: {ctor: '[]'}
										}
									},
									_user$project$Lang$space0)),
							_1: {ctor: '[]'}
						},
						_user$project$Lang$space0,
						_elm_lang$core$Maybe$Nothing,
						_user$project$Lang$space1));
			});
		var defs_ = _p242._0;
		var blobs_ = _p242._1;
		var code_ = _user$project$LangUnparser$unparse(
			_user$project$Blobs$fuseExp(
				{
					ctor: '_Tuple2',
					_0: defs_,
					_1: A2(_user$project$Blobs$Blobs, blobs_, _p240._2)
				}));
		return _elm_lang$core$Native_Utils.update(
			model,
			{code: code_, genSymCount: model.genSymCount + 1, selectedBlobs: _elm_lang$core$Dict$empty});
	});
var _user$project$ExpressionBasedTransform$groupSelectedBlobsAround = F3(
	function (model, _p245, _p244) {
		var _p246 = _p245;
		var _p255 = _p246._1;
		var _p247 = _p244;
		var _p248 = A3(_user$project$LangSvg$justGetSvgNode, 'groupSelectedBlobsAround', _p247._0, model.slate);
		var anchorKind = _p248._0;
		var anchorAttrs = _p248._1;
		var _p249 = A3(_user$project$ShapeWidgets$getPointEquations, anchorKind, anchorAttrs, _p247._1);
		if (((((_p249.ctor === '_Tuple2') && (_p249._0.ctor === 'EqnNum')) && (_p249._0._0.ctor === '_Tuple2')) && (_p249._1.ctor === 'EqnNum')) && (_p249._1._0.ctor === '_Tuple2')) {
			var _p250 = {ctor: '_Tuple2', _0: _p249._0._0._1, _1: _p249._1._0._1};
			if (((_p250.ctor === '_Tuple2') && (_p250._0.ctor === 'TrLoc')) && (_p250._1.ctor === 'TrLoc')) {
				var selectedNiceBlobs = A2(_user$project$ExpressionBasedTransform$selectedBlobsToSelectedNiceBlobs, model, _p255);
				var newGroup = A2(
					_elm_lang$core$Basics_ops['++'],
					'newGroup',
					_elm_lang$core$Basics$toString(model.genSymCount));
				var _p251 = A3(
					_user$project$ExpressionBasedTransform$rewritePrimitivePointsOfSelectedBlobs,
					model,
					{ctor: '_Tuple2', _0: _p249._0._0._0, _1: _p250._0._0},
					{ctor: '_Tuple2', _0: _p249._1._0._0, _1: _p250._1._0});
				var groupDefs = _p251._0;
				var eSubst = _p251._1;
				var _p252 = A8(
					_user$project$ExpressionBasedTransform$groupAndRearrange,
					model,
					newGroup,
					_p246._0,
					_p255,
					selectedNiceBlobs,
					groupDefs,
					eSubst,
					function (pluckedBlobs_) {
						return _user$project$Lang$withDummyExpInfo(
							A5(
								_user$project$Lang$EList,
								_user$project$Lang$ws('\n\n  '),
								{
									ctor: '::',
									_0: _user$project$Lang$withDummyExpInfo(
										A4(
											_user$project$Lang$EApp,
											_user$project$Lang$space1,
											_user$project$Lang$eVar0('anchoredGroup'),
											{
												ctor: '::',
												_0: _user$project$Lang$withDummyExpInfo(
													A4(
														_user$project$Lang$EApp,
														_user$project$Lang$space1,
														_user$project$Lang$eVar0('concat'),
														{
															ctor: '::',
															_0: _user$project$Lang$withDummyExpInfo(
																A5(_user$project$Lang$EList, _user$project$Lang$space1, pluckedBlobs_, _user$project$Lang$space0, _elm_lang$core$Maybe$Nothing, _user$project$Lang$space1)),
															_1: {ctor: '[]'}
														},
														_user$project$Lang$space0)),
												_1: {ctor: '[]'}
											},
											_user$project$Lang$space0)),
									_1: {ctor: '[]'}
								},
								_user$project$Lang$space0,
								_elm_lang$core$Maybe$Nothing,
								_user$project$Lang$space1));
					});
				var defs_ = _p252._0;
				var blobs_ = _p252._1;
				var code_ = _user$project$LangUnparser$unparse(
					_user$project$Blobs$fuseExp(
						{
							ctor: '_Tuple2',
							_0: defs_,
							_1: A2(_user$project$Blobs$Blobs, blobs_, _p246._2)
						}));
				return _elm_lang$core$Native_Utils.update(
					model,
					{code: code_, genSymCount: model.genSymCount + 1, selectedBlobs: _elm_lang$core$Dict$empty, selectedFeatures: _elm_lang$core$Set$empty});
			} else {
				var _p253 = A2(
					_elm_lang$core$Debug$log,
					'WARN: anchor must be defined by constants',
					{ctor: '_Tuple0'});
				return model;
			}
		} else {
			var _p254 = A2(
				_elm_lang$core$Debug$log,
				'WARN: for now, anchor must be a primitive point',
				{ctor: '_Tuple0'});
			return model;
		}
	});
var _user$project$ExpressionBasedTransform$selectedBlobsToSelectedVarBlobs = F2(
	function (model, blobs) {
		return A2(
			_elm_lang$core$List$concatMap,
			function (_p256) {
				var _p257 = _p256;
				var _p258 = _p257._2;
				switch (_p258.ctor) {
					case 'VarBlob':
						return {
							ctor: '::',
							_0: {ctor: '_Tuple3', _0: _p257._0, _1: _p257._1, _2: _p258._0},
							_1: {ctor: '[]'}
						};
					case 'WithBoundsBlob':
						return {ctor: '[]'};
					case 'WithAnchorBlob':
						return {ctor: '[]'};
					default:
						return {ctor: '[]'};
				}
			},
			A2(_user$project$ExpressionBasedTransform$selectedBlobsToSelectedNiceBlobs, model, blobs));
	});
var _user$project$ExpressionBasedTransform$mergeSelectedBlobs = function (model) {
	var _p259 = _user$project$Blobs$splitExp(model.inputExp);
	var defs = _p259._0;
	var mainExp = _p259._1;
	var _p260 = mainExp;
	if (_p260.ctor === 'Blobs') {
		var _p262 = _p260._0;
		var selectedVarBlobs = A2(_user$project$ExpressionBasedTransform$selectedBlobsToSelectedVarBlobs, model, _p262);
		if (!_elm_lang$core$Native_Utils.eq(
			_elm_lang$core$List$length(selectedVarBlobs),
			_elm_lang$core$Dict$size(model.selectedBlobs))) {
			return model;
		} else {
			var _p261 = A4(_user$project$ExpressionBasedTransform$mergeSelectedVarBlobs, model, defs, _p262, selectedVarBlobs);
			var defs_ = _p261._0;
			var blobs_ = _p261._1;
			var code_ = _user$project$LangUnparser$unparse(
				_user$project$Blobs$fuseExp(
					{
						ctor: '_Tuple2',
						_0: defs_,
						_1: A2(_user$project$Blobs$Blobs, blobs_, _p260._1)
					}));
			return _elm_lang$core$Native_Utils.update(
				model,
				{code: code_, selectedBlobs: _elm_lang$core$Dict$empty});
		}
	} else {
		return model;
	}
};
var _user$project$ExpressionBasedTransform$replicateSelectedBlob = F3(
	function (replicateKind, model, _p263) {
		var _p264 = _p263;
		var _p280 = _p264._2;
		var _p279 = _p264._0;
		var _p278 = _p264._1;
		var _p265 = A2(_user$project$ExpressionBasedTransform$selectedBlobsToSelectedNiceBlobs, model, _p278);
		_v119_2:
		do {
			if (((_p265.ctor === '::') && (_p265._0.ctor === '_Tuple3')) && (_p265._1.ctor === '[]')) {
				switch (_p265._0._2.ctor) {
					case 'WithAnchorBlob':
						if (_p265._0._2._0.ctor === '_Tuple3') {
							var _p270 = _p265._0._2._0._0;
							var eGroupFunc = _user$project$Lang$withDummyExpInfo(
								A4(
									_user$project$Lang$EApp,
									_user$project$Lang$ws('\n    '),
									_user$project$Lang$eVar0(_p265._0._2._0._1),
									_p265._0._2._0._2,
									_user$project$Lang$space0));
							var eAnchor = A2(_user$project$Lang$replacePrecedingWhitespace, '\n    ', _p270);
							var _p266 = function () {
								var _p267 = replicateKind;
								switch (_p267.ctor) {
									case 'HorizontalRepeat':
										var eNum = _user$project$Lang$withDummyExpInfo(
											A4(
												_user$project$Lang$EConst,
												_user$project$Lang$space1,
												3,
												_user$project$Lang$dummyLoc_(_user$project$Lang$frozen),
												A2(_user$project$Lang$intSlider, 1, 20)));
										var eSep = _user$project$Lang$withDummyExpInfo(
											A4(_user$project$Lang$EConst, _user$project$Lang$space1, 20, _user$project$Lang$dummyLoc, _user$project$Lang$noWidgetDecl));
										return {
											ctor: '_Tuple2',
											_0: 'horizontalArray',
											_1: {
												ctor: '::',
												_0: eNum,
												_1: {
													ctor: '::',
													_0: eSep,
													_1: {
														ctor: '::',
														_0: eGroupFunc,
														_1: {
															ctor: '::',
															_0: eAnchor,
															_1: {ctor: '[]'}
														}
													}
												}
											}
										};
									case 'LinearRepeat':
										var eNum = _user$project$Lang$withDummyExpInfo(
											A4(
												_user$project$Lang$EConst,
												_user$project$Lang$space1,
												3,
												_user$project$Lang$dummyLoc_(_user$project$Lang$frozen),
												A2(_user$project$Lang$intSlider, 1, 20)));
										var eStart = A2(_user$project$Lang$replacePrecedingWhitespace, '\n    ', _p270);
										var eEnd = function () {
											var _p268 = _user$project$ExpressionBasedTransform$stripPointExp(_p270);
											if (_p268.ctor === 'Nothing') {
												return eAnchor;
											} else {
												var ex_ = A2(_user$project$Lang$eConst0, _p268._0._0 + 100, _user$project$Lang$dummyLoc);
												var ey_ = A2(_user$project$Lang$eConst, _p268._0._1 + 50, _user$project$Lang$dummyLoc);
												return A2(
													_user$project$Lang$replacePrecedingWhitespace,
													'\n    ',
													_user$project$ExpressionBasedTransform$eAsPoint(
														A2(
															_user$project$Lang$eList,
															{
																ctor: '::',
																_0: ex_,
																_1: {
																	ctor: '::',
																	_0: ey_,
																	_1: {ctor: '[]'}
																}
															},
															_elm_lang$core$Maybe$Nothing)));
											}
										}();
										return {
											ctor: '_Tuple2',
											_0: 'linearArrayFromTo',
											_1: {
												ctor: '::',
												_0: eNum,
												_1: {
													ctor: '::',
													_0: eGroupFunc,
													_1: {
														ctor: '::',
														_0: eStart,
														_1: {
															ctor: '::',
															_0: eEnd,
															_1: {ctor: '[]'}
														}
													}
												}
											}
										};
									default:
										var nRadius = 100;
										var eNum = _user$project$Lang$withDummyExpInfo(
											A4(
												_user$project$Lang$EConst,
												_user$project$Lang$space1,
												3,
												_user$project$Lang$dummyLoc_(_user$project$Lang$frozen),
												A2(_user$project$Lang$intSlider, 1, 20)));
										var eRadius = _user$project$Lang$withDummyExpInfo(
											A4(
												_user$project$Lang$EConst,
												_user$project$Lang$space1,
												nRadius,
												_user$project$Lang$dummyLoc_(_user$project$Lang$unann),
												_user$project$Lang$noWidgetDecl));
										var eRot = _user$project$Lang$withDummyExpInfo(
											A4(
												_user$project$Lang$EConst,
												_user$project$Lang$space1,
												0,
												_user$project$Lang$dummyLoc_(_user$project$Lang$frozen),
												A2(_user$project$Lang$numSlider, 0, 6.28)));
										var eCenter = function () {
											var _p269 = _user$project$ExpressionBasedTransform$stripPointExp(_p270);
											if (_p269.ctor === 'Nothing') {
												return eAnchor;
											} else {
												var ex_ = A2(_user$project$Lang$eConst0, _p269._0._0, _user$project$Lang$dummyLoc);
												var ey_ = A2(_user$project$Lang$eConst, _p269._0._1 + nRadius, _user$project$Lang$dummyLoc);
												return A2(
													_user$project$Lang$replacePrecedingWhitespace,
													'\n    ',
													_user$project$ExpressionBasedTransform$eAsPoint(
														A2(
															_user$project$Lang$eList,
															{
																ctor: '::',
																_0: ex_,
																_1: {
																	ctor: '::',
																	_0: ey_,
																	_1: {ctor: '[]'}
																}
															},
															_elm_lang$core$Maybe$Nothing)));
											}
										}();
										return {
											ctor: '_Tuple2',
											_0: 'radialArray',
											_1: {
												ctor: '::',
												_0: eNum,
												_1: {
													ctor: '::',
													_0: eRadius,
													_1: {
														ctor: '::',
														_0: eRot,
														_1: {
															ctor: '::',
															_0: eGroupFunc,
															_1: {
																ctor: '::',
																_0: eCenter,
																_1: {ctor: '[]'}
															}
														}
													}
												}
											}
										};
								}
							}();
							var arrayFunction = _p266._0;
							var arrayArgs = _p266._1;
							var newBlob = A2(
								_user$project$Blobs$NiceBlob,
								_user$project$Lang$withDummyExpInfo(
									A4(
										_user$project$Lang$EApp,
										_user$project$Lang$ws('\n  '),
										_user$project$Lang$eVar0(arrayFunction),
										arrayArgs,
										_user$project$Lang$space0)),
								_user$project$Blobs$CallBlob(
									{ctor: '_Tuple2', _0: arrayFunction, _1: arrayArgs}));
							var blobs_ = A3(_user$project$Utils$replacei, _p265._0._0, newBlob, _p278);
							var code_ = _user$project$LangUnparser$unparse(
								_user$project$Blobs$fuseExp(
									{
										ctor: '_Tuple2',
										_0: _p279,
										_1: A2(_user$project$Blobs$Blobs, blobs_, _p280)
									}));
							return _elm_lang$core$Native_Utils.update(
								model,
								{code: code_, selectedBlobs: _elm_lang$core$Dict$empty});
						} else {
							break _v119_2;
						}
					case 'WithBoundsBlob':
						if (_p265._0._2._0.ctor === '_Tuple3') {
							var _p277 = _p265._0._2._0._0;
							var eGroupFunc = _user$project$Lang$withDummyExpInfo(
								A4(
									_user$project$Lang$EApp,
									_user$project$Lang$ws('\n    '),
									_user$project$Lang$eVar0(_p265._0._2._0._1),
									_p265._0._2._0._2,
									_user$project$Lang$space0));
							var eBounds = A2(_user$project$Lang$replacePrecedingWhitespace, '\n    ', _p277);
							var _p271 = function () {
								var _p272 = replicateKind;
								switch (_p272.ctor) {
									case 'HorizontalRepeat':
										var eNum = _user$project$Lang$withDummyExpInfo(
											A4(
												_user$project$Lang$EConst,
												_user$project$Lang$space1,
												3,
												_user$project$Lang$dummyLoc_(_user$project$Lang$frozen),
												A2(_user$project$Lang$intSlider, 1, 10)));
										var eSep = _user$project$Lang$withDummyExpInfo(
											A4(_user$project$Lang$EConst, _user$project$Lang$space1, 20, _user$project$Lang$dummyLoc, _user$project$Lang$noWidgetDecl));
										return {
											ctor: '_Tuple2',
											_0: 'horizontalArrayByBounds',
											_1: {
												ctor: '::',
												_0: eNum,
												_1: {
													ctor: '::',
													_0: eSep,
													_1: {
														ctor: '::',
														_0: eGroupFunc,
														_1: {
															ctor: '::',
															_0: eBounds,
															_1: {ctor: '[]'}
														}
													}
												}
											}
										};
									case 'LinearRepeat':
										var _p273 = {ctor: '_Tuple2', _0: 3, _1: 20};
										var nNum = _p273._0;
										var nSep = _p273._1;
										var eNum = _user$project$Lang$withDummyExpInfo(
											A4(
												_user$project$Lang$EConst,
												_user$project$Lang$space1,
												nNum,
												_user$project$Lang$dummyLoc_(_user$project$Lang$frozen),
												A2(_user$project$Lang$intSlider, 1, 20)));
										var eSep = _user$project$Lang$withDummyExpInfo(
											A4(_user$project$Lang$EConst, _user$project$Lang$space1, nSep, _user$project$Lang$dummyLoc, _user$project$Lang$noWidgetDecl));
										var eGroupBounds = function () {
											var _p274 = _user$project$ExpressionBasedTransform$stripBoundsExp(_p277);
											if (_p274.ctor === 'Nothing') {
												return eBounds;
											} else {
												var _p275 = _p274._0._0;
												var eLeft = A2(_user$project$Lang$eConst0, _p275, _user$project$Lang$dummyLoc);
												var eTop = A2(_user$project$Lang$eConst, _p274._0._1, _user$project$Lang$dummyLoc);
												var eRight = A2(_user$project$Lang$eConst, (_p275 + (nNum * (_p274._0._2 - _p275))) + ((nNum - 1) * nSep), _user$project$Lang$dummyLoc);
												var eBot = A2(_user$project$Lang$eConst, _p274._0._3, _user$project$Lang$dummyLoc);
												return A2(
													_user$project$Lang$replacePrecedingWhitespace,
													'\n    ',
													A2(
														_user$project$Lang$eList,
														{
															ctor: '::',
															_0: eLeft,
															_1: {
																ctor: '::',
																_0: eTop,
																_1: {
																	ctor: '::',
																	_0: eRight,
																	_1: {
																		ctor: '::',
																		_0: eBot,
																		_1: {ctor: '[]'}
																	}
																}
															}
														},
														_elm_lang$core$Maybe$Nothing));
											}
										}();
										return {
											ctor: '_Tuple2',
											_0: 'repeatInsideBounds',
											_1: {
												ctor: '::',
												_0: eNum,
												_1: {
													ctor: '::',
													_0: eSep,
													_1: {
														ctor: '::',
														_0: eGroupFunc,
														_1: {
															ctor: '::',
															_0: eGroupBounds,
															_1: {ctor: '[]'}
														}
													}
												}
											}
										};
									default:
										return _elm_lang$core$Native_Utils.crashCase(
											'ExpressionBasedTransform',
											{
												start: {line: 1346, column: 9},
												end: {line: 1371, column: 54}
											},
											_p272)('replicateSelectedBlob: TODO');
								}
							}();
							var arrayFunction = _p271._0;
							var arrayArgs = _p271._1;
							var newBlob = A2(
								_user$project$Blobs$NiceBlob,
								_user$project$Lang$withDummyExpInfo(
									A4(
										_user$project$Lang$EApp,
										_user$project$Lang$ws('\n  '),
										_user$project$Lang$eVar0(arrayFunction),
										arrayArgs,
										_user$project$Lang$space0)),
								_user$project$Blobs$CallBlob(
									{ctor: '_Tuple2', _0: arrayFunction, _1: arrayArgs}));
							var blobs_ = A3(_user$project$Utils$replacei, _p265._0._0, newBlob, _p278);
							var code_ = _user$project$LangUnparser$unparse(
								_user$project$Blobs$fuseExp(
									{
										ctor: '_Tuple2',
										_0: _p279,
										_1: A2(_user$project$Blobs$Blobs, blobs_, _p280)
									}));
							return _elm_lang$core$Native_Utils.update(
								model,
								{code: code_, selectedBlobs: _elm_lang$core$Dict$empty});
						} else {
							break _v119_2;
						}
					default:
						break _v119_2;
				}
			} else {
				break _v119_2;
			}
		} while(false);
		return model;
	});
var _user$project$ExpressionBasedTransform$duplicateSelectedBlobs = function (model) {
	var _p281 = _user$project$Blobs$splitExp(model.inputExp);
	var defs = _p281._0;
	var mainExp = _p281._1;
	var _p282 = mainExp;
	if (_p282.ctor === 'Blobs') {
		var _p298 = _p282._0;
		var _p283 = function () {
			var selectedNiceBlobs = A2(_user$project$ExpressionBasedTransform$selectedBlobsToSelectedNiceBlobs, model, _p298);
			var _p284 = A3(
				_elm_lang$core$List$foldl,
				F2(
					function (def, _p285) {
						var _p286 = _p285;
						var _p292 = _p286._0;
						var _p291 = _p286._2;
						var _p290 = _p286._1;
						if (!A2(_user$project$ExpressionBasedTransform$matchesAnySelectedVarBlob, selectedNiceBlobs, def)) {
							return {ctor: '_Tuple3', _0: _p292, _1: _p290, _2: _p291};
						} else {
							var _p287 = def;
							var ws1 = _p287._0;
							var p = _p287._1;
							var e = _p287._2;
							var ws2 = _p287._3;
							var _p288 = p.val.p__;
							if (_p288.ctor === 'PVar') {
								var x_ = A2(
									_elm_lang$core$Basics_ops['++'],
									_p288._1,
									A2(
										_elm_lang$core$Basics_ops['++'],
										'_copy',
										_elm_lang$core$Basics$toString(_p292)));
								var acc1_ = {
									ctor: '::',
									_0: {
										ctor: '_Tuple4',
										_0: ws1,
										_1: _user$project$Lang$withDummyPatInfo(
											A3(_user$project$Lang$PVar, _p288._0, x_, _p288._2)),
										_2: e,
										_3: ws2
									},
									_1: _p290
								};
								var acc2_ = {
									ctor: '::',
									_0: A2(
										_user$project$Blobs$varBlob,
										_user$project$Lang$withDummyExpInfo(
											A2(
												_user$project$Lang$EVar,
												_user$project$Lang$ws('\n  '),
												x_)),
										x_),
									_1: _p291
								};
								return {ctor: '_Tuple3', _0: 1 + _p292, _1: acc1_, _2: acc2_};
							} else {
								var _p289 = A2(
									_elm_lang$core$Debug$log,
									'duplicateSelectedBlobs: weird...',
									{ctor: '_Tuple0'});
								return {ctor: '_Tuple3', _0: _p292, _1: _p290, _2: _p291};
							}
						}
					}),
				{
					ctor: '_Tuple3',
					_0: model.genSymCount,
					_1: {ctor: '[]'},
					_2: {ctor: '[]'}
				},
				defs);
			var nextGenSym_ = _p284._0;
			var newDefs_ = _p284._1;
			var newVarBlobs_ = _p284._2;
			var newWithAndCallBlobs = A2(
				_elm_lang$core$List$concatMap,
				function (_p293) {
					var _p294 = _p293;
					var _p297 = _p294._2;
					var _p296 = _p294._1;
					var _p295 = _p297;
					switch (_p295.ctor) {
						case 'WithBoundsBlob':
							return {
								ctor: '::',
								_0: A2(_user$project$Blobs$NiceBlob, _p296, _p297),
								_1: {ctor: '[]'}
							};
						case 'WithAnchorBlob':
							return {
								ctor: '::',
								_0: A2(_user$project$Blobs$NiceBlob, _p296, _p297),
								_1: {ctor: '[]'}
							};
						case 'CallBlob':
							return {
								ctor: '::',
								_0: A2(_user$project$Blobs$NiceBlob, _p296, _p297),
								_1: {ctor: '[]'}
							};
						default:
							return {ctor: '[]'};
					}
				},
				selectedNiceBlobs);
			var newDefs = _elm_lang$core$List$reverse(newDefs_);
			var newBlobs = A2(
				_elm_lang$core$Basics_ops['++'],
				_elm_lang$core$List$reverse(newVarBlobs_),
				newWithAndCallBlobs);
			return {ctor: '_Tuple3', _0: nextGenSym_, _1: newDefs, _2: newBlobs};
		}();
		var nextGenSym = _p283._0;
		var newDefs = _p283._1;
		var newBlobs = _p283._2;
		var code_ = function () {
			var blobs_ = A2(_elm_lang$core$Basics_ops['++'], _p298, newBlobs);
			var defs_ = A2(_elm_lang$core$Basics_ops['++'], defs, newDefs);
			return _user$project$LangUnparser$unparse(
				_user$project$Blobs$fuseExp(
					{
						ctor: '_Tuple2',
						_0: defs_,
						_1: A2(_user$project$Blobs$Blobs, blobs_, _p282._1)
					}));
		}();
		return _elm_lang$core$Native_Utils.update(
			model,
			{
				code: code_,
				genSymCount: _elm_lang$core$List$length(newBlobs) + model.genSymCount
			});
	} else {
		return model;
	}
};
var _user$project$ExpressionBasedTransform$noExtraneousFreeVarsInRemovedClones = F2(
	function (cloneExps, commonScopeWhereAbstractionWillBeDefined) {
		var freeAtAbstraction = _user$project$LangTools$freeVars(commonScopeWhereAbstractionWillBeDefined);
		return A2(
			_elm_lang$core$List$all,
			function (cloneExp) {
				return A2(
					_elm_lang$core$List$all,
					function ($var) {
						return A2(_elm_lang$core$List$member, $var, freeAtAbstraction);
					},
					_user$project$LangTools$freeVars(cloneExp));
			},
			cloneExps);
	});
var _user$project$ExpressionBasedTransform$detectClones = F6(
	function (originalExp, candidateExpFilter, minCloneCount, minCloneSize, argCount, allowCurrying) {
		var argVar = _user$project$Lang$eVar('INSERT_ARGUMENT_HERE');
		var merge = F2(
			function (expA, expB) {
				merge:
				while (true) {
					var _p299 = {ctor: '_Tuple2', _0: expA.val.e__, _1: expB.val.e__};
					_v130_18:
					do {
						_v130_13:
						do {
							if (_p299.ctor === '_Tuple2') {
								switch (_p299._0.ctor) {
									case 'EConst':
										switch (_p299._1.ctor) {
											case 'EConst':
												return _elm_lang$core$Native_Utils.eq(_p299._0._1, _p299._1._1) ? expA : argVar;
											case 'EComment':
												break _v130_13;
											default:
												break _v130_18;
										}
									case 'EBase':
										switch (_p299._1.ctor) {
											case 'EBase':
												return A2(_user$project$Lang$eBaseValsEqual, _p299._0._1, _p299._1._1) ? expA : argVar;
											case 'EComment':
												break _v130_13;
											default:
												break _v130_18;
										}
									case 'EVar':
										switch (_p299._1.ctor) {
											case 'EVar':
												return _elm_lang$core$Native_Utils.eq(_p299._0._1, _p299._1._1) ? expA : argVar;
											case 'EComment':
												break _v130_13;
											default:
												break _v130_18;
										}
									case 'EFun':
										switch (_p299._1.ctor) {
											case 'EFun':
												var _p300 = _p299._0._1;
												return A2(_user$project$LangTools$patternListsEqual, _p300, _p299._1._1) ? A2(
													_user$project$Lang$replaceE__,
													expA,
													A4(
														_user$project$Lang$EFun,
														_p299._0._0,
														_p300,
														A2(merge, _p299._0._2, _p299._1._2),
														_p299._0._3)) : argVar;
											case 'EComment':
												break _v130_13;
											default:
												break _v130_18;
										}
									case 'EOp':
										switch (_p299._1.ctor) {
											case 'EOp':
												var _p304 = _p299._0._1;
												return _elm_lang$core$Native_Utils.eq(_p304.val, _p299._1._1.val) ? A2(
													_elm_lang$core$Maybe$withDefault,
													argVar,
													A2(
														_elm_lang$core$Maybe$map,
														function (_p301) {
															return function (newEs) {
																return A2(
																	_user$project$Lang$replaceE__,
																	expA,
																	A4(_user$project$Lang$EOp, _p299._0._0, _p304, newEs, _p299._0._3));
															}(
																A2(
																	_elm_lang$core$List$map,
																	function (_p302) {
																		var _p303 = _p302;
																		return A2(merge, _p303._0, _p303._1);
																	},
																	_p301));
														},
														A2(_user$project$Utils$maybeZip, _p299._0._2, _p299._1._2))) : argVar;
											case 'EComment':
												break _v130_13;
											default:
												break _v130_18;
										}
									case 'EList':
										switch (_p299._1.ctor) {
											case 'EList':
												if (_p299._0._3.ctor === 'Nothing') {
													if (_p299._1._3.ctor === 'Nothing') {
														return A2(
															_elm_lang$core$Maybe$withDefault,
															argVar,
															A2(
																_elm_lang$core$Maybe$map,
																function (_p305) {
																	return function (newEs) {
																		return A2(
																			_user$project$Lang$replaceE__,
																			expA,
																			A5(_user$project$Lang$EList, _p299._0._0, newEs, _p299._0._2, _elm_lang$core$Maybe$Nothing, _p299._0._4));
																	}(
																		A2(
																			_elm_lang$core$List$map,
																			function (_p306) {
																				var _p307 = _p306;
																				return A2(merge, _p307._0, _p307._1);
																			},
																			_p305));
																},
																A2(_user$project$Utils$maybeZip, _p299._0._1, _p299._1._1)));
													} else {
														break _v130_18;
													}
												} else {
													if (_p299._1._3.ctor === 'Just') {
														return A2(
															_elm_lang$core$Maybe$withDefault,
															argVar,
															A2(
																_elm_lang$core$Maybe$map,
																function (_p308) {
																	return function (newEs) {
																		return A2(
																			_user$project$Lang$replaceE__,
																			expA,
																			A5(
																				_user$project$Lang$EList,
																				_p299._0._0,
																				newEs,
																				_p299._0._2,
																				_elm_lang$core$Maybe$Just(
																					A2(merge, _p299._0._3._0, _p299._1._3._0)),
																				_p299._0._4));
																	}(
																		A2(
																			_elm_lang$core$List$map,
																			function (_p309) {
																				var _p310 = _p309;
																				return A2(merge, _p310._0, _p310._1);
																			},
																			_p308));
																},
																A2(_user$project$Utils$maybeZip, _p299._0._1, _p299._1._1)));
													} else {
														break _v130_18;
													}
												}
											case 'EComment':
												break _v130_13;
											default:
												break _v130_18;
										}
									case 'EApp':
										switch (_p299._1.ctor) {
											case 'EApp':
												return A2(
													_elm_lang$core$Maybe$withDefault,
													argVar,
													A2(
														_elm_lang$core$Maybe$map,
														function (_p311) {
															return function (newEs) {
																return A2(
																	_user$project$Lang$replaceE__,
																	expA,
																	A4(
																		_user$project$Lang$EApp,
																		_p299._0._0,
																		A2(merge, _p299._0._1, _p299._1._1),
																		newEs,
																		_p299._0._3));
															}(
																A2(
																	_elm_lang$core$List$map,
																	function (_p312) {
																		var _p313 = _p312;
																		return A2(merge, _p313._0, _p313._1);
																	},
																	_p311));
														},
														A2(_user$project$Utils$maybeZip, _p299._0._2, _p299._1._2)));
											case 'EComment':
												break _v130_13;
											default:
												break _v130_18;
										}
									case 'ELet':
										switch (_p299._1.ctor) {
											case 'ELet':
												var _p315 = _p299._0._2;
												var _p314 = _p299._0._3;
												return (_elm_lang$core$Native_Utils.eq(_p315, _p299._1._2) && A2(_user$project$LangTools$patternsEqual, _p314, _p299._1._3)) ? A2(
													_user$project$Lang$replaceE__,
													expA,
													A7(
														_user$project$Lang$ELet,
														_p299._0._0,
														_p299._0._1,
														_p315,
														_p314,
														A2(merge, _p299._0._4, _p299._1._4),
														A2(merge, _p299._0._5, _p299._1._5),
														_p299._0._6)) : argVar;
											case 'EComment':
												break _v130_13;
											default:
												break _v130_18;
										}
									case 'EIf':
										switch (_p299._1.ctor) {
											case 'EIf':
												return A2(
													_user$project$Lang$replaceE__,
													expA,
													A5(
														_user$project$Lang$EIf,
														_p299._0._0,
														A2(merge, _p299._0._1, _p299._1._1),
														A2(merge, _p299._0._2, _p299._1._2),
														A2(merge, _p299._0._3, _p299._1._3),
														_p299._0._4));
											case 'EComment':
												break _v130_13;
											default:
												break _v130_18;
										}
									case 'ECase':
										switch (_p299._1.ctor) {
											case 'ECase':
												return A2(
													_elm_lang$core$Maybe$withDefault,
													argVar,
													A2(
														_elm_lang$core$Maybe$andThen,
														function (branchPairs) {
															var bValPairs = A2(
																_elm_lang$core$List$map,
																function (_p316) {
																	var _p317 = _p316;
																	return {ctor: '_Tuple2', _0: _p317._0.val, _1: _p317._1.val};
																},
																branchPairs);
															return A2(
																_elm_lang$core$List$all,
																function (_p318) {
																	var _p319 = _p318;
																	return A2(_user$project$LangTools$patternsEqual, _p319._0._1, _p319._1._1);
																},
																bValPairs) ? _elm_lang$core$Maybe$Just(
																A2(
																	_user$project$Lang$replaceE__,
																	expA,
																	A4(
																		_user$project$Lang$ECase,
																		_p299._0._0,
																		A2(merge, _p299._0._1, _p299._1._1),
																		A2(
																			_elm_lang$core$List$map,
																			function (_p320) {
																				var _p321 = _p320;
																				return _elm_lang$core$Native_Utils.update(
																					_p321._0._0,
																					{
																						val: A4(
																							_user$project$Lang$Branch_,
																							_p321._1._0._0,
																							_p321._1._0._1,
																							A2(merge, _p321._1._0._2, _p321._1._1._2),
																							_p321._1._0._3)
																					});
																			},
																			A2(_user$project$Utils$zip, branchPairs, bValPairs)),
																		_p299._0._3))) : _elm_lang$core$Maybe$Nothing;
														},
														A2(_user$project$Utils$maybeZip, _p299._0._2, _p299._1._2)));
											case 'EComment':
												break _v130_13;
											default:
												break _v130_18;
										}
									case 'ETypeCase':
										switch (_p299._1.ctor) {
											case 'ETypeCase':
												var _p328 = _p299._0._1;
												return A2(_user$project$LangTools$patternsEqual, _p328, _p299._1._1) ? A2(
													_elm_lang$core$Maybe$withDefault,
													argVar,
													A2(
														_elm_lang$core$Maybe$andThen,
														function (tbranchPairs) {
															var tbValPairs = A2(
																_elm_lang$core$List$map,
																function (_p322) {
																	var _p323 = _p322;
																	return {ctor: '_Tuple2', _0: _p323._0.val, _1: _p323._1.val};
																},
																tbranchPairs);
															return A2(
																_elm_lang$core$List$all,
																function (_p324) {
																	var _p325 = _p324;
																	return A2(_user$project$Types$equal, _p325._0._1, _p325._1._1);
																},
																tbValPairs) ? _elm_lang$core$Maybe$Just(
																A2(
																	_user$project$Lang$replaceE__,
																	expA,
																	A4(
																		_user$project$Lang$ETypeCase,
																		_p299._0._0,
																		_p328,
																		A2(
																			_elm_lang$core$List$map,
																			function (_p326) {
																				var _p327 = _p326;
																				return _elm_lang$core$Native_Utils.update(
																					_p327._0._0,
																					{
																						val: A4(
																							_user$project$Lang$TBranch_,
																							_p327._1._0._0,
																							_p327._1._0._1,
																							A2(merge, _p327._1._0._2, _p327._1._1._2),
																							_p327._1._0._3)
																					});
																			},
																			A2(_user$project$Utils$zip, tbranchPairs, tbValPairs)),
																		_p299._0._3))) : _elm_lang$core$Maybe$Nothing;
														},
														A2(_user$project$Utils$maybeZip, _p299._0._2, _p299._1._2))) : argVar;
											case 'EComment':
												break _v130_13;
											default:
												break _v130_18;
										}
									case 'EComment':
										return A2(
											_user$project$Lang$replaceE__,
											expA,
											A3(
												_user$project$Lang$EComment,
												_p299._0._0,
												_p299._0._1,
												A2(merge, _p299._0._2, expB)));
									case 'EOption':
										switch (_p299._1.ctor) {
											case 'EComment':
												break _v130_13;
											case 'EOption':
												return argVar;
											default:
												break _v130_18;
										}
									case 'ETyp':
										switch (_p299._1.ctor) {
											case 'EComment':
												break _v130_13;
											case 'ETyp':
												var _p330 = _p299._0._2;
												var _p329 = _p299._0._1;
												return (A2(_user$project$LangTools$patternsEqual, _p329, _p299._1._1) && A2(_user$project$Types$equal, _p330, _p299._1._2)) ? A2(
													_user$project$Lang$replaceE__,
													expA,
													A5(
														_user$project$Lang$ETyp,
														_p299._0._0,
														_p329,
														_p330,
														A2(merge, _p299._0._3, _p299._1._3),
														_p299._0._4)) : argVar;
											default:
												break _v130_18;
										}
									case 'EColonType':
										switch (_p299._1.ctor) {
											case 'EComment':
												break _v130_13;
											case 'EColonType':
												var _p331 = _p299._0._3;
												return A2(_user$project$Types$equal, _p331, _p299._1._3) ? A2(
													_user$project$Lang$replaceE__,
													expA,
													A5(
														_user$project$Lang$EColonType,
														_p299._0._0,
														A2(merge, _p299._0._1, _p299._1._1),
														_p299._0._2,
														_p331,
														_p299._0._4)) : argVar;
											default:
												break _v130_18;
										}
									default:
										switch (_p299._1.ctor) {
											case 'EComment':
												break _v130_13;
											case 'ETypeAlias':
												var _p333 = _p299._0._2;
												var _p332 = _p299._0._1;
												return (A2(_user$project$LangTools$patternsEqual, _p332, _p299._1._1) && A2(_user$project$Types$equal, _p333, _p299._1._2)) ? A2(
													_user$project$Lang$replaceE__,
													expA,
													A5(
														_user$project$Lang$ETypeAlias,
														_p299._0._0,
														_p332,
														_p333,
														A2(merge, _p299._0._3, _p299._1._3),
														_p299._0._4)) : argVar;
											default:
												break _v130_18;
										}
								}
							} else {
								break _v130_18;
							}
						} while(false);
						var _v141 = expA,
							_v142 = _p299._1._2;
						expA = _v141;
						expB = _v142;
						continue merge;
					} while(false);
					return argVar;
				}
			});
		var mergeSingleArg = F2(
			function (expA, expB) {
				mergeSingleArg:
				while (true) {
					var retArgVar = {ctor: '_Tuple2', _0: argVar, _1: true};
					var retSame = {ctor: '_Tuple2', _0: expA, _1: false};
					var generalizedMerge = F6(
						function (precondition, maybeE1Pair, maybeE2Pair, maybeE3Pair, maybePairOfEs, newE__Func) {
							if (precondition) {
								var _p336 = function (_p334) {
									var _p335 = _p334;
									return A2(_user$project$Utils$maybeZip, _p335._0, _p335._1);
								}(
									A2(
										_elm_lang$core$Maybe$withDefault,
										{
											ctor: '_Tuple2',
											_0: {ctor: '[]'},
											_1: {ctor: '[]'}
										},
										maybePairOfEs));
								if (_p336.ctor === 'Nothing') {
									return retArgVar;
								} else {
									var _p337 = A2(
										_elm_lang$core$Maybe$withDefault,
										{
											ctor: '_Tuple2',
											_0: _user$project$Lang$eVar('ignored'),
											_1: false
										},
										A2(
											_elm_lang$core$Maybe$map,
											function (_p338) {
												var _p339 = _p338;
												return A2(mergeSingleArg, _p339._0, _p339._1);
											},
											maybeE1Pair));
									var e1Merged = _p337._0;
									var e1HasArgVar = _p337._1;
									var _p340 = A2(
										_elm_lang$core$Maybe$withDefault,
										{
											ctor: '_Tuple2',
											_0: _user$project$Lang$eVar('ignored'),
											_1: false
										},
										A2(
											_elm_lang$core$Maybe$map,
											function (_p341) {
												var _p342 = _p341;
												return A2(mergeSingleArg, _p342._0, _p342._1);
											},
											maybeE2Pair));
									var e2Merged = _p340._0;
									var e2HasArgVar = _p340._1;
									var _p343 = A2(
										_elm_lang$core$Maybe$withDefault,
										{
											ctor: '_Tuple2',
											_0: _user$project$Lang$eVar('ignored'),
											_1: false
										},
										A2(
											_elm_lang$core$Maybe$map,
											function (_p344) {
												var _p345 = _p344;
												return A2(mergeSingleArg, _p345._0, _p345._1);
											},
											maybeE3Pair));
									var e3Merged = _p343._0;
									var e3HasArgVar = _p343._1;
									var _p346 = _elm_lang$core$List$unzip(
										A2(
											_elm_lang$core$List$map,
											function (_p347) {
												var _p348 = _p347;
												return A2(mergeSingleArg, _p348._0, _p348._1);
											},
											_p336._0));
									var esMergers = _p346._0;
									var esHasArgVarBools = _p346._1;
									var argVarCount = A2(
										_user$project$Utils$count,
										F2(
											function (x, y) {
												return _elm_lang$core$Native_Utils.eq(x, y);
											})(true),
										{
											ctor: '::',
											_0: e1HasArgVar,
											_1: {
												ctor: '::',
												_0: e2HasArgVar,
												_1: {ctor: '::', _0: e3HasArgVar, _1: esHasArgVarBools}
											}
										});
									if (_elm_lang$core$Native_Utils.cmp(argVarCount, 1) < 1) {
										var newE__ = A4(newE__Func, e1Merged, e2Merged, e3Merged, esMergers);
										return {
											ctor: '_Tuple2',
											_0: A2(_user$project$Lang$replaceE__, expA, newE__),
											_1: _elm_lang$core$Native_Utils.eq(argVarCount, 1)
										};
									} else {
										return retArgVar;
									}
								}
							} else {
								return retArgVar;
							}
						});
					var _p349 = {ctor: '_Tuple2', _0: expA.val.e__, _1: expB.val.e__};
					_v149_18:
					do {
						_v149_13:
						do {
							if (_p349.ctor === '_Tuple2') {
								switch (_p349._0.ctor) {
									case 'EConst':
										switch (_p349._1.ctor) {
											case 'EConst':
												return _elm_lang$core$Native_Utils.eq(_p349._0._1, _p349._1._1) ? retSame : retArgVar;
											case 'EComment':
												break _v149_13;
											default:
												break _v149_18;
										}
									case 'EBase':
										switch (_p349._1.ctor) {
											case 'EBase':
												return A2(_user$project$Lang$eBaseValsEqual, _p349._0._1, _p349._1._1) ? retSame : retArgVar;
											case 'EComment':
												break _v149_13;
											default:
												break _v149_18;
										}
									case 'EVar':
										switch (_p349._1.ctor) {
											case 'EVar':
												return _elm_lang$core$Native_Utils.eq(_p349._0._1, _p349._1._1) ? retSame : retArgVar;
											case 'EComment':
												break _v149_13;
											default:
												break _v149_18;
										}
									case 'EFun':
										switch (_p349._1.ctor) {
											case 'EFun':
												var _p353 = _p349._0._1;
												return A6(
													generalizedMerge,
													A2(_user$project$LangTools$patternListsEqual, _p353, _p349._1._1),
													_elm_lang$core$Maybe$Just(
														{ctor: '_Tuple2', _0: _p349._0._2, _1: _p349._1._2}),
													_elm_lang$core$Maybe$Nothing,
													_elm_lang$core$Maybe$Nothing,
													_elm_lang$core$Maybe$Nothing,
													F4(
														function (mergedBody, _p352, _p351, _p350) {
															return A4(_user$project$Lang$EFun, _p349._0._0, _p353, mergedBody, _p349._0._3);
														}));
											case 'EComment':
												break _v149_13;
											default:
												break _v149_18;
										}
									case 'EOp':
										switch (_p349._1.ctor) {
											case 'EOp':
												var _p357 = _p349._0._1;
												return A6(
													generalizedMerge,
													_elm_lang$core$Native_Utils.eq(_p357.val, _p349._1._1.val),
													_elm_lang$core$Maybe$Nothing,
													_elm_lang$core$Maybe$Nothing,
													_elm_lang$core$Maybe$Nothing,
													_elm_lang$core$Maybe$Just(
														{ctor: '_Tuple2', _0: _p349._0._2, _1: _p349._1._2}),
													F4(
														function (_p356, _p355, _p354, mergedEs) {
															return A4(_user$project$Lang$EOp, _p349._0._0, _p357, mergedEs, _p349._0._3);
														}));
											case 'EComment':
												break _v149_13;
											default:
												break _v149_18;
										}
									case 'EList':
										switch (_p349._1.ctor) {
											case 'EList':
												if (_p349._0._3.ctor === 'Nothing') {
													if (_p349._1._3.ctor === 'Nothing') {
														return A6(
															generalizedMerge,
															true,
															_elm_lang$core$Maybe$Nothing,
															_elm_lang$core$Maybe$Nothing,
															_elm_lang$core$Maybe$Nothing,
															_elm_lang$core$Maybe$Just(
																{ctor: '_Tuple2', _0: _p349._0._1, _1: _p349._1._1}),
															F4(
																function (_p360, _p359, _p358, headMergers) {
																	return A5(_user$project$Lang$EList, _p349._0._0, headMergers, _p349._0._2, _elm_lang$core$Maybe$Nothing, _p349._0._4);
																}));
													} else {
														break _v149_18;
													}
												} else {
													if (_p349._1._3.ctor === 'Just') {
														return A6(
															generalizedMerge,
															true,
															_elm_lang$core$Maybe$Just(
																{ctor: '_Tuple2', _0: _p349._0._3._0, _1: _p349._1._3._0}),
															_elm_lang$core$Maybe$Nothing,
															_elm_lang$core$Maybe$Nothing,
															_elm_lang$core$Maybe$Just(
																{ctor: '_Tuple2', _0: _p349._0._1, _1: _p349._1._1}),
															F4(
																function (tailMerged, _p362, _p361, headMergers) {
																	return A5(
																		_user$project$Lang$EList,
																		_p349._0._0,
																		headMergers,
																		_p349._0._2,
																		_elm_lang$core$Maybe$Just(tailMerged),
																		_p349._0._4);
																}));
													} else {
														break _v149_18;
													}
												}
											case 'EComment':
												break _v149_13;
											default:
												break _v149_18;
										}
									case 'EApp':
										switch (_p349._1.ctor) {
											case 'EApp':
												return A6(
													generalizedMerge,
													true,
													_elm_lang$core$Maybe$Just(
														{ctor: '_Tuple2', _0: _p349._0._1, _1: _p349._1._1}),
													_elm_lang$core$Maybe$Nothing,
													_elm_lang$core$Maybe$Nothing,
													_elm_lang$core$Maybe$Just(
														{ctor: '_Tuple2', _0: _p349._0._2, _1: _p349._1._2}),
													F4(
														function (fMerged, _p364, _p363, argMergers) {
															return A4(_user$project$Lang$EApp, _p349._0._0, fMerged, argMergers, _p349._0._3);
														}));
											case 'EComment':
												break _v149_13;
											default:
												break _v149_18;
										}
									case 'ELet':
										switch (_p349._1.ctor) {
											case 'ELet':
												var _p368 = _p349._0._2;
												var _p367 = _p349._0._3;
												return A6(
													generalizedMerge,
													_elm_lang$core$Native_Utils.eq(_p368, _p349._1._2) && A2(_user$project$LangTools$patternsEqual, _p367, _p349._1._3),
													_elm_lang$core$Maybe$Just(
														{ctor: '_Tuple2', _0: _p349._0._4, _1: _p349._1._4}),
													_elm_lang$core$Maybe$Just(
														{ctor: '_Tuple2', _0: _p349._0._5, _1: _p349._1._5}),
													_elm_lang$core$Maybe$Nothing,
													_elm_lang$core$Maybe$Nothing,
													F4(
														function (e1Merged, e2Merged, _p366, _p365) {
															return A7(_user$project$Lang$ELet, _p349._0._0, _p349._0._1, _p368, _p367, e1Merged, e2Merged, _p349._0._6);
														}));
											case 'EComment':
												break _v149_13;
											default:
												break _v149_18;
										}
									case 'EIf':
										switch (_p349._1.ctor) {
											case 'EIf':
												return A6(
													generalizedMerge,
													true,
													_elm_lang$core$Maybe$Just(
														{ctor: '_Tuple2', _0: _p349._0._1, _1: _p349._1._1}),
													_elm_lang$core$Maybe$Just(
														{ctor: '_Tuple2', _0: _p349._0._2, _1: _p349._1._2}),
													_elm_lang$core$Maybe$Just(
														{ctor: '_Tuple2', _0: _p349._0._3, _1: _p349._1._3}),
													_elm_lang$core$Maybe$Nothing,
													F4(
														function (e1Merged, e2Merged, e3Merged, _p369) {
															return A5(_user$project$Lang$EIf, _p349._0._0, e1Merged, e2Merged, e3Merged, _p349._0._4);
														}));
											case 'EComment':
												break _v149_13;
											default:
												break _v149_18;
										}
									case 'ECase':
										switch (_p349._1.ctor) {
											case 'ECase':
												var _p373 = _p349._1._2;
												var _p372 = _p349._0._2;
												var precondition = A3(
													_user$project$Utils$listsEqualBy,
													_user$project$LangTools$patternsEqual,
													_user$project$Lang$branchPats(_p372),
													_user$project$Lang$branchPats(_p373));
												return A6(
													generalizedMerge,
													precondition,
													_elm_lang$core$Maybe$Just(
														{ctor: '_Tuple2', _0: _p349._0._1, _1: _p349._1._1}),
													_elm_lang$core$Maybe$Nothing,
													_elm_lang$core$Maybe$Nothing,
													_elm_lang$core$Maybe$Just(
														{
															ctor: '_Tuple2',
															_0: _user$project$Lang$branchExps(_p372),
															_1: _user$project$Lang$branchExps(_p373)
														}),
													F4(
														function (eMerged, _p371, _p370, branchExpsMerged) {
															return A4(
																_user$project$Lang$ECase,
																_p349._0._0,
																eMerged,
																A3(_elm_lang$core$List$map2, _user$project$Lang$replaceBranchExp, _p372, branchExpsMerged),
																_p349._0._3);
														}));
											case 'EComment':
												break _v149_13;
											default:
												break _v149_18;
										}
									case 'ETypeCase':
										switch (_p349._1.ctor) {
											case 'ETypeCase':
												var _p379 = _p349._1._2;
												var _p378 = _p349._0._2;
												var _p377 = _p349._0._1;
												var precondition = A2(_user$project$LangTools$patternsEqual, _p377, _p349._1._1) && A3(
													_user$project$Utils$listsEqualBy,
													_user$project$Types$equal,
													_user$project$Lang$tbranchTypes(_p378),
													_user$project$Lang$tbranchTypes(_p379));
												return A6(
													generalizedMerge,
													precondition,
													_elm_lang$core$Maybe$Nothing,
													_elm_lang$core$Maybe$Nothing,
													_elm_lang$core$Maybe$Nothing,
													_elm_lang$core$Maybe$Just(
														{
															ctor: '_Tuple2',
															_0: _user$project$Lang$tbranchExps(_p378),
															_1: _user$project$Lang$tbranchExps(_p379)
														}),
													F4(
														function (_p376, _p375, _p374, tbranchExpsMerged) {
															return A4(
																_user$project$Lang$ETypeCase,
																_p349._0._0,
																_p377,
																A3(_elm_lang$core$List$map2, _user$project$Lang$replaceTBranchExp, _p378, tbranchExpsMerged),
																_p349._0._3);
														}));
											case 'EComment':
												break _v149_13;
											default:
												break _v149_18;
										}
									case 'EComment':
										return function (_p380) {
											var _p381 = _p380;
											return {
												ctor: '_Tuple2',
												_0: A2(
													_user$project$Lang$replaceE__,
													expA,
													A3(_user$project$Lang$EComment, _p349._0._0, _p349._0._1, _p381._0)),
												_1: _p381._1
											};
										}(
											A2(mergeSingleArg, _p349._0._2, expB));
									case 'EOption':
										switch (_p349._1.ctor) {
											case 'EComment':
												break _v149_13;
											case 'EOption':
												return retArgVar;
											default:
												break _v149_18;
										}
									case 'ETyp':
										switch (_p349._1.ctor) {
											case 'EComment':
												break _v149_13;
											case 'ETyp':
												var _p386 = _p349._0._2;
												var _p385 = _p349._0._1;
												return A6(
													generalizedMerge,
													A2(_user$project$LangTools$patternsEqual, _p385, _p349._1._1) && A2(_user$project$Types$equal, _p386, _p349._1._2),
													_elm_lang$core$Maybe$Just(
														{ctor: '_Tuple2', _0: _p349._0._3, _1: _p349._1._3}),
													_elm_lang$core$Maybe$Nothing,
													_elm_lang$core$Maybe$Nothing,
													_elm_lang$core$Maybe$Nothing,
													F4(
														function (mergedE, _p384, _p383, _p382) {
															return A5(_user$project$Lang$ETyp, _p349._0._0, _p385, _p386, mergedE, _p349._0._4);
														}));
											default:
												break _v149_18;
										}
									case 'EColonType':
										switch (_p349._1.ctor) {
											case 'EComment':
												break _v149_13;
											case 'EColonType':
												var _p390 = _p349._0._3;
												return A6(
													generalizedMerge,
													A2(_user$project$Types$equal, _p390, _p349._1._3),
													_elm_lang$core$Maybe$Just(
														{ctor: '_Tuple2', _0: _p349._0._1, _1: _p349._1._1}),
													_elm_lang$core$Maybe$Nothing,
													_elm_lang$core$Maybe$Nothing,
													_elm_lang$core$Maybe$Nothing,
													F4(
														function (mergedE, _p389, _p388, _p387) {
															return A5(_user$project$Lang$EColonType, _p349._0._0, mergedE, _p349._0._2, _p390, _p349._0._4);
														}));
											default:
												break _v149_18;
										}
									default:
										switch (_p349._1.ctor) {
											case 'EComment':
												break _v149_13;
											case 'ETypeAlias':
												var _p395 = _p349._0._2;
												var _p394 = _p349._0._1;
												return A6(
													generalizedMerge,
													A2(_user$project$LangTools$patternsEqual, _p394, _p349._1._1) && A2(_user$project$Types$equal, _p395, _p349._1._2),
													_elm_lang$core$Maybe$Just(
														{ctor: '_Tuple2', _0: _p349._0._3, _1: _p349._1._3}),
													_elm_lang$core$Maybe$Nothing,
													_elm_lang$core$Maybe$Nothing,
													_elm_lang$core$Maybe$Nothing,
													F4(
														function (mergedE, _p393, _p392, _p391) {
															return A5(_user$project$Lang$ETypeAlias, _p349._0._0, _p394, _p395, mergedE, _p349._0._4);
														}));
											default:
												break _v149_18;
										}
								}
							} else {
								break _v149_18;
							}
						} while(false);
						var _v151 = expA,
							_v152 = _p349._1._2;
						expA = _v151;
						expB = _v152;
						continue mergeSingleArg;
					} while(false);
					return retArgVar;
				}
			});
		var mergeFunc = _elm_lang$core$Native_Utils.eq(argCount, 1) ? F2(
			function (eA, eB) {
				return _elm_lang$core$Tuple$first(
					A2(mergeSingleArg, eA, eB));
			}) : merge;
		var argVarCount = function (exp) {
			return A2(
				_user$project$Utils$count,
				function (exp) {
					var _p396 = exp.val.e__;
					if (_p396.ctor === 'EVar') {
						return _elm_lang$core$Native_Utils.eq(_p396._1, 'INSERT_ARGUMENT_HERE');
					} else {
						return false;
					}
				},
				_user$project$Lang$flattenExpTree(exp));
		};
		return A2(
			_elm_lang$core$List$map,
			function (_p397) {
				var _p398 = _p397;
				var _p418 = _p398._1;
				var _p417 = _p398._2;
				var _p416 = _p398._0;
				var eidsToReplace = A2(
					_elm_lang$core$List$map,
					function (_p399) {
						return function (_) {
							return _.eid;
						}(
							function (_) {
								return _.val;
							}(_p399));
					},
					_p418);
				var commonScope = A2(
					_user$project$LangTools$deepestCommonAncestorWithNewline,
					originalExp,
					function (exp) {
						return A2(_elm_lang$core$List$member, exp.val.eid, eidsToReplace);
					});
				var funcSuggestedName = function () {
					var defaultName = _elm_lang$core$Native_Utils.eq(
						_user$project$LangTools$simpleExpName(_p416),
						'INSERT_ARGUMENT_HERE') ? 'thing' : _user$project$LangTools$simpleExpName(_p416);
					return A3(_user$project$LangTools$commonNameForEIdsWithDefault, defaultName, originalExp, eidsToReplace);
				}();
				var _p400 = A3(
					_user$project$Lang$mapFoldExp,
					F2(
						function (e, argN) {
							var _p401 = e.val.e__;
							if ((_p401.ctor === 'EVar') && (_p401._1 === 'INSERT_ARGUMENT_HERE')) {
								return {
									ctor: '_Tuple2',
									_0: A2(
										_user$project$Lang$replaceE__,
										e,
										A2(
											_user$project$Lang$EVar,
											_p401._0,
											A2(
												_elm_lang$core$Basics_ops['++'],
												'INSERT_ARGUMENT',
												A2(
													_elm_lang$core$Basics_ops['++'],
													_elm_lang$core$Basics$toString(argN),
													'_HERE')))),
									_1: argN - 1
								};
							} else {
								return {ctor: '_Tuple2', _0: e, _1: argN};
							}
						}),
					argCount,
					_p416);
				var mergedArgUsesEnumerated = _p400._0;
				var funcWithPlaceholders = function () {
					var argList = A2(
						_elm_lang$core$List$map,
						function (n) {
							return (_elm_lang$core$Native_Utils.eq(n, 1) ? _user$project$Lang$pVar0 : _user$project$Lang$pVar)(
								A2(
									_elm_lang$core$Basics_ops['++'],
									'INSERT_ARGUMENT',
									A2(
										_elm_lang$core$Basics_ops['++'],
										_elm_lang$core$Basics$toString(n),
										'_HERE')));
						},
						A2(_elm_lang$core$List$range, 1, argCount));
					var fBody = _user$project$Lang$unindent(
						_user$project$LangSimplify$removeUnusedVars(
							_user$project$LangSimplify$changeRenamedVarsToOuter(mergedArgUsesEnumerated)));
					var fBodyReflowed = function () {
						var multipleLinesForFunction = (!A2(
							_elm_lang$core$String$contains,
							'\n',
							_user$project$LangUnparser$unparse(fBody))) && (_elm_lang$core$Native_Utils.cmp(
							_user$project$LangTools$longLineLength,
							_elm_lang$core$String$length(
								A3(
									_user$project$LangUnparser$unparseWithUniformWhitespace,
									true,
									true,
									A2(_user$project$Lang$eFun, argList, fBody)))) < 0);
						return multipleLinesForFunction ? A2(_user$project$Lang$replacePrecedingWhitespace, '\n', fBody) : _user$project$Lang$ensureWhitespaceExp(fBody);
					}();
					var explicitFunc = A2(_user$project$Lang$eFun, argList, fBodyReflowed);
					if ((!allowCurrying) || (_elm_lang$core$Native_Utils.cmp(argCount, 2) > -1)) {
						return explicitFunc;
					} else {
						var _p402 = fBody.val.e__;
						if (_p402.ctor === 'EApp') {
							var _p406 = _p402._1;
							var _p405 = _p402._2;
							var _p403 = A2(_user$project$Utils$takeLast, 1, _p405);
							if ((_p403.ctor === '::') && (_p403._1.ctor === '[]')) {
								var _p404 = _p403._0.val.e__;
								if ((_p404.ctor === 'EVar') && (_p404._1 === 'INSERT_ARGUMENT1_HERE')) {
									return (_elm_lang$core$Native_Utils.cmp(
										_elm_lang$core$List$length(_p405),
										2) > -1) ? A2(
										_user$project$Lang$replacePrecedingWhitespace,
										' ',
										A2(
											_user$project$Lang$replaceE__,
											fBody,
											A4(
												_user$project$Lang$EApp,
												_p402._0,
												_p406,
												A2(
													_elm_lang$core$List$take,
													_elm_lang$core$List$length(_p405) - 1,
													_p405),
												_p402._3))) : A2(_user$project$Lang$replacePrecedingWhitespace, ' ', _p406);
								} else {
									return explicitFunc;
								}
							} else {
								return explicitFunc;
							}
						} else {
							return explicitFunc;
						}
					}
				}();
				var _p407 = A3(
					_user$project$Utils$foldli1,
					F2(
						function (_p409, _p408) {
							var _p410 = _p409;
							var _p414 = _p410._0;
							var _p411 = _p408;
							var _p413 = _p411._1;
							var argBaseName = function () {
								var defaultName = _elm_lang$core$Native_Utils.eq(argCount, 0) ? 'arg' : A2(
									_elm_lang$core$Basics_ops['++'],
									'arg',
									_elm_lang$core$Basics$toString(_p414));
								return A3(
									_user$project$LangTools$commonNameForEIdsWithDefault,
									defaultName,
									originalExp,
									A2(
										_elm_lang$core$List$map,
										function (_p412) {
											return function (_) {
												return _.eid;
											}(
												function (_) {
													return _.val;
												}(_p412));
										},
										_p410._1));
							}();
							var argName = A3(_user$project$LangTools$nonCollidingName, argBaseName, 2, _p413);
							return {
								ctor: '_Tuple2',
								_0: A2(
									_elm_lang$core$Basics_ops['++'],
									_p411._0,
									{
										ctor: '::',
										_0: {
											ctor: '_Tuple2',
											_0: A2(
												_elm_lang$core$Basics_ops['++'],
												'INSERT_ARGUMENT',
												A2(
													_elm_lang$core$Basics_ops['++'],
													_elm_lang$core$Basics$toString(_p414),
													'_HERE')),
											_1: argName
										},
										_1: {ctor: '[]'}
									}),
								_1: A2(_elm_lang$core$Set$insert, argName, _p413)
							};
						}),
					{
						ctor: '_Tuple2',
						_0: {ctor: '[]'},
						_1: _user$project$LangTools$identifiersSet(funcWithPlaceholders)
					},
					A2(
						_user$project$Utils$fromJust_,
						'ExpressionBasedTransform.detectClones maybeZipN',
						_user$project$Utils$maybeZipN(_p417)));
				var argRenamingsList = _p407._0;
				var _p415 = _elm_lang$core$List$unzip(argRenamingsList);
				var argNames = _p415._1;
				var abstractedFunc = A2(
					_user$project$LangTools$renameIdentifiers,
					_elm_lang$core$Dict$fromList(argRenamingsList),
					funcWithPlaceholders);
				return {
					ctor: '_Tuple5',
					_0: A3(_user$project$Utils$zip3, eidsToReplace, _p418, _p417),
					_1: abstractedFunc,
					_2: commonScope,
					_3: funcSuggestedName,
					_4: argNames
				};
			},
			A2(
				_user$project$Utils$dedupBy,
				function (_p419) {
					var _p420 = _p419;
					return A3(_user$project$LangUnparser$unparseWithUniformWhitespace, false, false, _p420._0);
				},
				A2(
					_elm_lang$core$List$sortBy,
					function (_p421) {
						var _p422 = _p421;
						return 0 - _elm_lang$core$List$length(_p422._1);
					},
					A2(
						_elm_lang$core$List$filter,
						function (_p423) {
							var _p424 = _p423;
							return A2(
								_elm_lang$core$List$all,
								function (e) {
									return _user$project$LangTools$isLiteral(e) || (_elm_lang$core$Native_Utils.cmp(
										_user$project$LangTools$nodeCount(e),
										3) < 1);
								},
								_elm_lang$core$List$concat(_p424._2));
						},
						A2(
							_elm_lang$core$List$map,
							function (_p425) {
								var _p426 = _p425;
								var _p428 = _p426._1;
								var _p427 = _p426._0;
								return {
									ctor: '_Tuple3',
									_0: _p427,
									_1: _p428,
									_2: A2(
										_elm_lang$core$List$map,
										function (exp) {
											return A2(_user$project$LangTools$extraExpsDiff, _p427, exp);
										},
										_p428)
								};
							},
							A2(
								_elm_lang$core$List$map,
								function (_p429) {
									var _p430 = _p429;
									return {
										ctor: '_Tuple2',
										_0: _p430._0,
										_1: A2(
											_elm_lang$core$List$sortBy,
											function (exp) {
												return {ctor: '_Tuple2', _0: exp.start.line, _1: exp.start.col};
											},
											_p430._1)
									};
								},
								A2(
									_elm_lang$core$List$filter,
									function (_p431) {
										var _p432 = _p431;
										return (_elm_lang$core$Native_Utils.cmp(
											_elm_lang$core$List$length(_p432._1),
											minCloneCount) > -1) && _elm_lang$core$Native_Utils.eq(
											argVarCount(_p432._0),
											argCount);
									},
									A3(
										_elm_lang$core$List$foldl,
										F2(
											function (exp, mergeGroups) {
												var addedMergeGroups = A2(
													_elm_lang$core$List$filterMap,
													function (_p433) {
														var _p434 = _p433;
														var newMerged = A2(mergeFunc, _p434._0, exp);
														return (_elm_lang$core$Native_Utils.cmp(
															_user$project$LangTools$nodeCount(newMerged),
															minCloneSize) > -1) ? _elm_lang$core$Maybe$Just(
															{
																ctor: '_Tuple2',
																_0: newMerged,
																_1: {ctor: '::', _0: exp, _1: _p434._1}
															}) : _elm_lang$core$Maybe$Nothing;
													},
													mergeGroups);
												return {
													ctor: '::',
													_0: {
														ctor: '_Tuple2',
														_0: exp,
														_1: {
															ctor: '::',
															_0: exp,
															_1: {ctor: '[]'}
														}
													},
													_1: A2(_elm_lang$core$Basics_ops['++'], mergeGroups, addedMergeGroups)
												};
											}),
										{ctor: '[]'},
										A2(
											_elm_lang$core$List$filter,
											candidateExpFilter,
											A2(
												_elm_lang$core$List$filter,
												function (e) {
													return !(_user$project$Lang$isComment(e) || _user$project$Lang$isOption(e));
												},
												A2(_user$project$LangTools$subExpsOfSizeAtLeast, minCloneSize, originalExp)))))))))));
	});
var _user$project$ExpressionBasedTransform$cloneEliminationSythesisResults = F4(
	function (candidateExpFilter, minCloneCount, minCloneSizeToArgumentRatio, originalExp) {
		return A2(
			_elm_lang$core$List$map,
			function (_p435) {
				var _p436 = _p435;
				var _p441 = _p436._2;
				var _p440 = _p436._0;
				var funcName = A3(
					_user$project$LangTools$nonCollidingName,
					_p436._3,
					2,
					_user$project$LangTools$identifiersSet(_p441));
				var oldIndentation = _user$project$Lang$indentationOf(_p441);
				var abstractedFuncIndented = A2(
					_user$project$Lang$replaceIndentation,
					A2(_elm_lang$core$Basics_ops['++'], '  ', oldIndentation),
					_p436._1);
				var eidToNewE__ = _elm_lang$core$Dict$fromList(
					A2(
						_elm_lang$core$List$map,
						function (_p437) {
							var _p438 = _p437;
							return {
								ctor: '_Tuple2',
								_0: _p438._0,
								_1: A4(
									_user$project$Lang$EApp,
									_user$project$Lang$space1,
									_user$project$Lang$eVar0(funcName),
									A2(
										_elm_lang$core$List$map,
										_user$project$Lang$replacePrecedingWhitespace(' '),
										_p438._2),
									_user$project$Lang$space0)
							};
						},
						_p440));
				var usagesReplaced = A2(_user$project$Lang$applyESubstPreservingPrecedingWhitespace, eidToNewE__, _p441);
				var wrapped = A5(
					_user$project$LangTools$newLetFancyWhitespace,
					-1,
					_user$project$Lang$pVar(funcName),
					abstractedFuncIndented,
					usagesReplaced,
					originalExp);
				var newProgram = A3(_user$project$Lang$replaceExpNode, _p441.val.eid, wrapped, originalExp);
				var clonesName = function () {
					var _p439 = _user$project$Utils$unzip3(_p440);
					var eidsToReplace = _p439._0;
					var name = A2(_user$project$LangTools$commonNameForEIds, originalExp, eidsToReplace);
					return _elm_lang$core$Native_Utils.eq(name, '') ? _user$project$Utils$toSentence(
						A2(
							_elm_lang$core$List$map,
							_user$project$LangTools$expNameForEId(originalExp),
							eidsToReplace)) : A2(
						_elm_lang$core$Basics_ops['++'],
						_elm_lang$core$Basics$toString(
							_elm_lang$core$List$length(_p440)),
						A2(
							_elm_lang$core$Basics_ops['++'],
							' ',
							A2(_elm_lang$core$Basics_ops['++'], name, 's')));
				}();
				return A2(
					_user$project$InterfaceModel$synthesisResult,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'Merge ',
						A2(
							_elm_lang$core$Basics_ops['++'],
							clonesName,
							A2(
								_elm_lang$core$Basics_ops['++'],
								' by abstracting over ',
								_user$project$Utils$toSentence(_p436._4)))),
					newProgram);
			},
			A2(
				_elm_lang$core$List$filter,
				function (_p442) {
					var _p443 = _p442;
					var _p444 = _user$project$Utils$unzip3(_p443._0);
					var cloneExps = _p444._1;
					return A2(_user$project$ExpressionBasedTransform$noExtraneousFreeVarsInRemovedClones, cloneExps, _p443._2);
				},
				A2(
					_elm_lang$core$Basics_ops['++'],
					A6(_user$project$ExpressionBasedTransform$detectClones, originalExp, candidateExpFilter, minCloneCount, minCloneSizeToArgumentRatio * 1, 1, false),
					A2(
						_elm_lang$core$Basics_ops['++'],
						A6(_user$project$ExpressionBasedTransform$detectClones, originalExp, candidateExpFilter, minCloneCount, minCloneSizeToArgumentRatio * 2, 2, false),
						A2(
							_elm_lang$core$Basics_ops['++'],
							A6(_user$project$ExpressionBasedTransform$detectClones, originalExp, candidateExpFilter, minCloneCount, minCloneSizeToArgumentRatio * 3, 3, false),
							A2(
								_elm_lang$core$Basics_ops['++'],
								A6(_user$project$ExpressionBasedTransform$detectClones, originalExp, candidateExpFilter, minCloneCount, minCloneSizeToArgumentRatio * 4, 4, false),
								A2(
									_elm_lang$core$Basics_ops['++'],
									A6(_user$project$ExpressionBasedTransform$detectClones, originalExp, candidateExpFilter, minCloneCount, minCloneSizeToArgumentRatio * 5, 5, false),
									A2(
										_elm_lang$core$Basics_ops['++'],
										A6(_user$project$ExpressionBasedTransform$detectClones, originalExp, candidateExpFilter, minCloneCount, minCloneSizeToArgumentRatio * 6, 6, false),
										A2(
											_elm_lang$core$Basics_ops['++'],
											A6(_user$project$ExpressionBasedTransform$detectClones, originalExp, candidateExpFilter, minCloneCount, minCloneSizeToArgumentRatio * 7, 7, false),
											A6(_user$project$ExpressionBasedTransform$detectClones, originalExp, candidateExpFilter, minCloneCount, minCloneSizeToArgumentRatio * 8, 8, false))))))))));
	});
var _user$project$ExpressionBasedTransform$mapAbstractSynthesisResults = function (originalExp) {
	return A2(
		_elm_lang$core$List$map,
		function (_p445) {
			var _p446 = _p445;
			var _p452 = _p446._2;
			var _p451 = _p446._0;
			var _p450 = _p446._1;
			var _p447 = _user$project$Utils$unzip3(_p451);
			var eidsToReplace = _p447._0;
			var sortedExps = _p447._1;
			var parameterExpLists = _p447._2;
			var oldIndentation = _user$project$Lang$indentationOf(_p452);
			var mapCall = function () {
				var parameterExps = _elm_lang$core$List$concat(parameterExpLists);
				if (A2(
					_elm_lang$core$String$contains,
					'\n',
					_user$project$LangUnparser$unparse(_p450))) {
					var newLineIndent = F2(
						function (extraIndent, exp) {
							return A2(
								_user$project$Lang$replacePrecedingWhitespace,
								A2(
									_elm_lang$core$Basics_ops['++'],
									'\n',
									A2(_elm_lang$core$Basics_ops['++'], extraIndent, oldIndentation)),
								exp);
						});
					return A2(
						newLineIndent,
						'  ',
						A2(
							_user$project$Lang$eApp,
							_user$project$Lang$eVar0('map'),
							{
								ctor: '::',
								_0: A2(
									_user$project$Lang$replacePrecedingWhitespace,
									' ',
									A2(
										_user$project$Lang$indent,
										A2(_elm_lang$core$Basics_ops['++'], '      ', oldIndentation),
										_p450)),
								_1: {
									ctor: '::',
									_0: A2(
										newLineIndent,
										'    ',
										_user$project$Lang$eTuple(
											A3(_user$project$Lang$setExpListWhitespace, '', ' ', parameterExps))),
									_1: {ctor: '[]'}
								}
							}));
				} else {
					return A2(
						_user$project$Lang$eApp,
						_user$project$Lang$eVar0('map'),
						{
							ctor: '::',
							_0: _p450,
							_1: {
								ctor: '::',
								_0: _user$project$Lang$eTuple(
									A3(_user$project$Lang$setExpListWhitespace, '', ' ', parameterExps)),
								_1: {ctor: '[]'}
							}
						});
				}
			}();
			var namesToAvoid = _user$project$LangTools$identifiersSet(_p452);
			var varNames = A2(
				_user$project$Utils$mapi1,
				function (_p448) {
					var _p449 = _p448;
					return A3(
						_user$project$LangTools$nonCollidingName,
						A2(
							_elm_lang$core$Basics_ops['++'],
							_p446._3,
							_elm_lang$core$Basics$toString(_p449._0)),
						2,
						namesToAvoid);
				},
				sortedExps);
			var eidToVarE__ = _elm_lang$core$Dict$fromList(
				A2(
					_user$project$Utils$zip,
					eidsToReplace,
					A2(
						_elm_lang$core$List$map,
						function (name) {
							return A2(_user$project$Lang$EVar, _user$project$Lang$space1, name);
						},
						varNames)));
			var usagesReplaced = A2(_user$project$Lang$applyESubstPreservingPrecedingWhitespace, eidToVarE__, _p452);
			var wrapped = function () {
				var letKind = A2(_user$project$LangTools$isTopLevel, _p452, originalExp) ? _user$project$Lang$Def : _user$project$Lang$Let;
				return _user$project$Lang$withDummyExpInfo(
					A7(
						_user$project$Lang$ELet,
						_user$project$Lang$ws(
							A2(_elm_lang$core$Basics_ops['++'], '\n', oldIndentation)),
						letKind,
						false,
						_user$project$Lang$pListOfPVars(varNames),
						mapCall,
						usagesReplaced,
						_user$project$Lang$space0));
			}();
			var newProgram = A3(_user$project$Lang$replaceExpNode, _p452.val.eid, wrapped, originalExp);
			var clonesName = (!_elm_lang$core$Native_Utils.eq(
				_user$project$Utils$commonPrefixString(varNames),
				'')) ? A2(
				_elm_lang$core$Basics_ops['++'],
				_elm_lang$core$Basics$toString(
					_elm_lang$core$List$length(_p451)),
				A2(
					_elm_lang$core$Basics_ops['++'],
					' ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_user$project$Utils$commonPrefixString(varNames),
						's'))) : _user$project$Utils$toSentence(
				A2(
					_elm_lang$core$List$map,
					_user$project$LangTools$expNameForEId(originalExp),
					eidsToReplace));
			return A2(
				_user$project$InterfaceModel$synthesisResult,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'Merge ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						clonesName,
						A2(
							_elm_lang$core$Basics_ops['++'],
							' by mapping over ',
							A2(_elm_lang$core$String$join, ' ', _p446._4)))),
				newProgram);
		},
		A2(
			_elm_lang$core$List$filter,
			function (_p453) {
				var _p454 = _p453;
				var _p455 = _user$project$Utils$unzip3(_p454._0);
				var cloneExps = _p455._1;
				return A2(_user$project$ExpressionBasedTransform$noExtraneousFreeVarsInRemovedClones, cloneExps, _p454._2);
			},
			A6(
				_user$project$ExpressionBasedTransform$detectClones,
				originalExp,
				_elm_lang$core$Basics$always(true),
				3,
				3,
				1,
				true)));
};
var _user$project$ExpressionBasedTransform$inlineListSynthesisResults = function (originalExp) {
	var candidatesAndDescription = A2(
		_elm_lang$core$List$concatMap,
		function (exp) {
			var _p456 = exp.val.e__;
			if ((_p456.ctor === 'ELet') && (_p456._2 === false)) {
				var _p482 = _p456._3;
				var _p481 = _p456._5;
				var letExp = exp;
				var _p457 = _p482.val.p__;
				if (((((_p457.ctor === 'PList') && (_p457._1.ctor === '::')) && (_p457._1._1.ctor === '::')) && (_p457._1._1._1.ctor === '::')) && (_p457._3.ctor === 'Nothing')) {
					var pats = {
						ctor: '::',
						_0: _p457._1._0,
						_1: {
							ctor: '::',
							_0: _p457._1._1._0,
							_1: {ctor: '::', _0: _p457._1._1._1._0, _1: _p457._1._1._1._1}
						}
					};
					var maybeIdents = _user$project$Utils$projJusts(
						A2(_elm_lang$core$List$map, _user$project$LangTools$patToMaybePVarIdent, pats));
					var _p458 = maybeIdents;
					if (_p458.ctor === 'Just') {
						var _p480 = _p458._0;
						var usages = A2(
							_user$project$LangTools$identifierSetUses,
							_elm_lang$core$Set$fromList(_p480),
							_p481);
						if (_elm_lang$core$Native_Utils.eq(
							A2(_elm_lang$core$List$map, _user$project$LangTools$expToIdent, usages),
							_p480)) {
							var maybeParents = A2(
								_elm_lang$core$List$map,
								function (_p459) {
									return _user$project$Utils$maybeLast(
										A2(_user$project$Utils$dropLast, 1, _p459));
								},
								A2(
									_user$project$Lang$findAllWithAncestors,
									function (e) {
										return A2(_elm_lang$core$List$member, e, usages);
									},
									_p481));
							var _p460 = _user$project$Utils$dedupByEquality(maybeParents);
							if (((_p460.ctor === '::') && (_p460._0.ctor === 'Just')) && (_p460._1.ctor === '[]')) {
								var _p479 = _p460._0._0;
								var _p461 = _p479.val.e__;
								if (_p461.ctor === 'EList') {
									var _p478 = _p461._3;
									var listName = function () {
										var listBaseName = function () {
											var prefix = _user$project$Utils$commonPrefixString(_p480);
											return _elm_lang$core$Native_Utils.eq(prefix, '') ? 'list' : A2(_elm_lang$core$Basics_ops['++'], prefix, 's');
										}();
										return A3(
											_user$project$LangTools$nonCollidingName,
											listBaseName,
											2,
											_user$project$LangTools$identifiersSet(_p481));
									}();
									var eConcatExp = function (listExp) {
										return A2(
											_user$project$Lang$eApp,
											_user$project$Lang$eVar0('concat'),
											{
												ctor: '::',
												_0: listExp,
												_1: {ctor: '[]'}
											});
									};
									var eConcat = function (listExps) {
										return A2(
											_user$project$Lang$eApp,
											_user$project$Lang$eVar0('concat'),
											{
												ctor: '::',
												_0: _user$project$Lang$eTuple(listExps),
												_1: {ctor: '[]'}
											});
									};
									var eAppend = F2(
										function (listExpA, listExpB) {
											return A2(
												_user$project$Lang$eApp,
												_user$project$Lang$eVar0('append'),
												A2(
													_elm_lang$core$List$map,
													_user$project$Lang$replacePrecedingWhitespace(' '),
													{
														ctor: '::',
														_0: listExpA,
														_1: {
															ctor: '::',
															_0: listExpB,
															_1: {ctor: '[]'}
														}
													}));
										});
									var usagePrecedingWhitespace = _user$project$Lang$precedingWhitespace(
										A2(_user$project$Utils$head, 'ExpressionBasedTransform.inlineListSynthesisResults usages', usages));
									var useOldWs = function (e) {
										return A2(_user$project$Lang$replacePrecedingWhitespace, usagePrecedingWhitespace, e);
									};
									var newListExpCandidates = function () {
										var _p462 = A2(_user$project$Utils$splitBy, usages, _p461._1);
										if (((_p462.ctor === '::') && (_p462._1.ctor === '::')) && (_p462._1._1.ctor === '[]')) {
											if (_p462._0.ctor === '[]') {
												if (_p462._1._0.ctor === '[]') {
													var _p463 = _p478;
													if (_p463.ctor === 'Nothing') {
														return {
															ctor: '::',
															_0: _user$project$Lang$eVar(listName),
															_1: {
																ctor: '::',
																_0: _user$project$Lang$eTuple(
																	{
																		ctor: '::',
																		_0: useOldWs(
																			eConcatExp(
																				_user$project$Lang$eVar(listName))),
																		_1: {ctor: '[]'}
																	}),
																_1: {ctor: '[]'}
															}
														};
													} else {
														var _p464 = _p463._0;
														return {
															ctor: '::',
															_0: A2(
																eAppend,
																_user$project$Lang$eVar(listName),
																_p464),
															_1: {
																ctor: '::',
																_0: A2(
																	_user$project$Lang$eList,
																	{
																		ctor: '::',
																		_0: useOldWs(
																			eConcatExp(
																				_user$project$Lang$eVar(listName))),
																		_1: {ctor: '[]'}
																	},
																	_elm_lang$core$Maybe$Just(_p464)),
																_1: {ctor: '[]'}
															}
														};
													}
												} else {
													var _p467 = _p462._1._0;
													var _p465 = _p478;
													if (_p465.ctor === 'Nothing') {
														return {
															ctor: '::',
															_0: A2(
																eAppend,
																_user$project$Lang$eVar(listName),
																_user$project$Lang$eTuple(_p467)),
															_1: {
																ctor: '::',
																_0: _user$project$Lang$eTuple(
																	{
																		ctor: '::',
																		_0: useOldWs(
																			eConcatExp(
																				_user$project$Lang$eVar(listName))),
																		_1: _p467
																	}),
																_1: {
																	ctor: '::',
																	_0: A2(
																		_user$project$Lang$eList,
																		{
																			ctor: '::',
																			_0: useOldWs(
																				eConcatExp(
																					_user$project$Lang$eVar(listName))),
																			_1: {ctor: '[]'}
																		},
																		_elm_lang$core$Maybe$Just(
																			_user$project$Lang$eTuple(_p467))),
																	_1: {ctor: '[]'}
																}
															}
														};
													} else {
														var _p466 = _p465._0;
														return {
															ctor: '::',
															_0: eConcat(
																{
																	ctor: '::',
																	_0: _user$project$Lang$eVar(listName),
																	_1: {
																		ctor: '::',
																		_0: _user$project$Lang$eTuple(_p467),
																		_1: {
																			ctor: '::',
																			_0: _p466,
																			_1: {ctor: '[]'}
																		}
																	}
																}),
															_1: {
																ctor: '::',
																_0: A2(
																	eAppend,
																	_user$project$Lang$eVar(listName),
																	A2(
																		_user$project$Lang$eList,
																		_p467,
																		_elm_lang$core$Maybe$Just(_p466))),
																_1: {
																	ctor: '::',
																	_0: A2(
																		_user$project$Lang$eList,
																		{
																			ctor: '::',
																			_0: useOldWs(
																				eConcatExp(
																					_user$project$Lang$eVar(listName))),
																			_1: _p467
																		},
																		_elm_lang$core$Maybe$Just(_p466)),
																	_1: {ctor: '[]'}
																}
															}
														};
													}
												}
											} else {
												if (_p462._1._0.ctor === '[]') {
													var _p470 = _p462._0;
													var _p468 = _p478;
													if (_p468.ctor === 'Nothing') {
														return {
															ctor: '::',
															_0: A2(
																eAppend,
																_user$project$Lang$eTuple(_p470),
																_user$project$Lang$eVar(listName)),
															_1: {
																ctor: '::',
																_0: A2(
																	_user$project$Lang$eList,
																	_p470,
																	_elm_lang$core$Maybe$Just(
																		_user$project$Lang$eVar(listName))),
																_1: {
																	ctor: '::',
																	_0: _user$project$Lang$eTuple(
																		A2(
																			_elm_lang$core$Basics_ops['++'],
																			_p470,
																			{
																				ctor: '::',
																				_0: useOldWs(
																					eConcatExp(
																						_user$project$Lang$eVar(listName))),
																				_1: {ctor: '[]'}
																			})),
																	_1: {
																		ctor: '::',
																		_0: A2(
																			_user$project$Lang$eList,
																			_p470,
																			_elm_lang$core$Maybe$Just(
																				eConcatExp(
																					_user$project$Lang$eVar(listName)))),
																		_1: {ctor: '[]'}
																	}
																}
															}
														};
													} else {
														var _p469 = _p468._0;
														return {
															ctor: '::',
															_0: eConcat(
																{
																	ctor: '::',
																	_0: _user$project$Lang$eTuple(_p470),
																	_1: {
																		ctor: '::',
																		_0: _user$project$Lang$eVar(listName),
																		_1: {
																			ctor: '::',
																			_0: _p469,
																			_1: {ctor: '[]'}
																		}
																	}
																}),
															_1: {
																ctor: '::',
																_0: A2(
																	_user$project$Lang$eList,
																	_p470,
																	_elm_lang$core$Maybe$Just(
																		A2(
																			eAppend,
																			_user$project$Lang$eVar(listName),
																			_p469))),
																_1: {
																	ctor: '::',
																	_0: A2(
																		_user$project$Lang$eList,
																		A2(
																			_elm_lang$core$Basics_ops['++'],
																			_p470,
																			{
																				ctor: '::',
																				_0: useOldWs(
																					eConcatExp(
																						_user$project$Lang$eVar(listName))),
																				_1: {ctor: '[]'}
																			}),
																		_elm_lang$core$Maybe$Just(_p469)),
																	_1: {ctor: '[]'}
																}
															}
														};
													}
												} else {
													var _p474 = _p462._0;
													var _p473 = _p462._1._0;
													var _p471 = _p478;
													if (_p471.ctor === 'Nothing') {
														return {
															ctor: '::',
															_0: eConcat(
																{
																	ctor: '::',
																	_0: _user$project$Lang$eTuple(_p474),
																	_1: {
																		ctor: '::',
																		_0: _user$project$Lang$eVar(listName),
																		_1: {
																			ctor: '::',
																			_0: _user$project$Lang$eTuple(_p473),
																			_1: {ctor: '[]'}
																		}
																	}
																}),
															_1: {
																ctor: '::',
																_0: _user$project$Lang$eTuple(
																	A2(
																		_elm_lang$core$Basics_ops['++'],
																		_p474,
																		A2(
																			_elm_lang$core$Basics_ops['++'],
																			{
																				ctor: '::',
																				_0: useOldWs(
																					eConcatExp(
																						_user$project$Lang$eVar(listName))),
																				_1: {ctor: '[]'}
																			},
																			_p473))),
																_1: {ctor: '[]'}
															}
														};
													} else {
														var _p472 = _p471._0;
														return {
															ctor: '::',
															_0: eConcat(
																{
																	ctor: '::',
																	_0: _user$project$Lang$eTuple(_p474),
																	_1: {
																		ctor: '::',
																		_0: _user$project$Lang$eVar(listName),
																		_1: {
																			ctor: '::',
																			_0: _user$project$Lang$eTuple(_p473),
																			_1: {
																				ctor: '::',
																				_0: _p472,
																				_1: {ctor: '[]'}
																			}
																		}
																	}
																}),
															_1: {
																ctor: '::',
																_0: A2(
																	_user$project$Lang$eList,
																	A2(
																		_elm_lang$core$Basics_ops['++'],
																		_p474,
																		A2(
																			_elm_lang$core$Basics_ops['++'],
																			{
																				ctor: '::',
																				_0: useOldWs(
																					eConcatExp(
																						_user$project$Lang$eVar(listName))),
																				_1: {ctor: '[]'}
																			},
																			_p473)),
																	_elm_lang$core$Maybe$Just(_p472)),
																_1: {ctor: '[]'}
															}
														};
													}
												}
											}
										} else {
											return {ctor: '[]'};
										}
									}();
									return A2(
										_elm_lang$core$List$map,
										function (newListExp) {
											var prettyNewListExp = function () {
												var _p475 = newListExp.val.e__;
												if (_p475.ctor === 'EList') {
													return A2(_user$project$LangTools$copyListWhitespace, _p479, newListExp);
												} else {
													return newListExp;
												}
											}();
											var newLetBody = A3(_user$project$Lang$replaceExpNodePreservingPrecedingWhitespace, _p479.val.eid, prettyNewListExp, _p481);
											var newLet = A2(
												_user$project$Lang$replaceE__,
												letExp,
												A7(
													_user$project$Lang$ELet,
													_p456._0,
													_p456._1,
													false,
													_user$project$Lang$pVar(listName),
													_p456._4,
													newLetBody,
													_p456._6));
											return {
												ctor: '_Tuple2',
												_0: A3(_user$project$Lang$replaceExpNode, newLet.val.eid, newLet, originalExp),
												_1: A2(
													_elm_lang$core$Basics_ops['++'],
													'Inline ',
													A2(
														_elm_lang$core$Basics_ops['++'],
														function (_p476) {
															return _user$project$Utils$squish(
																_user$project$LangUnparser$unparsePat(_p476));
														}(_p482),
														A2(
															_elm_lang$core$Basics_ops['++'],
															' into ',
															function (_p477) {
																return _user$project$Utils$squish(
																	_user$project$LangUnparser$unparse(_p477));
															}(newListExp))))
											};
										},
										newListExpCandidates);
								} else {
									return {ctor: '[]'};
								}
							} else {
								return {ctor: '[]'};
							}
						} else {
							return {ctor: '[]'};
						}
					} else {
						return {ctor: '[]'};
					}
				} else {
					return {ctor: '[]'};
				}
			} else {
				return {ctor: '[]'};
			}
		},
		_user$project$Lang$flattenExpTree(originalExp));
	return A2(
		_elm_lang$core$List$map,
		function (_p483) {
			var _p484 = _p483;
			return A2(_user$project$InterfaceModel$synthesisResult, _p484._1, _p484._0);
		},
		candidatesAndDescription);
};
var _user$project$ExpressionBasedTransform$rangeSynthesisResults = function (originalExp) {
	var eidAndRangeLists = A2(
		_elm_lang$core$List$filterMap,
		function (exp) {
			var _p485 = exp.val.e__;
			if ((_p485.ctor === 'EList') && (_p485._3.ctor === 'Nothing')) {
				var _p489 = _p485._1;
				var maybeNums = _user$project$Utils$projJusts(
					A2(_elm_lang$core$List$map, _user$project$LangTools$expToMaybeNum, _p489));
				var _p486 = maybeNums;
				if ((((_p486.ctor === 'Just') && (_p486._0.ctor === '::')) && (_p486._0._1.ctor === '::')) && (_p486._0._1._1.ctor === '::')) {
					var nums = {
						ctor: '::',
						_0: _p486._0._0,
						_1: {
							ctor: '::',
							_0: _p486._0._1._0,
							_1: {ctor: '::', _0: _p486._0._1._1._0, _1: _p486._0._1._1._1}
						}
					};
					var _p487 = {
						ctor: '_Tuple2',
						_0: _elm_lang$core$Basics$round(
							A2(
								_user$project$Utils$fromJust_,
								'ExpressionBasedTransform.rangeSynthesisResults min',
								_elm_lang$core$List$minimum(nums))),
						_1: _elm_lang$core$Basics$round(
							A2(
								_user$project$Utils$fromJust_,
								'ExpressionBasedTransform.rangeSynthesisResults max',
								_elm_lang$core$List$maximum(nums)))
					};
					var min = _p487._0;
					var max = _p487._1;
					var _p488 = _elm_lang$core$Native_Utils.eq(
						nums,
						A2(
							_elm_lang$core$List$map,
							_elm_lang$core$Basics$toFloat,
							A2(_elm_lang$core$List$range, min, max))) ? {ctor: '_Tuple2', _0: 'ascending', _1: nums} : (_elm_lang$core$Native_Utils.eq(
						_elm_lang$core$List$reverse(nums),
						A2(
							_elm_lang$core$List$map,
							_elm_lang$core$Basics$toFloat,
							A2(_elm_lang$core$List$range, min, max))) ? {
						ctor: '_Tuple2',
						_0: 'descending',
						_1: _elm_lang$core$List$reverse(nums)
					} : {
						ctor: '_Tuple2',
						_0: 'none',
						_1: {ctor: '[]'}
					});
					var characterization = _p488._0;
					var ascending = _p488._1;
					if (!_elm_lang$core$Native_Utils.eq(characterization, 'none')) {
						var insertedLoc = _user$project$Lang$dummyLoc_(
							A2(_elm_lang$core$List$all, _user$project$Lang$isFrozenNumber, _p489) ? _user$project$Lang$frozen : _user$project$Lang$unann);
						var maybeReverse = function (e) {
							return _elm_lang$core$Native_Utils.eq(characterization, 'descending') ? A2(
								_user$project$Lang$eApp,
								_user$project$Lang$eVar0('reverse'),
								{
									ctor: '::',
									_0: e,
									_1: {ctor: '[]'}
								}) : e;
						};
						return _elm_lang$core$Native_Utils.eq(
							_elm_lang$core$List$head(ascending),
							_elm_lang$core$Maybe$Just(0.0)) ? _elm_lang$core$Maybe$Just(
							{
								ctor: '_Tuple2',
								_0: exp.val.eid,
								_1: maybeReverse(
									A2(
										_user$project$Lang$eApp,
										_user$project$Lang$eVar0('zeroTo'),
										{
											ctor: '::',
											_0: _user$project$Lang$withDummyExpInfo(
												A4(
													_user$project$Lang$EConst,
													_user$project$Lang$space1,
													_elm_lang$core$Basics$toFloat(max) + 1,
													insertedLoc,
													A2(_user$project$Lang$intSlider, 0, 5 * (max + 1)))),
											_1: {ctor: '[]'}
										}))
							}) : (_elm_lang$core$Native_Utils.eq(
							_elm_lang$core$List$head(ascending),
							_elm_lang$core$Maybe$Just(1.0)) ? _elm_lang$core$Maybe$Just(
							{
								ctor: '_Tuple2',
								_0: exp.val.eid,
								_1: maybeReverse(
									A2(
										_user$project$Lang$eApp,
										_user$project$Lang$eVar0('list1N'),
										{
											ctor: '::',
											_0: _user$project$Lang$withDummyExpInfo(
												A4(
													_user$project$Lang$EConst,
													_user$project$Lang$space1,
													_elm_lang$core$Basics$toFloat(max),
													insertedLoc,
													A2(_user$project$Lang$intSlider, 0, (5 * (max + 1)) - 1))),
											_1: {ctor: '[]'}
										}))
							}) : _elm_lang$core$Maybe$Just(
							{
								ctor: '_Tuple2',
								_0: exp.val.eid,
								_1: maybeReverse(
									A2(
										_user$project$Lang$eApp,
										_user$project$Lang$eVar0('range'),
										{
											ctor: '::',
											_0: A2(
												_user$project$Lang$eConst,
												_elm_lang$core$Basics$toFloat(min),
												insertedLoc),
											_1: {
												ctor: '::',
												_0: A2(
													_user$project$Lang$eConst,
													_elm_lang$core$Basics$toFloat(max),
													insertedLoc),
												_1: {ctor: '[]'}
											}
										}))
							}));
					} else {
						return _elm_lang$core$Maybe$Nothing;
					}
				} else {
					return _elm_lang$core$Maybe$Nothing;
				}
			} else {
				return _elm_lang$core$Maybe$Nothing;
			}
		},
		_user$project$Lang$flattenExpTree(originalExp));
	return A2(
		_elm_lang$core$List$map,
		function (_p490) {
			var _p491 = _p490;
			var _p494 = _p491._1;
			var _p493 = _p491._0;
			return A2(
				_user$project$InterfaceModel$synthesisResult,
				A2(
					_elm_lang$core$Basics_ops['++'],
					'Replace ',
					A2(
						_elm_lang$core$Basics_ops['++'],
						function (_p492) {
							return _user$project$Utils$squish(
								_user$project$LangUnparser$unparse(_p492));
						}(
							A2(_user$project$LangTools$justFindExpByEId, originalExp, _p493)),
						A2(
							_elm_lang$core$Basics_ops['++'],
							' with ',
							_user$project$LangUnparser$unparse(_p494)))),
				A3(_user$project$Lang$replaceExpNodePreservingPrecedingWhitespace, _p493, _p494, originalExp));
		},
		eidAndRangeLists);
};
var _user$project$ExpressionBasedTransform$passiveSynthesisSearch = function (originalExp) {
	return A2(
		_elm_lang$core$Basics_ops['++'],
		A4(
			_user$project$ExpressionBasedTransform$cloneEliminationSythesisResults,
			_elm_lang$core$Basics$always(true),
			2,
			5,
			originalExp),
		A2(
			_elm_lang$core$Basics_ops['++'],
			_user$project$ExpressionBasedTransform$mapAbstractSynthesisResults(originalExp),
			A2(
				_elm_lang$core$Basics_ops['++'],
				_user$project$ExpressionBasedTransform$rangeSynthesisResults(originalExp),
				_user$project$ExpressionBasedTransform$inlineListSynthesisResults(originalExp))));
};
var _user$project$ExpressionBasedTransform$AnchorBindings = F2(
	function (a, b) {
		return {ctor: 'AnchorBindings', _0: a, _1: b};
	});
var _user$project$ExpressionBasedTransform$findAnchorInMapping = function (mapping) {
	var _p495 = mapping;
	if ((((((_p495.ctor === '::') && (_p495._0.ctor === '_Tuple2')) && (_p495._0._0 === 'xAnchor')) && (_p495._1.ctor === '::')) && (_p495._1._0.ctor === '_Tuple2')) && (_p495._1._0._0 === 'yAnchor')) {
		return _elm_lang$core$Maybe$Just(
			{
				ctor: '_Tuple2',
				_0: _p495._1._1,
				_1: A2(_user$project$ExpressionBasedTransform$AnchorBindings, _p495._0._1, _p495._1._0._1)
			});
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$ExpressionBasedTransform$BoundsBindings = F4(
	function (a, b, c, d) {
		return {ctor: 'BoundsBindings', _0: a, _1: b, _2: c, _3: d};
	});
var _user$project$ExpressionBasedTransform$findBoundsInMapping = function (mapping) {
	var _p496 = mapping;
	if ((((((((((((_p496.ctor === '::') && (_p496._0.ctor === '_Tuple2')) && (_p496._0._0 === 'left')) && (_p496._1.ctor === '::')) && (_p496._1._0.ctor === '_Tuple2')) && (_p496._1._0._0 === 'top')) && (_p496._1._1.ctor === '::')) && (_p496._1._1._0.ctor === '_Tuple2')) && (_p496._1._1._0._0 === 'right')) && (_p496._1._1._1.ctor === '::')) && (_p496._1._1._1._0.ctor === '_Tuple2')) && (_p496._1._1._1._0._0 === 'bot')) {
		return _elm_lang$core$Maybe$Just(
			{
				ctor: '_Tuple2',
				_0: _p496._1._1._1._1,
				_1: A4(_user$project$ExpressionBasedTransform$BoundsBindings, _p496._0._1, _p496._1._0._1, _p496._1._1._0._1, _p496._1._1._1._0._1)
			});
	} else {
		return _elm_lang$core$Maybe$Nothing;
	}
};
var _user$project$ExpressionBasedTransform$findSpecialBindingsInMapping = function (mapping) {
	return A2(
		_user$project$Utils$plusMaybe,
		_user$project$ExpressionBasedTransform$findAnchorInMapping(mapping),
		_user$project$ExpressionBasedTransform$findBoundsInMapping(mapping));
};
var _user$project$ExpressionBasedTransform$abstractOne = F2(
	function (_p498, _p497) {
		var _p499 = _p498;
		var _p525 = _p499._0;
		var _p500 = _p497;
		var _p524 = _p500._0;
		var _p523 = _p500._1;
		var _p501 = A2(
			_user$project$ExpressionBasedTransform$pluckFromList,
			_user$project$ExpressionBasedTransform$matchesAnySelectedVarBlob(
				{
					ctor: '::',
					_0: {
						ctor: '_Tuple3',
						_0: _p525,
						_1: _p499._1,
						_2: _user$project$Blobs$VarBlob(_p499._2)
					},
					_1: {ctor: '[]'}
				}),
			_p524);
		var pluckedDefs = _p501._0;
		var beforeDefs = _p501._1;
		var afterDefs = _p501._2;
		var _p502 = function () {
			var matches = function (_p503) {
				var _p504 = _p503;
				return _elm_lang$core$Native_Utils.eq(_p525, _p504._0);
			};
			var _p505 = A2(
				_user$project$ExpressionBasedTransform$pluckFromList,
				matches,
				A2(
					_user$project$Utils$zip,
					A2(
						_elm_lang$core$List$range,
						1,
						_elm_lang$core$List$length(_p523)),
					_p523));
			var plucked = _p505._0;
			var before = _p505._1;
			var after = _p505._2;
			return {
				ctor: '_Tuple3',
				_0: A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$second, plucked),
				_1: A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$second, before),
				_2: A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$second, after)
			};
		}();
		var pluckedBlobs = _p502._0;
		var beforeBlobs = _p502._1;
		var afterBlobs = _p502._2;
		var _p506 = {ctor: '_Tuple2', _0: pluckedDefs, _1: pluckedBlobs};
		if ((((((((_p506.ctor === '_Tuple2') && (_p506._0.ctor === '::')) && (_p506._0._0.ctor === '_Tuple4')) && (_p506._0._1.ctor === '[]')) && (_p506._1.ctor === '::')) && (_p506._1._0.ctor === 'NiceBlob')) && (_p506._1._0._1.ctor === 'VarBlob')) && (_p506._1._1.ctor === '[]')) {
			var _p521 = _p506._1._0._1._0;
			var _p520 = _p506._0._0._3;
			var _p519 = _p506._0._0._0;
			var _p518 = _p506._0._0._1;
			var _p507 = _user$project$ExpressionBasedTransform$collectUnfrozenConstants(_p506._0._0._2);
			var e_ = _p507._0;
			var mapping = _p507._1;
			var _p508 = function () {
				var _p509 = _user$project$ExpressionBasedTransform$findSpecialBindingsInMapping(mapping);
				if (_p509.ctor === 'Just') {
					if (_p509._0._1.ctor === 'BoundsBindings') {
						var _p512 = _p509._0._0;
						var newFunc = function () {
							var pBounds = function () {
								var pVars = _user$project$Lang$listOfPVars(
									{
										ctor: '::',
										_0: 'left',
										_1: {
											ctor: '::',
											_0: 'top',
											_1: {
												ctor: '::',
												_0: 'right',
												_1: {
													ctor: '::',
													_0: 'bot',
													_1: {ctor: '[]'}
												}
											}
										}
									});
								var _p510 = _p512;
								if (_p510.ctor === '[]') {
									return _user$project$Lang$pList0(pVars);
								} else {
									return _user$project$Lang$pList(pVars);
								}
							}();
							var params = _user$project$Lang$listOfPVars(
								A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$first, _p512));
							return _user$project$Lang$withDummyExpInfo(
								A4(
									_user$project$Lang$EFun,
									_user$project$Lang$space1,
									A2(
										_elm_lang$core$Basics_ops['++'],
										params,
										{
											ctor: '::',
											_0: pBounds,
											_1: {ctor: '[]'}
										}),
									e_,
									_user$project$Lang$space0));
						}();
						var eBounds = A2(
							_user$project$Lang$eList,
							_user$project$Lang$listOfAnnotatedNums(
								{
									ctor: '::',
									_0: _p509._0._1._0,
									_1: {
										ctor: '::',
										_0: _p509._0._1._1,
										_1: {
											ctor: '::',
											_0: _p509._0._1._2,
											_1: {
												ctor: '::',
												_0: _p509._0._1._3,
												_1: {ctor: '[]'}
											}
										}
									}
								}),
							_elm_lang$core$Maybe$Nothing);
						var newCall = function () {
							var eBlah = function () {
								var _p511 = _user$project$Lang$listOfAnnotatedNums1(
									A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$second, _p512));
								if (_p511.ctor === '[]') {
									return _user$project$Lang$eVar(_p521);
								} else {
									return _user$project$Lang$withDummyExpInfo(
										A4(
											_user$project$Lang$EApp,
											_user$project$Lang$ws('\n    '),
											_user$project$Lang$eVar0(_p521),
											_p511,
											_user$project$Lang$space0));
								}
							}();
							return _user$project$Lang$withDummyExpInfo(
								A4(
									_user$project$Lang$EApp,
									_user$project$Lang$ws('\n  '),
									_user$project$Lang$eVar0('withBounds'),
									{
										ctor: '::',
										_0: eBounds,
										_1: {
											ctor: '::',
											_0: eBlah,
											_1: {ctor: '[]'}
										}
									},
									_user$project$Lang$space0));
						}();
						var newBlob = A2(
							_user$project$Blobs$NiceBlob,
							newCall,
							_user$project$Blobs$WithBoundsBlob(
								{
									ctor: '_Tuple3',
									_0: eBounds,
									_1: _p521,
									_2: {ctor: '[]'}
								}));
						return {
							ctor: '_Tuple2',
							_0: {ctor: '_Tuple4', _0: _p519, _1: _p518, _2: newFunc, _3: _p520},
							_1: newBlob
						};
					} else {
						var _p515 = _p509._0._0;
						var newFunc = function () {
							var pBounds = function () {
								var pVars = _user$project$Lang$listOfPVars(
									{
										ctor: '::',
										_0: 'xAnchor',
										_1: {
											ctor: '::',
											_0: 'yAnchor',
											_1: {ctor: '[]'}
										}
									});
								var _p513 = _p515;
								if (_p513.ctor === '[]') {
									return _user$project$Lang$pList0(pVars);
								} else {
									return _user$project$Lang$pList(pVars);
								}
							}();
							var params = _user$project$Lang$listOfPVars(
								A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$first, _p515));
							return _user$project$Lang$withDummyExpInfo(
								A4(
									_user$project$Lang$EFun,
									_user$project$Lang$space1,
									A2(
										_elm_lang$core$Basics_ops['++'],
										params,
										{
											ctor: '::',
											_0: A2(_user$project$ExpressionBasedTransform$pAsTight, 'anchor', pBounds),
											_1: {ctor: '[]'}
										}),
									e_,
									_user$project$Lang$space0));
						}();
						var eAnchor = _user$project$ExpressionBasedTransform$eAsPoint(
							A2(
								_user$project$Lang$eList,
								_user$project$Lang$listOfAnnotatedNums(
									{
										ctor: '::',
										_0: _p509._0._1._0,
										_1: {
											ctor: '::',
											_0: _p509._0._1._1,
											_1: {ctor: '[]'}
										}
									}),
								_elm_lang$core$Maybe$Nothing));
						var newCall = function () {
							var eBlah = function () {
								var _p514 = _user$project$Lang$listOfAnnotatedNums1(
									A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$second, _p515));
								if (_p514.ctor === '[]') {
									return _user$project$Lang$eVar(_p521);
								} else {
									return _user$project$Lang$withDummyExpInfo(
										A4(
											_user$project$Lang$EApp,
											_user$project$Lang$space1,
											_user$project$Lang$eVar0(_p521),
											_p514,
											_user$project$Lang$space0));
								}
							}();
							return _user$project$Lang$withDummyExpInfo(
								A4(
									_user$project$Lang$EApp,
									_user$project$Lang$ws('\n  '),
									_user$project$Lang$eVar0('withAnchor'),
									{
										ctor: '::',
										_0: eAnchor,
										_1: {
											ctor: '::',
											_0: eBlah,
											_1: {ctor: '[]'}
										}
									},
									_user$project$Lang$space0));
						}();
						var newBlob = A2(
							_user$project$Blobs$NiceBlob,
							newCall,
							_user$project$Blobs$WithAnchorBlob(
								{
									ctor: '_Tuple3',
									_0: eAnchor,
									_1: _p521,
									_2: {ctor: '[]'}
								}));
						return {
							ctor: '_Tuple2',
							_0: {ctor: '_Tuple4', _0: _p519, _1: _p518, _2: newFunc, _3: _p520},
							_1: newBlob
						};
					}
				} else {
					var newFunc = function () {
						var params = _user$project$Lang$listOfPVars(
							A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$first, mapping));
						return _user$project$Lang$withDummyExpInfo(
							A4(_user$project$Lang$EFun, _user$project$Lang$space1, params, e_, _user$project$Lang$space0));
					}();
					var newBlob = function () {
						var _p516 = _user$project$Lang$listOfAnnotatedNums1(
							A2(_elm_lang$core$List$map, _elm_lang$core$Tuple$second, mapping));
						if (_p516.ctor === '[]') {
							return A2(
								_user$project$Blobs$varBlob,
								_user$project$Lang$eVar(_p521),
								_p521);
						} else {
							var _p517 = _p516;
							var newCall = _user$project$Lang$withDummyExpInfo(
								A4(
									_user$project$Lang$EApp,
									_user$project$Lang$ws('\n  '),
									_user$project$Lang$eVar0(_p521),
									_p517,
									_user$project$Lang$space0));
							return A2(
								_user$project$Blobs$callBlob,
								newCall,
								{ctor: '_Tuple2', _0: _p521, _1: _p517});
						}
					}();
					return {
						ctor: '_Tuple2',
						_0: {ctor: '_Tuple4', _0: _p519, _1: _p518, _2: newFunc, _3: _p520},
						_1: newBlob
					};
				}
			}();
			var newDef = _p508._0;
			var newBlob = _p508._1;
			var defs_ = A2(
				_elm_lang$core$Basics_ops['++'],
				beforeDefs,
				A2(
					_elm_lang$core$Basics_ops['++'],
					{
						ctor: '::',
						_0: newDef,
						_1: {ctor: '[]'}
					},
					afterDefs));
			var blobs_ = A2(
				_elm_lang$core$Basics_ops['++'],
				beforeBlobs,
				A2(
					_elm_lang$core$Basics_ops['++'],
					{
						ctor: '::',
						_0: newBlob,
						_1: {ctor: '[]'}
					},
					afterBlobs));
			return {ctor: '_Tuple2', _0: defs_, _1: blobs_};
		} else {
			var _p522 = _elm_lang$core$Debug$log('abstractOne: multiple defs...');
			return {ctor: '_Tuple2', _0: _p524, _1: _p523};
		}
	});
var _user$project$ExpressionBasedTransform$abstractSelectedBlobs = function (model) {
	var _p526 = _user$project$Blobs$splitExp(model.inputExp);
	var defs = _p526._0;
	var mainExp = _p526._1;
	var _p527 = mainExp;
	if (_p527.ctor === 'Blobs') {
		var _p529 = _p527._0;
		var selectedVars = A2(_user$project$ExpressionBasedTransform$selectedBlobsToSelectedVarBlobs, model, _p529);
		var _p528 = A3(
			_elm_lang$core$List$foldl,
			_user$project$ExpressionBasedTransform$abstractOne,
			{ctor: '_Tuple2', _0: defs, _1: _p529},
			selectedVars);
		var defs_ = _p528._0;
		var blobs_ = _p528._1;
		var code_ = _user$project$LangUnparser$unparse(
			_user$project$Blobs$fuseExp(
				{
					ctor: '_Tuple2',
					_0: defs_,
					_1: A2(_user$project$Blobs$Blobs, blobs_, _p527._1)
				}));
		return _elm_lang$core$Native_Utils.update(
			model,
			{code: code_, selectedBlobs: _elm_lang$core$Dict$empty});
	} else {
		return model;
	}
};

var _user$project$FileHandler$write = _elm_lang$core$Native_Platform.outgoingPort(
	'write',
	function (v) {
		return {filename: v.filename, code: v.code};
	});
var _user$project$FileHandler$writeConfirmation = _elm_lang$core$Native_Platform.incomingPort('writeConfirmation', _elm_lang$core$Json_Decode$string);
var _user$project$FileHandler$requestFile = _elm_lang$core$Native_Platform.outgoingPort(
	'requestFile',
	function (v) {
		return v;
	});
var _user$project$FileHandler$receiveFile = _elm_lang$core$Native_Platform.incomingPort(
	'receiveFile',
	A2(
		_elm_lang$core$Json_Decode$andThen,
		function (filename) {
			return A2(
				_elm_lang$core$Json_Decode$andThen,
				function (code) {
					return _elm_lang$core$Json_Decode$succeed(
						{filename: filename, code: code});
				},
				A2(_elm_lang$core$Json_Decode$field, 'code', _elm_lang$core$Json_Decode$string));
		},
		A2(_elm_lang$core$Json_Decode$field, 'filename', _elm_lang$core$Json_Decode$string)));
var _user$project$FileHandler$requestIcon = _elm_lang$core$Native_Platform.outgoingPort(
	'requestIcon',
	function (v) {
		return v;
	});
var _user$project$FileHandler$receiveIcon = _elm_lang$core$Native_Platform.incomingPort(
	'receiveIcon',
	A2(
		_elm_lang$core$Json_Decode$andThen,
		function (iconName) {
			return A2(
				_elm_lang$core$Json_Decode$andThen,
				function (code) {
					return _elm_lang$core$Json_Decode$succeed(
						{iconName: iconName, code: code});
				},
				A2(_elm_lang$core$Json_Decode$field, 'code', _elm_lang$core$Json_Decode$string));
		},
		A2(_elm_lang$core$Json_Decode$field, 'iconName', _elm_lang$core$Json_Decode$string)));
var _user$project$FileHandler$requestFileFromInput = _elm_lang$core$Native_Platform.outgoingPort(
	'requestFileFromInput',
	function (v) {
		return v;
	});
var _user$project$FileHandler$receiveFileFromInput = _elm_lang$core$Native_Platform.incomingPort(
	'receiveFileFromInput',
	A2(
		_elm_lang$core$Json_Decode$andThen,
		function (filename) {
			return A2(
				_elm_lang$core$Json_Decode$andThen,
				function (code) {
					return _elm_lang$core$Json_Decode$succeed(
						{filename: filename, code: code});
				},
				A2(_elm_lang$core$Json_Decode$field, 'code', _elm_lang$core$Json_Decode$string));
		},
		A2(_elm_lang$core$Json_Decode$field, 'filename', _elm_lang$core$Json_Decode$string)));
var _user$project$FileHandler$requestFileIndex = _elm_lang$core$Native_Platform.outgoingPort(
	'requestFileIndex',
	function (v) {
		return null;
	});
var _user$project$FileHandler$receiveFileIndex = _elm_lang$core$Native_Platform.incomingPort(
	'receiveFileIndex',
	_elm_lang$core$Json_Decode$list(_elm_lang$core$Json_Decode$string));
var _user$project$FileHandler$delete = _elm_lang$core$Native_Platform.outgoingPort(
	'delete',
	function (v) {
		return v;
	});
var _user$project$FileHandler$deleteConfirmation = _elm_lang$core$Native_Platform.incomingPort('deleteConfirmation', _elm_lang$core$Json_Decode$string);
var _user$project$FileHandler$download = _elm_lang$core$Native_Platform.outgoingPort(
	'download',
	function (v) {
		return {filename: v.filename, text: v.text};
	});
var _user$project$FileHandler$DownloadInfo = F2(
	function (a, b) {
		return {filename: a, text: b};
	});

var _user$project$ProseScroller$resetProseScroll = _elm_lang$core$Native_Platform.outgoingPort(
	'resetProseScroll',
	function (v) {
		return null;
	});

var _user$project$DeucePopupPanelInfo$requestDeucePopupPanelInfo = _elm_lang$core$Native_Platform.outgoingPort(
	'requestDeucePopupPanelInfo',
	function (v) {
		return null;
	});
var _user$project$DeucePopupPanelInfo$receiveDeucePopupPanelInfo = _elm_lang$core$Native_Platform.incomingPort(
	'receiveDeucePopupPanelInfo',
	A2(
		_elm_lang$core$Json_Decode$andThen,
		function (height) {
			return _elm_lang$core$Json_Decode$succeed(
				{height: height});
		},
		A2(_elm_lang$core$Json_Decode$field, 'height', _elm_lang$core$Json_Decode$int)));
var _user$project$DeucePopupPanelInfo$DeucePopupPanelInfo = function (a) {
	return {height: a};
};

var _user$project$Prose$extractFromUserStudyTemplate = function (m) {
	var _p0 = A2(
		_elm_lang$core$List$partition,
		_elm_lang$core$String$startsWith('; <!-- PROSE --> '),
		_elm_lang$core$String$lines(m.code));
	var proseLines = _p0._0;
	var restLines = _p0._1;
	var residualCode = A2(_elm_lang$core$String$join, '\n', restLines);
	return _elm_lang$core$Native_Utils.update(
		m,
		{
			code: residualCode,
			lastRunCode: residualCode,
			prose: _user$project$Updatable$create(
				function () {
					var _p1 = proseLines;
					if (_p1.ctor === '[]') {
						return _elm_lang$core$Maybe$Nothing;
					} else {
						if (_p1._1.ctor === '[]') {
							return _elm_lang$core$Maybe$Just(
								A2(_elm_lang$core$String$dropLeft, 1, _p1._0));
						} else {
							return A2(_elm_lang$core$Debug$log, 'Prose expected only 1 HTML line...', _elm_lang$core$Maybe$Nothing);
						}
					}
				}())
		});
};

var _user$project$DeuceTools$isRenamer = function (_p0) {
	return A2(
		_elm_lang$core$String$startsWith,
		'Rename',
		function (_) {
			return _.name;
		}(_p0));
};
var _user$project$DeuceTools$isActive = F2(
	function (model, deuceTool) {
		return !_elm_lang$core$Native_Utils.eq(deuceTool.func, _elm_lang$core$Maybe$Nothing);
	});
var _user$project$DeuceTools$runTool = F2(
	function (model, deuceTool) {
		var _p1 = deuceTool.func;
		if (_p1.ctor === 'Just') {
			var _p2 = _user$project$ImpureGoodies$crashToError(_p1._0);
			if (_p2.ctor === 'Ok') {
				return _elm_lang$core$Maybe$Just(_p2._0);
			} else {
				var _p3 = A2(
					_user$project$UserStudyLog$log,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'Deuce Tool Crash \"',
						A2(_elm_lang$core$Basics_ops['++'], deuceTool.name, '\"')),
					_elm_lang$core$Basics$toString(_p2._0));
				return _elm_lang$core$Maybe$Nothing;
			}
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	});
var _user$project$DeuceTools$reselectDeuceTool = function (model) {
	var newSelectedDeuceTool = function () {
		var _p4 = model.selectedDeuceTool;
		if (_p4.ctor === 'Just') {
			return A2(
				_user$project$Utils$findFirst,
				function (_p5) {
					var _p6 = _p5;
					return _elm_lang$core$Native_Utils.eq(_p6._0.id, _p4._0._0.id);
				},
				_elm_lang$core$List$concat(model.deuceToolsAndResults));
		} else {
			return _elm_lang$core$Maybe$Nothing;
		}
	}();
	return _elm_lang$core$Native_Utils.update(
		model,
		{selectedDeuceTool: newSelectedDeuceTool});
};
var _user$project$DeuceTools$alignExpressionsTool = F2(
	function (model, selections) {
		return {
			name: 'Align Expressions',
			func: function () {
				var _p7 = selections;
				if (((((((_p7.ctor === '_Tuple7') && (_p7._2.ctor === '::')) && (_p7._2._1.ctor === '::')) && (_p7._3.ctor === '[]')) && (_p7._4.ctor === '[]')) && (_p7._5.ctor === '[]')) && (_p7._6.ctor === '[]')) {
					var eids = {
						ctor: '::',
						_0: _p7._2._0,
						_1: {ctor: '::', _0: _p7._2._1._0, _1: _p7._2._1._1}
					};
					var exps = A2(
						_elm_lang$core$List$map,
						_user$project$LangTools$justFindExpByEId(model.inputExp),
						eids);
					var lineNums = A2(
						_elm_lang$core$List$map,
						function (_p8) {
							return function (_) {
								return _.line;
							}(
								function (_) {
									return _.start;
								}(_p8));
						},
						exps);
					return (!_elm_lang$core$Native_Utils.eq(
						lineNums,
						_user$project$Utils$dedup(lineNums))) ? _elm_lang$core$Maybe$Nothing : _elm_lang$core$Maybe$Just(
						function (_p9) {
							var _p10 = _p9;
							var maxCol = A2(
								_user$project$Utils$fromJust_,
								'DeuceTools.alignExpressionsTool maxCol',
								_elm_lang$core$List$maximum(
									A2(
										_elm_lang$core$List$map,
										function (_p11) {
											return function (_) {
												return _.col;
											}(
												function (_) {
													return _.start;
												}(_p11));
										},
										exps)));
							return _elm_lang$core$List$singleton(
								A2(
									_user$project$InterfaceModel$synthesisResult,
									'Align Expressions',
									A2(
										_user$project$Lang$mapExp,
										function (e) {
											if (A2(_elm_lang$core$List$member, e.val.eid, eids)) {
												var wsDelta = maxCol - e.start.col;
												return A2(
													_user$project$Lang$pushRight,
													A2(_elm_lang$core$String$repeat, wsDelta, ' '),
													e);
											} else {
												return e;
											}
										},
										model.inputExp)));
						});
				} else {
					return _elm_lang$core$Maybe$Nothing;
				}
			}(),
			reqs: {
				ctor: '::',
				_0: {
					description: 'Select two or more expressions',
					value: function () {
						var _p12 = selections;
						_v6_2:
						do {
							if (_p12.ctor === '_Tuple7') {
								if (_p12._2.ctor === '[]') {
									if ((((((_p12._0.ctor === '[]') && (_p12._1.ctor === '[]')) && (_p12._3.ctor === '[]')) && (_p12._4.ctor === '[]')) && (_p12._5.ctor === '[]')) && (_p12._6.ctor === '[]')) {
										return _user$project$InterfaceModel$Possible;
									} else {
										break _v6_2;
									}
								} else {
									if (((((_p12._2._1.ctor === '::') && (_p12._3.ctor === '[]')) && (_p12._4.ctor === '[]')) && (_p12._5.ctor === '[]')) && (_p12._6.ctor === '[]')) {
										return _user$project$InterfaceModel$Satisfied;
									} else {
										break _v6_2;
									}
								}
							} else {
								break _v6_2;
							}
						} while(false);
						return _user$project$InterfaceModel$Impossible;
					}()
				},
				_1: {ctor: '[]'}
			},
			id: 'alignExpressions'
		};
	});
var _user$project$DeuceTools$makeMultiLineTool = F2(
	function (model, selections) {
		return {
			name: 'Make Multi-line',
			func: function () {
				var _p13 = selections;
				if (((((((_p13.ctor === '_Tuple7') && (_p13._2.ctor === '::')) && (_p13._2._1.ctor === '[]')) && (_p13._3.ctor === '[]')) && (_p13._4.ctor === '[]')) && (_p13._5.ctor === '[]')) && (_p13._6.ctor === '[]')) {
					var _p24 = _p13._2._0;
					var exp = A2(_user$project$LangTools$justFindExpByEId, model.inputExp, _p24);
					var _p14 = exp.val.e__;
					_v8_2:
					do {
						switch (_p14.ctor) {
							case 'EList':
								if (_p14._3.ctor === 'Nothing') {
									var _p18 = _p14._1;
									return A2(
										_elm_lang$core$List$all,
										function (_p15) {
											return A2(
												_elm_lang$core$String$contains,
												'\n',
												_user$project$Lang$precedingWhitespace(_p15));
										},
										_p18) ? _elm_lang$core$Maybe$Nothing : _elm_lang$core$Maybe$Just(
										function (_p16) {
											var _p17 = _p16;
											var indentation = A2(_user$project$Lang$indentationAt, _p24, model.inputExp);
											return _elm_lang$core$List$singleton(
												A2(
													_user$project$InterfaceModel$synthesisResult,
													'Make Multi-line',
													A3(
														_user$project$Lang$replaceExpNodeE__ByEId,
														_p24,
														A5(
															_user$project$Lang$EList,
															_p14._0,
															A3(
																_user$project$Lang$setExpListWhitespace,
																A2(
																	_elm_lang$core$Basics_ops['++'],
																	'\n',
																	A2(_elm_lang$core$Basics_ops['++'], indentation, '  ')),
																A2(
																	_elm_lang$core$Basics_ops['++'],
																	'\n',
																	A2(_elm_lang$core$Basics_ops['++'], indentation, '  ')),
																_p18),
															_p14._2,
															_elm_lang$core$Maybe$Nothing,
															_user$project$Lang$ws(
																A2(_elm_lang$core$Basics_ops['++'], '\n', indentation))),
														model.inputExp)));
										});
								} else {
									break _v8_2;
								}
							case 'EApp':
								var _p23 = _p14._2;
								var _p22 = _p14._1;
								return A2(
									_elm_lang$core$List$all,
									function (_p19) {
										return A2(
											_elm_lang$core$String$contains,
											'\n',
											_user$project$Lang$precedingWhitespace(_p19));
									},
									_p23) ? _elm_lang$core$Maybe$Nothing : _elm_lang$core$Maybe$Just(
									function (_p20) {
										var _p21 = _p20;
										var indentation = A2(_elm_lang$core$String$repeat, _p22.end.col, ' ');
										return _elm_lang$core$List$singleton(
											A2(
												_user$project$InterfaceModel$synthesisResult,
												'Make Multi-line',
												A3(
													_user$project$Lang$replaceExpNodeE__ByEId,
													_p24,
													A4(
														_user$project$Lang$EApp,
														_p14._0,
														_p22,
														A3(
															_user$project$Lang$setExpListWhitespace,
															' ',
															A2(_elm_lang$core$Basics_ops['++'], '\n', indentation),
															_p23),
														_user$project$Lang$space0),
													model.inputExp)));
									});
							default:
								break _v8_2;
						}
					} while(false);
					return _elm_lang$core$Maybe$Nothing;
				} else {
					return _elm_lang$core$Maybe$Nothing;
				}
			}(),
			reqs: {
				ctor: '::',
				_0: {
					description: 'Select one expression',
					value: function () {
						var _p25 = selections;
						_v11_2:
						do {
							if (_p25.ctor === '_Tuple7') {
								if (_p25._2.ctor === '[]') {
									if ((((((_p25._0.ctor === '[]') && (_p25._1.ctor === '[]')) && (_p25._3.ctor === '[]')) && (_p25._4.ctor === '[]')) && (_p25._5.ctor === '[]')) && (_p25._6.ctor === '[]')) {
										return _user$project$InterfaceModel$Possible;
									} else {
										break _v11_2;
									}
								} else {
									if (((((_p25._2._1.ctor === '[]') && (_p25._3.ctor === '[]')) && (_p25._4.ctor === '[]')) && (_p25._5.ctor === '[]')) && (_p25._6.ctor === '[]')) {
										return _user$project$InterfaceModel$FullySatisfied;
									} else {
										break _v11_2;
									}
								}
							} else {
								break _v11_2;
							}
						} while(false);
						return _user$project$InterfaceModel$Impossible;
					}()
				},
				_1: {ctor: '[]'}
			},
			id: 'makeMultiLine'
		};
	});
var _user$project$DeuceTools$makeSingleLineTool = F2(
	function (model, selections) {
		return {
			name: 'Make Single Line',
			func: function () {
				var maybeEIdToDeLineAndWhetherToPreservePrecedingWhitespace = function () {
					var _p26 = selections;
					_v12_2:
					do {
						if (_p26.ctor === '_Tuple7') {
							if (_p26._2.ctor === '::') {
								if (((((_p26._2._1.ctor === '[]') && (_p26._3.ctor === '[]')) && (_p26._4.ctor === '[]')) && (_p26._5.ctor === '[]')) && (_p26._6.ctor === '[]')) {
									return _elm_lang$core$Maybe$Just(
										{ctor: '_Tuple2', _0: _p26._2._0, _1: true});
								} else {
									break _v12_2;
								}
							} else {
								if (((((((_p26._0.ctor === '[]') && (_p26._1.ctor === '[]')) && (_p26._3.ctor === '[]')) && (_p26._4.ctor === '::')) && (_p26._4._1.ctor === '[]')) && (_p26._5.ctor === '[]')) && (_p26._6.ctor === '[]')) {
									return A2(
										_elm_lang$core$Maybe$map,
										function (letBoundExp) {
											return {ctor: '_Tuple2', _0: letBoundExp.val.eid, _1: false};
										},
										A2(
											_elm_lang$core$Maybe$andThen,
											_user$project$LangTools$expToMaybeLetBoundExp,
											A2(_user$project$Lang$findExpByEId, model.inputExp, _p26._4._0)));
								} else {
									break _v12_2;
								}
							}
						} else {
							break _v12_2;
						}
					} while(false);
					return _elm_lang$core$Maybe$Nothing;
				}();
				var _p27 = maybeEIdToDeLineAndWhetherToPreservePrecedingWhitespace;
				if (_p27.ctor === 'Nothing') {
					return _elm_lang$core$Maybe$Nothing;
				} else {
					var _p33 = _p27._0._1;
					var _p32 = _p27._0._0;
					var perhapsLeftTrimmer = _p33 ? _elm_lang$core$String$trimLeft : _elm_lang$core$Basics$identity;
					return A2(
						_elm_lang$core$String$contains,
						'\n',
						perhapsLeftTrimmer(
							_user$project$LangUnparser$unparse(
								A2(_user$project$LangTools$justFindExpByEId, model.inputExp, _p32)))) ? _elm_lang$core$Maybe$Just(
						function (_p28) {
							var _p29 = _p28;
							var deLine = function (ws) {
								return A2(_elm_lang$core$String$contains, '\n', ws.val) ? _user$project$Lang$space1 : ws;
							};
							var deLineP__ = function (p__) {
								var _p30 = p__;
								switch (_p30.ctor) {
									case 'PVar':
										return A3(
											_user$project$Lang$PVar,
											deLine(_p30._0),
											_p30._1,
											_p30._2);
									case 'PConst':
										return A2(
											_user$project$Lang$PConst,
											deLine(_p30._0),
											_p30._1);
									case 'PBase':
										return A2(
											_user$project$Lang$PBase,
											deLine(_p30._0),
											_p30._1);
									case 'PList':
										return A5(
											_user$project$Lang$PList,
											deLine(_p30._0),
											A3(_user$project$Lang$setPatListWhitespace, '', ' ', _p30._1),
											deLine(_p30._2),
											_p30._3,
											_user$project$Lang$space0);
									default:
										return A4(
											_user$project$Lang$PAs,
											deLine(_p30._0),
											_p30._1,
											_user$project$Lang$space1,
											_p30._3);
								}
							};
							var deLinePat = function (p) {
								return A2(
									_user$project$Lang$mapPatTopDown,
									_user$project$Lang$mapNodeP__(deLineP__),
									p);
							};
							var deLineE__ = function (e__) {
								var _p31 = e__;
								switch (_p31.ctor) {
									case 'EBase':
										return A2(
											_user$project$Lang$EBase,
											deLine(_p31._0),
											_p31._1);
									case 'EConst':
										return A4(
											_user$project$Lang$EConst,
											deLine(_p31._0),
											_p31._1,
											_p31._2,
											_p31._3);
									case 'EVar':
										return A2(
											_user$project$Lang$EVar,
											deLine(_p31._0),
											_p31._1);
									case 'EFun':
										return A4(
											_user$project$Lang$EFun,
											deLine(_p31._0),
											A3(
												_user$project$Lang$setPatListWhitespace,
												'',
												' ',
												A2(_elm_lang$core$List$map, deLinePat, _p31._1)),
											_p31._2,
											_user$project$Lang$space0);
									case 'EApp':
										return A4(
											_user$project$Lang$EApp,
											deLine(_p31._0),
											A2(_user$project$Lang$replacePrecedingWhitespace, '', _p31._1),
											_p31._2,
											_user$project$Lang$space0);
									case 'EList':
										return A5(
											_user$project$Lang$EList,
											deLine(_p31._0),
											A3(_user$project$Lang$setExpListWhitespace, '', ' ', _p31._1),
											deLine(_p31._2),
											_p31._3,
											_user$project$Lang$space0);
									case 'EOp':
										return A4(
											_user$project$Lang$EOp,
											deLine(_p31._0),
											_p31._1,
											_p31._2,
											_user$project$Lang$space0);
									case 'EIf':
										return A5(
											_user$project$Lang$EIf,
											deLine(_p31._0),
											_p31._1,
											_p31._2,
											_p31._3,
											_user$project$Lang$space0);
									case 'ELet':
										return A7(
											_user$project$Lang$ELet,
											deLine(_p31._0),
											_p31._1,
											_p31._2,
											_p31._3,
											_p31._4,
											_p31._5,
											_user$project$Lang$space0);
									case 'ECase':
										return A4(
											_user$project$Lang$ECase,
											deLine(_p31._0),
											_p31._1,
											_p31._2,
											_user$project$Lang$space0);
									case 'ETypeCase':
										return A4(
											_user$project$Lang$ETypeCase,
											deLine(_p31._0),
											_p31._1,
											_p31._2,
											_user$project$Lang$space0);
									case 'EComment':
										return A3(_user$project$Lang$EComment, _p31._0, _p31._1, _p31._2);
									case 'EOption':
										return A5(_user$project$Lang$EOption, _p31._0, _p31._1, _user$project$Lang$space1, _p31._3, _p31._4);
									case 'ETyp':
										return A5(
											_user$project$Lang$ETyp,
											deLine(_p31._0),
											_p31._1,
											_p31._2,
											_p31._3,
											_user$project$Lang$space0);
									case 'EColonType':
										return A5(
											_user$project$Lang$EColonType,
											deLine(_p31._0),
											_p31._1,
											deLine(_p31._2),
											_p31._3,
											_user$project$Lang$space0);
									default:
										return A5(
											_user$project$Lang$ETypeAlias,
											deLine(_p31._0),
											_p31._1,
											_p31._2,
											_p31._3,
											_user$project$Lang$space0);
								}
							};
							var deLineExp = function (e) {
								return A2(
									_user$project$Lang$mapExp,
									_user$project$Lang$mapNodeE__(deLineE__),
									e);
							};
							return _elm_lang$core$List$singleton(
								A2(
									_user$project$InterfaceModel$synthesisResult,
									'Make Single Line',
									A3(
										_user$project$Lang$mapExpNode,
										_p32,
										function (e) {
											return (_p33 ? _user$project$Lang$copyPrecedingWhitespace(e) : _user$project$Lang$replacePrecedingWhitespace(' '))(
												deLineExp(e));
										},
										model.inputExp)));
						}) : _elm_lang$core$Maybe$Nothing;
				}
			}(),
			reqs: {
				ctor: '::',
				_0: {
					description: 'Select one expression or definition',
					value: function () {
						var _p34 = selections;
						_v17_3:
						do {
							if (_p34.ctor === '_Tuple7') {
								if (_p34._2.ctor === '::') {
									if (((((_p34._2._1.ctor === '[]') && (_p34._3.ctor === '[]')) && (_p34._4.ctor === '[]')) && (_p34._5.ctor === '[]')) && (_p34._6.ctor === '[]')) {
										return _user$project$InterfaceModel$FullySatisfied;
									} else {
										break _v17_3;
									}
								} else {
									if (((_p34._0.ctor === '[]') && (_p34._1.ctor === '[]')) && (_p34._3.ctor === '[]')) {
										if (_p34._4.ctor === '[]') {
											if ((_p34._5.ctor === '[]') && (_p34._6.ctor === '[]')) {
												return _user$project$InterfaceModel$Possible;
											} else {
												break _v17_3;
											}
										} else {
											if (((_p34._4._1.ctor === '[]') && (_p34._5.ctor === '[]')) && (_p34._6.ctor === '[]')) {
												return _user$project$InterfaceModel$FullySatisfied;
											} else {
												break _v17_3;
											}
										}
									} else {
										break _v17_3;
									}
								}
							} else {
								break _v17_3;
							}
						} while(false);
						return _user$project$InterfaceModel$Impossible;
					}()
				},
				_1: {ctor: '[]'}
			},
			id: 'makeSingleLine'
		};
	});
var _user$project$DeuceTools$reorderExpressionsTool = F2(
	function (model, selections) {
		return {
			name: 'Reorder Expressions',
			func: A2(_user$project$CodeMotion$reorderExpressionsTransformation, model.inputExp, selections),
			reqs: {ctor: '[]'},
			id: 'reorderExpressions'
		};
	});
var _user$project$DeuceTools$reorderArgumentsTool = F2(
	function (model, selections) {
		var _p35 = function () {
			var _p36 = selections;
			_v18_5:
			do {
				if ((_p36.ctor === '_Tuple7') && (_p36._4.ctor === '[]')) {
					if (_p36._5.ctor === '[]') {
						if (_p36._6.ctor === '[]') {
							if (_p36._2.ctor === '[]') {
								if (_p36._3.ctor === '[]') {
									return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Possible};
								} else {
									var scopeEIds = A2(_elm_lang$core$List$map, _user$project$Lang$pathedPatIdToScopeEId, _p36._3);
									return (_user$project$Utils$allSame(scopeEIds) && A2(
										_elm_lang$core$List$all,
										function (_p37) {
											return A2(
												F2(
													function (x, y) {
														return _elm_lang$core$Native_Utils.eq(x, y);
													}),
												_elm_lang$core$Maybe$Just(true),
												A2(
													_elm_lang$core$Maybe$map,
													_user$project$Lang$isFunc,
													A2(_user$project$Lang$findExpByEId, model.inputExp, _p37)));
										},
										scopeEIds)) ? {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Possible} : {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
								}
							} else {
								if (_p36._3.ctor === '[]') {
									var _p38 = _user$project$Utils$projJusts(
										A2(
											_elm_lang$core$List$map,
											_user$project$LangTools$eidToMaybeCorrespondingArgumentPathedPatId(model.inputExp),
											_p36._2));
									if (_p38.ctor === 'Just') {
										return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Possible};
									} else {
										return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
									}
								} else {
									break _v18_5;
								}
							}
						} else {
							if ((((_p36._0.ctor === '[]') && (_p36._1.ctor === '[]')) && (_p36._2.ctor === '[]')) && (_p36._6._1.ctor === '[]')) {
								var _p43 = _p36._3;
								var targetPathedPatId = _user$project$Lang$patTargetPositionToTargetPathedPatId(_p36._6._0);
								var scopeIds = A2(
									_elm_lang$core$List$map,
									_user$project$Lang$pathedPatIdToScopeId,
									{ctor: '::', _0: targetPathedPatId, _1: _p43});
								var targetScopeEId = _user$project$Lang$pathedPatIdToScopeEId(targetPathedPatId);
								var _p40 = {
									ctor: '_Tuple2',
									_0: _user$project$Utils$allSame(scopeIds),
									_1: A2(
										_elm_lang$core$Maybe$map,
										function (_p39) {
											return function (_) {
												return _.e__;
											}(
												function (_) {
													return _.val;
												}(_p39));
										},
										A2(_user$project$Lang$findExpByEId, model.inputExp, targetScopeEId))
								};
								if ((((_p40.ctor === '_Tuple2') && (_p40._0 === true)) && (_p40._1.ctor === 'Just')) && (_p40._1._0.ctor === 'EFun')) {
									return {
										ctor: '_Tuple2',
										_0: _elm_lang$core$Maybe$Just(
											function (_p41) {
												var _p42 = _p41;
												return A4(
													_user$project$CodeMotion$reorderFunctionArgs,
													targetScopeEId,
													A2(_elm_lang$core$List$map, _user$project$Lang$pathedPatIdToPath, _p43),
													_user$project$Lang$pathedPatIdToPath(targetPathedPatId),
													model.inputExp);
											}),
										_1: _user$project$InterfaceModel$Satisfied
									};
								} else {
									return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
								}
							} else {
								break _v18_5;
							}
						}
					} else {
						if ((((_p36._3.ctor === '[]') && (_p36._5._0.ctor === '_Tuple2')) && (_p36._5._1.ctor === '[]')) && (_p36._6.ctor === '[]')) {
							var _p44 = _user$project$Utils$projJusts(
								A2(
									_elm_lang$core$List$map,
									_user$project$LangTools$eidToMaybeCorrespondingArgumentPathedPatId(model.inputExp),
									{ctor: '::', _0: _p36._5._0._1, _1: _p36._2}));
							if ((_p44.ctor === 'Just') && (_p44._0.ctor === '::')) {
								var _p49 = _p44._0._1;
								var targetPathedPatId = _user$project$Lang$patTargetPositionToTargetPathedPatId(
									{ctor: '_Tuple2', _0: _p36._5._0._0, _1: _p44._0._0});
								var scopeIds = A2(
									_elm_lang$core$List$map,
									_user$project$Lang$pathedPatIdToScopeId,
									{ctor: '::', _0: targetPathedPatId, _1: _p49});
								var targetEId = _user$project$Lang$pathedPatIdToScopeEId(targetPathedPatId);
								var _p46 = {
									ctor: '_Tuple2',
									_0: _user$project$Utils$allSame(scopeIds),
									_1: A2(
										_elm_lang$core$Maybe$map,
										function (_p45) {
											return function (_) {
												return _.e__;
											}(
												function (_) {
													return _.val;
												}(_p45));
										},
										A2(_user$project$Lang$findExpByEId, model.inputExp, targetEId))
								};
								if ((((_p46.ctor === '_Tuple2') && (_p46._0 === true)) && (_p46._1.ctor === 'Just')) && (_p46._1._0.ctor === 'EFun')) {
									return {
										ctor: '_Tuple2',
										_0: _elm_lang$core$Maybe$Just(
											function (_p47) {
												var _p48 = _p47;
												return A4(
													_user$project$CodeMotion$reorderFunctionArgs,
													targetEId,
													A2(_elm_lang$core$List$map, _user$project$Lang$pathedPatIdToPath, _p49),
													_user$project$Lang$pathedPatIdToPath(targetPathedPatId),
													model.inputExp);
											}),
										_1: _user$project$InterfaceModel$Satisfied
									};
								} else {
									return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
								}
							} else {
								return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
							}
						} else {
							break _v18_5;
						}
					}
				} else {
					break _v18_5;
				}
			} while(false);
			return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
		}();
		var func = _p35._0;
		var possibility = _p35._1;
		var makeReqs = function (predVal) {
			return {
				ctor: '::',
				_0: {description: 'Select one or more function arguments (either at the definition\n               or a call-site) and one target position (i.e. whitespace) in that list', value: predVal},
				_1: {ctor: '[]'}
			};
		};
		return {
			name: 'Reorder Arguments',
			func: func,
			reqs: makeReqs(possibility),
			id: 'reorderArguments'
		};
	});
var _user$project$DeuceTools$removeArgumentsTool = F2(
	function (model, selections) {
		var makeReqs = function (predVal) {
			return {
				ctor: '::',
				_0: {description: 'Select function arguments at definitions or call-sites', value: predVal},
				_1: {ctor: '[]'}
			};
		};
		var id = 'removeArguments';
		var toolName = 'Remove Argument';
		var defaultTool = function (predVal) {
			return {
				name: toolName,
				func: _elm_lang$core$Maybe$Nothing,
				reqs: makeReqs(predVal),
				id: id
			};
		};
		var disabledTool = defaultTool(_user$project$InterfaceModel$Impossible);
		var _p50 = selections;
		_v25_4:
		do {
			if (_p50.ctor === '_Tuple7') {
				if (_p50._2.ctor === '[]') {
					if (_p50._3.ctor === '[]') {
						if (((((_p50._4.ctor === '[]') && (_p50._5.ctor === '[]')) && (_p50._6.ctor === '[]')) && (_p50._0.ctor === '[]')) && (_p50._1.ctor === '[]')) {
							return defaultTool(_user$project$InterfaceModel$Possible);
						} else {
							return disabledTool;
						}
					} else {
						if (((((_p50._0.ctor === '[]') && (_p50._1.ctor === '[]')) && (_p50._4.ctor === '[]')) && (_p50._5.ctor === '[]')) && (_p50._6.ctor === '[]')) {
							var _p57 = _p50._3;
							var isAllArgumentSelected = A2(
								_elm_lang$core$List$all,
								function (pathedPatId) {
									var scopeExp = A2(
										_user$project$Lang$findExpByEId,
										model.inputExp,
										_user$project$Lang$pathedPatIdToScopeEId(pathedPatId));
									var _p52 = A2(
										_elm_lang$core$Maybe$map,
										function (_p51) {
											return function (_) {
												return _.e__;
											}(
												function (_) {
													return _.val;
												}(_p51));
										},
										scopeExp);
									if ((_p52.ctor === 'Just') && (_p52._0.ctor === 'EFun')) {
										return true;
									} else {
										return false;
									}
								},
								_p57);
							return (isAllArgumentSelected && _elm_lang$core$Native_Utils.eq(
								_elm_lang$core$List$length(_p57),
								1)) ? {
								name: 'Remove Argument',
								func: _elm_lang$core$Maybe$Just(
									function (_p53) {
										var _p54 = _p53;
										return A2(
											_user$project$CodeMotion$removeArg,
											_user$project$Utils$head_(_p57),
											model.inputExp);
									}),
								reqs: makeReqs(_user$project$InterfaceModel$Satisfied),
								id: id
							} : (isAllArgumentSelected ? {
								name: 'Remove Arguments',
								func: _elm_lang$core$Maybe$Just(
									function (_p55) {
										var _p56 = _p55;
										return A2(_user$project$CodeMotion$removeArgs, _p57, model.inputExp);
									}),
								reqs: makeReqs(_user$project$InterfaceModel$Satisfied),
								id: id
							} : disabledTool);
						} else {
							break _v25_4;
						}
					}
				} else {
					if ((((_p50._3.ctor === '[]') && (_p50._4.ctor === '[]')) && (_p50._5.ctor === '[]')) && (_p50._6.ctor === '[]')) {
						var _p58 = _user$project$Utils$projJusts(
							A2(
								_elm_lang$core$List$map,
								_user$project$LangTools$eidToMaybeCorrespondingArgumentPathedPatId(model.inputExp),
								_p50._2));
						if (_p58.ctor === 'Just') {
							if ((_p58._0.ctor === '::') && (_p58._0._1.ctor === '[]')) {
								return {
									name: 'Remove Argument',
									func: _elm_lang$core$Maybe$Just(
										function (_p59) {
											var _p60 = _p59;
											return A2(_user$project$CodeMotion$removeArg, _p58._0._0, model.inputExp);
										}),
									reqs: makeReqs(_user$project$InterfaceModel$Satisfied),
									id: id
								};
							} else {
								return {
									name: 'Remove Arguments',
									func: _elm_lang$core$Maybe$Just(
										function (_p61) {
											var _p62 = _p61;
											return A2(_user$project$CodeMotion$removeArgs, _p58._0, model.inputExp);
										}),
									reqs: makeReqs(_user$project$InterfaceModel$Satisfied),
									id: id
								};
							}
						} else {
							return disabledTool;
						}
					} else {
						break _v25_4;
					}
				}
			} else {
				break _v25_4;
			}
		} while(false);
		return disabledTool;
	});
var _user$project$DeuceTools$addArgumentsTool = F2(
	function (model, selections) {
		var makeReqs = function (predVal) {
			return {
				ctor: '::',
				_0: {description: 'Select one or more expressions in a function and, optionally,\n               one target position (i.e. whitespace) in the function\'s argument list', value: predVal},
				_1: {ctor: '[]'}
			};
		};
		var id = 'addArguments';
		var toolName = 'Add Argument';
		var defaultTool = function (predVal) {
			return {
				name: toolName,
				func: _elm_lang$core$Maybe$Nothing,
				reqs: makeReqs(predVal),
				id: id
			};
		};
		var disabledTool = defaultTool(_user$project$InterfaceModel$Impossible);
		var _p63 = selections;
		_v32_4:
		do {
			if (_p63.ctor === '_Tuple7') {
				if (_p63._2.ctor === '::') {
					if (((_p63._3.ctor === '[]') && (_p63._4.ctor === '[]')) && (_p63._5.ctor === '[]')) {
						var eids = {ctor: '::', _0: _p63._2._0, _1: _p63._2._1};
						var enclosingFuncs = A2(
							_elm_lang$core$List$filter,
							_user$project$Lang$isFunc,
							A2(
								_user$project$Lang$commonAncestors,
								function (e) {
									return A2(_elm_lang$core$List$member, e.val.eid, eids);
								},
								model.inputExp));
						var targetPPIdsWithValidity = A2(
							_elm_lang$core$List$map,
							function (targetPPId) {
								return {
									ctor: '_Tuple2',
									_0: targetPPId,
									_1: A2(
										_elm_lang$core$List$any,
										function (_p64) {
											return A2(
												F2(
													function (x, y) {
														return _elm_lang$core$Native_Utils.eq(x, y);
													}),
												_user$project$Lang$pathedPatIdToScopeEId(targetPPId),
												function (_) {
													return _.eid;
												}(
													function (_) {
														return _.val;
													}(_p64)));
										},
										enclosingFuncs)
								};
							},
							A2(_elm_lang$core$List$map, _user$project$Lang$patTargetPositionToTargetPathedPatId, _p63._6));
						var targetPPIdsToTry = function () {
							var funcExpToArgPPId = function (funcExp) {
								return {
									ctor: '_Tuple2',
									_0: {ctor: '_Tuple2', _0: funcExp.val.eid, _1: 1},
									_1: {
										ctor: '::',
										_0: 1 + _elm_lang$core$List$length(
											_user$project$LangTools$expToFuncPats(funcExp)),
										_1: {ctor: '[]'}
									}
								};
							};
							var _p65 = targetPPIdsWithValidity;
							if (_p65.ctor === '[]') {
								return A2(_elm_lang$core$List$map, funcExpToArgPPId, enclosingFuncs);
							} else {
								if (((_p65._0.ctor === '_Tuple2') && (_p65._0._1 === true)) && (_p65._1.ctor === '[]')) {
									return {
										ctor: '::',
										_0: _p65._0._0,
										_1: {ctor: '[]'}
									};
								} else {
									return {ctor: '[]'};
								}
							}
						}();
						var _p66 = {ctor: '_Tuple2', _0: eids, _1: targetPPIdsToTry};
						_v34_2:
						do {
							if ((_p66.ctor === '_Tuple2') && (_p66._0.ctor === '::')) {
								if (_p66._0._1.ctor === '[]') {
									if (_p66._1.ctor === '::') {
										return {
											name: 'Add Argument',
											func: _elm_lang$core$Maybe$Just(
												function (_p67) {
													var _p68 = _p67;
													return A2(
														_elm_lang$core$List$concatMap,
														function (targetPPId) {
															return A3(_user$project$CodeMotion$addArg, _p66._0._0, targetPPId, model.inputExp);
														},
														targetPPIdsToTry);
												}),
											reqs: makeReqs(_user$project$InterfaceModel$Satisfied),
											id: id
										};
									} else {
										break _v34_2;
									}
								} else {
									if (_p66._1.ctor === '::') {
										return {
											name: 'Add Arguments',
											func: _elm_lang$core$Maybe$Just(
												function (_p69) {
													var _p70 = _p69;
													return A2(
														_elm_lang$core$List$concatMap,
														function (targetPPId) {
															return A3(_user$project$CodeMotion$addArgs, eids, targetPPId, model.inputExp);
														},
														targetPPIdsToTry);
												}),
											reqs: makeReqs(_user$project$InterfaceModel$Satisfied),
											id: id
										};
									} else {
										break _v34_2;
									}
								}
							} else {
								break _v34_2;
							}
						} while(false);
						return disabledTool;
					} else {
						break _v32_4;
					}
				} else {
					if (_p63._3.ctor === '[]') {
						if ((_p63._4.ctor === '[]') && (_p63._5.ctor === '[]')) {
							if (_p63._6.ctor === '[]') {
								return defaultTool(_user$project$InterfaceModel$Possible);
							} else {
								if (_p63._6._1.ctor === '[]') {
									return defaultTool(_user$project$InterfaceModel$Possible);
								} else {
									break _v32_4;
								}
							}
						} else {
							break _v32_4;
						}
					} else {
						if ((_p63._4.ctor === '[]') && (_p63._5.ctor === '[]')) {
							var argSourcePathedPatIds = {ctor: '::', _0: _p63._3._0, _1: _p63._3._1};
							var argSourceScopeEIds = A2(_elm_lang$core$List$map, _user$project$Lang$pathedPatIdToScopeEId, argSourcePathedPatIds);
							var areSourcesAllLets = A2(
								_elm_lang$core$List$all,
								function (_p71) {
									return A2(
										F2(
											function (x, y) {
												return _elm_lang$core$Native_Utils.eq(x, y);
											}),
										_elm_lang$core$Maybe$Just(true),
										A2(
											_elm_lang$core$Maybe$map,
											_user$project$Lang$isLet,
											A2(_user$project$Lang$findExpByEId, model.inputExp, _p71)));
								},
								argSourceScopeEIds);
							var enclosingFuncs = A2(
								_elm_lang$core$List$filter,
								_user$project$Lang$isFunc,
								A2(
									_user$project$Lang$commonAncestors,
									function (e) {
										return A2(_elm_lang$core$List$member, e.val.eid, argSourceScopeEIds);
									},
									model.inputExp));
							var targetPPIdsWithValidity = A2(
								_elm_lang$core$List$map,
								function (targetPPId) {
									return {
										ctor: '_Tuple2',
										_0: targetPPId,
										_1: A2(
											_elm_lang$core$List$any,
											function (_p72) {
												return A2(
													F2(
														function (x, y) {
															return _elm_lang$core$Native_Utils.eq(x, y);
														}),
													_user$project$Lang$pathedPatIdToScopeEId(targetPPId),
													function (_) {
														return _.eid;
													}(
														function (_) {
															return _.val;
														}(_p72)));
											},
											enclosingFuncs)
									};
								},
								A2(_elm_lang$core$List$map, _user$project$Lang$patTargetPositionToTargetPathedPatId, _p63._6));
							var targetPPIdsToTry = function () {
								var funcExpToArgPPId = function (funcExp) {
									return {
										ctor: '_Tuple2',
										_0: {ctor: '_Tuple2', _0: funcExp.val.eid, _1: 1},
										_1: {
											ctor: '::',
											_0: 1 + _elm_lang$core$List$length(
												_user$project$LangTools$expToFuncPats(funcExp)),
											_1: {ctor: '[]'}
										}
									};
								};
								var _p73 = targetPPIdsWithValidity;
								if (_p73.ctor === '[]') {
									return A2(_elm_lang$core$List$map, funcExpToArgPPId, enclosingFuncs);
								} else {
									if (((_p73._0.ctor === '_Tuple2') && (_p73._0._1 === true)) && (_p73._1.ctor === '[]')) {
										return {
											ctor: '::',
											_0: _p73._0._0,
											_1: {ctor: '[]'}
										};
									} else {
										return {ctor: '[]'};
									}
								}
							}();
							var _p74 = {ctor: '_Tuple3', _0: argSourcePathedPatIds, _1: targetPPIdsToTry, _2: areSourcesAllLets};
							_v38_2:
							do {
								if ((_p74.ctor === '_Tuple3') && (_p74._0.ctor === '::')) {
									if (_p74._0._1.ctor === '[]') {
										if ((_p74._1.ctor === '::') && (_p74._2 === true)) {
											return {
												name: 'Add Argument',
												func: _elm_lang$core$Maybe$Just(
													function (_p75) {
														var _p76 = _p75;
														return A2(
															_elm_lang$core$List$concatMap,
															function (targetPPId) {
																return A3(_user$project$CodeMotion$addArgFromPat, _p74._0._0, targetPPId, model.inputExp);
															},
															targetPPIdsToTry);
													}),
												reqs: makeReqs(_user$project$InterfaceModel$Satisfied),
												id: id
											};
										} else {
											break _v38_2;
										}
									} else {
										if ((_p74._1.ctor === '::') && (_p74._2 === true)) {
											return {
												name: 'Add Arguments',
												func: _elm_lang$core$Maybe$Just(
													function (_p77) {
														var _p78 = _p77;
														return A2(
															_elm_lang$core$List$concatMap,
															function (targetPPId) {
																return A3(_user$project$CodeMotion$addArgsFromPats, argSourcePathedPatIds, targetPPId, model.inputExp);
															},
															targetPPIdsToTry);
													}),
												reqs: makeReqs(_user$project$InterfaceModel$Satisfied),
												id: id
											};
										} else {
											break _v38_2;
										}
									}
								} else {
									break _v38_2;
								}
							} while(false);
							return disabledTool;
						} else {
							break _v32_4;
						}
					}
				}
			} else {
				break _v32_4;
			}
		} while(false);
		return disabledTool;
	});
var _user$project$DeuceTools$mergeTool = F2(
	function (model, selections) {
		var tryMerge = function (eids) {
			var mergeResults = function () {
				var minCloneCount = _elm_lang$core$List$length(eids);
				var candidateExpFilter = function (e) {
					return A2(_elm_lang$core$List$member, e.val.eid, eids);
				};
				return A4(_user$project$ExpressionBasedTransform$cloneEliminationSythesisResults, candidateExpFilter, minCloneCount, 2, model.inputExp);
			}();
			return (!_elm_lang$core$Native_Utils.eq(
				mergeResults,
				{ctor: '[]'})) ? {
				ctor: '_Tuple2',
				_0: _elm_lang$core$Maybe$Just(
					function (_p79) {
						var _p80 = _p79;
						return mergeResults;
					}),
				_1: _user$project$InterfaceModel$Satisfied
			} : {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
		};
		var _p81 = function () {
			var _p82 = selections;
			_v42_5:
			do {
				if (_p82.ctor === '_Tuple7') {
					if (_p82._2.ctor === '[]') {
						if (_p82._3.ctor === '[]') {
							if (_p82._4.ctor === '[]') {
								if ((((_p82._0.ctor === '[]') && (_p82._1.ctor === '[]')) && (_p82._5.ctor === '[]')) && (_p82._6.ctor === '[]')) {
									return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Possible};
								} else {
									break _v42_5;
								}
							} else {
								if (_p82._4._1.ctor === '[]') {
									if ((((_p82._0.ctor === '[]') && (_p82._1.ctor === '[]')) && (_p82._5.ctor === '[]')) && (_p82._6.ctor === '[]')) {
										return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Possible};
									} else {
										break _v42_5;
									}
								} else {
									if ((_p82._5.ctor === '[]') && (_p82._6.ctor === '[]')) {
										var boundExpEIds = A2(
											_elm_lang$core$List$map,
											function (_p83) {
												return function (_) {
													return _.eid;
												}(
													function (_) {
														return _.val;
													}(
														_user$project$LangTools$expToLetBoundExp(
															A2(_user$project$LangTools$justFindExpByEId, model.inputExp, _p83))));
											},
											{
												ctor: '::',
												_0: _p82._4._0,
												_1: {ctor: '::', _0: _p82._4._1._0, _1: _p82._4._1._1}
											});
										return tryMerge(boundExpEIds);
									} else {
										break _v42_5;
									}
								}
							}
						} else {
							break _v42_5;
						}
					} else {
						if (_p82._2._1.ctor === '[]') {
							if ((((((_p82._0.ctor === '[]') && (_p82._1.ctor === '[]')) && (_p82._3.ctor === '[]')) && (_p82._4.ctor === '[]')) && (_p82._5.ctor === '[]')) && (_p82._6.ctor === '[]')) {
								return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Possible};
							} else {
								break _v42_5;
							}
						} else {
							if ((((_p82._3.ctor === '[]') && (_p82._4.ctor === '[]')) && (_p82._5.ctor === '[]')) && (_p82._6.ctor === '[]')) {
								return tryMerge(
									{
										ctor: '::',
										_0: _p82._2._0,
										_1: {ctor: '::', _0: _p82._2._1._0, _1: _p82._2._1._1}
									});
							} else {
								break _v42_5;
							}
						}
					}
				} else {
					break _v42_5;
				}
			} while(false);
			return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
		}();
		var func = _p81._0;
		var predVal = _p81._1;
		return {
			name: 'Create Function by Merging Definitions',
			func: func,
			reqs: {
				ctor: '::',
				_0: {description: 'Select two or more expressions', value: predVal},
				_1: {ctor: '[]'}
			},
			id: 'merge'
		};
	});
var _user$project$DeuceTools$createFunctionFromArgsTool = F2(
	function (model, selections) {
		var _p84 = function () {
			var _p85 = selections;
			if ((((_p85.ctor === '_Tuple7') && (_p85._4.ctor === '[]')) && (_p85._5.ctor === '[]')) && (_p85._6.ctor === '[]')) {
				if ((((_p85._0.ctor === '[]') && (_p85._1.ctor === '[]')) && (_p85._2.ctor === '[]')) && (_p85._3.ctor === '[]')) {
					return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Possible};
				} else {
					var _p86 = _user$project$Utils$projJusts(
						A2(
							_elm_lang$core$List$map,
							function (ppid) {
								return A2(_user$project$LangTools$findBoundExpByPathedPatternId, ppid, model.inputExp);
							},
							_p85._3));
					if (_p86.ctor === 'Just') {
						var argEIds = _user$project$Utils$dedup(
							A2(
								_elm_lang$core$Basics_ops['++'],
								_p85._2,
								A2(
									_elm_lang$core$List$map,
									function (_p87) {
										return function (_) {
											return _.eid;
										}(
											function (_) {
												return _.val;
											}(_p87));
									},
									_p86._0)));
						var enclosingPPIds = function () {
							var ancestors = A2(
								_user$project$Lang$commonAncestors,
								function (e) {
									return A2(_elm_lang$core$List$member, e.val.eid, argEIds);
								},
								model.inputExp);
							var ancestorEIds = A2(
								_elm_lang$core$List$map,
								function (_p88) {
									return function (_) {
										return _.eid;
									}(
										function (_) {
											return _.val;
										}(_p88));
								},
								ancestors);
							return A2(
								_elm_lang$core$List$concatMap,
								function (letExp) {
									return A2(
										_elm_lang$core$List$map,
										function (_p89) {
											var _p90 = _p89;
											return {
												ctor: '_Tuple2',
												_0: {ctor: '_Tuple2', _0: letExp.val.eid, _1: 1},
												_1: _p90._0
											};
										},
										A2(
											_elm_lang$core$List$filter,
											function (_p91) {
												var _p92 = _p91;
												return A2(_elm_lang$core$List$member, _p92._1.val.eid, ancestorEIds);
											},
											A2(
												_elm_lang$core$List$filter,
												function (_p93) {
													var _p94 = _p93;
													return !_user$project$Lang$isFunc(_p94._1);
												},
												A2(
													_user$project$LangTools$tryMatchExpPatToPaths,
													_user$project$LangTools$expToLetPat(letExp),
													_user$project$LangTools$expToLetBoundExp(letExp)))));
								},
								A2(
									_elm_lang$core$List$filter,
									function (_p95) {
										return A2(
											F2(
												function (x, y) {
													return !_elm_lang$core$Native_Utils.eq(x, y);
												}),
											_elm_lang$core$Maybe$Just('main'),
											_user$project$LangTools$patToMaybePVarIdent(
												_user$project$LangTools$expToLetPat(_p95)));
									},
									A2(_elm_lang$core$List$filter, _user$project$Lang$isLet, ancestors)));
						}();
						var _p96 = enclosingPPIds;
						if (_p96.ctor === '[]') {
							return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
						} else {
							return {
								ctor: '_Tuple2',
								_0: _elm_lang$core$Maybe$Just(
									function (_p97) {
										var _p98 = _p97;
										return A2(
											_elm_lang$core$List$concatMap,
											function (ppid) {
												return A3(_user$project$CodeMotion$abstractPVar, ppid, argEIds, model.inputExp);
											},
											enclosingPPIds);
									}),
								_1: _user$project$InterfaceModel$Satisfied
							};
						}
					} else {
						return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
					}
				}
			} else {
				return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
			}
		}();
		var func = _p84._0;
		var predVal = _p84._1;
		return {
			name: 'Create Function from Arguments',
			func: func,
			reqs: {
				ctor: '::',
				_0: {description: 'Select expressions or patterns to become arguments to a new function.', value: predVal},
				_1: {ctor: '[]'}
			},
			id: 'createFunctionFromArguments'
		};
	});
var _user$project$DeuceTools$createFunctionTool = F2(
	function (model, selections) {
		var _p99 = function () {
			var _p100 = selections;
			_v50_4:
			do {
				if (_p100.ctor === '_Tuple7') {
					if (_p100._2.ctor === '::') {
						if (((((_p100._2._1.ctor === '[]') && (_p100._3.ctor === '[]')) && (_p100._4.ctor === '[]')) && (_p100._5.ctor === '[]')) && (_p100._6.ctor === '[]')) {
							var _p109 = _p100._2._0;
							var maybeExpToAbstract = A2(_user$project$Lang$findExpByEId, model.inputExp, _p109);
							var expToAbstractParts = A2(
								_elm_lang$core$Maybe$withDefault,
								{ctor: '[]'},
								A2(_elm_lang$core$Maybe$map, _user$project$Lang$flattenExpTree, maybeExpToAbstract));
							var parameterCount = A2(
								_user$project$Utils$count,
								function (e) {
									return A2(_user$project$CodeMotion$shouldBeParameterIsConstant, e, model.inputExp);
								},
								expToAbstractParts) + A2(
								_user$project$Utils$count,
								function (e) {
									return A2(_user$project$CodeMotion$shouldBeParameterIsNamedUnfrozenConstant, e, model.inputExp);
								},
								expToAbstractParts);
							var expSize = A2(
								_elm_lang$core$Maybe$withDefault,
								0,
								A2(_elm_lang$core$Maybe$map, _user$project$LangTools$nodeCount, maybeExpToAbstract));
							return ((_elm_lang$core$Native_Utils.cmp(parameterCount, 0) > 0) && (_elm_lang$core$Native_Utils.cmp(expSize, 3) > -1)) ? {
								ctor: '_Tuple2',
								_0: _elm_lang$core$Maybe$Just(
									function (_p107) {
										var _p108 = _p107;
										return A2(_user$project$CodeMotion$abstractExp, _p109, model.inputExp);
									}),
								_1: _user$project$InterfaceModel$FullySatisfied
							} : {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
						} else {
							break _v50_4;
						}
					} else {
						if ((_p100._0.ctor === '[]') && (_p100._1.ctor === '[]')) {
							if (_p100._3.ctor === '::') {
								if ((((_p100._3._1.ctor === '[]') && (_p100._4.ctor === '[]')) && (_p100._5.ctor === '[]')) && (_p100._6.ctor === '[]')) {
									var _p106 = _p100._3._0;
									var _p103 = A2(
										_elm_lang$core$Maybe$map,
										function (_p101) {
											var _p102 = _p101;
											return {ctor: '_Tuple2', _0: _p102._0.val.e__, _1: _p102._1.val.p__};
										},
										A2(_user$project$LangTools$findScopeExpAndPatByPathedPatternId, _p106, model.inputExp));
									if ((((_p103.ctor === 'Just') && (_p103._0.ctor === '_Tuple2')) && (_p103._0._0.ctor === 'ELet')) && (_p103._0._1.ctor === 'PVar')) {
										return {
											ctor: '_Tuple2',
											_0: _elm_lang$core$Maybe$Just(
												function (_p104) {
													var _p105 = _p104;
													return A3(
														_user$project$CodeMotion$abstractPVar,
														_p106,
														{ctor: '[]'},
														model.inputExp);
												}),
											_1: _user$project$InterfaceModel$FullySatisfied
										};
									} else {
										return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
									}
								} else {
									break _v50_4;
								}
							} else {
								if (_p100._4.ctor === '[]') {
									if ((_p100._5.ctor === '[]') && (_p100._6.ctor === '[]')) {
										return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Possible};
									} else {
										break _v50_4;
									}
								} else {
									if (((_p100._4._1.ctor === '[]') && (_p100._5.ctor === '[]')) && (_p100._6.ctor === '[]')) {
										var _p114 = _p100._4._0;
										var _p111 = A2(
											_elm_lang$core$Maybe$map,
											function (_p110) {
												return function (_) {
													return _.p__;
												}(
													function (_) {
														return _.val;
													}(_p110));
											},
											_user$project$LangTools$expToMaybeLetPat(
												A2(_user$project$LangTools$justFindExpByEId, model.inputExp, _p114)));
										if ((_p111.ctor === 'Just') && (_p111._0.ctor === 'PVar')) {
											return {
												ctor: '_Tuple2',
												_0: _elm_lang$core$Maybe$Just(
													function (_p112) {
														var _p113 = _p112;
														var pathedPatId = {
															ctor: '_Tuple2',
															_0: {ctor: '_Tuple2', _0: _p114, _1: 1},
															_1: {ctor: '[]'}
														};
														return A3(
															_user$project$CodeMotion$abstractPVar,
															pathedPatId,
															{ctor: '[]'},
															model.inputExp);
													}),
												_1: _user$project$InterfaceModel$FullySatisfied
											};
										} else {
											return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
										}
									} else {
										break _v50_4;
									}
								}
							}
						} else {
							break _v50_4;
						}
					}
				} else {
					break _v50_4;
				}
			} while(false);
			return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
		}();
		var func = _p99._0;
		var predVal = _p99._1;
		return {
			name: 'Create Function from Definition',
			func: func,
			reqs: {
				ctor: '::',
				_0: {description: 'Select one variable definition or expression', value: predVal},
				_1: {ctor: '[]'}
			},
			id: 'createFunction'
		};
	});
var _user$project$DeuceTools$convertColorStringTool = F2(
	function (model, selections) {
		var baseName = 'Convert Color String';
		var impossible = {ctor: '_Tuple3', _0: baseName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Impossible};
		var _p115 = function () {
			var _p116 = selections;
			if ((((((_p116.ctor === '_Tuple7') && (_p116._0.ctor === '[]')) && (_p116._3.ctor === '[]')) && (_p116._4.ctor === '[]')) && (_p116._5.ctor === '[]')) && (_p116._6.ctor === '[]')) {
				if ((_p116._1.ctor === '[]') && (_p116._2.ctor === '[]')) {
					return {ctor: '_Tuple3', _0: baseName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Possible};
				} else {
					var _p127 = _p116._1;
					var literalCount = _elm_lang$core$List$length(_p127);
					var expCount = _elm_lang$core$List$length(_p116._2);
					if (!_elm_lang$core$Native_Utils.eq(expCount, literalCount)) {
						return impossible;
					} else {
						var idStringPairs = A2(
							_elm_lang$core$List$filterMap,
							function (_p117) {
								var _p118 = _p117;
								var _p119 = _p118._1._1;
								if (_p119.ctor === 'EString') {
									return _elm_lang$core$Maybe$Just(
										{ctor: '_Tuple2', _0: _p118._0, _1: _p119._1});
								} else {
									return _elm_lang$core$Maybe$Nothing;
								}
							},
							_p127);
						var idStringPairCount = _elm_lang$core$List$length(idStringPairs);
						if (!_elm_lang$core$Native_Utils.eq(literalCount, idStringPairCount)) {
							return impossible;
						} else {
							var convertedStrings = A2(_elm_lang$core$List$filterMap, _user$project$ColorNum$convertStringToRgbAndHue, idStringPairs);
							var convertedStringCount = _elm_lang$core$List$length(convertedStrings);
							if (!_elm_lang$core$Native_Utils.eq(idStringPairCount, convertedStringCount)) {
								return impossible;
							} else {
								var _p120 = A3(
									_elm_lang$core$List$foldl,
									F2(
										function (_p122, _p121) {
											var _p123 = _p122;
											var _p124 = _p121;
											var eColorNum = A2(_user$project$Lang$eConst, _p123._2, _user$project$Lang$dummyLoc);
											var eRgba = A2(
												_user$project$Lang$eList,
												_user$project$Lang$listOfNums(
													{
														ctor: '::',
														_0: _p123._1._0,
														_1: {
															ctor: '::',
															_0: _p123._1._1,
															_1: {
																ctor: '::',
																_0: _p123._1._2,
																_1: {
																	ctor: '::',
																	_0: 1.0,
																	_1: {ctor: '[]'}
																}
															}
														}
													}),
												_elm_lang$core$Maybe$Nothing);
											var replaceString = _user$project$Lang$replaceExpNodePreservingPrecedingWhitespace(_p123._0);
											return {
												ctor: '_Tuple2',
												_0: A2(replaceString, eRgba, _p124._0),
												_1: A2(replaceString, eColorNum, _p124._1)
											};
										}),
									{ctor: '_Tuple2', _0: model.inputExp, _1: model.inputExp},
									convertedStrings);
								var newExp1 = _p120._0;
								var newExp2 = _p120._1;
								return {
									ctor: '_Tuple3',
									_0: A2(_user$project$Utils$perhapsPluralizeList, baseName, _p127),
									_1: _elm_lang$core$Maybe$Just(
										function (_p125) {
											var _p126 = _p125;
											return {
												ctor: '::',
												_0: A2(_user$project$InterfaceModel$synthesisResult, 'RGBA', newExp1),
												_1: {
													ctor: '::',
													_0: A2(
														_user$project$InterfaceModel$setResultSafe,
														false,
														A2(_user$project$InterfaceModel$synthesisResult, 'Color Number (Hue Only)', newExp2)),
													_1: {ctor: '[]'}
												}
											};
										}),
									_2: _user$project$InterfaceModel$Satisfied
								};
							}
						}
					}
				}
			} else {
				return impossible;
			}
		}();
		var name = _p115._0;
		var func = _p115._1;
		var predVal = _p115._2;
		return {
			name: name,
			func: func,
			reqs: {
				ctor: '::',
				_0: {description: 'Select one or more color strings', value: predVal},
				_1: {ctor: '[]'}
			},
			id: 'convertColorString'
		};
	});
var _user$project$DeuceTools$rewriteOffsetTool = F2(
	function (model, selections) {
		var toolName = 'Rewrite as Offset';
		var _p128 = function () {
			var _p129 = selections;
			_v63_3:
			do {
				if (_p129.ctor === '_Tuple7') {
					if (_p129._0.ctor === '[]') {
						if ((((((_p129._1.ctor === '[]') && (_p129._3.ctor === '[]')) && (_p129._2.ctor === '[]')) && (_p129._4.ctor === '[]')) && (_p129._5.ctor === '[]')) && (_p129._6.ctor === '[]')) {
							return {ctor: '_Tuple3', _0: toolName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Possible};
						} else {
							return {ctor: '_Tuple3', _0: toolName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Impossible};
						}
					} else {
						if ((((((_p129._1.ctor === '[]') && (_p129._3.ctor === '::')) && (_p129._3._1.ctor === '[]')) && (_p129._4.ctor === '[]')) && (_p129._5.ctor === '[]')) && (_p129._6.ctor === '[]')) {
							var _p132 = _p129._3._0;
							var _p131 = _p129._0;
							var _p130 = A2(
								_user$project$Lang$findExpByEId,
								model.inputExp,
								_user$project$Lang$pathedPatIdToScopeEId(_p132));
							if (_p130.ctor === 'Just') {
								return (_user$project$Lang$isLet(_p130._0) && _elm_lang$core$Native_Utils.eq(
									_elm_lang$core$List$length(_p131),
									_elm_lang$core$List$length(_p129._2))) ? {
									ctor: '_Tuple3',
									_0: A2(_user$project$Utils$perhapsPluralizeList, toolName, _p131),
									_1: A3(_user$project$CodeMotion$rewriteOffsetTransformation, model, _p132, _p131),
									_2: _user$project$InterfaceModel$Satisfied
								} : {ctor: '_Tuple3', _0: toolName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Impossible};
							} else {
								return {ctor: '_Tuple3', _0: toolName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Impossible};
							}
						} else {
							break _v63_3;
						}
					}
				} else {
					break _v63_3;
				}
			} while(false);
			return {ctor: '_Tuple3', _0: toolName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Impossible};
		}();
		var name = _p128._0;
		var func = _p128._1;
		var predVal = _p128._2;
		return {
			name: name,
			func: func,
			reqs: {
				ctor: '::',
				_0: {description: 'Select one variable and one or more numbers', value: predVal},
				_1: {ctor: '[]'}
			},
			id: 'rewriteOffset'
		};
	});
var _user$project$DeuceTools$rangeAround = function (n) {
	var i = n - (3 * n);
	var j = n + (3 * n);
	return {ctor: '_Tuple2', _0: i, _1: j};
};
var _user$project$DeuceTools$duplicateDefinitionTool = F2(
	function (model, selections) {
		var eidIsLet = function (eid) {
			return _elm_lang$core$Native_Utils.eq(
				A2(
					_elm_lang$core$Maybe$map,
					_user$project$Lang$isLet,
					A2(_user$project$Lang$findExpByEId, model.inputExp, eid)),
				_elm_lang$core$Maybe$Just(true));
		};
		var toolName = 'Duplicate Definition';
		var _p133 = function () {
			var _p134 = selections;
			_v65_4:
			do {
				_v65_1:
				do {
					if (_p134.ctor === '_Tuple7') {
						if ((((_p134._0.ctor === '[]') && (_p134._1.ctor === '[]')) && (_p134._2.ctor === '[]')) && (_p134._4.ctor === '[]')) {
							if (_p134._5.ctor === '::') {
								if (_p134._3.ctor === '[]') {
									break _v65_1;
								} else {
									if ((((_p134._5._0.ctor === '_Tuple2') && (_p134._5._0._0.ctor === 'Before')) && (_p134._5._1.ctor === '[]')) && (_p134._6.ctor === '[]')) {
										var _p138 = _p134._3;
										var allAreLets = A2(
											_elm_lang$core$List$all,
											function (_p135) {
												return eidIsLet(
													_user$project$Lang$pathedPatIdToScopeEId(_p135));
											},
											_p138);
										return allAreLets ? {
											ctor: '_Tuple3',
											_0: A2(_user$project$Utils$perhapsPluralizeList, toolName, _p138),
											_1: _elm_lang$core$Maybe$Just(
												function (_p136) {
													var _p137 = _p136;
													return A3(_user$project$CodeMotion$duplicateDefinitionsBeforeEId, _p138, _p134._5._0._1, model.inputExp);
												}),
											_2: _user$project$InterfaceModel$Satisfied
										} : {ctor: '_Tuple3', _0: toolName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Impossible};
									} else {
										break _v65_4;
									}
								}
							} else {
								if (_p134._3.ctor === '[]') {
									if (_p134._6.ctor === '[]') {
										return {ctor: '_Tuple3', _0: toolName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Possible};
									} else {
										break _v65_1;
									}
								} else {
									if ((_p134._6.ctor === '::') && (_p134._6._1.ctor === '[]')) {
										var _p142 = _p134._3;
										var targetPathedPatId = _user$project$Lang$patTargetPositionToTargetPathedPatId(_p134._6._0);
										var allAreLets = A2(
											_elm_lang$core$List$all,
											function (_p139) {
												return eidIsLet(
													_user$project$Lang$pathedPatIdToScopeEId(_p139));
											},
											_p142) && eidIsLet(
											_user$project$Lang$pathedPatIdToScopeEId(targetPathedPatId));
										return allAreLets ? {
											ctor: '_Tuple3',
											_0: A2(_user$project$Utils$perhapsPluralizeList, toolName, _p142),
											_1: _elm_lang$core$Maybe$Just(
												function (_p140) {
													var _p141 = _p140;
													return A3(_user$project$CodeMotion$duplicateDefinitionsPat, _p142, targetPathedPatId, model.inputExp);
												}),
											_2: _user$project$InterfaceModel$Satisfied
										} : {ctor: '_Tuple3', _0: toolName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Impossible};
									} else {
										break _v65_4;
									}
								}
							}
						} else {
							if (_p134._3.ctor === '[]') {
								break _v65_1;
							} else {
								break _v65_4;
							}
						}
					} else {
						break _v65_4;
					}
				} while(false);
				return {ctor: '_Tuple3', _0: toolName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Impossible};
			} while(false);
			return {ctor: '_Tuple3', _0: toolName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Impossible};
		}();
		var name = _p133._0;
		var func = _p133._1;
		var predVal = _p133._2;
		return {
			name: toolName,
			func: func,
			reqs: {
				ctor: '::',
				_0: {description: 'Select one or more patterns and one target position (i.e. whitespace)', value: predVal},
				_1: {ctor: '[]'}
			},
			id: 'duplicateDefinition'
		};
	});
var _user$project$DeuceTools$moveDefinitionTool = F2(
	function (model, selections) {
		var toolName = 'Move Definition';
		var _p143 = function () {
			var _p144 = selections;
			_v68_9:
			do {
				if ((((_p144.ctor === '_Tuple7') && (_p144._0.ctor === '[]')) && (_p144._1.ctor === '[]')) && (_p144._2.ctor === '[]')) {
					if (_p144._3.ctor === '::') {
						if (_p144._4.ctor === '[]') {
							if (_p144._5.ctor === '::') {
								if ((((_p144._5._0.ctor === '_Tuple2') && (_p144._5._0._0.ctor === 'Before')) && (_p144._5._1.ctor === '[]')) && (_p144._6.ctor === '[]')) {
									var pathedPatIds = {ctor: '::', _0: _p144._3._0, _1: _p144._3._1};
									return {
										ctor: '_Tuple3',
										_0: A2(_user$project$Utils$perhapsPluralizeList, toolName, pathedPatIds),
										_1: _elm_lang$core$Maybe$Just(
											function (_p145) {
												var _p146 = _p145;
												return A3(_user$project$CodeMotion$moveDefinitionsBeforeEId, pathedPatIds, _p144._5._0._1, model.inputExp);
											}),
										_2: _user$project$InterfaceModel$Satisfied
									};
								} else {
									break _v68_9;
								}
							} else {
								if (_p144._6.ctor === '[]') {
									return {ctor: '_Tuple3', _0: toolName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Possible};
								} else {
									if (_p144._6._1.ctor === '[]') {
										var pathedPatIds = {ctor: '::', _0: _p144._3._0, _1: _p144._3._1};
										var targetPathedPatId = _user$project$Lang$patTargetPositionToTargetPathedPatId(_p144._6._0);
										var _p148 = A2(
											_elm_lang$core$Maybe$map,
											function (_p147) {
												return function (_) {
													return _.e__;
												}(
													function (_) {
														return _.val;
													}(_p147));
											},
											A2(
												_user$project$Lang$findExpByEId,
												model.inputExp,
												_user$project$Lang$pathedPatIdToScopeEId(targetPathedPatId)));
										if ((_p148.ctor === 'Just') && (_p148._0.ctor === 'ELet')) {
											return {
												ctor: '_Tuple3',
												_0: A2(_user$project$Utils$perhapsPluralizeList, toolName, pathedPatIds),
												_1: _elm_lang$core$Maybe$Just(
													function (_p149) {
														var _p150 = _p149;
														return A3(_user$project$CodeMotion$moveDefinitionsPat, pathedPatIds, targetPathedPatId, model.inputExp);
													}),
												_2: _user$project$InterfaceModel$Satisfied
											};
										} else {
											return {ctor: '_Tuple3', _0: toolName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Impossible};
										}
									} else {
										break _v68_9;
									}
								}
							}
						} else {
							break _v68_9;
						}
					} else {
						if (_p144._5.ctor === '[]') {
							if (_p144._4.ctor === '::') {
								if (_p144._6.ctor === '[]') {
									return {ctor: '_Tuple3', _0: toolName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Possible};
								} else {
									break _v68_9;
								}
							} else {
								if (_p144._6.ctor === '[]') {
									return {ctor: '_Tuple3', _0: toolName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Possible};
								} else {
									if (_p144._6._1.ctor === '[]') {
										return {ctor: '_Tuple3', _0: toolName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Possible};
									} else {
										break _v68_9;
									}
								}
							}
						} else {
							if ((_p144._5._1.ctor === '[]') && (_p144._6.ctor === '[]')) {
								if (_p144._4.ctor === '[]') {
									return {ctor: '_Tuple3', _0: toolName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Possible};
								} else {
									if ((_p144._5._0.ctor === '_Tuple2') && (_p144._5._0._0.ctor === 'Before')) {
										if (_p144._4._1.ctor === '[]') {
											return {
												ctor: '_Tuple3',
												_0: toolName,
												_1: _elm_lang$core$Maybe$Just(
													function (_p151) {
														var _p152 = _p151;
														return A3(
															_user$project$CodeMotion$moveDefinitionsBeforeEId,
															{
																ctor: '::',
																_0: {
																	ctor: '_Tuple2',
																	_0: {ctor: '_Tuple2', _0: _p144._4._0, _1: 1},
																	_1: {ctor: '[]'}
																},
																_1: {ctor: '[]'}
															},
															_p144._5._0._1,
															model.inputExp);
													}),
												_2: _user$project$InterfaceModel$Satisfied
											};
										} else {
											var _p155 = _p144._4;
											return {
												ctor: '_Tuple3',
												_0: A2(_user$project$Utils$perhapsPluralizeList, toolName, _p155),
												_1: _elm_lang$core$Maybe$Just(
													function (_p153) {
														var _p154 = _p153;
														return A3(_user$project$CodeMotion$moveEquationsBeforeEId, _p155, _p144._5._0._1, model.inputExp);
													}),
												_2: _user$project$InterfaceModel$Satisfied
											};
										}
									} else {
										break _v68_9;
									}
								}
							} else {
								break _v68_9;
							}
						}
					}
				} else {
					break _v68_9;
				}
			} while(false);
			return {ctor: '_Tuple3', _0: toolName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Impossible};
		}();
		var name = _p143._0;
		var func = _p143._1;
		var predVal = _p143._2;
		return {
			name: toolName,
			func: func,
			reqs: {
				ctor: '::',
				_0: {description: 'Select one or more variable definitions and one target position (i.e. whitespace)', value: predVal},
				_1: {ctor: '[]'}
			},
			id: 'moveDefinition'
		};
	});
var _user$project$DeuceTools$copyExpressionTool = F2(
	function (model, selections) {
		var _p156 = function () {
			var _p157 = selections;
			_v74_5:
			do {
				if (_p157.ctor === '_Tuple7') {
					if (_p157._3.ctor === '::') {
						return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
					} else {
						if (_p157._4.ctor === '::') {
							return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
						} else {
							if ((_p157._5.ctor === '[]') && (_p157._6.ctor === '[]')) {
								if (_p157._2.ctor === '[]') {
									return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Possible};
								} else {
									if (_p157._2._1.ctor === '[]') {
										return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Possible};
									} else {
										return {
											ctor: '_Tuple2',
											_0: A2(_user$project$CodeMotion$copyExpressionTransformation, model.inputExp, _p157._2),
											_1: _user$project$InterfaceModel$Satisfied
										};
									}
								}
							} else {
								break _v74_5;
							}
						}
					}
				} else {
					break _v74_5;
				}
			} while(false);
			return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
		}();
		var func = _p156._0;
		var predVal = _p156._1;
		return {
			name: 'Make Equal by Copying',
			func: func,
			reqs: {
				ctor: '::',
				_0: {description: 'Select two or more expressions.', value: predVal},
				_1: {ctor: '[]'}
			},
			id: 'copyExpression'
		};
	});
var _user$project$DeuceTools$introduceVariableTool = F2(
	function (model, selections) {
		var toolName = 'Introduce Local Variable';
		var _p158 = function () {
			var _p159 = selections;
			_v75_5:
			do {
				_v75_1:
				do {
					if (_p159.ctor === '_Tuple7') {
						if ((_p159._3.ctor === '[]') && (_p159._4.ctor === '[]')) {
							if (_p159._5.ctor === '[]') {
								if (_p159._6.ctor === '[]') {
									if (_p159._2.ctor === '[]') {
										if ((_p159._0.ctor === '[]') && (_p159._1.ctor === '[]')) {
											return {ctor: '_Tuple3', _0: toolName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Possible};
										} else {
											break _v75_1;
										}
									} else {
										var _p160 = _p159._2;
										return {
											ctor: '_Tuple3',
											_0: A2(_user$project$Utils$perhapsPluralizeList, 'Introduce Variable', _p160),
											_1: A3(_user$project$CodeMotion$introduceVarTransformation, model, _p160, _elm_lang$core$Maybe$Nothing),
											_2: _user$project$InterfaceModel$Satisfied
										};
									}
								} else {
									if (_p159._2.ctor === '[]') {
										break _v75_1;
									} else {
										if (_p159._6._1.ctor === '[]') {
											var _p161 = _p159._2;
											return {
												ctor: '_Tuple3',
												_0: A2(_user$project$Utils$perhapsPluralizeList, 'Introduce Variable', _p161),
												_1: A3(
													_user$project$CodeMotion$introduceVarTransformation,
													model,
													_p161,
													_elm_lang$core$Maybe$Just(
														_user$project$Lang$PatTargetPosition(_p159._6._0))),
												_2: _user$project$InterfaceModel$Satisfied
											};
										} else {
											break _v75_5;
										}
									}
								}
							} else {
								if (_p159._2.ctor === '[]') {
									break _v75_1;
								} else {
									if ((_p159._5._1.ctor === '[]') && (_p159._6.ctor === '[]')) {
										var _p162 = _p159._2;
										return {
											ctor: '_Tuple3',
											_0: A2(_user$project$Utils$perhapsPluralizeList, 'Introduce Variable', _p162),
											_1: A3(
												_user$project$CodeMotion$introduceVarTransformation,
												model,
												_p162,
												_elm_lang$core$Maybe$Just(
													_user$project$Lang$ExpTargetPosition(_p159._5._0))),
											_2: _user$project$InterfaceModel$Satisfied
										};
									} else {
										break _v75_5;
									}
								}
							}
						} else {
							if (_p159._2.ctor === '[]') {
								break _v75_1;
							} else {
								break _v75_5;
							}
						}
					} else {
						break _v75_5;
					}
				} while(false);
				return {ctor: '_Tuple3', _0: toolName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Impossible};
			} while(false);
			return {ctor: '_Tuple3', _0: toolName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Impossible};
		}();
		var name = _p158._0;
		var func = _p158._1;
		var predVal = _p158._2;
		return {
			name: name,
			func: func,
			reqs: {
				ctor: '::',
				_0: {description: 'Select one or more constants and, optionally, one target position (i.e. whitespace)', value: predVal},
				_1: {ctor: '[]'}
			},
			id: 'introduceVariable'
		};
	});
var _user$project$DeuceTools$inlineDefinitionTool = F2(
	function (model, selections) {
		var toolName = 'Inline Definition';
		var _p163 = function () {
			var _p164 = selections;
			_v76_4:
			do {
				_v76_1:
				do {
					if (_p164.ctor === '_Tuple7') {
						if (((_p164._0.ctor === '[]') && (_p164._1.ctor === '[]')) && (_p164._2.ctor === '[]')) {
							if (_p164._3.ctor === '[]') {
								if (_p164._4.ctor === '[]') {
									if ((_p164._5.ctor === '[]') && (_p164._6.ctor === '[]')) {
										return {ctor: '_Tuple3', _0: toolName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Possible};
									} else {
										break _v76_1;
									}
								} else {
									if ((_p164._5.ctor === '[]') && (_p164._6.ctor === '[]')) {
										var _p170 = _p164._4;
										return {
											ctor: '_Tuple3',
											_0: A2(_user$project$Utils$perhapsPluralizeList, toolName, _p170),
											_1: _elm_lang$core$Maybe$Just(
												function (_p168) {
													var _p169 = _p168;
													return A2(
														_user$project$CodeMotion$inlineDefinitions,
														A2(
															_elm_lang$core$List$map,
															function (letEId) {
																return {
																	ctor: '_Tuple2',
																	_0: {ctor: '_Tuple2', _0: letEId, _1: 1},
																	_1: {ctor: '[]'}
																};
															},
															_p170),
														model.inputExp);
												}),
											_2: _user$project$InterfaceModel$Satisfied
										};
									} else {
										break _v76_4;
									}
								}
							} else {
								if (((_p164._4.ctor === '[]') && (_p164._5.ctor === '[]')) && (_p164._6.ctor === '[]')) {
									var _p167 = _p164._3;
									return {
										ctor: '_Tuple3',
										_0: A2(_user$project$Utils$perhapsPluralizeList, toolName, _p167),
										_1: _elm_lang$core$Maybe$Just(
											function (_p165) {
												var _p166 = _p165;
												return A2(_user$project$CodeMotion$inlineDefinitions, _p167, model.inputExp);
											}),
										_2: _user$project$InterfaceModel$Satisfied
									};
								} else {
									break _v76_4;
								}
							}
						} else {
							if ((_p164._3.ctor === '[]') && (_p164._4.ctor === '[]')) {
								break _v76_1;
							} else {
								break _v76_4;
							}
						}
					} else {
						break _v76_4;
					}
				} while(false);
				return {ctor: '_Tuple3', _0: toolName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Impossible};
			} while(false);
			return {ctor: '_Tuple3', _0: toolName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Impossible};
		}();
		var name = _p163._0;
		var func = _p163._1;
		var predVal = _p163._2;
		return {
			name: name,
			func: func,
			reqs: {
				ctor: '::',
				_0: {description: 'Select one or more variable definitions', value: predVal},
				_1: {ctor: '[]'}
			},
			id: 'inlineDefinition'
		};
	});
var _user$project$DeuceTools$swapDefinitionsTool = F2(
	function (model, selections) {
		var ppidIsInLet = function (ppid) {
			var _p171 = A2(_user$project$LangTools$findScopeExpAndPatByPathedPatternId, ppid, model.inputExp);
			if (_p171.ctor === 'Just') {
				return _user$project$Lang$isLet(_p171._0._0);
			} else {
				return false;
			}
		};
		var letEIdToTopPId = function (letEId) {
			return function (_) {
				return _.pid;
			}(
				function (_) {
					return _.val;
				}(
					_user$project$LangTools$expToLetPat(
						A2(_user$project$LangTools$justFindExpByEId, model.inputExp, letEId))));
		};
		var _p172 = function () {
			var _p173 = selections;
			_v80_5:
			do {
				if ((_p173.ctor === '_Tuple7') && (_p173._2.ctor === '[]')) {
					if (_p173._3.ctor === '::') {
						if (_p173._3._1.ctor === '[]') {
							if (((_p173._4.ctor === '[]') && (_p173._5.ctor === '[]')) && (_p173._6.ctor === '[]')) {
								return ppidIsInLet(_p173._3._0) ? {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Possible} : {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
							} else {
								break _v80_5;
							}
						} else {
							if ((((_p173._3._1._1.ctor === '[]') && (_p173._4.ctor === '[]')) && (_p173._5.ctor === '[]')) && (_p173._6.ctor === '[]')) {
								return {
									ctor: '_Tuple2',
									_0: A3(
										_user$project$CodeMotion$swapDefinitionsTransformation,
										model.inputExp,
										A2(
											_user$project$Utils$fromJust_,
											'CodeMotion.swapDefinitionsTool',
											A2(_user$project$LangTools$pathedPatternIdToPId, _p173._3._0, model.inputExp)),
										A2(
											_user$project$Utils$fromJust_,
											'CodeMotion.swapDefinitionsTool',
											A2(_user$project$LangTools$pathedPatternIdToPId, _p173._3._1._0, model.inputExp))),
									_1: _user$project$InterfaceModel$Satisfied
								};
							} else {
								break _v80_5;
							}
						}
					} else {
						if (_p173._4.ctor === '[]') {
							if ((_p173._5.ctor === '[]') && (_p173._6.ctor === '[]')) {
								return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Possible};
							} else {
								break _v80_5;
							}
						} else {
							if (_p173._4._1.ctor === '[]') {
								if ((_p173._5.ctor === '[]') && (_p173._6.ctor === '[]')) {
									return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Possible};
								} else {
									break _v80_5;
								}
							} else {
								if (((_p173._4._1._1.ctor === '[]') && (_p173._5.ctor === '[]')) && (_p173._6.ctor === '[]')) {
									return {
										ctor: '_Tuple2',
										_0: A3(
											_user$project$CodeMotion$swapDefinitionsTransformation,
											model.inputExp,
											letEIdToTopPId(_p173._4._0),
											letEIdToTopPId(_p173._4._1._0)),
										_1: _user$project$InterfaceModel$Satisfied
									};
								} else {
									break _v80_5;
								}
							}
						}
					}
				} else {
					break _v80_5;
				}
			} while(false);
			return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
		}();
		var func = _p172._0;
		var predVal = _p172._1;
		return {
			name: 'Swap Definitions',
			func: func,
			reqs: {
				ctor: '::',
				_0: {description: 'Select two variable definitions.', value: predVal},
				_1: {ctor: '[]'}
			},
			id: 'swapDefinitions'
		};
	});
var _user$project$DeuceTools$swapExpressionsTool = F2(
	function (model, selections) {
		var _p174 = function () {
			var _p175 = selections;
			_v81_5:
			do {
				_v81_2:
				do {
					_v81_1:
					do {
						if (_p175.ctor === '_Tuple7') {
							if (_p175._2.ctor === '[]') {
								if (_p175._3.ctor === '[]') {
									if (_p175._4.ctor === '[]') {
										if ((_p175._5.ctor === '[]') && (_p175._6.ctor === '[]')) {
											return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Possible};
										} else {
											break _v81_5;
										}
									} else {
										break _v81_2;
									}
								} else {
									break _v81_1;
								}
							} else {
								if (_p175._3.ctor === '::') {
									break _v81_1;
								} else {
									if (_p175._4.ctor === '::') {
										break _v81_2;
									} else {
										if (_p175._2._1.ctor === '[]') {
											if ((_p175._5.ctor === '[]') && (_p175._6.ctor === '[]')) {
												return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Possible};
											} else {
												break _v81_5;
											}
										} else {
											if (((_p175._2._1._1.ctor === '[]') && (_p175._5.ctor === '[]')) && (_p175._6.ctor === '[]')) {
												return {
													ctor: '_Tuple2',
													_0: A3(_user$project$CodeMotion$swapExpressionsTransformation, model.inputExp, _p175._2._0, _p175._2._1._0),
													_1: _user$project$InterfaceModel$Satisfied
												};
											} else {
												break _v81_5;
											}
										}
									}
								}
							}
						} else {
							break _v81_5;
						}
					} while(false);
					return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
				} while(false);
				return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
			} while(false);
			return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
		}();
		var func = _p174._0;
		var predVal = _p174._1;
		return {
			name: 'Swap Expressions',
			func: func,
			reqs: {
				ctor: '::',
				_0: {description: 'Select two expressions.', value: predVal},
				_1: {ctor: '[]'}
			},
			id: 'swapExpressions'
		};
	});
var _user$project$DeuceTools$selectTwoVars = F5(
	function (toolName, toolId, makeThunk, model, selections) {
		var _p176 = function () {
			var _p177 = selections;
			_v82_3:
			do {
				if ((((_p177.ctor === '_Tuple7') && (_p177._0.ctor === '[]')) && (_p177._1.ctor === '[]')) && (_p177._2.ctor === '[]')) {
					if (_p177._3.ctor === '[]') {
						if (((_p177._4.ctor === '[]') && (_p177._5.ctor === '[]')) && (_p177._6.ctor === '[]')) {
							return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Possible};
						} else {
							break _v82_3;
						}
					} else {
						if (_p177._3._1.ctor === '[]') {
							if (((_p177._4.ctor === '[]') && (_p177._5.ctor === '[]')) && (_p177._6.ctor === '[]')) {
								return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Possible};
							} else {
								break _v82_3;
							}
						} else {
							if ((((_p177._3._1._1.ctor === '[]') && (_p177._4.ctor === '[]')) && (_p177._5.ctor === '[]')) && (_p177._6.ctor === '[]')) {
								var _p180 = _p177._3._1._0;
								var _p179 = _p177._3._0;
								var maybeNames = A2(
									_elm_lang$core$List$map,
									_elm_lang$core$Maybe$andThen(_user$project$LangTools$patToMaybeIdent),
									A2(
										_elm_lang$core$List$map,
										function (ppid) {
											return A2(_user$project$LangTools$findPatByPathedPatternId, ppid, model.inputExp);
										},
										{
											ctor: '::',
											_0: _p179,
											_1: {
												ctor: '::',
												_0: _p180,
												_1: {ctor: '[]'}
											}
										}));
								var _p178 = maybeNames;
								if (((((_p178.ctor === '::') && (_p178._0.ctor === 'Just')) && (_p178._1.ctor === '::')) && (_p178._1._0.ctor === 'Just')) && (_p178._1._1.ctor === '[]')) {
									return {
										ctor: '_Tuple2',
										_0: _elm_lang$core$Maybe$Just(
											A2(
												makeThunk,
												{ctor: '_Tuple2', _0: _p179, _1: _p178._0._0},
												{ctor: '_Tuple2', _0: _p180, _1: _p178._1._0._0})),
										_1: _user$project$InterfaceModel$FullySatisfied
									};
								} else {
									return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
								}
							} else {
								break _v82_3;
							}
						}
					}
				} else {
					break _v82_3;
				}
			} while(false);
			return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
		}();
		var func = _p176._0;
		var predVal = _p176._1;
		return {
			name: toolName,
			func: func,
			reqs: {
				ctor: '::',
				_0: {description: 'Select two variables', value: predVal},
				_1: {ctor: '[]'}
			},
			id: toolId
		};
	});
var _user$project$DeuceTools$swapUsagesTool = F2(
	function (model, selections) {
		var makeThunk = F3(
			function (_p183, _p182, _p181) {
				var _p184 = _p183;
				var _p185 = _p182;
				var _p186 = _p181;
				return A3(_user$project$CodeMotion$swapUsages, _p184._0, _p185._0, model.inputExp);
			});
		return A5(_user$project$DeuceTools$selectTwoVars, 'Swap Variable Usages', 'swapUsages', makeThunk, model, selections);
	});
var _user$project$DeuceTools$swapNamesAndUsagesTool = F2(
	function (model, selections) {
		var makeThunk = F3(
			function (_p189, _p188, _p187) {
				var _p190 = _p189;
				var _p195 = _p190._0;
				var _p194 = _p190._1;
				var _p191 = _p188;
				var _p193 = _p191._1;
				var _p192 = _p187;
				return A3(
					_user$project$CodeMotion$composeTransformations,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'Swap names ',
						A2(
							_elm_lang$core$Basics_ops['++'],
							_p194,
							A2(_elm_lang$core$Basics_ops['++'], ' and ', _p193))),
					{
						ctor: '::',
						_0: A2(_user$project$CodeMotion$renamePat, _p195, 'IMPROBABLE_TEMPORARY_NAME_FOR_SAFETY_CHECK!!!'),
						_1: {
							ctor: '::',
							_0: A2(_user$project$CodeMotion$renamePat, _p191._0, _p194),
							_1: {
								ctor: '::',
								_0: A2(_user$project$CodeMotion$renamePat, _p195, _p193),
								_1: {ctor: '[]'}
							}
						}
					},
					model.inputExp);
			});
		return A5(_user$project$DeuceTools$selectTwoVars, 'Swap Variable Names and Usages', 'swapNamesAndUsages', makeThunk, model, selections);
	});
var _user$project$DeuceTools$renameVariableTool = F2(
	function (model, selections) {
		var nameMaker = function (s) {
			return A2(
				_elm_lang$core$Basics_ops['++'],
				'Rename \'',
				A2(_elm_lang$core$Basics_ops['++'], s, '\''));
		};
		var disabledName = 'Rename Variable';
		var _p196 = function () {
			var _p197 = selections;
			_v90_3:
			do {
				if (((_p197.ctor === '_Tuple7') && (_p197._0.ctor === '[]')) && (_p197._1.ctor === '[]')) {
					if (_p197._2.ctor === '::') {
						if (((((_p197._2._1.ctor === '[]') && (_p197._3.ctor === '[]')) && (_p197._4.ctor === '[]')) && (_p197._5.ctor === '[]')) && (_p197._6.ctor === '[]')) {
							var _p206 = _p197._2._0;
							var _p202 = A2(_user$project$Lang$findExpByEId, model.inputExp, _p206);
							if (_p202.ctor === 'Just') {
								var _p203 = _p202._0.val.e__;
								if (_p203.ctor === 'EVar') {
									var newName = model.deuceState.renameVarTextBox;
									return {
										ctor: '_Tuple3',
										_0: nameMaker(_p203._1),
										_1: _elm_lang$core$Maybe$Just(
											function (_p204) {
												var _p205 = _p204;
												return A3(_user$project$CodeMotion$renameVar, _p206, newName, model.inputExp);
											}),
										_2: _user$project$InterfaceModel$FullySatisfied
									};
								} else {
									return {ctor: '_Tuple3', _0: disabledName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Impossible};
								}
							} else {
								return {ctor: '_Tuple3', _0: disabledName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Impossible};
							}
						} else {
							break _v90_3;
						}
					} else {
						if (_p197._3.ctor === '::') {
							if ((((_p197._3._1.ctor === '[]') && (_p197._4.ctor === '[]')) && (_p197._5.ctor === '[]')) && (_p197._6.ctor === '[]')) {
								var _p201 = _p197._3._0;
								var _p198 = A2(
									_elm_lang$core$Maybe$andThen,
									_user$project$LangTools$patToMaybeIdent,
									A2(_user$project$LangTools$findPatByPathedPatternId, _p201, model.inputExp));
								if (_p198.ctor === 'Just') {
									var newName = model.deuceState.renameVarTextBox;
									return {
										ctor: '_Tuple3',
										_0: nameMaker(_p198._0),
										_1: _elm_lang$core$Maybe$Just(
											function (_p199) {
												var _p200 = _p199;
												return A3(_user$project$CodeMotion$renamePat, _p201, newName, model.inputExp);
											}),
										_2: _user$project$InterfaceModel$FullySatisfied
									};
								} else {
									return {ctor: '_Tuple3', _0: disabledName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Impossible};
								}
							} else {
								break _v90_3;
							}
						} else {
							if (((_p197._4.ctor === '[]') && (_p197._5.ctor === '[]')) && (_p197._6.ctor === '[]')) {
								return {ctor: '_Tuple3', _0: disabledName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Possible};
							} else {
								break _v90_3;
							}
						}
					}
				} else {
					break _v90_3;
				}
			} while(false);
			return {ctor: '_Tuple3', _0: disabledName, _1: _elm_lang$core$Maybe$Nothing, _2: _user$project$InterfaceModel$Impossible};
		}();
		var name = _p196._0;
		var func = _p196._1;
		var predVal = _p196._2;
		return {
			name: name,
			func: func,
			reqs: {
				ctor: '::',
				_0: {description: 'Select a variable definition or use', value: predVal},
				_1: {ctor: '[]'}
			},
			id: 'renameVariable'
		};
	});
var _user$project$DeuceTools$flipBooleanTool = F2(
	function (model, selections) {
		var _p207 = function () {
			var _p208 = selections;
			_v96_2:
			do {
				if ((_p208.ctor === '_Tuple7') && (_p208._0.ctor === '[]')) {
					if (_p208._1.ctor === '::') {
						if (((((((_p208._1._1.ctor === '[]') && (_p208._2.ctor === '::')) && (_p208._2._1.ctor === '[]')) && (_p208._3.ctor === '[]')) && (_p208._4.ctor === '[]')) && (_p208._5.ctor === '[]')) && (_p208._6.ctor === '[]')) {
							var _p213 = _p208._2._0;
							var _p209 = A2(_user$project$Lang$findExpByEId, model.inputExp, _p213);
							if (_p209.ctor === 'Just') {
								var _p210 = _p209._0.val.e__;
								if ((_p210.ctor === 'EBase') && (_p210._1.ctor === 'EBool')) {
									var flipped = _user$project$Lang$withDummyExpInfo(
										A2(
											_user$project$Lang$EBase,
											_p210._0,
											_user$project$Lang$EBool(!_p210._1._0)));
									var newExp = A3(_user$project$Lang$replaceExpNode, _p213, flipped, model.inputExp);
									return {
										ctor: '_Tuple2',
										_0: _elm_lang$core$Maybe$Just(
											function (_p211) {
												var _p212 = _p211;
												return _user$project$InterfaceModel$oneSafeResult(newExp);
											}),
										_1: _user$project$InterfaceModel$FullySatisfied
									};
								} else {
									return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
								}
							} else {
								return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
							}
						} else {
							break _v96_2;
						}
					} else {
						if (((((_p208._2.ctor === '[]') && (_p208._3.ctor === '[]')) && (_p208._4.ctor === '[]')) && (_p208._5.ctor === '[]')) && (_p208._6.ctor === '[]')) {
							return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Possible};
						} else {
							break _v96_2;
						}
					}
				} else {
					break _v96_2;
				}
			} while(false);
			return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
		}();
		var func = _p207._0;
		var boolPredVal = _p207._1;
		return {
			name: 'Flip Boolean',
			func: func,
			reqs: {
				ctor: '::',
				_0: {description: 'Select a boolean value', value: boolPredVal},
				_1: {ctor: '[]'}
			},
			id: 'flipBoolean'
		};
	});
var _user$project$DeuceTools$makeEqualTool = F2(
	function (model, selections) {
		var _p214 = function () {
			var _p215 = selections;
			_v100_7:
			do {
				_v100_3:
				do {
					_v100_0:
					do {
						if (_p215.ctor === '_Tuple7') {
							if (_p215._3.ctor === '::') {
								return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
							} else {
								if (_p215._4.ctor === '::') {
									return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
								} else {
									if (_p215._5.ctor === '[]') {
										if (_p215._2.ctor === '[]') {
											break _v100_0;
										} else {
											if (_p215._6.ctor === '[]') {
												if (_p215._2._1.ctor === '[]') {
													break _v100_3;
												} else {
													return {
														ctor: '_Tuple2',
														_0: A3(_user$project$CodeMotion$makeEqualTransformation, model.inputExp, _p215._2, _elm_lang$core$Maybe$Nothing),
														_1: _user$project$InterfaceModel$Satisfied
													};
												}
											} else {
												if (_p215._2._1.ctor === '[]') {
													break _v100_3;
												} else {
													if (_p215._6._1.ctor === '[]') {
														return {
															ctor: '_Tuple2',
															_0: A3(
																_user$project$CodeMotion$makeEqualTransformation,
																model.inputExp,
																_p215._2,
																_elm_lang$core$Maybe$Just(
																	_user$project$Lang$PatTargetPosition(_p215._6._0))),
															_1: _user$project$InterfaceModel$Satisfied
														};
													} else {
														break _v100_7;
													}
												}
											}
										}
									} else {
										if (_p215._2.ctor === '[]') {
											break _v100_0;
										} else {
											if (_p215._2._1.ctor === '[]') {
												break _v100_3;
											} else {
												if ((_p215._5._1.ctor === '[]') && (_p215._6.ctor === '[]')) {
													return {
														ctor: '_Tuple2',
														_0: A3(
															_user$project$CodeMotion$makeEqualTransformation,
															model.inputExp,
															_p215._2,
															_elm_lang$core$Maybe$Just(
																_user$project$Lang$ExpTargetPosition(_p215._5._0))),
														_1: _user$project$InterfaceModel$Satisfied
													};
												} else {
													break _v100_7;
												}
											}
										}
									}
								}
							}
						} else {
							break _v100_7;
						}
					} while(false);
					return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Possible};
				} while(false);
				return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Possible};
			} while(false);
			return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
		}();
		var func = _p214._0;
		var expsPredVal = _p214._1;
		return {
			name: 'Make Equal with Single Variable',
			func: func,
			reqs: {
				ctor: '::',
				_0: {description: 'Select two or more expressions and, optionally, a target position (i.e. whitespace).', value: expsPredVal},
				_1: {ctor: '[]'}
			},
			id: 'makeEqual'
		};
	});
var _user$project$DeuceTools$oneOrMoreNumsOnly = function (selections) {
	var _p216 = selections;
	if ((((((_p216.ctor === '_Tuple7') && (_p216._1.ctor === '[]')) && (_p216._3.ctor === '[]')) && (_p216._4.ctor === '[]')) && (_p216._5.ctor === '[]')) && (_p216._6.ctor === '[]')) {
		var _p217 = _p216._0;
		return (_elm_lang$core$Native_Utils.cmp(
			_elm_lang$core$List$length(_p217),
			1) > -1) && _elm_lang$core$Native_Utils.eq(
			_elm_lang$core$List$length(_p217),
			_elm_lang$core$List$length(_p216._2));
	} else {
		return false;
	}
};
var _user$project$DeuceTools$thawFreezeTool = F2(
	function (model, selections) {
		var _p218 = selections;
		var nums = _p218._0;
		var _p219 = function () {
			var freezeAnnotations = A2(
				_elm_lang$core$List$map,
				function (_p220) {
					var _p221 = _p220;
					return _p221._1._2._1;
				},
				nums);
			if (_elm_lang$core$Native_Utils.eq(
				selections,
				{
					ctor: '_Tuple7',
					_0: {ctor: '[]'},
					_1: {ctor: '[]'},
					_2: {ctor: '[]'},
					_3: {ctor: '[]'},
					_4: {ctor: '[]'},
					_5: {ctor: '[]'},
					_6: {ctor: '[]'}
				})) {
				return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Possible};
			} else {
				if (!_user$project$DeuceTools$oneOrMoreNumsOnly(selections)) {
					return {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _user$project$InterfaceModel$Impossible};
				} else {
					var mode_ = function () {
						var _p222 = _user$project$Utils$dedupByEquality(freezeAnnotations);
						if ((_p222.ctor === '::') && (_p222._1.ctor === '[]')) {
							var _p223 = _p222._0;
							return model.syncOptions.thawedByDefault ? (_elm_lang$core$Native_Utils.eq(_p223, _user$project$Lang$unann) ? _elm_lang$core$Maybe$Just(
								{ctor: '_Tuple2', _0: 'Freeze', _1: _user$project$Lang$frozen}) : (_elm_lang$core$Native_Utils.eq(_p223, _user$project$Lang$frozen) ? _elm_lang$core$Maybe$Just(
								{ctor: '_Tuple2', _0: 'Thaw', _1: _user$project$Lang$unann}) : (_elm_lang$core$Native_Utils.eq(_p223, _user$project$Lang$thawed) ? _elm_lang$core$Maybe$Just(
								{ctor: '_Tuple2', _0: 'Freeze', _1: _user$project$Lang$frozen}) : _elm_lang$core$Maybe$Nothing))) : (_elm_lang$core$Native_Utils.eq(_p223, _user$project$Lang$unann) ? _elm_lang$core$Maybe$Just(
								{ctor: '_Tuple2', _0: 'Thaw', _1: _user$project$Lang$thawed}) : (_elm_lang$core$Native_Utils.eq(_p223, _user$project$Lang$frozen) ? _elm_lang$core$Maybe$Just(
								{ctor: '_Tuple2', _0: 'Thaw', _1: _user$project$Lang$thawed}) : (_elm_lang$core$Native_Utils.eq(_p223, _user$project$Lang$thawed) ? _elm_lang$core$Maybe$Just(
								{ctor: '_Tuple2', _0: 'Freeze', _1: _user$project$Lang$unann}) : _elm_lang$core$Maybe$Nothing)));
						} else {
							return model.syncOptions.thawedByDefault ? _elm_lang$core$Maybe$Just(
								{ctor: '_Tuple2', _0: 'Freeze', _1: _user$project$Lang$frozen}) : _elm_lang$core$Maybe$Just(
								{ctor: '_Tuple2', _0: 'Thaw', _1: _user$project$Lang$thawed});
						}
					}();
					var _p224 = mode_;
					if (_p224.ctor === 'Just') {
						return {ctor: '_Tuple2', _0: mode_, _1: _user$project$InterfaceModel$Satisfied};
					} else {
						return {ctor: '_Tuple2', _0: mode_, _1: _user$project$InterfaceModel$Impossible};
					}
				}
			}
		}();
		var mode = _p219._0;
		var predVal = _p219._1;
		var _p225 = function () {
			var _p226 = mode;
			if (_p226.ctor === 'Nothing') {
				return {ctor: '_Tuple2', _0: 'Thaw/Freeze', _1: _elm_lang$core$Maybe$Nothing};
			} else {
				var _p231 = _p226._0._0;
				return {
					ctor: '_Tuple2',
					_0: _p231,
					_1: _elm_lang$core$Maybe$Just(
						function (_p227) {
							var _p228 = _p227;
							var eSubst = A3(
								_elm_lang$core$List$foldl,
								F2(
									function (_p229, acc) {
										var _p230 = _p229;
										return A3(
											_elm_lang$core$Dict$insert,
											_p230._0,
											A4(
												_user$project$Lang$EConst,
												_p230._1._0,
												_p230._1._1,
												{ctor: '_Tuple3', _0: _p230._1._2._0, _1: _p226._0._1, _2: _p230._1._2._2},
												_p230._1._3),
											acc);
									}),
								_elm_lang$core$Dict$empty,
								nums);
							return {
								ctor: '::',
								_0: A2(
									_user$project$InterfaceModel$synthesisResult,
									_p231,
									A2(_user$project$Lang$applyESubst, eSubst, model.inputExp)),
								_1: {ctor: '[]'}
							};
						})
				};
			}
		}();
		var name = _p225._0;
		var func = _p225._1;
		return {
			name: name,
			func: func,
			reqs: {
				ctor: '::',
				_0: {description: 'Select one or more numbers', value: predVal},
				_1: {ctor: '[]'}
			},
			id: 'thawFreeze'
		};
	});
var _user$project$DeuceTools$showHideRangeTool = F2(
	function (model, selections) {
		var _p232 = selections;
		var nums = _p232._0;
		var mode = function () {
			if (!_user$project$DeuceTools$oneOrMoreNumsOnly(selections)) {
				return _elm_lang$core$Maybe$Nothing;
			} else {
				var freezeAnnotations = A3(
					_elm_lang$core$Basics$flip,
					_elm_lang$core$List$map,
					nums,
					function (_p233) {
						var _p234 = _p233;
						var _p235 = _p234._1._3.val;
						switch (_p235.ctor) {
							case 'IntSlider':
								return _elm_lang$core$Maybe$Just(_p235._4);
							case 'NumSlider':
								return _elm_lang$core$Maybe$Just(_p235._4);
							default:
								return _elm_lang$core$Maybe$Nothing;
						}
					});
				var _p236 = _user$project$Utils$dedupByEquality(freezeAnnotations);
				if (((_p236.ctor === '::') && (_p236._0.ctor === 'Just')) && (_p236._1.ctor === '[]')) {
					return _elm_lang$core$Maybe$Just(_p236._0._0);
				} else {
					return _elm_lang$core$Maybe$Nothing;
				}
			}
		}();
		var predVal = _elm_lang$core$Native_Utils.eq(
			selections,
			{
				ctor: '_Tuple7',
				_0: {ctor: '[]'},
				_1: {ctor: '[]'},
				_2: {ctor: '[]'},
				_3: {ctor: '[]'},
				_4: {ctor: '[]'},
				_5: {ctor: '[]'},
				_6: {ctor: '[]'}
			}) ? _user$project$InterfaceModel$Possible : ((!_elm_lang$core$Native_Utils.eq(mode, _elm_lang$core$Maybe$Nothing)) ? _user$project$InterfaceModel$Satisfied : _user$project$InterfaceModel$Impossible);
		var _p237 = function () {
			var _p238 = mode;
			if (_p238.ctor === 'Nothing') {
				return {ctor: '_Tuple2', _0: 'Show/Hide Sliders', _1: _elm_lang$core$Maybe$Nothing};
			} else {
				var _p246 = _p238._0;
				var toolName = function () {
					var _p239 = {
						ctor: '_Tuple2',
						_0: _p246,
						_1: _elm_lang$core$List$length(nums)
					};
					if (_p239._0 === true) {
						if (_p239._1 === 1) {
							return 'Show Slider';
						} else {
							return 'Show Sliders';
						}
					} else {
						if (_p239._1 === 1) {
							return 'Hide Slider';
						} else {
							return 'Hide Sliders';
						}
					}
				}();
				return {
					ctor: '_Tuple2',
					_0: toolName,
					_1: _elm_lang$core$Maybe$Just(
						function (_p240) {
							var _p241 = _p240;
							var eSubst = A3(
								_elm_lang$core$List$foldl,
								F2(
									function (_p242, acc) {
										var _p243 = _p242;
										var _p245 = _p243._1._3;
										var wd_ = function () {
											var _p244 = _p245.val;
											switch (_p244.ctor) {
												case 'IntSlider':
													return A5(_user$project$Lang$IntSlider, _p244._0, _p244._1, _p244._2, _p244._3, !_p246);
												case 'NumSlider':
													return A5(_user$project$Lang$NumSlider, _p244._0, _p244._1, _p244._2, _p244._3, !_p246);
												default:
													return _p245.val;
											}
										}();
										return A3(
											_elm_lang$core$Dict$insert,
											_p243._0,
											A4(
												_user$project$Lang$EConst,
												_p243._1._0,
												_p243._1._1,
												_p243._1._2,
												_elm_lang$core$Native_Utils.update(
													_p245,
													{val: wd_})),
											acc);
									}),
								_elm_lang$core$Dict$empty,
								nums);
							return {
								ctor: '::',
								_0: A2(
									_user$project$InterfaceModel$synthesisResult,
									toolName,
									A2(_user$project$Lang$applyESubst, eSubst, model.inputExp)),
								_1: {ctor: '[]'}
							};
						})
				};
			}
		}();
		var name = _p237._0;
		var func = _p237._1;
		return {
			name: name,
			func: func,
			reqs: {
				ctor: '::',
				_0: {description: 'Select one or more numbers with sliders', value: predVal},
				_1: {ctor: '[]'}
			},
			id: 'showHideRange'
		};
	});
var _user$project$DeuceTools$addRemoveRangeTool = F2(
	function (model, selections) {
		var predVal = _elm_lang$core$Native_Utils.eq(
			selections,
			{
				ctor: '_Tuple7',
				_0: {ctor: '[]'},
				_1: {ctor: '[]'},
				_2: {ctor: '[]'},
				_3: {ctor: '[]'},
				_4: {ctor: '[]'},
				_5: {ctor: '[]'},
				_6: {ctor: '[]'}
			}) ? _user$project$InterfaceModel$Possible : (_user$project$DeuceTools$oneOrMoreNumsOnly(selections) ? _user$project$InterfaceModel$Satisfied : _user$project$InterfaceModel$Impossible);
		var _p247 = selections;
		var nums = _p247._0;
		var mode = function () {
			var freezeAnnotations = A3(
				_elm_lang$core$Basics$flip,
				_elm_lang$core$List$map,
				nums,
				function (_p248) {
					var _p249 = _p248;
					var _p250 = _p249._1._3.val;
					if (_p250.ctor === 'NoWidgetDecl') {
						return true;
					} else {
						return false;
					}
				});
			return _user$project$Utils$maybeUnpackSingleton(
				_user$project$Utils$dedupByEquality(freezeAnnotations));
		}();
		var _p251 = function () {
			var _p252 = mode;
			if (_p252.ctor === 'Nothing') {
				return {ctor: '_Tuple2', _0: 'Add/Remove Sliders', _1: _elm_lang$core$Maybe$Nothing};
			} else {
				var _p260 = _p252._0;
				var toolName = function () {
					var _p253 = {
						ctor: '_Tuple2',
						_0: _p260,
						_1: _elm_lang$core$List$length(nums)
					};
					if (_p253._0 === true) {
						if (_p253._1 === 1) {
							return 'Add Slider';
						} else {
							return 'Add Sliders';
						}
					} else {
						if (_p253._1 === 1) {
							return 'Remove Slider';
						} else {
							return 'Remove Sliders';
						}
					}
				}();
				return {
					ctor: '_Tuple2',
					_0: toolName,
					_1: _elm_lang$core$Maybe$Just(
						function (_p254) {
							var _p255 = _p254;
							var eSubst = A3(
								_elm_lang$core$List$foldl,
								F2(
									function (_p256, acc) {
										var _p257 = _p256;
										var _p259 = _p257._1._1;
										var wd = function () {
											if (_p260) {
												if (A2(
													_user$project$Utils$between,
													_p259,
													{ctor: '_Tuple2', _0: 1.0e-3, _1: 1})) {
													return A2(_user$project$Lang$numSlider, 1.0e-3, 1);
												} else {
													var _p258 = _user$project$DeuceTools$rangeAround(_p259);
													var i = _p258._0;
													var j = _p258._1;
													return _elm_lang$core$Native_Utils.eq(
														_elm_lang$core$Basics$toFloat(
															_elm_lang$core$Basics$round(_p259)),
														_p259) ? A2(
														_user$project$Lang$intSlider,
														A2(
															_elm_lang$core$Basics$max,
															0,
															_elm_lang$core$Basics$round(i)),
														_elm_lang$core$Basics$round(j)) : A2(
														_user$project$Lang$numSlider,
														A2(_elm_lang$core$Basics$max, 0, i),
														j);
												}
											} else {
												return _user$project$Lang$withDummyRange(_user$project$Lang$NoWidgetDecl);
											}
										}();
										return A3(
											_elm_lang$core$Dict$insert,
											_p257._0,
											A4(_user$project$Lang$EConst, _p257._1._0, _p259, _p257._1._2, wd),
											acc);
									}),
								_elm_lang$core$Dict$empty,
								nums);
							return {
								ctor: '::',
								_0: A2(
									_user$project$InterfaceModel$synthesisResult,
									toolName,
									A2(_user$project$Lang$applyESubst, eSubst, model.inputExp)),
								_1: {ctor: '[]'}
							};
						})
				};
			}
		}();
		var name = _p251._0;
		var func = _p251._1;
		return {
			name: name,
			func: func,
			reqs: {
				ctor: '::',
				_0: {description: 'Select one or more numbers', value: predVal},
				_1: {ctor: '[]'}
			},
			id: 'addRemoveRange'
		};
	});
var _user$project$DeuceTools$selectedPatTargets = function (deuceWidgets) {
	return A3(
		_elm_lang$core$Basics$flip,
		_elm_lang$core$List$concatMap,
		deuceWidgets,
		function (deuceWidget) {
			var _p261 = deuceWidget;
			if (_p261.ctor === 'DeucePatTarget') {
				return {
					ctor: '::',
					_0: _p261._0,
					_1: {ctor: '[]'}
				};
			} else {
				return {ctor: '[]'};
			}
		});
};
var _user$project$DeuceTools$selectedExpTargets = function (deuceWidgets) {
	return A3(
		_elm_lang$core$Basics$flip,
		_elm_lang$core$List$concatMap,
		deuceWidgets,
		function (deuceWidget) {
			var _p262 = deuceWidget;
			if (_p262.ctor === 'DeuceExpTarget') {
				return {
					ctor: '::',
					_0: _p262._0,
					_1: {ctor: '[]'}
				};
			} else {
				return {ctor: '[]'};
			}
		});
};
var _user$project$DeuceTools$selectedEquations = function (deuceWidgets) {
	return A3(
		_elm_lang$core$Basics$flip,
		_elm_lang$core$List$concatMap,
		deuceWidgets,
		function (deuceWidget) {
			var _p263 = deuceWidget;
			if (_p263.ctor === 'DeuceLetBindingEquation') {
				return {
					ctor: '::',
					_0: _p263._0,
					_1: {ctor: '[]'}
				};
			} else {
				return {ctor: '[]'};
			}
		});
};
var _user$project$DeuceTools$selectedPats = function (deuceWidgets) {
	return A3(
		_elm_lang$core$Basics$flip,
		_elm_lang$core$List$concatMap,
		deuceWidgets,
		function (deuceWidget) {
			var _p264 = deuceWidget;
			if (_p264.ctor === 'DeucePat') {
				return {
					ctor: '::',
					_0: _p264._0,
					_1: {ctor: '[]'}
				};
			} else {
				return {ctor: '[]'};
			}
		});
};
var _user$project$DeuceTools$selectedExps = function (deuceWidgets) {
	return A3(
		_elm_lang$core$Basics$flip,
		_elm_lang$core$List$concatMap,
		deuceWidgets,
		function (deuceWidget) {
			var _p265 = deuceWidget;
			if (_p265.ctor === 'DeuceExp') {
				return {
					ctor: '::',
					_0: _p265._0,
					_1: {ctor: '[]'}
				};
			} else {
				return {ctor: '[]'};
			}
		});
};
var _user$project$DeuceTools$selectedNumsAndBaseVals = function (model) {
	var noMatches = {
		ctor: '_Tuple2',
		_0: {ctor: '[]'},
		_1: {ctor: '[]'}
	};
	return function (_p266) {
		var _p267 = _p266;
		return {
			ctor: '_Tuple2',
			_0: _elm_lang$core$List$concat(_p267._0),
			_1: _elm_lang$core$List$concat(_p267._1)
		};
	}(
		_elm_lang$core$List$unzip(
			A2(
				_elm_lang$core$List$map,
				function (deuceWidget) {
					var _p268 = deuceWidget;
					if (_p268.ctor === 'DeuceExp') {
						var _p271 = _p268._0;
						var _p269 = A2(_user$project$Lang$findExpByEId, model.inputExp, _p271);
						if (_p269.ctor === 'Just') {
							var _p270 = _p269._0.val.e__;
							switch (_p270.ctor) {
								case 'EConst':
									return {
										ctor: '_Tuple2',
										_0: {
											ctor: '::',
											_0: {
												ctor: '_Tuple2',
												_0: _p271,
												_1: {ctor: '_Tuple4', _0: _p270._0, _1: _p270._1, _2: _p270._2, _3: _p270._3}
											},
											_1: {ctor: '[]'}
										},
										_1: {ctor: '[]'}
									};
								case 'EBase':
									return {
										ctor: '_Tuple2',
										_0: {ctor: '[]'},
										_1: {
											ctor: '::',
											_0: {
												ctor: '_Tuple2',
												_0: _p271,
												_1: {ctor: '_Tuple2', _0: _p270._0, _1: _p270._1}
											},
											_1: {ctor: '[]'}
										}
									};
								default:
									return noMatches;
							}
						} else {
							return noMatches;
						}
					} else {
						return noMatches;
					}
				},
				model.deuceState.selectedWidgets)));
};
var _user$project$DeuceTools$selectedNums = function (_p272) {
	return _elm_lang$core$Tuple$first(
		_user$project$DeuceTools$selectedNumsAndBaseVals(_p272));
};
var _user$project$DeuceTools$selectedBaseVals = function (_p273) {
	return _elm_lang$core$Tuple$second(
		_user$project$DeuceTools$selectedNumsAndBaseVals(_p273));
};
var _user$project$DeuceTools$deuceTools = function (model) {
	var baseVals = _user$project$DeuceTools$selectedBaseVals(model);
	var nums = _user$project$DeuceTools$selectedNums(model);
	var _p274 = model.deuceState;
	var selectedWidgets = _p274.selectedWidgets;
	var exps = _user$project$DeuceTools$selectedExps(selectedWidgets);
	var pathedPatIds = _user$project$DeuceTools$selectedPats(selectedWidgets);
	var letBindingEquations = _user$project$DeuceTools$selectedEquations(selectedWidgets);
	var expTargets = _user$project$DeuceTools$selectedExpTargets(selectedWidgets);
	var patTargets = _user$project$DeuceTools$selectedPatTargets(selectedWidgets);
	var selections = {ctor: '_Tuple7', _0: nums, _1: baseVals, _2: exps, _3: pathedPatIds, _4: letBindingEquations, _5: expTargets, _6: patTargets};
	return A2(
		_elm_lang$core$List$map,
		_elm_lang$core$List$map(
			function (tool) {
				return A2(tool, model, selections);
			}),
		{
			ctor: '::',
			_0: {
				ctor: '::',
				_0: _user$project$DeuceTools$createFunctionTool,
				_1: {
					ctor: '::',
					_0: _user$project$DeuceTools$createFunctionFromArgsTool,
					_1: {
						ctor: '::',
						_0: _user$project$DeuceTools$mergeTool,
						_1: {ctor: '[]'}
					}
				}
			},
			_1: {
				ctor: '::',
				_0: {
					ctor: '::',
					_0: _user$project$DeuceTools$addArgumentsTool,
					_1: {
						ctor: '::',
						_0: _user$project$DeuceTools$removeArgumentsTool,
						_1: {
							ctor: '::',
							_0: _user$project$DeuceTools$reorderArgumentsTool,
							_1: {ctor: '[]'}
						}
					}
				},
				_1: {
					ctor: '::',
					_0: {
						ctor: '::',
						_0: _user$project$DeuceTools$renameVariableTool,
						_1: {
							ctor: '::',
							_0: _user$project$DeuceTools$introduceVariableTool,
							_1: {
								ctor: '::',
								_0: _user$project$DeuceTools$swapNamesAndUsagesTool,
								_1: {
									ctor: '::',
									_0: _user$project$DeuceTools$swapUsagesTool,
									_1: {ctor: '[]'}
								}
							}
						}
					},
					_1: {
						ctor: '::',
						_0: {
							ctor: '::',
							_0: _user$project$DeuceTools$makeEqualTool,
							_1: {
								ctor: '::',
								_0: _user$project$DeuceTools$copyExpressionTool,
								_1: {ctor: '[]'}
							}
						},
						_1: {
							ctor: '::',
							_0: {
								ctor: '::',
								_0: _user$project$DeuceTools$moveDefinitionTool,
								_1: {
									ctor: '::',
									_0: _user$project$DeuceTools$swapDefinitionsTool,
									_1: {
										ctor: '::',
										_0: _user$project$DeuceTools$inlineDefinitionTool,
										_1: {
											ctor: '::',
											_0: _user$project$DeuceTools$duplicateDefinitionTool,
											_1: {ctor: '[]'}
										}
									}
								}
							},
							_1: {
								ctor: '::',
								_0: {
									ctor: '::',
									_0: _user$project$DeuceTools$reorderExpressionsTool,
									_1: {
										ctor: '::',
										_0: _user$project$DeuceTools$swapExpressionsTool,
										_1: {ctor: '[]'}
									}
								},
								_1: {
									ctor: '::',
									_0: {
										ctor: '::',
										_0: _user$project$DeuceTools$makeSingleLineTool,
										_1: {
											ctor: '::',
											_0: _user$project$DeuceTools$makeMultiLineTool,
											_1: {
												ctor: '::',
												_0: _user$project$DeuceTools$alignExpressionsTool,
												_1: {ctor: '[]'}
											}
										}
									},
									_1: {
										ctor: '::',
										_0: (model.enableDomainSpecificCodeTools && (!_user$project$UserStudy$enabled)) ? {
											ctor: '::',
											_0: _user$project$DeuceTools$thawFreezeTool,
											_1: {
												ctor: '::',
												_0: _user$project$DeuceTools$addRemoveRangeTool,
												_1: {
													ctor: '::',
													_0: _user$project$DeuceTools$showHideRangeTool,
													_1: {
														ctor: '::',
														_0: _user$project$DeuceTools$rewriteOffsetTool,
														_1: {
															ctor: '::',
															_0: _user$project$DeuceTools$convertColorStringTool,
															_1: {ctor: '[]'}
														}
													}
												}
											}
										} : {ctor: '[]'},
										_1: {
											ctor: '::',
											_0: {
												ctor: '::',
												_0: _user$project$DeuceTools$flipBooleanTool,
												_1: {ctor: '[]'}
											},
											_1: {ctor: '[]'}
										}
									}
								}
							}
						}
					}
				}
			}
		});
};
var _user$project$DeuceTools$createToolCache_ = function (model) {
	return A2(
		_elm_lang$core$List$map,
		_elm_lang$core$List$map(
			function (deuceTool) {
				var _p275 = A2(_user$project$DeuceTools$runTool, model, deuceTool);
				if (_p275.ctor === 'Just') {
					return {ctor: '_Tuple3', _0: deuceTool, _1: _p275._0, _2: false};
				} else {
					return {
						ctor: '_Tuple3',
						_0: deuceTool,
						_1: {ctor: '[]'},
						_2: true
					};
				}
			}),
		_user$project$DeuceTools$deuceTools(model));
};
var _user$project$DeuceTools$createToolCache = function (model) {
	return _user$project$DeuceTools$createToolCache_(model);
};
var _user$project$DeuceTools$updateRenameToolsInCache = function (almostNewModel) {
	var cachedAndNewDeuceTools = A3(
		_user$project$Utils$zipWith,
		_user$project$Utils$zip,
		almostNewModel.deuceToolsAndResults,
		_user$project$DeuceTools$deuceTools(almostNewModel));
	return A2(
		_elm_lang$core$List$map,
		_elm_lang$core$List$map(
			function (_p276) {
				var _p277 = _p276;
				var _p280 = _p277._1;
				var _p279 = _p277._0._0;
				if (_user$project$DeuceTools$isRenamer(_p279)) {
					var _p278 = A2(_user$project$DeuceTools$runTool, almostNewModel, _p280);
					if (_p278.ctor === 'Just') {
						return {ctor: '_Tuple3', _0: _p280, _1: _p278._0, _2: false};
					} else {
						return {
							ctor: '_Tuple3',
							_0: _p280,
							_1: {ctor: '[]'},
							_2: true
						};
					}
				} else {
					return {ctor: '_Tuple3', _0: _p279, _1: _p277._0._1, _2: _p277._0._2};
				}
			}),
		cachedAndNewDeuceTools);
};

var _user$project$InterfaceController$msgSetColorScheme = function (colorScheme) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Set Color Scheme',
		function (old) {
			return _elm_lang$core$Native_Utils.update(
				old,
				{colorScheme: colorScheme});
		});
};
var _user$project$InterfaceController$msgReceiveDeucePopupPanelInfo = function (dppi) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Receive Deuce Popup Panel Info',
		function (old) {
			var oldDeucePopupPanelAbove = old.deucePopupPanelAbove;
			var _p0 = old.popupPanelPositions.deuce;
			var oldX = _p0._0;
			var oldY = _p0._1;
			var newDeucePopupPanelAbove = _elm_lang$core$Native_Utils.cmp(oldY, dppi.height) > 0;
			return _elm_lang$core$Native_Utils.update(
				old,
				{
					deucePopupPanelAbove: _user$project$InterfaceModel$deucePopupPanelShown(old) ? (oldDeucePopupPanelAbove && newDeucePopupPanelAbove) : true
				});
		});
};
var _user$project$InterfaceController$msgResetInterfaceLayout = A2(
	_user$project$InterfaceModel$Msg,
	'Reset Interface Layout',
	function (model) {
		return _elm_lang$core$Native_Utils.update(
			model,
			{mainResizerX: _elm_lang$core$Maybe$Nothing, proseResizerY: _elm_lang$core$Maybe$Nothing});
	});
var _user$project$InterfaceController$msgSetEnableDomainSpecificCodeTools = function (bool) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Set Enable Domain Specific Code Tools',
		function (model) {
			var almostNewModel = _elm_lang$core$Native_Utils.update(
				model,
				{enableDomainSpecificCodeTools: bool});
			return _elm_lang$core$Native_Utils.update(
				almostNewModel,
				{
					deuceToolsAndResults: _user$project$DeuceTools$createToolCache(almostNewModel),
					deuceToolResultPreviews: _elm_lang$core$Dict$empty
				});
		});
};
var _user$project$InterfaceController$msgSetEnableTextEdits = function (bool) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Set Enable Text Edits',
		function (model) {
			return _elm_lang$core$Native_Utils.update(
				model,
				{
					enableTextEdits: _user$project$Updatable$create(bool)
				});
		});
};
var _user$project$InterfaceController$msgSetTextSelectMode = function (textSelectMode) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Set Text Select Mode',
		function (model) {
			return _elm_lang$core$Native_Utils.update(
				model,
				{textSelectMode: textSelectMode});
		});
};
var _user$project$InterfaceController$msgSetCodeToolsMenuMode = function (mode) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Set Code Tools Menu Mode',
		function (model) {
			return _elm_lang$core$Native_Utils.update(
				model,
				{codeToolsMenuMode: mode});
		});
};
var _user$project$InterfaceController$msgSetEnableDeuceTextSelection = function (bool) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Set Enable Deuce Text Selection',
		function (model) {
			return _elm_lang$core$Native_Utils.update(
				model,
				{enableDeuceTextSelection: bool});
		});
};
var _user$project$InterfaceController$msgSetEnableDeuceBoxSelection = function (bool) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Set Enable Deuce Box Selection',
		function (model) {
			return _elm_lang$core$Native_Utils.update(
				model,
				{enableDeuceBoxSelection: bool});
		});
};
var _user$project$InterfaceController$currentTaskDuration = function (model) {
	var userStudyState = _user$project$UserStudy$getState(model.userStudyStateIndex);
	return _user$project$UserStudy$stepTimeoutDuration(userStudyState);
};
var _user$project$InterfaceController$timeLeft = function (model) {
	var timeoutTime = model.userStudyTaskStartTime + _user$project$InterfaceController$currentTaskDuration(model);
	return timeoutTime - model.userStudyTaskCurrentTime;
};
var _user$project$InterfaceController$deltaMouse = F2(
	function (old, $new) {
		return {ctor: '_Tuple2', _0: $new.x - old.x, _1: $new.y - old.y};
	});
var _user$project$InterfaceController$msgDragMainResizer = function () {
	var updater = F3(
		function (oldPosition, newPosition, old) {
			var oldMainResizerX = _user$project$SleekLayout$mainResizer(old).x;
			var rightBound = _user$project$SleekLayout$mainResizerRightBound(old);
			var leftBound = _user$project$SleekLayout$mainResizerLeftBound(old);
			var newMainResizerX = A3(
				_user$project$Utils$clamp,
				leftBound,
				rightBound,
				oldMainResizerX + _elm_lang$core$Tuple$first(
					A2(_user$project$InterfaceController$deltaMouse, oldPosition, newPosition)));
			return _elm_lang$core$Native_Utils.update(
				old,
				{
					mainResizerX: _elm_lang$core$Maybe$Just(newMainResizerX)
				});
		});
	return A2(
		_user$project$InterfaceModel$Msg,
		'Drag Main Resizer',
		function (model) {
			return _elm_lang$core$Native_Utils.update(
				model,
				{
					mouseMode: _user$project$InterfaceModel$MouseDrag(updater)
				});
		});
}();
var _user$project$InterfaceController$msgDragProseResizer = function () {
	var updater = F3(
		function (oldPosition, newPosition, old) {
			var oldProseResizerY = _user$project$SleekLayout$proseResizer(old).y;
			var bottomBound = _user$project$SleekLayout$proseResizerBottomBound(old);
			var topBound = _user$project$SleekLayout$proseResizerTopBound(old);
			var newProseResizerY = A3(
				_user$project$Utils$clamp,
				topBound,
				bottomBound,
				oldProseResizerY + _elm_lang$core$Tuple$second(
					A2(_user$project$InterfaceController$deltaMouse, oldPosition, newPosition)));
			return _elm_lang$core$Native_Utils.update(
				old,
				{
					proseResizerY: _elm_lang$core$Maybe$Just(newProseResizerY)
				});
		});
	return A2(
		_user$project$InterfaceModel$Msg,
		'Drag Prose Resizer',
		function (model) {
			return _elm_lang$core$Native_Utils.update(
				model,
				{
					mouseMode: _user$project$InterfaceModel$MouseDrag(updater)
				});
		});
}();
var _user$project$InterfaceController$shift = F2(
	function (_p2, _p1) {
		var _p3 = _p2;
		var _p4 = _p1;
		return {ctor: '_Tuple2', _0: _p3._0 + _p4._0, _1: _p3._1 + _p4._1};
	});
var _user$project$InterfaceController$updatePopupPanelPosition = F3(
	function (get, set, model) {
		var updater = F3(
			function (oldPosition, newPosition, old) {
				var oldPopupPanelPosition = get(old.popupPanelPositions);
				var newPopupPanelPosition = A2(
					_user$project$InterfaceController$shift,
					oldPopupPanelPosition,
					A2(_user$project$InterfaceController$deltaMouse, oldPosition, newPosition));
				var oldPopupPanelPositions = old.popupPanelPositions;
				var newPopupPanelPositions = A2(set, oldPopupPanelPositions, newPopupPanelPosition);
				return _elm_lang$core$Native_Utils.update(
					old,
					{popupPanelPositions: newPopupPanelPositions});
			});
		return _elm_lang$core$Native_Utils.update(
			model,
			{
				mouseMode: _user$project$InterfaceModel$MouseDrag(updater)
			});
	});
var _user$project$InterfaceController$msgDragDeucePopupPanel = A2(
	_user$project$InterfaceModel$Msg,
	'Drag Deuce Popup Panel',
	A2(
		_user$project$InterfaceController$updatePopupPanelPosition,
		function (_) {
			return _.deuce;
		},
		F2(
			function (ppp, pos) {
				return _elm_lang$core$Native_Utils.update(
					ppp,
					{deuce: pos});
			})));
var _user$project$InterfaceController$msgDragEditCodePopupPanel = A2(
	_user$project$InterfaceModel$Msg,
	'Drag Edit Code Popup Panel',
	A2(
		_user$project$InterfaceController$updatePopupPanelPosition,
		function (_) {
			return _.editCode;
		},
		F2(
			function (ppp, pos) {
				return _elm_lang$core$Native_Utils.update(
					ppp,
					{editCode: pos});
			})));
var _user$project$InterfaceController$msgDragDeuceRightClickMenu = A2(
	_user$project$InterfaceModel$Msg,
	'Drag Deuce Right Click Menu',
	A2(
		_user$project$InterfaceController$updatePopupPanelPosition,
		function (_) {
			return _.deuceRightClickMenu;
		},
		F2(
			function (ppp, pos) {
				return _elm_lang$core$Native_Utils.update(
					ppp,
					{deuceRightClickMenu: pos});
			})));
var _user$project$InterfaceController$msgClearDrag = A2(
	_user$project$InterfaceModel$Msg,
	'Clear Drag',
	function (model) {
		return _elm_lang$core$Native_Utils.update(
			model,
			{mouseMode: _user$project$InterfaceModel$MouseNothing});
	});
var _user$project$InterfaceController$msgUpdateRenameVarTextBox = function (text) {
	return A2(
		_user$project$InterfaceModel$Msg,
		A2(_elm_lang$core$Basics_ops['++'], 'Update Rename Var Text Box: ', text),
		function (model) {
			var oldDeuceState = model.deuceState;
			var almostNewModel = _elm_lang$core$Native_Utils.update(
				model,
				{
					deuceState: _elm_lang$core$Native_Utils.update(
						oldDeuceState,
						{
							renameVarTextBox: _user$project$FastParser$sanitizeVariableName(text)
						})
				});
			return _user$project$DeuceTools$reselectDeuceTool(
				_elm_lang$core$Native_Utils.update(
					almostNewModel,
					{
						deuceToolsAndResults: _user$project$DeuceTools$updateRenameToolsInCache(almostNewModel),
						deuceToolResultPreviews: _elm_lang$core$Dict$empty
					}));
		});
};
var _user$project$InterfaceController$msgLeaveDeuceResult = F2(
	function (_p5, path) {
		var _p6 = _p5;
		var clearPreview = function (m) {
			return _elm_lang$core$Native_Utils.update(
				m,
				{preview: _elm_lang$core$Maybe$Nothing});
		};
		return A2(
			_user$project$InterfaceModel$Msg,
			A2(
				_elm_lang$core$Basics_ops['++'],
				'Leave Deuce Result \"',
				A2(
					_elm_lang$core$Basics_ops['++'],
					_p6._0.description,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'\" ',
						_elm_lang$core$Basics$toString(path)))),
			function (_p7) {
				return clearPreview(
					_user$project$DeuceWidgets$clearHoveredMenuPath(_p7));
			});
	});
var _user$project$InterfaceController$msgHoverDeuceResult = F3(
	function (isRenamer, _p8, path) {
		var _p9 = _p8;
		var _p16 = _p9._0;
		var maybeRunToolAndCachePreview = function (m) {
			var _p10 = {
				ctor: '_Tuple2',
				_0: isRenamer,
				_1: A2(_elm_lang$core$Dict$get, path, m.deuceToolResultPreviews)
			};
			if (_p10._0 === true) {
				return m;
			} else {
				if (_p10._1.ctor === 'Just') {
					return _elm_lang$core$Native_Utils.update(
						m,
						{preview: _p10._1._0._0});
				} else {
					var _p11 = function () {
						var _p12 = {
							ctor: '_Tuple2',
							_0: _p16.isSafe,
							_1: A2(_user$project$InterfaceModel$runAndResolve, m, _p16.exp)
						};
						if (_p12._0 === true) {
							if (_p12._1.ctor === 'Ok') {
								return {
									ctor: '_Tuple2',
									_0: _elm_lang$core$Maybe$Just(
										{
											ctor: '_Tuple2',
											_0: _p12._1._0._3,
											_1: _elm_lang$core$Result$Ok(
												{ctor: '_Tuple3', _0: _p12._1._0._0, _1: _p12._1._0._1, _2: _p12._1._0._2})
										}),
									_1: 'expected-safe'
								};
							} else {
								var _p14 = _p12._1._0;
								var _p13 = A2(_elm_lang$core$Debug$log, 'not safe after all!', _p14);
								return {
									ctor: '_Tuple2',
									_0: _elm_lang$core$Maybe$Just(
										{
											ctor: '_Tuple2',
											_0: _user$project$LangUnparser$unparse(_p16.exp),
											_1: _elm_lang$core$Result$Err(_p14)
										}),
									_1: 'unexpected-unsafe'
								};
							}
						} else {
							if (_p12._1.ctor === 'Ok') {
								return {
									ctor: '_Tuple2',
									_0: _elm_lang$core$Maybe$Just(
										{
											ctor: '_Tuple2',
											_0: _p12._1._0._3,
											_1: _elm_lang$core$Result$Ok(
												{ctor: '_Tuple3', _0: _p12._1._0._0, _1: _p12._1._0._1, _2: _p12._1._0._2})
										}),
									_1: 'unexpected-safe'
								};
							} else {
								return {
									ctor: '_Tuple2',
									_0: _elm_lang$core$Maybe$Just(
										{
											ctor: '_Tuple2',
											_0: _user$project$LangUnparser$unparse(_p16.exp),
											_1: _elm_lang$core$Result$Err(_p12._1._0)
										}),
									_1: 'expected-unsafe'
								};
							}
						}
					}();
					var preview = _p11._0;
					var $class = _p11._1;
					var deuceToolResultPreviews = A3(
						_elm_lang$core$Dict$insert,
						path,
						{ctor: '_Tuple2', _0: preview, _1: $class},
						m.deuceToolResultPreviews);
					return _elm_lang$core$Native_Utils.update(
						m,
						{preview: preview, deuceToolResultPreviews: deuceToolResultPreviews});
				}
			}
		};
		return A2(
			_user$project$InterfaceModel$Msg,
			A2(
				_elm_lang$core$Basics_ops['++'],
				'Hover Deuce Result \"',
				A2(
					_elm_lang$core$Basics_ops['++'],
					_p16.description,
					A2(
						_elm_lang$core$Basics_ops['++'],
						'\" ',
						_elm_lang$core$Basics$toString(path)))),
			function (_p15) {
				return maybeRunToolAndCachePreview(
					A2(_user$project$DeuceWidgets$setHoveredMenuPath, path, _p15));
			});
	});
var _user$project$InterfaceController$msgSetGhostsShown = function (shown) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Set Ghosts Shown',
		function (old) {
			var newMode = function () {
				var _p17 = old.outputMode;
				if (_p17.ctor === 'Print') {
					return _user$project$InterfaceModel$Print(
						A2(_user$project$LangSvg$printSvg, shown, old.slate));
				} else {
					return old.outputMode;
				}
			}();
			return _elm_lang$core$Native_Utils.update(
				old,
				{showGhosts: shown, outputMode: newMode});
		});
};
var _user$project$InterfaceController$msgSetToolMode = function (mode) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Set Tool Mode',
		function (old) {
			var newTool = function () {
				var _p18 = old.tool;
				switch (_p18.ctor) {
					case 'Line':
						return _user$project$InterfaceModel$Line(mode);
					case 'Rect':
						return _user$project$InterfaceModel$Rect(mode);
					case 'Oval':
						return _user$project$InterfaceModel$Oval(mode);
					case 'Poly':
						return _user$project$InterfaceModel$Poly(mode);
					case 'Path':
						return _user$project$InterfaceModel$Path(mode);
					case 'Cursor':
						return _user$project$InterfaceModel$Cursor;
					case 'PointOrOffset':
						return _user$project$InterfaceModel$PointOrOffset;
					case 'Text':
						return _user$project$InterfaceModel$Text;
					case 'HelperLine':
						return _user$project$InterfaceModel$HelperLine;
					default:
						return _user$project$InterfaceModel$Lambda(_p18._0);
				}
			}();
			return _elm_lang$core$Native_Utils.update(
				old,
				{toolMode: mode, tool: newTool});
		});
};
var _user$project$InterfaceController$msgUpdateFontSize = function (fontSize) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Update Font Size',
		function (old) {
			var oldCodeBoxInfo = old.codeBoxInfo;
			return _elm_lang$core$Native_Utils.update(
				old,
				{
					codeBoxInfo: _elm_lang$core$Native_Utils.update(
						oldCodeBoxInfo,
						{fontSize: fontSize})
				});
		});
};
var _user$project$InterfaceController$setMenuActive = F2(
	function (isActive, model) {
		var oldViewState = model.viewState;
		var newViewState = _elm_lang$core$Native_Utils.update(
			oldViewState,
			{menuActive: isActive});
		return _elm_lang$core$Native_Utils.update(
			model,
			{viewState: newViewState});
	});
var _user$project$InterfaceController$msgHideMenu = A2(
	_user$project$InterfaceModel$Msg,
	'Hide Menu',
	_user$project$InterfaceController$setMenuActive(false));
var _user$project$InterfaceController$msgToggleMenu = A2(
	_user$project$InterfaceModel$Msg,
	'Toggle Menu',
	function (old) {
		return A2(_user$project$InterfaceController$setMenuActive, !old.viewState.menuActive, old);
	});
var _user$project$InterfaceController$msgReceiveDotImage = function (s) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Receive Image',
		function (m) {
			return _elm_lang$core$Native_Utils.update(
				m,
				{
					outputMode: _user$project$InterfaceModel$PrintScopeGraph(
						_elm_lang$core$Maybe$Just(s))
				});
		});
};
var _user$project$InterfaceController$msgMouseLeaveDeuceWidget = function (widget) {
	return A2(
		_user$project$InterfaceModel$Msg,
		A2(
			_elm_lang$core$Basics_ops['++'],
			'msgMouseLeaveDeuceWidget ',
			_elm_lang$core$Basics$toString(widget)),
		function (old) {
			var deuceState = old.deuceState;
			return _elm_lang$core$Native_Utils.update(
				old,
				{
					deuceState: _elm_lang$core$Native_Utils.update(
						deuceState,
						{
							hoveredWidgets: {ctor: '[]'}
						})
				});
		});
};
var _user$project$InterfaceController$msgMouseEnterDeuceWidget = function (widget) {
	return A2(
		_user$project$InterfaceModel$Msg,
		A2(
			_elm_lang$core$Basics_ops['++'],
			'msgMouseEnterDeuceWidget ',
			_elm_lang$core$Basics$toString(widget)),
		function (old) {
			var deuceState = old.deuceState;
			return _elm_lang$core$Native_Utils.update(
				old,
				{
					deuceState: _elm_lang$core$Native_Utils.update(
						deuceState,
						{
							hoveredWidgets: {
								ctor: '::',
								_0: widget,
								_1: {ctor: '[]'}
							}
						})
				});
		});
};
var _user$project$InterfaceController$toggleDeuceWidget = F2(
	function (widget, model) {
		var multipleTargetPositionsFilter = model.allowMultipleTargetPositions ? _elm_lang$core$Basics$identity : _elm_lang$core$List$filter(
			function (w) {
				return !(_user$project$DeuceWidgets$isTargetPosition(w) && _user$project$DeuceWidgets$isTargetPosition(widget));
			});
		var oldDeuceState = model.deuceState;
		var oldSelectedWidgets = oldDeuceState.selectedWidgets;
		var newSelectedWidgets = A2(_elm_lang$core$List$member, widget, oldSelectedWidgets) ? A2(_user$project$Utils$removeAsSet, widget, oldSelectedWidgets) : A2(
			_user$project$Utils$addAsSet,
			widget,
			multipleTargetPositionsFilter(
				A2(
					_elm_lang$core$List$filter,
					function (w) {
						return !(A3(_user$project$DeuceWidgets$isSubWidget, model.inputExp, w, widget) || A3(_user$project$DeuceWidgets$isSubWidget, model.inputExp, widget, w));
					},
					oldSelectedWidgets)));
		var newSelectedWidgetsEmpty = _elm_lang$core$List$isEmpty(newSelectedWidgets);
		var newDeuceRightClickMenuMode = newSelectedWidgetsEmpty ? _elm_lang$core$Maybe$Nothing : model.deuceRightClickMenuMode;
		var newDeuceState = _elm_lang$core$Native_Utils.update(
			oldDeuceState,
			{selectedWidgets: newSelectedWidgets});
		var almostNewModel = _elm_lang$core$Native_Utils.update(
			model,
			{deuceState: newDeuceState, deuceRightClickMenuMode: newDeuceRightClickMenuMode});
		return _user$project$DeuceTools$reselectDeuceTool(
			_elm_lang$core$Native_Utils.update(
				almostNewModel,
				{
					deuceToolsAndResults: _user$project$DeuceTools$createToolCache(almostNewModel),
					deuceToolResultPreviews: _elm_lang$core$Dict$empty
				}));
	});
var _user$project$InterfaceController$msgMouseClickDeuceWidget = function (widget) {
	return A2(
		_user$project$InterfaceModel$Msg,
		A2(
			_elm_lang$core$Basics_ops['++'],
			'msgMouseClickDeuceWidget ',
			_elm_lang$core$Basics$toString(widget)),
		function (old) {
			return A2(_user$project$InterfaceController$toggleDeuceWidget, widget, old);
		});
};
var _user$project$InterfaceController$textSelect = F2(
	function (allowSingleSelection, old) {
		var patMap = _user$project$Lang$computePatMap(old.inputExp);
		var _p19 = A2(
			_elm_lang$core$Maybe$andThen,
			_user$project$DeuceWidgets$toDeuceWidget(patMap),
			A2(_user$project$InterfaceModel$codeObjectFromSelection, allowSingleSelection, old));
		if (_p19.ctor === 'Just') {
			return A2(_user$project$InterfaceController$toggleDeuceWidget, _p19._0, old);
		} else {
			return old;
		}
	});
var _user$project$InterfaceController$msgTextSelect = function (allowSingleSelection) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Text Select',
		_user$project$InterfaceController$textSelect(allowSingleSelection));
};
var _user$project$InterfaceController$msgMouseLeaveCodeBox = A2(
	_user$project$InterfaceModel$Msg,
	'Mouse Leave CodeBox',
	function (m) {
		var codeBoxInfo = m.codeBoxInfo;
		return _elm_lang$core$Native_Utils.update(
			m,
			{hoveringCodeBox: false});
	});
var _user$project$InterfaceController$msgMouseEnterCodeBox = A2(
	_user$project$InterfaceModel$Msg,
	'Mouse Enter CodeBox',
	function (m) {
		var codeBoxInfo = m.codeBoxInfo;
		return _elm_lang$core$Native_Utils.update(
			m,
			{hoveringCodeBox: true});
	});
var _user$project$InterfaceController$resetDeuceState = function (m) {
	var layoutOffsets = m.layoutOffsets;
	return _elm_lang$core$Native_Utils.update(
		m,
		{
			deuceState: _user$project$DeuceWidgets$emptyDeuceState,
			deuceToolsAndResults: _user$project$DeuceTools$createToolCache(
				_elm_lang$core$Native_Utils.update(
					_user$project$InterfaceModel$initModel,
					{enableDomainSpecificCodeTools: m.enableDomainSpecificCodeTools})),
			deuceToolResultPreviews: _elm_lang$core$Dict$empty,
			selectedDeuceTool: _elm_lang$core$Maybe$Nothing,
			preview: _elm_lang$core$Maybe$Nothing,
			layoutOffsets: _elm_lang$core$Native_Utils.update(
				layoutOffsets,
				{
					deuceToolBox: {
						pinned: layoutOffsets.deuceToolBox.pinned,
						offsets: layoutOffsets.deuceToolBox.pinned ? layoutOffsets.deuceToolBox.offsets : {dx: 0, dy: 0}
					}
				})
		});
};
var _user$project$InterfaceController$msgSetAllowMultipleTargetPositions = function (bool) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Set Allow Multiple Target Positions',
		function (model) {
			return _user$project$InterfaceController$resetDeuceState(
				_elm_lang$core$Native_Utils.update(
					model,
					{allowMultipleTargetPositions: bool}));
		});
};
var _user$project$InterfaceController$msgImportCode = A2(
	_user$project$InterfaceModel$Msg,
	'Import Code',
	_user$project$InterfaceModel$closeDialogBox(_user$project$InterfaceModel$ImportCode));
var _user$project$InterfaceController$msgExportSvg = A2(_user$project$InterfaceModel$Msg, 'Export SVG', _elm_lang$core$Basics$identity);
var _user$project$InterfaceController$msgExportCode = A2(_user$project$InterfaceModel$Msg, 'Export Code', _elm_lang$core$Basics$identity);
var _user$project$InterfaceController$msgConfirmGiveUp = A2(
	_user$project$InterfaceModel$Msg,
	'Confirm Give Up',
	function (old) {
		return A2(
			_user$project$InterfaceModel$closeDialogBox,
			_user$project$InterfaceModel$AlertGiveUp,
			_elm_lang$core$Native_Utils.update(
				old,
				{giveUpConfirmed: true}));
	});
var _user$project$InterfaceController$msgCancelGiveUp = A2(_user$project$InterfaceModel$Msg, 'Cancel Give Up', _user$project$InterfaceModel$cancelGiveUp);
var _user$project$InterfaceController$msgToggleAutosave = A2(
	_user$project$InterfaceModel$Msg,
	'Toggle Autosave',
	function (old) {
		return _elm_lang$core$Native_Utils.update(
			old,
			{autosave: !old.autosave});
	});
var _user$project$InterfaceController$msgConfirmFileOperation = A2(
	_user$project$InterfaceModel$Msg,
	'Confirm File Operation',
	function (_p20) {
		return A2(
			_user$project$InterfaceModel$closeDialogBox,
			_user$project$InterfaceModel$AlertSave,
			function (old) {
				return _elm_lang$core$Native_Utils.update(
					old,
					{fileOperationConfirmed: true});
			}(_p20));
	});
var _user$project$InterfaceController$msgCancelFileOperation = A2(_user$project$InterfaceModel$Msg, 'Cancel File Operation', _user$project$InterfaceModel$cancelFileOperation);
var _user$project$InterfaceController$msgDelete = function (filename) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Delete',
		function (old) {
			return _elm_lang$core$Native_Utils.eq(filename, old.filename) ? _elm_lang$core$Native_Utils.update(
				old,
				{fileToDelete: filename, needsSave: true, lastSaveState: _elm_lang$core$Maybe$Nothing}) : _elm_lang$core$Native_Utils.update(
				old,
				{fileToDelete: filename});
		});
};
var _user$project$InterfaceController$msgSave = A2(
	_user$project$InterfaceModel$Msg,
	'Save',
	function (old) {
		return _elm_lang$core$Native_Utils.eq(old.filename, _user$project$InterfaceModel$bufferName) ? A2(_user$project$InterfaceModel$openDialogBox, _user$project$InterfaceModel$SaveAs, old) : old;
	});
var _user$project$InterfaceController$msgSaveAs = function () {
	var closeDialogBoxIfNecessary = function (old) {
		return (!_elm_lang$core$Native_Utils.eq(old.filename, _user$project$InterfaceModel$bufferName)) ? A2(_user$project$InterfaceModel$closeDialogBox, _user$project$InterfaceModel$SaveAs, old) : old;
	};
	var switchFilenameToInput = function (old) {
		return _elm_lang$core$Native_Utils.update(
			old,
			{filename: old.filenameInput});
	};
	return A2(
		_user$project$InterfaceModel$Msg,
		'Save As',
		function (_p21) {
			return closeDialogBoxIfNecessary(
				switchFilenameToInput(_p21));
		});
}();
var _user$project$InterfaceController$updateFileIndex = F2(
	function (fileIndex, old) {
		return _elm_lang$core$Native_Utils.update(
			old,
			{fileIndex: fileIndex});
	});
var _user$project$InterfaceController$msgUpdateFileIndex = function (fileIndex) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Update File Index',
		_user$project$InterfaceController$updateFileIndex(fileIndex));
};
var _user$project$InterfaceController$readFileFromInput = F2(
	function (file, old) {
		return _elm_lang$core$Native_Utils.update(
			old,
			{
				filename: file.filename,
				code: file.code,
				history: _user$project$History$begin(
					{
						code: file.code,
						selectedDeuceWidgets: {ctor: '[]'}
					}),
				lastSaveState: _elm_lang$core$Maybe$Nothing,
				needsSave: true
			});
	});
var _user$project$InterfaceController$loadIcon = F3(
	function (env, icon, old) {
		var oldIcons = old.icons;
		var actualCode = function () {
			if (!_elm_lang$core$Native_Utils.eq(icon.code, '')) {
				return icon.code;
			} else {
				var _p22 = A2(_elm_lang$core$Dict$get, icon.iconName, _user$project$DefaultIconTheme$icons);
				if (_p22.ctor === 'Just') {
					return _p22._0;
				} else {
					return '(blobs [])';
				}
			}
		}();
		var iconHtml = A2(_user$project$Canvas$iconify, env, actualCode);
		var newIcons = A3(_elm_lang$core$Dict$insert, icon.iconName, iconHtml, oldIcons);
		return _elm_lang$core$Native_Utils.update(
			old,
			{icons: newIcons});
	});
var _user$project$InterfaceController$loadLambdaToolIcons = F2(
	function (finalEnv, old) {
		var foo = F2(
			function (tool, acc) {
				var icon = _user$project$InterfaceModel$lambdaToolIcon(tool);
				return A2(_elm_lang$core$Dict$member, icon.iconName, old.icons) ? acc : A3(_user$project$InterfaceController$loadIcon, finalEnv, icon, old);
			});
		return A3(_elm_lang$core$List$foldl, foo, old, old.lambdaTools);
	});
var _user$project$InterfaceController$msgLoadIcon = function (file) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Load Icon',
		A2(_user$project$InterfaceController$loadIcon, _user$project$Eval$initEnv, file));
};
var _user$project$InterfaceController$readFile = F2(
	function (file, old) {
		return _elm_lang$core$Native_Utils.update(
			old,
			{
				filename: file.filename,
				code: file.code,
				history: _user$project$History$begin(
					{
						code: file.code,
						selectedDeuceWidgets: {ctor: '[]'}
					}),
				lastSaveState: _elm_lang$core$Maybe$Just(file.code),
				needsSave: false
			});
	});
var _user$project$InterfaceController$requestFile = F2(
	function (requestedFilename, old) {
		return _elm_lang$core$Native_Utils.update(
			old,
			{filename: requestedFilename});
	});
var _user$project$InterfaceController$msgOpen = function (filename) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Open',
		function (_p23) {
			return A2(
				_user$project$InterfaceModel$closeDialogBox,
				_user$project$InterfaceModel$Open,
				A2(_user$project$InterfaceController$requestFile, filename, _p23));
		});
};
var _user$project$InterfaceController$confirmDelete = function (deletedFilename) {
	return _elm_lang$core$Basics$identity;
};
var _user$project$InterfaceController$msgConfirmDelete = function (deletedFilename) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Confirm Delete',
		_user$project$InterfaceController$confirmDelete(deletedFilename));
};
var _user$project$InterfaceController$confirmWrite = F2(
	function (savedFilename, old) {
		return _elm_lang$core$Native_Utils.update(
			old,
			{
				needsSave: false,
				lastSaveState: _elm_lang$core$Maybe$Just(old.code)
			});
	});
var _user$project$InterfaceController$msgConfirmWrite = function (savedFilename) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Confirm Write',
		_user$project$InterfaceController$confirmWrite(savedFilename));
};
var _user$project$InterfaceController$msgUpdateFilenameInput = function (str) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Update Filename Input',
		function (old) {
			return _elm_lang$core$Native_Utils.update(
				old,
				{filenameInput: str});
		});
};
var _user$project$InterfaceController$msgCloseDialogBox = function (db) {
	return A2(
		_user$project$InterfaceModel$Msg,
		A2(
			_elm_lang$core$Basics_ops['++'],
			'Close Dialog Box \"',
			A2(
				_elm_lang$core$Basics_ops['++'],
				_elm_lang$core$Basics$toString(db),
				'\"')),
		_user$project$InterfaceModel$closeDialogBox(db));
};
var _user$project$InterfaceController$msgOpenDialogBox = function (db) {
	return A2(
		_user$project$InterfaceModel$Msg,
		A2(
			_elm_lang$core$Basics_ops['++'],
			'Open Dialog Box \"',
			A2(
				_elm_lang$core$Basics_ops['++'],
				_elm_lang$core$Basics$toString(db),
				'\"')),
		_user$project$InterfaceModel$openDialogBox(db));
};
var _user$project$InterfaceController$giveUpAsker = function (msg) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Give Up Asker',
		function (old) {
			return A2(
				_user$project$InterfaceModel$openDialogBox,
				_user$project$InterfaceModel$AlertGiveUp,
				_elm_lang$core$Native_Utils.update(
					old,
					{
						pendingGiveUpMsg: _elm_lang$core$Maybe$Just(msg),
						giveUpConfirmed: false
					}));
		});
};
var _user$project$InterfaceController$requireSaveAsker = F2(
	function (_p24, needsSave) {
		var _p25 = _p24;
		var _p27 = _p25;
		return needsSave ? A2(
			_user$project$InterfaceModel$Msg,
			A2(_elm_lang$core$Basics_ops['++'], 'Ask ', _p25._0),
			function (_p26) {
				return A2(
					_user$project$InterfaceModel$openDialogBox,
					_user$project$InterfaceModel$AlertSave,
					function (old) {
						return _elm_lang$core$Native_Utils.update(
							old,
							{
								pendingFileOperation: _elm_lang$core$Maybe$Just(_p27),
								fileOperationConfirmed: false
							});
					}(_p26));
			}) : _p27;
	});
var _user$project$InterfaceController$msgAskOpen = function (filename) {
	return _user$project$InterfaceController$requireSaveAsker(
		_user$project$InterfaceController$msgOpen(filename));
};
var _user$project$InterfaceController$msgAskImportCode = _user$project$InterfaceController$requireSaveAsker(_user$project$InterfaceController$msgImportCode);
var _user$project$InterfaceController$msgClearPreview = A2(
	_user$project$InterfaceModel$Msg,
	'Clear Preview',
	function (old) {
		return _elm_lang$core$Native_Utils.update(
			old,
			{preview: _elm_lang$core$Maybe$Nothing});
	});
var _user$project$InterfaceController$msgSelectOption = function (_p28) {
	var _p29 = _p28;
	var _p32 = _p29._1;
	var _p31 = _p29._0;
	var _p30 = _p29._3;
	return A2(
		_user$project$InterfaceModel$Msg,
		'Select Option...',
		function (old) {
			return _elm_lang$core$Native_Utils.update(
				old,
				{
					code: _p30,
					inputExp: _p31,
					inputVal: _p32,
					history: A3(
						_user$project$InterfaceModel$modelCommit,
						_p30,
						{ctor: '[]'},
						old.history),
					slate: _p29._2,
					preview: _elm_lang$core$Maybe$Nothing,
					synthesisResults: {ctor: '[]'},
					tool: _user$project$InterfaceModel$Cursor,
					liveSyncInfo: A2(
						_user$project$Utils$fromOk,
						'SelectOption mkLive',
						A6(
							_user$project$InterfaceModel$mkLive,
							old.syncOptions,
							old.slideNumber,
							old.movieNumber,
							old.movieTime,
							_p31,
							{
								ctor: '_Tuple2',
								_0: _p32,
								_1: {ctor: '[]'}
							}))
				});
		});
};
var _user$project$InterfaceController$showExpPreview = F2(
	function (old, exp) {
		var code = _user$project$LangUnparser$unparse(exp);
		var _p33 = A2(_user$project$InterfaceModel$runAndResolve, old, exp);
		if (_p33.ctor === 'Ok') {
			return _elm_lang$core$Native_Utils.update(
				old,
				{
					preview: _elm_lang$core$Maybe$Just(
						{
							ctor: '_Tuple2',
							_0: code,
							_1: _elm_lang$core$Result$Ok(
								{ctor: '_Tuple3', _0: _p33._0._0, _1: _p33._0._1, _2: _p33._0._2})
						})
				});
		} else {
			return _elm_lang$core$Native_Utils.update(
				old,
				{
					preview: _elm_lang$core$Maybe$Just(
						{
							ctor: '_Tuple2',
							_0: code,
							_1: _elm_lang$core$Result$Err(_p33._0)
						})
				});
		}
	});
var _user$project$InterfaceController$showCodePreview = F2(
	function (old, code) {
		var _p34 = _user$project$FastParser$parseE(code);
		if (_p34.ctor === 'Ok') {
			return A2(_user$project$InterfaceController$showExpPreview, old, _p34._0);
		} else {
			return _elm_lang$core$Native_Utils.update(
				old,
				{
					preview: _elm_lang$core$Maybe$Just(
						{
							ctor: '_Tuple2',
							_0: code,
							_1: _elm_lang$core$Result$Err(
								_user$project$FastParser$showError(_p34._0))
						})
				});
		}
	});
var _user$project$InterfaceController$msgPreview = function (expOrCode) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Preview',
		function (old) {
			var _p35 = expOrCode;
			if (_p35.ctor === 'Left') {
				return A2(_user$project$InterfaceController$showExpPreview, old, _p35._0);
			} else {
				return A2(_user$project$InterfaceController$showCodePreview, old, _p35._0);
			}
		});
};
var _user$project$InterfaceController$msgPauseResumeMovie = A2(
	_user$project$InterfaceModel$Msg,
	'Pause/Resume Movie',
	function (old) {
		return _elm_lang$core$Native_Utils.update(
			old,
			{runAnimation: !old.runAnimation});
	});
var _user$project$InterfaceController$msgRedraw = A2(
	_user$project$InterfaceModel$Msg,
	'Redraw',
	function (old) {
		var _p36 = A4(_user$project$LangSvg$fetchEverything, old.slideNumber, old.movieNumber, old.movieTime, old.inputVal);
		if (_p36.ctor === 'Ok') {
			return _elm_lang$core$Native_Utils.update(
				old,
				{slideCount: _p36._0._0, movieCount: _p36._0._1, movieDuration: _p36._0._2, movieContinue: _p36._0._3, slate: _p36._0._4});
		} else {
			return _elm_lang$core$Native_Utils.update(
				old,
				{
					errorBox: _elm_lang$core$Maybe$Just(_p36._0)
				});
		}
	});
var _user$project$InterfaceController$msgSetLiveSyncDelay = function (b) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Set Live',
		function (m) {
			return _elm_lang$core$Native_Utils.update(
				m,
				{liveSyncDelay: b});
		});
};
var _user$project$InterfaceController$updateHeuristics = F2(
	function (heuristic, old) {
		var oldSyncOptions = old.syncOptions;
		var newSyncOptions = _elm_lang$core$Native_Utils.update(
			oldSyncOptions,
			{feelingLucky: heuristic});
		var _p37 = old.outputMode;
		if (_p37.ctor === 'Live') {
			var _p38 = A6(
				_user$project$InterfaceModel$mkLive,
				newSyncOptions,
				old.slideNumber,
				old.movieNumber,
				old.movieTime,
				old.inputExp,
				{ctor: '_Tuple2', _0: old.inputVal, _1: old.widgets});
			if (_p38.ctor === 'Ok') {
				return _elm_lang$core$Native_Utils.update(
					old,
					{syncOptions: newSyncOptions, liveSyncInfo: _p38._0});
			} else {
				return _elm_lang$core$Native_Utils.update(
					old,
					{
						syncOptions: newSyncOptions,
						errorBox: _elm_lang$core$Maybe$Just(_p38._0)
					});
			}
		} else {
			return _elm_lang$core$Native_Utils.update(
				old,
				{syncOptions: newSyncOptions});
		}
	});
var _user$project$InterfaceController$msgSetHeuristicsBiased = A2(
	_user$project$InterfaceModel$Msg,
	'Set Heuristics Biased',
	_user$project$InterfaceController$updateHeuristics(_user$project$Sync$heuristicsBiased));
var _user$project$InterfaceController$msgSetHeuristicsNone = A2(
	_user$project$InterfaceModel$Msg,
	'Set Heuristics None',
	_user$project$InterfaceController$updateHeuristics(_user$project$Sync$heuristicsNone));
var _user$project$InterfaceController$msgSetHeuristicsFair = A2(
	_user$project$InterfaceModel$Msg,
	'Set Heuristics Fair',
	_user$project$InterfaceController$updateHeuristics(_user$project$Sync$heuristicsFair));
var _user$project$InterfaceController$msgSetOutputPrint = A2(
	_user$project$InterfaceModel$Msg,
	'Set Output Print',
	function (old) {
		return _elm_lang$core$Native_Utils.update(
			old,
			{
				outputMode: _user$project$InterfaceModel$Print(
					A2(_user$project$LangSvg$printSvg, old.showGhosts, old.slate))
			});
	});
var _user$project$InterfaceController$msgSetOutputLive = A2(
	_user$project$InterfaceModel$Msg,
	'Set Output Live',
	function (old) {
		return _elm_lang$core$Native_Utils.update(
			old,
			{outputMode: _user$project$InterfaceModel$Live});
	});
var _user$project$InterfaceController$msgToggleCodeBox = A2(
	_user$project$InterfaceModel$Msg,
	'Toggle Code Box',
	function (old) {
		return _elm_lang$core$Native_Utils.update(
			old,
			{basicCodeBox: !old.basicCodeBox});
	});
var _user$project$InterfaceController$setAutoSynthesis = F2(
	function (shouldUseAutoSynthesis, old) {
		return _elm_lang$core$Native_Utils.update(
			old,
			{autoSynthesis: shouldUseAutoSynthesis});
	});
var _user$project$InterfaceController$msgStartAutoSynthesis = A2(
	_user$project$InterfaceModel$Msg,
	'Start Auto Synthesis',
	_user$project$InterfaceController$setAutoSynthesis(true));
var _user$project$InterfaceController$clearSynthesisResults = function (old) {
	return _elm_lang$core$Native_Utils.update(
		old,
		{
			preview: _elm_lang$core$Maybe$Nothing,
			synthesisResults: {ctor: '[]'}
		});
};
var _user$project$InterfaceController$msgClearSynthesisResults = A2(_user$project$InterfaceModel$Msg, 'Clear Synthesis Results', _user$project$InterfaceController$clearSynthesisResults);
var _user$project$InterfaceController$msgStopAutoSynthesisAndClear = A2(
	_user$project$InterfaceModel$Msg,
	'Stop Auto Synthesis and Clear',
	function (_p39) {
		return _user$project$InterfaceController$clearSynthesisResults(
			A2(_user$project$InterfaceController$setAutoSynthesis, false, _p39));
	});
var _user$project$InterfaceController$cleanSynthesisResult = function (_p40) {
	var _p41 = _p40;
	return _user$project$InterfaceModel$SynthesisResult(
		{
			description: A2(_elm_lang$core$Basics_ops['++'], _p41._0.description, ' -> Cleaned'),
			exp: _user$project$LangSimplify$cleanCode(_p41._0.exp),
			isSafe: _p41._0.isSafe,
			sortKey: _p41._0.sortKey,
			children: _p41._0.children
		});
};
var _user$project$InterfaceController$cleanDedupSortSynthesisResults = function (synthesisResults) {
	return A2(
		_elm_lang$core$List$sortBy,
		function (_p42) {
			var _p43 = _p42;
			return {
				ctor: '_Tuple3',
				_0: _user$project$LangTools$nodeCount(_p43._0.exp),
				_1: _p43._0.sortKey,
				_2: _p43._0.description
			};
		},
		A2(
			_user$project$Utils$dedupBy,
			function (_p44) {
				var _p45 = _p44;
				return _user$project$LangUnparser$unparse(_p45._0.exp);
			},
			A2(_elm_lang$core$List$map, _user$project$InterfaceController$cleanSynthesisResult, synthesisResults)));
};
var _user$project$InterfaceController$maybeRunAutoSynthesis = F2(
	function (m, e) {
		return m.autoSynthesis ? _user$project$InterfaceController$cleanDedupSortSynthesisResults(
			_user$project$ExpressionBasedTransform$passiveSynthesisSearch(e)) : {ctor: '[]'};
	});
var _user$project$InterfaceController$doMakeEqual = function (old) {
	var synthesisResults = A6(_user$project$ValueBasedTransform$makeEqual, old.inputExp, old.selectedFeatures, old.slideNumber, old.movieNumber, old.movieTime, old.syncOptions);
	return _elm_lang$core$Native_Utils.update(
		old,
		{
			synthesisResults: _user$project$InterfaceController$cleanDedupSortSynthesisResults(synthesisResults)
		});
};
var _user$project$InterfaceController$msgMakeEqual = A2(_user$project$InterfaceModel$Msg, 'Make Equal', _user$project$InterfaceController$doMakeEqual);
var _user$project$InterfaceController$msgRelate = A2(
	_user$project$InterfaceModel$Msg,
	'Relate',
	function (old) {
		var synthesisResults = A6(_user$project$ValueBasedTransform$relate, old.inputExp, old.selectedFeatures, old.slideNumber, old.movieNumber, old.movieTime, old.syncOptions);
		return _elm_lang$core$Native_Utils.update(
			old,
			{
				synthesisResults: _user$project$InterfaceController$cleanDedupSortSynthesisResults(synthesisResults)
			});
	});
var _user$project$InterfaceController$msgIndexedRelate = A2(
	_user$project$InterfaceModel$Msg,
	'Indexed Relate',
	function (old) {
		var synthesisResults = A7(_user$project$ValueBasedTransform$indexedRelate, old.inputExp, old.selectedFeatures, old.selectedShapes, old.slideNumber, old.movieNumber, old.movieTime, old.syncOptions);
		return _elm_lang$core$Native_Utils.update(
			old,
			{
				synthesisResults: _user$project$InterfaceController$cleanDedupSortSynthesisResults(synthesisResults)
			});
	});
var _user$project$InterfaceController$msgHoverSynthesisResult = function (pathByIndices) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Hover SynthesisResult',
		function (old) {
			var maybeFindResult = F2(
				function (path, results) {
					var _p46 = path;
					if (_p46.ctor === '[]') {
						return _elm_lang$core$Maybe$Nothing;
					} else {
						if (_p46._1.ctor === '[]') {
							return A2(_user$project$Utils$maybeGeti0, _p46._0, results);
						} else {
							return A2(
								_elm_lang$core$Maybe$andThen,
								function (_p47) {
									var _p48 = _p47;
									return A2(
										_elm_lang$core$Maybe$andThen,
										maybeFindResult(_p46._1),
										_p48._0.children);
								},
								A2(_user$project$Utils$maybeGeti0, _p46._0, results));
						}
					}
				});
			var setResultChildren = F3(
				function (path, childResults, oldResults) {
					var _p49 = path;
					if (_p49.ctor === '[]') {
						return oldResults;
					} else {
						if (_p49._1.ctor === '[]') {
							return A3(
								_user$project$Utils$getReplacei0,
								_p49._0,
								function (_p50) {
									var _p51 = _p50;
									return _user$project$InterfaceModel$SynthesisResult(
										_elm_lang$core$Native_Utils.update(
											_p51._0,
											{
												children: _elm_lang$core$Maybe$Just(childResults)
											}));
								},
								oldResults);
						} else {
							return A3(
								_user$project$Utils$getReplacei0,
								_p49._0,
								function (_p52) {
									var _p53 = _p52;
									var _p54 = _p53._0;
									return _user$project$InterfaceModel$SynthesisResult(
										_elm_lang$core$Native_Utils.update(
											_p54,
											{
												children: _elm_lang$core$Maybe$Just(
													A3(
														setResultChildren,
														_p49._1,
														childResults,
														A2(
															_elm_lang$core$Maybe$withDefault,
															{ctor: '[]'},
															_p54.children)))
											}));
								},
								oldResults);
						}
					}
				});
			var _p55 = A2(maybeFindResult, pathByIndices, old.synthesisResults);
			if (_p55.ctor === 'Just') {
				var _p57 = _p55._0._0.exp;
				var newModel = _elm_lang$core$Native_Utils.update(
					old,
					{hoveredSynthesisResultPathByIndices: pathByIndices});
				var newModel2 = function () {
					var _p56 = {ctor: '_Tuple2', _0: old.autoSynthesis, _1: _p55._0._0.children};
					_v27_2:
					do {
						if (_p56.ctor === '_Tuple2') {
							if (_p56._1.ctor === 'Just') {
								return newModel;
							} else {
								if (_p56._0 === false) {
									return newModel;
								} else {
									break _v27_2;
								}
							}
						} else {
							break _v27_2;
						}
					} while(false);
					var childResults = _user$project$InterfaceController$cleanDedupSortSynthesisResults(
						_user$project$ExpressionBasedTransform$passiveSynthesisSearch(_p57));
					var newTopLevelResults = A3(setResultChildren, pathByIndices, childResults, old.synthesisResults);
					return _elm_lang$core$Native_Utils.update(
						newModel,
						{synthesisResults: newTopLevelResults, hoveredSynthesisResultPathByIndices: pathByIndices});
				}();
				return A2(_user$project$InterfaceController$showExpPreview, newModel2, _p57);
			} else {
				return _elm_lang$core$Native_Utils.update(
					old,
					{
						preview: _elm_lang$core$Maybe$Nothing,
						hoveredSynthesisResultPathByIndices: {ctor: '[]'}
					});
			}
		});
};
var _user$project$InterfaceController$msgKeyUp = function (keyCode) {
	return A2(
		_user$project$InterfaceModel$Msg,
		A2(
			_elm_lang$core$Basics_ops['++'],
			'Key Up ',
			_elm_lang$core$Basics$toString(keyCode)),
		function (old) {
			return _user$project$Keys$isCommandKey(keyCode) ? _elm_lang$core$Native_Utils.update(
				old,
				{
					keysDown: A2(
						_elm_lang$core$List$filter,
						F2(
							function (x, y) {
								return _elm_lang$core$Native_Utils.eq(x, y);
							})(_user$project$Keys$keyShift),
						old.keysDown)
				}) : _elm_lang$core$Native_Utils.update(
				old,
				{
					keysDown: A2(_user$project$Utils$removeAsSet, keyCode, old.keysDown)
				});
		});
};
var _user$project$InterfaceController$msgKeyPress = function (keyCode) {
	return A2(
		_user$project$InterfaceModel$Msg,
		A2(
			_elm_lang$core$Basics_ops['++'],
			'Key Press ',
			_elm_lang$core$Basics$toString(keyCode)),
		function (old) {
			return old;
		});
};
var _user$project$InterfaceController$isKeyDown = F2(
	function (keyCode, model) {
		return A2(_elm_lang$core$List$member, keyCode, model.keysDown);
	});
var _user$project$InterfaceController$refreshInputExp = function (old) {
	var parseResult = _user$project$FastParser$parseE(old.code);
	var _p58 = function () {
		var _p59 = parseResult;
		if (_p59.ctor === 'Ok') {
			return {ctor: '_Tuple2', _0: _p59._0, _1: true};
		} else {
			return {ctor: '_Tuple2', _0: old.inputExp, _1: false};
		}
	}();
	var newInputExp = _p58._0;
	var codeClean = _p58._1;
	return _elm_lang$core$Native_Utils.update(
		old,
		{inputExp: newInputExp, codeClean: codeClean});
};
var _user$project$InterfaceController$msgSetSelectedDeuceTool = F2(
	function (useTextSelect, cachedDeuceTool) {
		var maybeTextSelect = useTextSelect ? function (_p60) {
			return A2(
				_user$project$InterfaceController$textSelect,
				false,
				_user$project$InterfaceController$refreshInputExp(_p60));
		} : _elm_lang$core$Basics$identity;
		var selectedDeuceToolUpdater = function (model) {
			return _elm_lang$core$Native_Utils.update(
				model,
				{
					selectedDeuceTool: _elm_lang$core$Maybe$Just(cachedDeuceTool),
					deuceRightClickMenuMode: _elm_lang$core$Maybe$Nothing
				});
		};
		return A2(
			_user$project$InterfaceModel$Msg,
			A2(
				_elm_lang$core$Basics_ops['++'],
				'Set Selected Deuce Tool ',
				_elm_lang$core$Basics$toString(
					function (_) {
						return _.name;
					}(
						_user$project$Utils$fst3(cachedDeuceTool)))),
			function (_p61) {
				return maybeTextSelect(
					selectedDeuceToolUpdater(_p61));
			});
	});
var _user$project$InterfaceController$msgDeuceRightClick = function (menuMode) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Deuce Right Click',
		function (model) {
			if (model.enableDeuceTextSelection && _user$project$InterfaceModel$noWidgetsSelected(model)) {
				var modelAfterTextSelection = A2(
					_user$project$InterfaceController$textSelect,
					true,
					_user$project$InterfaceController$refreshInputExp(model));
				if (_user$project$InterfaceModel$noWidgetsSelected(modelAfterTextSelection)) {
					return model;
				} else {
					var _p62 = A2(_user$project$UserStudyLog$log, 'Showing Right Click Menu', '');
					return A4(_user$project$InterfaceModel$showDeuceRightClickMenu, _user$project$SleekLayout$deuceRightClickMenuMouseOffset.x, _user$project$SleekLayout$deuceRightClickMenuMouseOffset.y, menuMode, modelAfterTextSelection);
				}
			} else {
				return model;
			}
		});
};
var _user$project$InterfaceController$resetDeucePopupPanelPosition = function (m) {
	var oldPopupPanelPositions = m.popupPanelPositions;
	var newPopupPanelPositions = _elm_lang$core$Native_Utils.update(
		oldPopupPanelPositions,
		{
			deuce: {ctor: '_Tuple2', _0: 400, _1: 400}
		});
	return _elm_lang$core$Native_Utils.update(
		m,
		{popupPanelPositions: newPopupPanelPositions});
};
var _user$project$InterfaceController$msgUserHasTyped = A2(
	_user$project$InterfaceModel$Msg,
	'User Has Typed',
	function (model) {
		return _elm_lang$core$Native_Utils.update(
			model,
			{deuceState: _user$project$DeuceWidgets$emptyDeuceState});
	});
var _user$project$InterfaceController$msgAceUpdate = function (aceCodeBoxInfo) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Ace Update',
		function (old) {
			if (!_elm_lang$core$Native_Utils.eq(old.preview, _elm_lang$core$Maybe$Nothing)) {
				return old;
			} else {
				var needsSave = !_elm_lang$core$Native_Utils.eq(
					old.lastSaveState,
					_elm_lang$core$Maybe$Just(aceCodeBoxInfo.code));
				return _elm_lang$core$Native_Utils.update(
					old,
					{code: aceCodeBoxInfo.code, codeBoxInfo: aceCodeBoxInfo.codeBoxInfo, needsSave: needsSave});
			}
		});
};
var _user$project$InterfaceController$msgVisibilityChange = function (visibility) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Visibility Change',
		function (model) {
			var _p63 = visibility;
			if (_p63.ctor === 'Visible') {
				return model;
			} else {
				return _elm_lang$core$Native_Utils.update(
					model,
					{
						keysDown: {ctor: '[]'}
					});
			}
		});
};
var _user$project$InterfaceController$msgCodeUpdate = function (s) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Code Update',
		function (old) {
			return _elm_lang$core$Native_Utils.update(
				old,
				{code: s});
		});
};
var _user$project$InterfaceController$msgWindowDimensions = function (wh) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Window Dimensions',
		function (old) {
			return _elm_lang$core$Native_Utils.update(
				old,
				{dimensions: wh});
		});
};
var _user$project$InterfaceController$msgNoop = A2(_user$project$InterfaceModel$Msg, 'Noop', _elm_lang$core$Basics$identity);
var _user$project$InterfaceController$iconCommand = function (filename) {
	var potentialIconName = A2(_elm_lang$core$String$dropLeft, 6, filename);
	return A2(_elm_lang$core$List$member, potentialIconName, _user$project$InterfaceModel$iconNames) ? {
		ctor: '::',
		_0: _user$project$FileHandler$requestIcon(potentialIconName),
		_1: {ctor: '[]'}
	} : {ctor: '[]'};
};
var _user$project$InterfaceController$issueCommand = F3(
	function (_p64, oldModel, newModel) {
		var _p65 = _p64;
		var _p67 = _p65._0;
		var _p66 = _p67;
		switch (_p66) {
			case 'Toggle Code Box':
				return newModel.basicCodeBox ? _elm_lang$core$Platform_Cmd$none : _user$project$AceCodeBox$initializeAndDisplay(newModel);
			case 'Save As':
				return (!_elm_lang$core$Native_Utils.eq(newModel.filename, _user$project$InterfaceModel$bufferName)) ? _user$project$FileHandler$write(
					_user$project$InterfaceModel$getFile(newModel)) : _elm_lang$core$Platform_Cmd$none;
			case 'Save':
				return (!_elm_lang$core$Native_Utils.eq(newModel.filename, _user$project$InterfaceModel$bufferName)) ? _user$project$FileHandler$write(
					_user$project$InterfaceModel$getFile(newModel)) : _user$project$FileHandler$requestFileIndex(
					{ctor: '_Tuple0'});
			case 'Confirm Write':
				return _elm_lang$core$Platform_Cmd$batch(
					_user$project$InterfaceController$iconCommand(newModel.filename));
			case 'Open':
				return _user$project$FileHandler$requestFile(newModel.filename);
			case 'Delete':
				return _user$project$FileHandler$delete(newModel.fileToDelete);
			case 'Confirm Delete':
				return _elm_lang$core$Platform_Cmd$batch(
					_user$project$InterfaceController$iconCommand(newModel.fileToDelete));
			case 'Export Code':
				return _user$project$FileHandler$download(
					{
						filename: A2(
							_elm_lang$core$Basics_ops['++'],
							_user$project$InterfaceModel$prettyFilename(newModel),
							'.little'),
						text: newModel.code
					});
			case 'Export SVG':
				return _user$project$FileHandler$download(
					{
						filename: A2(
							_elm_lang$core$Basics_ops['++'],
							_user$project$InterfaceModel$prettyFilename(newModel),
							'.svg'),
						text: A2(_user$project$LangSvg$printSvg, newModel.showGhosts, newModel.slate)
					});
			case 'Import Code':
				return _user$project$FileHandler$requestFileFromInput(_user$project$InterfaceModel$importCodeFileInputId);
			case 'Ace Update':
				return (newModel.autosave && newModel.needsSave) ? _user$project$FileHandler$write(
					_user$project$InterfaceModel$getFile(newModel)) : _elm_lang$core$Platform_Cmd$none;
			case 'Enable Text Edits':
				return _user$project$AceCodeBox$setReadOnly(false);
			case 'Disable Text Edits':
				return _user$project$AceCodeBox$setReadOnly(true);
			default:
				return _elm_lang$core$Platform_Cmd$batch(
					{
						ctor: '::',
						_0: _elm_lang$core$Native_Utils.eq(_p67, 'Update Font Size') ? _user$project$AceCodeBox$updateFontSize(newModel) : (((!_elm_lang$core$Native_Utils.eq(newModel.code, oldModel.code)) || ((!_elm_lang$core$Native_Utils.eq(newModel.codeBoxInfo, oldModel.codeBoxInfo)) || ((!_elm_lang$core$Native_Utils.eq(newModel.preview, oldModel.preview)) || (_elm_lang$core$Native_Utils.eq(_p67, 'Turn Off Caption') || (_elm_lang$core$Native_Utils.eq(_p67, 'Mouse Enter CodeBox') || _elm_lang$core$Native_Utils.eq(_p67, 'Mouse Leave CodeBox')))))) ? _user$project$AceCodeBox$display(newModel) : (_elm_lang$core$Native_Utils.eq(_p67, 'Drag Layout Widget Trigger') ? _user$project$AceCodeBox$resize(newModel) : ((_elm_lang$core$Native_Utils.eq(_p67, 'Toggle Output') && _elm_lang$core$Native_Utils.eq(
							newModel.outputMode,
							_user$project$InterfaceModel$PrintScopeGraph(_elm_lang$core$Maybe$Nothing))) ? _user$project$DependenceGraph$render(newModel.scopeGraph) : (newModel.runAnimation ? _user$project$AnimationLoop$requestFrame(
							{ctor: '_Tuple0'}) : _elm_lang$core$Platform_Cmd$none)))),
						_1: {
							ctor: '::',
							_0: A2(_elm_lang$core$String$startsWith, 'New', _p67) ? _user$project$AceCodeBox$resetScroll(newModel) : _elm_lang$core$Platform_Cmd$none,
							_1: {
								ctor: '::',
								_0: A2(_elm_lang$core$String$startsWith, 'msgMouseClickDeuceWidget', _p67) ? _user$project$DeucePopupPanelInfo$requestDeucePopupPanelInfo(
									{ctor: '_Tuple0'}) : _elm_lang$core$Platform_Cmd$none,
								_1: {
									ctor: '::',
									_0: A2(_elm_lang$core$String$startsWith, 'Open Dialog Box', _p67) ? _user$project$FileHandler$requestFileIndex(
										{ctor: '_Tuple0'}) : _elm_lang$core$Platform_Cmd$none,
									_1: {
										ctor: '::',
										_0: _elm_lang$core$Native_Utils.eq(_p67, 'Set Color Scheme') ? _user$project$ColorScheme$updateColorScheme(newModel.colorScheme) : _elm_lang$core$Platform_Cmd$none,
										_1: {ctor: '[]'}
									}
								}
							}
						}
					});
		}
	});
var _user$project$InterfaceController$updateCommands = function (model) {
	var ifNeedsUpdate = F2(
		function (get, f) {
			var up = get(model);
			return _user$project$Updatable$needsUpdate(up) ? {
				ctor: '::',
				_0: f(
					_user$project$Updatable$extract(up)),
				_1: {ctor: '[]'}
			} : {ctor: '[]'};
		});
	return _elm_lang$core$List$concat(
		{
			ctor: '::',
			_0: A2(
				ifNeedsUpdate,
				function (_) {
					return _.enableTextEdits;
				},
				function (_p68) {
					return _user$project$AceCodeBox$setReadOnly(!_p68);
				}),
			_1: {
				ctor: '::',
				_0: A2(
					ifNeedsUpdate,
					function (_) {
						return _.prose;
					},
					function (_p69) {
						return _user$project$ProseScroller$resetProseScroll(
							A2(
								_elm_lang$core$Basics$always,
								{ctor: '_Tuple0'},
								_p69));
					}),
				_1: {ctor: '[]'}
			}
		});
};
var _user$project$InterfaceController$debugModel = F3(
	function (get, old, $new) {
		var returnValue = {ctor: '_Tuple2', _0: $new, _1: _elm_lang$core$Platform_Cmd$none};
		var newProperty = get($new);
		var oldProperty = get(old);
		if (!_elm_lang$core$Native_Utils.eq(oldProperty, newProperty)) {
			var _p70 = A2(_elm_lang$core$Debug$log, '', newProperty);
			return returnValue;
		} else {
			return returnValue;
		}
	});
var _user$project$InterfaceController$handleSavedSelectionsHook = F2(
	function (oldModel, newModel) {
		if (_elm_lang$core$Native_Utils.eq(oldModel.preview, _elm_lang$core$Maybe$Nothing) && (!_elm_lang$core$Native_Utils.eq(newModel.preview, _elm_lang$core$Maybe$Nothing))) {
			return {
				ctor: '_Tuple2',
				_0: _elm_lang$core$Native_Utils.update(
					newModel,
					{
						savedSelections: _elm_lang$core$Maybe$Just(newModel.codeBoxInfo.selections)
					}),
				_1: _elm_lang$core$Platform_Cmd$none
			};
		} else {
			if ((!_elm_lang$core$Native_Utils.eq(oldModel.preview, _elm_lang$core$Maybe$Nothing)) && _elm_lang$core$Native_Utils.eq(newModel.preview, _elm_lang$core$Maybe$Nothing)) {
				var _p71 = newModel.savedSelections;
				if (_p71.ctor === 'Just') {
					return {
						ctor: '_Tuple2',
						_0: _elm_lang$core$Native_Utils.update(
							newModel,
							{savedSelections: _elm_lang$core$Maybe$Nothing}),
						_1: _user$project$AceCodeBox$setSelections(_p71._0)
					};
				} else {
					return {ctor: '_Tuple2', _0: newModel, _1: _elm_lang$core$Platform_Cmd$none};
				}
			} else {
				return {ctor: '_Tuple2', _0: newModel, _1: _elm_lang$core$Platform_Cmd$none};
			}
		}
	});
var _user$project$InterfaceController$hooks = {
	ctor: '::',
	_0: _user$project$InterfaceController$handleSavedSelectionsHook,
	_1: {ctor: '[]'}
};
var _user$project$InterfaceController$applyAllHooks = F2(
	function (oldModel, newModel) {
		return A3(
			_elm_lang$core$List$foldl,
			F2(
				function (f, _p72) {
					var _p73 = _p72;
					return A2(
						_elm_lang$core$Tuple$mapSecond,
						A2(
							_elm_lang$core$Basics$flip,
							F2(
								function (x, y) {
									return {ctor: '::', _0: x, _1: y};
								}),
							_p73._1),
						A2(f, oldModel, _p73._0));
				}),
			{
				ctor: '_Tuple2',
				_0: newModel,
				_1: {ctor: '[]'}
			},
			_user$project$InterfaceController$hooks);
	});
var _user$project$InterfaceController$onClickPrimaryZone = F4(
	function (i, k, z, old) {
		var realZone = _user$project$ShapeWidgets$parseZone(z);
		var hoveredCrosshairs_ = function () {
			var _p74 = A2(_user$project$ShapeWidgets$zoneToCrosshair, k, realZone);
			if ((_p74.ctor === 'Just') && (_p74._0.ctor === '_Tuple2')) {
				return A2(
					_elm_lang$core$Set$insert,
					{ctor: '_Tuple3', _0: i, _1: _p74._0._0, _2: _p74._0._1},
					old.hoveredCrosshairs);
			} else {
				return old.hoveredCrosshairs;
			}
		}();
		var _p75 = function () {
			if (_elm_lang$core$Native_Utils.cmp(i, -2) < 0) {
				if (_elm_lang$core$Native_Utils.eq(z, 'Offset1D')) {
					var update = A2(
						_elm_lang$core$Set$member,
						{ctor: '_Tuple2', _0: i, _1: 'offset'},
						old.selectedFeatures) ? _elm_lang$core$Set$remove : _elm_lang$core$Set$insert;
					return {
						ctor: '_Tuple3',
						_0: A2(
							update,
							{ctor: '_Tuple2', _0: i, _1: 'offset'},
							old.selectedFeatures),
						_1: old.selectedShapes,
						_2: old.selectedBlobs
					};
				} else {
					return {ctor: '_Tuple3', _0: old.selectedFeatures, _1: old.selectedShapes, _2: old.selectedBlobs};
				}
			} else {
				var selectThisShape = function (_p76) {
					var _p77 = _p76;
					return A2(
						_elm_lang$core$Set$insert,
						i,
						_elm_lang$core$Native_Utils.eq(
							old.keysDown,
							{
								ctor: '::',
								_0: _user$project$Keys$keyShift,
								_1: {ctor: '[]'}
							}) ? old.selectedShapes : _elm_lang$core$Set$empty);
				};
				var selectBlob = function (blobId) {
					return A3(
						_elm_lang$core$Dict$insert,
						blobId,
						i,
						_elm_lang$core$Native_Utils.eq(
							old.keysDown,
							{
								ctor: '::',
								_0: _user$project$Keys$keyShift,
								_1: {ctor: '[]'}
							}) ? old.selectedBlobs : _elm_lang$core$Dict$empty);
				};
				var maybeBlobId = function () {
					var _p78 = A2(
						_elm_lang$core$Dict$get,
						i,
						_elm_lang$core$Tuple$second(old.slate));
					if ((_p78.ctor === 'Just') && (_p78._0.ctor === 'SvgNode')) {
						return _user$project$LangSvg$maybeFindBlobId(_p78._0._1);
					} else {
						return _elm_lang$core$Native_Utils.crashCase(
							'InterfaceController',
							{
								start: {line: 367, column: 9},
								end: {line: 369, column: 75}
							},
							_p78)('onClickPrimaryZone');
					}
				}();
				var _p80 = {ctor: '_Tuple3', _0: k, _1: realZone, _2: maybeBlobId};
				_v37_4:
				do {
					if (_p80.ctor === '_Tuple3') {
						if (_p80._2.ctor === 'Just') {
							switch (_p80._1.ctor) {
								case 'ZLineEdge':
									if (_p80._0 === 'line') {
										return {
											ctor: '_Tuple3',
											_0: old.selectedFeatures,
											_1: selectThisShape(
												{ctor: '_Tuple0'}),
											_2: selectBlob(_p80._2._0)
										};
									} else {
										break _v37_4;
									}
								case 'ZInterior':
									return {
										ctor: '_Tuple3',
										_0: old.selectedFeatures,
										_1: selectThisShape(
											{ctor: '_Tuple0'}),
										_2: selectBlob(_p80._2._0)
									};
								default:
									break _v37_4;
							}
						} else {
							switch (_p80._1.ctor) {
								case 'ZLineEdge':
									if (_p80._0 === 'line') {
										return {
											ctor: '_Tuple3',
											_0: old.selectedFeatures,
											_1: selectThisShape(
												{ctor: '_Tuple0'}),
											_2: old.selectedBlobs
										};
									} else {
										break _v37_4;
									}
								case 'ZInterior':
									return {
										ctor: '_Tuple3',
										_0: old.selectedFeatures,
										_1: selectThisShape(
											{ctor: '_Tuple0'}),
										_2: old.selectedBlobs
									};
								default:
									break _v37_4;
							}
						}
					} else {
						break _v37_4;
					}
				} while(false);
				return {ctor: '_Tuple3', _0: old.selectedFeatures, _1: old.selectedShapes, _2: old.selectedBlobs};
			}
		}();
		var selectedFeatures_ = _p75._0;
		var selectedShapes_ = _p75._1;
		var selectedBlobs_ = _p75._2;
		return _elm_lang$core$Native_Utils.update(
			old,
			{hoveredCrosshairs: hoveredCrosshairs_, selectedFeatures: selectedFeatures_, selectedShapes: selectedShapes_, selectedBlobs: selectedBlobs_});
	});
var _user$project$InterfaceController$rewriteInnerMostExpToMain = function (exp) {
	rewriteInnerMostExpToMain:
	while (true) {
		var _p81 = exp.val.e__;
		switch (_p81.ctor) {
			case 'EComment':
				var _v39 = _p81._2;
				exp = _v39;
				continue rewriteInnerMostExpToMain;
			case 'EOption':
				var _v40 = _p81._4;
				exp = _v40;
				continue rewriteInnerMostExpToMain;
			case 'ETyp':
				var _v41 = _p81._3;
				exp = _v41;
				continue rewriteInnerMostExpToMain;
			case 'ETypeAlias':
				var _v42 = _p81._3;
				exp = _v42;
				continue rewriteInnerMostExpToMain;
			case 'ELet':
				return A2(
					_user$project$Lang$replaceE__,
					exp,
					A7(
						_user$project$Lang$ELet,
						_p81._0,
						_p81._1,
						_p81._2,
						_p81._3,
						_p81._4,
						_user$project$InterfaceController$rewriteInnerMostExpToMain(_p81._5),
						_p81._6));
			default:
				return A2(
					_user$project$Lang$eLets,
					{
						ctor: '::',
						_0: {ctor: '_Tuple2', _0: 'main', _1: exp},
						_1: {ctor: '[]'}
					},
					_user$project$Lang$eVar('main'));
		}
	}
};
var _user$project$InterfaceController$switchToCursorTool = function (old) {
	return _elm_lang$core$Native_Utils.update(
		old,
		{mouseMode: _user$project$InterfaceModel$MouseNothing, tool: _user$project$InterfaceModel$Cursor});
};
var _user$project$InterfaceController$updateCodeBoxWithParseError = F2(
	function (annot, codeBoxInfo) {
		return _elm_lang$core$Native_Utils.update(
			codeBoxInfo,
			{
				annotations: {
					ctor: '::',
					_0: annot,
					_1: {ctor: '[]'}
				},
				highlights: {ctor: '[]'},
				tooltips: {ctor: '[]'}
			});
	});
var _user$project$InterfaceController$updateCodeBoxInfo = F2(
	function (ati, m) {
		var codeBoxInfo = m.codeBoxInfo;
		return _elm_lang$core$Native_Utils.update(
			codeBoxInfo,
			{annotations: ati.annotations, highlights: ati.highlights, tooltips: ati.tooltips});
	});
var _user$project$InterfaceController$handleError = F2(
	function (oldModel, result) {
		var _p82 = result;
		if (_p82.ctor === 'Ok') {
			return _p82._0;
		} else {
			return _elm_lang$core$Native_Utils.update(
				oldModel,
				{
					errorBox: _elm_lang$core$Maybe$Just(_p82._0)
				});
		}
	});
var _user$project$InterfaceController$applyTrigger = F5(
	function (zoneKey, trigger, _p84, _p83, old) {
		var _p85 = _p84;
		var _p92 = _p85._1;
		var _p91 = _p85._0;
		var _p86 = _p83;
		var dx = _elm_lang$core$Native_Utils.eq(old.keysDown, _user$project$Keys$y) ? 0 : (_p86._0 - _p91);
		var dy = _elm_lang$core$Native_Utils.eq(old.keysDown, _user$project$Keys$x) ? 0 : (_p86._1 - _p92);
		var _p87 = A2(
			trigger,
			{ctor: '_Tuple2', _0: _p91, _1: _p92},
			{ctor: '_Tuple2', _0: dx, _1: dy});
		var newExp = _p87._0;
		var highlights = _p87._1;
		var codeBoxInfo_ = function () {
			var codeBoxInfo = old.codeBoxInfo;
			return _elm_lang$core$Native_Utils.update(
				codeBoxInfo,
				{highlights: highlights});
		}();
		var dragInfo_ = {
			ctor: '_Tuple3',
			_0: trigger,
			_1: {ctor: '_Tuple2', _0: _p91, _1: _p92},
			_2: true
		};
		return A2(
			_user$project$InterfaceController$handleError,
			old,
			A2(
				_elm_lang$core$Result$andThen,
				function (_p88) {
					var _p89 = _p88;
					var _p90 = _p89._0;
					return A2(
						_elm_lang$core$Result$map,
						function (newSlate) {
							var newCode = _user$project$LangUnparser$unparse(newExp);
							return _elm_lang$core$Native_Utils.update(
								old,
								{
									code: newCode,
									lastRunCode: newCode,
									inputExp: newExp,
									inputVal: _p90,
									slate: newSlate,
									widgets: _p89._1,
									codeBoxInfo: codeBoxInfo_,
									mouseMode: A2(
										_user$project$InterfaceModel$MouseDragZone,
										zoneKey,
										_elm_lang$core$Maybe$Just(dragInfo_))
								});
						},
						A4(_user$project$LangSvg$resolveToIndexedTree, old.slideNumber, old.movieNumber, old.movieTime, _p90));
				},
				_user$project$Eval$run(newExp)));
	});
var _user$project$InterfaceController$onMouseDrag = F2(
	function (lastPosition, old) {
		var newPosition = _elm_lang$core$Tuple$second(old.mouseState);
		var _p93 = {ctor: '_Tuple2', _0: newPosition.x, _1: newPosition.y};
		var mx0 = _p93._0;
		var my0 = _p93._1;
		var _p94 = A2(_user$project$SleekLayout$clickToCanvasPoint, old, newPosition);
		var isOnCanvas = _p94._0;
		var mx = _p94._1._0;
		var my = _p94._1._1;
		var _p95 = A2(_user$project$SleekLayout$clickToCanvasPoint, old, lastPosition);
		var mxLast = _p95._1._0;
		var myLast = _p95._1._1;
		var _p96 = old.mouseMode;
		switch (_p96.ctor) {
			case 'MouseNothing':
				return old;
			case 'MouseDragLayoutWidget':
				return A2(
					_p96._0,
					{ctor: '_Tuple2', _0: mx0, _1: my0},
					old);
			case 'MouseDrag':
				return A3(_p96._0, lastPosition, newPosition, old);
			case 'MouseDragZone':
				if (_p96._1.ctor === 'Nothing') {
					return old;
				} else {
					var _p97 = old.liveSyncDelay;
					if (_p97 === false) {
						return A5(
							_user$project$InterfaceController$applyTrigger,
							_p96._0,
							_p96._1._0._0,
							{ctor: '_Tuple2', _0: _p96._1._0._1._0, _1: _p96._1._0._1._1},
							{ctor: '_Tuple2', _0: mx, _1: my},
							old);
					} else {
						return old;
					}
				}
			case 'MouseDrawNew':
				var _p98 = {ctor: '_Tuple2', _0: old.tool, _1: _p96._0};
				_v49_5:
				do {
					_v49_1:
					do {
						_v49_0:
						do {
							if (_p98.ctor === '_Tuple2') {
								switch (_p98._1.ctor) {
									case 'NoPointsYet':
										switch (_p98._0.ctor) {
											case 'Poly':
												break _v49_0;
											case 'Path':
												break _v49_1;
											default:
												var pointOnCanvas = {
													ctor: '_Tuple2',
													_0: old.keysDown,
													_1: {ctor: '_Tuple2', _0: mx, _1: my}
												};
												var lastPointOnCanvas = {
													ctor: '_Tuple2',
													_0: old.keysDown,
													_1: {ctor: '_Tuple2', _0: mxLast, _1: myLast}
												};
												return _elm_lang$core$Native_Utils.update(
													old,
													{
														mouseMode: _user$project$InterfaceModel$MouseDrawNew(
															A2(_user$project$InterfaceModel$TwoPoints, pointOnCanvas, lastPointOnCanvas))
													});
										}
									case 'TwoPoints':
										switch (_p98._0.ctor) {
											case 'Poly':
												break _v49_0;
											case 'Path':
												break _v49_1;
											default:
												var pointOnCanvas = {
													ctor: '_Tuple2',
													_0: old.keysDown,
													_1: {ctor: '_Tuple2', _0: mx, _1: my}
												};
												return _elm_lang$core$Native_Utils.update(
													old,
													{
														mouseMode: _user$project$InterfaceModel$MouseDrawNew(
															A2(_user$project$InterfaceModel$TwoPoints, pointOnCanvas, _p98._1._1))
													});
										}
									case 'OffsetFromExisting':
										switch (_p98._0.ctor) {
											case 'Poly':
												break _v49_0;
											case 'Path':
												break _v49_1;
											default:
												return _elm_lang$core$Native_Utils.update(
													old,
													{
														mouseMode: _user$project$InterfaceModel$MouseDrawNew(
															A2(
																_user$project$InterfaceModel$OffsetFromExisting,
																{ctor: '_Tuple2', _0: mx, _1: my},
																_p98._1._1))
													});
										}
									default:
										switch (_p98._0.ctor) {
											case 'Poly':
												break _v49_0;
											case 'Path':
												break _v49_1;
											default:
												break _v49_5;
										}
								}
							} else {
								break _v49_5;
							}
						} while(false);
						return old;
					} while(false);
					return old;
				} while(false);
				return old;
			default:
				return old;
		}
	});
var _user$project$InterfaceController$msgMousePosition = function (pos_) {
	var deucePopupPanelPositionUpdater = function (old) {
		if (_user$project$InterfaceModel$noWidgetsSelected(old)) {
			var oldPopupPanelPositions = old.popupPanelPositions;
			var newDeucePopupPanelPosition = {ctor: '_Tuple2', _0: pos_.x + _user$project$SleekLayout$deucePopupPanelMouseOffset.x, _1: pos_.y + _user$project$SleekLayout$deucePopupPanelMouseOffset.y};
			var newPopupPanelPositions = _elm_lang$core$Native_Utils.update(
				oldPopupPanelPositions,
				{deuce: newDeucePopupPanelPosition});
			return _elm_lang$core$Native_Utils.update(
				old,
				{popupPanelPositions: newPopupPanelPositions});
		} else {
			return old;
		}
	};
	var mouseStateUpdater = function (old) {
		var _p99 = old.mouseState;
		if (_p99._0.ctor === 'Nothing') {
			return _elm_lang$core$Native_Utils.update(
				old,
				{
					mouseState: {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: pos_}
				});
		} else {
			return A2(
				_user$project$InterfaceController$onMouseDrag,
				_p99._1,
				_elm_lang$core$Native_Utils.update(
					old,
					{
						mouseState: {
							ctor: '_Tuple2',
							_0: _elm_lang$core$Maybe$Just(true),
							_1: pos_
						}
					}));
		}
	};
	return A2(
		_user$project$InterfaceModel$Msg,
		A2(
			_elm_lang$core$Basics_ops['++'],
			'MousePosition ',
			_elm_lang$core$Basics$toString(pos_)),
		function (_p100) {
			return deucePopupPanelPositionUpdater(
				mouseStateUpdater(_p100));
		});
};
var _user$project$InterfaceController$handleNew = function (template) {
	return function (_p101) {
		return A2(
			_user$project$InterfaceModel$closeDialogBox,
			_user$project$InterfaceModel$New,
			function (old) {
				var _p102 = A2(_user$project$Utils$maybeFind, template, _user$project$ExamplesGenerated$list);
				if (_p102.ctor === 'Nothing') {
					var _p103 = A2(_elm_lang$core$Debug$log, 'WARN: not found:', template);
					return old;
				} else {
					var _p104 = _p102._0._1(
						{ctor: '_Tuple0'});
					var e = _p104.e;
					var v = _p104.v;
					var ws = _p104.ws;
					var ati = _p104.ati;
					var so = A2(_user$project$Sync$syncOptionsOf, old.syncOptions, e);
					var outputMode = A2(
						_user$project$Utils$fromOk,
						'SelectExample mkLive',
						A6(
							_user$project$InterfaceModel$mkLive,
							so,
							old.slideNumber,
							old.movieNumber,
							old.movieTime,
							e,
							{ctor: '_Tuple2', _0: v, _1: ws}));
					return A2(
						_user$project$InterfaceController$handleError,
						old,
						A2(
							_elm_lang$core$Result$map,
							function (_p105) {
								var _p106 = _p105;
								var _p107 = _p106._2;
								var code = _user$project$LangUnparser$unparse(e);
								return _user$project$Prose$extractFromUserStudyTemplate(
									_user$project$InterfaceController$resetDeuceState(
										_elm_lang$core$Native_Utils.update(
											_user$project$InterfaceModel$initModel,
											{
												inputExp: e,
												inputVal: v,
												code: code,
												lastRunCode: code,
												history: _user$project$History$begin(
													{
														code: code,
														selectedDeuceWidgets: {ctor: '[]'}
													}),
												liveSyncInfo: outputMode,
												syncOptions: so,
												slideNumber: 1,
												slideCount: _p106._0,
												movieCount: _p106._1,
												movieTime: 0,
												movieDuration: _p107,
												movieContinue: _p106._3,
												runAnimation: _elm_lang$core$Native_Utils.cmp(_p107, 0) > 0,
												slate: _p106._4,
												widgets: ws,
												codeBoxInfo: A2(_user$project$InterfaceController$updateCodeBoxInfo, ati, old),
												filename: _user$project$InterfaceModel$bufferName,
												needsSave: true,
												lastSaveState: _elm_lang$core$Maybe$Nothing,
												scopeGraph: _user$project$DependenceGraph$compute(e),
												lastSelectedTemplate: _elm_lang$core$Maybe$Just(template),
												dimensions: old.dimensions,
												syncOptions: old.syncOptions,
												localSaves: old.localSaves,
												basicCodeBox: old.basicCodeBox,
												randomColor: old.randomColor,
												layoutOffsets: old.layoutOffsets,
												fileIndex: old.fileIndex,
												icons: old.icons,
												userStudyStateIndex: old.userStudyStateIndex,
												userStudyTaskCurrentTime: old.userStudyTaskCurrentTime,
												userStudyTaskStartTime: old.userStudyTaskCurrentTime,
												enableDeuceBoxSelection: old.enableDeuceBoxSelection,
												enableDeuceTextSelection: old.enableDeuceTextSelection,
												codeToolsMenuMode: old.codeToolsMenuMode,
												textSelectMode: old.textSelectMode,
												enableTextEdits: old.enableTextEdits,
												allowMultipleTargetPositions: old.allowMultipleTargetPositions,
												enableDomainSpecificCodeTools: old.enableDomainSpecificCodeTools,
												mainResizerX: old.mainResizerX,
												proseResizerY: old.proseResizerY,
												colorScheme: old.colorScheme
											})));
							},
							A4(_user$project$LangSvg$fetchEverything, old.slideNumber, old.movieNumber, old.movieTime, v)));
				}
			}(_p101));
	};
};
var _user$project$InterfaceController$msgNew = function (template) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'New',
		_user$project$InterfaceController$handleNew(template));
};
var _user$project$InterfaceController$msgAskNew = function (template) {
	return _user$project$InterfaceController$requireSaveAsker(
		_user$project$InterfaceController$msgNew(template));
};
var _user$project$InterfaceController$runWithErrorHandling = F3(
	function (model, exp, onOk) {
		var result = function () {
			var reparsedResult = A2(
				_elm_lang$core$Result$mapError,
				_user$project$FastParser$showError,
				_user$project$FastParser$parseE(
					_user$project$LangUnparser$unparse(exp)));
			return A2(
				_elm_lang$core$Result$andThen,
				function (reparsed) {
					return A2(
						_elm_lang$core$Result$map,
						function (_p108) {
							var _p109 = _p108;
							return A5(onOk, reparsed, _p109._0, _p109._1, _p109._2, _p109._3);
						},
						A2(_user$project$InterfaceModel$runAndResolve, model, reparsed));
				},
				reparsedResult);
		}();
		return A2(_user$project$InterfaceController$handleError, model, result);
	});
var _user$project$InterfaceController$discardErrorAnnotations = function (result) {
	return A2(
		_elm_lang$core$Result$mapError,
		function (_p110) {
			var _p111 = _p110;
			return _p111._0;
		},
		result);
};
var _user$project$InterfaceController$clearSelections = function (old) {
	return _elm_lang$core$Native_Utils.update(
		old,
		{selectedFeatures: _elm_lang$core$Set$empty, selectedShapes: _elm_lang$core$Set$empty, selectedBlobs: _elm_lang$core$Dict$empty});
};
var _user$project$InterfaceController$between1 = F2(
	function (i, _p112) {
		var _p113 = _p112;
		return A2(
			_user$project$Utils$between,
			i,
			{ctor: '_Tuple2', _0: _p113._0 + 1, _1: _p113._1 + 1});
	});
var _user$project$InterfaceController$refreshHighlights = F2(
	function (zoneKey, model) {
		var codeBoxInfo = model.codeBoxInfo;
		var hi = A2(_user$project$InterfaceModel$liveInfoToHighlights, zoneKey, model);
		return _elm_lang$core$Native_Utils.update(
			model,
			{
				codeBoxInfo: _elm_lang$core$Native_Utils.update(
					codeBoxInfo,
					{highlights: hi})
			});
	});
var _user$project$InterfaceController$refreshLiveInfo = function (m) {
	var _p114 = A6(
		_user$project$InterfaceModel$mkLive,
		m.syncOptions,
		m.slideNumber,
		m.movieNumber,
		m.movieTime,
		m.inputExp,
		{ctor: '_Tuple2', _0: m.inputVal, _1: m.widgets});
	if (_p114.ctor === 'Ok') {
		return _p114._0;
	} else {
		var _p115 = A2(
			_user$project$UserStudyLog$log,
			'refreshLiveInfo Error',
			_elm_lang$core$Basics$toString(_p114._0));
		return {
			initSubstPlus: _user$project$FastParser$substPlusOf(m.inputExp),
			triggers: _elm_lang$core$Dict$empty
		};
	}
};
var _user$project$InterfaceController$finishTrigger = F2(
	function (zoneKey, old) {
		var e = A2(
			_user$project$Utils$fromOkay,
			'onMouseUp',
			_user$project$FastParser$parseE(old.code));
		var old_ = _elm_lang$core$Native_Utils.update(
			old,
			{inputExp: e});
		return A2(
			_user$project$InterfaceController$refreshHighlights,
			zoneKey,
			_elm_lang$core$Native_Utils.update(
				old_,
				{
					mouseMode: _user$project$InterfaceModel$MouseNothing,
					liveSyncInfo: _user$project$InterfaceController$refreshLiveInfo(old_),
					history: A3(
						_user$project$InterfaceModel$modelCommit,
						old.code,
						{ctor: '[]'},
						old_.history)
				}));
	});
var _user$project$InterfaceController$tryRun = function (old) {
	var oldWithUpdatedHistory = function () {
		var updatedHistory = A3(
			_user$project$InterfaceModel$modelCommit,
			old.code,
			{ctor: '[]'},
			old.history);
		return _elm_lang$core$Native_Utils.update(
			old,
			{history: updatedHistory});
	}();
	var _p116 = _user$project$FastParser$parseE(old.code);
	if (_p116.ctor === 'Err') {
		return _elm_lang$core$Result$Err(
			{
				ctor: '_Tuple3',
				_0: oldWithUpdatedHistory,
				_1: _user$project$FastParser$showError(_p116._0),
				_2: _elm_lang$core$Maybe$Nothing
			});
	} else {
		var _p137 = _p116._0;
		var resultThunk = function (_p117) {
			var _p118 = _p117;
			var rewrittenE = _user$project$InterfaceController$rewriteInnerMostExpToMain(_p137);
			return A2(
				_elm_lang$core$Result$andThen,
				function (_p119) {
					var _p120 = _p119;
					var _p135 = _p120._0._0;
					var _p134 = _p120._1;
					return A2(
						_elm_lang$core$Result$map,
						function (_p121) {
							var _p122 = _p121;
							var _p133 = _p122._2;
							var newCode = _user$project$LangUnparser$unparse(_p137);
							var lambdaTools_ = function () {
								var program = _user$project$Blobs$splitExp(_p137);
								return A2(
									_elm_lang$core$Basics_ops['++'],
									A2(_user$project$Draw$lambdaToolOptionsOf, program, _p134),
									_user$project$InterfaceModel$initModel.lambdaTools);
							}();
							var $new = A2(
								_user$project$InterfaceController$loadLambdaToolIcons,
								_p134,
								_elm_lang$core$Native_Utils.update(
									old,
									{lambdaTools: lambdaTools_}));
							var new_ = _elm_lang$core$Native_Utils.update(
								$new,
								{
									inputExp: _p137,
									inputVal: _p135,
									code: newCode,
									lastRunCode: newCode,
									slideCount: _p122._0,
									movieCount: _p122._1,
									movieTime: 0,
									movieDuration: _p133,
									movieContinue: _p122._3,
									runAnimation: _elm_lang$core$Native_Utils.cmp(_p133, 0) > 0,
									slate: _p122._4,
									widgets: _p120._0._1,
									history: A3(
										_user$project$InterfaceModel$modelCommit,
										newCode,
										{ctor: '[]'},
										old.history),
									caption: _elm_lang$core$Maybe$Nothing,
									syncOptions: A2(_user$project$Sync$syncOptionsOf, old.syncOptions, _p137),
									lambdaTools: lambdaTools_,
									errorBox: _elm_lang$core$Maybe$Nothing,
									scopeGraph: _user$project$DependenceGraph$compute(_p137),
									preview: _elm_lang$core$Maybe$Nothing,
									synthesisResults: A2(_user$project$InterfaceController$maybeRunAutoSynthesis, old, _p137)
								});
							var taskProgressAnnotation = function () {
								var _p123 = A2(
									_elm_lang$core$List$map,
									_elm_lang$core$String$trimRight,
									A2(_elm_lang$core$String$split, '; The final program should look something like:\n', newCode));
								if (((_p123.ctor === '::') && (_p123._1.ctor === '::')) && (_p123._1._1.ctor === '[]')) {
									var normalize = function (str) {
										return A4(
											_elm_lang$core$Regex$replace,
											_elm_lang$core$Regex$All,
											_elm_lang$core$Regex$regex('[\\s\\(\\)\\[\\]]+'),
											function (_p124) {
												return '';
											},
											str);
									};
									var targetCode = normalize(
										A3(
											_user$project$Utils$stringReplace,
											';\n',
											'\n',
											A3(_user$project$Utils$stringReplace, '\n;', '\n', _p123._1._0)));
									var givenLines = A2(_elm_lang$core$String$split, '\n', _p123._0);
									var singleLineGoodness = A2(
										_elm_lang$core$List$map,
										function (givenLine) {
											return A2(_elm_lang$core$String$contains, givenLine, targetCode);
										},
										A2(_elm_lang$core$List$map, normalize, givenLines));
									var multiLineGoodness = function () {
										var targetCodeWithBeginEndMarkers = A2(
											_elm_lang$core$Basics_ops['++'],
											'BOC',
											A2(_elm_lang$core$Basics_ops['++'], targetCode, 'EOC'));
										var lineTriples = A3(
											_user$project$Utils$zip3,
											A2(
												_elm_lang$core$Basics_ops['++'],
												{
													ctor: '::',
													_0: '',
													_1: {
														ctor: '::',
														_0: 'BOC',
														_1: {ctor: '[]'}
													}
												},
												givenLines),
											A2(
												_elm_lang$core$Basics_ops['++'],
												{
													ctor: '::',
													_0: 'BOC',
													_1: {ctor: '[]'}
												},
												A2(
													_elm_lang$core$Basics_ops['++'],
													givenLines,
													{
														ctor: '::',
														_0: 'EOC',
														_1: {ctor: '[]'}
													})),
											A2(
												_elm_lang$core$Basics_ops['++'],
												givenLines,
												{
													ctor: '::',
													_0: 'EOC',
													_1: {
														ctor: '::',
														_0: '',
														_1: {ctor: '[]'}
													}
												}));
										var lineGoodnessTriples = A3(
											_user$project$Utils$zip3,
											A2(
												_elm_lang$core$Basics_ops['++'],
												{
													ctor: '::',
													_0: true,
													_1: {
														ctor: '::',
														_0: true,
														_1: {ctor: '[]'}
													}
												},
												singleLineGoodness),
											A2(
												_elm_lang$core$Basics_ops['++'],
												{
													ctor: '::',
													_0: true,
													_1: {ctor: '[]'}
												},
												A2(
													_elm_lang$core$Basics_ops['++'],
													singleLineGoodness,
													{
														ctor: '::',
														_0: true,
														_1: {ctor: '[]'}
													})),
											A2(
												_elm_lang$core$Basics_ops['++'],
												singleLineGoodness,
												{
													ctor: '::',
													_0: true,
													_1: {
														ctor: '::',
														_0: true,
														_1: {ctor: '[]'}
													}
												}));
										return A2(
											_elm_lang$core$List$map,
											function (_p125) {
												var _p126 = _p125;
												return (_p126._0._0 && (_p126._0._1 && _p126._0._2)) ? A2(
													_elm_lang$core$String$contains,
													normalize(
														A2(
															_elm_lang$core$Basics_ops['++'],
															_p126._1._0,
															A2(_elm_lang$core$Basics_ops['++'], _p126._1._1, _p126._1._2))),
													targetCodeWithBeginEndMarkers) : true;
											},
											A2(
												_user$project$Utils$dropLast,
												1,
												A2(
													_elm_lang$core$List$drop,
													1,
													A2(_user$project$Utils$zip, lineGoodnessTriples, lineTriples))));
									}();
									var singleLineAnnotataions = A2(
										_elm_lang$core$List$map,
										function (_p127) {
											var _p128 = _p127;
											return {row: _p128._0, type_: 'error', text: 'Does not match target code!'};
										},
										A2(
											_elm_lang$core$List$filter,
											function (_p129) {
												return !_elm_lang$core$Tuple$second(_p129);
											},
											_user$project$Utils$zipi0(singleLineGoodness)));
									var multiLineAnnotataions = A2(
										_elm_lang$core$List$map,
										function (_p130) {
											var _p131 = _p130;
											return {row: _p131._0, type_: 'error', text: 'Missing code or ordering problem!'};
										},
										A2(
											_elm_lang$core$List$filter,
											function (_p132) {
												return !_elm_lang$core$Tuple$second(_p132);
											},
											_user$project$Utils$zipi0(multiLineGoodness)));
									return {
										annotations: A2(_elm_lang$core$Basics_ops['++'], singleLineAnnotataions, multiLineAnnotataions),
										highlights: {ctor: '[]'},
										tooltips: {ctor: '[]'}
									};
								} else {
									return _user$project$Types$dummyAceTypeInfo;
								}
							}();
							return _user$project$InterfaceController$resetDeuceState(
								_elm_lang$core$Native_Utils.update(
									new_,
									{
										liveSyncInfo: _user$project$InterfaceController$refreshLiveInfo(new_),
										codeBoxInfo: A2(_user$project$InterfaceController$updateCodeBoxInfo, taskProgressAnnotation, new_)
									}));
						},
						A4(_user$project$LangSvg$fetchEverything, old.slideNumber, old.movieNumber, 0.0, _p135));
				},
				A2(_user$project$Eval$doEval, _user$project$Eval$initEnv, rewrittenE));
		};
		var _p136 = _user$project$ImpureGoodies$crashToError(resultThunk);
		if (_p136.ctor === 'Err') {
			return _elm_lang$core$Result$Err(
				{ctor: '_Tuple3', _0: oldWithUpdatedHistory, _1: _p136._0, _2: _elm_lang$core$Maybe$Nothing});
		} else {
			if (_p136._0.ctor === 'Err') {
				return _elm_lang$core$Result$Err(
					{ctor: '_Tuple3', _0: oldWithUpdatedHistory, _1: _p136._0._0, _2: _elm_lang$core$Maybe$Nothing});
			} else {
				return _elm_lang$core$Result$Ok(_p136._0._0);
			}
		}
	}
};
var _user$project$InterfaceController$upstateRun = function (old) {
	var _p138 = _user$project$InterfaceController$tryRun(old);
	if (_p138.ctor === 'Err') {
		if (_p138._0._2.ctor === 'Just') {
			return _elm_lang$core$Native_Utils.update(
				_p138._0._0,
				{
					errorBox: _elm_lang$core$Maybe$Just(_p138._0._1),
					codeBoxInfo: A2(_user$project$InterfaceController$updateCodeBoxWithParseError, _p138._0._2._0, old.codeBoxInfo)
				});
		} else {
			return _elm_lang$core$Native_Utils.update(
				_p138._0._0,
				{
					errorBox: _elm_lang$core$Maybe$Just(_p138._0._1)
				});
		}
	} else {
		return _p138._0;
	}
};
var _user$project$InterfaceController$onMouseClick = F2(
	function (click, old) {
		var _p139 = {ctor: '_Tuple2', _0: old.tool, _1: old.mouseMode};
		_v67_8:
		do {
			_v67_6:
			do {
				if (_p139.ctor === '_Tuple2') {
					switch (_p139._1.ctor) {
						case 'MouseDragZone':
							switch (_p139._0.ctor) {
								case 'Cursor':
									if (_p139._1._0.ctor === '_Tuple3') {
										if (_p139._1._1.ctor === 'Nothing') {
											return A4(
												_user$project$InterfaceController$onClickPrimaryZone,
												_p139._1._0._0,
												_p139._1._0._1,
												_p139._1._0._2,
												_elm_lang$core$Native_Utils.update(
													old,
													{mouseMode: _user$project$InterfaceModel$MouseNothing}));
										} else {
											if ((_p139._1._1._0.ctor === '_Tuple3') && (_p139._1._1._0._2 === false)) {
												return A4(
													_user$project$InterfaceController$onClickPrimaryZone,
													_p139._1._0._0,
													_p139._1._0._1,
													_p139._1._0._2,
													_elm_lang$core$Native_Utils.update(
														old,
														{mouseMode: _user$project$InterfaceModel$MouseNothing}));
											} else {
												break _v67_8;
											}
										}
									} else {
										break _v67_8;
									}
								case 'PointOrOffset':
									break _v67_6;
								default:
									break _v67_8;
							}
						case 'MouseDrawNew':
							switch (_p139._0.ctor) {
								case 'Poly':
									switch (_p139._1._0.ctor) {
										case 'PolyPoints':
											var _p142 = _p139._1._0._0;
											var _p141 = A2(_user$project$SleekLayout$clickToCanvasPoint, old, click);
											var isOnCanvas = _p141._0;
											var pointOnCanvas = _p141._1;
											if (_elm_lang$core$Native_Utils.eq(
												_p142,
												{ctor: '[]'})) {
												return _elm_lang$core$Native_Utils.crash(
													'InterfaceController',
													{
														start: {line: 288, column: 28},
														end: {line: 288, column: 39}
													})('invalid state, PolyPoints should always be nonempty');
											} else {
												var initialPoint = _user$project$Utils$last_(_p142);
												return (_elm_lang$core$Native_Utils.cmp(
													A2(_user$project$Utils$distanceInt, pointOnCanvas, initialPoint),
													_user$project$Draw$drawDotSize) > 0) ? _elm_lang$core$Native_Utils.update(
													old,
													{
														mouseMode: _user$project$InterfaceModel$MouseDrawNew(
															_user$project$InterfaceModel$PolyPoints(
																{ctor: '::', _0: pointOnCanvas, _1: _p142}))
													}) : (_elm_lang$core$Native_Utils.eq(
													_elm_lang$core$List$length(_p142),
													2) ? _elm_lang$core$Native_Utils.update(
													old,
													{mouseMode: _user$project$InterfaceModel$MouseNothing}) : (_elm_lang$core$Native_Utils.eq(
													_elm_lang$core$List$length(_p142),
													1) ? _user$project$InterfaceController$switchToCursorTool(old) : _user$project$InterfaceController$upstateRun(
													_user$project$InterfaceController$switchToCursorTool(
														A3(_user$project$Draw$addPolygon, _p139._0._0, old, _p142)))));
											}
										case 'NoPointsYet':
											var _p140 = A2(_user$project$SleekLayout$clickToCanvasPoint, old, click);
											var isOnCanvas = _p140._0;
											var pointOnCanvas = _p140._1;
											return _elm_lang$core$Native_Utils.update(
												old,
												{
													mouseMode: _user$project$InterfaceModel$MouseDrawNew(
														_user$project$InterfaceModel$PolyPoints(
															{
																ctor: '::',
																_0: pointOnCanvas,
																_1: {ctor: '[]'}
															}))
												});
										default:
											break _v67_8;
									}
								case 'Path':
									switch (_p139._1._0.ctor) {
										case 'PathPoints':
											var _p150 = _p139._0._0;
											var _p149 = _p139._1._0._0;
											var _p144 = A2(_user$project$SleekLayout$clickToCanvasPoint, old, click);
											var isOnCanvas = _p144._0;
											var pointOnCanvas = _p144._1;
											var add = function ($new) {
												var points_ = {
													ctor: '::',
													_0: {ctor: '_Tuple2', _0: old.keysDown, _1: $new},
													_1: _p149
												};
												return {
													ctor: '_Tuple2',
													_0: points_,
													_1: _elm_lang$core$Native_Utils.update(
														old,
														{
															mouseMode: _user$project$InterfaceModel$MouseDrawNew(
																_user$project$InterfaceModel$PathPoints(points_))
														})
												};
											};
											var _p145 = _p149;
											if (_p145.ctor === '[]') {
												return _elm_lang$core$Native_Utils.crashCase(
													'InterfaceController',
													{
														start: {line: 306, column: 7},
														end: {line: 322, column: 47}
													},
													_p145)('invalid state, PathPoints should always be nonempty');
											} else {
												if (_p145._1.ctor === '[]') {
													return (_elm_lang$core$Native_Utils.cmp(
														A2(_user$project$Utils$distanceInt, pointOnCanvas, _p145._0._1),
														_user$project$Draw$drawDotSize) < 0) ? _user$project$InterfaceController$switchToCursorTool(old) : _elm_lang$core$Tuple$second(
														add(pointOnCanvas));
												} else {
													if (_elm_lang$core$Native_Utils.cmp(
														A2(_user$project$Utils$distanceInt, pointOnCanvas, _p145._0._1),
														_user$project$Draw$drawDotSize) < 0) {
														return _user$project$InterfaceController$upstateRun(
															A3(_user$project$Draw$addPath, _p150, old, _p149));
													} else {
														var _p147 = _user$project$Utils$last_(_p149);
														var firstClick = _p147._1;
														if (_elm_lang$core$Native_Utils.cmp(
															A2(_user$project$Utils$distanceInt, pointOnCanvas, firstClick),
															_user$project$Draw$drawDotSize) < 0) {
															var _p148 = add(firstClick);
															var points_ = _p148._0;
															var old_ = _p148._1;
															return _user$project$InterfaceController$upstateRun(
																_user$project$InterfaceController$switchToCursorTool(
																	A3(_user$project$Draw$addPath, _p150, old_, points_)));
														} else {
															return _elm_lang$core$Tuple$second(
																add(pointOnCanvas));
														}
													}
												}
											}
										case 'NoPointsYet':
											var _p143 = A2(_user$project$SleekLayout$clickToCanvasPoint, old, click);
											var isOnCanvas = _p143._0;
											var pointOnCanvas = _p143._1;
											return _elm_lang$core$Native_Utils.update(
												old,
												{
													mouseMode: _user$project$InterfaceModel$MouseDrawNew(
														_user$project$InterfaceModel$PathPoints(
															{
																ctor: '::',
																_0: {ctor: '_Tuple2', _0: old.keysDown, _1: pointOnCanvas},
																_1: {ctor: '[]'}
															}))
												});
										default:
											break _v67_8;
									}
								case 'PointOrOffset':
									break _v67_6;
								default:
									if (_p139._1._0.ctor === 'NoPointsYet') {
										return _user$project$InterfaceController$switchToCursorTool(old);
									} else {
										break _v67_8;
									}
							}
						default:
							if (_p139._0.ctor === 'PointOrOffset') {
								break _v67_6;
							} else {
								break _v67_8;
							}
					}
				} else {
					break _v67_8;
				}
			} while(false);
			var _p151 = A2(_user$project$SleekLayout$clickToCanvasPoint, old, click);
			var isOnCanvas = _p151._0;
			var pointOnCanvas = _p151._1;
			return isOnCanvas ? _user$project$InterfaceController$upstateRun(
				A2(_user$project$Draw$addPoint, old, pointOnCanvas)) : old;
		} while(false);
		return old;
	});
var _user$project$InterfaceController$onMouseUp = function (old) {
	var _p152 = {ctor: '_Tuple2', _0: old.outputMode, _1: old.mouseMode};
	_v69_4:
	do {
		if (_p152.ctor === '_Tuple2') {
			switch (_p152._0.ctor) {
				case 'Print':
					return old;
				case 'PrintScopeGraph':
					return old;
				default:
					switch (_p152._1.ctor) {
						case 'MouseDragZone':
							if (((_p152._1._1.ctor === 'Just') && (_p152._1._1._0.ctor === '_Tuple3')) && (_p152._1._1._0._1.ctor === '_Tuple2')) {
								var _p155 = _p152._1._0;
								var _p153 = old.liveSyncDelay;
								if (_p153 === false) {
									return A2(_user$project$InterfaceController$finishTrigger, _p155, old);
								} else {
									var _p154 = A2(
										_user$project$SleekLayout$clickToCanvasPoint,
										old,
										_elm_lang$core$Tuple$second(old.mouseState));
									var isOnCanvas = _p154._0;
									var mx = _p154._1._0;
									var my = _p154._1._1;
									return A2(
										_user$project$InterfaceController$finishTrigger,
										_p155,
										A5(
											_user$project$InterfaceController$applyTrigger,
											_p155,
											_p152._1._1._0._0,
											{ctor: '_Tuple2', _0: _p152._1._1._0._1._0, _1: _p152._1._1._0._1._1},
											{ctor: '_Tuple2', _0: mx, _1: my},
											old));
								}
							} else {
								break _v69_4;
							}
						case 'MouseDrawNew':
							var resetMouseMode = function (model) {
								return _elm_lang$core$Native_Utils.update(
									model,
									{mouseMode: _user$project$InterfaceModel$MouseNothing});
							};
							var _p156 = {
								ctor: '_Tuple3',
								_0: old.tool,
								_1: _p152._1._0,
								_2: _elm_lang$core$Native_Utils.eq(
									old.keysDown,
									{
										ctor: '::',
										_0: _user$project$Keys$keyShift,
										_1: {ctor: '[]'}
									})
							};
							_v71_17:
							do {
								_v71_16:
								do {
									if (_p156.ctor === '_Tuple3') {
										switch (_p156._0.ctor) {
											case 'Line':
												switch (_p156._1.ctor) {
													case 'TwoPoints':
														return _user$project$InterfaceController$upstateRun(
															resetMouseMode(
																A3(_user$project$Draw$addLine, old, _p156._1._0, _p156._1._1)));
													case 'NoPointsYet':
														break _v71_16;
													default:
														break _v71_17;
												}
											case 'HelperLine':
												switch (_p156._1.ctor) {
													case 'TwoPoints':
														return _user$project$InterfaceController$upstateRun(
															resetMouseMode(
																A3(_user$project$Draw$addLine, old, _p156._1._0, _p156._1._1)));
													case 'NoPointsYet':
														break _v71_16;
													default:
														break _v71_17;
												}
											case 'Rect':
												switch (_p156._1.ctor) {
													case 'TwoPoints':
														if (_p156._2 === false) {
															switch (_p156._0._0.ctor) {
																case 'Raw':
																	return _user$project$InterfaceController$upstateRun(
																		resetMouseMode(
																			A3(_user$project$Draw$addRawRect, old, _p156._1._0, _p156._1._1)));
																case 'Stretchy':
																	return _user$project$InterfaceController$upstateRun(
																		resetMouseMode(
																			A3(_user$project$Draw$addStretchyRect, old, _p156._1._0, _p156._1._1)));
																default:
																	break _v71_17;
															}
														} else {
															switch (_p156._0._0.ctor) {
																case 'Raw':
																	return _user$project$InterfaceController$upstateRun(
																		resetMouseMode(
																			A3(_user$project$Draw$addRawSquare, old, _p156._1._0, _p156._1._1)));
																case 'Stretchy':
																	return _user$project$InterfaceController$upstateRun(
																		resetMouseMode(
																			A3(_user$project$Draw$addStretchySquare, old, _p156._1._0, _p156._1._1)));
																default:
																	break _v71_17;
															}
														}
													case 'NoPointsYet':
														break _v71_16;
													default:
														break _v71_17;
												}
											case 'Oval':
												switch (_p156._1.ctor) {
													case 'TwoPoints':
														if (_p156._2 === false) {
															switch (_p156._0._0.ctor) {
																case 'Raw':
																	return _user$project$InterfaceController$upstateRun(
																		resetMouseMode(
																			A3(_user$project$Draw$addRawOval, old, _p156._1._0, _p156._1._1)));
																case 'Stretchy':
																	return _user$project$InterfaceController$upstateRun(
																		resetMouseMode(
																			A3(_user$project$Draw$addStretchyOval, old, _p156._1._0, _p156._1._1)));
																default:
																	break _v71_17;
															}
														} else {
															switch (_p156._0._0.ctor) {
																case 'Raw':
																	return _user$project$InterfaceController$upstateRun(
																		resetMouseMode(
																			A3(_user$project$Draw$addRawCircle, old, _p156._1._0, _p156._1._1)));
																case 'Stretchy':
																	return _user$project$InterfaceController$upstateRun(
																		resetMouseMode(
																			A3(_user$project$Draw$addStretchyCircle, old, _p156._1._0, _p156._1._1)));
																default:
																	break _v71_17;
															}
														}
													case 'NoPointsYet':
														break _v71_16;
													default:
														break _v71_17;
												}
											case 'Lambda':
												switch (_p156._1.ctor) {
													case 'TwoPoints':
														return _user$project$InterfaceController$upstateRun(
															resetMouseMode(
																A4(_user$project$Draw$addLambda, _p156._0._0, old, _p156._1._0, _p156._1._1)));
													case 'NoPointsYet':
														break _v71_16;
													default:
														break _v71_17;
												}
											case 'Poly':
												return old;
											case 'Path':
												return old;
											case 'Text':
												switch (_p156._1.ctor) {
													case 'TwoPoints':
														return _user$project$InterfaceController$upstateRun(
															resetMouseMode(
																A3(_user$project$Draw$addTextBox, old, _p156._1._0, _p156._1._1)));
													case 'NoPointsYet':
														break _v71_16;
													default:
														break _v71_17;
												}
											case 'PointOrOffset':
												switch (_p156._1.ctor) {
													case 'TwoPoints':
														if (((_p156._1._0.ctor === '_Tuple2') && (_p156._1._1.ctor === '_Tuple2')) && (_p156._1._1._1.ctor === '_Tuple2')) {
															return _user$project$InterfaceController$upstateRun(
																resetMouseMode(
																	A3(
																		_user$project$Draw$addOffsetAndMaybePoint,
																		old,
																		{
																			ctor: '_Tuple2',
																			_0: {
																				ctor: '_Tuple2',
																				_0: _elm_lang$core$Basics$toFloat(_p156._1._1._1._0),
																				_1: _user$project$Lang$dummyTrace
																			},
																			_1: {
																				ctor: '_Tuple2',
																				_0: _elm_lang$core$Basics$toFloat(_p156._1._1._1._1),
																				_1: _user$project$Lang$dummyTrace
																			}
																		},
																		_p156._1._0._1)));
														} else {
															break _v71_17;
														}
													case 'OffsetFromExisting':
														return _user$project$InterfaceController$upstateRun(
															resetMouseMode(
																A3(_user$project$Draw$addOffsetAndMaybePoint, old, _p156._1._1, _p156._1._0)));
													case 'NoPointsYet':
														break _v71_16;
													default:
														break _v71_17;
												}
											default:
												if (_p156._1.ctor === 'NoPointsYet') {
													break _v71_16;
												} else {
													break _v71_17;
												}
										}
									} else {
										break _v71_17;
									}
								} while(false);
								return _user$project$InterfaceController$switchToCursorTool(old);
							} while(false);
							return resetMouseMode(old);
						default:
							break _v69_4;
					}
			}
		} else {
			break _v69_4;
		}
	} while(false);
	return _elm_lang$core$Native_Utils.update(
		old,
		{
			mouseMode: _user$project$InterfaceModel$MouseNothing,
			liveSyncInfo: _user$project$InterfaceController$refreshLiveInfo(old)
		});
};
var _user$project$InterfaceController$msgRun = A2(
	_user$project$InterfaceModel$Msg,
	'Run',
	function (old) {
		return _user$project$InterfaceController$upstateRun(old);
	});
var _user$project$InterfaceController$updateTrackedValues = F3(
	function (newHistory, recent, old) {
		var toBeRun = _user$project$InterfaceController$resetDeuceState(
			_user$project$InterfaceModel$hideDeuceRightClickMenu(
				_elm_lang$core$Native_Utils.update(
					old,
					{code: recent.code})));
		var ran = _user$project$InterfaceController$upstateRun(toBeRun);
		var ranDeuceState = ran.deuceState;
		var newDeuceState = _elm_lang$core$Native_Utils.update(
			ranDeuceState,
			{selectedWidgets: recent.selectedDeuceWidgets});
		var almostNew = _elm_lang$core$Native_Utils.update(
			ran,
			{deuceState: newDeuceState, history: newHistory});
		return _user$project$InterfaceController$resetDeucePopupPanelPosition(
			_user$project$DeuceTools$reselectDeuceTool(
				_elm_lang$core$Native_Utils.update(
					almostNew,
					{
						deuceToolsAndResults: _user$project$DeuceTools$createToolCache(almostNew),
						deuceToolResultPreviews: _elm_lang$core$Dict$empty
					})));
	});
var _user$project$InterfaceController$doUndo = function (old) {
	var _p157 = _user$project$History$backward(old.history);
	if (_p157.ctor === 'Just') {
		var _p159 = _p157._0;
		var _p158 = _user$project$History$mostRecent(_p159);
		if (_p158.ctor === 'Just') {
			return A3(_user$project$InterfaceController$updateTrackedValues, _p159, _p158._0, old);
		} else {
			return old;
		}
	} else {
		return old;
	}
};
var _user$project$InterfaceController$msgUndo = A2(_user$project$InterfaceModel$Msg, 'Undo', _user$project$InterfaceController$doUndo);
var _user$project$InterfaceController$doRedo = function (old) {
	var _p160 = _user$project$History$forward(old.history);
	if (_p160.ctor === 'Just') {
		var _p162 = _p160._0;
		var _p161 = _user$project$History$mostRecent(_p162);
		if (_p161.ctor === 'Just') {
			return A3(_user$project$InterfaceController$updateTrackedValues, _p162, _p161._0, old);
		} else {
			return old;
		}
	} else {
		return old;
	}
};
var _user$project$InterfaceController$msgRedo = A2(_user$project$InterfaceModel$Msg, 'Redo', _user$project$InterfaceController$doRedo);
var _user$project$InterfaceController$doGroup = function (old) {
	var _p163 = _user$project$Blobs$isSimpleProgram(old.inputExp);
	if (_p163.ctor === 'Nothing') {
		return old;
	} else {
		var _p166 = _p163._0;
		var maybeAnchorPoint = _user$project$ExpressionBasedTransform$anchorOfSelectedFeatures(old.selectedFeatures);
		var multipleSelectedBlobs = _elm_lang$core$Native_Utils.cmp(
			_elm_lang$core$Dict$size(old.selectedBlobs),
			1) > 0;
		var _p164 = {ctor: '_Tuple2', _0: maybeAnchorPoint, _1: multipleSelectedBlobs};
		if (_p164._0.ctor === 'Ok') {
			if (_p164._0._0.ctor === 'Nothing') {
				if (_p164._1 === false) {
					return old;
				} else {
					return _user$project$InterfaceController$upstateRun(
						A2(_user$project$ExpressionBasedTransform$groupSelectedBlobs, old, _p166));
				}
			} else {
				return _user$project$InterfaceController$upstateRun(
					A3(_user$project$ExpressionBasedTransform$groupSelectedBlobsAround, old, _p166, _p164._0._0._0));
			}
		} else {
			var _p165 = A2(_elm_lang$core$Debug$log, 'bad anchor', _p164._0._0);
			return old;
		}
	}
};
var _user$project$InterfaceController$msgGroupBlobs = A2(_user$project$InterfaceModel$Msg, 'Group Blobs', _user$project$InterfaceController$doGroup);
var _user$project$InterfaceController$doDuplicate = function (old) {
	return _user$project$InterfaceController$upstateRun(
		_user$project$ExpressionBasedTransform$duplicateSelectedBlobs(old));
};
var _user$project$InterfaceController$msgKeyDown = function (keyCode) {
	var func = function (old) {
		var currentKeyDown = A2(_user$project$InterfaceController$isKeyDown, keyCode, old);
		if (_elm_lang$core$Native_Utils.eq(keyCode, _user$project$Keys$keyEsc)) {
			if (_user$project$InterfaceModel$anyDialogShown(old)) {
				return _user$project$InterfaceModel$closeAllDialogBoxes(old);
			} else {
				var $new = function (m) {
					return _elm_lang$core$Native_Utils.update(
						m,
						{deucePopupPanelAbove: true});
				}(
					_user$project$InterfaceController$resetDeuceState(
						_user$project$InterfaceModel$hideDeuceRightClickMenu(old)));
				var _p167 = {ctor: '_Tuple2', _0: old.tool, _1: old.mouseMode};
				_v78_3:
				do {
					_v78_0:
					do {
						if (_p167.ctor === '_Tuple2') {
							switch (_p167._1.ctor) {
								case 'MouseNothing':
									if (_p167._0.ctor === 'Cursor') {
										break _v78_0;
									} else {
										return _elm_lang$core$Native_Utils.update(
											$new,
											{tool: _user$project$InterfaceModel$Cursor});
									}
								case 'MouseDrawNew':
									if (_p167._0.ctor === 'Cursor') {
										break _v78_0;
									} else {
										return _elm_lang$core$Native_Utils.update(
											$new,
											{mouseMode: _user$project$InterfaceModel$MouseNothing});
									}
								default:
									if (_p167._0.ctor === 'Cursor') {
										break _v78_0;
									} else {
										break _v78_3;
									}
							}
						} else {
							break _v78_3;
						}
					} while(false);
					return _user$project$InterfaceController$clearSelections($new);
				} while(false);
				return $new;
			}
		} else {
			if (_elm_lang$core$Native_Utils.eq(keyCode, _user$project$Keys$keyPlusEqual)) {
				var newModel = _user$project$InterfaceController$doMakeEqual(old);
				return A2(
					_elm_lang$core$Maybe$withDefault,
					old,
					A2(
						_elm_lang$core$Maybe$map,
						function (synthesisResult) {
							return _user$project$InterfaceController$upstateRun(
								_user$project$InterfaceController$clearSynthesisResults(
									_elm_lang$core$Native_Utils.update(
										newModel,
										{
											code: _user$project$LangUnparser$unparse(
												_user$project$InterfaceModel$resultExp(synthesisResult))
										})));
						},
						A2(_user$project$Utils$findFirst, _user$project$InterfaceModel$isResultSafe, newModel.synthesisResults)));
			} else {
				if (_elm_lang$core$Native_Utils.eq(keyCode, _user$project$Keys$keyD) && (A2(_elm_lang$core$List$any, _user$project$Keys$isCommandKey, old.keysDown) && _elm_lang$core$Native_Utils.eq(
					_elm_lang$core$List$length(old.keysDown),
					1))) {
					return _user$project$InterfaceController$doDuplicate(old);
				} else {
					if (_elm_lang$core$Native_Utils.eq(keyCode, _user$project$Keys$keyG) && (A2(_elm_lang$core$List$any, _user$project$Keys$isCommandKey, old.keysDown) && _elm_lang$core$Native_Utils.eq(
						_elm_lang$core$List$length(old.keysDown),
						1))) {
						return _user$project$InterfaceController$doGroup(old);
					} else {
						if (_elm_lang$core$Native_Utils.eq(keyCode, _user$project$Keys$keyZ) && (A2(_elm_lang$core$List$any, _user$project$Keys$isCommandKey, old.keysDown) && _elm_lang$core$Native_Utils.eq(
							_elm_lang$core$List$length(old.keysDown),
							1))) {
							return _user$project$InterfaceController$doUndo(old);
						} else {
							if (_elm_lang$core$Native_Utils.eq(keyCode, _user$project$Keys$keyZ) && (A2(_elm_lang$core$List$any, _user$project$Keys$isCommandKey, old.keysDown) && (A2(
								_elm_lang$core$List$any,
								F2(
									function (x, y) {
										return _elm_lang$core$Native_Utils.eq(x, y);
									})(_user$project$Keys$keyShift),
								old.keysDown) && _elm_lang$core$Native_Utils.eq(
								_elm_lang$core$List$length(old.keysDown),
								2)))) {
								return _user$project$InterfaceController$doRedo(old);
							} else {
								if (_elm_lang$core$Native_Utils.eq(keyCode, _user$project$Keys$keyEnter) && (A2(_elm_lang$core$List$any, _user$project$Keys$isCommandKey, old.keysDown) && _elm_lang$core$Native_Utils.eq(
									_elm_lang$core$List$length(old.keysDown),
									1))) {
									return _user$project$InterfaceController$upstateRun(old);
								} else {
									if ((!currentKeyDown) && _elm_lang$core$Native_Utils.eq(keyCode, _user$project$Keys$keyShift)) {
										return _user$project$InterfaceController$refreshInputExp(old);
									} else {
										return old;
									}
								}
							}
						}
					}
				}
			}
		}
	};
	var addKey = function (old) {
		var currentKeyDown = A2(_user$project$InterfaceController$isKeyDown, keyCode, old);
		return (!currentKeyDown) ? _elm_lang$core$Native_Utils.update(
			old,
			{
				keysDown: {ctor: '::', _0: keyCode, _1: old.keysDown}
			}) : old;
	};
	return A2(
		_user$project$InterfaceModel$Msg,
		A2(
			_elm_lang$core$Basics_ops['++'],
			'Key Down ',
			_elm_lang$core$Basics$toString(keyCode)),
		function (_p168) {
			return addKey(
				func(_p168));
		});
};
var _user$project$InterfaceController$msgDuplicateBlobs = A2(_user$project$InterfaceModel$Msg, 'Duplicate Blobs', _user$project$InterfaceController$doDuplicate);
var _user$project$InterfaceController$msgMergeBlobs = A2(
	_user$project$InterfaceModel$Msg,
	'Merge Blobs',
	function (old) {
		return (_elm_lang$core$Native_Utils.cmp(
			_elm_lang$core$Dict$size(old.selectedBlobs),
			1) < 1) ? old : _user$project$InterfaceController$upstateRun(
			_user$project$ExpressionBasedTransform$mergeSelectedBlobs(old));
	});
var _user$project$InterfaceController$msgAbstractBlobs = A2(
	_user$project$InterfaceModel$Msg,
	'Abstract Blobs',
	function (old) {
		return _user$project$InterfaceController$upstateRun(
			_user$project$ExpressionBasedTransform$abstractSelectedBlobs(old));
	});
var _user$project$InterfaceController$msgReplicateBlob = function (option) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Replicate Blob',
		function (old) {
			var _p169 = _user$project$Blobs$isSimpleProgram(old.inputExp);
			if (_p169.ctor === 'Nothing') {
				return old;
			} else {
				return _user$project$InterfaceController$upstateRun(
					A3(_user$project$ExpressionBasedTransform$replicateSelectedBlob, option, old, _p169._0));
			}
		});
};
var _user$project$InterfaceController$msgReadFile = function (file) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Read File',
		function (_p170) {
			return _user$project$InterfaceController$upstateRun(
				A2(_user$project$InterfaceController$readFile, file, _p170));
		});
};
var _user$project$InterfaceController$msgReadFileFromInput = function (file) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Read File From Input',
		function (_p171) {
			return _user$project$InterfaceController$upstateRun(
				A2(_user$project$InterfaceController$readFileFromInput, file, _p171));
		});
};
var _user$project$InterfaceController$msgChooseDeuceExp = F2(
	function (name, exp) {
		return A2(
			_user$project$InterfaceModel$Msg,
			A2(
				_elm_lang$core$Basics_ops['++'],
				'Choose Deuce Exp \"',
				A2(_elm_lang$core$Basics_ops['++'], name, '\"')),
			function (m) {
				var modifiedHistory = A3(_user$project$InterfaceModel$modelModify, m.code, m.deuceState.selectedWidgets, m.history);
				var modelWithCorrectHistory = function () {
					var _p172 = modifiedHistory;
					if (_p172.ctor === 'Just') {
						return _elm_lang$core$Native_Utils.update(
							m,
							{history: _p172._0});
					} else {
						return m;
					}
				}();
				return _user$project$InterfaceController$upstateRun(
					_elm_lang$core$Native_Utils.update(
						modelWithCorrectHistory,
						{
							code: _user$project$LangUnparser$unparse(exp)
						}));
			});
	});
var _user$project$InterfaceController$changeUserStudyStep = F3(
	function (label, offset, old) {
		var i = old.userStudyStateIndex;
		var newState = A2(_user$project$Utils$geti, i + offset, _user$project$UserStudy$sequence);
		var template = _user$project$UserStudy$getTemplate(newState);
		var _p173 = A2(
			_user$project$UserStudyLog$log,
			label,
			_elm_lang$core$Basics$toString(newState));
		return _user$project$InterfaceController$upstateRun(
			A2(
				_user$project$UserStudy$postProcessProse,
				newState,
				A2(
					_user$project$UserStudy$enableFeaturesForEditorMode,
					newState,
					function (m) {
						var finalCode = A2(_user$project$UserStudy$postProcessCode, newState, m.code);
						return _elm_lang$core$Native_Utils.update(
							m,
							{
								code: finalCode,
								history: _user$project$History$begin(
									{
										code: finalCode,
										selectedDeuceWidgets: {ctor: '[]'}
									})
							});
					}(
						A2(
							_user$project$InterfaceController$handleNew,
							template,
							_elm_lang$core$Native_Utils.update(
								old,
								{userStudyStateIndex: i + offset}))))));
	});
var _user$project$InterfaceController$msgUserStudyStep = F2(
	function (label, offset) {
		return A2(
			_user$project$InterfaceModel$Msg,
			label,
			function (old) {
				return A3(_user$project$InterfaceController$changeUserStudyStep, label, offset, old);
			});
	});
var _user$project$InterfaceController$msgUserStudyNext = function (isDone) {
	var asker = isDone ? _elm_lang$core$Basics$identity : _user$project$InterfaceController$giveUpAsker;
	return asker(
		A2(_user$project$InterfaceController$msgUserStudyStep, 'New: User Study Next', 1));
};
var _user$project$InterfaceController$msgUserStudyPrev = A2(_user$project$InterfaceController$msgUserStudyStep, 'New: User Study Prev', -1);
var _user$project$InterfaceController$msgUserStudyEverySecondTick = function (currentTime) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Time Tick',
		function (old) {
			if (_elm_lang$core$Native_Utils.cmp(
				_user$project$InterfaceController$timeLeft(old),
				0) < 1) {
				var _p174 = A2(
					_user$project$UserStudyLog$log,
					'Task Timeout',
					A2(
						_elm_lang$core$Basics_ops['++'],
						'{ ',
						A2(
							_elm_lang$core$Basics_ops['++'],
							_user$project$UserStudyLog$modelSummaryJsonInner(old),
							' }')));
				return A3(
					_user$project$InterfaceController$changeUserStudyStep,
					'New: User Study Next',
					1,
					_elm_lang$core$Native_Utils.update(
						old,
						{userStudyTaskCurrentTime: currentTime}));
			} else {
				return _elm_lang$core$Native_Utils.update(
					old,
					{userStudyTaskCurrentTime: currentTime});
			}
		});
};
var _user$project$InterfaceController$msgTryParseRun = function (newModel) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Try Parse Run',
		function (old) {
			var _p175 = _user$project$InterfaceController$tryRun(newModel);
			if (_p175.ctor === 'Err') {
				if (_p175._0._2.ctor === 'Just') {
					return _elm_lang$core$Native_Utils.update(
						_p175._0._0,
						{
							caption: _elm_lang$core$Maybe$Just(
								_user$project$InterfaceModel$LangError(_p175._0._1)),
							codeBoxInfo: A2(_user$project$InterfaceController$updateCodeBoxWithParseError, _p175._0._2._0, old.codeBoxInfo)
						});
				} else {
					return _elm_lang$core$Native_Utils.update(
						_p175._0._0,
						{
							caption: _elm_lang$core$Maybe$Just(
								_user$project$InterfaceModel$LangError(_p175._0._1))
						});
				}
			} else {
				return _p175._0;
			}
		});
};
var _user$project$InterfaceController$msgSelectSynthesisResult = function (newExp) {
	return A2(
		_user$project$InterfaceModel$Msg,
		'Select Synthesis Result',
		function (old) {
			var newCode = _user$project$LangUnparser$unparse(newExp);
			var $new = _elm_lang$core$Native_Utils.update(
				old,
				{
					code: newCode,
					lastRunCode: newCode,
					history: A3(
						_user$project$InterfaceModel$modelCommit,
						newCode,
						{ctor: '[]'},
						old.history),
					synthesisResults: {ctor: '[]'}
				});
			return A3(
				_user$project$InterfaceController$runWithErrorHandling,
				$new,
				newExp,
				F5(
					function (reparsed, newVal, newWidgets, newSlate, newCode) {
						var newer = _user$project$InterfaceController$clearSelections(
							_elm_lang$core$Native_Utils.update(
								$new,
								{
									inputExp: reparsed,
									inputVal: newVal,
									slate: newSlate,
									widgets: newWidgets,
									preview: _elm_lang$core$Maybe$Nothing,
									synthesisResults: A2(_user$project$InterfaceController$maybeRunAutoSynthesis, old, reparsed)
								}));
						return _elm_lang$core$Native_Utils.update(
							newer,
							{
								liveSyncInfo: _user$project$InterfaceController$refreshLiveInfo(newer),
								codeBoxInfo: A2(_user$project$InterfaceController$updateCodeBoxInfo, _user$project$Types$dummyAceTypeInfo, newer)
							});
					}));
		});
};
var _user$project$InterfaceController$msgCancelSync = A2(
	_user$project$InterfaceModel$Msg,
	'Cancel Sync',
	function (old) {
		return _user$project$InterfaceController$upstateRun(
			_elm_lang$core$Native_Utils.update(
				old,
				{
					liveSyncInfo: _user$project$InterfaceController$refreshLiveInfo(old)
				}));
	});
var _user$project$InterfaceController$debugLog = _user$project$Config$debugLog(_user$project$Config$debugController);
var _user$project$InterfaceController$upstate = F2(
	function (_p176, old) {
		var _p177 = _p176;
		var _p178 = A2(_user$project$InterfaceController$debugLog, 'Msg', _p177._0);
		return _p177._1(old);
	});
var _user$project$InterfaceController$update = F2(
	function (msg, oldModel) {
		update:
		while (true) {
			var _p179 = {
				ctor: '_Tuple2',
				_0: {ctor: '_Tuple2', _0: oldModel.pendingFileOperation, _1: oldModel.fileOperationConfirmed},
				_1: {ctor: '_Tuple2', _0: oldModel.pendingGiveUpMsg, _1: oldModel.giveUpConfirmed}
			};
			_v83_2:
			do {
				if (_p179.ctor === '_Tuple2') {
					if (((_p179._0.ctor === '_Tuple2') && (_p179._0._0.ctor === 'Just')) && (_p179._0._1 === true)) {
						var _v84 = _p179._0._0._0,
							_v85 = _elm_lang$core$Native_Utils.update(
							oldModel,
							{pendingFileOperation: _elm_lang$core$Maybe$Nothing, fileOperationConfirmed: false});
						msg = _v84;
						oldModel = _v85;
						continue update;
					} else {
						if (((_p179._1.ctor === '_Tuple2') && (_p179._1._0.ctor === 'Just')) && (_p179._1._1 === true)) {
							var _v86 = _p179._1._0._0,
								_v87 = _elm_lang$core$Native_Utils.update(
								oldModel,
								{pendingGiveUpMsg: _elm_lang$core$Maybe$Nothing, giveUpConfirmed: false});
							msg = _v86;
							oldModel = _v87;
							continue update;
						} else {
							break _v83_2;
						}
					}
				} else {
					break _v83_2;
				}
			} while(false);
			var newModel = A2(_user$project$InterfaceController$upstate, msg, oldModel);
			var cmd = A3(_user$project$InterfaceController$issueCommand, msg, oldModel, newModel);
			var _p180 = A2(_user$project$InterfaceController$applyAllHooks, oldModel, newModel);
			var hookedModel = _p180._0;
			var hookedCommands = _p180._1;
			return {
				ctor: '_Tuple2',
				_0: _user$project$InterfaceModel$setAllUpdated(hookedModel),
				_1: _elm_lang$core$Platform_Cmd$batch(
					{
						ctor: '::',
						_0: cmd,
						_1: A2(
							_elm_lang$core$Basics_ops['++'],
							_user$project$InterfaceController$updateCommands(newModel),
							hookedCommands)
					})
			};
		}
	});
var _user$project$InterfaceController$msgStartAnimation = A2(
	_user$project$InterfaceModel$Msg,
	'Start Animation',
	function (old) {
		return A2(
			_user$project$InterfaceController$upstate,
			_user$project$InterfaceController$msgRedraw,
			_elm_lang$core$Native_Utils.update(
				old,
				{movieTime: 0, runAnimation: true}));
	});
var _user$project$InterfaceController$msgNextSlide = A2(
	_user$project$InterfaceModel$Msg,
	'Next Slide',
	function (old) {
		return (_elm_lang$core$Native_Utils.cmp(old.slideNumber, old.slideCount) > -1) ? A2(
			_user$project$InterfaceController$upstate,
			_user$project$InterfaceController$msgStartAnimation,
			_elm_lang$core$Native_Utils.update(
				old,
				{slideNumber: old.slideNumber, movieNumber: old.movieCount})) : A2(
			_user$project$InterfaceController$upstate,
			_user$project$InterfaceController$msgStartAnimation,
			_elm_lang$core$Native_Utils.update(
				old,
				{slideNumber: old.slideNumber + 1, movieNumber: 1}));
	});
var _user$project$InterfaceController$msgPreviousSlide = A2(
	_user$project$InterfaceModel$Msg,
	'Previous Slide',
	function (old) {
		if (_elm_lang$core$Native_Utils.cmp(old.slideNumber, 1) < 1) {
			return A2(
				_user$project$InterfaceController$upstate,
				_user$project$InterfaceController$msgStartAnimation,
				_elm_lang$core$Native_Utils.update(
					old,
					{slideNumber: 1, movieNumber: 1}));
		} else {
			var previousSlideNumber = old.slideNumber - 1;
			var result = A2(
				_elm_lang$core$Result$andThen,
				function (_p181) {
					var _p182 = _p181;
					return A2(
						_elm_lang$core$Result$map,
						function (previousMovieCount) {
							return A2(
								_user$project$InterfaceController$upstate,
								_user$project$InterfaceController$msgStartAnimation,
								_elm_lang$core$Native_Utils.update(
									old,
									{slideNumber: previousSlideNumber, movieNumber: previousMovieCount}));
						},
						A2(_user$project$LangSvg$resolveToMovieCount, previousSlideNumber, _p182._0));
				},
				_user$project$Eval$run(old.inputExp));
			return A2(_user$project$InterfaceController$handleError, old, result);
		}
	});
var _user$project$InterfaceController$msgNextMovie = A2(
	_user$project$InterfaceModel$Msg,
	'Next Movie',
	function (old) {
		return (_elm_lang$core$Native_Utils.eq(old.movieNumber, old.movieCount) && (_elm_lang$core$Native_Utils.cmp(old.slideNumber, old.slideCount) < 0)) ? A2(_user$project$InterfaceController$upstate, _user$project$InterfaceController$msgNextSlide, old) : ((_elm_lang$core$Native_Utils.cmp(old.movieNumber, old.movieCount) < 0) ? A2(
			_user$project$InterfaceController$upstate,
			_user$project$InterfaceController$msgStartAnimation,
			_elm_lang$core$Native_Utils.update(
				old,
				{movieNumber: old.movieNumber + 1})) : A2(
			_user$project$InterfaceController$upstate,
			_user$project$InterfaceController$msgRedraw,
			_elm_lang$core$Native_Utils.update(
				old,
				{movieTime: old.movieDuration, runAnimation: false})));
	});
var _user$project$InterfaceController$msgTickDelta = function (deltaT) {
	return A2(
		_user$project$InterfaceModel$Msg,
		A2(
			_elm_lang$core$Basics_ops['++'],
			'Tick Delta ',
			_elm_lang$core$Basics$toString(deltaT)),
		function (old) {
			if (_elm_lang$core$Native_Utils.cmp(old.movieTime, old.movieDuration) < 0) {
				var adjustedDeltaT = _elm_lang$core$Native_Utils.eq(old.movieTime, 0.0) ? A3(_elm_lang$core$Basics$clamp, 0.0, 50, deltaT) : deltaT;
				var newMovieTime = A3(_elm_lang$core$Basics$clamp, 0.0, old.movieDuration, old.movieTime + (adjustedDeltaT / 1000));
				return A2(
					_user$project$InterfaceController$upstate,
					_user$project$InterfaceController$msgRedraw,
					_elm_lang$core$Native_Utils.update(
						old,
						{movieTime: newMovieTime}));
			} else {
				if (_elm_lang$core$Native_Utils.eq(old.movieContinue, true)) {
					return A2(_user$project$InterfaceController$upstate, _user$project$InterfaceController$msgNextMovie, old);
				} else {
					return _elm_lang$core$Native_Utils.update(
						old,
						{runAnimation: false});
				}
			}
		});
};
var _user$project$InterfaceController$msgPreviousMovie = A2(
	_user$project$InterfaceModel$Msg,
	'Previous Movie',
	function (old) {
		return _elm_lang$core$Native_Utils.eq(old.movieNumber, 1) ? A2(_user$project$InterfaceController$upstate, _user$project$InterfaceController$msgPreviousSlide, old) : A2(
			_user$project$InterfaceController$upstate,
			_user$project$InterfaceController$msgStartAnimation,
			_elm_lang$core$Native_Utils.update(
				old,
				{movieNumber: old.movieNumber - 1}));
	});
var _user$project$InterfaceController$msgMouseIsDown = function (b) {
	return A2(
		_user$project$InterfaceModel$Msg,
		A2(
			_elm_lang$core$Basics_ops['++'],
			'MouseIsDown ',
			_elm_lang$core$Basics$toString(b)),
		function (old) {
			var $new = function () {
				var _p183 = _elm_lang$core$Tuple$second(old.mouseState);
				var x = _p183.x;
				var y = _p183.y;
				var lightestColor = 470;
				return _elm_lang$core$Native_Utils.update(
					old,
					{
						randomColor: A2(_elm_lang$core$Basics_ops['%'], (old.randomColor + x) + y, lightestColor)
					});
			}();
			var _p184 = {ctor: '_Tuple2', _0: b, _1: $new.mouseState};
			if (_p184._0 === false) {
				if (_p184._1._0.ctor === 'Just') {
					if (_p184._1._0._0 === false) {
						var _p188 = _p184._1._1;
						var _p187 = A2(
							_user$project$InterfaceController$debugLog,
							'mouse click',
							{ctor: '_Tuple0'});
						return A2(
							_user$project$InterfaceController$onMouseClick,
							_p188,
							_elm_lang$core$Native_Utils.update(
								$new,
								{
									mouseState: {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _p188}
								}));
					} else {
						var _p189 = A2(
							_user$project$InterfaceController$debugLog,
							'mouse up',
							{ctor: '_Tuple0'});
						return _user$project$InterfaceController$onMouseUp(
							_elm_lang$core$Native_Utils.update(
								$new,
								{
									mouseState: {ctor: '_Tuple2', _0: _elm_lang$core$Maybe$Nothing, _1: _p184._1._1}
								}));
					}
				} else {
					var _p190 = A2(
						_user$project$InterfaceController$debugLog,
						'mouse down was preempted by a handler in View',
						{ctor: '_Tuple0'});
					return $new;
				}
			} else {
				if (_p184._1._0.ctor === 'Nothing') {
					var _p186 = _p184._1._1;
					var _p185 = A2(
						_user$project$InterfaceController$debugLog,
						'mouse down',
						{ctor: '_Tuple0'});
					return old.hoveringCodeBox ? _elm_lang$core$Native_Utils.update(
						$new,
						{
							mouseState: {
								ctor: '_Tuple2',
								_0: _elm_lang$core$Maybe$Just(false),
								_1: _p186
							}
						}) : _elm_lang$core$Native_Utils.update(
						$new,
						{
							mouseState: {
								ctor: '_Tuple2',
								_0: _elm_lang$core$Maybe$Just(false),
								_1: _p186
							}
						});
				} else {
					var _p191 = A2(
						_elm_lang$core$Debug$log,
						'upstate MouseIsDown: impossible',
						{ctor: '_Tuple0'});
					return $new;
				}
			}
		});
};
var _user$project$InterfaceController$msgCleanCode = A2(
	_user$project$InterfaceModel$Msg,
	'Clean Code',
	function (old) {
		var _p192 = _user$project$FastParser$parseE(old.code);
		if (_p192.ctor === 'Err') {
			return _elm_lang$core$Native_Utils.update(
				old,
				{
					caption: _elm_lang$core$Maybe$Just(
						_user$project$InterfaceModel$LangError(
							_user$project$FastParser$showError(_p192._0)))
				});
		} else {
			var cleanedExp = _user$project$LangSimplify$cleanCode(_p192._0);
			var code_ = _user$project$LangUnparser$unparse(cleanedExp);
			if (_elm_lang$core$Native_Utils.eq(old.code, code_)) {
				return old;
			} else {
				var _p193 = A2(_user$project$InterfaceController$debugLog, 'Cleaned: ', code_);
				return _user$project$InterfaceController$upstateRun(
					_elm_lang$core$Native_Utils.update(
						old,
						{inputExp: cleanedExp, code: code_}));
			}
		}
	});
var _user$project$InterfaceController$msgDigHole = A2(
	_user$project$InterfaceModel$Msg,
	'Dig Hole',
	function (old) {
		var newExp = A5(_user$project$ValueBasedTransform$digHole, old.inputExp, old.selectedFeatures, old.slate, old.widgets, old.syncOptions);
		return A3(
			_user$project$InterfaceController$runWithErrorHandling,
			old,
			newExp,
			F5(
				function (reparsed, newVal, newWidgets, newSlate, newCode) {
					return A2(
						_user$project$InterfaceController$debugLog,
						'new model',
						_user$project$InterfaceController$clearSelections(
							_elm_lang$core$Native_Utils.update(
								old,
								{
									code: newCode,
									inputExp: reparsed,
									inputVal: newVal,
									history: A3(
										_user$project$InterfaceModel$modelCommit,
										newCode,
										{ctor: '[]'},
										old.history),
									slate: newSlate,
									widgets: newWidgets,
									preview: _elm_lang$core$Maybe$Nothing,
									liveSyncInfo: A2(
										_user$project$Utils$fromOk,
										'DigHole MkLive',
										A6(
											_user$project$InterfaceModel$mkLive,
											old.syncOptions,
											old.slideNumber,
											old.movieNumber,
											old.movieTime,
											reparsed,
											{ctor: '_Tuple2', _0: newVal, _1: newWidgets}))
								})));
				}));
	});

var _user$project$Deuce$whitespaceColor = function (colorScheme) {
	var _p0 = colorScheme;
	if (_p0.ctor === 'Light') {
		return {r: 0, g: 100, b: 255};
	} else {
		return {r: 0, g: 200, b: 200};
	}
};
var _user$project$Deuce$objectColor = function (colorScheme) {
	var _p1 = colorScheme;
	if (_p1.ctor === 'Light') {
		return {r: 255, g: 165, b: 0};
	} else {
		return {r: 200, g: 200, b: 100};
	}
};
var _user$project$Deuce$polygonOpacity = function (colorScheme) {
	return 0.2;
};
var _user$project$Deuce$strokeWidth = function (colorScheme) {
	return '2px';
};
var _user$project$Deuce$hullPoints = function () {
	var pairToString = function (_p2) {
		var _p3 = _p2;
		return A2(
			_elm_lang$core$Basics_ops['++'],
			_elm_lang$core$Basics$toString(_p3._0),
			A2(
				_elm_lang$core$Basics_ops['++'],
				',',
				A2(
					_elm_lang$core$Basics_ops['++'],
					_elm_lang$core$Basics$toString(_p3._1),
					' ')));
	};
	return function (_p4) {
		return _elm_lang$core$String$concat(
			A2(_elm_lang$core$List$map, pairToString, _p4));
	};
}();
var _user$project$Deuce$specialEndFlag = -123456789;
var _user$project$Deuce$addBleed = function (_p5) {
	var _p6 = _p5;
	var _p8 = _p6._1;
	var _p7 = _p6._0;
	return _elm_lang$core$Native_Utils.eq(_p7, _user$project$Deuce$specialEndFlag) ? {ctor: '_Tuple2', _0: 0, _1: _p8} : ((_elm_lang$core$Native_Utils.cmp(_p7, 0) < 1) ? {ctor: '_Tuple2', _0: 0 - _user$project$SleekLayout$deuceOverlayBleed, _1: _p8} : {ctor: '_Tuple2', _0: _p7, _1: _p8});
};
var _user$project$Deuce$addFinalEndBleed = function (_p9) {
	var _p10 = _p9;
	var _p12 = _p10._1;
	var _p11 = _p10._0;
	return (_elm_lang$core$Native_Utils.cmp(_p11, 0) < 1) ? {ctor: '_Tuple2', _0: _user$project$Deuce$specialEndFlag, _1: _p12} : {ctor: '_Tuple2', _0: _p11, _1: _p12};
};
var _user$project$Deuce$affectedByBleed = _user$project$Lang$isTarget;
var _user$project$Deuce$zeroWidthPadding = 2;
var _user$project$Deuce$trimmedLine = _elm_lang$core$List$map(
	function (s) {
		var trimmedRightLen = function (_p13) {
			return _elm_lang$core$String$length(
				_elm_lang$core$String$trimRight(_p13));
		}(s);
		var trimmed = _elm_lang$core$String$trim(s);
		var trimmedLen = _elm_lang$core$String$length(trimmed);
		var startCol = trimmedRightLen - trimmedLen;
		var endCol = startCol + trimmedLen;
		return {startCol: startCol, endCol: endCol, val: trimmed};
	});
var _user$project$Deuce$untrimmedLine = F2(
	function (maxLen, strings) {
		var endCol = maxLen + 1;
		var startCol = 0;
		var lineMapper = function (s) {
			return {startCol: startCol, endCol: endCol, val: s};
		};
		return A2(_elm_lang$core$List$map, lineMapper, strings);
	});
var _user$project$Deuce$computeMaxLineLength = function (strings) {
	var lens = A2(_elm_lang$core$List$map, _elm_lang$core$String$length, strings);
	return A2(
		_elm_lang$core$Maybe$withDefault,
		0,
		_elm_lang$core$List$maximum(lens));
};
var _user$project$Deuce$isBlankLine = function (line) {
	return _elm_lang$core$Native_Utils.eq(line.startCol, line.endCol);
};
var _user$project$Deuce$emptyLine = {startCol: 0, endCol: 0, val: ''};
var _user$project$Deuce$c2a = F2(
	function (di, _p14) {
		var _p15 = _p14;
		return {
			ctor: '_Tuple2',
			_0: di.characterWidth * _elm_lang$core$Basics$toFloat(_p15._0),
			_1: di.lineHeight * _elm_lang$core$Basics$toFloat(_p15._1)
		};
	});
var _user$project$Deuce$lineHull = F2(
	function (di, _p16) {
		var _p17 = _p16;
		var _p19 = _p17._0;
		var _p18 = _p17._1;
		return A2(
			_elm_lang$core$List$map,
			_user$project$Deuce$c2a(di),
			{
				ctor: '::',
				_0: {ctor: '_Tuple2', _0: _p18.startCol, _1: _p19},
				_1: {
					ctor: '::',
					_0: {ctor: '_Tuple2', _0: _p18.startCol, _1: _p19 + 1},
					_1: {
						ctor: '::',
						_0: {ctor: '_Tuple2', _0: _p18.endCol, _1: _p19 + 1},
						_1: {
							ctor: '::',
							_0: {ctor: '_Tuple2', _0: _p18.endCol, _1: _p19},
							_1: {ctor: '[]'}
						}
					}
				}
			});
	});
var _user$project$Deuce$hull = F7(
	function (codeInfo, useTrimmed, shouldAddBleed, startCol, startRow, endCol, endRow) {
		var _p20 = shouldAddBleed ? {
			ctor: '_Tuple2',
			_0: _elm_lang$core$List$map(_user$project$Deuce$addBleed),
			_1: _user$project$Deuce$addFinalEndBleed
		} : {ctor: '_Tuple2', _0: _elm_lang$core$Basics$identity, _1: _elm_lang$core$Basics$identity};
		var modifier = _p20._0;
		var finalEndModifier = _p20._1;
		var lineHulls = useTrimmed ? codeInfo.trimmedLineHulls : codeInfo.untrimmedLineHulls;
		var relevantLines = A3(_user$project$Utils$slice, startRow + 1, endRow, lineHulls);
		return modifier(
			function () {
				if (!_elm_lang$core$Native_Utils.eq(startRow, endRow)) {
					return A2(
						_elm_lang$core$Basics_ops['++'],
						A2(
							_elm_lang$core$List$map,
							_user$project$Deuce$c2a(codeInfo.displayInfo),
							{
								ctor: '::',
								_0: {ctor: '_Tuple2', _0: startCol, _1: startRow},
								_1: {
									ctor: '::',
									_0: {ctor: '_Tuple2', _0: startCol, _1: startRow + 1},
									_1: {ctor: '[]'}
								}
							}),
						A2(
							_elm_lang$core$Basics_ops['++'],
							_elm_lang$core$List$concat(
								A2(
									_elm_lang$core$List$map,
									_elm_lang$core$List$take(2),
									relevantLines)),
							A2(
								_elm_lang$core$Basics_ops['++'],
								A2(
									_elm_lang$core$List$take,
									2,
									A2(
										_elm_lang$core$Maybe$withDefault,
										{ctor: '[]'},
										A2(_user$project$Utils$maybeGeti0, endRow, lineHulls))),
								A2(
									_elm_lang$core$Basics_ops['++'],
									A2(
										_elm_lang$core$List$map,
										function (_p21) {
											return finalEndModifier(
												A2(_user$project$Deuce$c2a, codeInfo.displayInfo, _p21));
										},
										{
											ctor: '::',
											_0: {ctor: '_Tuple2', _0: endCol, _1: endRow + 1},
											_1: {
												ctor: '::',
												_0: {ctor: '_Tuple2', _0: endCol, _1: endRow},
												_1: {ctor: '[]'}
											}
										}),
									A2(
										_elm_lang$core$Basics_ops['++'],
										_elm_lang$core$List$concat(
											A2(
												_elm_lang$core$List$map,
												_elm_lang$core$List$drop(2),
												_elm_lang$core$List$reverse(relevantLines))),
										A2(
											_elm_lang$core$List$drop,
											2,
											A2(
												_elm_lang$core$Maybe$withDefault,
												{ctor: '[]'},
												A2(_user$project$Utils$maybeGeti0, startRow, lineHulls))))))));
				} else {
					if (_elm_lang$core$Native_Utils.eq(startCol, endCol)) {
						var _p22 = A2(
							_user$project$Deuce$c2a,
							codeInfo.displayInfo,
							{ctor: '_Tuple2', _0: startCol, _1: startRow + 1});
						var yBottom = _p22._1;
						var _p23 = A2(
							_user$project$Deuce$c2a,
							codeInfo.displayInfo,
							{ctor: '_Tuple2', _0: startCol, _1: startRow});
						var x = _p23._0;
						var yTop = _p23._1;
						return {
							ctor: '::',
							_0: {ctor: '_Tuple2', _0: x - _user$project$Deuce$zeroWidthPadding, _1: yTop},
							_1: {
								ctor: '::',
								_0: {ctor: '_Tuple2', _0: x - _user$project$Deuce$zeroWidthPadding, _1: yBottom},
								_1: {
									ctor: '::',
									_0: {ctor: '_Tuple2', _0: x + _user$project$Deuce$zeroWidthPadding, _1: yBottom},
									_1: {
										ctor: '::',
										_0: {ctor: '_Tuple2', _0: x + _user$project$Deuce$zeroWidthPadding, _1: yTop},
										_1: {ctor: '[]'}
									}
								}
							}
						};
					} else {
						return A2(
							_elm_lang$core$List$map,
							_user$project$Deuce$c2a(codeInfo.displayInfo),
							{
								ctor: '::',
								_0: {ctor: '_Tuple2', _0: startCol, _1: startRow},
								_1: {
									ctor: '::',
									_0: {ctor: '_Tuple2', _0: startCol, _1: startRow + 1},
									_1: {
										ctor: '::',
										_0: {ctor: '_Tuple2', _0: endCol, _1: startRow + 1},
										_1: {
											ctor: '::',
											_0: {ctor: '_Tuple2', _0: endCol, _1: startRow},
											_1: {ctor: '[]'}
										}
									}
								}
							});
					}
				}
			}());
	});
var _user$project$Deuce$index = _elm_lang$core$List$indexedMap(
	F2(
		function (v0, v1) {
			return {ctor: '_Tuple2', _0: v0, _1: v1};
		}));
var _user$project$Deuce$lineHullsFromCode = F2(
	function (di, code) {
		var lines = _elm_lang$core$String$lines(code);
		var maxLineLength = _user$project$Deuce$computeMaxLineLength(lines);
		var pipeline = function (lineKind) {
			return A2(
				_elm_lang$core$List$map,
				_user$project$Deuce$lineHull(di),
				_user$project$Deuce$index(
					lineKind(lines)));
		};
		return {
			ctor: '_Tuple3',
			_0: pipeline(
				_user$project$Deuce$untrimmedLine(maxLineLength)),
			_1: pipeline(_user$project$Deuce$trimmedLine),
			_2: maxLineLength
		};
	});
var _user$project$Deuce$startEnd = F2(
	function (codeInfo, codeObject) {
		var info = _user$project$Lang$extractInfoFromCodeObject(codeObject);
		var infoTuple = {ctor: '_Tuple4', _0: info.start.col, _1: info.start.line, _2: info.end.col, _3: info.end.line};
		var _p24 = function () {
			var _p25 = codeObject;
			if (_p25.ctor === 'E') {
				var _p26 = _p25._0;
				var endExp = _user$project$Lang$firstNestedExp(_p26);
				return {ctor: '_Tuple4', _0: _p26.start.col, _1: _p26.start.line, _2: endExp.end.col, _3: endExp.end.line};
			} else {
				return infoTuple;
			}
		}();
		var startCol = _p24._0;
		var startLine = _p24._1;
		var endCol = _p24._2;
		var endLine = _p24._3;
		var _p27 = _elm_lang$core$Native_Utils.eq(endCol, 0) ? {ctor: '_Tuple4', _0: startLine, _1: startCol, _2: endLine - 1, _3: codeInfo.maxLineLength + 1} : (_user$project$Lang$hasDummyInfo(info) ? {ctor: '_Tuple4', _0: -100, _1: -100, _2: -100, _3: -100} : {ctor: '_Tuple4', _0: startLine, _1: startCol, _2: endLine, _3: endCol});
		var realStartLine = _p27._0;
		var realStartCol = _p27._1;
		var realEndLine = _p27._2;
		var realEndCol = _p27._3;
		return {ctor: '_Tuple4', _0: realStartCol - 1, _1: realStartLine - 1, _2: realEndCol - 1, _3: realEndLine - 1};
	});
var _user$project$Deuce$codeObjectHull = F2(
	function (codeInfo, codeObject) {
		var _p28 = A2(_user$project$Deuce$startEnd, codeInfo, codeObject);
		var startCol = _p28._0;
		var startRow = _p28._1;
		var endCol = _p28._2;
		var endRow = _p28._3;
		var shouldAddBleed = _user$project$Deuce$affectedByBleed(codeObject);
		var useTrimmed = function (_p29) {
			return !_user$project$Lang$isTarget(_p29);
		}(codeObject);
		return A7(_user$project$Deuce$hull, codeInfo, useTrimmed, shouldAddBleed, startCol, startRow, endCol, endRow);
	});
var _user$project$Deuce$codeObjectHullPoints = F2(
	function (codeInfo, codeObject) {
		return _user$project$Deuce$hullPoints(
			A2(_user$project$Deuce$codeObjectHull, codeInfo, codeObject));
	});
var _user$project$Deuce$rgbaString = F2(
	function (c, a) {
		return A2(
			_elm_lang$core$Basics_ops['++'],
			'rgba(',
			A2(
				_elm_lang$core$Basics_ops['++'],
				_elm_lang$core$Basics$toString(c.r),
				A2(
					_elm_lang$core$Basics_ops['++'],
					',',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_elm_lang$core$Basics$toString(c.g),
						A2(
							_elm_lang$core$Basics_ops['++'],
							',',
							A2(
								_elm_lang$core$Basics_ops['++'],
								_elm_lang$core$Basics$toString(c.b),
								A2(
									_elm_lang$core$Basics_ops['++'],
									',',
									A2(
										_elm_lang$core$Basics_ops['++'],
										_elm_lang$core$Basics$toString(a),
										')'))))))));
	});
var _user$project$Deuce$circleHandles = F5(
	function (codeInfo, codeObject, color, opacity, radius) {
		var _p30 = A2(_user$project$Deuce$startEnd, codeInfo, codeObject);
		var startCol = _p30._0;
		var startRow = _p30._1;
		var endCol = _p30._2;
		var endRow = _p30._3;
		var accountForBleed = F2(
			function (mightBleed, _p31) {
				var _p32 = _p31;
				var _p34 = _p32._1;
				var _p33 = _p32._0;
				return ((_elm_lang$core$Native_Utils.cmp(_p33, 0) < 1) && (mightBleed && _user$project$Deuce$affectedByBleed(codeObject))) ? {ctor: '_Tuple2', _0: 0 - _user$project$SleekLayout$deuceOverlayBleed, _1: _p34} : {ctor: '_Tuple2', _0: _p33, _1: _p34};
			});
		var radiusString = _elm_lang$core$Basics$toString(radius);
		var handle = F3(
			function (mightBleed, col, row) {
				var _p35 = A2(
					_user$project$Utils$mapBoth,
					_elm_lang$core$Basics$toString,
					A2(
						accountForBleed,
						mightBleed,
						A2(
							_user$project$Deuce$c2a,
							codeInfo.displayInfo,
							{ctor: '_Tuple2', _0: col, _1: row})));
				var cx = _p35._0;
				var cy = _p35._1;
				return A2(
					_elm_lang$svg$Svg$circle,
					{
						ctor: '::',
						_0: _elm_lang$svg$Svg_Attributes$cx(cx),
						_1: {
							ctor: '::',
							_0: _elm_lang$svg$Svg_Attributes$cy(cy),
							_1: {
								ctor: '::',
								_0: _elm_lang$svg$Svg_Attributes$r(radiusString),
								_1: {ctor: '[]'}
							}
						}
					},
					{ctor: '[]'});
			});
		return A2(
			_elm_lang$svg$Svg$g,
			{
				ctor: '::',
				_0: _elm_lang$svg$Svg_Attributes$fill(
					A2(_user$project$Deuce$rgbaString, color, opacity)),
				_1: {
					ctor: '::',
					_0: _elm_lang$svg$Svg_Attributes$strokeWidth(
						_user$project$Deuce$strokeWidth(codeInfo.displayInfo.colorScheme)),
					_1: {
						ctor: '::',
						_0: _elm_lang$svg$Svg_Attributes$stroke(
							A2(_user$project$Deuce$rgbaString, color, opacity)),
						_1: {ctor: '[]'}
					}
				}
			},
			{
				ctor: '::',
				_0: A3(handle, true, startCol, startRow),
				_1: {
					ctor: '::',
					_0: A3(handle, false, endCol, endRow + 1),
					_1: {ctor: '[]'}
				}
			});
	});
var _user$project$Deuce$blockerPolygon = F2(
	function (codeInfo, codeObject) {
		var color = {r: 255, g: 0, b: 0};
		return {
			ctor: '::',
			_0: A2(
				_elm_lang$svg$Svg$g,
				{
					ctor: '::',
					_0: _elm_lang$svg$Svg_Attributes$opacity('0'),
					_1: {ctor: '[]'}
				},
				{
					ctor: '::',
					_0: A2(
						_elm_lang$svg$Svg$polygon,
						{
							ctor: '::',
							_0: _elm_lang$svg$Svg_Attributes$points(
								A2(_user$project$Deuce$codeObjectHullPoints, codeInfo, codeObject)),
							_1: {
								ctor: '::',
								_0: _elm_lang$svg$Svg_Attributes$strokeWidth(
									_user$project$Deuce$strokeWidth(codeInfo.displayInfo.colorScheme)),
								_1: {
									ctor: '::',
									_0: _elm_lang$svg$Svg_Attributes$stroke(
										A2(_user$project$Deuce$rgbaString, color, 1)),
									_1: {
										ctor: '::',
										_0: _elm_lang$svg$Svg_Attributes$fill(
											A2(
												_user$project$Deuce$rgbaString,
												color,
												_user$project$Deuce$polygonOpacity(codeInfo.displayInfo.colorScheme))),
										_1: {ctor: '[]'}
									}
								}
							}
						},
						{ctor: '[]'}),
					_1: {ctor: '[]'}
				}),
			_1: {ctor: '[]'}
		};
	});
var _user$project$Deuce$codeObjectPolygon = F3(
	function (codeInfo, codeObject, color) {
		var _p36 = A2(_user$project$DeuceWidgets$toDeuceWidget, codeInfo.patMap, codeObject);
		if (_p36.ctor === 'Nothing') {
			return {ctor: '[]'};
		} else {
			var _p38 = _p36._0;
			var active = A2(_elm_lang$core$List$member, _p38, codeInfo.deuceState.selectedWidgets);
			var hovered = A2(_elm_lang$core$List$member, _p38, codeInfo.deuceState.hoveredWidgets);
			var baseAlpha = (active && hovered) ? 1 : (active ? 1 : (hovered ? 1 : 0));
			var cursorStyle = (hovered || active) ? 'pointer' : 'default';
			var onClick = _user$project$InterfaceController$msgMouseClickDeuceWidget(_p38);
			var onMouseOut = _user$project$InterfaceController$msgMouseLeaveDeuceWidget(_p38);
			var onMouseOver = _user$project$InterfaceController$msgMouseEnterDeuceWidget(_p38);
			return {
				ctor: '::',
				_0: A2(
					_elm_lang$svg$Svg$g,
					{
						ctor: '::',
						_0: function (_p37) {
							return _elm_lang$svg$Svg_Attributes$style(
								_user$project$HtmlUtils$styleListToString(_p37));
						}(
							{
								ctor: '::',
								_0: {ctor: '_Tuple2', _0: 'cursor', _1: cursorStyle},
								_1: {ctor: '[]'}
							}),
						_1: {
							ctor: '::',
							_0: _elm_lang$svg$Svg_Events$onMouseOver(onMouseOver),
							_1: {
								ctor: '::',
								_0: _elm_lang$svg$Svg_Events$onMouseOut(onMouseOut),
								_1: {
									ctor: '::',
									_0: _elm_lang$svg$Svg_Events$onClick(onClick),
									_1: {
										ctor: '::',
										_0: _elm_lang$svg$Svg_Attributes$opacity(
											_elm_lang$core$Basics$toString(baseAlpha)),
										_1: {ctor: '[]'}
									}
								}
							}
						}
					},
					{
						ctor: '::',
						_0: A5(_user$project$Deuce$circleHandles, codeInfo, codeObject, color, 1, 3),
						_1: {
							ctor: '::',
							_0: A2(
								_elm_lang$svg$Svg$polygon,
								{
									ctor: '::',
									_0: _elm_lang$svg$Svg_Attributes$points(
										A2(_user$project$Deuce$codeObjectHullPoints, codeInfo, codeObject)),
									_1: {
										ctor: '::',
										_0: _elm_lang$svg$Svg_Attributes$strokeWidth(
											_user$project$Deuce$strokeWidth(codeInfo.displayInfo.colorScheme)),
										_1: {
											ctor: '::',
											_0: _elm_lang$svg$Svg_Attributes$stroke(
												A2(_user$project$Deuce$rgbaString, color, 1)),
											_1: {
												ctor: '::',
												_0: _elm_lang$svg$Svg_Attributes$fill(
													A2(
														_user$project$Deuce$rgbaString,
														color,
														_user$project$Deuce$polygonOpacity(codeInfo.displayInfo.colorScheme))),
												_1: {ctor: '[]'}
											}
										}
									}
								},
								{ctor: '[]'}),
							_1: {ctor: '[]'}
						}
					}),
				_1: {ctor: '[]'}
			};
		}
	});
var _user$project$Deuce$expPolygon = F2(
	function (codeInfo, e) {
		var color = _user$project$Deuce$objectColor(codeInfo.displayInfo.colorScheme);
		var codeObject = _user$project$Lang$E(e);
		var _p39 = e.val.e__;
		if ((_p39.ctor === 'ELet') && (_p39._1.ctor === 'Def')) {
			return {ctor: '[]'};
		} else {
			return A3(_user$project$Deuce$codeObjectPolygon, codeInfo, codeObject, color);
		}
	});
var _user$project$Deuce$patPolygon = F3(
	function (codeInfo, e, p) {
		var color = _user$project$Deuce$objectColor(codeInfo.displayInfo.colorScheme);
		var codeObject = A2(_user$project$Lang$P, e, p);
		return A3(_user$project$Deuce$codeObjectPolygon, codeInfo, codeObject, color);
	});
var _user$project$Deuce$letBindingEquationPolygon = F2(
	function (codeInfo, eid) {
		var color = _user$project$Deuce$objectColor(codeInfo.displayInfo.colorScheme);
		var codeObject = _user$project$Lang$LBE(eid);
		return A3(_user$project$Deuce$codeObjectPolygon, codeInfo, codeObject, color);
	});
var _user$project$Deuce$expTargetPolygon = F4(
	function (codeInfo, ba, ws, et) {
		var color = _user$project$Deuce$whitespaceColor(codeInfo.displayInfo.colorScheme);
		var codeObject = A3(_user$project$Lang$ET, ba, ws, et);
		return A3(_user$project$Deuce$codeObjectPolygon, codeInfo, codeObject, color);
	});
var _user$project$Deuce$patTargetPolygon = F5(
	function (codeInfo, ba, ws, e, pt) {
		var color = _user$project$Deuce$whitespaceColor(codeInfo.displayInfo.colorScheme);
		var codeObject = A4(_user$project$Lang$PT, ba, ws, e, pt);
		return A3(_user$project$Deuce$codeObjectPolygon, codeInfo, codeObject, color);
	});
var _user$project$Deuce$polygons = F2(
	function (codeInfo, ast) {
		return _elm_lang$core$List$reverse(
			A3(
				_user$project$Lang$foldCode,
				F2(
					function (codeObject, acc) {
						if (_user$project$Lang$isSelectable(codeObject)) {
							var _p40 = codeObject;
							switch (_p40.ctor) {
								case 'E':
									return A2(
										_elm_lang$core$Basics_ops['++'],
										A2(_user$project$Deuce$expPolygon, codeInfo, _p40._0),
										acc);
								case 'P':
									return A2(
										_elm_lang$core$Basics_ops['++'],
										A3(_user$project$Deuce$patPolygon, codeInfo, _p40._0, _p40._1),
										acc);
								case 'T':
									return acc;
								case 'LBE':
									return A2(
										_elm_lang$core$Basics_ops['++'],
										A2(_user$project$Deuce$letBindingEquationPolygon, codeInfo, _p40._0),
										acc);
								case 'ET':
									return A2(
										_elm_lang$core$Basics_ops['++'],
										A4(_user$project$Deuce$expTargetPolygon, codeInfo, _p40._0, _p40._1, _p40._2),
										acc);
								case 'PT':
									return A2(
										_elm_lang$core$Basics_ops['++'],
										A5(_user$project$Deuce$patTargetPolygon, codeInfo, _p40._0, _p40._1, _p40._2, _p40._3),
										acc);
								default:
									return acc;
							}
						} else {
							return A2(
								_elm_lang$core$Basics_ops['++'],
								A2(_user$project$Deuce$blockerPolygon, codeInfo, codeObject),
								acc);
						}
					}),
				{ctor: '[]'},
				_user$project$Lang$E(ast)));
	});
var _user$project$Deuce$overlay = function (model) {
	var leftShift = model.codeBoxInfo.contentLeft + _user$project$SleekLayout$deuceOverlayBleed;
	var displayInfo = {lineHeight: model.codeBoxInfo.lineHeight, characterWidth: model.codeBoxInfo.characterWidth, colorScheme: model.colorScheme};
	var _p41 = A2(_user$project$Deuce$lineHullsFromCode, displayInfo, model.code);
	var untrimmedLineHulls = _p41._0;
	var trimmedLineHulls = _p41._1;
	var maxLineLength = _p41._2;
	var ast = model.inputExp;
	var patMap = _user$project$Lang$computePatMap(ast);
	var codeInfo = {displayInfo: displayInfo, untrimmedLineHulls: untrimmedLineHulls, trimmedLineHulls: trimmedLineHulls, deuceState: model.deuceState, patMap: patMap, maxLineLength: maxLineLength};
	return A2(
		_elm_lang$svg$Svg$g,
		{
			ctor: '::',
			_0: _elm_lang$svg$Svg_Attributes$transform(
				A2(
					_elm_lang$core$Basics_ops['++'],
					'translate(',
					A2(
						_elm_lang$core$Basics_ops['++'],
						_elm_lang$core$Basics$toString(leftShift),
						', 0)'))),
			_1: {ctor: '[]'}
		},
		A2(_user$project$Deuce$polygons, codeInfo, ast));
};
var _user$project$Deuce$Color = F3(
	function (a, b, c) {
		return {r: a, g: b, b: c};
	});
var _user$project$Deuce$Line = F3(
	function (a, b, c) {
		return {startCol: a, endCol: b, val: c};
	});
var _user$project$Deuce$DisplayInfo = F3(
	function (a, b, c) {
		return {lineHeight: a, characterWidth: b, colorScheme: c};
	});
var _user$project$Deuce$CodeInfo = F6(
	function (a, b, c, d, e, f) {
		return {displayInfo: a, untrimmedLineHulls: b, trimmedLineHulls: c, deuceState: d, patMap: e, maxLineLength: f};
	});

var _user$project$SleekView$deuceOverlay = function (model) {
	var disabledFlag = function () {
		var _p0 = model.preview;
		if (_p0.ctor === 'Just') {
			return ' disabled';
		} else {
			return '';
		}
	}();
	var pointerEvents = _user$project$InterfaceModel$deuceActive(model) ? 'auto' : 'none';
	return A2(
		_elm_lang$html$Html$div,
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$class(
				A2(_elm_lang$core$Basics_ops['++'], 'deuce-overlay-container', disabledFlag)),
			_1: {
				ctor: '::',
				_0: _elm_lang$html$Html_Attributes$style(
					{
						ctor: '::',
						_0: {ctor: '_Tuple2', _0: 'pointer-events', _1: pointerEvents},
						_1: {
							ctor: '::',
							_0: {
								ctor: '_Tuple2',
								_0: 'top',
								_1: _user$project$SleekLayout$px(model.codeBoxInfo.scrollerTop)
							},
							_1: {
								ctor: '::',
								_0: {
									ctor: '_Tuple2',
									_0: 'left',
									_1: _user$project$SleekLayout$px(model.codeBoxInfo.scrollerLeft - _user$project$SleekLayout$deuceOverlayBleed)
								},
								_1: {
									ctor: '::',
									_0: {
										ctor: '_Tuple2',
										_0: 'width',
										_1: _user$project$SleekLayout$px(model.codeBoxInfo.scrollerWidth + _user$project$SleekLayout$deuceOverlayBleed)
									},
									_1: {
										ctor: '::',
										_0: {
											ctor: '_Tuple2',
											_0: 'height',
											_1: _user$project$SleekLayout$px(model.codeBoxInfo.scrollerHeight)
										},
										_1: {ctor: '[]'}
									}
								}
							}
						}
					}),
				_1: {ctor: '[]'}
			}
		},
		{
			ctor: '::',
			_0: A2(
				_elm_lang$svg$Svg$svg,
				{
					ctor: '::',
					_0: _elm_lang$svg$Svg_Attributes$class('deuce-overlay'),
					_1: {
						ctor: '::',
						_0: _elm_lang$svg$Svg_Attributes$width('10000000'),
						_1: {
							ctor: '::',
							_0: _elm_lang$svg$Svg_Attributes$height('10000000'),
							_1: {
								ctor: '::',
								_0: function (_p1) {
									return _elm_lang$svg$Svg_Attributes$style(
										_user$project$HtmlUtils$styleListToString(_p1));
								}(
									{
										ctor: '::',
										_0: {
											ctor: '_Tuple2',
											_0: 'top',
											_1: _user$project$SleekLayout$px(0 - model.codeBoxInfo.scrollTop)
										},
										_1: {
											ctor: '::',
											_0: {
												ctor: '_Tuple2',
												_0: 'left',
												_1: _user$project$SleekLayout$px(0 - model.codeBoxInfo.scrollLeft)
											},
											_1: {ctor: '[]'}
										}
									}),
								_1: {ctor: '[]'}
							}
						}
					}
				},
				{
					ctor: '::',
					_0: _user$project$Deuce$overlay(model),
					_1: {ctor: '[]'}
				}),
			_1: {ctor: '[]'}
		});
};
var _user$project$SleekView$onbeforeunloadDataElement = function (model) {
	var needsSaveString = model.needsSave ? 'true' : 'false';
	return A2(
		_elm_lang$html$Html$input,
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$type_('hidden'),
			_1: {
				ctor: '::',
				_0: _elm_lang$html$Html_Attributes$id('onbeforeunload-data'),
				_1: {
					ctor: '::',
					_0: A2(_elm_lang$html$Html_Attributes$attribute, 'data-needs-save', needsSaveString),
					_1: {
						ctor: '::',
						_0: A2(
							_elm_lang$html$Html_Attributes$attribute,
							'data-filename',
							_user$project$InterfaceModel$prettyFilename(model)),
						_1: {ctor: '[]'}
					}
				}
			}
		},
		{ctor: '[]'});
};
var _user$project$SleekView$subtleBackground = A2(
	_elm_lang$html$Html$div,
	{
		ctor: '::',
		_0: _elm_lang$html$Html_Attributes$class('subtle-background'),
		_1: {ctor: '[]'}
	},
	{ctor: '[]'});
var _user$project$SleekView$viewFileIndexEntry = function (filename) {
	return A2(
		_elm_lang$html$Html$div,
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$class('file-listing'),
			_1: {ctor: '[]'}
		},
		{
			ctor: '::',
			_0: A2(
				_elm_lang$html$Html$span,
				{ctor: '[]'},
				{
					ctor: '::',
					_0: A2(
						_elm_lang$html$Html$b,
						{ctor: '[]'},
						{
							ctor: '::',
							_0: _elm_lang$html$Html$text(filename),
							_1: {ctor: '[]'}
						}),
					_1: {
						ctor: '::',
						_0: _elm_lang$html$Html$text('.little'),
						_1: {ctor: '[]'}
					}
				}),
			_1: {ctor: '[]'}
		});
};
var _user$project$SleekView$toolModeIndicator = function (model) {
	var toolModeDisplay = F2(
		function (mode, modeText) {
			var flag = _elm_lang$core$Native_Utils.eq(model.toolMode, mode) ? ' active' : '';
			return A2(
				_elm_lang$html$Html$div,
				{
					ctor: '::',
					_0: _elm_lang$html$Html_Attributes$class(
						A2(_elm_lang$core$Basics_ops['++'], 'tool-mode', flag)),
					_1: {
						ctor: '::',
						_0: _elm_lang$html$Html_Events$onClick(
							_user$project$InterfaceController$msgSetToolMode(mode)),
						_1: {ctor: '[]'}
					}
				},
				{
					ctor: '::',
					_0: _elm_lang$html$Html$text(modeText),
					_1: {ctor: '[]'}
				});
		});
	return A2(
		_elm_lang$html$Html$div,
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$class('tool-mode-indicator'),
			_1: {ctor: '[]'}
		},
		{
			ctor: '::',
			_0: A2(toolModeDisplay, _user$project$InterfaceModel$Raw, 'Raw'),
			_1: {
				ctor: '::',
				_0: A2(toolModeDisplay, _user$project$InterfaceModel$Stretchy, 'Stretchy'),
				_1: {
					ctor: '::',
					_0: A2(toolModeDisplay, _user$project$InterfaceModel$Sticky, 'Sticky'),
					_1: {ctor: '[]'}
				}
			}
		});
};
var _user$project$SleekView$buttonSelectedColor = '#DDDDDD';
var _user$project$SleekView$buttonRegularColor = '#FFFFFF';
var _user$project$SleekView$iconButtonExtraAttrs = F6(
	function (model, iconName, extraAttrs, onClickHandler, btnKind, disabled) {
		var iconHtml = function () {
			var _p2 = A2(
				_elm_lang$core$Dict$get,
				_user$project$Utils$naturalToCamelCase(iconName),
				model.icons);
			if (_p2.ctor === 'Just') {
				return _p2._0;
			} else {
				return _elm_lang$html$Html$text('');
			}
		}();
		var color = function () {
			var _p3 = btnKind;
			switch (_p3.ctor) {
				case 'Regular':
					return _user$project$SleekView$buttonRegularColor;
				case 'Unselected':
					return _user$project$SleekView$buttonRegularColor;
				default:
					return _user$project$SleekView$buttonSelectedColor;
			}
		}();
		var commonAttrs = {
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$disabled(disabled),
			_1: {
				ctor: '::',
				_0: _elm_lang$html$Html_Attributes$class('icon-button'),
				_1: {
					ctor: '::',
					_0: _elm_lang$html$Html_Attributes$style(
						{
							ctor: '::',
							_0: {
								ctor: '_Tuple2',
								_0: 'width',
								_1: function (_p4) {
									return _user$project$SleekLayout$px(
										function (_) {
											return _.width;
										}(_p4));
								}(_user$project$SleekLayout$iconButton)
							},
							_1: {
								ctor: '::',
								_0: {
									ctor: '_Tuple2',
									_0: 'height',
									_1: function (_p5) {
										return _user$project$SleekLayout$px(
											function (_) {
												return _.height;
											}(_p5));
									}(_user$project$SleekLayout$iconButton)
								},
								_1: {
									ctor: '::',
									_0: {ctor: '_Tuple2', _0: 'background', _1: color},
									_1: {ctor: '[]'}
								}
							}
						}),
					_1: {ctor: '[]'}
				}
			}
		};
		return A2(
			_elm_lang$html$Html$button,
			A2(
				_elm_lang$core$Basics_ops['++'],
				commonAttrs,
				A2(
					_elm_lang$core$Basics_ops['++'],
					{
						ctor: '::',
						_0: A2(_user$project$HtmlUtils$handleEventAndStop, 'mousedown', _user$project$InterfaceController$msgNoop),
						_1: {
							ctor: '::',
							_0: _elm_lang$html$Html_Events$onClick(onClickHandler),
							_1: {
								ctor: '::',
								_0: _elm_lang$html$Html_Attributes$title(iconName),
								_1: {ctor: '[]'}
							}
						}
					},
					extraAttrs)),
			{
				ctor: '::',
				_0: iconHtml,
				_1: {ctor: '[]'}
			});
	});
var _user$project$SleekView$iconButton = F5(
	function (model, iconName, onClickHandler, btnKind, disabled) {
		return A6(
			_user$project$SleekView$iconButtonExtraAttrs,
			model,
			iconName,
			{ctor: '[]'},
			onClickHandler,
			btnKind,
			disabled);
	});
var _user$project$SleekView$textOutput = function (text) {
	return A2(
		_elm_lang$html$Html$textarea,
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$class('text-output'),
			_1: {
				ctor: '::',
				_0: _elm_lang$html$Html_Attributes$readonly(true),
				_1: {ctor: '[]'}
			}
		},
		{
			ctor: '::',
			_0: _elm_lang$html$Html$text(text),
			_1: {ctor: '[]'}
		});
};
var _user$project$SleekView$outputPanel = function (model) {
	var outputPanelWarning = A2(
		_elm_lang$html$Html$div,
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$class('output-panel-warning'),
			_1: {
				ctor: '::',
				_0: _elm_lang$html$Html_Attributes$style(
					{
						ctor: '::',
						_0: {
							ctor: '_Tuple2',
							_0: 'top',
							_1: function (_p6) {
								return _user$project$SleekLayout$px(
									_elm_lang$core$Basics$negate(_p6));
							}(_user$project$SleekLayout$panelBorderWidth)
						},
						_1: {
							ctor: '::',
							_0: {
								ctor: '_Tuple2',
								_0: 'right',
								_1: function (_p7) {
									return _user$project$SleekLayout$px(
										_elm_lang$core$Basics$negate(_p7));
								}(_user$project$SleekLayout$panelBorderWidth)
							},
							_1: {
								ctor: '::',
								_0: {
									ctor: '_Tuple2',
									_0: 'bottom',
									_1: function (_p8) {
										return _user$project$SleekLayout$px(
											_elm_lang$core$Basics$negate(_p8));
									}(_user$project$SleekLayout$panelBorderWidth)
								},
								_1: {
									ctor: '::',
									_0: {
										ctor: '_Tuple2',
										_0: 'left',
										_1: function (_p9) {
											return _user$project$SleekLayout$px(
												_elm_lang$core$Basics$negate(_p9));
										}(_user$project$SleekLayout$panelBorderWidth)
									},
									_1: {ctor: '[]'}
								}
							}
						}
					}),
				_1: {ctor: '[]'}
			}
		},
		{ctor: '[]'});
	var dim = _user$project$SleekLayout$outputCanvas(model);
	var output = function () {
		var _p10 = {ctor: '_Tuple3', _0: model.errorBox, _1: model.outputMode, _2: model.preview};
		_v3_4:
		do {
			if (_p10._2.ctor === 'Just') {
				if (_p10._2._0.ctor === '_Tuple2') {
					if (_p10._2._0._1.ctor === 'Err') {
						return _user$project$SleekView$textOutput(_p10._2._0._1._0);
					} else {
						return A3(_user$project$Canvas$build, dim.width, dim.height, model);
					}
				} else {
					break _v3_4;
				}
			} else {
				if (_p10._0.ctor === 'Just') {
					return _user$project$SleekView$textOutput(_p10._0._0);
				} else {
					if (_p10._1.ctor === 'Print') {
						return _user$project$SleekView$textOutput(_p10._1._0);
					} else {
						break _v3_4;
					}
				}
			}
		} while(false);
		return A3(_user$project$Canvas$build, dim.width, dim.height, model);
	}();
	return A2(
		_elm_lang$html$Html$div,
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$class('panel output-panel'),
			_1: {
				ctor: '::',
				_0: _elm_lang$html$Html_Attributes$style(
					{
						ctor: '::',
						_0: {
							ctor: '_Tuple2',
							_0: 'left',
							_1: function (_p11) {
								return _user$project$SleekLayout$px(
									function (_) {
										return _.x;
									}(_p11));
							}(
								_user$project$SleekLayout$outputPanel(model))
						},
						_1: {
							ctor: '::',
							_0: {
								ctor: '_Tuple2',
								_0: 'top',
								_1: function (_p12) {
									return _user$project$SleekLayout$px(
										function (_) {
											return _.y;
										}(_p12));
								}(
									_user$project$SleekLayout$outputPanel(model))
							},
							_1: {
								ctor: '::',
								_0: {
									ctor: '_Tuple2',
									_0: 'width',
									_1: function (_p13) {
										return _user$project$SleekLayout$px(
											function (_) {
												return _.width;
											}(_p13));
									}(
										_user$project$SleekLayout$outputPanel(model))
								},
								_1: {
									ctor: '::',
									_0: {
										ctor: '_Tuple2',
										_0: 'height',
										_1: function (_p14) {
											return _user$project$SleekLayout$px(
												function (_) {
													return _.height;
												}(_p14));
										}(
											_user$project$SleekLayout$outputPanel(model))
									},
									_1: {ctor: '[]'}
								}
							}
						}
					}),
				_1: {ctor: '[]'}
			}
		},
		{
			ctor: '::',
			_0: output,
			_1: {
				ctor: '::',
				_0: outputPanelWarning,
				_1: {ctor: '[]'}
			}
		});
};
var _user$project$SleekView$proseResizer = function (model) {
	var proseResizerBB = _user$project$SleekLayout$proseResizer(model);
	return A2(
		_elm_lang$html$Html$div,
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$class('resizer prose-resizer'),
			_1: {
				ctor: '::',
				_0: _elm_lang$html$Html_Attributes$style(
					{
						ctor: '::',
						_0: {
							ctor: '_Tuple2',
							_0: 'width',
							_1: function (_p15) {
								return _user$project$SleekLayout$px(
									function (_) {
										return _.width;
									}(_p15));
							}(proseResizerBB)
						},
						_1: {
							ctor: '::',
							_0: {
								ctor: '_Tuple2',
								_0: 'height',
								_1: function (_p16) {
									return _user$project$SleekLayout$px(
										function (_) {
											return _.height;
										}(_p16));
								}(proseResizerBB)
							},
							_1: {
								ctor: '::',
								_0: {
									ctor: '_Tuple2',
									_0: 'left',
									_1: function (_p17) {
										return _user$project$SleekLayout$px(
											function (_) {
												return _.x;
											}(_p17));
									}(proseResizerBB)
								},
								_1: {
									ctor: '::',
									_0: {
										ctor: '_Tuple2',
										_0: 'top',
										_1: function (_p18) {
											return _user$project$SleekLayout$px(
												function (_) {
													return _.y;
												}(_p18));
										}(proseResizerBB)
									},
									_1: {ctor: '[]'}
								}
							}
						}
					}),
				_1: {
					ctor: '::',
					_0: _elm_lang$html$Html_Events$onMouseDown(_user$project$InterfaceController$msgDragProseResizer),
					_1: {
						ctor: '::',
						_0: _elm_lang$html$Html_Events$onMouseUp(_user$project$InterfaceController$msgClearDrag),
						_1: {ctor: '[]'}
					}
				}
			}
		},
		{
			ctor: '::',
			_0: A2(
				_elm_lang$html$Html$span,
				{
					ctor: '::',
					_0: _elm_lang$html$Html_Attributes$class('sideways'),
					_1: {ctor: '[]'}
				},
				{
					ctor: '::',
					_0: _elm_lang$html$Html$text(''),
					_1: {ctor: '[]'}
				}),
			_1: {ctor: '[]'}
		});
};
var _user$project$SleekView$mainResizer = function (model) {
	var mainResizerBB = _user$project$SleekLayout$mainResizer(model);
	return A2(
		_elm_lang$html$Html$div,
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$class('resizer main-resizer'),
			_1: {
				ctor: '::',
				_0: _elm_lang$html$Html_Attributes$style(
					{
						ctor: '::',
						_0: {
							ctor: '_Tuple2',
							_0: 'width',
							_1: function (_p19) {
								return _user$project$SleekLayout$px(
									function (_) {
										return _.width;
									}(_p19));
							}(mainResizerBB)
						},
						_1: {
							ctor: '::',
							_0: {
								ctor: '_Tuple2',
								_0: 'height',
								_1: function (_p20) {
									return _user$project$SleekLayout$px(
										function (_) {
											return _.height;
										}(_p20));
								}(mainResizerBB)
							},
							_1: {
								ctor: '::',
								_0: {
									ctor: '_Tuple2',
									_0: 'line-height',
									_1: function (_p21) {
										return _user$project$SleekLayout$px(
											function (_) {
												return _.height;
											}(_p21));
									}(mainResizerBB)
								},
								_1: {
									ctor: '::',
									_0: {
										ctor: '_Tuple2',
										_0: 'left',
										_1: function (_p22) {
											return _user$project$SleekLayout$px(
												function (_) {
													return _.x;
												}(_p22));
										}(mainResizerBB)
									},
									_1: {
										ctor: '::',
										_0: {
											ctor: '_Tuple2',
											_0: 'top',
											_1: function (_p23) {
												return _user$project$SleekLayout$px(
													function (_) {
														return _.y;
													}(_p23));
											}(mainResizerBB)
										},
										_1: {ctor: '[]'}
									}
								}
							}
						}
					}),
				_1: {
					ctor: '::',
					_0: _elm_lang$html$Html_Events$onMouseDown(_user$project$InterfaceController$msgDragMainResizer),
					_1: {
						ctor: '::',
						_0: _elm_lang$html$Html_Events$onMouseUp(_user$project$InterfaceController$msgClearDrag),
						_1: {ctor: '[]'}
					}
				}
			}
		},
		{
			ctor: '::',
			_0: _elm_lang$html$Html$text(''),
			_1: {ctor: '[]'}
		});
};
var _user$project$SleekView$fileIndicator = function (model) {
	var filenameHtml = _elm_lang$html$Html$text(
		_user$project$InterfaceModel$prettyFilename(model));
	var wrapper = model.needsSave ? A2(
		_elm_lang$html$Html$i,
		{ctor: '[]'},
		{
			ctor: '::',
			_0: filenameHtml,
			_1: {
				ctor: '::',
				_0: _elm_lang$html$Html$text(' *'),
				_1: {ctor: '[]'}
			}
		}) : filenameHtml;
	return A2(
		_elm_lang$html$Html$span,
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$class('file-indicator'),
			_1: {ctor: '[]'}
		},
		{
			ctor: '::',
			_0: wrapper,
			_1: {ctor: '[]'}
		});
};
var _user$project$SleekView$prosePanel = function (model) {
	var innerHTML = _elm_lang$core$Json_Encode$string(
		A2(
			_elm_lang$core$Maybe$withDefault,
			'',
			_user$project$Updatable$extract(model.prose)));
	var prosePanelBB = _user$project$SleekLayout$prosePanel(model);
	var prosePanelGet = function (f) {
		return function (_p24) {
			return _user$project$SleekLayout$px(
				f(_p24));
		}(prosePanelBB);
	};
	return A2(
		_elm_lang$html$Html$div,
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$class('panel prose-panel'),
			_1: {
				ctor: '::',
				_0: _elm_lang$html$Html_Attributes$style(
					{
						ctor: '::',
						_0: {
							ctor: '_Tuple2',
							_0: 'left',
							_1: prosePanelGet(
								function (_) {
									return _.x;
								})
						},
						_1: {
							ctor: '::',
							_0: {
								ctor: '_Tuple2',
								_0: 'top',
								_1: prosePanelGet(
									function (_) {
										return _.y;
									})
							},
							_1: {
								ctor: '::',
								_0: {
									ctor: '_Tuple2',
									_0: 'width',
									_1: prosePanelGet(
										function (_) {
											return _.width;
										})
								},
								_1: {
									ctor: '::',
									_0: {
										ctor: '_Tuple2',
										_0: 'height',
										_1: prosePanelGet(
											function (_) {
												return _.height;
											})
									},
									_1: {ctor: '[]'}
								}
							}
						}
					}),
				_1: {
					ctor: '::',
					_0: A2(_elm_lang$html$Html_Attributes$property, 'innerHTML', innerHTML),
					_1: {ctor: '[]'}
				}
			}
		},
		{ctor: '[]'});
};
var _user$project$SleekView$menuOptions = function (options) {
	var menuOptionDivider = A2(
		_elm_lang$html$Html$div,
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$class('menu-option-divider'),
			_1: {ctor: '[]'}
		},
		{ctor: '[]'});
	return A2(
		_elm_lang$html$Html$div,
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$class('menu-options'),
			_1: {
				ctor: '::',
				_0: _elm_lang$html$Html_Attributes$style(
					{
						ctor: '::',
						_0: {
							ctor: '_Tuple2',
							_0: 'top',
							_1: function (_p25) {
								return _user$project$SleekLayout$px(
									function (_) {
										return _.height;
									}(_p25));
							}(_user$project$SleekLayout$menuBar)
						},
						_1: {ctor: '[]'}
					}),
				_1: {ctor: '[]'}
			}
		},
		_elm_lang$core$List$concat(
			A2(
				_elm_lang$core$List$intersperse,
				{
					ctor: '::',
					_0: menuOptionDivider,
					_1: {ctor: '[]'}
				},
				options)));
};
var _user$project$SleekView$generalUiButton = F4(
	function (disabled, userClass, title, onClickHandler) {
		var disabledFlag = disabled ? 'disabled ' : '';
		return A2(
			_elm_lang$html$Html$span,
			{
				ctor: '::',
				_0: _elm_lang$html$Html_Attributes$class(
					A2(
						_elm_lang$core$Basics_ops['++'],
						'ui-button ',
						A2(_elm_lang$core$Basics_ops['++'], disabledFlag, userClass))),
				_1: {
					ctor: '::',
					_0: _elm_lang$html$Html_Events$onClick(onClickHandler),
					_1: {ctor: '[]'}
				}
			},
			{
				ctor: '::',
				_0: _elm_lang$html$Html$text(title),
				_1: {ctor: '[]'}
			});
	});
var _user$project$SleekView$styledUiButton = _user$project$SleekView$generalUiButton(false);
var _user$project$SleekView$uiButton = _user$project$SleekView$styledUiButton('');
var _user$project$SleekView$closeUiButton = A2(_user$project$SleekView$styledUiButton, 'close', '');
var _user$project$SleekView$dialogBox = function (zIndex) {
	return function (width) {
		return function (height) {
			return function (closable) {
				return function (db) {
					return function (model) {
						return function (headerStyles) {
							return function (headerElements) {
								return function (parentStyles) {
									return function (elements) {
										var activeFlag = A2(_user$project$InterfaceModel$isDialogBoxShowing, db, model) ? ' active' : '';
										var closeDialogBoxButton = _user$project$SleekView$closeUiButton(
											_user$project$InterfaceController$msgCloseDialogBox(db));
										var closeButton = closable ? {
											ctor: '::',
											_0: closeDialogBoxButton,
											_1: {ctor: '[]'}
										} : {ctor: '[]'};
										return A2(
											_elm_lang$html$Html$div,
											{
												ctor: '::',
												_0: _elm_lang$html$Html_Attributes$class(
													A2(_elm_lang$core$Basics_ops['++'], 'dialog-box', activeFlag)),
												_1: {
													ctor: '::',
													_0: _elm_lang$html$Html_Attributes$style(
														{
															ctor: '::',
															_0: {ctor: '_Tuple2', _0: 'width', _1: width},
															_1: {
																ctor: '::',
																_0: {ctor: '_Tuple2', _0: 'height', _1: height},
																_1: {
																	ctor: '::',
																	_0: {ctor: '_Tuple2', _0: 'z-index', _1: zIndex},
																	_1: {ctor: '[]'}
																}
															}
														}),
													_1: {ctor: '[]'}
												}
											},
											{
												ctor: '::',
												_0: A2(
													_elm_lang$html$Html$h1,
													{
														ctor: '::',
														_0: _elm_lang$html$Html_Attributes$style(headerStyles),
														_1: {ctor: '[]'}
													},
													{
														ctor: '::',
														_0: A2(
															_elm_lang$html$Html$div,
															{ctor: '[]'},
															headerElements),
														_1: {
															ctor: '::',
															_0: A2(
																_elm_lang$html$Html$div,
																{ctor: '[]'},
																closeButton),
															_1: {ctor: '[]'}
														}
													}),
												_1: {
													ctor: '::',
													_0: A2(
														_elm_lang$html$Html$div,
														{
															ctor: '::',
															_0: _elm_lang$html$Html_Attributes$class('content'),
															_1: {
																ctor: '::',
																_0: _elm_lang$html$Html_Attributes$style(parentStyles),
																_1: {ctor: '[]'}
															}
														},
														elements),
													_1: {ctor: '[]'}
												}
											});
									};
								};
							};
						};
					};
				};
			};
		};
	};
};
var _user$project$SleekView$bigDialogBox = A3(_user$project$SleekView$dialogBox, '100', '85%', '85%');
var _user$project$SleekView$fileNewDialogBox = function (model) {
	var viewTemplate = function (_p26) {
		var _p27 = _p26;
		var _p28 = _p27._0;
		return A3(
			_user$project$SleekView$styledUiButton,
			'wide',
			_p28,
			A2(_user$project$InterfaceController$msgAskNew, _p28, model.needsSave));
	};
	var viewCategory = function (_p29) {
		var _p30 = _p29;
		return A2(
			_elm_lang$html$Html$div,
			{ctor: '[]'},
			A2(
				_elm_lang$core$Basics_ops['++'],
				{
					ctor: '::',
					_0: A2(
						_elm_lang$html$Html$h2,
						{ctor: '[]'},
						{
							ctor: '::',
							_0: _elm_lang$html$Html$text(_p30._0),
							_1: {ctor: '[]'}
						}),
					_1: {ctor: '[]'}
				},
				A2(_elm_lang$core$List$map, viewTemplate, _p30._1)));
	};
	return A7(
		_user$project$SleekView$bigDialogBox,
		true,
		_user$project$InterfaceModel$New,
		model,
		{ctor: '[]'},
		{
			ctor: '::',
			_0: _elm_lang$html$Html$text('New from Template...'),
			_1: {ctor: '[]'}
		},
		{ctor: '[]'},
		A2(_elm_lang$core$List$map, viewCategory, _user$project$ExamplesGenerated$templateCategories));
};
var _user$project$SleekView$fileSaveAsDialogBox = function (model) {
	var currentFilesHeader = A2(
		_elm_lang$html$Html$h2,
		{ctor: '[]'},
		{
			ctor: '::',
			_0: _elm_lang$html$Html$text('Current Files'),
			_1: {ctor: '[]'}
		});
	var saveAsInput = A2(
		_elm_lang$html$Html$div,
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$class('save-as-input'),
			_1: {ctor: '[]'}
		},
		{
			ctor: '::',
			_0: A2(
				_elm_lang$html$Html$input,
				{
					ctor: '::',
					_0: _elm_lang$html$Html_Attributes$type_('text'),
					_1: {
						ctor: '::',
						_0: _elm_lang$html$Html_Events$onInput(_user$project$InterfaceController$msgUpdateFilenameInput),
						_1: {ctor: '[]'}
					}
				},
				{ctor: '[]'}),
			_1: {
				ctor: '::',
				_0: _elm_lang$html$Html$text('.little'),
				_1: {
					ctor: '::',
					_0: A2(
						_elm_lang$html$Html$span,
						{
							ctor: '::',
							_0: _elm_lang$html$Html_Attributes$class('save-as-button'),
							_1: {ctor: '[]'}
						},
						{
							ctor: '::',
							_0: A2(_user$project$SleekView$uiButton, 'Save', _user$project$InterfaceController$msgSaveAs),
							_1: {ctor: '[]'}
						}),
					_1: {ctor: '[]'}
				}
			}
		});
	return A7(
		_user$project$SleekView$bigDialogBox,
		true,
		_user$project$InterfaceModel$SaveAs,
		model,
		{ctor: '[]'},
		{
			ctor: '::',
			_0: _elm_lang$html$Html$text('Save As...'),
			_1: {ctor: '[]'}
		},
		{ctor: '[]'},
		A2(
			_elm_lang$core$Basics_ops['++'],
			{
				ctor: '::',
				_0: saveAsInput,
				_1: {
					ctor: '::',
					_0: currentFilesHeader,
					_1: {ctor: '[]'}
				}
			},
			A2(_elm_lang$core$List$map, _user$project$SleekView$viewFileIndexEntry, model.fileIndex)));
};
var _user$project$SleekView$fileOpenDialogBox = function (model) {
	var fileOpenRow = function (filename) {
		return A2(
			_elm_lang$html$Html$div,
			{
				ctor: '::',
				_0: _elm_lang$html$Html_Attributes$class('open-listing'),
				_1: {ctor: '[]'}
			},
			{
				ctor: '::',
				_0: A2(
					_elm_lang$html$Html$span,
					{ctor: '[]'},
					{
						ctor: '::',
						_0: A2(
							_elm_lang$html$Html$b,
							{ctor: '[]'},
							{
								ctor: '::',
								_0: _elm_lang$html$Html$text(filename),
								_1: {ctor: '[]'}
							}),
						_1: {
							ctor: '::',
							_0: _elm_lang$html$Html$text('.little'),
							_1: {ctor: '[]'}
						}
					}),
				_1: {
					ctor: '::',
					_0: A2(
						_elm_lang$html$Html$span,
						{
							ctor: '::',
							_0: _elm_lang$html$Html_Attributes$class('file-open-delete-buttons'),
							_1: {ctor: '[]'}
						},
						{
							ctor: '::',
							_0: A2(
								_user$project$SleekView$uiButton,
								'Open',
								A2(_user$project$InterfaceController$msgAskOpen, filename, model.needsSave)),
							_1: {
								ctor: '::',
								_0: A2(
									_elm_lang$html$Html$span,
									{
										ctor: '::',
										_0: _elm_lang$html$Html_Attributes$class('file-delete-button'),
										_1: {ctor: '[]'}
									},
									{
										ctor: '::',
										_0: A2(
											_user$project$SleekView$uiButton,
											'Delete',
											_user$project$InterfaceController$msgDelete(filename)),
										_1: {ctor: '[]'}
									}),
								_1: {ctor: '[]'}
							}
						}),
					_1: {ctor: '[]'}
				}
			});
	};
	return A7(
		_user$project$SleekView$bigDialogBox,
		true,
		_user$project$InterfaceModel$Open,
		model,
		{ctor: '[]'},
		{
			ctor: '::',
			_0: _elm_lang$html$Html$text('Open...'),
			_1: {ctor: '[]'}
		},
		{ctor: '[]'},
		A2(_elm_lang$core$List$map, fileOpenRow, model.fileIndex));
};
var _user$project$SleekView$smallDialogBox = A3(_user$project$SleekView$dialogBox, '101', '35%', '35%');
var _user$project$SleekView$alertSaveDialogBox = function (model) {
	return A7(
		_user$project$SleekView$smallDialogBox,
		false,
		_user$project$InterfaceModel$AlertSave,
		model,
		{ctor: '[]'},
		{
			ctor: '::',
			_0: A2(
				_elm_lang$html$Html$span,
				{
					ctor: '::',
					_0: _elm_lang$html$Html_Attributes$class('alert-warning'),
					_1: {ctor: '[]'}
				},
				{
					ctor: '::',
					_0: _elm_lang$html$Html$text('Warning'),
					_1: {ctor: '[]'}
				}),
			_1: {ctor: '[]'}
		},
		{
			ctor: '::',
			_0: {ctor: '_Tuple2', _0: 'display', _1: 'flex'},
			_1: {ctor: '[]'}
		},
		{
			ctor: '::',
			_0: A2(
				_elm_lang$html$Html$div,
				{
					ctor: '::',
					_0: _elm_lang$html$Html_Attributes$style(
						{
							ctor: '::',
							_0: {ctor: '_Tuple2', _0: 'padding', _1: '20px'},
							_1: {
								ctor: '::',
								_0: {ctor: '_Tuple2', _0: 'flex-grow', _1: '1'},
								_1: {
									ctor: '::',
									_0: {ctor: '_Tuple2', _0: 'display', _1: 'flex'},
									_1: {
										ctor: '::',
										_0: {ctor: '_Tuple2', _0: 'flex-direction', _1: 'column'},
										_1: {
											ctor: '::',
											_0: {ctor: '_Tuple2', _0: 'justify-content', _1: 'space-between'},
											_1: {ctor: '[]'}
										}
									}
								}
							}
						}),
					_1: {ctor: '[]'}
				},
				{
					ctor: '::',
					_0: A2(
						_elm_lang$html$Html$div,
						{ctor: '[]'},
						{
							ctor: '::',
							_0: A2(
								_elm_lang$html$Html$i,
								{ctor: '[]'},
								{
									ctor: '::',
									_0: _elm_lang$html$Html$text(
										_user$project$InterfaceModel$prettyFilename(model)),
									_1: {ctor: '[]'}
								}),
							_1: {
								ctor: '::',
								_0: _elm_lang$html$Html$text(' has unsaved changes. Would you like to continue anyway?'),
								_1: {ctor: '[]'}
							}
						}),
					_1: {
						ctor: '::',
						_0: A2(
							_elm_lang$html$Html$div,
							{
								ctor: '::',
								_0: _elm_lang$html$Html_Attributes$style(
									{
										ctor: '::',
										_0: {ctor: '_Tuple2', _0: 'text-align', _1: 'right'},
										_1: {ctor: '[]'}
									}),
								_1: {ctor: '[]'}
							},
							{
								ctor: '::',
								_0: A2(_user$project$SleekView$uiButton, 'Cancel', _user$project$InterfaceController$msgCancelFileOperation),
								_1: {
									ctor: '::',
									_0: A2(
										_elm_lang$html$Html$span,
										{
											ctor: '::',
											_0: _elm_lang$html$Html_Attributes$style(
												{
													ctor: '::',
													_0: {ctor: '_Tuple2', _0: 'margin-left', _1: '30px'},
													_1: {ctor: '[]'}
												}),
											_1: {ctor: '[]'}
										},
										{
											ctor: '::',
											_0: A2(_user$project$SleekView$uiButton, 'Yes (Discard Changes)', _user$project$InterfaceController$msgConfirmFileOperation),
											_1: {ctor: '[]'}
										}),
									_1: {ctor: '[]'}
								}
							}),
						_1: {ctor: '[]'}
					}
				}),
			_1: {ctor: '[]'}
		});
};
var _user$project$SleekView$alertGiveUpDialogBox = function (model) {
	return A7(
		_user$project$SleekView$smallDialogBox,
		false,
		_user$project$InterfaceModel$AlertGiveUp,
		model,
		{ctor: '[]'},
		{
			ctor: '::',
			_0: A2(
				_elm_lang$html$Html$span,
				{
					ctor: '::',
					_0: _elm_lang$html$Html_Attributes$class('alert-warning'),
					_1: {ctor: '[]'}
				},
				{
					ctor: '::',
					_0: _elm_lang$html$Html$text('Warning'),
					_1: {ctor: '[]'}
				}),
			_1: {ctor: '[]'}
		},
		{
			ctor: '::',
			_0: {ctor: '_Tuple2', _0: 'display', _1: 'flex'},
			_1: {ctor: '[]'}
		},
		{
			ctor: '::',
			_0: A2(
				_elm_lang$html$Html$div,
				{
					ctor: '::',
					_0: _elm_lang$html$Html_Attributes$style(
						{
							ctor: '::',
							_0: {ctor: '_Tuple2', _0: 'padding', _1: '20px'},
							_1: {
								ctor: '::',
								_0: {ctor: '_Tuple2', _0: 'flex-grow', _1: '1'},
								_1: {
									ctor: '::',
									_0: {ctor: '_Tuple2', _0: 'display', _1: 'flex'},
									_1: {
										ctor: '::',
										_0: {ctor: '_Tuple2', _0: 'flex-direction', _1: 'column'},
										_1: {
											ctor: '::',
											_0: {ctor: '_Tuple2', _0: 'justify-content', _1: 'space-between'},
											_1: {ctor: '[]'}
										}
									}
								}
							}
						}),
					_1: {ctor: '[]'}
				},
				{
					ctor: '::',
					_0: A2(
						_elm_lang$html$Html$div,
						{ctor: '[]'},
						{
							ctor: '::',
							_0: _elm_lang$html$Html$text('Are you sure you would like to give up? You will NOT be able to return to this task at a later time.'),
							_1: {ctor: '[]'}
						}),
					_1: {
						ctor: '::',
						_0: A2(
							_elm_lang$html$Html$div,
							{
								ctor: '::',
								_0: _elm_lang$html$Html_Attributes$style(
									{
										ctor: '::',
										_0: {ctor: '_Tuple2', _0: 'text-align', _1: 'right'},
										_1: {ctor: '[]'}
									}),
								_1: {ctor: '[]'}
							},
							{
								ctor: '::',
								_0: A2(_user$project$SleekView$uiButton, 'Cancel', _user$project$InterfaceController$msgCancelGiveUp),
								_1: {
									ctor: '::',
									_0: A2(
										_elm_lang$html$Html$span,
										{
											ctor: '::',
											_0: _elm_lang$html$Html_Attributes$style(
												{
													ctor: '::',
													_0: {ctor: '_Tuple2', _0: 'margin-left', _1: '30px'},
													_1: {ctor: '[]'}
												}),
											_1: {ctor: '[]'}
										},
										{
											ctor: '::',
											_0: A2(_user$project$SleekView$uiButton, 'Yes (cannot be undone)', _user$project$InterfaceController$msgConfirmGiveUp),
											_1: {ctor: '[]'}
										}),
									_1: {ctor: '[]'}
								}
							}),
						_1: {ctor: '[]'}
					}
				}),
			_1: {ctor: '[]'}
		});
};
var _user$project$SleekView$importCodeDialogBox = function (model) {
	return A7(
		_user$project$SleekView$smallDialogBox,
		true,
		_user$project$InterfaceModel$ImportCode,
		model,
		{ctor: '[]'},
		{
			ctor: '::',
			_0: _elm_lang$html$Html$text('Import Code...'),
			_1: {ctor: '[]'}
		},
		{ctor: '[]'},
		{
			ctor: '::',
			_0: A2(
				_elm_lang$html$Html$div,
				{
					ctor: '::',
					_0: _elm_lang$html$Html_Attributes$class('centered'),
					_1: {ctor: '[]'}
				},
				{
					ctor: '::',
					_0: A2(
						_elm_lang$html$Html$input,
						{
							ctor: '::',
							_0: _elm_lang$html$Html_Attributes$type_('file'),
							_1: {
								ctor: '::',
								_0: _elm_lang$html$Html_Attributes$id(_user$project$InterfaceModel$importCodeFileInputId),
								_1: {ctor: '[]'}
							}
						},
						{ctor: '[]'}),
					_1: {
						ctor: '::',
						_0: A2(
							_elm_lang$html$Html$br,
							{ctor: '[]'},
							{ctor: '[]'}),
						_1: {
							ctor: '::',
							_0: A2(
								_elm_lang$html$Html$br,
								{ctor: '[]'},
								{ctor: '[]'}),
							_1: {
								ctor: '::',
								_0: A2(
									_user$project$SleekView$uiButton,
									'Import',
									_user$project$InterfaceController$msgAskImportCode(model.needsSave)),
								_1: {ctor: '[]'}
							}
						}
					}
				}),
			_1: {ctor: '[]'}
		});
};
var _user$project$SleekView$smallWideDialogBox = A3(_user$project$SleekView$dialogBox, '101', '60%', '35%');
var _user$project$SleekView$helpDialogBox = F2(
	function (model, helpInfo) {
		return A7(
			_user$project$SleekView$smallWideDialogBox,
			true,
			_user$project$InterfaceModel$Help(helpInfo),
			model,
			{ctor: '[]'},
			{
				ctor: '::',
				_0: function () {
					var _p31 = helpInfo;
					switch (_p31.ctor) {
						case 'HelpSyntax':
							return _elm_lang$html$Html$text('Syntax Help');
						case 'HelpTextSelectMode':
							return _elm_lang$html$Html$text('Text-Select Mode Help');
						default:
							return _elm_lang$html$Html$text('Box-Select Mode Help');
					}
				}(),
				_1: {ctor: '[]'}
			},
			{ctor: '[]'},
			{
				ctor: '::',
				_0: A2(
					_elm_lang$html$Html$div,
					{
						ctor: '::',
						_0: _elm_lang$html$Html_Attributes$class('centered'),
						_1: {ctor: '[]'}
					},
					function () {
						var makeList = function (items) {
							return A2(
								_elm_lang$html$Html$ol,
								{
									ctor: '::',
									_0: _elm_lang$html$Html_Attributes$class('help-list'),
									_1: {ctor: '[]'}
								},
								A2(
									_elm_lang$core$List$map,
									function (s) {
										return A2(
											_elm_lang$html$Html$li,
											{ctor: '[]'},
											{
												ctor: '::',
												_0: _elm_lang$html$Html$text(s),
												_1: {ctor: '[]'}
											});
									},
									items));
						};
						var _p32 = helpInfo;
						switch (_p32.ctor) {
							case 'HelpSyntax':
								return {
									ctor: '::',
									_0: A2(
										_elm_lang$html$Html$pre,
										{ctor: '[]'},
										{
											ctor: '::',
											_0: _elm_lang$html$Html$text(_user$project$UserStudy$syntaxHelp),
											_1: {ctor: '[]'}
										}),
									_1: {ctor: '[]'}
								};
							case 'HelpTextSelectMode':
								return {
									ctor: '::',
									_0: makeList(_user$project$UserStudy$textSelectHelp),
									_1: {
										ctor: '::',
										_0: A2(
											_elm_lang$html$Html$br,
											{ctor: '[]'},
											{ctor: '[]'}),
										_1: {
											ctor: '::',
											_0: _elm_lang$html$Html$text('The Escape key resets all selections and tools.'),
											_1: {ctor: '[]'}
										}
									}
								};
							default:
								return {
									ctor: '::',
									_0: makeList(_user$project$UserStudy$boxSelectHelp),
									_1: {
										ctor: '::',
										_0: A2(
											_elm_lang$html$Html$br,
											{ctor: '[]'},
											{ctor: '[]'}),
										_1: {
											ctor: '::',
											_0: _elm_lang$html$Html$text('The Escape key deselects all selected boxes.'),
											_1: {ctor: '[]'}
										}
									}
								};
						}
					}()),
				_1: {ctor: '[]'}
			});
	});
var _user$project$SleekView$dialogBoxes = function (model) {
	return {
		ctor: '::',
		_0: _user$project$SleekView$fileNewDialogBox(model),
		_1: {
			ctor: '::',
			_0: _user$project$SleekView$fileSaveAsDialogBox(model),
			_1: {
				ctor: '::',
				_0: _user$project$SleekView$fileOpenDialogBox(model),
				_1: {
					ctor: '::',
					_0: _user$project$SleekView$alertSaveDialogBox(model),
					_1: {
						ctor: '::',
						_0: _user$project$SleekView$alertGiveUpDialogBox(model),
						_1: {
							ctor: '::',
							_0: _user$project$SleekView$importCodeDialogBox(model),
							_1: {
								ctor: '::',
								_0: A2(_user$project$SleekView$helpDialogBox, model, _user$project$InterfaceModel$HelpSyntax),
								_1: {
									ctor: '::',
									_0: A2(_user$project$SleekView$helpDialogBox, model, _user$project$InterfaceModel$HelpTextSelectMode),
									_1: {
										ctor: '::',
										_0: A2(_user$project$SleekView$helpDialogBox, model, _user$project$InterfaceModel$HelpBoxSelectMode),
										_1: {ctor: '[]'}
									}
								}
							}
						}
					}
				}
			}
		}
	};
};
var _user$project$SleekView$popupPanel = function (args) {
	var _p33 = A2(_user$project$Utils$mapBoth, _user$project$SleekLayout$px, args.pos);
	var xString = _p33._0;
	var yString = _p33._1;
	var dragger = {
		ctor: '::',
		_0: A2(
			_elm_lang$html$Html$div,
			{
				ctor: '::',
				_0: _elm_lang$html$Html_Attributes$class('dragger'),
				_1: {
					ctor: '::',
					_0: _elm_lang$html$Html_Events$onMouseDown(args.dragHandler),
					_1: {
						ctor: '::',
						_0: _elm_lang$html$Html_Events$onMouseUp(_user$project$InterfaceController$msgClearDrag),
						_1: {ctor: '[]'}
					}
				}
			},
			A2(
				_elm_lang$core$Basics_ops['++'],
				args.title,
				{
					ctor: '::',
					_0: _user$project$SleekView$closeUiButton(
						_user$project$InterfaceController$msgKeyDown(_user$project$Keys$keyEsc)),
					_1: {ctor: '[]'}
				})),
		_1: {ctor: '[]'}
	};
	var disabledFlag = args.disabled ? 'disabled ' : '';
	return A2(
		_elm_lang$html$Html$div,
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$class(
				A2(
					_elm_lang$core$Basics_ops['++'],
					'popup-panel panel ',
					A2(_elm_lang$core$Basics_ops['++'], disabledFlag, args.$class))),
			_1: {
				ctor: '::',
				_0: _elm_lang$html$Html_Attributes$style(
					{
						ctor: '::',
						_0: {ctor: '_Tuple2', _0: 'left', _1: xString},
						_1: {
							ctor: '::',
							_0: {ctor: '_Tuple2', _0: 'top', _1: yString},
							_1: {ctor: '[]'}
						}
					}),
				_1: {ctor: '[]'}
			}
		},
		A2(_elm_lang$core$Basics_ops['++'], dragger, args.content));
};
var _user$project$SleekView$logMouseOver = function (itemDescription) {
	return {
		ctor: '::',
		_0: _elm_lang$html$Html_Events$onMouseOver(
			A2(
				_user$project$InterfaceModel$Msg,
				A2(_elm_lang$core$Basics_ops['++'], 'Hover ', itemDescription),
				_elm_lang$core$Basics$identity)),
		_1: {
			ctor: '::',
			_0: _elm_lang$html$Html_Events$onMouseOut(
				A2(
					_user$project$InterfaceModel$Msg,
					A2(_elm_lang$core$Basics_ops['++'], 'Leave ', itemDescription),
					_elm_lang$core$Basics$identity)),
			_1: {ctor: '[]'}
		}
	};
};
var _user$project$SleekView$menuHeading = function (heading) {
	var attributes = A2(
		_elm_lang$core$Basics_ops['++'],
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$class('menu-heading'),
			_1: {
				ctor: '::',
				_0: A3(
					_elm_lang$html$Html_Events$onWithOptions,
					'click',
					{stopPropagation: true, preventDefault: false},
					_elm_lang$core$Json_Decode$succeed(_user$project$InterfaceController$msgToggleMenu)),
				_1: {
					ctor: '::',
					_0: _elm_lang$html$Html_Attributes$style(
						{
							ctor: '::',
							_0: {
								ctor: '_Tuple2',
								_0: 'height',
								_1: function (_p34) {
									return _user$project$SleekLayout$px(
										function (_) {
											return _.height;
										}(_p34));
								}(_user$project$SleekLayout$menuBar)
							},
							_1: {
								ctor: '::',
								_0: {
									ctor: '_Tuple2',
									_0: 'line-height',
									_1: function (_p35) {
										return _user$project$SleekLayout$px(
											function (_) {
												return _.height;
											}(_p35));
									}(_user$project$SleekLayout$menuBar)
								},
								_1: {
									ctor: '::',
									_0: {
										ctor: '_Tuple2',
										_0: 'padding',
										_1: A2(
											_elm_lang$core$Basics_ops['++'],
											'0 ',
											function (_p36) {
												return _user$project$SleekLayout$px(
													_user$project$SleekLayout$half(
														function (_) {
															return _.height;
														}(_p36)));
											}(_user$project$SleekLayout$menuBar))
									},
									_1: {ctor: '[]'}
								}
							}
						}),
					_1: {ctor: '[]'}
				}
			}
		},
		_user$project$SleekView$logMouseOver(
			A2(
				_elm_lang$core$Basics_ops['++'],
				'Menu \"',
				A2(_elm_lang$core$Basics_ops['++'], heading, '\"'))));
	return A2(
		_elm_lang$html$Html$div,
		attributes,
		{
			ctor: '::',
			_0: _elm_lang$html$Html$text(heading),
			_1: {ctor: '[]'}
		});
};
var _user$project$SleekView$menu = F2(
	function (heading, options) {
		return A2(
			_elm_lang$html$Html$div,
			{
				ctor: '::',
				_0: _elm_lang$html$Html_Attributes$class('menu'),
				_1: {ctor: '[]'}
			},
			{
				ctor: '::',
				_0: _user$project$SleekView$menuHeading(heading),
				_1: {
					ctor: '::',
					_0: _user$project$SleekView$menuOptions(options),
					_1: {ctor: '[]'}
				}
			});
	});
var _user$project$SleekView$textButton = function (tb) {
	var _p37 = tb.disabled ? {ctor: '_Tuple3', _0: ' disabled', _1: _user$project$InterfaceController$msgNoop, _2: true} : {ctor: '_Tuple3', _0: '', _1: tb.onClick, _2: tb.stopPropagation};
	var disabledFlag = _p37._0;
	var realOnClick = _p37._1;
	var realStopPropagation = _p37._2;
	return A2(
		_elm_lang$html$Html$span,
		A2(
			_elm_lang$core$Basics_ops['++'],
			{
				ctor: '::',
				_0: _elm_lang$html$Html_Attributes$class(
					A2(_elm_lang$core$Basics_ops['++'], 'text-button', disabledFlag)),
				_1: {
					ctor: '::',
					_0: A3(
						_elm_lang$html$Html_Events$onWithOptions,
						'click',
						{stopPropagation: realStopPropagation, preventDefault: false},
						_elm_lang$core$Json_Decode$succeed(realOnClick)),
					_1: {ctor: '[]'}
				}
			},
			tb.attributes),
		tb.content);
};
var _user$project$SleekView$defaultTb = {
	attributes: {ctor: '[]'},
	content: {ctor: '[]'},
	onClick: _user$project$InterfaceController$msgNoop,
	disabled: false,
	stopPropagation: false
};
var _user$project$SleekView$simpleHtmlTextButton = function (content) {
	return _user$project$SleekView$textButton(
		_elm_lang$core$Native_Utils.update(
			_user$project$SleekView$defaultTb,
			{content: content}));
};
var _user$project$SleekView$disableableTextButton = F3(
	function (disabled, title, onClick) {
		return _user$project$SleekView$textButton(
			_elm_lang$core$Native_Utils.update(
				_user$project$SleekView$defaultTb,
				{
					content: {
						ctor: '::',
						_0: _elm_lang$html$Html$text(title),
						_1: {ctor: '[]'}
					},
					onClick: onClick,
					disabled: disabled,
					attributes: _user$project$SleekView$logMouseOver(
						A2(
							_elm_lang$core$Basics_ops['++'],
							'Button \"',
							A2(_elm_lang$core$Basics_ops['++'], title, '\"')))
				}));
	});
var _user$project$SleekView$simpleTextButton = _user$project$SleekView$disableableTextButton(false);
var _user$project$SleekView$relateTextButton = F3(
	function (model, text, onClickHandler) {
		var noFeatures = _elm_lang$core$Set$isEmpty(model.selectedFeatures);
		return A3(_user$project$SleekView$disableableTextButton, noFeatures, text, onClickHandler);
	});
var _user$project$SleekView$groupTextButton = F4(
	function (model, text, onClickHandler, disallowSelectedFeatures) {
		var noBlobs = _elm_lang$core$Dict$isEmpty(model.selectedBlobs);
		var noFeatures = _elm_lang$core$Set$isEmpty(model.selectedFeatures);
		return A3(_user$project$SleekView$disableableTextButton, noBlobs || (disallowSelectedFeatures && (!noFeatures)), text, onClickHandler);
	});
var _user$project$SleekView$simpleTextRadioButton = F3(
	function (active, title, onClick) {
		var _p38 = active ? {ctor: '_Tuple2', _0: 'radio-button-active', _1: ''} : {ctor: '_Tuple2', _0: '', _1: ''};
		var activeFlag = _p38._0;
		var radioButtonIcon = _p38._1;
		return _user$project$SleekView$textButton(
			_elm_lang$core$Native_Utils.update(
				_user$project$SleekView$defaultTb,
				{
					content: {
						ctor: '::',
						_0: A2(
							_elm_lang$html$Html$span,
							{
								ctor: '::',
								_0: _elm_lang$html$Html_Attributes$class('radio-button-icon'),
								_1: {ctor: '[]'}
							},
							{
								ctor: '::',
								_0: _elm_lang$html$Html$text(radioButtonIcon),
								_1: {ctor: '[]'}
							}),
						_1: {
							ctor: '::',
							_0: A2(
								_elm_lang$html$Html$span,
								{
									ctor: '::',
									_0: _elm_lang$html$Html_Attributes$class(activeFlag),
									_1: {ctor: '[]'}
								},
								{
									ctor: '::',
									_0: _elm_lang$html$Html$text(title),
									_1: {ctor: '[]'}
								}),
							_1: {ctor: '[]'}
						}
					},
					onClick: onClick,
					attributes: _user$project$SleekView$logMouseOver(
						A2(
							_elm_lang$core$Basics_ops['++'],
							'Radio Button \"',
							A2(
								_elm_lang$core$Basics_ops['++'],
								radioButtonIcon,
								A2(
									_elm_lang$core$Basics_ops['++'],
									' ',
									A2(_elm_lang$core$Basics_ops['++'], title, '\"')))))
				}));
	});
var _user$project$SleekView$booleanOption = F4(
	function (test, onString, offString, handler) {
		return {
			ctor: '::',
			_0: A3(
				_user$project$SleekView$simpleTextRadioButton,
				test,
				onString,
				handler(true)),
			_1: {
				ctor: '::',
				_0: A3(
					_user$project$SleekView$simpleTextRadioButton,
					!test,
					offString,
					handler(false)),
				_1: {ctor: '[]'}
			}
		};
	});
var _user$project$SleekView$generalHtmlHoverMenu = F7(
	function ($class, titleHtml, onMouseEnter, onMouseLeave, onClick, disabled, dropdownContent) {
		var _p39 = disabled ? {ctor: '_Tuple4', _0: 'disabled ', _1: _user$project$InterfaceController$msgNoop, _2: _user$project$InterfaceController$msgNoop, _3: _user$project$InterfaceController$msgNoop} : {ctor: '_Tuple4', _0: '', _1: onMouseEnter, _2: onMouseLeave, _3: onClick};
		var disabledFlag = _p39._0;
		var realOnMouseEnter = _p39._1;
		var realOnMouseLeave = _p39._2;
		var realOnClick = _p39._3;
		return A2(
			_elm_lang$html$Html$div,
			{
				ctor: '::',
				_0: _elm_lang$html$Html_Attributes$class(
					A2(
						_elm_lang$core$Basics_ops['++'],
						'hover-menu ',
						A2(_elm_lang$core$Basics_ops['++'], disabledFlag, $class))),
				_1: {
					ctor: '::',
					_0: _elm_lang$html$Html_Events$onMouseEnter(realOnMouseEnter),
					_1: {
						ctor: '::',
						_0: _elm_lang$html$Html_Events$onMouseLeave(realOnMouseLeave),
						_1: {ctor: '[]'}
					}
				}
			},
			{
				ctor: '::',
				_0: A2(
					_elm_lang$html$Html$div,
					{
						ctor: '::',
						_0: _elm_lang$html$Html_Attributes$class('hover-menu-title'),
						_1: {ctor: '[]'}
					},
					{
						ctor: '::',
						_0: _user$project$SleekView$textButton(
							_elm_lang$core$Native_Utils.update(
								_user$project$SleekView$defaultTb,
								{
									content: {
										ctor: '::',
										_0: A2(
											_elm_lang$html$Html$span,
											{
												ctor: '::',
												_0: _elm_lang$html$Html_Attributes$class('hover-menu-content'),
												_1: {ctor: '[]'}
											},
											titleHtml),
										_1: {
											ctor: '::',
											_0: A2(
												_elm_lang$html$Html$span,
												{
													ctor: '::',
													_0: _elm_lang$html$Html_Attributes$class('hover-menu-indicator'),
													_1: {ctor: '[]'}
												},
												{
													ctor: '::',
													_0: _elm_lang$html$Html$text(''),
													_1: {ctor: '[]'}
												}),
											_1: {ctor: '[]'}
										}
									},
									disabled: disabled,
									stopPropagation: true,
									onClick: realOnClick
								})),
						_1: {ctor: '[]'}
					}),
				_1: {
					ctor: '::',
					_0: A2(
						_elm_lang$html$Html$div,
						{
							ctor: '::',
							_0: _elm_lang$html$Html_Attributes$class('dropdown-content'),
							_1: {ctor: '[]'}
						},
						dropdownContent),
					_1: {ctor: '[]'}
				}
			});
	});
var _user$project$SleekView$generalHoverMenu = function (titleString) {
	return A2(
		_user$project$SleekView$generalHtmlHoverMenu,
		'',
		{
			ctor: '::',
			_0: _elm_lang$html$Html$text(titleString),
			_1: {ctor: '[]'}
		});
};
var _user$project$SleekView$hoverMenu = F2(
	function (title, dropdownContent) {
		return A6(_user$project$SleekView$generalHoverMenu, title, _user$project$InterfaceController$msgNoop, _user$project$InterfaceController$msgNoop, _user$project$InterfaceController$msgNoop, false, dropdownContent);
	});
var _user$project$SleekView$italicizeQuotes = F2(
	function (quoteString, text) {
		var mapper = function (_p40) {
			var _p41 = _p40;
			var _p42 = _p41._1;
			return _user$project$Utils$isEven(_p41._0) ? _elm_lang$html$Html$text(_p42) : A2(
				_elm_lang$html$Html$i,
				{ctor: '[]'},
				{
					ctor: '::',
					_0: _elm_lang$html$Html$text(_p42),
					_1: {ctor: '[]'}
				});
		};
		var splitString = A2(_elm_lang$core$String$split, quoteString, text);
		return A2(_user$project$Utils$mapi0, mapper, splitString);
	});
var _user$project$SleekView$editCodeEntry = F2(
	function (model, _p43) {
		var _p44 = _p43;
		var _p45 = _p44._1._0;
		var disabled = A2(_elm_lang$core$List$any, _user$project$InterfaceModel$predicateImpossible, _p45.reqs) || (!_user$project$InterfaceModel$noWidgetsSelected(model));
		var isRenamer = _user$project$DeuceTools$isRenamer(_p45);
		var name = A2(_elm_lang$core$Basics_ops['++'], _p45.name, '...');
		var title = isRenamer ? A2(_user$project$SleekView$italicizeQuotes, '\'', name) : {
			ctor: '::',
			_0: _elm_lang$html$Html$text(name),
			_1: {ctor: '[]'}
		};
		return _user$project$SleekView$textButton(
			_elm_lang$core$Native_Utils.update(
				_user$project$SleekView$defaultTb,
				{
					content: title,
					disabled: disabled,
					onClick: A2(_user$project$InterfaceController$msgSetSelectedDeuceTool, true, _p44._1),
					attributes: _user$project$SleekView$logMouseOver(
						A2(
							_elm_lang$core$Basics_ops['++'],
							'Edit Code Top Menu Item \"',
							A2(_elm_lang$core$Basics_ops['++'], name, '\"')))
				}));
	});
var _user$project$SleekView$deuceRightClickMenuEntry = F2(
	function (model, _p46) {
		var _p47 = _p46;
		var _p48 = _p47._1._0;
		var disabled = A2(_elm_lang$core$List$any, _user$project$InterfaceModel$predicateImpossible, _p48.reqs);
		var isRenamer = _user$project$DeuceTools$isRenamer(_p48);
		var name = A2(_elm_lang$core$Basics_ops['++'], _p48.name, '...');
		var title = isRenamer ? A2(_user$project$SleekView$italicizeQuotes, '\'', name) : {
			ctor: '::',
			_0: _elm_lang$html$Html$text(name),
			_1: {ctor: '[]'}
		};
		return disabled ? {ctor: '[]'} : {
			ctor: '::',
			_0: _user$project$SleekView$textButton(
				_elm_lang$core$Native_Utils.update(
					_user$project$SleekView$defaultTb,
					{
						content: title,
						onClick: A2(_user$project$InterfaceController$msgSetSelectedDeuceTool, false, _p47._1),
						attributes: _user$project$SleekView$logMouseOver(
							A2(
								_elm_lang$core$Basics_ops['++'],
								'Button (Deuce Right-Click Menu) \"',
								A2(_elm_lang$core$Basics_ops['++'], name, '\"')))
					})),
			_1: {ctor: '[]'}
		};
	});
var _user$project$SleekView$deuceRightClickMenu = function (model) {
	var content = {
		ctor: '::',
		_0: A2(
			_elm_lang$html$Html$div,
			{
				ctor: '::',
				_0: _elm_lang$html$Html_Attributes$class('deuce-right-click-menu'),
				_1: {ctor: '[]'}
			},
			_elm_lang$core$List$concat(
				A2(
					_elm_lang$core$List$concatMap,
					_user$project$Utils$mapi1(
						_user$project$SleekView$deuceRightClickMenuEntry(model)),
					model.deuceToolsAndResults))),
		_1: {ctor: '[]'}
	};
	var disabled = (!model.enableDeuceTextSelection) || (!_user$project$InterfaceModel$deuceRightClickMenuShown(model));
	return _user$project$SleekView$popupPanel(
		{
			pos: model.popupPanelPositions.deuceRightClickMenu,
			disabled: disabled,
			dragHandler: _user$project$InterfaceController$msgDragDeuceRightClickMenu,
			$class: '',
			title: {
				ctor: '::',
				_0: _elm_lang$html$Html$text('Code Tools'),
				_1: {ctor: '[]'}
			},
			content: content
		});
};
var _user$project$SleekView$enterKeyCode = 13;
var _user$project$SleekView$onKeyDown = function (tagger) {
	return A2(
		_elm_lang$html$Html_Events$on,
		'keydown',
		A2(_elm_lang$core$Json_Decode$map, tagger, _elm_lang$html$Html_Events$keyCode));
};
var _user$project$SleekView$onRightClick = function (handler) {
	return A3(
		_elm_lang$html$Html_Events$onWithOptions,
		'contextmenu',
		{stopPropagation: true, preventDefault: true},
		_elm_lang$core$Json_Decode$succeed(handler));
};
var _user$project$SleekView$codePanel = function (model) {
	var statusBar = A2(
		_elm_lang$html$Html$div,
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$class('status-bar'),
			_1: {ctor: '[]'}
		},
		A2(
			_elm_lang$core$Basics_ops['++'],
			_user$project$UserStudy$hideIfEnabled(
				{
					ctor: '::',
					_0: A2(
						_elm_lang$html$Html$span,
						{ctor: '[]'},
						{
							ctor: '::',
							_0: A2(
								_elm_lang$html$Html$b,
								{ctor: '[]'},
								{
									ctor: '::',
									_0: _elm_lang$html$Html$text('Current file: '),
									_1: {ctor: '[]'}
								}),
							_1: {
								ctor: '::',
								_0: _user$project$SleekView$fileIndicator(model),
								_1: {ctor: '[]'}
							}
						}),
					_1: {ctor: '[]'}
				}),
			{
				ctor: '::',
				_0: A2(
					_elm_lang$html$Html$div,
					{
						ctor: '::',
						_0: _elm_lang$html$Html_Attributes$class('needs-run-light'),
						_1: {ctor: '[]'}
					},
					{ctor: '[]'}),
				_1: {ctor: '[]'}
			}));
	var editor = A2(
		_elm_lang$html$Html$div,
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$id('editor'),
			_1: {
				ctor: '::',
				_0: _user$project$SleekView$onRightClick(
					_user$project$InterfaceController$msgDeuceRightClick(_user$project$InterfaceModel$ShowPossible)),
				_1: {ctor: '[]'}
			}
		},
		{ctor: '[]'});
	var runButton = A2(
		_elm_lang$html$Html$div,
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$class('run'),
			_1: {
				ctor: '::',
				_0: _elm_lang$html$Html_Events$onClick(_user$project$InterfaceController$msgRun),
				_1: {ctor: '[]'}
			}
		},
		{
			ctor: '::',
			_0: _elm_lang$html$Html$text('Run '),
			_1: {ctor: '[]'}
		});
	var cleanButton = function () {
		var disabled = function () {
			var _p49 = model.outputMode;
			if (_p49.ctor === 'Live') {
				return false;
			} else {
				return true;
			}
		}();
		return A3(_user$project$SleekView$disableableTextButton, disabled, 'Clean Up', _user$project$InterfaceController$msgCleanCode);
	}();
	var redoButton = function () {
		var future = _user$project$History$next(model.history);
		var attributes = function () {
			var _p50 = {ctor: '_Tuple2', _0: _user$project$UserStudy$enabled, _1: future};
			if (((_p50.ctor === '_Tuple2') && (_p50._0 === false)) && (_p50._1.ctor === 'Just')) {
				return {
					ctor: '::',
					_0: _elm_lang$html$Html_Events$onMouseEnter(
						_user$project$InterfaceController$msgPreview(
							_user$project$Either$Right(_p50._1._0.code))),
					_1: {
						ctor: '::',
						_0: _elm_lang$html$Html_Events$onMouseLeave(_user$project$InterfaceController$msgClearPreview),
						_1: {ctor: '[]'}
					}
				};
			} else {
				return {ctor: '[]'};
			}
		}();
		return _user$project$SleekView$textButton(
			_elm_lang$core$Native_Utils.update(
				_user$project$SleekView$defaultTb,
				{
					attributes: A2(
						_elm_lang$core$Basics_ops['++'],
						attributes,
						_user$project$SleekView$logMouseOver('Redo')),
					content: {
						ctor: '::',
						_0: _elm_lang$html$Html$text(' Redo'),
						_1: {ctor: '[]'}
					},
					onClick: _user$project$InterfaceController$msgRedo,
					disabled: !_user$project$History$hasFuture(model.history)
				}));
	}();
	var undoButton = function () {
		var past = _user$project$History$prior(model.history);
		var attributes = function () {
			var _p51 = {ctor: '_Tuple2', _0: _user$project$UserStudy$enabled, _1: past};
			if (((_p51.ctor === '_Tuple2') && (_p51._0 === false)) && (_p51._1.ctor === 'Just')) {
				return {
					ctor: '::',
					_0: _elm_lang$html$Html_Events$onMouseEnter(
						_user$project$InterfaceController$msgPreview(
							_user$project$Either$Right(_p51._1._0.code))),
					_1: {
						ctor: '::',
						_0: _elm_lang$html$Html_Events$onMouseLeave(_user$project$InterfaceController$msgClearPreview),
						_1: {ctor: '[]'}
					}
				};
			} else {
				return {ctor: '[]'};
			}
		}();
		return _user$project$SleekView$textButton(
			_elm_lang$core$Native_Utils.update(
				_user$project$SleekView$defaultTb,
				{
					attributes: A2(
						_elm_lang$core$Basics_ops['++'],
						attributes,
						_user$project$SleekView$logMouseOver('Undo')),
					content: {
						ctor: '::',
						_0: _elm_lang$html$Html$text(' Undo'),
						_1: {ctor: '[]'}
					},
					onClick: _user$project$InterfaceController$msgUndo,
					disabled: !_user$project$History$hasExtendedPast(model.history)
				}));
	}();
	var actionBar = A2(
		_elm_lang$html$Html$div,
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$class('action-bar'),
			_1: {ctor: '[]'}
		},
		A2(
			_elm_lang$core$Basics_ops['++'],
			{
				ctor: '::',
				_0: undoButton,
				_1: {
					ctor: '::',
					_0: redoButton,
					_1: {ctor: '[]'}
				}
			},
			A2(
				_elm_lang$core$Basics_ops['++'],
				_user$project$UserStudy$hideIfEnabled(
					{
						ctor: '::',
						_0: cleanButton,
						_1: {ctor: '[]'}
					}),
				_user$project$Updatable$extract(model.enableTextEdits) ? {
					ctor: '::',
					_0: runButton,
					_1: {ctor: '[]'}
				} : {ctor: '[]'})));
	return A2(
		_elm_lang$html$Html$div,
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$class('panel code-panel'),
			_1: {
				ctor: '::',
				_0: _elm_lang$html$Html_Attributes$style(
					{
						ctor: '::',
						_0: {
							ctor: '_Tuple2',
							_0: 'left',
							_1: function (_p52) {
								return _user$project$SleekLayout$px(
									function (_) {
										return _.x;
									}(_p52));
							}(
								_user$project$SleekLayout$codePanel(model))
						},
						_1: {
							ctor: '::',
							_0: {
								ctor: '_Tuple2',
								_0: 'top',
								_1: function (_p53) {
									return _user$project$SleekLayout$px(
										function (_) {
											return _.y;
										}(_p53));
								}(
									_user$project$SleekLayout$codePanel(model))
							},
							_1: {
								ctor: '::',
								_0: {
									ctor: '_Tuple2',
									_0: 'width',
									_1: function (_p54) {
										return _user$project$SleekLayout$px(
											function (_) {
												return _.width;
											}(_p54));
									}(
										_user$project$SleekLayout$codePanel(model))
								},
								_1: {
									ctor: '::',
									_0: {
										ctor: '_Tuple2',
										_0: 'height',
										_1: function (_p55) {
											return _user$project$SleekLayout$px(
												function (_) {
													return _.height;
												}(_p55));
										}(
											_user$project$SleekLayout$codePanel(model))
									},
									_1: {ctor: '[]'}
								}
							}
						}
					}),
				_1: {ctor: '[]'}
			}
		},
		{
			ctor: '::',
			_0: statusBar,
			_1: {
				ctor: '::',
				_0: actionBar,
				_1: {
					ctor: '::',
					_0: editor,
					_1: {ctor: '[]'}
				}
			}
		});
};
var _user$project$SleekView$onClickWithoutPropagation = function (handler) {
	return A3(
		_elm_lang$html$Html_Events$onWithOptions,
		'click',
		{stopPropagation: true, preventDefault: false},
		_elm_lang$core$Json_Decode$succeed(handler));
};
var _user$project$SleekView$deuceSynthesisResult = F4(
	function (model, path, isRenamer, _p56) {
		var _p57 = _p56;
		var _p59 = _p57._0;
		var renameInput = isRenamer ? {
			ctor: '::',
			_0: A2(
				_elm_lang$html$Html$input,
				{
					ctor: '::',
					_0: _elm_lang$html$Html_Attributes$type_('text'),
					_1: {
						ctor: '::',
						_0: _elm_lang$html$Html_Attributes$class('rename-input'),
						_1: {
							ctor: '::',
							_0: _elm_lang$html$Html_Events$onInput(_user$project$InterfaceController$msgUpdateRenameVarTextBox),
							_1: {
								ctor: '::',
								_0: _user$project$SleekView$onClickWithoutPropagation(_user$project$InterfaceController$msgNoop),
								_1: {
									ctor: '::',
									_0: _user$project$SleekView$onKeyDown(
										function (code) {
											return _elm_lang$core$Native_Utils.eq(code, _user$project$SleekView$enterKeyCode) ? A2(_user$project$InterfaceController$msgChooseDeuceExp, _p59.description, _p59.exp) : _user$project$InterfaceController$msgNoop;
										}),
									_1: {ctor: '[]'}
								}
							}
						}
					}
				},
				{ctor: '[]'}),
			_1: {ctor: '[]'}
		} : {ctor: '[]'};
		var additionalInputs = renameInput;
		var $class = function () {
			var _p58 = A2(_elm_lang$core$Dict$get, path, model.deuceToolResultPreviews);
			if (_p58.ctor === 'Nothing') {
				return isRenamer ? '' : (_p59.isSafe ? 'expected-safe' : 'expected-unsafe');
			} else {
				return _p58._0._1;
			}
		}();
		var alreadyRun = A2(_elm_lang$core$Dict$member, path, model.deuceToolResultPreviews);
		var description = isRenamer ? A2(_user$project$SleekView$italicizeQuotes, '\'', _p59.description) : {
			ctor: '::',
			_0: _elm_lang$html$Html$text(
				alreadyRun ? _p59.description : _p59.description),
			_1: {ctor: '[]'}
		};
		return A7(
			_user$project$SleekView$generalHtmlHoverMenu,
			$class,
			A2(
				_elm_lang$core$Basics_ops['++'],
				{
					ctor: '::',
					_0: A2(
						_elm_lang$html$Html$span,
						{ctor: '[]'},
						description),
					_1: {ctor: '[]'}
				},
				additionalInputs),
			A3(
				_user$project$InterfaceController$msgHoverDeuceResult,
				isRenamer,
				_user$project$InterfaceModel$SynthesisResult(_p59),
				path),
			A2(
				_user$project$InterfaceController$msgLeaveDeuceResult,
				_user$project$InterfaceModel$SynthesisResult(_p59),
				path),
			A2(_user$project$InterfaceController$msgChooseDeuceExp, _p59.description, _p59.exp),
			false,
			{ctor: '[]'});
	});
var _user$project$SleekView$deuceSynthesisResults = F4(
	function (model, path, isRenamer, results) {
		return _elm_lang$core$List$isEmpty(results) ? {
			ctor: '::',
			_0: A7(
				_user$project$SleekView$generalHtmlHoverMenu,
				'transformation-oops',
				{
					ctor: '::',
					_0: A2(
						_elm_lang$html$Html$span,
						{ctor: '[]'},
						{
							ctor: '::',
							_0: _elm_lang$html$Html$text('Oops! Can\'t apply transformation after all.'),
							_1: {ctor: '[]'}
						}),
					_1: {ctor: '[]'}
				},
				_user$project$InterfaceController$msgNoop,
				_user$project$InterfaceController$msgNoop,
				_user$project$InterfaceController$msgNoop,
				true,
				{ctor: '[]'}),
			_1: {ctor: '[]'}
		} : A2(
			_user$project$Utils$mapi1,
			function (_p60) {
				var _p61 = _p60;
				return A4(
					_user$project$SleekView$deuceSynthesisResult,
					model,
					A2(
						_elm_lang$core$Basics_ops['++'],
						path,
						{
							ctor: '::',
							_0: _p61._0,
							_1: {ctor: '[]'}
						}),
					isRenamer,
					_p61._1);
			},
			results);
	});
var _user$project$SleekView$deuceHoverMenu = F2(
	function (model, _p62) {
		var _p63 = _p62;
		var _p64 = _p63._1._0;
		var isRenamer = _user$project$DeuceTools$isRenamer(_p64);
		var title = isRenamer ? A2(_user$project$SleekView$italicizeQuotes, '\'', _p64.name) : {
			ctor: '::',
			_0: _elm_lang$html$Html$text(_p64.name),
			_1: {ctor: '[]'}
		};
		var path = {
			ctor: '::',
			_0: _p63._0,
			_1: {ctor: '[]'}
		};
		return A7(
			_user$project$SleekView$generalHtmlHoverMenu,
			'',
			title,
			_user$project$InterfaceController$msgNoop,
			_user$project$InterfaceController$msgNoop,
			_user$project$InterfaceController$msgNoop,
			_p63._1._2,
			{
				ctor: '::',
				_0: A2(
					_elm_lang$html$Html$div,
					{
						ctor: '::',
						_0: _elm_lang$html$Html_Attributes$class('synthesis-results'),
						_1: {ctor: '[]'}
					},
					A4(_user$project$SleekView$deuceSynthesisResults, model, path, isRenamer, _p63._1._1)),
				_1: {ctor: '[]'}
			});
	});
var _user$project$SleekView$deucePopupPanel = function (model) {
	var appearDirectionFlag = model.deucePopupPanelAbove ? 'appear-above' : 'appear-below';
	return _user$project$SleekView$popupPanel(
		{
			pos: model.popupPanelPositions.deuce,
			disabled: !_user$project$InterfaceModel$deucePopupPanelShown(model),
			dragHandler: _user$project$InterfaceController$msgDragDeucePopupPanel,
			$class: A2(_elm_lang$core$Basics_ops['++'], 'deuce-popup-panel ', appearDirectionFlag),
			title: {
				ctor: '::',
				_0: _elm_lang$html$Html$text('Code Tools'),
				_1: {ctor: '[]'}
			},
			content: {
				ctor: '::',
				_0: function () {
					var activeTools = A2(
						_user$project$Utils$mapi1,
						_user$project$SleekView$deuceHoverMenu(model),
						A2(
							_elm_lang$core$List$concatMap,
							_elm_lang$core$List$filter(
								function (_p65) {
									return A2(
										_user$project$DeuceTools$isActive,
										model,
										_user$project$Utils$fst3(_p65));
								}),
							model.deuceToolsAndResults));
					return _elm_lang$core$List$isEmpty(activeTools) ? A2(
						_elm_lang$html$Html$div,
						{
							ctor: '::',
							_0: _elm_lang$html$Html_Attributes$class('no-available-tools'),
							_1: {ctor: '[]'}
						},
						{
							ctor: '::',
							_0: _elm_lang$html$Html$text('There are no available tools based on these selections. Press '),
							_1: {
								ctor: '::',
								_0: A2(
									_elm_lang$html$Html$i,
									{ctor: '[]'},
									{
										ctor: '::',
										_0: _elm_lang$html$Html$text('Escape'),
										_1: {ctor: '[]'}
									}),
								_1: {
									ctor: '::',
									_0: _elm_lang$html$Html$text(' to clear.'),
									_1: {ctor: '[]'}
								}
							}
						}) : A2(
						_elm_lang$html$Html$div,
						{ctor: '[]'},
						activeTools);
				}(),
				_1: {ctor: '[]'}
			}
		});
};
var _user$project$SleekView$editCodePopupPanel = function (model) {
	var _p66 = function () {
		var _p67 = model.selectedDeuceTool;
		if (_p67.ctor === 'Nothing') {
			return {
				ctor: '_Tuple3',
				_0: true,
				_1: {
					ctor: '::',
					_0: _elm_lang$html$Html$text('Configuration Panel'),
					_1: {ctor: '[]'}
				},
				_2: {ctor: '[]'}
			};
		} else {
			var _p71 = _p67._0._0;
			var isRenamer = _user$project$DeuceTools$isRenamer(_p71);
			var title = isRenamer ? A2(_user$project$SleekView$italicizeQuotes, '\'', _p71.name) : {
				ctor: '::',
				_0: _elm_lang$html$Html$text(_p71.name),
				_1: {ctor: '[]'}
			};
			var path = {
				ctor: '::',
				_0: 1,
				_1: {ctor: '[]'}
			};
			var content = A2(
				_elm_lang$core$Basics_ops['++'],
				{
					ctor: '::',
					_0: A2(
						_elm_lang$html$Html$h2,
						{ctor: '[]'},
						{
							ctor: '::',
							_0: _elm_lang$html$Html$text('Requirements'),
							_1: {ctor: '[]'}
						}),
					_1: {
						ctor: '::',
						_0: A2(
							_elm_lang$html$Html$ul,
							{
								ctor: '::',
								_0: _elm_lang$html$Html_Attributes$class('requirements-list'),
								_1: {ctor: '[]'}
							},
							A2(
								_elm_lang$core$List$map,
								function (_p68) {
									var _p69 = _p68;
									var $class = function () {
										var _p70 = _p69.value;
										switch (_p70.ctor) {
											case 'FullySatisfied':
												return 'fully-satisfied';
											case 'Satisfied':
												return 'satisfied';
											case 'Possible':
												return 'possible';
											default:
												return 'impossible';
										}
									}();
									return A2(
										_elm_lang$html$Html$li,
										{
											ctor: '::',
											_0: _elm_lang$html$Html_Attributes$class($class),
											_1: {ctor: '[]'}
										},
										{
											ctor: '::',
											_0: _elm_lang$html$Html$text(_p69.description),
											_1: {ctor: '[]'}
										});
								},
								_p71.reqs)),
						_1: {ctor: '[]'}
					}
				},
				A2(_elm_lang$core$List$all, _user$project$InterfaceModel$predicateSatisfied, _p71.reqs) ? {
					ctor: '::',
					_0: A2(
						_elm_lang$html$Html$h2,
						{ctor: '[]'},
						{
							ctor: '::',
							_0: _elm_lang$html$Html$text('Code Updates'),
							_1: {ctor: '[]'}
						}),
					_1: {
						ctor: '::',
						_0: A2(
							_elm_lang$html$Html$div,
							{
								ctor: '::',
								_0: _elm_lang$html$Html_Attributes$class('synthesis-results'),
								_1: {ctor: '[]'}
							},
							A4(_user$project$SleekView$deuceSynthesisResults, model, path, isRenamer, _p67._0._1)),
						_1: {ctor: '[]'}
					}
				} : {ctor: '[]'});
			return {ctor: '_Tuple3', _0: false, _1: title, _2: content};
		}
	}();
	var disabled = _p66._0;
	var title = _p66._1;
	var content = _p66._2;
	return _user$project$SleekView$popupPanel(
		{pos: model.popupPanelPositions.editCode, disabled: disabled, dragHandler: _user$project$InterfaceController$msgDragEditCodePopupPanel, $class: 'edit-code-popup-panel', title: title, content: content});
};
var _user$project$SleekView$popupPanels = function (model) {
	return {
		ctor: '::',
		_0: _user$project$SleekView$deucePopupPanel(model),
		_1: {
			ctor: '::',
			_0: _user$project$SleekView$editCodePopupPanel(model),
			_1: {ctor: '[]'}
		}
	};
};
var _user$project$SleekView$groupDisabled = F2(
	function (disallowSelectedFeatures, model) {
		var noBlobs = _elm_lang$core$Dict$isEmpty(model.selectedBlobs);
		var noFeatures = _elm_lang$core$Set$isEmpty(model.selectedFeatures);
		return noBlobs || (disallowSelectedFeatures && (!noFeatures));
	});
var _user$project$SleekView$relateDisabled = function (model) {
	return _elm_lang$core$Set$isEmpty(model.selectedFeatures);
};
var _user$project$SleekView$allButLast = function (xs) {
	var len = _elm_lang$core$List$length(xs);
	return A2(_elm_lang$core$List$take, len - 1, xs);
};
var _user$project$SleekView$synthesisResultHoverMenu = F4(
	function (description, elementPath, exp, nextMenu) {
		return A6(
			_user$project$SleekView$generalHoverMenu,
			description,
			_user$project$InterfaceController$msgHoverSynthesisResult(elementPath),
			_user$project$InterfaceController$msgHoverSynthesisResult(
				_user$project$SleekView$allButLast(elementPath)),
			_user$project$InterfaceController$msgSelectSynthesisResult(exp),
			false,
			nextMenu);
	});
var _user$project$SleekView$synthesisResultsSelect = function (model) {
	var desc = F4(
		function (description, exp, isSafe, sortKey) {
			return A2(
				_elm_lang$core$Basics_ops['++'],
				isSafe ? '' : '[UNSAFE] ',
				A2(
					_elm_lang$core$Basics_ops['++'],
					A4(
						_elm_lang$core$Regex$replace,
						_elm_lang$core$Regex$All,
						_elm_lang$core$Regex$regex('^Original -> | -> Cleaned$'),
						function (_p72) {
							return '';
						},
						description),
					A2(
						_elm_lang$core$Basics_ops['++'],
						' (',
						A2(
							_elm_lang$core$Basics_ops['++'],
							_elm_lang$core$Basics$toString(
								_user$project$LangTools$nodeCount(exp)),
							A2(
								_elm_lang$core$Basics_ops['++'],
								')',
								A2(
									_elm_lang$core$Basics_ops['++'],
									' ',
									_elm_lang$core$Basics$toString(sortKey)))))));
		});
	var resultButtonList = F3(
		function (priorPathByIndices, remainingPathByIndices, results) {
			return _elm_lang$core$List$concat(
				A2(
					_user$project$Utils$mapi0,
					function (_p73) {
						var _p74 = _p73;
						var _p78 = _p74._0;
						var _p77 = _p74._1._0.exp;
						var thisElementPath = A2(
							_elm_lang$core$Basics_ops['++'],
							priorPathByIndices,
							{
								ctor: '::',
								_0: _p78,
								_1: {ctor: '[]'}
							});
						var nextMenu = function () {
							var _p75 = remainingPathByIndices;
							if (_p75.ctor === '::') {
								if (_elm_lang$core$Native_Utils.eq(_p78, _p75._0)) {
									var _p76 = _p74._1._0.children;
									if (_p76.ctor === 'Just') {
										return A3(resultButtonList, thisElementPath, _p75._1, _p76._0);
									} else {
										return {ctor: '[]'};
									}
								} else {
									return {ctor: '[]'};
								}
							} else {
								return {ctor: '[]'};
							}
						}();
						return {
							ctor: '::',
							_0: A4(
								_user$project$SleekView$synthesisResultHoverMenu,
								_user$project$InterfaceModel$splash_i_2017_demo ? A2(
									_elm_lang$core$Basics_ops['++'],
									'Option ',
									_elm_lang$core$Basics$toString(_p78 + 1)) : A4(desc, _p74._1._0.description, _p77, _p74._1._0.isSafe, _p74._1._0.sortKey),
								thisElementPath,
								_p77,
								nextMenu),
							_1: {ctor: '[]'}
						};
					},
					results));
		});
	return A2(
		_elm_lang$html$Html$div,
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$class('synthesis-results'),
			_1: {ctor: '[]'}
		},
		A3(
			resultButtonList,
			{ctor: '[]'},
			model.hoveredSynthesisResultPathByIndices,
			model.synthesisResults));
};
var _user$project$SleekView$synthesisHoverMenu = F4(
	function (model, title, onMouseEnter, disabled) {
		return A6(
			_user$project$SleekView$generalHoverMenu,
			title,
			onMouseEnter,
			_user$project$InterfaceController$msgClearSynthesisResults,
			_user$project$InterfaceController$msgNoop,
			disabled,
			{
				ctor: '::',
				_0: _user$project$SleekView$synthesisResultsSelect(model),
				_1: {ctor: '[]'}
			});
	});
var _user$project$SleekView$relateHoverMenu = F3(
	function (model, title, onMouseEnter) {
		return A4(
			_user$project$SleekView$synthesisHoverMenu,
			model,
			title,
			onMouseEnter,
			_user$project$SleekView$relateDisabled(model));
	});
var _user$project$SleekView$menuBar = function (model) {
	var activeFlag = model.viewState.menuActive ? ' active' : '';
	return A2(
		_elm_lang$html$Html$div,
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$class('menu-bar'),
			_1: {
				ctor: '::',
				_0: _elm_lang$html$Html_Attributes$style(
					{
						ctor: '::',
						_0: {
							ctor: '_Tuple2',
							_0: 'height',
							_1: function (_p79) {
								return _user$project$SleekLayout$px(
									function (_) {
										return _.height;
									}(_p79));
							}(_user$project$SleekLayout$menuBar)
						},
						_1: {
							ctor: '::',
							_0: {
								ctor: '_Tuple2',
								_0: 'borderBottomWidth',
								_1: function (_p80) {
									return _user$project$SleekLayout$px(
										function (_) {
											return _.borderWidth;
										}(_p80));
								}(_user$project$SleekLayout$menuBar)
							},
							_1: {ctor: '[]'}
						}
					}),
				_1: {ctor: '[]'}
			}
		},
		{
			ctor: '::',
			_0: A2(
				_elm_lang$html$Html$div,
				{
					ctor: '::',
					_0: _elm_lang$html$Html_Attributes$class(
						A2(_elm_lang$core$Basics_ops['++'], 'main-bar', activeFlag)),
					_1: {ctor: '[]'}
				},
				A2(
					_elm_lang$core$Basics_ops['++'],
					_user$project$UserStudy$hideIfEnabled(
						{
							ctor: '::',
							_0: A2(
								_elm_lang$html$Html$img,
								{
									ctor: '::',
									_0: _elm_lang$html$Html_Attributes$class('logo-image'),
									_1: {
										ctor: '::',
										_0: _elm_lang$html$Html_Attributes$src(
											function () {
												var _p81 = model.colorScheme;
												if (_p81.ctor === 'Light') {
													return 'img/sketch-n-sketch-logo.png';
												} else {
													return 'img/light_logo.svg';
												}
											}()),
										_1: {
											ctor: '::',
											_0: _elm_lang$html$Html_Attributes$width(20),
											_1: {
												ctor: '::',
												_0: _elm_lang$html$Html_Attributes$height(20),
												_1: {ctor: '[]'}
											}
										}
									}
								},
								{ctor: '[]'}),
							_1: {
								ctor: '::',
								_0: A2(
									_user$project$SleekView$menu,
									'Sketch-n-Sketch',
									{
										ctor: '::',
										_0: {
											ctor: '::',
											_0: _user$project$SleekView$simpleHtmlTextButton(
												{
													ctor: '::',
													_0: A2(
														_elm_lang$html$Html$a,
														{
															ctor: '::',
															_0: _elm_lang$html$Html_Attributes$href('https://github.com/ravichugh/sketch-n-sketch/blob/master/README.md'),
															_1: {
																ctor: '::',
																_0: _elm_lang$html$Html_Attributes$target('_blank'),
																_1: {ctor: '[]'}
															}
														},
														{
															ctor: '::',
															_0: _elm_lang$html$Html$text('Syntax Guide'),
															_1: {ctor: '[]'}
														}),
													_1: {ctor: '[]'}
												}),
											_1: {
												ctor: '::',
												_0: _user$project$SleekView$simpleHtmlTextButton(
													{
														ctor: '::',
														_0: A2(
															_elm_lang$html$Html$a,
															{
																ctor: '::',
																_0: _elm_lang$html$Html_Attributes$href('https://github.com/ravichugh/sketch-n-sketch/blob/master/examples/prelude.little'),
																_1: {
																	ctor: '::',
																	_0: _elm_lang$html$Html_Attributes$target('_blank'),
																	_1: {ctor: '[]'}
																}
															},
															{
																ctor: '::',
																_0: _elm_lang$html$Html$text('Little Standard Library (Prelude)'),
																_1: {ctor: '[]'}
															}),
														_1: {ctor: '[]'}
													}),
												_1: {
													ctor: '::',
													_0: _user$project$SleekView$simpleHtmlTextButton(
														{
															ctor: '::',
															_0: A2(
																_elm_lang$html$Html$a,
																{
																	ctor: '::',
																	_0: _elm_lang$html$Html_Attributes$href('http://ravichugh.github.io/sketch-n-sketch/'),
																	_1: {
																		ctor: '::',
																		_0: _elm_lang$html$Html_Attributes$target('_blank'),
																		_1: {ctor: '[]'}
																	}
																},
																{
																	ctor: '::',
																	_0: _elm_lang$html$Html$text('About Sketch-n-Sketch'),
																	_1: {ctor: '[]'}
																}),
															_1: {ctor: '[]'}
														}),
													_1: {
														ctor: '::',
														_0: A3(_user$project$SleekView$disableableTextButton, true, _user$project$Config$params.strVersion, _user$project$InterfaceController$msgNoop),
														_1: {ctor: '[]'}
													}
												}
											}
										},
										_1: {ctor: '[]'}
									}),
								_1: {
									ctor: '::',
									_0: A2(
										_user$project$SleekView$menu,
										'File',
										{
											ctor: '::',
											_0: {
												ctor: '::',
												_0: A2(
													_user$project$SleekView$simpleTextButton,
													'New...',
													_user$project$InterfaceController$msgOpenDialogBox(_user$project$InterfaceModel$New)),
												_1: {
													ctor: '::',
													_0: A2(
														_user$project$SleekView$simpleTextButton,
														'Save As...',
														_user$project$InterfaceController$msgOpenDialogBox(_user$project$InterfaceModel$SaveAs)),
													_1: {
														ctor: '::',
														_0: A3(_user$project$SleekView$disableableTextButton, !model.needsSave, 'Save', _user$project$InterfaceController$msgSave),
														_1: {ctor: '[]'}
													}
												}
											},
											_1: {
												ctor: '::',
												_0: {
													ctor: '::',
													_0: A2(
														_user$project$SleekView$simpleTextButton,
														'Open...',
														_user$project$InterfaceController$msgOpenDialogBox(_user$project$InterfaceModel$Open)),
													_1: {ctor: '[]'}
												},
												_1: {
													ctor: '::',
													_0: {
														ctor: '::',
														_0: A2(_user$project$SleekView$simpleTextButton, 'Export Code', _user$project$InterfaceController$msgExportCode),
														_1: {
															ctor: '::',
															_0: A2(_user$project$SleekView$simpleTextButton, 'Export SVG', _user$project$InterfaceController$msgExportSvg),
															_1: {ctor: '[]'}
														}
													},
													_1: {
														ctor: '::',
														_0: {
															ctor: '::',
															_0: A2(
																_user$project$SleekView$simpleTextButton,
																'Import Code...',
																_user$project$InterfaceController$msgOpenDialogBox(_user$project$InterfaceModel$ImportCode)),
															_1: {
																ctor: '::',
																_0: A3(_user$project$SleekView$disableableTextButton, true, 'Import SVG', _user$project$InterfaceController$msgNoop),
																_1: {ctor: '[]'}
															}
														},
														_1: {ctor: '[]'}
													}
												}
											}
										}),
									_1: {ctor: '[]'}
								}
							}
						}),
					A2(
						_elm_lang$core$Basics_ops['++'],
						function () {
							var maybeEntry = function () {
								var _p82 = model.codeToolsMenuMode;
								switch (_p82.ctor) {
									case 'CTAll':
										return _elm_lang$core$Maybe$Just(
											_user$project$SleekView$editCodeEntry(model));
									case 'CTActive':
										return _elm_lang$core$Maybe$Just(
											_user$project$SleekView$deuceHoverMenu(model));
									default:
										return _elm_lang$core$Maybe$Nothing;
								}
							}();
							var _p83 = maybeEntry;
							if (_p83.ctor === 'Just') {
								return {
									ctor: '::',
									_0: A2(
										_user$project$SleekView$menu,
										'Code Tools',
										A2(
											_elm_lang$core$List$map,
											_user$project$Utils$mapi1(_p83._0),
											model.deuceToolsAndResults)),
									_1: {ctor: '[]'}
								};
							} else {
								return {ctor: '[]'};
							}
						}(),
						A2(
							_elm_lang$core$Basics_ops['++'],
							_user$project$UserStudy$hideIfEnabled(
								{
									ctor: '::',
									_0: A2(
										_user$project$SleekView$menu,
										'Output Tools',
										{
											ctor: '::',
											_0: A2(
												_elm_lang$core$Basics_ops['++'],
												{
													ctor: '::',
													_0: A3(_user$project$SleekView$relateTextButton, model, 'Dig Hole', _user$project$InterfaceController$msgDigHole),
													_1: {
														ctor: '::',
														_0: A3(_user$project$SleekView$relateHoverMenu, model, 'Make Equal (=)', _user$project$InterfaceController$msgMakeEqual),
														_1: {ctor: '[]'}
													}
												},
												_user$project$InterfaceModel$splash_i_2017_demo ? {ctor: '[]'} : {
													ctor: '::',
													_0: A3(_user$project$SleekView$relateHoverMenu, model, 'Relate', _user$project$InterfaceController$msgRelate),
													_1: {
														ctor: '::',
														_0: A3(_user$project$SleekView$relateHoverMenu, model, 'Indexed Relate', _user$project$InterfaceController$msgIndexedRelate),
														_1: {ctor: '[]'}
													}
												}),
											_1: {
												ctor: '::',
												_0: {
													ctor: '::',
													_0: A4(_user$project$SleekView$groupTextButton, model, 'Dupe (D)', _user$project$InterfaceController$msgDuplicateBlobs, true),
													_1: {
														ctor: '::',
														_0: A4(_user$project$SleekView$groupTextButton, model, 'Merge', _user$project$InterfaceController$msgMergeBlobs, true),
														_1: {
															ctor: '::',
															_0: A4(_user$project$SleekView$groupTextButton, model, 'Group (G)', _user$project$InterfaceController$msgGroupBlobs, false),
															_1: {
																ctor: '::',
																_0: A4(_user$project$SleekView$groupTextButton, model, 'Abstract', _user$project$InterfaceController$msgAbstractBlobs, true),
																_1: {ctor: '[]'}
															}
														}
													}
												},
												_1: {
													ctor: '::',
													_0: {
														ctor: '::',
														_0: A4(
															_user$project$SleekView$groupTextButton,
															model,
															'Repeat Right',
															_user$project$InterfaceController$msgReplicateBlob(_user$project$InterfaceModel$HorizontalRepeat),
															true),
														_1: {
															ctor: '::',
															_0: A4(
																_user$project$SleekView$groupTextButton,
																model,
																'Repeat To',
																_user$project$InterfaceController$msgReplicateBlob(_user$project$InterfaceModel$LinearRepeat),
																true),
															_1: {
																ctor: '::',
																_0: A4(
																	_user$project$SleekView$groupTextButton,
																	model,
																	'Repeat Around',
																	_user$project$InterfaceController$msgReplicateBlob(_user$project$InterfaceModel$RadialRepeat),
																	true),
																_1: {ctor: '[]'}
															}
														}
													},
													_1: {ctor: '[]'}
												}
											}
										}),
									_1: {ctor: '[]'}
								}),
							A2(
								_elm_lang$core$Basics_ops['++'],
								{
									ctor: '::',
									_0: A2(
										_user$project$SleekView$menu,
										'View',
										A2(
											_elm_lang$core$Basics_ops['++'],
											_user$project$UserStudy$hideIfEnabled(
												{
													ctor: '::',
													_0: {
														ctor: '::',
														_0: A3(_user$project$SleekView$disableableTextButton, true, 'Main Layer', _user$project$InterfaceController$msgNoop),
														_1: {
															ctor: '::',
															_0: A3(_user$project$SleekView$disableableTextButton, true, 'Widget Layer', _user$project$InterfaceController$msgNoop),
															_1: {
																ctor: '::',
																_0: A2(
																	_user$project$SleekView$hoverMenu,
																	'Ghost Layer',
																	A4(_user$project$SleekView$booleanOption, model.showGhosts, 'On', 'Off', _user$project$InterfaceController$msgSetGhostsShown)),
																_1: {ctor: '[]'}
															}
														}
													},
													_1: {ctor: '[]'}
												}),
											{
												ctor: '::',
												_0: {
													ctor: '::',
													_0: A2(_user$project$SleekView$simpleTextButton, 'Reset Interface Layout', _user$project$InterfaceController$msgResetInterfaceLayout),
													_1: {ctor: '[]'}
												},
												_1: {ctor: '[]'}
											})),
									_1: {
										ctor: '::',
										_0: A2(
											_user$project$SleekView$menu,
											'Options',
											A2(
												_elm_lang$core$Basics_ops['++'],
												{
													ctor: '::',
													_0: A2(
														_elm_lang$core$Basics_ops['++'],
														{
															ctor: '::',
															_0: A2(
																_user$project$SleekView$hoverMenu,
																'Font Size',
																{
																	ctor: '::',
																	_0: A3(
																		_user$project$SleekView$simpleTextRadioButton,
																		function () {
																			var _p84 = model.codeBoxInfo.fontSize;
																			if (_p84 === 8) {
																				return true;
																			} else {
																				return false;
																			}
																		}(),
																		'8',
																		_user$project$InterfaceController$msgUpdateFontSize(8)),
																	_1: {
																		ctor: '::',
																		_0: A3(
																			_user$project$SleekView$simpleTextRadioButton,
																			function () {
																				var _p85 = model.codeBoxInfo.fontSize;
																				if (_p85 === 10) {
																					return true;
																				} else {
																					return false;
																				}
																			}(),
																			'10',
																			_user$project$InterfaceController$msgUpdateFontSize(10)),
																		_1: {
																			ctor: '::',
																			_0: A3(
																				_user$project$SleekView$simpleTextRadioButton,
																				function () {
																					var _p86 = model.codeBoxInfo.fontSize;
																					if (_p86 === 12) {
																						return true;
																					} else {
																						return false;
																					}
																				}(),
																				'12',
																				_user$project$InterfaceController$msgUpdateFontSize(12)),
																			_1: {
																				ctor: '::',
																				_0: A3(
																					_user$project$SleekView$simpleTextRadioButton,
																					function () {
																						var _p87 = model.codeBoxInfo.fontSize;
																						if (_p87 === 14) {
																							return true;
																						} else {
																							return false;
																						}
																					}(),
																					'14',
																					_user$project$InterfaceController$msgUpdateFontSize(14)),
																				_1: {
																					ctor: '::',
																					_0: A3(
																						_user$project$SleekView$simpleTextRadioButton,
																						function () {
																							var _p88 = model.codeBoxInfo.fontSize;
																							if (_p88 === 16) {
																								return true;
																							} else {
																								return false;
																							}
																						}(),
																						'16',
																						_user$project$InterfaceController$msgUpdateFontSize(16)),
																					_1: {
																						ctor: '::',
																						_0: A3(
																							_user$project$SleekView$simpleTextRadioButton,
																							function () {
																								var _p89 = model.codeBoxInfo.fontSize;
																								if (_p89 === 18) {
																									return true;
																								} else {
																									return false;
																								}
																							}(),
																							'18',
																							_user$project$InterfaceController$msgUpdateFontSize(18)),
																						_1: {
																							ctor: '::',
																							_0: A3(
																								_user$project$SleekView$simpleTextRadioButton,
																								function () {
																									var _p90 = model.codeBoxInfo.fontSize;
																									if (_p90 === 20) {
																										return true;
																									} else {
																										return false;
																									}
																								}(),
																								'20',
																								_user$project$InterfaceController$msgUpdateFontSize(20)),
																							_1: {
																								ctor: '::',
																								_0: A3(
																									_user$project$SleekView$simpleTextRadioButton,
																									function () {
																										var _p91 = model.codeBoxInfo.fontSize;
																										if (_p91 === 22) {
																											return true;
																										} else {
																											return false;
																										}
																									}(),
																									'22',
																									_user$project$InterfaceController$msgUpdateFontSize(22)),
																								_1: {
																									ctor: '::',
																									_0: A3(
																										_user$project$SleekView$simpleTextRadioButton,
																										function () {
																											var _p92 = model.codeBoxInfo.fontSize;
																											if (_p92 === 24) {
																												return true;
																											} else {
																												return false;
																											}
																										}(),
																										'24',
																										_user$project$InterfaceController$msgUpdateFontSize(24)),
																									_1: {ctor: '[]'}
																								}
																							}
																						}
																					}
																				}
																			}
																		}
																	}
																}),
															_1: {ctor: '[]'}
														},
														_user$project$UserStudy$hideIfEnabled(
															{
																ctor: '::',
																_0: A2(
																	_user$project$SleekView$hoverMenu,
																	'Color Scheme',
																	{
																		ctor: '::',
																		_0: A3(
																			_user$project$SleekView$simpleTextRadioButton,
																			function () {
																				var _p93 = model.colorScheme;
																				if (_p93.ctor === 'Light') {
																					return true;
																				} else {
																					return false;
																				}
																			}(),
																			'Light',
																			_user$project$InterfaceController$msgSetColorScheme(_user$project$InterfaceModel$Light)),
																		_1: {
																			ctor: '::',
																			_0: A3(
																				_user$project$SleekView$simpleTextRadioButton,
																				function () {
																					var _p94 = model.colorScheme;
																					if (_p94.ctor === 'Dark') {
																						return true;
																					} else {
																						return false;
																					}
																				}(),
																				'Dark',
																				_user$project$InterfaceController$msgSetColorScheme(_user$project$InterfaceModel$Dark)),
																			_1: {ctor: '[]'}
																		}
																	}),
																_1: {
																	ctor: '::',
																	_0: A2(
																		_user$project$SleekView$hoverMenu,
																		'Auto-Run',
																		{
																			ctor: '::',
																			_0: A3(_user$project$SleekView$disableableTextButton, true, 'Every second', _user$project$InterfaceController$msgNoop),
																			_1: {
																				ctor: '::',
																				_0: A3(_user$project$SleekView$disableableTextButton, true, 'Every 2 seconds', _user$project$InterfaceController$msgNoop),
																				_1: {
																					ctor: '::',
																					_0: A3(_user$project$SleekView$disableableTextButton, true, 'Every 3 seconds', _user$project$InterfaceController$msgNoop),
																					_1: {ctor: '[]'}
																				}
																			}
																		}),
																	_1: {ctor: '[]'}
																}
															})),
													_1: {ctor: '[]'}
												},
												_user$project$UserStudy$hideIfEnabled(
													{
														ctor: '::',
														_0: {
															ctor: '::',
															_0: A2(
																_user$project$SleekView$hoverMenu,
																'Enable Text Edits',
																A4(
																	_user$project$SleekView$booleanOption,
																	_user$project$Updatable$extract(model.enableTextEdits),
																	'True',
																	'False',
																	_user$project$InterfaceController$msgSetEnableTextEdits)),
															_1: {
																ctor: '::',
																_0: A2(
																	_user$project$SleekView$hoverMenu,
																	'Enable Deuce Box Selection',
																	A4(_user$project$SleekView$booleanOption, model.enableDeuceBoxSelection, 'True', 'False', _user$project$InterfaceController$msgSetEnableDeuceBoxSelection)),
																_1: {
																	ctor: '::',
																	_0: A2(
																		_user$project$SleekView$hoverMenu,
																		'Enable Deuce Text Selection',
																		A4(_user$project$SleekView$booleanOption, model.enableDeuceTextSelection, 'True', 'False', _user$project$InterfaceController$msgSetEnableDeuceTextSelection)),
																	_1: {ctor: '[]'}
																}
															}
														},
														_1: {
															ctor: '::',
															_0: {
																ctor: '::',
																_0: A2(
																	_user$project$SleekView$hoverMenu,
																	'Code Tools Menu Mode',
																	{
																		ctor: '::',
																		_0: A3(
																			_user$project$SleekView$simpleTextRadioButton,
																			function () {
																				var _p95 = model.codeToolsMenuMode;
																				if (_p95.ctor === 'CTAll') {
																					return true;
																				} else {
																					return false;
																				}
																			}(),
																			'All',
																			_user$project$InterfaceController$msgSetCodeToolsMenuMode(_user$project$InterfaceModel$CTAll)),
																		_1: {
																			ctor: '::',
																			_0: A3(
																				_user$project$SleekView$simpleTextRadioButton,
																				function () {
																					var _p96 = model.codeToolsMenuMode;
																					if (_p96.ctor === 'CTActive') {
																						return true;
																					} else {
																						return false;
																					}
																				}(),
																				'Active',
																				_user$project$InterfaceController$msgSetCodeToolsMenuMode(_user$project$InterfaceModel$CTActive)),
																			_1: {
																				ctor: '::',
																				_0: A3(
																					_user$project$SleekView$simpleTextRadioButton,
																					function () {
																						var _p97 = model.codeToolsMenuMode;
																						if (_p97.ctor === 'CTDisabled') {
																							return true;
																						} else {
																							return false;
																						}
																					}(),
																					'Disabled',
																					_user$project$InterfaceController$msgSetCodeToolsMenuMode(_user$project$InterfaceModel$CTDisabled)),
																				_1: {ctor: '[]'}
																			}
																		}
																	}),
																_1: {
																	ctor: '::',
																	_0: A2(
																		_user$project$SleekView$hoverMenu,
																		'Domain-Specific Code Tools',
																		A4(_user$project$SleekView$booleanOption, model.enableDomainSpecificCodeTools, 'Enabled', 'Disabled', _user$project$InterfaceController$msgSetEnableDomainSpecificCodeTools)),
																	_1: {ctor: '[]'}
																}
															},
															_1: {
																ctor: '::',
																_0: {
																	ctor: '::',
																	_0: A2(
																		_user$project$SleekView$hoverMenu,
																		'Text Selection Mode',
																		{
																			ctor: '::',
																			_0: A3(
																				_user$project$SleekView$simpleTextRadioButton,
																				function () {
																					var _p98 = model.textSelectMode;
																					if (_p98.ctor === 'Strict') {
																						return true;
																					} else {
																						return false;
																					}
																				}(),
																				'Strict',
																				_user$project$InterfaceController$msgSetTextSelectMode(_user$project$InterfaceModel$Strict)),
																			_1: {
																				ctor: '::',
																				_0: A3(
																					_user$project$SleekView$simpleTextRadioButton,
																					function () {
																						var _p99 = model.textSelectMode;
																						if (_p99.ctor === 'Superset') {
																							return true;
																						} else {
																							return false;
																						}
																					}(),
																					'Superset',
																					_user$project$InterfaceController$msgSetTextSelectMode(_user$project$InterfaceModel$Superset)),
																				_1: {
																					ctor: '::',
																					_0: A3(
																						_user$project$SleekView$simpleTextRadioButton,
																						function () {
																							var _p100 = model.textSelectMode;
																							if (_p100.ctor === 'Subset') {
																								return true;
																							} else {
																								return false;
																							}
																						}(),
																						'Subset',
																						_user$project$InterfaceController$msgSetTextSelectMode(_user$project$InterfaceModel$Subset)),
																					_1: {
																						ctor: '::',
																						_0: A3(
																							_user$project$SleekView$simpleTextRadioButton,
																							function () {
																								var _p101 = model.textSelectMode;
																								if (_p101.ctor === 'SubsetExtra') {
																									return true;
																								} else {
																									return false;
																								}
																							}(),
																							'SubsetExtra',
																							_user$project$InterfaceController$msgSetTextSelectMode(_user$project$InterfaceModel$SubsetExtra)),
																						_1: {ctor: '[]'}
																					}
																				}
																			}
																		}),
																	_1: {
																		ctor: '::',
																		_0: A2(
																			_user$project$SleekView$hoverMenu,
																			'Allow Multiple Target Positions',
																			A4(_user$project$SleekView$booleanOption, model.allowMultipleTargetPositions, 'True', 'False', _user$project$InterfaceController$msgSetAllowMultipleTargetPositions)),
																		_1: {ctor: '[]'}
																	}
																},
																_1: {
																	ctor: '::',
																	_0: {
																		ctor: '::',
																		_0: A2(
																			_user$project$SleekView$hoverMenu,
																			'Shape Code Templates',
																			{
																				ctor: '::',
																				_0: A3(
																					_user$project$SleekView$simpleTextRadioButton,
																					_elm_lang$core$Native_Utils.eq(model.toolMode, _user$project$InterfaceModel$Raw),
																					'Raw',
																					_user$project$InterfaceController$msgSetToolMode(_user$project$InterfaceModel$Raw)),
																				_1: {
																					ctor: '::',
																					_0: A3(
																						_user$project$SleekView$simpleTextRadioButton,
																						_elm_lang$core$Native_Utils.eq(model.toolMode, _user$project$InterfaceModel$Stretchy),
																						'Stretchy',
																						_user$project$InterfaceController$msgSetToolMode(_user$project$InterfaceModel$Stretchy)),
																					_1: {
																						ctor: '::',
																						_0: A3(
																							_user$project$SleekView$simpleTextRadioButton,
																							_elm_lang$core$Native_Utils.eq(model.toolMode, _user$project$InterfaceModel$Sticky),
																							'Sticky',
																							_user$project$InterfaceController$msgSetToolMode(_user$project$InterfaceModel$Sticky)),
																						_1: {ctor: '[]'}
																					}
																				}
																			}),
																		_1: {ctor: '[]'}
																	},
																	_1: {
																		ctor: '::',
																		_0: {
																			ctor: '::',
																			_0: A2(
																				_user$project$SleekView$hoverMenu,
																				'Automatically Suggest Code Changes',
																				{
																					ctor: '::',
																					_0: A3(_user$project$SleekView$simpleTextRadioButton, model.autoSynthesis, 'On', _user$project$InterfaceController$msgStartAutoSynthesis),
																					_1: {
																						ctor: '::',
																						_0: A3(_user$project$SleekView$simpleTextRadioButton, !model.autoSynthesis, 'Off', _user$project$InterfaceController$msgStopAutoSynthesisAndClear),
																						_1: {ctor: '[]'}
																					}
																				}),
																			_1: {
																				ctor: '::',
																				_0: A2(
																					_user$project$SleekView$hoverMenu,
																					'Output Synchronization',
																					{
																						ctor: '::',
																						_0: A3(
																							_user$project$SleekView$simpleTextRadioButton,
																							_elm_lang$core$Native_Utils.eq(model.liveSyncDelay, false),
																							'Live',
																							_user$project$InterfaceController$msgSetLiveSyncDelay(false)),
																						_1: {
																							ctor: '::',
																							_0: A3(
																								_user$project$SleekView$simpleTextRadioButton,
																								_elm_lang$core$Native_Utils.eq(model.liveSyncDelay, true),
																								'Delayed',
																								_user$project$InterfaceController$msgSetLiveSyncDelay(true)),
																							_1: {ctor: '[]'}
																						}
																					}),
																				_1: {
																					ctor: '::',
																					_0: A2(
																						_user$project$SleekView$hoverMenu,
																						'Live Update Heuristics',
																						{
																							ctor: '::',
																							_0: A3(
																								_user$project$SleekView$simpleTextRadioButton,
																								_elm_lang$core$Native_Utils.eq(model.syncOptions.feelingLucky, _user$project$Sync$heuristicsBiased),
																								'Biased',
																								_user$project$InterfaceController$msgSetHeuristicsBiased),
																							_1: {
																								ctor: '::',
																								_0: A3(
																									_user$project$SleekView$simpleTextRadioButton,
																									_elm_lang$core$Native_Utils.eq(model.syncOptions.feelingLucky, _user$project$Sync$heuristicsNone),
																									'None',
																									_user$project$InterfaceController$msgSetHeuristicsNone),
																								_1: {
																									ctor: '::',
																									_0: A3(
																										_user$project$SleekView$simpleTextRadioButton,
																										_elm_lang$core$Native_Utils.eq(model.syncOptions.feelingLucky, _user$project$Sync$heuristicsFair),
																										'Fair',
																										_user$project$InterfaceController$msgSetHeuristicsFair),
																									_1: {ctor: '[]'}
																								}
																							}
																						}),
																					_1: {ctor: '[]'}
																				}
																			}
																		},
																		_1: {
																			ctor: '::',
																			_0: {
																				ctor: '::',
																				_0: A2(
																					_user$project$SleekView$hoverMenu,
																					'Output Type',
																					{
																						ctor: '::',
																						_0: A3(
																							_user$project$SleekView$simpleTextRadioButton,
																							function () {
																								var _p102 = model.outputMode;
																								if (_p102.ctor === 'Live') {
																									return true;
																								} else {
																									return false;
																								}
																							}(),
																							'Graphics',
																							_user$project$InterfaceController$msgSetOutputLive),
																						_1: {
																							ctor: '::',
																							_0: A3(
																								_user$project$SleekView$simpleTextRadioButton,
																								function () {
																									var _p103 = model.outputMode;
																									if (_p103.ctor === 'Print') {
																										return true;
																									} else {
																										return false;
																									}
																								}(),
																								'Text',
																								_user$project$InterfaceController$msgSetOutputPrint),
																							_1: {ctor: '[]'}
																						}
																					}),
																				_1: {ctor: '[]'}
																			},
																			_1: {ctor: '[]'}
																		}
																	}
																}
															}
														}
													}))),
										_1: {ctor: '[]'}
									}
								},
								_user$project$UserStudy$showIfEnabled(
									{
										ctor: '::',
										_0: A2(
											_elm_lang$html$Html$div,
											{
												ctor: '::',
												_0: _elm_lang$html$Html_Attributes$class('user-study-info'),
												_1: {ctor: '[]'}
											},
											{
												ctor: '::',
												_0: function () {
													var timeLeft = _user$project$InterfaceController$timeLeft(model);
													if ((!_elm_lang$core$Native_Utils.eq(timeLeft, _user$project$Utils$infinity)) && (_elm_lang$core$Native_Utils.cmp(timeLeft, 30 * _elm_lang$core$Time$second) < 1)) {
														var secs = _elm_lang$core$Basics$round(timeLeft / _elm_lang$core$Time$second);
														return A2(
															_elm_lang$html$Html$span,
															{
																ctor: '::',
																_0: _elm_lang$html$Html_Attributes$class('time-left time-almost-gone'),
																_1: {ctor: '[]'}
															},
															{
																ctor: '::',
																_0: _elm_lang$html$Html$text(
																	A2(
																		_elm_lang$core$Basics_ops['++'],
																		(_elm_lang$core$Native_Utils.cmp(secs, 10) < 0) ? '0:0' : '0:',
																		A2(
																			_elm_lang$core$Basics_ops['++'],
																			_elm_lang$core$Basics$toString(secs),
																			' remaining on task'))),
																_1: {ctor: '[]'}
															});
													} else {
														if ((!_elm_lang$core$Native_Utils.eq(timeLeft, _user$project$Utils$infinity)) && (_elm_lang$core$Native_Utils.cmp(
															timeLeft,
															_user$project$InterfaceController$currentTaskDuration(model) / 3.0) < 1)) {
															var mins = _elm_lang$core$Basics$round(timeLeft / _elm_lang$core$Time$minute);
															return A2(
																_elm_lang$html$Html$span,
																{
																	ctor: '::',
																	_0: _elm_lang$html$Html_Attributes$class('time-left'),
																	_1: {ctor: '[]'}
																},
																{
																	ctor: '::',
																	_0: _elm_lang$html$Html$text(
																		A2(
																			_elm_lang$core$Basics_ops['++'],
																			A2(_user$project$Utils$pluralize, mins, 'minute'),
																			' remaining on task')),
																	_1: {ctor: '[]'}
																});
														} else {
															return A2(
																_elm_lang$html$Html$span,
																{ctor: '[]'},
																{ctor: '[]'});
														}
													}
												}(),
												_1: {
													ctor: '::',
													_0: _user$project$SleekView$textButton(
														_elm_lang$core$Native_Utils.update(
															_user$project$SleekView$defaultTb,
															{
																content: {
																	ctor: '::',
																	_0: A2(
																		_elm_lang$html$Html$span,
																		{
																			ctor: '::',
																			_0: _elm_lang$html$Html_Attributes$class('flip'),
																			_1: {ctor: '[]'}
																		},
																		{
																			ctor: '::',
																			_0: _elm_lang$html$Html$text(''),
																			_1: {ctor: '[]'}
																		}),
																	_1: {
																		ctor: '::',
																		_0: _elm_lang$html$Html$text(' Previous Step'),
																		_1: {ctor: '[]'}
																	}
																},
																onClick: _user$project$InterfaceController$msgUserStudyPrev,
																disabled: _user$project$UserStudy$disablePreviousStep(model.userStudyStateIndex)
															})),
													_1: {
														ctor: '::',
														_0: A2(
															_elm_lang$html$Html$span,
															{
																ctor: '::',
																_0: _elm_lang$html$Html_Attributes$class('step-info'),
																_1: {ctor: '[]'}
															},
															{
																ctor: '::',
																_0: _elm_lang$html$Html$text(
																	_user$project$UserStudy$stepDescription(model.userStudyStateIndex)),
																_1: {ctor: '[]'}
															}),
														_1: {
															ctor: '::',
															_0: function () {
																var isDone = _elm_lang$core$Native_Utils.eq(
																	model.codeBoxInfo.annotations,
																	{ctor: '[]'});
																return A3(
																	_user$project$SleekView$disableableTextButton,
																	_user$project$UserStudy$disableNextStep(model.userStudyStateIndex),
																	isDone ? 'Next Step ' : 'Give Up ',
																	_user$project$InterfaceController$msgUserStudyNext(isDone));
															}(),
															_1: {ctor: '[]'}
														}
													}
												}
											}),
										_1: {
											ctor: '::',
											_0: A2(
												_user$project$SleekView$menu,
												'Help',
												{
													ctor: '::',
													_0: {
														ctor: '::',
														_0: A2(
															_user$project$SleekView$simpleTextButton,
															'Text-Select Mode',
															_user$project$InterfaceController$msgOpenDialogBox(
																_user$project$InterfaceModel$Help(_user$project$InterfaceModel$HelpTextSelectMode))),
														_1: {
															ctor: '::',
															_0: A2(
																_user$project$SleekView$simpleTextButton,
																'Box-Select Mode',
																_user$project$InterfaceController$msgOpenDialogBox(
																	_user$project$InterfaceModel$Help(_user$project$InterfaceModel$HelpBoxSelectMode))),
															_1: {ctor: '[]'}
														}
													},
													_1: {ctor: '[]'}
												}),
											_1: {ctor: '[]'}
										}
									})))))),
			_1: {ctor: '[]'}
		});
};
var _user$project$SleekView$groupHoverMenu = F4(
	function (model, title, onMouseEnter, disallowSelectedFeatures) {
		return A4(
			_user$project$SleekView$synthesisHoverMenu,
			model,
			title,
			onMouseEnter,
			A2(_user$project$SleekView$groupDisabled, disallowSelectedFeatures, model));
	});
var _user$project$SleekView$synthesisAutoSearch = function (model) {
	return (_elm_lang$core$Native_Utils.cmp(
		_elm_lang$core$List$length(model.synthesisResults),
		0) > 0) ? {
		ctor: '::',
		_0: A2(
			_elm_lang$html$Html$div,
			{
				ctor: '::',
				_0: _elm_lang$html$Html_Attributes$class('synthesis-auto-search'),
				_1: {ctor: '[]'}
			},
			{
				ctor: '::',
				_0: _user$project$SleekView$synthesisResultsSelect(model),
				_1: {ctor: '[]'}
			}),
		_1: {ctor: '[]'}
	} : {ctor: '[]'};
};
var _user$project$SleekView$synthesisPanel = function (model) {
	return A2(
		_elm_lang$html$Html$div,
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$class('synthesis-panel-wrapper'),
			_1: {
				ctor: '::',
				_0: _elm_lang$html$Html_Attributes$style(
					{
						ctor: '::',
						_0: {
							ctor: '_Tuple2',
							_0: 'bottom',
							_1: function (_p104) {
								return _user$project$SleekLayout$px(
									function (_) {
										return _.bottom;
									}(_p104));
							}(
								_user$project$SleekLayout$synthesisPanel(model))
						},
						_1: {
							ctor: '::',
							_0: {
								ctor: '_Tuple2',
								_0: 'height',
								_1: function (_p105) {
									return _user$project$SleekLayout$px(
										function (_) {
											return _.height;
										}(_p105));
								}(
									_user$project$SleekLayout$synthesisPanel(model))
							},
							_1: {ctor: '[]'}
						}
					}),
				_1: {ctor: '[]'}
			}
		},
		{
			ctor: '::',
			_0: A2(
				_elm_lang$html$Html$div,
				{
					ctor: '::',
					_0: _elm_lang$html$Html_Attributes$class('panel synthesis-panel'),
					_1: {ctor: '[]'}
				},
				{
					ctor: '::',
					_0: A2(
						_elm_lang$html$Html$div,
						{
							ctor: '::',
							_0: _elm_lang$html$Html_Attributes$class('dropdown-content synthesis-menu-holder'),
							_1: {ctor: '[]'}
						},
						{
							ctor: '::',
							_0: _user$project$SleekView$synthesisResultsSelect(model),
							_1: {ctor: '[]'}
						}),
					_1: {ctor: '[]'}
				}),
			_1: {ctor: '[]'}
		});
};
var _user$project$SleekView$TextButtonOptions = F5(
	function (a, b, c, d, e) {
		return {attributes: a, content: b, onClick: c, disabled: d, stopPropagation: e};
	});
var _user$project$SleekView$Unselected = {ctor: 'Unselected'};
var _user$project$SleekView$Selected = {ctor: 'Selected'};
var _user$project$SleekView$lambdaTools = function (model) {
	var buttons = A2(
		_user$project$Utils$mapi1,
		function (_p106) {
			var _p107 = _p106;
			var _p108 = _p107._0;
			var iconName = _user$project$InterfaceModel$strLambdaTool(_p107._1);
			return A2(
				_elm_lang$html$Html$div,
				{
					ctor: '::',
					_0: _elm_lang$html$Html_Attributes$class('tool'),
					_1: {ctor: '[]'}
				},
				{
					ctor: '::',
					_0: A5(
						_user$project$SleekView$iconButton,
						model,
						iconName,
						A2(
							_user$project$InterfaceModel$Msg,
							iconName,
							function (m) {
								return _elm_lang$core$Native_Utils.update(
									m,
									{
										tool: _user$project$InterfaceModel$Lambda(_p108)
									});
							}),
						_elm_lang$core$Native_Utils.eq(
							model.tool,
							_user$project$InterfaceModel$Lambda(_p108)) ? _user$project$SleekView$Selected : _user$project$SleekView$Unselected,
						false),
					_1: {ctor: '[]'}
				});
		},
		model.lambdaTools);
	return buttons;
};
var _user$project$SleekView$Regular = {ctor: 'Regular'};
var _user$project$SleekView$toolButton = F2(
	function (model, tool) {
		var _p109 = function () {
			var _p110 = {
				ctor: '_Tuple2',
				_0: _elm_lang$core$Native_Utils.eq(model.tool, tool),
				_1: tool
			};
			if (_p110._0 === true) {
				return {ctor: '_Tuple2', _0: _user$project$SleekView$Selected, _1: false};
			} else {
				if ((_p110._1.ctor === 'Path') && (_p110._1._0.ctor === 'Sticky')) {
					return {ctor: '_Tuple2', _0: _user$project$SleekView$Regular, _1: true};
				} else {
					return {ctor: '_Tuple2', _0: _user$project$SleekView$Unselected, _1: false};
				}
			}
		}();
		var btnKind = _p109._0;
		var disabled = _p109._1;
		var cap = function () {
			var _p111 = tool;
			switch (_p111.ctor) {
				case 'Cursor':
					return 'Cursor';
				case 'Line':
					return 'Line';
				case 'Rect':
					return 'Rect';
				case 'Oval':
					return 'Ellipse';
				case 'Poly':
					return 'Polygon';
				case 'Path':
					return 'Path';
				case 'Text':
					return 'Text';
				case 'HelperLine':
					return '(Rule)';
				case 'Lambda':
					return 'Lambda';
				default:
					return _elm_lang$core$Native_Utils.crashCase(
						'SleekView',
						{
							start: {line: 1510, column: 11},
							end: {line: 1530, column: 54}
						},
						_p111)(
						A2(
							_elm_lang$core$Basics_ops['++'],
							'toolButton: ',
							_elm_lang$core$Basics$toString(tool)));
			}
		}();
		return A2(
			_elm_lang$html$Html$div,
			{
				ctor: '::',
				_0: _elm_lang$html$Html_Attributes$class('tool'),
				_1: {ctor: '[]'}
			},
			{
				ctor: '::',
				_0: A5(
					_user$project$SleekView$iconButton,
					model,
					cap,
					A2(
						_user$project$InterfaceModel$Msg,
						cap,
						function (m) {
							return _elm_lang$core$Native_Utils.update(
								m,
								{tool: tool});
						}),
					btnKind,
					disabled),
				_1: {ctor: '[]'}
			});
	});
var _user$project$SleekView$toolPanel = function (model) {
	var toolSeparator = A2(
		_elm_lang$html$Html$div,
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$class('tool-separator'),
			_1: {ctor: '[]'}
		},
		{ctor: '[]'});
	return A2(
		_elm_lang$html$Html$div,
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$class('panel tool-panel'),
			_1: {
				ctor: '::',
				_0: _elm_lang$html$Html_Attributes$style(
					{
						ctor: '::',
						_0: {
							ctor: '_Tuple2',
							_0: 'width',
							_1: function (_p113) {
								return _user$project$SleekLayout$px(
									function (_) {
										return _.width;
									}(_p113));
							}(_user$project$SleekLayout$toolPanel)
						},
						_1: {
							ctor: '::',
							_0: {
								ctor: '_Tuple2',
								_0: 'right',
								_1: function (_p114) {
									return _user$project$SleekLayout$px(
										function (_) {
											return _.right;
										}(_p114));
								}(_user$project$SleekLayout$toolPanel)
							},
							_1: {
								ctor: '::',
								_0: {
									ctor: '_Tuple2',
									_0: 'marginLeft',
									_1: function (_p115) {
										return _user$project$SleekLayout$px(
											function (_) {
												return _.marginLeft;
											}(_p115));
									}(_user$project$SleekLayout$toolPanel)
								},
								_1: {ctor: '[]'}
							}
						}
					}),
				_1: {ctor: '[]'}
			}
		},
		A2(
			_elm_lang$core$Basics_ops['++'],
			{
				ctor: '::',
				_0: A2(_user$project$SleekView$toolButton, model, _user$project$InterfaceModel$Cursor),
				_1: {
					ctor: '::',
					_0: A2(_user$project$SleekView$toolButton, model, _user$project$InterfaceModel$Text),
					_1: {
						ctor: '::',
						_0: A2(
							_user$project$SleekView$toolButton,
							model,
							_user$project$InterfaceModel$Line(model.toolMode)),
						_1: {
							ctor: '::',
							_0: A2(
								_user$project$SleekView$toolButton,
								model,
								_user$project$InterfaceModel$Rect(model.toolMode)),
							_1: {
								ctor: '::',
								_0: A2(
									_user$project$SleekView$toolButton,
									model,
									_user$project$InterfaceModel$Oval(model.toolMode)),
								_1: {
									ctor: '::',
									_0: A2(
										_user$project$SleekView$toolButton,
										model,
										_user$project$InterfaceModel$Poly(model.toolMode)),
									_1: {
										ctor: '::',
										_0: A2(
											_user$project$SleekView$toolButton,
											model,
											_user$project$InterfaceModel$Path(model.toolMode)),
										_1: {ctor: '[]'}
									}
								}
							}
						}
					}
				}
			},
			A2(
				_elm_lang$core$Basics_ops['++'],
				_user$project$SleekView$lambdaTools(model),
				{
					ctor: '::',
					_0: _user$project$SleekView$toolModeIndicator(model),
					_1: {ctor: '[]'}
				})));
};
var _user$project$SleekView$workArea = function (model) {
	return A2(
		_elm_lang$html$Html$div,
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$class('work-area'),
			_1: {
				ctor: '::',
				_0: _elm_lang$html$Html_Attributes$style(
					{
						ctor: '::',
						_0: {
							ctor: '_Tuple2',
							_0: 'margin',
							_1: _user$project$SleekLayout$px(
								function (_) {
									return _.width;
								}(_user$project$SleekLayout$spacing))
						},
						_1: {
							ctor: '::',
							_0: {
								ctor: '_Tuple2',
								_0: 'top',
								_1: _user$project$SleekLayout$px(
									function (_) {
										return _.height;
									}(_user$project$SleekLayout$menuBar))
							},
							_1: {ctor: '[]'}
						}
					}),
				_1: {ctor: '[]'}
			}
		},
		A2(
			_elm_lang$core$Basics_ops['++'],
			{
				ctor: '::',
				_0: A2(
					_elm_lang$html$Html$div,
					{
						ctor: '::',
						_0: _elm_lang$html$Html_Attributes$class('main-panels'),
						_1: {ctor: '[]'}
					},
					A2(
						_elm_lang$core$Basics_ops['++'],
						_user$project$UserStudy$showIfEnabled(
							{
								ctor: '::',
								_0: _user$project$SleekView$proseResizer(model),
								_1: {
									ctor: '::',
									_0: _user$project$SleekView$prosePanel(model),
									_1: {ctor: '[]'}
								}
							}),
						A2(
							_elm_lang$core$Basics_ops['++'],
							{
								ctor: '::',
								_0: _user$project$SleekView$codePanel(model),
								_1: {
									ctor: '::',
									_0: _user$project$SleekView$mainResizer(model),
									_1: {
										ctor: '::',
										_0: _user$project$SleekView$outputPanel(model),
										_1: {ctor: '[]'}
									}
								}
							},
							_user$project$UserStudy$hideIfEnabled(
								{
									ctor: '::',
									_0: _user$project$SleekView$toolPanel(model),
									_1: {ctor: '[]'}
								})))),
				_1: {ctor: '[]'}
			},
			_user$project$UserStudy$hideIfEnabled(
				{
					ctor: '::',
					_0: _user$project$SleekView$synthesisPanel(model),
					_1: {ctor: '[]'}
				})));
};
var _user$project$SleekView$view = function (model) {
	var userStudyFlag = _user$project$UserStudy$enabled ? ' user-study-enabled' : '';
	var hasDialogFlag = _user$project$InterfaceModel$anyDialogShown(model) ? ' has-dialogs' : '';
	var needsRunFlag = _user$project$InterfaceModel$needsRun(model) ? ' needs-run' : '';
	return A2(
		_elm_lang$html$Html$div,
		{
			ctor: '::',
			_0: _elm_lang$html$Html_Attributes$class(
				A2(
					_elm_lang$core$Basics_ops['++'],
					'main',
					A2(
						_elm_lang$core$Basics_ops['++'],
						needsRunFlag,
						A2(_elm_lang$core$Basics_ops['++'], hasDialogFlag, userStudyFlag)))),
			_1: {
				ctor: '::',
				_0: _elm_lang$html$Html_Events$onClick(_user$project$InterfaceController$msgHideMenu),
				_1: {
					ctor: '::',
					_0: _user$project$SleekView$onRightClick(_user$project$InterfaceController$msgNoop),
					_1: {ctor: '[]'}
				}
			}
		},
		A2(
			_elm_lang$core$Basics_ops['++'],
			{
				ctor: '::',
				_0: _user$project$SleekView$onbeforeunloadDataElement(model),
				_1: {
					ctor: '::',
					_0: _user$project$SleekView$menuBar(model),
					_1: {
						ctor: '::',
						_0: _user$project$SleekView$workArea(model),
						_1: {
							ctor: '::',
							_0: _user$project$SleekView$deuceOverlay(model),
							_1: {
								ctor: '::',
								_0: _user$project$SleekView$deuceRightClickMenu(model),
								_1: {ctor: '[]'}
							}
						}
					}
				}
			},
			A2(
				_elm_lang$core$Basics_ops['++'],
				_user$project$SleekView$popupPanels(model),
				A2(
					_elm_lang$core$Basics_ops['++'],
					{
						ctor: '::',
						_0: _user$project$SleekView$subtleBackground,
						_1: {ctor: '[]'}
					},
					_user$project$SleekView$dialogBoxes(model)))));
};

var _user$project$Main$subscriptions = function (model) {
	return _elm_lang$core$Platform_Sub$batch(
		{
			ctor: '::',
			_0: _elm_lang$window$Window$resizes(_user$project$InterfaceController$msgWindowDimensions),
			_1: {
				ctor: '::',
				_0: _elm_lang$page_visibility$PageVisibility$visibilityChanges(_user$project$InterfaceController$msgVisibilityChange),
				_1: {
					ctor: '::',
					_0: _elm_lang$mouse$Mouse$downs(
						_elm_lang$core$Basics$always(
							_user$project$InterfaceController$msgMouseIsDown(true))),
					_1: {
						ctor: '::',
						_0: _elm_lang$mouse$Mouse$ups(
							_elm_lang$core$Basics$always(
								_user$project$InterfaceController$msgMouseIsDown(false))),
						_1: {
							ctor: '::',
							_0: _elm_lang$mouse$Mouse$moves(_user$project$InterfaceController$msgMousePosition),
							_1: {
								ctor: '::',
								_0: _elm_lang$keyboard$Keyboard$presses(_user$project$InterfaceController$msgKeyPress),
								_1: {
									ctor: '::',
									_0: _elm_lang$keyboard$Keyboard$downs(_user$project$InterfaceController$msgKeyDown),
									_1: {
										ctor: '::',
										_0: _elm_lang$keyboard$Keyboard$ups(_user$project$InterfaceController$msgKeyUp),
										_1: {
											ctor: '::',
											_0: _user$project$AceCodeBox$receiveEditorState(_user$project$InterfaceController$msgAceUpdate),
											_1: {
												ctor: '::',
												_0: _user$project$AceCodeBox$userHasTyped(
													_elm_lang$core$Basics$always(_user$project$InterfaceController$msgUserHasTyped)),
												_1: {
													ctor: '::',
													_0: _user$project$AnimationLoop$receiveFrame(_user$project$InterfaceController$msgTickDelta),
													_1: {
														ctor: '::',
														_0: _user$project$FileHandler$writeConfirmation(_user$project$InterfaceController$msgConfirmWrite),
														_1: {
															ctor: '::',
															_0: _user$project$FileHandler$deleteConfirmation(_user$project$InterfaceController$msgConfirmDelete),
															_1: {
																ctor: '::',
																_0: _user$project$FileHandler$receiveFile(_user$project$InterfaceController$msgReadFile),
																_1: {
																	ctor: '::',
																	_0: _user$project$FileHandler$receiveIcon(_user$project$InterfaceController$msgLoadIcon),
																	_1: {
																		ctor: '::',
																		_0: _user$project$FileHandler$receiveFileFromInput(_user$project$InterfaceController$msgReadFileFromInput),
																		_1: {
																			ctor: '::',
																			_0: _user$project$FileHandler$receiveFileIndex(_user$project$InterfaceController$msgUpdateFileIndex),
																			_1: {
																				ctor: '::',
																				_0: _user$project$DeucePopupPanelInfo$receiveDeucePopupPanelInfo(_user$project$InterfaceController$msgReceiveDeucePopupPanelInfo),
																				_1: {ctor: '[]'}
																			}
																		}
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		});
};
var _user$project$Main$initCmd = _elm_lang$core$Platform_Cmd$batch(
	A2(
		_elm_lang$core$Basics_ops['++'],
		{
			ctor: '::',
			_0: A2(_elm_lang$core$Task$perform, _user$project$InterfaceController$msgWindowDimensions, _elm_lang$window$Window$size),
			_1: {
				ctor: '::',
				_0: _user$project$AceCodeBox$initializeAndDisplay(_user$project$InterfaceModel$initModel),
				_1: {
					ctor: '::',
					_0: _user$project$FileHandler$requestFileIndex(
						{ctor: '_Tuple0'}),
					_1: {
						ctor: '::',
						_0: _elm_lang$core$Platform_Cmd$batch(
							A2(_elm_lang$core$List$map, _user$project$FileHandler$requestIcon, _user$project$InterfaceModel$iconNames)),
						_1: {
							ctor: '::',
							_0: A2(
								_elm_lang$core$Task$perform,
								_user$project$InterfaceController$msgLoadIcon,
								_elm_lang$core$Task$succeed(_user$project$InterfaceModel$starLambdaToolIcon)),
							_1: {
								ctor: '::',
								_0: _user$project$ColorScheme$updateColorScheme(_user$project$InterfaceModel$initColorScheme),
								_1: {ctor: '[]'}
							}
						}
					}
				}
			}
		},
		_user$project$UserStudy$enabled ? {
			ctor: '::',
			_0: A2(
				_elm_lang$core$Task$perform,
				_user$project$InterfaceController$msgUserStudyStep(''),
				_elm_lang$core$Task$succeed(0)),
			_1: {ctor: '[]'}
		} : {
			ctor: '::',
			_0: A2(
				_elm_lang$core$Task$perform,
				_user$project$InterfaceController$msgNew,
				_elm_lang$core$Task$succeed(_user$project$InterfaceModel$initTemplate)),
			_1: {ctor: '[]'}
		}));
var _user$project$Main$update = F2(
	function (msg, model) {
		return A3(_user$project$UserStudyLog$logModelUpdate, _user$project$InterfaceController$update, msg, model);
	});
var _user$project$Main$view = _user$project$SleekView$view;
var _user$project$Main$init = {ctor: '_Tuple2', _0: _user$project$InterfaceModel$initModel, _1: _user$project$Main$initCmd};
var _user$project$Main$main = _elm_lang$html$Html$program(
	{init: _user$project$Main$init, view: _user$project$Main$view, update: _user$project$Main$update, subscriptions: _user$project$Main$subscriptions})();

var Elm = {};
Elm['Main'] = Elm['Main'] || {};
if (typeof _user$project$Main$main !== 'undefined') {
    _user$project$Main$main(Elm['Main'], 'Main', undefined);
}

if (typeof define === "function" && define['amd'])
{
  define([], function() { return Elm; });
  return;
}

if (typeof module === "object")
{
  module['exports'] = Elm;
  return;
}

var globalElm = this['Elm'];
if (typeof globalElm === "undefined")
{
  this['Elm'] = Elm;
  return;
}

for (var publicModule in Elm)
{
  if (publicModule in globalElm)
  {
    throw new Error('There are two Elm modules called `' + publicModule + '` on this page! Rename one of them.');
  }
  globalElm[publicModule] = Elm[publicModule];
}

}).call(this);

